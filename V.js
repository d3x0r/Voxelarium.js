"use strict";
var Voxelarium = {};
Voxelarium.Fonts = {};
//var THREE = null;
var glow = null;
(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * @author d3x0r / https://github.com/d3x0r
 */

THREE.NaturalControls = function ( object, domElement ) {

    this.object = object;
	this.domElement = ( domElement !== undefined ) ? domElement : document;

	this.enabled = true;

	// 65 /*A*/, 83 /*S*/, 68 /*D*/
	this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40
        , A:65, S:83, D:68, W:87, SPACE:32, C:67 };

	// internals

	var scope = this;

	var rotateStart = new THREE.Vector2();
	var rotateEnd = new THREE.Vector2();
	var rotateDelta = new THREE.Vector2();

	var phiDelta = 0;
	var thetaDelta = 0;
	var scale = 1;

	var lastPosition = new THREE.Vector3();



	this.rotateLeft = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		thetaDelta -= angle;

	};

	this.rotateRight = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		thetaDelta += angle;

	};

	this.rotateUp = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		phiDelta -= angle;

	};

	this.rotateDown = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		phiDelta += angle;

	};

	this.update = function ( tick ) {

    touchUpdate();

    if( phiDelta )
        var a = 3;
        scope.object.matrix.motion.rotation.x = -phiDelta;
        scope.object.matrix.motion.rotation.y = thetaDelta;//, 0 );

        //scope.object.matrix.rotateRelative( -phiDelta, thetaDelta, 0 );
        scope.object.matrixWorldNeedsUpdate = true;

        scope.object.matrix.move( tick );
        scope.object.matrix.rotateRelative( 0, 0, -scope.object.matrix.roll );

        thetaDelta = 0;
		phiDelta = 0;
	};



	function onMouseDown( event ) {
		if ( scope.enabled === false ) return;

		event.preventDefault();

		rotateStart.set( event.clientX, event.clientY );

		document.addEventListener( 'mousemove', onMouseMove, false );
		document.addEventListener( 'mouseup', onMouseUp, false );

	}

	function onMouseMove( event ) {

		if ( scope.enabled === false ) return;

		event.preventDefault();

    rotateEnd.set( event.clientX, event.clientY );
		rotateDelta.subVectors( rotateEnd, rotateStart );

        rotateDelta.x = 32 * (rotateDelta.x / window.innerWidth)
        rotateDelta.y = 32 * (rotateDelta.y / window.innerHeight)

		scope.rotateLeft( 2 * Math.PI * rotateDelta.x  );
		scope.rotateUp( 2 * Math.PI * rotateDelta.y );

		rotateStart.copy( rotateEnd );

	}

	function onMouseUp( event ) {

		if ( scope.enabled === false ) return;
		if ( scope.userRotate === false ) return;

		document.removeEventListener( 'mousemove', onMouseMove, false );
		document.removeEventListener( 'mouseup', onMouseUp, false );


	}

	function onMouseWheel( event ) {

		if ( scope.enabled === false ) return;
		if ( scope.userZoom === false ) return;

		var delta = 0;

		if ( event.wheelDelta ) { // WebKit / Opera / Explorer 9

			delta = event.wheelDelta;

		} else if ( event.detail ) { // Firefox

			delta = - event.detail;

		}

		if ( delta > 0 ) {

			scope.zoomOut();

		} else {

			scope.zoomIn();

		}

	}

	function onKeyDown( event ) {

		if ( scope.enabled === false ) return;
		if ( scope.userPan === false ) return;

		switch ( event.keyCode ) {
            case scope.keys.SPACE:
                scope.object.matrix.motion.speed.y = 100;
                break;
            case scope.keys.C:
                scope.object.matrix.motion.speed.y = -100;
                break;
            case scope.keys.A:
                scope.object.matrix.motion.speed.x = -100;
				break;
			case scope.keys.W:
                scope.object.matrix.motion.speed.z = 100;
				break;
			case scope.keys.S:
                scope.object.matrix.motion.speed.z = -100;
				break;
			case scope.keys.D:
                scope.object.matrix.motion.speed.x = 100;
				break;
		}

	}

	function onKeyUp( event ) {

        switch ( event.keyCode ) {
            case scope.keys.SPACE:
                scope.object.matrix.motion.speed.y = 0;
                break;
            case scope.keys.C:
                scope.object.matrix.motion.speed.y = 0;
                break;

            case scope.keys.A:
                scope.object.matrix.motion.speed.x = 0;
				break;
			case scope.keys.W:
                scope.object.matrix.motion.speed.z = 0;
				break;
			case scope.keys.S:
                scope.object.matrix.motion.speed.z = 0;
				break;
			case scope.keys.D:
                scope.object.matrix.motion.speed.x = 0;
				break;
        }
		//switch ( event.keyCode ) {

		//		break;
		//}

	}

var touches = [];

TouchList.prototype.forEach = function(c){ for( var n = 0; n < this.length; n++ ) c(this[n]); }

function touchUpdate() {
  if( touches.length == 1 ){
    var t = touches[0];
    if( t.new )
    {
      rotateStart.set( t.x, t.y );
      t.new = false;
    }
    else {

            rotateEnd.set( t.x, t.y );
      		rotateDelta.subVectors( rotateEnd, rotateStart );

            rotateDelta.x = -2 * (rotateDelta.x / window.innerWidth)
            rotateDelta.y = - 2 * (rotateDelta.y / window.innerHeight)
      		scope.rotateLeft( Math.PI/2 * rotateDelta.x   );
      		scope.rotateUp( Math.PI/2 * rotateDelta.y );
            console.log( rotateDelta )
      		rotateStart.copy( rotateEnd );

    }
  }
}

function onTouchStart( e ) {
  e.preventDefault();
  e.changedTouches.forEach( (touch)=>{
    touches.push( {ID:touch.identifier,
      x : touch.clientX,
      y : touch.clientY,
      new : true
    })
  })
}

function onTouchMove( e ) {
  e.preventDefault();
  e.changedTouches.forEach( (touchChanged)=>{
    var touch = touches.find( (t)=> t.ID === touchChanged.identifier );
    if( touch ) {
      touch.x = touchChanged.clientX;
      touch.y = touchChanged.clientY;
    }
  })
}

function onTouchEnd( e ) {
  e.preventDefault();
  e.changedTouches.forEach( (touchChanged)=>{
    var touchIndex = touches.findIndex( (t)=> t.ID === touchChanged.identifier );
    if( touchIndex >= 0 )
       touches.splice( touchIndex, 1 )
  })
}

    function ignore(event) {
        event.preventDefault();
    }
    this.disable = function() {
    	scope.domElement.removeEventListener( 'contextmenu', ignore, false );
    	scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );
    	scope.domElement.removeEventListener( 'mousewheel', onMouseWheel, false );
    	scope.domElement.removeEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox
    	window.removeEventListener( 'keydown', onKeyDown, false );
    	window.removeEventListener( 'keyup', onKeyUp, false );
    }

    this.enable = function() {
    	scope.domElement.addEventListener( 'contextmenu', ignore, false );
    	scope.domElement.addEventListener( 'mousedown', onMouseDown, false );
    	scope.domElement.addEventListener( 'mousewheel', onMouseWheel, false );
      scope.domElement.addEventListener( 'touchstart', onTouchStart, false );
      scope.domElement.addEventListener( 'touchmove', onTouchMove, false );
      scope.domElement.addEventListener( 'touchend', onTouchEnd, false );

    	scope.domElement.addEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox
    	window.addEventListener( 'keydown', onKeyDown, false );
    	window.addEventListener( 'keyup', onKeyUp, false );
    }
    this.enable();

};

//THREE.NaturalCamera.

THREE.NaturalControls.prototype = Object.create( THREE.EventDispatcher.prototype );

},{}],2:[function(require,module,exports){


var casting = {
    reset: function() { this.cubes = 0; },
    material : new THREE.LineBasicMaterial({color:'blue',linewidth:3}),
    geometry : new THREE.BufferGeometry,
    mesh : null,
    addRef : null,
    cubes : 0
};
casting.geometry.dynamic = true;
casting.mesh = new THREE.LineSegments( casting.geometry, casting.material );
 casting.mesh.frustumCulled = false;
 var vertices = new Float32Array( 500 * 3 ); // 3 vertices per point
casting.geometry.addAttribute( 'position', new THREE.BufferAttribute( vertices, 3 ) )

casting.addRef = function updateCastMesh( currentRef) {
  {
    var unit = currentRef.cluster.voxelUnitSize;
    var x = currentRef.wx * unit
    var y = currentRef.wy * unit
    var z = currentRef.wz * unit
  }
  var P = [new THREE.Vector3( x, y, z )
    , new THREE.Vector3( x + unit, y, z )
    , new THREE.Vector3( x, y + unit, z )
    , new THREE.Vector3( x + unit, y + unit, z )
    , new THREE.Vector3( x, y, z + unit )
    , new THREE.Vector3( x + unit, y, z + unit )
    , new THREE.Vector3( x, y + unit, z + unit )
    , new THREE.Vector3( x + unit, y + unit, z + unit )
    ]
    var geometry = casting.geometry;
    //    console.log( "add", x, y, z )
    var v = casting.cubes * 24*3;
    vertices[v++] = P[0].x; vertices[v++] = P[0].y; vertices[v++] = P[0].z;
    vertices[v++] = P[1].x; vertices[v++] = P[1].y; vertices[v++] = P[1].z;
    vertices[v++] = P[1].x; vertices[v++] = P[1].y; vertices[v++] = P[1].z;
    vertices[v++] = P[3].x; vertices[v++] = P[3].y; vertices[v++] = P[3].z;
    vertices[v++] = P[3].x; vertices[v++] = P[3].y; vertices[v++] = P[3].z;
    vertices[v++] = P[2].x; vertices[v++] = P[2].y; vertices[v++] = P[2].z;
    vertices[v++] = P[2].x; vertices[v++] = P[2].y; vertices[v++] = P[2].z;
    vertices[v++] = P[0].x; vertices[v++] = P[0].y; vertices[v++] = P[0].z;

    vertices[v++] = P[4].x; vertices[v++] = P[4].y; vertices[v++] = P[4].z;
    vertices[v++] = P[5].x; vertices[v++] = P[5].y; vertices[v++] = P[5].z;
    vertices[v++] = P[5].x; vertices[v++] = P[5].y; vertices[v++] = P[5].z;
    vertices[v++] = P[7].x; vertices[v++] = P[7].y; vertices[v++] = P[7].z;
    vertices[v++] = P[7].x; vertices[v++] = P[7].y; vertices[v++] = P[7].z;
    vertices[v++] = P[6].x; vertices[v++] = P[6].y; vertices[v++] = P[6].z;
    vertices[v++] = P[6].x; vertices[v++] = P[6].y; vertices[v++] = P[6].z;
    vertices[v++] = P[4].x; vertices[v++] = P[4].y; vertices[v++] = P[4].z;

    vertices[v++] = P[0].x; vertices[v++] = P[0].y; vertices[v++] = P[0].z;
    vertices[v++] = P[4].x; vertices[v++] = P[4].y; vertices[v++] = P[4].z;
    vertices[v++] = P[1].x; vertices[v++] = P[1].y; vertices[v++] = P[1].z;
    vertices[v++] = P[5].x; vertices[v++] = P[5].y; vertices[v++] = P[5].z;
    vertices[v++] = P[2].x; vertices[v++] = P[2].y; vertices[v++] = P[2].z;
    vertices[v++] = P[6].x; vertices[v++] = P[6].y; vertices[v++] = P[6].z;
    vertices[v++] = P[3].x; vertices[v++] = P[3].y; vertices[v++] = P[3].z;
    vertices[v++] = P[7].x; vertices[v++] = P[7].y; vertices[v++] = P[7].z;
    this.cubes++;
    geometry.attributes.position.needsUpdate = true
    geometry.verticesNeedUpdate = true;
}



THREE.GameMouse = function ( object, domElement ) {
    this.object = object;
	this.domElement = ( domElement !== undefined ) ? domElement : document;
    this.casting = casting;
  this.camera = null;
  var scope = this;
  this.mode = 0;
  this.voxelSelector = null;
  this.clusters = null;
  this.mouseRay = { n : THREE.Vector3Zero.clone(), o: new THREE.Vector3().delete() }
  this.mouseClock = new THREE.Clock();
  this.mouseEvents = [];
  this.currentAddType = Voxelarium.Voxels.types[2];

  var mouseButtonCount = 0;
  var mouseScrollX = 0;
  var mouseScrollY = 0;
  var cursorDistance = 650;

  this.setCurrentType = function( type ) {
      this.currentAddType = type;
  }
  this.setMouseRay = function( camera, e ) {
      //#define BEGIN_SCALE 1
      var rect = scope.domElement.getBoundingClientRect();
      const w = rect.right-rect.left;//window.innerWidth;
      const h = rect.bottom-rect.top;//window.innerHeight;
      var x = (((e.clientX-rect.left)-(w/2.0))/w) * 2;
      var y = (((e.clientY-rect.top)-(h/2.0))/h) * 2;
      //console.log( `mouse at ${x}, ${y}` )

      var mouse_ray_slope = camera.matrix.left.clone().multiplyScalar( x*camera.aspect );
      mouse_ray_slope.addScaledVector( camera.matrix.up, -(y) );

      // 0.47 is some magic number for 90 degree FOV
      //mouse_ray_slope.addScaledVector( camera.matrix.forward, -0.47 );
      // 75 degree view and like 3/4 aspect
      //mouse_ray_slope.addScaledVector( camera.matrix.forward, -0.605 );//-Math.sqrt(1 - mouse_ray_slope.length()) );
      mouse_ray_slope.addScaledVector( camera.matrix.backward, -1.304);//0.652 );//-Math.sqrt(1 - mouse_ray_slope.length()) );

      //mouse_ray_slope.unproject( camera );

      //var mouse_ray_target = THREE.Vector3Zero.clone().addScaledVector( THREE.Vector3Forward, 1000 );
      //mouse_ray_target.addScaledVector( THREE.Vector3Left,  camera.aspect*1000*x );
      //mouse_ray_target.addScaledVector( THREE.Vector3Up, -(1000)*y );

      //mouse_ray_origin.applyMatrix4( camera.matrix );
      //mouse_ray_target.applyMatrix4( camera.matrix );

      //var mouse_ray_slope = mouse_ray_target.clone().sub( mouse_ray_origin );
      //mouse_ray_slope.sub(camera.matrix.origin);
  	  mouse_ray_slope.normalize();
      //mouse_ray_origin.delete();
      scope.mouseRay.n.delete();

      scope.mouseRay.n = mouse_ray_slope;
      scope.mouseRay.o = camera.matrix.origin;
  }

  this.update = function() {
    if( !scope.clusters )
      return;
     switch( scope.mode )
     {
     case 0:
        var cluster = scope.clusters[0];
        if( mouseScrollY ) {
            cursorDistance += ( mouseScrollY / 120 ) * cluster.voxelUnitSize;
            mouseScrollY = 0;
        }
        if( scope.mouseRay ) {
            var o = scope.mouseRay.o;
            var result;
            result = rayCast( cluster, scope.mouseRay.o, scope.mouseRay.n )

            if( Voxelarium.selector.currentVoxel )
              Voxelarium.selector.currentVoxel.delete();

            if( result ) {
                Voxelarium.selector.currentAddVoxel = cluster.getVoxelRef( false, result.PredPointedVoxel.x, result.PredPointedVoxel.y, result.PredPointedVoxel.z )
              Voxelarium.selector.currentVoxel = result.ref;
          }
          /* this was another way of getting voxels... raycast is the routine for this now?
            rayCast projects a line through each plane going going out, and is more accurate than this.
            Plus rayCast can return the side of detection. */
          if( false ){

                var vox = o.clone().addScaledVector( scope.mouseRay.n, cursorDistance ).delete()

                var vrTo = Voxelarium.VoxelRef( cluster, null
                    , Math.floor(vox.x/cluster.voxelUnitSize)
                    , Math.floor(vox.y/cluster.voxelUnitSize)
                    , Math.floor(vox.z/cluster.voxelUnitSize) );
                var vrFrom = Voxelarium.VoxelRef( cluster, null
                        , Math.floor(o.x/cluster.voxelUnitSize)
                        , Math.floor(o.y/cluster.voxelUnitSize)
                        , Math.floor(o.z/cluster.voxelUnitSize) );
                //console.log( "things are ", vrTo, vrFrom )
                //this.casting.reset();
                //console.log( "---------- new set ----------- ")
                var ref = vrFrom.forEach( vrTo, false, (ref)=>{
                    //this.casting.addRef( ref );
                  //console.log( `check at `, ref.wx, ref.wy, ref.wz )
                  if( ref.voxelType && !ref.voxelType.properties.Is_PlayerCanPassThrough )
                    return ref;
                  return null;
                })
                //if( ref ) {
                //    this.casting.geometry.computeBoundingSphere();
                //    this.casting.geometry.setDrawRange( 0, (this.casting.cubes-1)*24 );
                //}
                if( ref ) {
                  Voxelarium.selector.currentVoxel = ref;
                } else {
                  Voxelarium.selector.currentVoxel = cluster.getVoxelRef( true, vox.x, vox.y, vox.z );
                }
                vrTo.delete();
                vrFrom.delete();
            }
        }

        if( scope.mouseEvents ) {
            var mEvent = scope.mouseEvents.shift();
            if( mEvent ) {
                if( mEvent.down ) {
                    if( mEvent.button === 0 ) { // left
                        var ref = Voxelarium.selector.currentAddVoxel;
                        if( ref && ref.sector ){
                            ref.sector.setCube( ref.x, ref.y, ref.z, scope.currentAddType )
                            ref.cluster.mesher.SectorUpdateFaceCulling( ref.sector, true )
                            //basicMesher.SectorUpdateFaceCulling_Partial( cluster, sector, Voxelarium.FACEDRAW_Operations.ALL, true )
                            ref.cluster.mesher.MakeSectorRenderingData( ref.sector );
                            Voxelarium.db.world.storeSector( ref.sector );
                        }

                    }
                    if( mEvent.button === 2 ) { // right
                        var ref = Voxelarium.selector.currentVoxel;
                        if( ref && ref.sector ){
                            ref.sector.setCube( ref.x, ref.y, ref.z, Voxelarium.Voxels.Void )
                            ref.cluster.mesher.SectorUpdateFaceCulling( ref.sector, true )
                            //basicMesher.SectorUpdateFaceCulling_Partial( cluster, sector, Voxelarium.FACEDRAW_Operations.ALL, true )
                            ref.cluster.mesher.MakeSectorRenderingData( ref.sector );
                            Voxelarium.db.world.storeSector( ref.sector );
                        }
                    }
                }
            }
        }

        break;
     }
      /*
      scope.object.matrix.rotateRelative( -phiDelta, thetaDelta, 0 );
      scope.object.matrix.rotateRelative( 0, 0, -scope.object.matrix.roll );
      scope.object.matrixWorldNeedsUpdate = true;
      */
  }

function mouseEvent( x, y, b, down ) {
    var ev = { x : x,
        y : y,
        button : b,
        delta : scope.mouseClock.getDelta(),
        down : down
    }

    scope.mouseEvents.push( ev );
}

var ongoingTouches = [];

function copyTouch(touch) {
  return { identifier: touch.identifier, pageX: touch.pageX, pageY: touch.pageY };
}
function ongoingTouchIndexById(idToFind) {
  for (var i = 0; i < ongoingTouches.length; i++) {
    var id = ongoingTouches[i].identifier;

    if (id == idToFind) {
      return i;
    }
  }
  return -1;    // not found
}
function onTouchDown(event) {
  event.preventDefault();
  var touches = event.changedTouches;
  for( var i = 0; i < touches.length; i++ ) {
    console.log( `touch ${i}=${touches[i]}`);
    ongoingTouches.push( copyTouch( touches[i] ) );

  }
}

function onTouchUp(event) {
  event.preventDefault();
}

function onTouchMove(event) {
  event.preventDefault();
  var touches = event.changedTouches;
  for( var i = 0; i < touches.length; i++ ) {
    var idx = ongoingTouchIndexById(touches[i].identifier);
    if( idx >= 0 ) {
      ongoingTouches.splice( idx, 1, copyTouch( touches[i] ) );
    }
  }
}

function onTouchCancel(event) {
  event.preventDefault();
}



  function onMouseDown(event) {
      if ( scope.enabled === false ) return;
      event.preventDefault();
      mouseEvent( event.clientX, event.clientY, event.button, true );
  }

  function onMouseUp(event) {
      if ( scope.enabled === false ) return;
      event.preventDefault();
      mouseEvent( event.clientX, event.clientY, event.button, false );
  }

    function onMouseMove( event ) {

    	if ( scope.enabled === false ) return;

    	event.preventDefault();

        scope.setMouseRay( camera, event );

    }

    function onMouseWheel( event ) {
        event.preventDefault();
        mouseScrollX += event.wheelDeltaX;
        mouseScrollY += event.wheelDeltaY;
    }

  function ignore(event) {
      event.preventDefault();
  }

  this.disable = function() {
    scope.domElement.removeEventListener( 'contextmenu', ignore, false );
    scope.domElement.removeEventListener( 'touchstart', onTouchDown, false );
    scope.domElement.removeEventListener( 'touchend', onTouchUp, false );
    scope.domElement.removeEventListener( 'touchcancel', onTouchCancel, false );
    scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );
    scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );
    scope.domElement.removeEventListener( 'mouseup', onMouseUp, false );
    scope.domElement.removeEventListener( 'mousemove', onMouseMove, false );
    scope.domElement.removeEventListener( 'mousewheel', onMouseWheel, false );
    scope.domElement.removeEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox
    //window.removeEventListener( 'keydown', onKeyDown, false );
    //window.removeEventListener( 'keyup', onKeyUp, false );
  }

  this.enable = function() {
    scope.domElement.addEventListener( 'contextmenu', ignore, false );
    scope.domElement.addEventListener( 'touchstart', onTouchDown, false );
    scope.domElement.addEventListener( 'touchend', onTouchUp, false );
    scope.domElement.addEventListener( 'touchcancel', onTouchCancel, false );
    scope.domElement.addEventListener( 'touchmove', onTouchMove, false );
    scope.domElement.addEventListener( 'mousedown', onMouseDown, false );
    scope.domElement.addEventListener( 'mouseup', onMouseUp, false );
    scope.domElement.addEventListener( 'mousemove', onMouseMove, false );
    scope.domElement.addEventListener( 'mousewheel', onMouseWheel, false ); // firefox
    scope.domElement.addEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox
    //window.addEventListener( 'keydown', onKeyDown, false );
    //window.addEventListener( 'keyup', onKeyUp, false );
  }
  this.enable();


}





function  rayCast(cluster, o, forward )
{
    var Out = null;
  var Delta_h = new THREE.Vector4Pool.new(),Delta_v = new THREE.Vector4Pool.new(),Delta_s = new THREE.Vector4Pool.new();
  var Offset_h = new THREE.Vector4Pool.new(), Offset_v = new THREE.Vector4Pool.new(), Offset_s = new THREE.Vector4Pool.new();
  var Norm_h = new THREE.Vector3Pool.new(), Norm_v = new THREE.Vector3Pool.new(), Norm_s = new THREE.Vector3Pool.new();
  var Collision_h = new THREE.Vector4Pool.new(), Collision_v = new THREE.Vector4Pool.new(), Collision_s = new THREE.Vector4Pool.new();

  var ActualCube_x,ActualCube_y,ActualCube_z;
  var NewCube_x,NewCube_y,NewCube_z;
  var Collide_X, Collide_Y, Collide_Z;
  var i;

  var Norm = forward;

  Collide_X = Collide_Y = Collide_Z = false;

  if (Norm.x >= 0.01 )
  {
    Collide_X = true;
    Delta_h.x = 1.0;
    Delta_h.y = Norm.y / Norm.x;
    Delta_h.z = Norm.z / Norm.x;
    Delta_h.w = 0;
    Delta_h.w = Delta_h.length();

    Collision_h.x = (Math.floor(o.x / cluster.voxelUnitSize) + 1.0)*cluster.voxelUnitSize;
    Collision_h.y = (Collision_h.x - o.x) * Delta_h.y + o.y;
    Collision_h.z = (Collision_h.x - o.x) * Delta_h.z + o.z;
    Collision_h.w = (Collision_h.x - o.x) * Delta_h.w;

    Offset_h.x = cluster.voxelUnitSize;
    Offset_h.y = Delta_h.y * cluster.voxelUnitSize;
    Offset_h.z = Delta_h.z * cluster.voxelUnitSize;
    Offset_h.w = Delta_h.w * cluster.voxelUnitSize;
    Norm_h.x = Offset_h.x/2;// / (cluster.voxelUnitSize/2);
    Norm_h.y = 0 / (cluster.voxelUnitSize/2);
    Norm_h.z = 0 / (cluster.voxelUnitSize/2);
  }
  else if (Norm.x <= -0.01)
  {
    Collide_X = true;

    Delta_h.x = 1.0;
    Delta_h.y = Norm.y / -Norm.x;
    Delta_h.z = Norm.z / -Norm.x;
    Delta_h.w = 0;
    Delta_h.w = Delta_h.length();

    Collision_h.x = (Math.floor(o.x / cluster.voxelUnitSize))*cluster.voxelUnitSize;
    Collision_h.y = (o.x - Collision_h.x) * Delta_h.y + o.y;
    Collision_h.z = (o.x - Collision_h.x) * Delta_h.z + o.z;
    Collision_h.w = (o.x - Collision_h.x) * Delta_h.w;
    Offset_h.x = -cluster.voxelUnitSize;
    Offset_h.y = Delta_h.y * cluster.voxelUnitSize;
    Offset_h.z = Delta_h.z * cluster.voxelUnitSize;
    Offset_h.w = Delta_h.w * cluster.voxelUnitSize;
    Norm_h.x = Offset_h.x/2;// / (cluster.voxelUnitSize/2);
    Norm_h.y = 0 / (cluster.voxelUnitSize/2);
    Norm_h.z = 0 / (cluster.voxelUnitSize/2);
  }

  if (Norm.y >= 0.01 )
  {
    Collide_Y = true;
    Delta_v.x = Norm.x / Norm.y;
    Delta_v.y = 1.0;
    Delta_v.z = Norm.z / Norm.y;
    Delta_v.w = 0;
    Delta_v.w = Delta_v.length();

    Collision_v.y = (Math.floor(o.y / cluster.voxelUnitSize)+1) * cluster.voxelUnitSize;
    var dely = (Collision_v.y - o.y);
    Collision_v.x = dely * Delta_v.x + o.x;
    Collision_v.z = dely * Delta_v.z + o.z;
    Collision_v.w = dely * Delta_v.w;
    Offset_v.y = cluster.voxelUnitSize;
    Offset_v.x = Delta_v.x * cluster.voxelUnitSize;
    Offset_v.z = Delta_v.z * cluster.voxelUnitSize;
    Offset_v.w = Delta_v.w * cluster.voxelUnitSize;
    Norm_v.x = 0 / (cluster.voxelUnitSize/2);
    Norm_v.y = Offset_v.y/2;// / (cluster.voxelUnitSize/2);
    Norm_v.z = 0 / (cluster.voxelUnitSize/2);
  }
  else if (Norm.y <= -0.01)
  {
    Collide_Y = true;
    Delta_v.x = Norm.x / -Norm.y;
    Delta_v.y = 1.0;
    Delta_v.z = Norm.z / -Norm.y;
    Delta_v.w = 0;
    Delta_v.w = Delta_v.length();

    Collision_v.y = (Math.floor(o.y / cluster.voxelUnitSize)) * cluster.voxelUnitSize;
    var dely = (o.y-Collision_v.y );
    Collision_v.x = (dely) * Delta_v.x + o.x;
    Collision_v.z = (dely) * Delta_v.z + o.z;
    Collision_v.w = (dely) * Delta_v.w;

    Offset_v.y = -cluster.voxelUnitSize;
    Offset_v.x = Delta_v.x * cluster.voxelUnitSize;
    Offset_v.z = Delta_v.z * cluster.voxelUnitSize;
    Offset_v.w = Delta_v.w * cluster.voxelUnitSize;
    Norm_v.x = 0 / (cluster.voxelUnitSize/2);
    Norm_v.y = Offset_v.y/2;// / (cluster.voxelUnitSize/2);
    Norm_v.z = 0 / (cluster.voxelUnitSize/2);
  }

  if (Norm.z >= 0.01)
  {
    Collide_Z = true;
    Delta_s.x = Norm.x / Norm.z;
    Delta_s.y = Norm.y / Norm.z;
    Delta_s.z = 1.0;
    Delta_s.w = 0;
    Delta_s.w = Delta_s.length();
    Collision_s.z = (Math.floor(o.z / cluster.voxelUnitSize) + 1.0)*cluster.voxelUnitSize;
    Collision_s.x = (Collision_s.z - o.z) * Delta_s.x + o.x;
    Collision_s.y = (Collision_s.z - o.z) * Delta_s.y + o.y;
    Collision_s.w = (Collision_s.z - o.z) * Delta_s.w;

    Offset_s.x = Delta_s.x * cluster.voxelUnitSize;
    Offset_s.y = Delta_s.y * cluster.voxelUnitSize;
    Offset_s.z = cluster.voxelUnitSize;
    Offset_s.w = Delta_s.w * cluster.voxelUnitSize;
    Norm_s.x = 0 / (cluster.voxelUnitSize/2);
    Norm_s.y = 0 / (cluster.voxelUnitSize/2);
    Norm_s.z = Offset_s.z/2;// / (cluster.voxelUnitSize/2);
  }
  else if (Norm.z <= -0.01)
  {
    Collide_Z = true;
    Delta_s.x = Norm.x / -Norm.z;
    Delta_s.y = Norm.y / -Norm.z;
    Delta_s.z = 1.0;
    Delta_s.w = 0;
    Delta_s.w = Delta_s.length();
    Collision_s.z = (Math.floor(o.z / cluster.voxelUnitSize) )*cluster.voxelUnitSize;
    Collision_s.x = (o.z - Collision_s.z) * Delta_s.x + o.x;
    Collision_s.y = (o.z - Collision_s.z) * Delta_s.y + o.y;
    Collision_s.w = (o.z - Collision_s.z) * Delta_s.w;

    Offset_s.x = Delta_s.x * cluster.voxelUnitSize;
    Offset_s.y = Delta_s.y * cluster.voxelUnitSize;
    Offset_s.z = - cluster.voxelUnitSize;
    Offset_s.w = Delta_s.w * cluster.voxelUnitSize;

    Norm_s.x = 0 / (cluster.voxelUnitSize/2);
    Norm_s.y = 0 / (cluster.voxelUnitSize/2);
    Norm_s.z = Offset_s.z/2;// / (cluster.voxelUnitSize/2);
  }



//  printf("yaw: %04lf pitch: %lf Offset_y:%lf Offset_z:%lf xyz:%lf %lf %lf NXYZ:%lf %lf %lf Dxyz:%lf %lf %lf", yaw,pitch, Delta_h.y, Delta_h.z,x,y,z, Norm_h.x, Norm_h.y, Norm_h.z, Delta_h.x, Delta_h.y, Delta_h.z);
 //printf("Angle (y:%lf p:%lf) XYZ:(%lf %lf %lf) Off(%lf %lf %lf %lf) Coll(%lf %lf %lf %lf) Norm(%lg %lg %lf) :\n", yaw,pitch,x,y,z, Offset_s.x, Offset_s.y, Offset_s.z, Offset_s.w, Collision_s.x, Collision_s.y, Collision_s.z, Collision_s.w, Norm_s.x,Norm_s.y, Norm_s.z);

  var Match_h = 0;
  var Match_s = 0;
  var Match_v = 0;
  var Cycle = 1;
  var MinW = 1000000.0;
  var ref;
  //console.log( '-------------------------');
  for (i=0;i<150;i++)
  {

    // Horizontal X axis.
    if (Collide_X)
    {
      if (Match_h==0 && Collision_h.w < MinW)
      {
        ActualCube_x = Math.floor((Collision_h.x - Norm_h.x) / cluster.voxelUnitSize);
        ActualCube_y = Math.floor((Collision_h.y - Norm_h.y) / cluster.voxelUnitSize);
        ActualCube_z = Math.floor((Collision_h.z - Norm_h.z) / cluster.voxelUnitSize);
        NewCube_x = Math.floor((Collision_h.x + Norm_h.x) / cluster.voxelUnitSize);
        NewCube_y = Math.floor((Collision_h.y + Norm_h.y) / cluster.voxelUnitSize);
        NewCube_z = Math.floor((Collision_h.z + Norm_h.z) / cluster.voxelUnitSize);
        if( ( ref = cluster.getVoxelRef( false, NewCube_x, NewCube_y, NewCube_z) ) && ref.sector && !ref.voxelType.properties.Is_PlayerCanPassThrough)
        {
            //console.log( `x check ${NewCube_x}  ${NewCube_y}  ${NewCube_z}    ${ActualCube_x} ${ActualCube_y} ${ActualCube_z}  ${MinW}  ${Collision_h.w}`)
            Out = { PredPointedVoxel : new THREE.Vector3( ActualCube_x, ActualCube_y, ActualCube_z ),
                    PointedVoxel : new THREE.Vector3( NewCube_x, NewCube_y, NewCube_z ),
                    ref : ref
                    };
          // printf(" MATCH_H: %lf\n",Collision_h.w);
          Match_h = Cycle;
          MinW = Collision_h.w;
        } else if( ref ) ref.delete();
      }
    }

    // Horizontal Z axis.

    if (Collide_Z)
    {
      if (Match_s == 0 && Collision_s.w < MinW)
      {
        ActualCube_x = Math.floor((Collision_s.x - Norm_s.x) / cluster.voxelUnitSize);
        ActualCube_y = Math.floor((Collision_s.y - Norm_s.y) / cluster.voxelUnitSize);
        ActualCube_z = Math.floor((Collision_s.z - Norm_s.z) / cluster.voxelUnitSize);
        NewCube_x = Math.floor((Collision_s.x + Norm_s.x) / cluster.voxelUnitSize);
        NewCube_y = Math.floor((Collision_s.y + Norm_s.y) / cluster.voxelUnitSize);
        NewCube_z = Math.floor((Collision_s.z + Norm_s.z) / cluster.voxelUnitSize);
        //console.log( `z check ${NewCube_x}  ${NewCube_y}  ${NewCube_z}  ${MinW}  ${Collision_s.w} `)
        if( ( ref = cluster.getVoxelRef( false, NewCube_x, NewCube_y, NewCube_z) ) && ref.sector && !ref.voxelType.properties.Is_PlayerCanPassThrough)
        {
            //console.log( `z check ${NewCube_x}  ${NewCube_y}  ${NewCube_z}  ${MinW}  ${Collision_s.w} `)
          Out = { PredPointedVoxel : new THREE.Vector3( ActualCube_x, ActualCube_y, ActualCube_z ),
                  PointedVoxel : new THREE.Vector3( NewCube_x, NewCube_y, NewCube_z ),
                  ref : ref
                   };
          // printf(" MATCH_S: %lf\n",Collision_s.w);
          Match_s = Cycle;
          MinW = Collision_s.w;
        } else if( ref ) ref.delete();
      }
    }

    // Vertical Y axis.

    if (Collide_Y)
    {
      if (Match_v==0 && Collision_v.w < MinW)
      {
        ActualCube_x = Math.floor((Collision_v.x - Norm_v.x) / cluster.voxelUnitSize);
        ActualCube_y = Math.floor((Collision_v.y - Norm_v.y) / cluster.voxelUnitSize);
        ActualCube_z = Math.floor((Collision_v.z - Norm_v.z) / cluster.voxelUnitSize);
        NewCube_x = Math.floor((Collision_v.x + Norm_v.x) / cluster.voxelUnitSize);
        NewCube_y = Math.floor((Collision_v.y + Norm_v.y) / cluster.voxelUnitSize);
        NewCube_z = Math.floor((Collision_v.z + Norm_v.z) / cluster.voxelUnitSize);
        if( ( ref = cluster.getVoxelRef( false, NewCube_x, NewCube_y, NewCube_z) ) && ref.sector && !ref.voxelType.properties.Is_PlayerCanPassThrough )
        {
            //console.log( `y check ${NewCube_x}  ${NewCube_y}  ${NewCube_z}  ${MinW}  ${Collision_v.w} `)
          Out = { PredPointedVoxel : new THREE.Vector3( ActualCube_x, ActualCube_y, ActualCube_z ),
                  PointedVoxel : new THREE.Vector3( NewCube_x, NewCube_y, NewCube_z ),
                  ref : ref
                   };
          // printf(" MATCH_V: %lf\n",Collision_v.w);
          Match_v = Cycle;
          MinW = Collision_v.w;
        } else if( ref ) ref.delete();
      }
    }

      //printf(" Match (H:%lf S:%lf V:%lf) \n", Collision_h.w, Collision_s.w, Collision_v.w);
      if (Match_h>0 && (Match_h - Cycle)<-100) return Out;
      if (Match_s>0 && (Match_s - Cycle)<-100) return Out;
      if (Match_v>0 && (Match_v - Cycle)<-100) return Out;

    Collision_h.x += Offset_h.x; Collision_h.y += Offset_h.y; Collision_h.z += Offset_h.z; Collision_h.w += Offset_h.w;
    Collision_v.x += Offset_v.x; Collision_v.y += Offset_v.y; Collision_v.z += Offset_v.z; Collision_v.w += Offset_v.w;
    Collision_s.x += Offset_s.x; Collision_s.y += Offset_s.y; Collision_s.z += Offset_s.z; Collision_s.w += Offset_s.w;
    Cycle ++;
  }
  Delta_h.delete();
  Delta_v.delete();
  Delta_s.delete();
  Offset_h.delete();
  Offset_v.delete();
  Offset_s.delete();
  Norm_h.delete();
  Norm_v.delete();
  Norm_s.delete();
  Collision_h.delete();
  Collision_v.delete();
  Collision_s.delete();

  return Out;
}

},{}],3:[function(require,module,exports){


glow = {

 glowcomposer : null,
 scenecomposer : null,
 finalcomposer : null,

 renderTargetGlow : null,
	renderTarget : null,
        render : null,
    };


var glowcomposer;
var scenecomposer;
var finalcomposer;

var renderTargetGlow;
var	renderTarget;

var finalshader = {
    uniforms: {
        tDiffuse: { type: "t", value: 0, texture: null }, // The base scene buffer
        tGlow: { type: "t", value: 1, texture: null }, // The glow scene buffer
		tDiffuseDepth: { type: "t", value: 0, texture: null }, // The base scene buffer
        tGlowDepth: { type: "t", value: 1, texture: null }, // The glow scene buffer
		cameraNear: { type: 'f', value: 1 },
		cameraFar: { type: 'f', value: 10000 },
    },

    vertexShader: [
        "varying vec2 vUv;",

        "void main() {",

            "vUv = vec2( uv.x, uv.y );",
            "gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

        "}"
    ].join(""),

    fragmentShader: [
        "uniform sampler2D tDiffuse;",
        "uniform sampler2D tGlow;",
		"uniform sampler2D tDiffuseDepth;",
		"uniform sampler2D tGlowDepth;",
		"uniform float cameraNear;",
 		"uniform float cameraFar;",

        "varying vec2 vUv;",

		"float readDepth (sampler2D depthSampler, vec2 coord) {",
        "  float cameraFarPlusNear = cameraFar + cameraNear;",
        "  float cameraFarMinusNear = cameraFar - cameraNear;",
        "  float cameraCoef = 2.0 * cameraNear;",
        "  return 1.0-(cameraCoef / (cameraFarPlusNear - texture2D(depthSampler, coord).x * cameraFarMinusNear));",
        "}",

        "void main() {",

            "vec4 texel = texture2D( tDiffuse, vUv );",
            "vec4 glow = texture2D( tGlow, vUv );",
			"float texelDepth = readDepth( tDiffuseDepth, vUv );",
			"float glowDepth = readDepth( tGlowDepth, vUv );",
			//"float texelDepth = texture2D(tDiffuseDepth, vUv).x;",
            //"if( (texel.r+texel.g+texel.b)== 0.0 ) ",
			"    gl_FragColor = (texel + vec4(0.5, 0.75, 1.0, 3.0) * glow * 1.0);", // Blend the two buffers together (I colorized and intensified the glow at the same time)
			//"    gl_FragColor +=  vec4(texelDepth, glowDepth, 0, 1.0);", // Blend the two buffers together (I colorized and intensified the glow at the same time)
			//"else gl_FragColor = texel;",
			//"gl_FragColor = texel;",

        "}"
    ].join("")
};

var preGlow;
var preFlat;
var overlay;
var scene;

glow.makeComposers =
function makeComposers( renderer, sceneFlat, preFlatSetup, sceneGlow, preGlowSetup, sceneOver ) {
  scene = sceneFlat;
  glow.renderer = renderer;
	renderer.autoClear = false;

  if( !Voxelarium.Settings.use_basic_material ) {

    overlay = sceneOver;
    preGlow = preGlowSetup;
    preFlat = preFlatSetup;
	// Prepare the glow composer's render target
	var renderTargetParameters = { minFilter: THREE.LinearFilter
			, magFilter: THREE.LinearFilter
			//, format: THREE.RGBFormat
			, stencilBufer: false };
	if( !renderTargetGlow ){
	  renderTargetGlow = new THREE.WebGLRenderTarget( window.innerWidth, window.innerHeight/*, renderTargetParameters*/ );
	  renderTargetGlow.texture.minFilter = THREE.LinearFilter;
	  renderTargetGlow.texture.magFilter = THREE.LinearFilter;
	  renderTargetGlow.texture.stencilBufer = false;
	  renderTargetGlow.depthTexture = new THREE.DepthTexture( );
		//renderTargetGlow.depthTexture.type = isWebGL2 ? THREE.FloatType : THREE.UnsignedShortType;
	}
	// Prepare the blur shader passes
	var hblur = new THREE.ShaderPass( THREE.HorizontalBlurShader );
	var vblur = new THREE.ShaderPass( THREE.VerticalBlurShader );

	var bluriness = 1;

	hblur.uniforms[ "h" ].value = bluriness / window.innerWidth;
	//hblur.material.depthTest = false;
	//hblur.material.depthWrite = false;

	vblur.uniforms[ "v" ].value = bluriness / window.innerHeight;
	//vblur.material.depthTest = false;
	//vblur.material.depthWrite = false;

	// Prepare the glow scene render pass
	var renderModelGlow = new THREE.RenderPass( sceneGlow, camera);

	// Create the glow composer
	glowcomposer = new THREE.EffectComposer( renderer, renderTargetGlow );

	// Add all the glow passes
	glowcomposer.addPass( renderModelGlow );
	glowcomposer.addPass( hblur );
	glowcomposer.addPass( vblur );


	// Prepare the base scene render pass
	var renderModel = new THREE.RenderPass( sceneFlat, camera );
	var renderModel2 = new THREE.RenderPass( sceneGlow, camera );
    //var renderModel3 = new THREE.RenderPass( sceneOver, camera );
	renderModel.clear = true;
	renderModel2.clear = false;
    //renderModel3.clear = false;


	// Prepare the composer's render target
	if( !renderTarget ) {
		renderTarget = new THREE.WebGLRenderTarget( window.innerWidth, window.innerHeight/*, renderTargetParameters*/ );
		renderTargetGlow.texture.minFilter = THREE.LinearFilter;
		renderTargetGlow.texture.magFilter = THREE.LinearFilter;
		renderTargetGlow.texture.stencilBufer = false;
		renderTarget.depthTexture = new THREE.DepthTexture();
		//renderTarget.depthTexture.type = isWebGL2 ? THREE.FloatType : THREE.UnsignedShortType;
		//renderTarget.depthTexture.type = THREE.FloatType ;//: THREE.UnsignedShortType;
	}
	// Create the composer
//	scenecomposer = new THREE.EffectComposer( renderer, renderTarget );

	// First we need to assign the glow composer's output render target to the tGlow sampler2D of our shader
	// Old Three.js pre-r50
	//finalshader.uniforms[ "tGlow" ].texture = glowcomposer.renderTarget2;
	// New Three.js
	finalshader.uniforms[ "tGlow" ].value = glowcomposer.renderTarget2;
	finalshader.uniforms[ "tGlowDepth" ].value = renderTargetGlow.depthTexture;
	finalshader.uniforms[ "tDiffuseDepth" ].value = renderTarget.depthTexture;
	finalshader.uniforms[ "cameraNear"].value = camera.near;
	finalshader.uniforms[ "cameraFar"].value = camera.far;

	//finalshader.uniforms[ "tDiffuse" ].value = scenecomposer.renderTarget2;
	// Note that the tDiffuse sampler2D will be automatically filled by the EffectComposer

	// Prepare the additive blending pass
	var finalPass = new THREE.ShaderPass( finalshader );
    //finalPass.
	finalPass.needsSwap = false;
	// Make sure the additive blending is rendered to the screen (since it's the last pass)
	finalPass.renderToScreen = true;
    //renderModel3.renderToScreen = true;

	// Create the composer
	finalcomposer = new THREE.EffectComposer( renderer, renderTarget );

	// Add all passes
	finalcomposer.addPass( renderModel );
	finalcomposer.addPass( renderModel2 );
	finalcomposer.addPass( finalPass );
}
    //finalcomposer.addPass( renderModel3 );
}



//exports.render =
glow.render = function glowRender() {
  if( !Voxelarium.Settings.use_basic_material ) {
    preGlow();
    glowcomposer.render();

    preFlat();
	//scenecomposer.render();

	finalshader.uniforms[ "tGlow" ].value = glowcomposer.renderTarget2;
	finalshader.uniforms[ "tGlowDepth" ].value = renderTargetGlow.depthTexture.texture;
	finalshader.uniforms[ "tDiffuseDepth" ].value = renderTarget.depthTexture.texture;
	finalshader.uniforms[ "cameraNear"].value = camera.near;
	finalshader.uniforms[ "cameraFar"].value = camera.far;


    finalcomposer.render();
	   if( overlay )
	     glow.renderer.render( overlay, camera );
  }
  else {
    glow.renderer.render( scene, camera );
    if( overlay )
  	     glow.renderer.render( overlay, camera );

  }
  if( Voxelarium.Settings.VR )
	  effect.submitFrame();

}

},{}],4:[function(require,module,exports){
if (global.GENTLY) require = GENTLY.hijack(require);

var util = require('util'),
    WriteStream = require('fs').WriteStream,
    EventEmitter = require('events').EventEmitter,
    crypto = require('crypto');

function File(properties) {
  EventEmitter.call(this);

  this.size = 0;
  this.path = null;
  this.name = null;
  this.type = null;
  this.hash = null;
  this.lastModifiedDate = null;

  this._writeStream = null;
  
  for (var key in properties) {
    this[key] = properties[key];
  }

  if(typeof this.hash === 'string') {
    this.hash = crypto.createHash(properties.hash);
  } else {
    this.hash = null;
  }
}
module.exports = File;
util.inherits(File, EventEmitter);

File.prototype.open = function() {
  this._writeStream = new WriteStream(this.path);
};

File.prototype.toJSON = function() {
  return {
    size: this.size,
    path: this.path,
    name: this.name,
    type: this.type,
    mtime: this.lastModifiedDate,
    length: this.length,
    filename: this.filename,
    mime: this.mime
  };
};

File.prototype.write = function(buffer, cb) {
  var self = this;
  if (self.hash) {
    self.hash.update(buffer);
  }
  this._writeStream.write(buffer, function() {
    self.lastModifiedDate = new Date();
    self.size += buffer.length;
    self.emit('progress', self.size);
    cb();
  });
};

File.prototype.end = function(cb) {
  var self = this;
  if (self.hash) {
    self.hash = self.hash.digest('hex');
  }
  this._writeStream.end(function() {
    self.emit('end');
    cb();
  });
};

},{"crypto":undefined,"events":undefined,"fs":undefined,"util":undefined}],5:[function(require,module,exports){
if (global.GENTLY) require = GENTLY.hijack(require);

var crypto = require('crypto');
var fs = require('fs');
var util = require('util'),
    path = require('path'),
    File = require('./file'),
    MultipartParser = require('./multipart_parser').MultipartParser,
    QuerystringParser = require('./querystring_parser').QuerystringParser,
    OctetParser       = require('./octet_parser').OctetParser,
    JSONParser = require('./json_parser').JSONParser,
    StringDecoder = require('string_decoder').StringDecoder,
    EventEmitter = require('events').EventEmitter,
    Stream = require('stream').Stream,
    os = require('os');

function IncomingForm(opts) {
  if (!(this instanceof IncomingForm)) return new IncomingForm(opts);
  EventEmitter.call(this);

  opts=opts||{};

  this.error = null;
  this.ended = false;

  this.maxFields = opts.maxFields || 1000;
  this.maxFieldsSize = opts.maxFieldsSize || 2 * 1024 * 1024;
  this.keepExtensions = opts.keepExtensions || false;
  this.uploadDir = opts.uploadDir || os.tmpDir();
  this.encoding = opts.encoding || 'utf-8';
  this.headers = null;
  this.type = null;
  this.hash = opts.hash || false;
  this.multiples = opts.multiples || false;

  this.bytesReceived = null;
  this.bytesExpected = null;

  this._parser = null;
  this._flushing = 0;
  this._fieldsSize = 0;
  this.openedFiles = [];

  return this;
}
util.inherits(IncomingForm, EventEmitter);
exports.IncomingForm = IncomingForm;

IncomingForm.prototype.parse = function(req, cb) {
  this.pause = function() {
    try {
      req.pause();
    } catch (err) {
      // the stream was destroyed
      if (!this.ended) {
        // before it was completed, crash & burn
        this._error(err);
      }
      return false;
    }
    return true;
  };

  this.resume = function() {
    try {
      req.resume();
    } catch (err) {
      // the stream was destroyed
      if (!this.ended) {
        // before it was completed, crash & burn
        this._error(err);
      }
      return false;
    }

    return true;
  };

  // Setup callback first, so we don't miss anything from data events emitted
  // immediately.
  if (cb) {
    var fields = {}, files = {};
    this
      .on('field', function(name, value) {
        fields[name] = value;
      })
      .on('file', function(name, file) {
        if (this.multiples) {
          if (files[name]) {
            if (!Array.isArray(files[name])) {
              files[name] = [files[name]];
            }
            files[name].push(file);
          } else {
            files[name] = file;
          }
        } else {
          files[name] = file;
        }
      })
      .on('error', function(err) {
        cb(err, fields, files);
      })
      .on('end', function() {
        cb(null, fields, files);
      });
  }

  // Parse headers and setup the parser, ready to start listening for data.
  this.writeHeaders(req.headers);

  // Start listening for data.
  var self = this;
  req
    .on('error', function(err) {
      self._error(err);
    })
    .on('aborted', function() {
      self.emit('aborted');
      self._error(new Error('Request aborted'));
    })
    .on('data', function(buffer) {
      self.write(buffer);
    })
    .on('end', function() {
      if (self.error) {
        return;
      }

      var err = self._parser.end();
      if (err) {
        self._error(err);
      }
    });

  return this;
};

IncomingForm.prototype.writeHeaders = function(headers) {
  this.headers = headers;
  this._parseContentLength();
  this._parseContentType();
};

IncomingForm.prototype.write = function(buffer) {
  if (this.error) {
    return;
  }
  if (!this._parser) {
    this._error(new Error('uninitialized parser'));
    return;
  }

  this.bytesReceived += buffer.length;
  this.emit('progress', this.bytesReceived, this.bytesExpected);

  var bytesParsed = this._parser.write(buffer);
  if (bytesParsed !== buffer.length) {
    this._error(new Error('parser error, '+bytesParsed+' of '+buffer.length+' bytes parsed'));
  }

  return bytesParsed;
};

IncomingForm.prototype.pause = function() {
  // this does nothing, unless overwritten in IncomingForm.parse
  return false;
};

IncomingForm.prototype.resume = function() {
  // this does nothing, unless overwritten in IncomingForm.parse
  return false;
};

IncomingForm.prototype.onPart = function(part) {
  // this method can be overwritten by the user
  this.handlePart(part);
};

IncomingForm.prototype.handlePart = function(part) {
  var self = this;

  if (part.filename === undefined) {
    var value = ''
      , decoder = new StringDecoder(this.encoding);

    part.on('data', function(buffer) {
      self._fieldsSize += buffer.length;
      if (self._fieldsSize > self.maxFieldsSize) {
        self._error(new Error('maxFieldsSize exceeded, received '+self._fieldsSize+' bytes of field data'));
        return;
      }
      value += decoder.write(buffer);
    });

    part.on('end', function() {
      self.emit('field', part.name, value);
    });
    return;
  }

  this._flushing++;

  var file = new File({
    path: this._uploadPath(part.filename),
    name: part.filename,
    type: part.mime,
    hash: self.hash
  });

  this.emit('fileBegin', part.name, file);

  file.open();
  this.openedFiles.push(file);

  part.on('data', function(buffer) {
    if (buffer.length == 0) {
      return;
    }
    self.pause();
    file.write(buffer, function() {
      self.resume();
    });
  });

  part.on('end', function() {
    file.end(function() {
      self._flushing--;
      self.emit('file', part.name, file);
      self._maybeEnd();
    });
  });
};

function dummyParser(self) {
  return {
    end: function () {
      self.ended = true;
      self._maybeEnd();
      return null;
    }
  };
}

IncomingForm.prototype._parseContentType = function() {
  if (this.bytesExpected === 0) {
    this._parser = dummyParser(this);
    return;
  }

  if (!this.headers['content-type']) {
    this._error(new Error('bad content-type header, no content-type'));
    return;
  }

  if (this.headers['content-type'].match(/octet-stream/i)) {
    this._initOctetStream();
    return;
  }

  if (this.headers['content-type'].match(/urlencoded/i)) {
    this._initUrlencoded();
    return;
  }

  if (this.headers['content-type'].match(/multipart/i)) {
    var m = this.headers['content-type'].match(/boundary=(?:"([^"]+)"|([^;]+))/i);
    if (m) {
      this._initMultipart(m[1] || m[2]);
    } else {
      this._error(new Error('bad content-type header, no multipart boundary'));
    }
    return;
  }

  if (this.headers['content-type'].match(/json/i)) {
    this._initJSONencoded();
    return;
  }

  this._error(new Error('bad content-type header, unknown content-type: '+this.headers['content-type']));
};

IncomingForm.prototype._error = function(err) {
  if (this.error || this.ended) {
    return;
  }

  this.error = err;
  this.emit('error', err);

  if (Array.isArray(this.openedFiles)) {
    this.openedFiles.forEach(function(file) {
      file._writeStream.destroy();
      setTimeout(fs.unlink, 0, file.path, function(error) { });
    });
  }
};

IncomingForm.prototype._parseContentLength = function() {
  this.bytesReceived = 0;
  if (this.headers['content-length']) {
    this.bytesExpected = parseInt(this.headers['content-length'], 10);
  } else if (this.headers['transfer-encoding'] === undefined) {
    this.bytesExpected = 0;
  }

  if (this.bytesExpected !== null) {
    this.emit('progress', this.bytesReceived, this.bytesExpected);
  }
};

IncomingForm.prototype._newParser = function() {
  return new MultipartParser();
};

IncomingForm.prototype._initMultipart = function(boundary) {
  this.type = 'multipart';

  var parser = new MultipartParser(),
      self = this,
      headerField,
      headerValue,
      part;

  parser.initWithBoundary(boundary);

  parser.onPartBegin = function() {
    part = new Stream();
    part.readable = true;
    part.headers = {};
    part.name = null;
    part.filename = null;
    part.mime = null;

    part.transferEncoding = 'binary';
    part.transferBuffer = '';

    headerField = '';
    headerValue = '';
  };

  parser.onHeaderField = function(b, start, end) {
    headerField += b.toString(self.encoding, start, end);
  };

  parser.onHeaderValue = function(b, start, end) {
    headerValue += b.toString(self.encoding, start, end);
  };

  parser.onHeaderEnd = function() {
    headerField = headerField.toLowerCase();
    part.headers[headerField] = headerValue;

    var m = headerValue.match(/\bname="([^"]+)"/i);
    if (headerField == 'content-disposition') {
      if (m) {
        part.name = m[1];
      }

      part.filename = self._fileName(headerValue);
    } else if (headerField == 'content-type') {
      part.mime = headerValue;
    } else if (headerField == 'content-transfer-encoding') {
      part.transferEncoding = headerValue.toLowerCase();
    }

    headerField = '';
    headerValue = '';
  };

  parser.onHeadersEnd = function() {
    switch(part.transferEncoding){
      case 'binary':
      case '7bit':
      case '8bit':
      parser.onPartData = function(b, start, end) {
        part.emit('data', b.slice(start, end));
      };

      parser.onPartEnd = function() {
        part.emit('end');
      };
      break;

      case 'base64':
      parser.onPartData = function(b, start, end) {
        part.transferBuffer += b.slice(start, end).toString('ascii');

        /*
        four bytes (chars) in base64 converts to three bytes in binary
        encoding. So we should always work with a number of bytes that
        can be divided by 4, it will result in a number of buytes that
        can be divided vy 3.
        */
        var offset = parseInt(part.transferBuffer.length / 4, 10) * 4;
        part.emit('data', new Buffer(part.transferBuffer.substring(0, offset), 'base64'));
        part.transferBuffer = part.transferBuffer.substring(offset);
      };

      parser.onPartEnd = function() {
        part.emit('data', new Buffer(part.transferBuffer, 'base64'));
        part.emit('end');
      };
      break;

      default:
      return self._error(new Error('unknown transfer-encoding'));
    }

    self.onPart(part);
  };


  parser.onEnd = function() {
    self.ended = true;
    self._maybeEnd();
  };

  this._parser = parser;
};

IncomingForm.prototype._fileName = function(headerValue) {
  var m = headerValue.match(/\bfilename="(.*?)"($|; )/i);
  if (!m) return;

  var filename = m[1].substr(m[1].lastIndexOf('\\') + 1);
  filename = filename.replace(/%22/g, '"');
  filename = filename.replace(/&#([\d]{4});/g, function(m, code) {
    return String.fromCharCode(code);
  });
  return filename;
};

IncomingForm.prototype._initUrlencoded = function() {
  this.type = 'urlencoded';

  var parser = new QuerystringParser(this.maxFields)
    , self = this;

  parser.onField = function(key, val) {
    self.emit('field', key, val);
  };

  parser.onEnd = function() {
    self.ended = true;
    self._maybeEnd();
  };

  this._parser = parser;
};

IncomingForm.prototype._initOctetStream = function() {
  this.type = 'octet-stream';
  var filename = this.headers['x-file-name'];
  var mime = this.headers['content-type'];

  var file = new File({
    path: this._uploadPath(filename),
    name: filename,
    type: mime
  });

  this.emit('fileBegin', filename, file);
  file.open();

  this._flushing++;

  var self = this;

  self._parser = new OctetParser();

  //Keep track of writes that haven't finished so we don't emit the file before it's done being written
  var outstandingWrites = 0;

  self._parser.on('data', function(buffer){
    self.pause();
    outstandingWrites++;

    file.write(buffer, function() {
      outstandingWrites--;
      self.resume();

      if(self.ended){
        self._parser.emit('doneWritingFile');
      }
    });
  });

  self._parser.on('end', function(){
    self._flushing--;
    self.ended = true;

    var done = function(){
      file.end(function() {
        self.emit('file', 'file', file);
        self._maybeEnd();
      });
    };

    if(outstandingWrites === 0){
      done();
    } else {
      self._parser.once('doneWritingFile', done);
    }
  });
};

IncomingForm.prototype._initJSONencoded = function() {
  this.type = 'json';

  var parser = new JSONParser()
    , self = this;

  if (this.bytesExpected) {
    parser.initWithLength(this.bytesExpected);
  }

  parser.onField = function(key, val) {
    self.emit('field', key, val);
  };

  parser.onEnd = function() {
    self.ended = true;
    self._maybeEnd();
  };

  this._parser = parser;
};

IncomingForm.prototype._uploadPath = function(filename) {
  var name = 'upload_';
  var buf = crypto.randomBytes(16);
  for (var i = 0; i < buf.length; ++i) {
    name += ('0' + buf[i].toString(16)).slice(-2);
  }

  if (this.keepExtensions) {
    var ext = path.extname(filename);
    ext     = ext.replace(/(\.[a-z0-9]+).*/i, '$1');

    name += ext;
  }

  return path.join(this.uploadDir, name);
};

IncomingForm.prototype._maybeEnd = function() {
  if (!this.ended || this._flushing || this.error) {
    return;
  }

  this.emit('end');
};


},{"./file":4,"./json_parser":7,"./multipart_parser":8,"./octet_parser":9,"./querystring_parser":10,"crypto":undefined,"events":undefined,"fs":undefined,"os":undefined,"path":undefined,"stream":undefined,"string_decoder":undefined,"util":undefined}],6:[function(require,module,exports){
var IncomingForm = require('./incoming_form').IncomingForm;
IncomingForm.IncomingForm = IncomingForm;
module.exports = IncomingForm;

},{"./incoming_form":5}],7:[function(require,module,exports){
if (global.GENTLY) require = GENTLY.hijack(require);

var Buffer = require('buffer').Buffer;

function JSONParser() {
  this.data = new Buffer('');
  this.bytesWritten = 0;
}
exports.JSONParser = JSONParser;

JSONParser.prototype.initWithLength = function(length) {
  this.data = new Buffer(length);
};

JSONParser.prototype.write = function(buffer) {
  if (this.data.length >= this.bytesWritten + buffer.length) {
    buffer.copy(this.data, this.bytesWritten);
  } else {
    this.data = Buffer.concat([this.data, buffer]);
  }
  this.bytesWritten += buffer.length;
  return buffer.length;
};

JSONParser.prototype.end = function() {
  try {
    var fields = JSON.parse(this.data.toString('utf8'));
    for (var field in fields) {
      this.onField(field, fields[field]);
    }
  } catch (e) {}
  this.data = null;

  this.onEnd();
};

},{"buffer":undefined}],8:[function(require,module,exports){
var Buffer = require('buffer').Buffer,
    s = 0,
    S =
    { PARSER_UNINITIALIZED: s++,
      START: s++,
      START_BOUNDARY: s++,
      HEADER_FIELD_START: s++,
      HEADER_FIELD: s++,
      HEADER_VALUE_START: s++,
      HEADER_VALUE: s++,
      HEADER_VALUE_ALMOST_DONE: s++,
      HEADERS_ALMOST_DONE: s++,
      PART_DATA_START: s++,
      PART_DATA: s++,
      PART_END: s++,
      END: s++
    },

    f = 1,
    F =
    { PART_BOUNDARY: f,
      LAST_BOUNDARY: f *= 2
    },

    LF = 10,
    CR = 13,
    SPACE = 32,
    HYPHEN = 45,
    COLON = 58,
    A = 97,
    Z = 122,

    lower = function(c) {
      return c | 0x20;
    };

for (s in S) {
  exports[s] = S[s];
}

function MultipartParser() {
  this.boundary = null;
  this.boundaryChars = null;
  this.lookbehind = null;
  this.state = S.PARSER_UNINITIALIZED;

  this.index = null;
  this.flags = 0;
}
exports.MultipartParser = MultipartParser;

MultipartParser.stateToString = function(stateNumber) {
  for (var state in S) {
    var number = S[state];
    if (number === stateNumber) return state;
  }
};

MultipartParser.prototype.initWithBoundary = function(str) {
  this.boundary = new Buffer(str.length+4);
  this.boundary.write('\r\n--', 0);
  this.boundary.write(str, 4);
  this.lookbehind = new Buffer(this.boundary.length+8);
  this.state = S.START;

  this.boundaryChars = {};
  for (var i = 0; i < this.boundary.length; i++) {
    this.boundaryChars[this.boundary[i]] = true;
  }
};

MultipartParser.prototype.write = function(buffer) {
  var self = this,
      i = 0,
      len = buffer.length,
      prevIndex = this.index,
      index = this.index,
      state = this.state,
      flags = this.flags,
      lookbehind = this.lookbehind,
      boundary = this.boundary,
      boundaryChars = this.boundaryChars,
      boundaryLength = this.boundary.length,
      boundaryEnd = boundaryLength - 1,
      bufferLength = buffer.length,
      c,
      cl,

      mark = function(name) {
        self[name+'Mark'] = i;
      },
      clear = function(name) {
        delete self[name+'Mark'];
      },
      callback = function(name, buffer, start, end) {
        if (start !== undefined && start === end) {
          return;
        }

        var callbackSymbol = 'on'+name.substr(0, 1).toUpperCase()+name.substr(1);
        if (callbackSymbol in self) {
          self[callbackSymbol](buffer, start, end);
        }
      },
      dataCallback = function(name, clear) {
        var markSymbol = name+'Mark';
        if (!(markSymbol in self)) {
          return;
        }

        if (!clear) {
          callback(name, buffer, self[markSymbol], buffer.length);
          self[markSymbol] = 0;
        } else {
          callback(name, buffer, self[markSymbol], i);
          delete self[markSymbol];
        }
      };

  for (i = 0; i < len; i++) {
    c = buffer[i];
    switch (state) {
      case S.PARSER_UNINITIALIZED:
        return i;
      case S.START:
        index = 0;
        state = S.START_BOUNDARY;
      case S.START_BOUNDARY:
        if (index == boundary.length - 2) {
          if (c == HYPHEN) {
            flags |= F.LAST_BOUNDARY;
          } else if (c != CR) {
            return i;
          }
          index++;
          break;
        } else if (index - 1 == boundary.length - 2) {
          if (flags & F.LAST_BOUNDARY && c == HYPHEN){
            callback('end');
            state = S.END;
            flags = 0;
          } else if (!(flags & F.LAST_BOUNDARY) && c == LF) {
            index = 0;
            callback('partBegin');
            state = S.HEADER_FIELD_START;
          } else {
            return i;
          }
          break;
        }

        if (c != boundary[index+2]) {
          index = -2;
        }
        if (c == boundary[index+2]) {
          index++;
        }
        break;
      case S.HEADER_FIELD_START:
        state = S.HEADER_FIELD;
        mark('headerField');
        index = 0;
      case S.HEADER_FIELD:
        if (c == CR) {
          clear('headerField');
          state = S.HEADERS_ALMOST_DONE;
          break;
        }

        index++;
        if (c == HYPHEN) {
          break;
        }

        if (c == COLON) {
          if (index == 1) {
            // empty header field
            return i;
          }
          dataCallback('headerField', true);
          state = S.HEADER_VALUE_START;
          break;
        }

        cl = lower(c);
        if (cl < A || cl > Z) {
          return i;
        }
        break;
      case S.HEADER_VALUE_START:
        if (c == SPACE) {
          break;
        }

        mark('headerValue');
        state = S.HEADER_VALUE;
      case S.HEADER_VALUE:
        if (c == CR) {
          dataCallback('headerValue', true);
          callback('headerEnd');
          state = S.HEADER_VALUE_ALMOST_DONE;
        }
        break;
      case S.HEADER_VALUE_ALMOST_DONE:
        if (c != LF) {
          return i;
        }
        state = S.HEADER_FIELD_START;
        break;
      case S.HEADERS_ALMOST_DONE:
        if (c != LF) {
          return i;
        }

        callback('headersEnd');
        state = S.PART_DATA_START;
        break;
      case S.PART_DATA_START:
        state = S.PART_DATA;
        mark('partData');
      case S.PART_DATA:
        prevIndex = index;

        if (index === 0) {
          // boyer-moore derrived algorithm to safely skip non-boundary data
          i += boundaryEnd;
          while (i < bufferLength && !(buffer[i] in boundaryChars)) {
            i += boundaryLength;
          }
          i -= boundaryEnd;
          c = buffer[i];
        }

        if (index < boundary.length) {
          if (boundary[index] == c) {
            if (index === 0) {
              dataCallback('partData', true);
            }
            index++;
          } else {
            index = 0;
          }
        } else if (index == boundary.length) {
          index++;
          if (c == CR) {
            // CR = part boundary
            flags |= F.PART_BOUNDARY;
          } else if (c == HYPHEN) {
            // HYPHEN = end boundary
            flags |= F.LAST_BOUNDARY;
          } else {
            index = 0;
          }
        } else if (index - 1 == boundary.length)  {
          if (flags & F.PART_BOUNDARY) {
            index = 0;
            if (c == LF) {
              // unset the PART_BOUNDARY flag
              flags &= ~F.PART_BOUNDARY;
              callback('partEnd');
              callback('partBegin');
              state = S.HEADER_FIELD_START;
              break;
            }
          } else if (flags & F.LAST_BOUNDARY) {
            if (c == HYPHEN) {
              callback('partEnd');
              callback('end');
              state = S.END;
              flags = 0;
            } else {
              index = 0;
            }
          } else {
            index = 0;
          }
        }

        if (index > 0) {
          // when matching a possible boundary, keep a lookbehind reference
          // in case it turns out to be a false lead
          lookbehind[index-1] = c;
        } else if (prevIndex > 0) {
          // if our boundary turned out to be rubbish, the captured lookbehind
          // belongs to partData
          callback('partData', lookbehind, 0, prevIndex);
          prevIndex = 0;
          mark('partData');

          // reconsider the current character even so it interrupted the sequence
          // it could be the beginning of a new sequence
          i--;
        }

        break;
      case S.END:
        break;
      default:
        return i;
    }
  }

  dataCallback('headerField');
  dataCallback('headerValue');
  dataCallback('partData');

  this.index = index;
  this.state = state;
  this.flags = flags;

  return len;
};

MultipartParser.prototype.end = function() {
  var callback = function(self, name) {
    var callbackSymbol = 'on'+name.substr(0, 1).toUpperCase()+name.substr(1);
    if (callbackSymbol in self) {
      self[callbackSymbol]();
    }
  };
  if ((this.state == S.HEADER_FIELD_START && this.index === 0) ||
      (this.state == S.PART_DATA && this.index == this.boundary.length)) {
    callback(this, 'partEnd');
    callback(this, 'end');
  } else if (this.state != S.END) {
    return new Error('MultipartParser.end(): stream ended unexpectedly: ' + this.explain());
  }
};

MultipartParser.prototype.explain = function() {
  return 'state = ' + MultipartParser.stateToString(this.state);
};

},{"buffer":undefined}],9:[function(require,module,exports){
var EventEmitter = require('events').EventEmitter
	, util = require('util');

function OctetParser(options){
	if(!(this instanceof OctetParser)) return new OctetParser(options);
	EventEmitter.call(this);
}

util.inherits(OctetParser, EventEmitter);

exports.OctetParser = OctetParser;

OctetParser.prototype.write = function(buffer) {
    this.emit('data', buffer);
	return buffer.length;
};

OctetParser.prototype.end = function() {
	this.emit('end');
};

},{"events":undefined,"util":undefined}],10:[function(require,module,exports){
if (global.GENTLY) require = GENTLY.hijack(require);

// This is a buffering parser, not quite as nice as the multipart one.
// If I find time I'll rewrite this to be fully streaming as well
var querystring = require('querystring');

function QuerystringParser(maxKeys) {
  this.maxKeys = maxKeys;
  this.buffer = '';
}
exports.QuerystringParser = QuerystringParser;

QuerystringParser.prototype.write = function(buffer) {
  this.buffer += buffer.toString('ascii');
  return buffer.length;
};

QuerystringParser.prototype.end = function() {
  var fields = querystring.parse(this.buffer, '&', '=', { maxKeys: this.maxKeys });
  for (var field in fields) {
    this.onField(field, fields[field]);
  }
  this.buffer = '';

  this.onEnd();
};


},{"querystring":undefined}],11:[function(require,module,exports){
//console.log("!!!!!!!!!!!!!!!! WARNING THIS IS GUN 0.5 !!!!!!!!!!!!!!!!!!!!!!");
;(function(){

	/* UNBUILD */
	var root;
	if(typeof window !== "undefined"){ root = window }
	if(typeof global !== "undefined"){ root = global }
	root = root || {};
	var console = root.console = root.console || {log: function(){}};
	function require(arg){
		return arg.slice? require[resolve(arg)] : function(mod, path){
			arg(mod = {exports: {}});
			require[resolve(path)] = mod.exports;
		}
		function resolve(path){
			return path.split('/').slice(-1).toString().replace('.js','');
		}
	}
	if(typeof module !== "undefined"){ var common = module }
	/* UNBUILD */

	;require(function(module){
		// Generic javascript utilities.
		var Type = {};
		Type.fns = Type.fn = {is: function(fn){ return (!!fn && fn instanceof Function) }}
		Type.bi = {is: function(b){ return (b instanceof Boolean || typeof b == 'boolean') }}
		Type.num = {is: function(n){ return !list_is(n) && ((n - parseFloat(n) + 1) >= 0 || Infinity === n || -Infinity === n) }}
		Type.text = {is: function(t){ return (typeof t == 'string') }}
		Type.text.ify = function(t){
			if(Type.text.is(t)){ return t }
			if(typeof JSON !== "undefined"){ return JSON.stringify(t) }
			return (t && t.toString)? t.toString() : t;
		}
		Type.text.random = function(l, c){
			var s = '';
			l = l || 24; // you are not going to make a 0 length random number, so no need to check type
			c = c || '0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz';
			while(l > 0){ s += c.charAt(Math.floor(Math.random() * c.length)); l-- }
			return s;
		}
		Type.text.match = function(t, o){ var r = false;
			t = t || '';
			o = Type.text.is(o)? {'=': o} : o || {}; // {'~', '=', '*', '<', '>', '+', '-', '?', '!'} // ignore case, exactly equal, anything after, lexically larger, lexically lesser, added in, subtacted from, questionable fuzzy match, and ends with.
			if(Type.obj.has(o,'~')){ t = t.toLowerCase(); o['='] = (o['='] || o['~']).toLowerCase() }
			if(Type.obj.has(o,'=')){ return t === o['='] }
			if(Type.obj.has(o,'*')){ if(t.slice(0, o['*'].length) === o['*']){ r = true; t = t.slice(o['*'].length) } else { return false }}
			if(Type.obj.has(o,'!')){ if(t.slice(-o['!'].length) === o['!']){ r = true } else { return false }}
			if(Type.obj.has(o,'+')){
				if(Type.list.map(Type.list.is(o['+'])? o['+'] : [o['+']], function(m){
					if(t.indexOf(m) >= 0){ r = true } else { return true }
				})){ return false }
			}
			if(Type.obj.has(o,'-')){
				if(Type.list.map(Type.list.is(o['-'])? o['-'] : [o['-']], function(m){
					if(t.indexOf(m) < 0){ r = true } else { return true }
				})){ return false }
			}
			if(Type.obj.has(o,'>')){ if(t > o['>']){ r = true } else { return false }}
			if(Type.obj.has(o,'<')){ if(t < o['<']){ r = true } else { return false }}
			function fuzzy(t,f){ var n = -1, i = 0, c; for(;c = f[i++];){ if(!~(n = t.indexOf(c, n+1))){ return false }} return true } // via http://stackoverflow.com/questions/9206013/javascript-fuzzy-search
			if(Type.obj.has(o,'?')){ if(fuzzy(t, o['?'])){ r = true } else { return false }} // change name!
			return r;
		}
		Type.list = {is: function(l){ return (l instanceof Array) }}
		Type.list.slit = Array.prototype.slice;
		Type.list.sort = function(k){ // creates a new sort function based off some field
			return function(A,B){
				if(!A || !B){ return 0 } A = A[k]; B = B[k];
				if(A < B){ return -1 }else if(A > B){ return 1 }
				else { return 0 }
			}
		}
		Type.list.map = function(l, c, _){ return obj_map(l, c, _) }
		Type.list.index = 1; // change this to 0 if you want non-logical, non-mathematical, non-matrix, non-convenient array notation
		Type.obj = {is: function(o){ return o? (o instanceof Object && o.constructor === Object) || Object.prototype.toString.call(o).match(/^\[object (\w+)\]$/)[1] === 'Object' : false }}
		Type.obj.put = function(o, f, v){ return (o||{})[f] = v, o } 
		Type.obj.has = function(o, f){ return o && Object.prototype.hasOwnProperty.call(o, f) }
		Type.obj.del = function(o, k){
			if(!o){ return }
			o[k] = null;
			delete o[k];
			return o;
		}
		Type.obj.as = function(o, f, v){ return o[f] = o[f] || (arguments.length >= 3? v : {}) }
		Type.obj.ify = function(o){
			if(obj_is(o)){ return o }
			try{o = JSON.parse(o);
			}catch(e){o={}};
			return o;
		}
		;(function(){ var u;
			function map(v,f){
				if(obj_has(this,f) && u !== this[f]){ return }
				this[f] = v;
			}
			Type.obj.to = function(from, to){
				to = to || {};
				obj_map(from, map, to);
				return to;
			}
		}());
		Type.obj.copy = function(o){ // because http://web.archive.org/web/20140328224025/http://jsperf.com/cloning-an-object/2
			return !o? o : JSON.parse(JSON.stringify(o)); // is shockingly faster than anything else, and our data has to be a subset of JSON anyways!
		}
		;(function(){
			function empty(v,i){ var n = this.n;
				if(n && (i === n || (obj_is(n) && obj_has(n, i)))){ return }
				if(i){ return true }
			}
			Type.obj.empty = function(o, n){
				if(!o){ return true }
				return obj_map(o,empty,{n:n})? false : true;
			}
		}());
		;(function(){
			function t(k,v){
				if(2 === arguments.length){
					t.r = t.r || {};
					t.r[k] = v;
					return;
				} t.r = t.r || [];
				t.r.push(k);
			};
			Type.obj.map = function(l, c, _){
				var u, i = 0, x, r, ll, lle, f = fn_is(c);
				t.r = null;
				if(Object.keys && obj_is(l)){
					ll = Object.keys(l); lle = true;
				}
				if(list_is(l) || ll){
					x = (ll || l).length;
					for(;i < x; i++){
						var ii = (i + Type.list.index);
						if(f){
							r = lle? c.call(_ || this, l[ll[i]], ll[i], t) : c.call(_ || this, l[i], ii, t);
							if(r !== u){ return r }
						} else {
							//if(Type.test.is(c,l[i])){ return ii } // should implement deep equality testing!
							if(c === l[lle? ll[i] : i]){ return ll? ll[i] : ii } // use this for now
						}
					}
				} else {
					for(i in l){
						if(f){
							if(obj_has(l,i)){
								r = _? c.call(_, l[i], i, t) : c(l[i], i, t);
								if(r !== u){ return r }
							}
						} else {
							//if(a.test.is(c,l[i])){ return i } // should implement deep equality testing!
							if(c === l[i]){ return i } // use this for now
						}
					}
				}
				return f? t.r : Type.list.index? 0 : -1;
			}
		}());
		Type.time = {};
		Type.time.is = function(t){ return t? t instanceof Date : (+new Date().getTime()) }

		var fn_is = Type.fn.is;
		var list_is = Type.list.is;
		var obj = Type.obj, obj_is = obj.is, obj_has = obj.has, obj_map = obj.map;
		module.exports = Type;
	})(require, './type');
		
	;require(function(module){
		// On event emitter generic javascript utility.
		function Scope(){
			function On(tag, arg, as, eas, skip){
				var ctx = this, ons = ctx.ons || (ctx.ons = {}), on = ons[tag] || (ons[tag] = {s: []}), act, mem, O = On.ons;
				if(!arg){
					if(1 === arguments.length){ // Performance drops significantly even though `arguments.length` should be okay to use.
						return on;
					}
				}
				if(arg instanceof Function){
					act = new Act(tag, arg, as, on, ctx);
					if(O && O.event && ctx !== On){
						On.on('event', act);
						if(noop === act.fn){
							return act;
						}
						if(-1 < act.i){ return act }
					}
					on.s.push(act);
					return act;
				}
				var proxy;
				if(O && O.emit && ctx !== On){
					var ev = {tag: tag, arg: arg, on: on, ctx: ctx}, u;
					On.on('emit', ev);
					if(u === ev.arg){ return }
					arg = ev.arg;
					proxy = ev.proxy;
				}
				on.arg = arg;
				on.end = as;
				on.as = eas;
				var i = 0, acts = on.s, l = acts.length, arr = (arg instanceof Array), gap, off, act;
				for(; i < l; i++){ act = acts[i];
					if(skip){
						if(skip === act){
							skip = false;
						}
						continue;
					}
					var tmp = act.tmp = {};
					if(!arr){
						act.fn.call(act.as, arg, proxy||act);
					} else {
						act.fn.apply(act.as, arg.concat(proxy||act));
					}
					if(noop === act.fn){
						off = true;
					}
					if(tmp.halt){
						if(1 === tmp.halt){
							gap = true;
						}
						break;
					}
				}
				if(off){
					var still = [];
					for(i = 0; i < l; i++){ act = acts[i];
						if(noop !== act.fn){
							still.push(act);
						}
					}
					on.s = still;
					if(0 === still.length){
						delete ons[tag];
					}
				}
				if(!gap && as && as instanceof Function){
					as.call(eas, arg);
				}
				return;
			}
			On.on = On;
			On.scope = Scope;
			return On;
		}
		function Act(tag, fn, as, on, ctx){
			this.tag = tag;
			this.fn = fn;
			this.as = as;
			this.on = on;
			this.ctx = ctx;
		}
		Act.chain = Act.prototype;
		Act.chain.stun = function(){
			if(!this.tmp){ this.tmp = {} }
			if(!arguments.length){
				return this.tmp.halt = true;
			}
			var act = this, on = act.on, halt = {
				resume: function(arg){
					/*
						TODO: BUG!
						TODO: BUG!
						TODO: BUG!
						TODO: BUG!
						TODO: BUG!
						Why does our map not get updates?
						Portions do if we do not use .key to save the initial data.
						Which makes me think it relates to pseudo, however it doesn't fully work if I get rid of that.
						Why why why? Probably something to do with map events and memoizing?
					*/
					act.ctx.on(act.tag, (arguments.length?
						1 === arguments.length? arg : Array.prototype.slice.call(arguments)
					: halt.arg), halt.end, halt.as, act);
				}, arg: on.arg,
				end: on.end,
				as: on.as
			};
			act.tmp.halt = 1;
			return halt.resume;
		}
		Act.chain.off = function(){
			this.fn = noop;
		}
		Act.chain.emit = function(arg){
			var act = this, arr = (arg instanceof Array);
			if(!arr){
				act.fn.call(act.as, arg, act);
			} else {
				act.fn.apply(act.as, arg.concat(act));
			}
		}
		function noop(){};
		module.exports = Scope();
	})(require, './on');

	;require(function(module){
		var On = require('./on');
		
		function Chain(create, opt){
			opt = opt || {};
			opt.id = opt.id || '#';
			opt.rid = opt.rid || '@';
			opt.uuid = opt.uuid || function(){
				return (+new Date()) + Math.random();
			};
			var on = On.scope();

			on.stun = function(chain, fn, as){
				var res = function(n){
					if(1 === n){
						at.stun.skip = 1;
						return;
					}
					if(at.stun === stun){
						delete at.stun;	
					}
					off = true;
					var i = 0, q = res.queue, l = q.length, c, v;
					for(i; i < l; i++){ v = q[i];
						c = v[0];
						v = v[1];
						c.on('in', v.get, v);
					}
				}, at = chain._, off, stun = at.stun = function(arg){
					if(off){
						delete this.stun;
						return false;
					}
					if(at.stun.skip){
						return at.stun.skip = false;
					}
					res.queue.push([this, arg]);
					return true;
				}
				res.queue = [];
				return res;
			}

			var ask = on.ask = function(cb, as){
				if(!ask.on){ ask.on = On.scope() }
				var id = opt.uuid();
				if(cb){ ask.on(id, cb, as) }
				return id;
			}
			ask._ = opt.id;
			on.ack = function(at, reply){
				if(!at || !reply || !ask.on){ return }
				var id = at[opt.id] || at;
				ask.on(id, reply);
				return true;
			}
			on.ack._ = opt.rid;
			/*
			on.on('event', function event(act){
				var last = act.on.last, tmp;
				if(last){
					if(last instanceof Array){
						act.fn.apply(act.as, last.concat(act));
					} else {
						act.fn.call(act.as, last, act);
					}
					if(last !== act.on.last){
						event(act);
					}
					return;
				}
			});*/

			on.on('event', function event(act){
				var last = act.on.last, tmp;
				if(last){
					if(act.on.map){
						Gun.obj.map(act.on.map, function(v,f){ // TODO: BUG! Gun is not available in this module.
							//emit(v[0], act, event, v[1]); // below enables more control
							emit(v[1], act, event, v[2]);
						});
					} else {
						emit(last, act, event);
					}
					if(last !== act.on.last){
						event(act);
					}
					return;
				}
			});
			function emit(last, act, event, ev){
				if(last instanceof Array){
					act.fn.apply(act.as, last.concat(ev||act));
				} else {
					act.fn.call(act.as, last, ev||act);
				}
			}

			on.on('emit', function(ev){
				if(ev.on.map){
					/*
					ev.id = ev.id || Gun.text.random(6);
					ev.on.map[ev.id] = ev.arg;
					ev.proxy = ev.arg[1];
					ev.arg = ev.arg[0];
					*/ // below gives more control.
					ev.on.map[ev.arg[0]] = ev.arg;
					ev.proxy = ev.arg[2];
					ev.arg = ev.arg[1];
				}
				ev.on.last = ev.arg;
			});
			return on;
		}
		/*
		function backward(scope, ev){ var tmp;
			if(!scope || !scope.on){ return }
			//if(scope.on('back').length){
			if((tmp = scope.ons) && (tmp = tmp[ev]) && tmp.s.length){
				return scope;
			}
			return backward((scope.back||backward)._, ev);
		}
		*/
		module.exports = Chain;
	})(require, './onify');

	;require(function(module){
		// Generic javascript scheduler utility.
		var Type = require('./type');
		function s(state, cb, time){ // maybe use lru-cache?
			s.time = time || Gun.time.is;
			s.waiting.push({when: state, event: cb || function(){}});
			if(s.soonest < state){ return }
			s.set(state);
		}
		s.waiting = [];
		s.soonest = Infinity;
		s.sort = Type.list.sort('when');
		s.set = function(future){
			if(Infinity <= (s.soonest = future)){ return }
			var now = s.time();
			future = (future <= now)? 0 : (future - now);
			clearTimeout(s.id);
			s.id = setTimeout(s.check, future);
		}
		s.each = function(wait, i, map){
			var ctx = this;
			if(!wait){ return }
			if(wait.when <= ctx.now){
				if(wait.event instanceof Function){
					setTimeout(function(){ wait.event() },0);
				}
			} else {
				ctx.soonest = (ctx.soonest < wait.when)? ctx.soonest : wait.when;
				map(wait);
			}
		}
		s.check = function(){
			var ctx = {now: s.time(), soonest: Infinity};
			s.waiting.sort(s.sort);
			s.waiting = Type.list.map(s.waiting, s.each, ctx) || [];
			s.set(ctx.soonest);
		}
		module.exports = s;
	})(require, './schedule');

	;require(function(module){
		/* Based on the Hypothetical Amnesia Machine thought experiment */
		function HAM(machineState, incomingState, currentState, incomingValue, currentValue){
			if(machineState < incomingState){
				return {defer: true}; // the incoming value is outside the boundary of the machine's state, it must be reprocessed in another state.
			}
			if(incomingState < currentState){
				return {historical: true}; // the incoming value is within the boundary of the machine's state, but not within the range.
				
			}
			if(currentState < incomingState){
				return {converge: true, incoming: true}; // the incoming value is within both the boundary and the range of the machine's state.
				
			}
			if(incomingState === currentState){
				if(incomingValue === currentValue){ // Note: while these are practically the same, the deltas could be technically different
					return {state: true};
				}
				/*
					The following is a naive implementation, but will always work.
					Never change it unless you have specific needs that absolutely require it.
					If changed, your data will diverge unless you guarantee every peer's algorithm has also been changed to be the same.
					As a result, it is highly discouraged to modify despite the fact that it is naive,
					because convergence (data integrity) is generally more important.
					Any difference in this algorithm must be given a new and different name.
				*/
				if(Lexical(incomingValue) < Lexical(currentValue)){ // Lexical only works on simple value types!
					return {converge: true, current: true};
				}
				if(Lexical(currentValue) < Lexical(incomingValue)){ // Lexical only works on simple value types!
					return {converge: true, incoming: true};
				}
			}
			return {err: "you have not properly handled recursion through your data or filtered it as JSON"};
		}
		function Lexical(value){
			// TODO: BUG! HAM should understand a relation (pointer) as a type as well.
			if(typeof value === 'string'){ // Text
				return 'aaaaa'+value;
			}
			if((value - parseFloat(value) + 1) >= 0){ // Numbers (JSON-able)
				return 'aaaa'+value;
			}
			if(true === value){ // Boolean
				return 'aaa';
			}
			if(false === value){ // Boolean
				return 'aa';
			}
			if(null === value){ // Null
				return 'a';
			}
			if(undefined === value){ // Undefined
				return '';
			}
			return ''; // Not supported
		}
		var undefined;
		module.exports = HAM;
	})(require, './HAM');

	;require(function(module){
		var Type = require('./type');
		var Val = {};
		Val.is = function(v){ // Valid values are a subset of JSON: null, binary, number (!Infinity), text, or a soul relation. Arrays need special algorithms to handle concurrency, so they are not supported directly. Use an extension that supports them if needed but research their problems first.
			var u;
			if(v === u){ return false }
			if(v === null){ return true } // "deletes", nulling out fields.
			if(v === Infinity){ return false } // we want this to be, but JSON does not support it, sad face.
			if(bi_is(v) // by "binary" we mean boolean.
			|| num_is(v)
			|| text_is(v)){ // by "text" we mean strings.
				return true; // simple values are valid.
			}
			return Val.rel.is(v) || false; // is the value a soul relation? Then it is valid and return it. If not, everything else remaining is an invalid data type. Custom extensions can be built on top of these primitives to support other types.
		}
		Val.rel = {_: '#'};
		;(function(){
			Val.rel.is = function(v){ // this defines whether an object is a soul relation or not, they look like this: {'#': 'UUID'}
				if(v && !v._ && obj_is(v)){ // must be an object.
					var o = {};
					obj_map(v, map, o);
					if(o.id){ // a valid id was found.
						return o.id; // yay! Return it.
					}
				}
				return false; // the value was not a valid soul relation.
			}
			function map(s, f){ var o = this; // map over the object...
				if(o.id){ return o.id = false } // if ID is already defined AND we're still looping through the object, it is considered invalid.
				if(f == _rel && text_is(s)){ // the field should be '#' and have a text value.
					o.id = s; // we found the soul!
				} else {
					return o.id = false; // if there exists anything else on the object that isn't the soul, then it is considered invalid.
				}
			}
		}());
		Val.rel.ify = function(t){ return obj_put({}, _rel, t) } // convert a soul into a relation and return it.
		var _rel = Val.rel._;
		var bi_is = Type.bi.is;
		var num_is = Type.num.is;
		var text_is = Type.text.is;
		var obj = Type.obj, obj_is = obj.is, obj_put = obj.put, obj_map = obj.map;
		module.exports = Val;
	})(require, './val');

	;require(function(module){
		var Type = require('./type');
		var Val = require('./val');
		var Node = {_: '_'};
		Node.soul = function(n, o){ return (n && n._ && n._[o || _soul]) } // convenience function to check to see if there is a soul on a node and return it.
		Node.soul.ify = function(n, o){ // put a soul on an object.
			o = (typeof o === 'string')? {soul: o} : o || {};
			n = n || {}; // make sure it exists.
			n._ = n._ || {}; // make sure meta exists.
			n._[_soul] = o.soul || n._[_soul] || text_random(); // put the soul on it.
			return n;
		}
		;(function(){
			Node.is = function(n, cb, o){ var s; // checks to see if an object is a valid node.
				if(!obj_is(n)){ return false } // must be an object.
				if(s = Node.soul(n)){ // must have a soul on it.
					return !obj_map(n, map, {o:o,n:n,cb:cb});
				}
				return false; // nope! This was not a valid node.
			}
			function map(v, f){ // we invert this because the way we check for this is via a negation.
				if(f === Node._){ return } // skip over the metadata.
				if(!Val.is(v)){ return true } // it is true that this is an invalid node.
				if(this.cb){ this.cb.call(this.o, v, f, this.n) } // optionally callback each field/value.
			}
		}());
		;(function(){
			Node.ify = function(obj, o, as){ // returns a node from a shallow object.
				if(!o){ o = {} }
				else if(typeof o === 'string'){ o = {soul: o} }
				else if(o instanceof Function){ o = {map: o} }
				if(o.map){ o.node = o.map.call(as, obj, u, o.node || {}) }
				if(o.node = Node.soul.ify(o.node || {}, o)){
					obj_map(obj, map, {opt:o,as:as});
				}
				return o.node; // This will only be a valid node if the object wasn't already deep!
			}
			function map(v, f){ var o = this.opt, tmp, u; // iterate over each field/value.
				if(o.map){
					tmp = o.map.call(this.as, v, ''+f, o.node);
					if(u === tmp){
						obj_del(o.node, f);
					} else
					if(o.node){ o.node[f] = tmp }
					return;
				}
				if(Val.is(v)){ 
					o.node[f] = v;
				}
			}
		}());
		var obj = Type.obj, obj_is = obj.is, obj_del = obj.del, obj_map = obj.map;
		var text = Type.text, text_random = text.random;
		var _soul = Val.rel._;
		var u;
		module.exports = Node;
	})(require, './node');

	;require(function(module){
		var Type = require('./type');
		var Node = require('./node');
		function State(){
			var t = time();
			if(last < t){
				n = 0;
				return last = t;
			}
			return last = t + ((n += 1) / d);
		}
		State._ = '>';
		var time = Type.time.is, last = -Infinity, n = 0, d = 1000;
		State.ify = function(n, f, s){ // put a field's state on a node.
			if(!n || !n[N_]){ return } // reject if it is not node-like.
			var tmp = obj_as(n[N_], State._); // grab the states data.
			if(u !== f && num_is(s)){ tmp[f] = s } // add the valid state.
			return n;
		}
		State.is = function(n, f){ // convenience function to get the state on a field on a node and return it.
			var tmp = f && n && n[N_] && n[N_][State._];
			if(!tmp){ return }
			return num_is(tmp[f])? tmp[f] : -Infinity;
		}
		;(function(){
			State.map = function(cb, s, as){ var u; // for use with Node.ify
				var o = obj_is(o = cb || s)? o : null;
				cb = fn_is(cb = cb || s)? cb : null;
				if(o && !cb){
					s = num_is(s)? s : State();
					o[N_] = o[N_] || {};
					obj_map(o, map, {o:o,s:s});
					return o;
				}
				as = as || obj_is(s)? s : u;
				s = num_is(s)? s : State();
				return function(v, f, o, opt){
					if(!cb){
						map.call({o: o, s: s}, v,f);
						return v;
					}
					cb.call(as || this || {}, v, f, o, opt);
					if(obj_has(o,f) && u === o[f]){ return }
					map.call({o: o, s: s}, v,f);
				}
			}
			function map(v,f){
				if(N_ === f){ return }
				State.ify(this.o, f, this.s) ;
			}
		}());
		var obj = Type.obj, obj_as = obj.as, obj_has = obj.has, obj_is = obj.is, obj_map = obj.map;
		var num = Type.num, num_is = num.is;
		var fn = Type.fn, fn_is = fn.is;
		var N_ = Node._, u;
		module.exports = State;
	})(require, './state');

	;require(function(module){
		var Type = require('./type');
		var Val = require('./val');
		var Node = require('./node');
		var Graph = {};
		;(function(){
			Graph.is = function(g, cb, fn, as){ // checks to see if an object is a valid graph.
				if(!g || !obj_is(g) || obj_empty(g)){ return false } // must be an object.
				return !obj_map(g, map, {fn:fn,cb:cb,as:as}); // makes sure it wasn't an empty object.
			}
			function nf(fn){ // optional callback for each node.
				if(fn){ Node.is(nf.n, fn, nf.as) } // where we then have an optional callback for each field/value.
			}
			function map(n, s){ // we invert this because the way we check for this is via a negation.
				if(!n || s !== Node.soul(n) || !Node.is(n, this.fn)){ return true } // it is true that this is an invalid graph.
				if(!fn_is(this.cb)){ return }	
				nf.n = n; nf.as = this.as;	 
				this.cb.call(nf.as, n, s, nf);
			}
		}());
		;(function(){
			Graph.ify = function(obj, env, as){
				var at = {path: [], obj: obj};
				if(!env){
					env = {};
				} else 
				if(typeof env === 'string'){
					env = {soul: env};
				} else
				if(env instanceof Function){
					env.map = env;
				}
				if(env.soul){
					at.rel = Val.rel.ify(env.soul);
				}
				env.graph = env.graph || {};
				env.seen = env.seen || [];
				env.as = env.as || as;
				node(env, at);
				env.root = at.node;
				return env.graph;
			}
			function node(env, at){ var tmp;
				if(tmp = seen(env, at)){ return tmp }
				at.env = env;
				at.soul = soul;
				if(Node.ify(at.obj, map, at)){
					at.rel = at.rel || Val.rel.ify(Node.soul(at.node));
					env.graph[Val.rel.is(at.rel)] = at.node;
				}
				return at;
			}
			function map(v,f,n){
				var at = this, env = at.env, is, tmp;
				if(Node._ === f && obj_has(v,Val.rel._)){
					return n._; // TODO: Bug?
				}
				if(!(is = valid(v,f,n, at,env))){ return }
				if(!f){
					at.node = at.node || n || {};
					if(obj_has(v, Node._)){
						at.node._ = Gun.obj.copy(v._);
					}
					at.node = Node.soul.ify(at.node, Val.rel.is(at.rel));
				}
				if(tmp = env.map){
					tmp.call(env.as || {}, v,f,n, at);
					if(obj_has(n,f)){
						v = n[f];
						if(u === v){
							obj_del(n, f);
							return;
						}
						if(!(is = valid(v,f,n, at,env))){ return }
					}
				}
				if(!f){ return at.node }
				if(true === is){
					return v;
				}
				tmp = node(env, {obj: v, path: at.path.concat(f)});
				if(!tmp.node){ return }
				return tmp.rel; //{'#': Node.soul(tmp.node)};
			}
			function soul(id){ var at = this;
				var prev = Val.rel.is(at.rel), graph = at.env.graph;
				at.rel = at.rel || Val.rel.ify(id);
				at.rel[Val.rel._] = id;
				if(at.node && at.node[Node._]){
					at.node[Node._][Val.rel._] = id;
				}
				if(obj_has(graph, prev)){
					graph[id] = graph[prev];
					obj_del(graph, prev);
				}
			}
			function valid(v,f,n, at,env){ var tmp;
				if(Val.is(v)){ return true }
				if(obj_is(v)){ return 1 }
				if(tmp = env.invalid){
					v = tmp.call(env.as || {}, v,f,n);
					return valid(v,f,n, at,env);
				}
				env.err = "Invalid value at '" + at.path.concat(f).join('.') + "'!";
			}
			function seen(env, at){
				var arr = env.seen, i = arr.length, has;
				while(i--){ has = arr[i];
					if(at.obj === has.obj){ return has }
				}
				arr.push(at);
			}
		}());
		Graph.node = function(node){
			var soul = Node.soul(node);
			if(!soul){ return }
			return obj_put({}, soul, node);
		}
		;(function(){
			Graph.to = function(graph, root, opt){
				if(!graph){ return }
				var obj = {};
				opt = opt || {seen: {}};
				obj_map(graph[root], map, {obj:obj, graph: graph, opt: opt});
				return obj;
			}
			function map(v,f){ var tmp, obj;
				if(Node._ === f){
					if(obj_empty(v, Val.rel._)){
						return;
					}
					this.obj[f] = obj_copy(v);
					return;
				}
				if(!(tmp = Val.rel.is(v))){
					this.obj[f] = v;
					return;
				}
				if(obj = this.opt.seen[tmp]){
					this.obj[f] = obj;
					return;
				}
				this.obj[f] = this.opt.seen[tmp] = Graph.to(this.graph, tmp, this.opt);
			}
		}());
		var fn_is = Type.fn.is;
		var obj = Type.obj, obj_is = obj.is, obj_del = obj.del, obj_has = obj.has, obj_empty = obj.empty, obj_put = obj.put, obj_map = obj.map, obj_copy = obj.copy;
		var u;
		module.exports = Graph;
	})(require, './graph');


	;require(function(module){

		function Gun(o){
			if(!(this instanceof Gun)){ return Gun.create(o) }
			this._ = {gun: this};
		}

		Gun.create = function(o){
			return new Gun().opt(o);
		};

		Gun._ = { // some reserved key words, these are not the only ones.
			meta: '_' // all metadata of the node is stored in the meta property on the node.
			,soul: '#' // a soul is a UUID of a node but it always points to the "latest" data known.
			,field: '.' // a field is a property on a node which points to a value.
			,state: '>' // other than the soul, we store HAM metadata.
			,value: '=' // the primitive value.
		}

		Gun.__ = {
			'_':'meta'
			,'#':'soul'
			,'.':'field'
			,'=':'value'
			,'>':'state'
		}

		Gun.version = 0.4;

		Gun.is = function(gun){ return (gun instanceof Gun) } // check to see if it is a GUN instance.

		var Type = require('./type');
		Type.obj.map(Type, function(v,f){
			Gun[f] = v;
		});
		Gun.HAM = require('./HAM');
		Gun.val = require('./val');
		Gun.node = require('./node');
		Gun.state = require('./state');
		Gun.graph = require('./graph');

		Gun.on = require('./onify')();
		
		/*
		var opt = {chain: 'in', back: 'out', extend: 'root', id: Gun._.soul};
		Gun.chain = require('./chain')(Gun, opt);
		Gun.chain.chain.opt = opt;
		*/
		(Gun.chain = Gun.prototype).chain = function(){
			var chain = new this.constructor(), _;
			_ = chain._ || (chain._ = {});
			_.root = this._.root;
			_.back = this;
			return chain;
		}
		Gun.chain.toJSON = function(){};

		;(function(){

			Gun.chain.opt = function(opt){
				opt = opt || {};
				var gun = this, at = gun._, tmp, u;
				if(!at.root){ root(at) }
				tmp = at.opt = at.opt || {};
				if(text_is(opt)){ opt = {peers: opt} }
				else if(list_is(opt)){ opt = {peers: opt} }
				if(text_is(opt.peers)){ opt.peers = [opt.peers] }
				if(list_is(opt.peers)){ opt.peers = obj_map(opt.peers, function(n,f,m){m(n,{})}) }
				obj_map(opt, function map(v,f){
					if(obj_is(v)){
						tmp = tmp[f] || (tmp[f] = {}); // TODO: Bug? Be careful of falsey values getting overwritten?
						obj_map(v, map);
						return;
					}
					tmp[f] = v;
				});
				Gun.on('opt', at);
				return gun;
			}
			function root(at){
				var gun = at.gun;
				at.root = gun;
				at.graph = {};
				gun.on('in', input, at);
				gun.on('out', output, at);
			}
			function output(at){
				var cat = this, gun = cat.gun, tmp;
				if(at.put){
					cat.on('in', obj_to(at, {gun: cat.gun}));
				}
				if(!at.gun){
					at = Gun.obj.to(at, {gun: gun});
				}
				if(at.put){ Gun.on('put', at) }
				if(at.get){ get(at, cat) }
				Gun.on('out', at);
				if(!cat.back){ return }
				cat.back.on('out', at);
			}
			function get(at, cat){
				var soul = at.get[_soul], node = cat.graph[soul], field = at.get[_field];
				if(node && (!field || obj_has(node, field))){
					// TODO: BUG!!! Shouldn't this ack?????
					if(field){
						node = Gun.obj.put({_: node._}, field, node[field]);
					}
					cat.on('in', {
						'@': at.req? at['#'] : 0, // temporary hack
						put: Gun.graph.node(node) // TODO: BUG! Clone node!
					});
					return;
				}
				Gun.on('get', at);
			}
			function input(at){ var cat = this;
				if(at['@'] || at.err || u === at.put){
					at.gun = at.gun || cat.gun;
					Gun.on.ack(at['@'], at);
					return;
				}
				if(cat.graph){
					Gun.obj.map(at.put, ham, {at: at, cat: this}); // all unions must happen first, sadly.
				}
				Gun.obj.map(at.put, map, {at: at, cat: this});
			}
			function ham(data, key){
				var cat = this.cat, graph = cat.graph;
				graph[key] = Gun.HAM.union(graph[key] || data, data) || graph[key];
			}
			function map(data, key){
				var cat = this.cat, graph = cat.graph, path = cat.path || (cat.path = {}), gun, at;
				gun = path[key] || (path[key] = cat.gun.get(key));
				(at = gun._).change = data;
				if(graph){
					data = graph[key]; // TODO! BUG/PERF! COPY!?
				}
				at.put = data;
				gun.on('in', {
					put: data,
					get: key,
					gun: gun,
					via: this.at
				});
			}
		}());
		var text = Type.text, text_is = text.is, text_random = text.random;
		var list = Type.list, list_is = list.is;
		var obj = Type.obj, obj_is = obj.is, obj_has = obj.has, obj_to = obj.to, obj_map = obj.map;
		var _soul = Gun._.soul, _field = Gun._.field;
		var u;

		console.debug = function(i, s){ return (console.debug.i && i === console.debug.i && console.debug.i++) && console.log.apply(console, arguments), s };

		Gun.log = function(){ return (!Gun.log.off && console.log.apply(console, arguments)), [].slice.call(arguments).join(' ') }
		Gun.log.once = function(w,s,o){ return (o = Gun.log.once)[w] = o[w] || 0, o[w]++ || Gun.log(s) }

		if(typeof window !== "undefined"){ window.Gun = Gun }
		if(typeof common !== "undefined"){ common.exports = Gun }
		module.exports = Gun;
	})(require, './gun');

	;require(function(module){

		var Gun = require('./gun');
		module.exports = Gun;

		;(function(){
			function meta(v,f){
				if(obj_has(Gun.__, f)){ return }
				obj_put(this._, f, v);
			}
			function map(value, field){
				if(Gun._.meta === field){ return }
				var node = this.node, vertex = this.vertex, union = this.union, machine = this.machine;
				var is = state_is(node, field), cs = state_is(vertex, field);
				if(u === is || u === cs){ return true } // it is true that this is an invalid HAM comparison.
				var iv = rel_is(value) || value, cv = rel_is(vertex[field]) || vertex[field];
				







				// TODO: BUG! Need to compare relation to not relation, and choose the relation if there is a state conflict.








				if(!val_is(iv) && u !== iv){ return true } // Undefined is okay since a value might not exist on both nodes. // it is true that this is an invalid HAM comparison.
				if(!val_is(cv) && u !== cv){ return true }  // Undefined is okay since a value might not exist on both nodes. // it is true that this is an invalid HAM comparison.
				var HAM = Gun.HAM(machine, is, cs, iv, cv);
				if(HAM.err){
					console.log(".!HYPOTHETICAL AMNESIA MACHINE ERR!.", HAM.err); // this error should never happen.
					return;
				}
				if(HAM.state || HAM.historical || HAM.current){ // TODO: BUG! Not implemented.
					//opt.lower(vertex, {field: field, value: value, state: is});
					return;
				}
				if(HAM.incoming){
					union[field] = value;
					state_ify(union, field, is);
					return;
				}
				if(HAM.defer){ // TODO: BUG! Not implemented.
					/*upper.wait = true;
					opt.upper.call(state, vertex, field, incoming, ctx.incoming.state); // signals that there are still future modifications.
					Gun.schedule(ctx.incoming.state, function(){
						update(incoming, field);
						if(ctx.incoming.state === upper.max){ (upper.last || function(){})() }
					}, gun.__.opt.state);*/
				}
			}
			Gun.HAM.union = function(vertex, node, opt){
				if(!node || !vertex || !node._ || !vertex._){ return }
				opt = num_is(opt)? {machine: opt} : {machine: (+new Date)};
				opt.union = Gun.obj.copy(vertex);
				opt.vertex = vertex;
				opt.node = node;
				obj_map(node._, meta, opt.union);
				if(obj_map(node, map, opt)){ // if this returns true then something was invalid.
					return;
				}
				return opt.union;
			}
			var Type = Gun;
			var num = Type.num, num_is = num.is;
			var obj = Type.obj, obj_has = obj.has, obj_put = obj.put, obj_map = obj.map;
			var node = Gun.node, node_soul = node.soul, node_is = node.is, node_ify = node.ify;
			var state = Gun.state, state_is = state.is, state_ify = state.ify;
			var val = Gun.val, val_is = val.is, rel_is = val.rel.is;
			var u;
		}());

	})(require, './index');

	;require(function(module){
		var Gun = require('./index');
		var obj = Gun.obj, obj_is = obj.is, obj_put = obj.put, obj_map = obj.map, obj_empty = obj.empty;
		var num = Gun.num, num_is = num.is;
		var _soul = Gun.val.rel._, _field = '.';
		
		;(function(){ var obj = {}, u;
			Gun.chain.Back = function(n, opt){ var tmp;
				if(-1 === n || Infinity === n){
					return this._.root;
				} else
				if(1 === n){
					return this._.back;
				}
				var gun = this, at = gun._;
				if(typeof n === 'string'){
					n = n.split('.');
				}
				if(n instanceof Array){
					var i = 0, l = n.length, tmp = at;
					for(i; i < l; i++){
						tmp = (tmp||obj)[n[i]];
					}
					if(u !== tmp){
						return opt? gun : tmp;
					} else
					if(tmp = at.back){
						return tmp.Back(n, opt);
					}
					return;
				}
				if(n instanceof Function){
					var yes, tmp = {_:{back: gun}};
					while((tmp = tmp._) && (tmp = tmp.back) && !(yes = n(tmp, opt))){}
					return yes;
				}
			}
		}())

		;(function(){

			Gun.chain.put = function(data, cb, opt, as){
				// TODO: BUG! Put probably cannot handle plural chains!
				var gun = this, root = gun.Back(-1), tmp;
				opt = (opt && typeof opt === 'string')? {soul: opt} : opt || {};
				as = as || {opt: opt, soul: opt.soul};
				as.gun = gun;
				as.data = data;
				opt.any = opt.any || cb;
				if(root === gun || as.soul){
					if(!obj_is(as.data)){
						(opt.any||noop).call(opt.as || gun, as.out = {err: Gun.log("No field to put", (typeof as.data), '"' + as.data + '" on!')});
						if(as.res){ as.res() }
						return gun;
					}
					if(!as.soul){
						if(opt.init || as.gun.Back('opt.init')){
							return gun;
						}
					}
					as.gun = gun = root.get(as.soul = as.soul || (as.not = Gun.node.soul(as.data) || (opt.uuid || root.Back('opt.uuid') || Gun.text.random)()));
					as.ref = as.ref || as.gun;
					ify(as);
					return gun;
				}
				if(Gun.is(data)){
					data.any(function(e,d,k,at,ev){
						ev.off();
						var s = Gun.node.soul(d);
						if(!s){Gun.log("Can only save a node, not a property.");return}
						gun.put(Gun.val.rel.ify(s), cb, opt);
					});
					return gun;
				}
				as.ref = as.ref || (root === (tmp = gun.Back(1)))? gun : tmp;
				as.ref.any(any, {as: as, '.': null});
				if(!as.out){
					as.res = as.res || Gun.on.stun(as.ref);
					as.gun._.stun = as.ref._.stun; // TODO: BUG! These stuns need to be attached all the way down, not just one level.
				}
				return gun;
			};

			function ify(as){
				as.batch = batch;
				var opt = as.opt, env = as.env = Gun.state.map(map, opt.state);
				env.soul = as.soul;
				as.graph = Gun.graph.ify(as.data, env, as);
				if(env.err){
					(opt.any||noop).call(opt.as || as.gun, as.out = {err: Gun.log(env.err)});
					if(as.res){ as.res() }
					return;
				}
				as.batch();
			}

			function batch(){ var as = this;
				if(!as.graph || obj_map(as.stun, no)){ return }
				as.ref.on('out', {
					gun: as.ref, put: as.out = as.env.graph, opt: as.opt,
					'#': Gun.on.ask(function(ack, ev){
						if(ack && 0 === ack.ok){ return }
						ev.off(); // One response is good enough for us currently. Later we may want to adjust this.
						if(!as.opt.any){ return }
						as.opt.any.call(as.opt.as || as.gun, ack.err, ack.ok);
					}, as.opt)
				});
				if(as.res){ as.res() }
			} function no(v,f){ if(v){ return true } }

			function map(v,f,n, at){ var as = this;
				if(f || !at.path.length){ return }
				var path = at.path, ref = as.ref, opt = as.opt;
				var i = 0, l = path.length;
				for(i; i < l; i++){
					ref = ref.get(path[i], null, {path: true}); // TODO: API change! We won't need 'path: true' anymore.
				}
				if(as.not || Gun.node.soul(at.obj)){
					at.soul(Gun.node.soul(at.obj) || (as.opt.uuid || as.gun.Back('opt.uuid') || Gun.text.random)());
					return;
				}
				(as.stun = as.stun || {})[path] = true;
				if(as.res){
					as.res(1);
				}
				ref.any(soul, {as: {at: at, as: as}, '.': null});
			}

			function soul(at, ev){ var as = this.as, cat = this.at;
				ev.stun(); // TODO: BUG!?
				ev.off();
				cat.soul(Gun.node.soul(cat.obj) || Gun.node.soul(at.put) || Gun.val.rel.is(at.put) || (as.opt.uuid || as.gun.Back('opt.uuid') || Gun.text.random)()); // TODO: BUG!? Do we really want the soul of the object given to us? Could that be dangerous?
				as.stun[cat.path] = false;
				as.batch();
			}

			function any(at, ev){ 
				function implicit(at){ // TODO: CLEAN UP!!!!!
					if(!at || !at.get){ return } // TODO: CLEAN UP!!!!!
					as.data = obj_put({}, tmp = at.get, as.data); // TODO: CLEAN UP!!!!!
					at = at.via; // TODO: CLEAN UP!!!!!
					if(!at){ return } // TODO: CLEAN UP!!!!!
					tmp = at.get; // TODO: CLEAN UP!!!!!
					if(!at.via || !at.via.get){ return } // TODO: CLEAN UP!!!!!
					implicit(at);  // TODO: CLEAN UP!!!!!
				} // TODO: CLEAN UP!!!!!
				var as = this;
				if(at.err){ 
					console.log("Please report this as an issue! Put.any.err");
					return 
				}
				var cat = as.ref._, data = at.put, opt = as.opt, root, tmp;
				if(u === data){
					if(opt.init || as.gun.Back('opt.init')){
						return;
					}
					/*
						TODO: THIS WHOLE SECTION NEEDS TO BE CLEANED UP!
						Implicit behavior should be much cleaner. Right now it is hacky.
					*/
					// TODO: BUG!!!!!!! Apparently Gun.node.ify doesn't produce a valid HAM node?
					if(as.ref !== as.gun){ // TODO: CLEAN UP!!!!!
						tmp = as.gun._.get; // TODO: CLEAN UP!!!!!
						if(!tmp){ return } // TODO: CLEAN UP!!!!!
						as.data = obj_put({}, tmp, as.data);
						tmp = u;
					}
					if(as.gun.Back(-1) !== cat.back){
						implicit(at);
					}
					tmp = tmp || at.get;
					any.call(as, {
						put: as.data,
						get: as.not = as.soul = tmp
					}, ev);
					return;
				}
				ev.off(ev.stun());
				if(!as.not && !(as.soul = Gun.node.soul(data))){
					if(as.path && obj_is(as.data)){ // Apparently necessary
						as.soul = (opt.uuid || as.gun.Back('opt.uuid') || Gun.text.random)();
					} else {
						/*
							TODO: CLEAN UP! Is any of this necessary?
						*/
						if(!at.get){
							console.log("Please report this as an issue! Put.any.no.soul");
							return;
						}
						(as.next = as.next || Gun.on.next(as.ref))(function(next){
							// TODO: BUG! Maybe don't go back up 1 because .put already does that if ref isn't already specified?
							(root = as.ref.Back(1)).put(data = obj_put({}, at.get, as.data), opt.any, opt, {
								opt: opt,
								ref: root
							});
							//Gun.obj.to(opt, {
							//	ref: null,
							//	gun: null,
							//	next: null,
							//	data: data
							//}));
							//next(); // TODO: BUG! Needed? Not needed?
						});
						return;
					}
				}
				if(as.ref !== as.gun && !as.not){
					tmp = as.gun._.get;
					if(!tmp){
						console.log("Please report this as an issue! Put.no.get"); // TODO: BUG!??
						return;
					}
					as.data = obj_put({}, tmp, as.data);
				}
				as.ref.put(as.data, opt.any, opt, as);
			}
			var obj = Gun.obj, obj_has = obj.has, obj_put = obj.put;
			var u, noop = function(){};
		}());

		;(function(){
			Gun.chain.get = function(lex, cb, opt){
				if(!opt || !opt.path){ var back = this.Back(-1); } // TODO: CHANGING API! Remove this line!
				var gun, back = back || this, cat = back._;
				var path = cat.path || empty, tmp;
				if(typeof lex === 'string'){
					if(!(gun = path[lex])){
						gun = cache(lex, back);
					}
				} else
				if(!lex && 0 != lex){
					(gun = back.chain())._.err = {err: Gun.log('Invalid get request!', lex)};
					if(cb){ cb.call(gun, gun._.err) }
					return gun;
				} else
				if(num_is(lex)){
					return back.get(''+lex, cb, opt);
				} else
				if(tmp = lex.soul){
					if(!(gun = path[tmp])){
						gun = cache(tmp, back);
					}
					if(tmp = lex.field){
						(opt = opt || {}).path = true;
						return gun.get(tmp, cb, opt);
					}
				} else
				if(tmp = lex[_soul]){
					if(!(gun = path[tmp])){
						gun = cache(tmp, back);
					}
					if(tmp = lex[_field]){
						(opt = opt || {}).path = true;
						return gun.get(tmp, cb, opt);
					}
				}
				if(tmp = cat.stun){
					gun._.stun = gun._.stun || tmp;
				}
				if(cb && cb instanceof Function){
					((opt = opt || {}).gun = opt.gun || gun).any(cb, opt);
				}
				return gun;
			}
			function cache(key, back){
				var cat = back._, path = cat.path, gun = back.chain(), at = gun._;
				if(!path){ path = cat.path = {} }
				path[at.get = key] = gun;
				at.stun = at.stun || cat.stun; // TODO: BUG! Clean up! This is kinda ugly. These need to be attached all the way down regardless of whether a gun chain has been cached or not for the first time. 
				Gun.on('path', at);
				//gun.on('in', input, at); // For 'in' if I add my own listeners to each then I MUST do it before in gets called. If I listen globally for all incoming data instead though, regardless of individual listeners, I can transform the data there and then as well.
				gun.on('out', output, at); // However for output, there isn't really the global option. I must listen by adding my own listener individually BEFORE this one is ever called.
				return gun;
			}
			function output(at){
				var cat = this, gun = cat.gun, root = gun.Back(-1), put, get, tmp;
				if(!at.gun){
					at.gun = gun;
				}
				console.debug(10, 'out', cat.get, at.get);
				if(at.get && !at.get[_soul]){
					if(typeof at.get === 'string'){ // request for soul!
						if(cat.ask){
							if(cat.ask[at.get]){
								return;
							}
							cat.ask[at.get] = at['#'] || 1;
							cat.on('in', function(tac, ev){ ev.off();
								var tmp = tac.put;
								if(tmp && u !== tmp[at.get] && (tmp = (cat.path||empty)[at.get])){
									tmp = tmp._;
									tmp.change = tac.put[at.get];
									tmp.put = tac.put[at.get];
									// TODO: Could we pass it to input/map function since they already do this?
									tmp.on('in', {
										get: at.get,
										put: tac.put[at.get],
										gun: tmp.gun,
										via: tac
									})
									return;
								}
								if(!(tmp = Gun.node.soul(tmp = tac.put) || Gun.val.rel.is(tmp))){
									tmp = (cat.path||empty)[at.get];
									if(!tmp){ return }
									tmp.on('in', {get: at.get, gun:tmp, via: tac});
									return;
								}
								cat.ask[at.get] = 0;
								tmp = {'#': tmp, '.': at.get};
								tmp = {gun: at.gun, get: tmp};
								tmp['#'] = Gun.on.ask(ack, tmp);
								at.gun.on('out', tmp);
							}).off();
							return;
						}
						cat.ask = obj_put({}, at.get, at['#'] || 1);
						gun.on('in', input, cat);
						if(root === cat.back){
							cat.ask[at.get] = 0;
							tmp = {'#': cat.get, '.': at.get};
							tmp = {gun: at.gun, get: tmp};
							tmp['#'] = Gun.on.ask(ack, tmp);
							at.gun.on('out', tmp);
							return;
						}
						console.debug(7, 'out', cat.get, at.get, cat.ask);
						cat.back.on('out', {
							gun: cat.gun,
							get: cat.get
						});
						return;
					} else
					if(at.get instanceof Function){
						if(!cat.ask){
							var opt = at.opt || {};
							tmp = obj_has(opt, '.'); // TODO: CLEAN UP!
							cat.ask = tmp? {} : {_:1}; // TODO: CLEAN UP!
							gun.on('in', input, cat);
							if(root === cat.back){
								if(cat.ask && cat.ask._){ cat.ask._ = 0 } // TODO: CLEAN UP!
								if(tmp && opt['.']){ cat.ask[opt['.']] = 0 } // TODO: CLEAN UP!
								tmp = tmp? {'#': cat.get, '.': opt['.']} : {'#': cat.get}; // TODO: CLEAN UP!
								tmp = {gun: at.gun, get: tmp};
								tmp['#'] = Gun.on.ask(ack, tmp);
								cat.back.on('out', tmp);
							} else {
								console.debug(6, 'out', cat.get);
								cat.back.on('out', {
									gun: cat.gun,
									get: cat.get
								});
							}
						}
						console.debug(9, 'out', cat.get);
						if(cat.stun && cat.stun(at)){ return }
						gun.on('in', at.get, at);
						return;
					}
				}
				cat.back.on('out', at);
			}
			function input(at, ev){ var cat = this, tmp;
				cat.id = cat.id || Gun.text.random(5); // TOD: BUG! This allows for 1B item entropy in memory. In the future, people might want to expand this to be larger.
				if(at.err){
					console.log("Please report this as an issue! In.err"); // TODO: BUG!
					return;
				}
				console.debug(10, 'input', at, cat.get);
				if(value.call(cat, at, ev)){
					return;
				}
				if(tmp = cat.link){
					if(tmp = tmp.res){
						// TODO: BUG! Ordering of the change set? What if the proxied object has a change but the parent has a happened too. Pretend that the parent changed the field such that it no longer point to the proxy. But in the changeset it might get iterated over last, thus it the update will get triggered here now for the proxy, even though this update is suppose to unsubscribe itself. Or what if this ordering is inconsistent? Or is this just basically impossible from the API's put perspective?
						tmp(cat); // TODO: BUG! What about via? Do we need to clone this?
					}
				}
				obj_map(cat.change, map, {at: at, cat: cat});
			}
			Gun.chain.get.input = input;
			function value(at, ev){
				//var cat = this, is = (u === at.put) || Gun.val.is(at.put), rel = Gun.val.rel.is(at.put), tmp, u;
				var cat = this, put = cat.change, rel, tmp, u;
				if(u === put){
					not(cat, at);
					return true;
				}
				if(!cat.link && Gun.node.soul(put) && (rel = Gun.node.soul(at.put))){
				console.debug(11, 'value', put);
					ask(cat, rel);
					return false;
				}
				if(!(rel = Gun.val.rel.is(put))){
					if(!Gun.val.is(put)){
						return false;
					}
					not(cat, at);
					return true;
				}
				//cat.change = at.put;
				if(cat.link){
					if(rel === cat.link.rel){
						ev.stun();
						tmp = cat.link.ref._;
						cat.change = tmp.change;
						cat.put = at.put = tmp.put; // TODO: BUG! Mutating at event? Needed for certain tests, but is this bad?
						return false;
					}
					not(cat, at);
				}
				tmp = ev.stun(tmp);
				//cat.put = u; // For performance sake, do this now to prevent `.val` from firing.
				tmp = cat.link = {rel: rel, ref: cat.gun.Back(-1).get(rel), res: tmp, as: cat};
				// TODO: BUG???? Below allows subscriptions to happen without the soul itself being subscribed. Will this cause problems? I think it should be okay. Not sure what test is necessary.
				tmp.sub = tmp.ref._.on('in', proxy, tmp); // TODO: BUG! If somebody does `.off` how do we clean up these things from memory?
				if(tmp.ran){ return }
				ask(cat, rel);
				if(!tmp.ran){
					tmp.res(); // This is necessary for things that listen for a soul or relation only.
				}
				return true;
			}
			function map(data, key){ // Map over only the changes on every update.
				if(Gun._.meta === key){ return }
				var cat = this.cat, path = cat.path || {}, gun, at, tmp;
				if(!(gun = path[key])){ return }
				if(cat.put && obj_has(cat.put, key)){ data = cat.put[key] } // But use the actual data.
				(at = gun._).change = cat.change[key];
				at.put = data;
				if(tmp = Gun.val.rel.is(at.put)){ // PERFORMANCE HACK!
					if(tmp = gun.Back(-1).get(tmp)._.put){ // PERFORMANCE HACK!
						at.put = data = tmp; // PERFORMANCE HACK!
					}
				}
				gun.on('in', {
					put: data,
					get: key,
					gun: gun,
					via: this.at
				});
			}
			function not(cat, at){
				var tmp, u;
				tmp = cat.link;
				if(u !== cat.put){ cat.link = null; } // TODO: BUG! This may mean `not` will be fired multiple times until data is found. Is this okay?
				if(null === tmp){ return }
				if(tmp){
					if(tmp.sub){
						tmp.sub.off();
					}
					tmp.sub = false;
				}
				obj_map(cat.ask, function(v,key){
					cat.ask[key] = 1;
					if(!(v = (cat.path||empty)[key])){ return }
					(tmp = v._).put = tmp.change = u;
					v.on('in', {get: key, put: u, gun: v, via: at});
				});
			}
			function ask(cat, soul){
				if(!cat.ask){ return }
				var tmp = cat.ask, lex;
				if(obj_has(tmp, '_')){
					if(!tmp._){ return }
					tmp._ = 0;
					lex = {gun: cat.gun, get: {'#': soul}};
					lex['#'] = Gun.on.ask(ack, lex);
					cat.gun.on('out', lex);
					return;
				}
				// TODO: PERF! Make it so we do not have to iterate through this every time?
				obj_map(tmp, function(v,key){
					if(!v || (cat.put && cat.put[key])){ return } // TODO: This seems like an optimization? But does it have side effects? Probably not without the tmp[key] = 0;
					if(!(v = (cat.path||empty)[key])){ return }
					tmp[key] = 0;
					lex = {gun: v, get: {'#': soul, '.': key}};
					lex['#'] = Gun.on.ask(ack, lex);
					v.on('out', lex);
				});
			}
			function proxy(at, ev){ var link = this;
				link.ran = true;
				if(false === link.sub){ return ev.off() } // will this auto clean itself up?
				link.as.change = link.ref._.change;
				link.as.put = at.put;
				input.call(link.as, at, ev); // TODO: BUG! What about via? Do we need to clone this?
			}
			Gun.chain.any = function(any, opt){
				if(!any){ return this }
				var chain = this, cat = chain._, opt = opt || {}, last = {};//function(){};
				if(opt.change){ opt.change = 1 }
				console.debug(5, 'any');
				chain.on('out', {get: function(at, ev){
						//console.log("any!", at);
						if(!at.gun){ console.log('%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%EXPLODE%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%', at) }
						var gun = at.gun || chain, cat = gun._;
						var data = cat.put || at.put, tmp;
						if((tmp = at.put) && tmp[Gun.val.rel._] && (tmp = Gun.val.rel.is(tmp))){
							if(null !== opt['.']){
								return;
							}
							at = obj_to(at, {put: data = cat.change = cat.put = Gun.state.ify(Gun.node.ify({}, tmp))});
						}
						// TODO: BUG! Need to use at.put > cat.put for merged cache?
						if(tmp = opt.change){ // TODO: BUG! Opt is outer scope, gun/cat/data might be iterative and thus only inner scope? Aka, we can't use it for all of them. 
							if(1 === tmp){
								opt.change = true;
							} else {
								data = cat.change;
								at = obj_to(at, {put: data});
							}
						}
						var id = cat.id+at.get;
						/*
						if(last[id] == data && obj_has(last, id)){ return }
						last[id] = data; // TODO: PERF! Memory optimizaiton? Can we avoid this.
						*/
					
						if(last.put === data && last.get === id){ return }
						last.get = id;
						last.put = data;
						
						cat.last = data;
						if(opt.as){
							any.call(opt.as, at, ev);
						} else {
							any.call(gun, at.err, data, at.get, cat, ev);
						}
					}, opt: opt
				});
				return chain;
			}
			function ack(at, ev){ var lex = this.get, chain = this.gun;
				var s = lex['#'], f = lex['.'], root = at.gun.Back(-1), gun = root.get(s), tmp;
				if(tmp = at.put){
					if(!f || obj_has(tmp[s], f)){
						ev.off();
						at['@'] = 0;
						return root.on('in', at);
					}
					/*
					if(!tmp[s] && !obj_empty(tmp)){ // TODO: BUG! Seems like it just causes unnecessary data/event to be triggered. Nothing genuinely useful.
						ev.off(); // TODO: BUG!? It isn't matching data by lex means, but it IS a reply?
						at['@'] = 0;
						return root.on('in', at);
					}
					*/
					if(f && gun._.put){
						gun = gun.get(f, null, {path:true});
						if(!chain){
							console.log("Please report this as an issue! ack.chain");
							return;
						}
						chain.on('in', {
							err: at.err,
							get: f,
							gun: chain,
							via: {get:s,via:at}
						});
						return;
					}
				}
				if(gun._.put){
					gun = gun.get(f, null, {path:true});
					gun.on('in', {
						err: at.err,
						get: f,
						gun: gun,
						via: {get:s,via:at}
					});
					return;
				}
				gun.on('in', {
					err: at.err,
					put: at.put? at.put[s] || at.put : at.put,
					get: s,
					gun: gun,
					via: at
				});
			}
			var obj = Gun.obj, obj_has = obj.has, obj_to = obj.to;
			var empty = {}, u;
			var _soul = Gun._.soul, _field = Gun._.field, _sid = Gun.on.ask._, _rid = Gun.on.ack._;
		}());

		;(function(){
			Gun.chain.key = function(index, cb, opt){
				if(!index){
					if(cb){
						cb.call(this, {err: Gun.log('No key!')});
					}
					return this;
				}
				var gun = this;
				if(typeof opt === 'string'){
					console.log("Please report this as an issue! key.opt.string");
					return gun;
				}
				if(gun === gun._.root){if(cb){cb({err: Gun.log("Can't do that on root instance.")})};return gun}
				opt = opt || {};
				opt.key = index;
				opt.any = cb || function(){};
				opt.ref = gun.Back(-1).get(opt.key);
				opt.gun = opt.gun || gun;
				gun.on(key, {as: opt});
				if(!opt.data){
					opt.res = Gun.on.stun(opt.ref);
				}
				return gun;
			}
			function key(at, ev){ var opt = this;
				ev.off();
				opt.soul = Gun.node.soul(at.put);
				if(!opt.soul || opt.key === opt.soul){ return opt.data = {} }
				opt.data = obj_put({}, keyed._, Gun.node.ify(obj_put({}, opt.soul, Gun.val.rel.ify(opt.soul)), '#'+opt.key+'#'))
				if(opt.res){
					opt.res(1);
				}
				opt.ref.put(opt.data, opt.any, {soul: opt.key, key: opt.key});
				if(opt.res){
					opt.res();
				}
			}
			function keyed(f){
				if(!f || !('#' === f[0] && '#' === f[f.length-1])){ return }
				var s = f.slice(1,-1);
				if(!s){ return }
				return s;
			}
			keyed._ = '##';
			Gun.on('path', function(at){
				var gun = at.gun;
				if(gun.Back(-1) !== at.back){ return }
				gun.on('in', pseudo, gun._);
				gun.on('out', normalize, gun._);
			});
			function normalize(at){ var cat = this;
				if(!at.put){
					if(at.get){
						search.call(cat, at);
					}
					return;
				}
				if(at.opt && at.opt.key){ return }
				var put = at.put, graph = cat.gun.Back(-1)._.graph;
				Gun.graph.is(put, function(node, soul){
					if(!Gun.node.is(graph['#'+soul+'#'], function each(rel,id){
						if(id !== Gun.val.rel.is(rel)){ return }
						if(rel = graph['#'+id+'#']){
							Gun.node.is(rel, each);
							return;
						}
						Gun.node.soul.ify(rel = put[id] = Gun.obj.copy(node), id);
					})){ return }
					Gun.obj.del(put, soul);
				});
			}
			function search(at){ var cat = this;
				var tmp;
				if(!Gun.obj.is(at.get)){ return }
				if(cat.pseudo){

				}
				if((tmp = at.opt) && (null === tmp['.'])){
					tmp['.'] = '##';
					return;
				}
				if((tmp = at.get) && Gun.obj.has(tmp, '.')){
					tmp = at['#'];
					at['#'] = Gun.on.ask(proxy);
				}
				var tried = {};
				function proxy(ack, ev){
					ev.off();
					var put = ack.put, lex = at.get;
					if(!cat.pseudo){ return Gun.on.ack(tmp, ack) }
					if(ack.put){
						if(!lex['.']){
							return Gun.on.ack(tmp, ack);
						}
						if(obj_has(ack.put[lex['#']], lex['.'])){
							return Gun.on.ack(tmp, ack);
						}
					}
					Gun.obj.map(cat.seen, function(ref,id){ // TODO: BUG! In-memory versus future?
						if(tried[id]){
							return Gun.on.ack(tmp, ack);
						}
						tried[id] = true;
						ref.on('out', {
							gun: ref,
							get: id = {'#': id, '.': at.get['.']},
							'#': Gun.on.ask(proxy)
						});
					});
				}
			}
			function pseudo(at, ev){ var cat = this;
				if(cat.pseudo){
					ev.stun();
					if(cat.pseudo === at.put){ return }
					cat.change = cat.changed || cat.pseudo;
					cat.on('in', Gun.obj.to(at, {put: cat.put = cat.pseudo}));
					return;
				}
				if(!at.put){ return }
				var rel = Gun.val.rel.is(at.put[keyed._]);
				if(!rel){ return }
				var soul = Gun.node.soul(at.put), resume = ev.stun(resume), root = cat.gun.Back(-1), seen = cat.seen = {};
				cat.pseudo = cat.put = Gun.state.ify(Gun.node.ify({}, soul));
				root.get(rel).on(each, true);
				function each(change){
					Gun.node.is(change, map);
				}
				function map(rel, soul){
					if(soul !== Gun.val.rel.is(rel)){ return }
					if(seen[soul]){ return }
					seen[soul] = root.get(soul).on(on, true);
				}
				function on(put){
					cat.pseudo = Gun.HAM.union(cat.pseudo, put) || cat.pseudo;
					cat.change = cat.changed = put;
					cat.put = cat.pseudo;
					resume({
						gun: cat.gun,
						put: cat.pseudo,
						get: soul
						//via: this.at
					});
				}
			}
			var obj = Gun.obj, obj_has = obj.has;
		}());

		Gun.chain.path = function(field, cb, opt){
			var back = this, gun = back, tmp;
			opt = opt || {}; opt.path = true;
			if(gun === gun._.root){if(cb){cb({err: Gun.log("Can't do that on root instance.")})}return gun}
			if(typeof field === 'string'){
				tmp = field.split(opt.split || '.');
				if(1 === tmp.length){
					return back.get(field, cb, opt);
				}
				field = tmp;
			}
			if(field instanceof Array){
				if(field.length > 1){
					gun = back;
					var i = 0, l = field.length;
					for(i; i < l; i++){
						console.debug(3, 'path', field[i]);
						console.debug(2, 'path', field[i]);
						gun = gun.get(field[i], (i+1 === l)? cb : null, opt);
					}
					gun.back = back; // TODO: API change!
				} else {
					gun = back.get(field[0], cb, opt);
				}
				return gun;
			}
			if(!field && 0 != field){
				return back;
			}
			return back.get(''+field, cb, opt);
		}

		;(function(){
			Gun.chain.on = function(tag, arg, eas, as){
				var gun = this, at = gun._, tmp;
				if(!at.on){ at.on = Gun.on }
				if(typeof tag === 'string'){
					if(!arg){ return at.on(tag) }
					at.on(tag, arg, eas || at, as);
					return gun;
				}
				var opt = arg;
				opt = (true === opt)? {change: true} : opt || {}; 
				opt.ok = tag;
				gun.any(ok, {as: opt, change: opt.change}); // TODO: PERF! Event listener leak!!!????
				return gun;
			}

			function ok(cat, ev){ var opt = this;
				var data = cat.put, tmp; 
				// TODO: BUG! Need to use at.put > cat.put for merged cache?
				if(u === data){ return }
				if(opt.as){
					//console.log("BANANA CREAM PIE", opt);
					opt.ok.call(opt.as, cat, ev);
				} else {
					//console.log("HICADOO DAAH", cat, opt);
					opt.ok.call(cat.gun, data, cat.get, cat, ev);
				}
			}

					//if(obj_empty(value, Gun._.meta) && !(opt && opt.empty)){ // TODO: PERF! Deprecate!???
						
					//} else {
						//console.log("value", value);
						//if(!(value||empty)['#']/* || !val_rel_is(value)*/){ // TODO: Performance hit!???? // TODO: BUG! WE should avoid this. So that way it is usable with gun plugin chains.
							//cb.call(gun, value, at.get); // TODO: BUG! What about stun?
							//return gun;
						//}
					//}

			// TODO: BUG! What about stun?
			Gun.chain.val = function(cb, opt){
				var gun = this, at = gun._, value = at.put;
				if(!at.stun && u !== value){
					cb.call(gun, value, at.get);
					return gun;
				}
				if(cb){
					(opt = opt || {}).ok = cb;
					opt.cat = at;
					console.debug(4, 'val', at);
					gun.any(val, {as: opt});
					opt.async = true;
				}
				return gun;
			}

			function val(at, ev, to){ var opt = this;
				var cat = opt.cat, data = at.put;
				if(u === data){
					return;
				}
				clearTimeout(ev.to);
				if(!to && opt.async){
					ev.to = setTimeout(function(){
						val.call(opt, at, ev, ev.to || 1)
					}, opt.wait || 99);
					return;
				}
				ev.off();
				opt.ok.call(at.gun || opt.gun, data, at.get); // TODO: BUG! opt.gun?
			}

			Gun.chain.off = function(){
				var gun = this, at = gun._, tmp;
				var back = at.back || {}, cat = back._;
				if(!cat){ return }
				if(tmp = cat.path){
					if(tmp[at.get]){
						obj_del(tmp, at.get);
					} else {
						obj_map(tmp, function(path, key){
							if(gun !== path){ return }
							obj_del(tmp, key);
						});
					}
				}
				if((tmp = gun.Back(-1)) === back){
					obj_del(tmp.graph, at.get);
				}
				if(at.ons && (tmp = at.ons['@$'])){
					obj_map(tmp.s, function(ev){
						ev.off();
					});
				}
				return gun;
			}
			var obj = Gun.obj, obj_has = obj.has, obj_del = obj.del, obj_to = obj.to;
			var val_rel_is = Gun.val.rel.is;
			var empty = {}, u;
		}());

		;(function(){
			Gun.chain.not = function(cb, opt, t){
				var gun = this, at = Gun.obj.to(gun._, {not: {not: cb}});
				gun.any(ought, {as: at});
				return gun;
			}
			function ought(cat, ev){ ev.off(); var at = this; // TODO: BUG! Is this correct?
				if(cat.err || cat.put){ return }
				if(!at.not || !at.not.not){ return }
				//ev.stun(); // TODO: BUG? I think this is correct. NOW INCORRECT because as things mutate we might want to retrigger!
				at.not.not.call(at.gun, at.get, function(){ console.log("Please report this bug on https://gitter.im/amark/gun and in the issues."); need.to.implement; });
			}
		}());

		;(function(){
			Gun.chain.map = function(cb, opt, t){
				var gun = this, cat = gun._, chain = cat.map;
				if(!chain){
					chain = cat.map = gun.chain();
					var list = (cat = chain._).list = cat.list || {};
					chain.on('in').map = {};
					chain.on('out', function(at){
						console.debug(8, 'map out', at);
				 		if(at.get instanceof Function){
							chain.on('in', at.get, at);
							return;
						} else {
							console.debug(9, 'map out', at);
							chain.on('in', gun.get.input, at.gun._);
						}
					});
					if(opt !== false){
						gun.on(map, {change: true, as: cat});
						console.debug(1, 'map');
					}
				}
				if(cb){
					chain.on(cb);
				}
				return chain;
			}
			function map(at,ev){
				var cat = this, gun = at.gun || this.back, tac = gun._;
				obj_map(at.put, each, {gun:gun, cat: cat, id: tac.id||at.get});
			}
			function each(v,f){
				if(n_ === f){ return }
				var gun = this.gun, cat = this.cat, id = this.id;
				if(cat.list[id+f]){ return }
				// TODO: BUG! Ghosting!
				cat.list[id+f] = gun.path(f).on(function(v,f,a,ev){
					//cat.on('in',[{gun:this,get:f,put:v},ev]);
					cat.on('in',[id+f,{gun:this,get:f,put:v},ev]);
				});
			}
			var obj_map = Gun.obj.map, noop = function(){}, event = {stun: noop, off: noop}, n_ = Gun.node._;
		}());

		;(function(){
			Gun.chain.init = function(){ // TODO: DEPRECATE?
				(this._.opt = this._.opt || {}).init = true;
				return this.Back(-1).put(Gun.node.ify({}, this._.get), null, this._.get);
			}
		}());

		;(function(){
			Gun.chain.set = function(item, cb, opt){
				var gun = this;
				cb = cb || function(){};
				return item.val(function(node){
					var put = {}, soul = Gun.node.soul(node);
					if(!soul){ return cb.call(gun, {err: Gun.log('Only a node can be linked! Not "' + node + '"!')}) }
					gun.put(Gun.obj.put(put, soul, Gun.val.rel.ify(soul)), cb, opt);
				});
			}
		}());
	})(require, './api');

	;require(function(module){
		if(typeof JSON === 'undefined'){ throw new Error("Include JSON first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js") } // for old IE use
		if(typeof Gun === 'undefined'){ return } // TODO: localStorage is Browser only. But it would be nice if it could somehow plugin into NodeJS compatible localStorage APIs?
		
		var root, noop = function(){};
		if(typeof window !== 'undefined'){ root = window }
		var store = root.localStorage || {setItem: noop, removeItem: noop, getItem: noop};

		function put(at){ var err, id, opt, root = at.gun._.root;
			(opt = at.opt || {}).prefix = opt.prefix || 'gun/';
			Gun.graph.is(at.put, function(node, soul){
				//try{store.setItem(opt.prefix + soul, Gun.text.ify(node));
				try{store.setItem(opt.prefix + soul, Gun.text.ify(root._.graph[soul]||node));
				}catch(e){ err = e || "localStorage failure" }
			});
			//console.log('@@@@@@@@@@local put!');
			Gun.on.ack(at, {err: err, ok: 0}); // TODO: Reliability! Are we sure we want to have localStorage ack?
		}
		function get(at){
			var gun = at.gun, lex = at.get, soul, data, opt, u;
			//setTimeout(function(){
			(opt = at.opt || {}).prefix = opt.prefix || 'gun/';
			if(!lex || !(soul = lex[Gun._.soul])){ return }
			data = Gun.obj.ify(store.getItem(opt.prefix + soul) || null);
			if(!data){ return } // localStorage isn't trustworthy to say "not found".
			if(Gun.obj.has(lex, '.')){var tmp = data[lex['.']];data = {_: data._};if(u !== tmp){data[lex['.']] = tmp}}
			//console.log('@@@@@@@@@@@@local get', data, at);
			gun.Back(-1).on('in', {'@': at['#'], put: Gun.graph.node(data)});
			//},100);
		}
		Gun.on('put', put);
		Gun.on('get', get);
	})(require, './adapters/localStorage');
	
	;require(function(module){
		function r(base, body, cb, opt){
			var o = base.length? {base: base} : {};
			o.base = opt.base || base;
			o.body = opt.body || body;
			o.headers = opt.headers;
			o.url = opt.url;
			o.out = opt.out;
			cb = cb || function(){};
			if(!o.base){ return }
			r.transport(o, cb);
		}
		r.createServer = function(fn){ r.createServer.s.push(fn) }
		r.createServer.ing = function(req, cb){
			var i = r.createServer.s.length;
			while(i--){ (r.createServer.s[i] || function(){})(req, cb) }
		}
		r.createServer.s = [];
		r.back = 2; r.backoff = 2;
		r.transport = function(opt, cb){
			//Gun.log("TRANSPORT:", opt);
			if(r.ws(opt, cb)){ return }
			r.jsonp(opt, cb);
		}
		r.ws = function(opt, cb, req){
			var ws, WS = window.WebSocket || window.mozWebSocket || window.webkitWebSocket;
			if(!WS){ return }
			if(ws = r.ws.peers[opt.base]){
				req = req || {};
				if(opt.headers){ req.headers = opt.headers }
				if(opt.body){ req.body = opt.body }
				if(opt.url){ req.url = opt.url }
				req.headers = req.headers || {};
				if(!opt.out && !ws.cbs[req.headers['ws-rid']]){
					ws.cbs[req.headers['ws-rid'] = 'WS' + (+ new Date()) + '.' + Math.floor((Math.random()*65535)+1)] = function(err,res){
						if(!res || res.body || res.end){ delete ws.cbs[req.headers['ws-rid']] }
						cb(err,res);
					}
				}
				if(!ws.readyState){ return setTimeout(function(){ r.ws(opt, cb, req) },100), true }
				ws.sending = true;
				ws.send(JSON.stringify(req));
				return true;
			}
			if(ws === false){ return }
			(ws = r.ws.peers[opt.base] = new WS(opt.base.replace('http','ws'))).cbs = {};
			ws.onopen = function(o){ r.back = 2; r.ws(opt, cb) };
			ws.onclose = window.onbeforeunload = function(c){
				if(!ws || !c){ return }
				if(ws.close instanceof Function){ ws.close() }
				if(!ws.sending){
					ws = r.ws.peers[opt.base] = false;
					return r.transport(opt, cb);
				}
				r.each(ws.cbs, function(cb){
					cb({err: "WebSocket disconnected!", code: !ws.sending? -1 : (ws||{}).err || c.code});
				});
				ws = r.ws.peers[opt.base] = null; // this will make the next request try to reconnect
				setTimeout(function(){ // TODO: Have the driver handle this!
					r.ws(opt, function(){}); // opt here is a race condition, is it not? Does this matter?
				}, r.back *= r.backoff);
			};
			ws.onmessage = function(m){ var res;
				if(!m || !m.data){ return }
				try{res = JSON.parse(m.data);
				}catch(e){ return }
				if(!res){ return }
				res.headers = res.headers || {};
				if(res.headers['ws-rid']){ return (ws.cbs[res.headers['ws-rid']]||function(){})(null, res) }
				if(res.body){ r.createServer.ing(res, function(res){ res.out = true; r(opt.base, null, null, res)}) } // emit extra events.
			};
			ws.onerror = function(e){ (ws||{}).err = e };
			return true;
		}
		r.ws.peers = {};
		r.ws.cbs = {};
		r.jsonp = function(opt, cb){
			r.jsonp.ify(opt, function(url){
				if(!url){ return }
				r.jsonp.send(url, function(err, reply){
					cb(err, reply);
					r.jsonp.poll(opt, reply);
				}, opt.jsonp);
			});
		}
		r.jsonp.send = function(url, cb, id){
			var js = document.createElement('script');
			js.src = url;
			js.onerror = function(c){
				(window[js.id]||function(){})(null, {err: "JSONP failed!"});
			}
			window[js.id = id] = function(res, err){
				cb(err, res);
				cb.id = js.id;
				js.parentNode.removeChild(js);
				window[cb.id] = null; // TODO: BUG: This needs to handle chunking!
				try{delete window[cb.id];
				}catch(e){}
			}
			js.async = true;
			document.getElementsByTagName('head')[0].appendChild(js);
			return js;
		}
		r.jsonp.poll = function(opt, res){
			if(!opt || !opt.base || !res || !res.headers || !res.headers.poll){ return }
			(r.jsonp.poll.s = r.jsonp.poll.s || {})[opt.base] = r.jsonp.poll.s[opt.base] || setTimeout(function(){ // TODO: Need to optimize for Chrome's 6 req limit?
				//Gun.log("polling again");
				var o = {base: opt.base, headers: {pull: 1}};
				r.each(opt.headers, function(v,i){ o.headers[i] = v })
				r.jsonp(o, function(err, reply){
					delete r.jsonp.poll.s[opt.base];
					while(reply.body && reply.body.length && reply.body.shift){ // we're assuming an array rather than chunk encoding. :(
						var res = reply.body.shift();
						if(res && res.body){ r.createServer.ing(res, function(){ r(opt.base, null, null, res) }) } // emit extra events.
					}
				});
			}, res.headers.poll);
		}
		r.jsonp.ify = function(opt, cb){
			var uri = encodeURIComponent, q = '?';
			if(opt.url && opt.url.pathname){ q = opt.url.pathname + q; }
			q = opt.base + q;
			r.each((opt.url||{}).query, function(v, i){ q += uri(i) + '=' + uri(v) + '&' });
			if(opt.headers){ q += uri('`') + '=' + uri(JSON.stringify(opt.headers)) + '&' }
			if(r.jsonp.max < q.length){ return cb() }
			q += uri('jsonp') + '=' + uri(opt.jsonp = 'P'+Math.floor((Math.random()*65535)+1));
			if(opt.body){
				q += '&';
				var w = opt.body, wls = function(w,l,s){
					return uri('%') + '=' + uri(w+'-'+(l||w)+'/'+(s||w))  + '&' + uri('$') + '=';
				}
				if(typeof w != 'string'){
					w = JSON.stringify(w);
					q += uri('^') + '=' + uri('json') + '&';
				}
				w = uri(w);
				var i = 0, l = w.length
				, s = r.jsonp.max - (q.length + wls(l.toString()).length);
				if(s < 0){ return cb() }
				while(w){
					cb(q + wls(i, (i = i + s), l) + w.slice(0, i));
					w = w.slice(i);
				}
			} else {
				cb(q);
			}
		}
		r.jsonp.max = 2000;
		r.each = function(obj, cb, as){
			if(!obj || !cb){ return }
			for(var i in obj){
				if(obj.hasOwnProperty(i)){
					cb.call(as, obj[i], i);
				}
			}
		}
		module.exports = r;
	})(require, './polyfill/request');

	;require(function(module){
		P.request = require('./request');
		function P(p){
			if(!P.is(this)){ return new P(p) }
			this.peers = p;
		}
		P.is = function(p){ return (p instanceof P) }
		P.chain = P.prototype;
		function map(peer, url){
			var msg = this.msg;
			var opt = this.opt || {};
			opt.out = true;
			P.request(url, msg, null, opt);
		}
		P.chain.send = function(msg, opt){
			P.request.each(this.peers, map, {msg: msg, opt: opt});
		}
		module.exports = P;
	})(require, './polyfill/peer');

	;require(function(module){
		if(typeof JSON === 'undefined'){ throw new Error("Include JSON first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js") } // for old IE use
		if(typeof Gun === 'undefined'){ return } // TODO: window.Websocket is Browser only. But it would be nice if it could somehow merge it with lib/WSP?
		
		var root, noop = function(){};
		if(typeof window !== 'undefined'){ root = window }

		var Tab = {};
		Tab.on = Gun.on;//Gun.on.create();
		Tab.peers = require('../polyfill/peer');
		Gun.on('get', function(at){
			var gun = at.gun, opt = gun.Back('opt') || {}, peers = opt.peers;
			if(!peers || Gun.obj.empty(peers)){
				//setTimeout(function(){
				Gun.log.once('peers', "Warning! You have no peers to connect to!");
				at.gun.Back(-1).on('in', {'@': at['#']});
				//},100);
				return;
			}
			var msg = {
				'#': at['#'] || Gun.text.random(9), // msg ID
				'$': at.get // msg BODY
			};
			Tab.on(msg['#'], function(err, data){ // TODO: ONE? PERF! Clear out listeners, maybe with setTimeout?
				if(data){
					at.gun.Back(-1).on('out', {'@': at['#'], err: err, put: data});
				} else {
					at.gun.Back(-1).on('in', {'@': at['#'], err: err, put: data});
				}
			});
			Tab.peers(peers).send(msg, {headers: {'gun-sid': Tab.server.sid}});
		});
		Gun.on('put', function(at){
			if(at['@']){ return }
			var opt = at.gun.Back('opt') || {}, peers = opt.peers;
			if(!peers || Gun.obj.empty(peers)){
				Gun.log.once('peers', "Warning! You have no peers to save to!");
				at.gun.Back(-1).on('in', {'@': at['#']});
				return;
			}
			if(false === opt.websocket || (at.opt && false === at.opt.websocket)){ return }
			var msg = {
				'#': at['#'] || Gun.text.random(9), // msg ID
				'$': at.put // msg BODY
			};
			Tab.on(msg['#'], function(err, ok){ // TODO: ONE? PERF! Clear out listeners, maybe with setTimeout?
				at.gun.Back(-1).on('in', {'@': at['#'], err: err, ok: ok});
			});
			Tab.peers(peers).send(msg, {headers: {'gun-sid': Tab.server.sid}});
		});
		// browser/client side Server!
		Gun.on('opt', function(at){ // TODO: BUG! Does not respect separate instances!!!
			if(Tab.server){ return }
			var gun = at.gun, server = Tab.server = {}, tmp;
			server.sid = Gun.text.random();
			Tab.peers.request.createServer(function(req, res){
				if(!req || !res || !req.body || !req.headers){ return }
				var msg = req.body;
				// AUTH for non-replies.
				if(server.msg(msg['#'])){ return }
				//server.on('network', Gun.obj.copy(req)); // Unless we have WebRTC, not needed.
				if(msg['@']){ // no need to process.
					if(Tab.ons[tmp = msg['@'] || msg['#']]){
						Tab.on(tmp, [msg['!'], msg['$']]);
					}
					return 
				}
				if(msg['$'] && msg['$']['#']){ return server.get(req, res) }
				else { return server.put(req, res) }
			});
			server.get = function(req, cb){
				var body = req.body, lex = body['$'], opt;
				var graph = gun._.root._.graph, node;
				if(!(node = graph[lex['#']])){ return } // Don't reply to data we don't have it in memory. TODO: Add localStorage?
				cb({body: {
					'#': server.msg(),
					'@': body['#'],
					'$': node
				}});
			}
			server.put = function(req, cb){
				var body = req.body, graph = body['$'];
				var __ = gun._.root._;
				if(!(graph = Gun.obj.map(graph, function(node, soul, map){ // filter out what we don't have in memory.
					if(!__.path[soul]){ return }
					map(soul, node);
				}))){ return }
				gun.on('out', {gun: gun, opt: {websocket: false}, put: graph, '#': Gun.on.ask(function(ack, ev){
					if(!ack){ return }
					ev.off();
					return cb({body: {
						'#': server.msg(),
						'@': body['#'],
						'$': ack,
						'!': ack.err
					}});
				})});
			}
			server.msg = function(id){
				if(!id){
					return server.msg.debounce[id = Gun.text.random(9)] = Gun.time.is(), id;
				}
				clearTimeout(server.msg.clear);
				server.msg.clear = setTimeout(function(){
					var now = Gun.time.is();
					Gun.obj.map(server.msg.debounce, function(t,id){
						if((now - t) < (1000 * 60 * 5)){ return }
						Gun.obj.del(server.msg.debounce, id);
					});
				},500);
				if(server.msg.debounce[id]){ 
					return server.msg.debounce[id] = Gun.time.is(), id;
				}
				server.msg.debounce[id] = Gun.time.is();
				return;
			};	
			server.msg.debounce = server.msg.debounce || {};
		});

	})(require, './adapters/wsp');

}());

},{"../polyfill/peer":undefined,"./HAM":undefined,"./graph":undefined,"./gun":11,"./index":12,"./node":undefined,"./on":undefined,"./onify":undefined,"./request":undefined,"./state":undefined,"./type":undefined,"./val":undefined}],12:[function(require,module,exports){
module.exports = require('./lib/server');
},{"./lib/server":16}],13:[function(require,module,exports){
// This was written by the wonderful Forrest Tait
// modified by Mark to be part of core for convenience
// twas not designed for production use
// only simple local development.
var Gun = require('../gun'),
	fs = require('fs'),
	file = {};

// queue writes, adapted from https://github.com/toolness/jsondown/blob/master/jsondown.js
var isWriting = false, queuedWrites = [];
function writeFile(path, disk, at){
	if(isWriting) return queuedWrites.push(at);
	isWriting = true;
	var contents = JSON.stringify(disk, null, 2);
	fs.writeFile(String(path), contents, function(err) {
		var batch = queuedWrites.splice(0);
		isWriting = false;
		at.gun.Back(-1).on('in', {'@': at['#'], err: err, ok: err? false : 1});
		if(!batch.length){ return }
		batch.forEach(function(at){
			at.gun.Back(-1).on('in', {'@': at['#'], err: err, ok: err? false : 1});
		});
	});
}

Gun.on('put', function(at){
	var gun = at.gun, graph = at.put, opt = at.opt || {};
	var __ = gun._.root._;
	Gun.obj.map(graph, function(node, soul){
		file.disk.graph[soul] = __.graph[soul] || graph[soul];
	});
	writeFile(opt.file || file.file, file.disk, at);
});
Gun.on('get', function(at){
	var gun = at.gun, lex = at.get, opt = at.opt;
	if(!lex){return}
	gun.Back(-1).on('in', {'@': at['#'], put: Gun.graph.node(file.disk.graph[lex['#']])});
	//at.cb(null, file.disk.graph[lex['#']]);
});

Gun.on('opt', function(at){
	var gun = at.gun, opts = at.opt;
	if ((opts.file === false) || (opts.s3 && opts.s3.key)) {
		return; // don't use this plugin if S3 is being used.
	}
	console.log("WARNING! This `file.js` module for gun is intended only for local development testing!")
	file.file = opts.file || file.file || 'data.json';
	file.raw = file.raw || (fs.existsSync || require('path').existsSync)(opts.file) ? fs.readFileSync(opts.file).toString() : null;
	file.disk = file.disk || Gun.obj.ify(file.raw || {graph: {}});
	file.disk.graph = file.disk.graph || {};
});

},{"../gun":11,"fs":undefined,"path":undefined}],14:[function(require,module,exports){
var Gun = require('../gun')
,	formidable = require('formidable')
,	url = require('url');
module.exports = function(req, res, next){
	next = next || function(){}; // if not next, and we don't handle it, we should res.end
	if(!req || !res){ return next() }
	if(!req.url){ return next() }
	if(!req.method){ return next() }
	var msg = {};
	msg.url = url.parse(req.url, true);
	msg.method = (req.method||'').toLowerCase();
	msg.headers = req.headers;
	var u, body
	,	form = new formidable.IncomingForm()
	,	post = function(err, body){
		if(u !== body){ msg.body = body }
		next(msg, function(reply){
			if(!res){ return }
			if(!reply){ return res.end() }
			if(Gun.obj.has(reply, 'statusCode') || Gun.obj.has(reply, 'status')){
				res.statusCode = reply.statusCode || reply.status;
			}
			if(reply.headers){
				if(!(res.headersSent || res.headerSent || res._headerSent || res._headersSent)){
					Gun.obj.map(reply.headers, function(val, field){
						if(val !== 0 && !val){ return }
						res.setHeader(field, val);
					});
				}
			}
			if(Gun.obj.has(reply,'chunk') || Gun.obj.has(reply,'write')){
				res.write(Gun.text.ify(reply.chunk || reply.write) || '');
			}
			if(Gun.obj.has(reply,'body') || Gun.obj.has(reply,'end')){
				res.end(Gun.text.ify(reply.body || reply.end) || '');
			}
		});
	}
	form.on('field',function(k,v){
		(body = body || {})[k] = v;
	}).on('file',function(k,v){
		return; // files not supported in gun yet
	}).on('error',function(e){
		if(form.done){ return }
		post(e);
	}).on('end', function(){
		if(form.done){ return }
		post(null, body);
	});
	form.parse(req);
}
},{"../gun":11,"formidable":6,"url":undefined}],15:[function(require,module,exports){
var Gun = require('../gun');
module.exports = function(req, cb){
	if(!req.url || !req.url.query || !req.url.query.jsonp){ return cb }
	cb.jsonp = req.url.query.jsonp;
	delete req.url.query.jsonp;
	Gun.obj.map(Gun.obj.ify(req.url.query['`']), function(val, i){
		req.headers[i] = val;
	});
	delete req.url.query['`'];
	if(req.url.query.$){
		req.body = req.url.query.$;
		if(!Gun.obj.has(req.url.query, '^') || 'json' == req.url.query['^']){
			req.body = Gun.obj.ify(req.body); // TODO: BUG! THIS IS WRONG! This doesn't handle multipart chunking, and will fail!
		}
	}
	delete req.url.query.$;
	delete req.url.query['^'];
	delete req.url.query['%'];
	var reply = {headers:{}};
	return function(res){
		if(!res){ return }
		if(res.headers){
			Gun.obj.map(res.headers, function(val, field){
				reply.headers[field] = val;
			});
		}
		reply.headers['Content-Type'] = "text/javascript";
		if(Gun.obj.has(res,'chunk') && (!reply.body || Gun.list.is(reply.chunks))){
			(reply.chunks = reply.chunks || []).push(res.chunk);
		}
		if(Gun.obj.has(res,'body')){
			reply.body = res.body; // self-reference yourself so on the client we can get the headers and body.
			reply.body = ';'+ cb.jsonp + '(' + Gun.text.ify(reply) + ');'; // javascriptify it! can't believe the client trusts us.
			cb(reply);
		}
	}
}

},{"../gun":11}],16:[function(require,module,exports){
;(function(){
	console.log("Hello wonderful person! :) I'm mark@gunDB.io, message me for help or with hatemail. I want to hear from you! <3");
	var Gun = require('../gun');
	console.log("TODO: MARK! UPDATE S3 DRIVER BEFORE PUBLISHING!")
	//require('./s3');
	require('./wsp');
	require('./file');
	module.exports = Gun;
}());

},{"../gun":11,"./file":13,"./wsp":18}],17:[function(require,module,exports){
var Gun = require('../gun')
,	url = require('url');
module.exports = function(wss, server, opt){
	wss.on('connection', function(ws){
		var req = {};
		ws.upgradeReq = ws.upgradeReq || {};
		req.url = url.parse(ws.upgradeReq.url||'');
		req.method = (ws.upgradeReq.method||'').toLowerCase();
		req.headers = ws.upgradeReq.headers || {};
		//Gun.log("wsReq", req);
		ws.on('message', function(msg){
			msg = Gun.obj.ify(msg);
			msg.url = msg.url || {};
			msg.url.pathname = (req.url.pathname||'') + (msg.url.pathname||'');
			Gun.obj.map(req.url, function(val, i){
				msg.url[i] = msg.url[i] || val; // reattach url
			});
			msg.method = msg.method || msg.body? 'put' : 'get';
			msg.headers = msg.headers || {};
			Gun.obj.map(opt.headers || req.headers, function(val, i){
				msg.headers[i] = msg.headers[i]; // reattach headers
			});
			server.call(ws, msg, function(reply){
				if(!ws || !ws.send || !ws._socket || !ws._socket.writable){ return }
				reply = reply || {};
				if(msg && msg.headers && msg.headers['ws-rid']){
					(reply.headers = reply.headers || {})['ws-rid'] = msg.headers['ws-rid'];
				}
				try{ws.send(Gun.text.ify(reply));
				}catch(e){} // juuuust in case. 
			});
		});
		ws.off = function(m){
			//Gun.log("ws.off", m);
			ws.send = null;
		}
		ws.on('close', ws.off);
		ws.on('error', ws.off);
	});
}

},{"../gun":11,"url":undefined}],18:[function(require,module,exports){
(function (__dirname){
;(function(wsp){
	/*
		TODO: SERVER PUSH!
		TODO: SERVER GET!
		TODO: SERVER PUSH!
		TODO: SERVER GET!
		TODO: SERVER PUSH!
		TODO: SERVER GET!
		TODO: SERVER PUSH!
		TODO: SERVER GET!
		TODO: SERVER PUSH!
		TODO: SERVER GET!
		TODO: SERVER PUSH!
		TODO: SERVER GET!
	*/
	var Gun = require('../gun')
	, formidable = require('formidable')
	, ws = require('ws').Server
	, http = require('./http')
	, url = require('url');
	Gun.on('opt', function(at){
		var gun = at.gun, opt = at.opt;
		gun.__ = at.root._;
		gun.__.opt.ws = opt.ws = gun.__.opt.ws || opt.ws || {};
		function start(server, port, app){
			if(app && app.use){ app.use(gun.wsp.server) }
			server = gun.__.opt.ws.server = gun.__.opt.ws.server || opt.ws.server || server;
			require('./ws')(gun.wsp.ws = gun.wsp.ws || new ws(gun.__.opt.ws), function(req, res){
				var ws = this;
				req.headers['gun-sid'] = ws.sid = ws.sid? ws.sid : req.headers['gun-sid'];
				ws.sub = ws.sub || gun.wsp.on('network', function(msg, ev){
					if(!ws || !ws.send || !ws._socket || !ws._socket.writable){ return ev.off() }
					if(!msg || (msg.headers && msg.headers['gun-sid'] === ws.sid)){ return }
					if(msg && msg.headers){ delete msg.headers['ws-rid'] }
					// TODO: BUG? ^ What if other peers want to ack? Do they use the ws-rid or a gun declared id?
					try{ws.send(Gun.text.ify(msg));
					}catch(e){} // juuuust in case. 
				});
				gun.wsp.wire(req, res);
			}, {headers: {'ws-rid': 1, 'gun-sid': 1}});
			gun.__.opt.ws.port = gun.__.opt.ws.port || opt.ws.port || port || 80;
		}
		var wsp = gun.wsp = gun.wsp || function(server){
			if(!server){ return gun }
			if(Gun.fns.is(server.address)){
				if(server.address()){
					start(server, server.address().port);
					return gun;
				}
			}
			if(Gun.fns.is(server.get) && server.get('port')){
				start(server, server.get('port'));
				return gun;
			}
			var listen = server.listen;
			server.listen = function(port){
				var serve = listen.apply(server, arguments);
				start(serve, port, server);
				return serve;
			}
			return gun;
		}
		gun.wsp.on = gun.wsp.on || Gun.on;
		gun.wsp.regex = gun.wsp.regex || opt.route || opt.path || /^\/gun/i;
		gun.wsp.poll = gun.wsp.poll || opt.poll || 1;
		gun.wsp.pull = gun.wsp.pull || opt.pull || gun.wsp.poll * 1000;
		gun.wsp.server = gun.wsp.server || function(req, res, next){ // http
			next = next || function(){};
			if(!req || !res){ return next(), false }
			if(!req.upgrade){ return next(), false }
			if(!req.url){ return next(), false }
			if(!req.method){ return next(), false }
			var msg = {};
			msg.url = url.parse(req.url, true);
			if(!gun.wsp.regex.test(msg.url.pathname)){ return next(), false } // TODO: BUG! If the option isn't a regex then this will fail!
			if(msg.url.pathname.replace(gun.wsp.regex,'').slice(0,3).toLowerCase() === '.js'){
				res.writeHead(200, {'Content-Type': 'text/javascript'});
				res.end(gun.wsp.js = gun.wsp.js || require('fs').readFileSync(__dirname + '/../gun.js')); // gun server is caching the gun library for the client
				return true;
			}
			return http(req, res, function(req, res){
				if(!req){ return next() }
				var stream, cb = res = require('./jsonp')(req, res);
				if(req.headers && (stream = req.headers['gun-sid'])){
					stream = (gun.wsp.peers = gun.wsp.peers || {})[stream] = gun.wsp.peers[stream] || {sid: stream};
					stream.drain = stream.drain || function(res){
						if(!res || !stream || !stream.queue || !stream.queue.length){ return }
						res({headers: {'gun-sid': stream.sid}, body: stream.queue });
						stream.off = setTimeout(function(){ stream = null }, gun.wsp.pull);
						stream.reply = stream.queue = null;
						return true;
					}
					stream.sub = stream.sub || gun.wsp.on('network', function(req, ev){
						if(!stream){ return ev.off() } // self cleans up after itself!
						if(!req || (req.headers && req.headers['gun-sid'] === stream.sid)){ return }
						(stream.queue = stream.queue || []).push(req);
						stream.drain(stream.reply);
					});
					cb = function(r){ (r.headers||{}).poll = gun.wsp.poll; res(r) }
					clearTimeout(stream.off);
					if(req.headers.pull){
						if(stream.drain(cb)){ return }
						return stream.reply = cb;
					}
				}
				gun.wsp.wire(req, cb);
			}), true;
		}
		if((gun.__.opt.maxSockets = opt.maxSockets || gun.__.opt.maxSockets) !== false){
			require('https').globalAgent.maxSockets = require('http').globalAgent.maxSockets = gun.__.opt.maxSockets || Infinity;
		}
		gun.wsp.msg = gun.wsp.msg || function(id){
			if(!id){
				return gun.wsp.msg.debounce[id = Gun.text.random(9)] = Gun.time.is(), id;
			}
			clearTimeout(gun.wsp.msg.clear);
			gun.wsp.msg.clear = setTimeout(function(){
				var now = Gun.time.is();
				Gun.obj.map(gun.wsp.msg.debounce, function(t,id){
					if((now - t) < (1000 * 60 * 5)){ return }
					Gun.obj.del(gun.wsp.msg.debounce, id);
				});
			},500);
			if(id = gun.wsp.msg.debounce[id]){ 
				return gun.wsp.msg.debounce[id] = Gun.time.is(), id;
			}
			gun.wsp.msg.debounce[id] = Gun.time.is();
			return;
		};
		gun.wsp.msg.debounce = gun.wsp.msg.debounce || {};
		gun.wsp.wire = gun.wsp.wire || (function(){
			// all streams, technically PATCH but implemented as PUT or POST, are forwarded to other trusted peers
			// except for the ones that are listed in the message as having already been sending to.
			// all states, implemented with GET, are replied to the source that asked for it.
			function tran(req, res){
				if(!req || !res || !req.body || !req.headers){ return }
				if(req.url){ req.url = url.format(req.url) }
				var msg = req.body;
				// AUTH for non-replies.
				if(gun.wsp.msg(msg['#'])){ return }
				gun.wsp.on('network', Gun.obj.copy(req));
				if(msg['@']){ return } // no need to process.
				if(msg['$'] && msg['$']['#']){ return tran.get(req, res) }
				//if(Gun.is.lex(msg['$'])){ return tran.get(req, res) }
				else { return tran.put(req, res) }
				cb({body: {hello: 'world'}});
				// TODO: BUG! server put should push.
			}
			tran.get = function(req, cb){
				var body = req.body, lex = body['$'], reply = {headers: {'Content-Type': tran.json}}, opt;
				gun.on('out', {gun: gun, get: lex, req: 1, '#': Gun.on.ask(function(at, ev){
					ev.off();
					var graph = at.put;
					return cb({headers: reply.headers, body: {
						'#': gun.wsp.msg(),
						'@': body['#'],
						'$': graph,
						'!': at.err
					}});
					return;
					if(Gun.obj.empty(node)){
						return cb({headers: reply.headers, body: node});
					} // we're out of stuff!
					/*
					(function(chunks){ // FEATURE! Stream chunks if the nodes are large!
						var max = 10, count = 0, soul = Gun.is.node.soul(node);
						if(Object.keys(node).length > max){
							var n = Gun.is.node.soul.ify({}, soul);
							Gun.obj.map(node, function(val, field){
								if(!(++count % max)){
									cb({headers: reply.headers, chunk: n}); // send node chunks
									n = Gun.is.node.soul.ify({}, soul);
								}
								Gun.is.node.state.ify([n, node], field, val);
							});
							if(count % max){ // finish off the last chunk
								cb({headers: reply.headers, chunk: n});
							}
						} else {
							cb({headers: reply.headers, chunk: node}); // send full node
						}
					}([]));
					*/
					cb({headers: reply.headers, chunk: node }); // Use this if you don't want streaming chunks feature.
				})});
			}
			tran.put = function(req, cb){
				//console.log("tran.put", req);
				// NOTE: It is highly recommended you do your own PUT/POSTs through your own API that then saves to gun manually.
				// This will give you much more fine-grain control over security, transactions, and what not.
				var body = req.body, graph = body['$'], reply = {headers: {'Content-Type': tran.json}}, opt;
				gun.on('out', {gun: gun, put: graph, '#': Gun.on.ask(function(ack, ev){
				//Gun.on('put', {gun: gun, put: graph, '#': Gun.on.ask(function(ack, ev){
					ev.off();
					return cb({headers: reply.headers, body: {
						'#': gun.wsp.msg(),
						'@': body['#'],
						'$': ack,
						'!': ack.err
					}});
				})});
				return;
				if(Gun.is.graph(req.body)){
					if(req.err = Gun.union(gun, req.body, function(err, ctx){ // TODO: BUG? Probably should give me ctx.graph
						if(err){ return cb({headers: reply.headers, body: {err: err || "Union failed."}}) }
						var ctx = ctx || {}; ctx.graph = {};
						Gun.is.graph(req.body, function(node, soul){
							ctx.graph[soul] = gun.__.graph[soul];
						});
						(gun.__.opt.wire.put || function(g,cb){cb("No save.")})(ctx.graph, function(err, ok){
							if(err){ return cb({headers: reply.headers, body: {err: err || "Failed."}}) } // TODO: err should already be an error object?
							cb({headers: reply.headers, body: {ok: ok || "Persisted."}});
							//console.log("tran.put <------------------------", ok);
						});
					}).err){ cb({headers: reply.headers, body: {err: req.err || "Union failed."}}) }
				} else {
					cb({headers: reply.headers, body: {err: "Not a valid graph!"}});
				}
			}
			gun.wsp.on('network', function(req){
				// TODO: MARK! You should move the networking events to here, not in WSS only.
			});
			tran.json = 'application/json';
			return tran;
		}());
		if(opt.server){
			wsp(opt.server);
		}
	});
}({}));

}).call(this,"/javascript\\Voxelarium.js\\node_modules\\gun\\lib")

},{"../gun":11,"./http":14,"./jsonp":15,"./ws":17,"formidable":6,"fs":undefined,"http":undefined,"https":undefined,"url":undefined,"ws":21}],19:[function(require,module,exports){
/*!
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var fs = require('fs');

function Options(defaults) {
  var internalValues = {};
  var values = this.value = {};
  Object.keys(defaults).forEach(function(key) {
    internalValues[key] = defaults[key];
    Object.defineProperty(values, key, {
      get: function() { return internalValues[key]; },
      configurable: false,
      enumerable: true
    });
  });
  this.reset = function() {
    Object.keys(defaults).forEach(function(key) {
      internalValues[key] = defaults[key];
    });
    return this;
  };
  this.merge = function(options, required) {
    options = options || {};
    if (Object.prototype.toString.call(required) === '[object Array]') {
      var missing = [];
      for (var i = 0, l = required.length; i < l; ++i) {
        var key = required[i];
        if (!(key in options)) {
          missing.push(key);
        }
      }
      if (missing.length > 0) {
        if (missing.length > 1) {
          throw new Error('options ' +
            missing.slice(0, missing.length - 1).join(', ') + ' and ' +
            missing[missing.length - 1] + ' must be defined');
        }
        else throw new Error('option ' + missing[0] + ' must be defined');
      }
    }
    Object.keys(options).forEach(function(key) {
      if (key in internalValues) {
        internalValues[key] = options[key];
      }
    });
    return this;
  };
  this.copy = function(keys) {
    var obj = {};
    Object.keys(defaults).forEach(function(key) {
      if (keys.indexOf(key) !== -1) {
        obj[key] = values[key];
      }
    });
    return obj;
  };
  this.read = function(filename, cb) {
    if (typeof cb == 'function') {
      var self = this;
      fs.readFile(filename, function(error, data) {
        if (error) return cb(error);
        var conf = JSON.parse(data);
        self.merge(conf);
        cb();
      });
    }
    else {
      var conf = JSON.parse(fs.readFileSync(filename));
      this.merge(conf);
    }
    return this;
  };
  this.isDefined = function(key) {
    return typeof values[key] != 'undefined';
  };
  this.isDefinedAndNonNull = function(key) {
    return typeof values[key] != 'undefined' && values[key] !== null;
  };
  Object.freeze(values);
  Object.freeze(this);
}

module.exports = Options;

},{"fs":undefined}],20:[function(require,module,exports){
'use strict';

var has = Object.prototype.hasOwnProperty;

/**
 * An auto incrementing id which we can use to create "unique" Ultron instances
 * so we can track the event emitters that are added through the Ultron
 * interface.
 *
 * @type {Number}
 * @private
 */
var id = 0;

/**
 * Ultron is high-intelligence robot. It gathers intelligence so it can start improving
 * upon his rudimentary design. It will learn from your EventEmitting patterns
 * and exterminate them.
 *
 * @constructor
 * @param {EventEmitter} ee EventEmitter instance we need to wrap.
 * @api public
 */
function Ultron(ee) {
  if (!(this instanceof Ultron)) return new Ultron(ee);

  this.id = id++;
  this.ee = ee;
}

/**
 * Register a new EventListener for the given event.
 *
 * @param {String} event Name of the event.
 * @param {Functon} fn Callback function.
 * @param {Mixed} context The context of the function.
 * @returns {Ultron}
 * @api public
 */
Ultron.prototype.on = function on(event, fn, context) {
  fn.__ultron = this.id;
  this.ee.on(event, fn, context);

  return this;
};
/**
 * Add an EventListener that's only called once.
 *
 * @param {String} event Name of the event.
 * @param {Function} fn Callback function.
 * @param {Mixed} context The context of the function.
 * @returns {Ultron}
 * @api public
 */
Ultron.prototype.once = function once(event, fn, context) {
  fn.__ultron = this.id;
  this.ee.once(event, fn, context);

  return this;
};

/**
 * Remove the listeners we assigned for the given event.
 *
 * @returns {Ultron}
 * @api public
 */
Ultron.prototype.remove = function remove() {
  var args = arguments
    , event;

  //
  // When no event names are provided we assume that we need to clear all the
  // events that were assigned through us.
  //
  if (args.length === 1 && 'string' === typeof args[0]) {
    args = args[0].split(/[, ]+/);
  } else if (!args.length) {
    args = [];

    for (event in this.ee._events) {
      if (has.call(this.ee._events, event)) args.push(event);
    }
  }

  for (var i = 0; i < args.length; i++) {
    var listeners = this.ee.listeners(args[i]);

    for (var j = 0; j < listeners.length; j++) {
      event = listeners[j];

      //
      // Once listeners have a `listener` property that stores the real listener
      // in the EventEmitter that ships with Node.js.
      //
      if (event.listener) {
        if (event.listener.__ultron !== this.id) continue;
        delete event.listener.__ultron;
      } else {
        if (event.__ultron !== this.id) continue;
        delete event.__ultron;
      }

      this.ee.removeListener(args[i], event);
    }
  }

  return this;
};

/**
 * Destroy the Ultron instance, remove all listeners and release all references.
 *
 * @returns {Boolean}
 * @api public
 */
Ultron.prototype.destroy = function destroy() {
  if (!this.ee) return false;

  this.remove();
  this.ee = null;

  return true;
};

//
// Expose the module.
//
module.exports = Ultron;

},{}],21:[function(require,module,exports){
'use strict';

/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var WS = module.exports = require('./lib/WebSocket');

WS.Server = require('./lib/WebSocketServer');
WS.Sender = require('./lib/Sender');
WS.Receiver = require('./lib/Receiver');

/**
 * Create a new WebSocket server.
 *
 * @param {Object} options Server options
 * @param {Function} fn Optional connection listener.
 * @returns {WS.Server}
 * @api public
 */
WS.createServer = function createServer(options, fn) {
  var server = new WS.Server(options);

  if (typeof fn === 'function') {
    server.on('connection', fn);
  }

  return server;
};

/**
 * Create a new WebSocket connection.
 *
 * @param {String} address The URL/address we need to connect to.
 * @param {Function} fn Open listener.
 * @returns {WS}
 * @api public
 */
WS.connect = WS.createConnection = function connect(address, fn) {
  var client = new WS(address);

  if (typeof fn === 'function') {
    client.on('open', fn);
  }

  return client;
};

},{"./lib/Receiver":29,"./lib/Sender":31,"./lib/WebSocket":34,"./lib/WebSocketServer":35}],22:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var util = require('util');

function BufferPool(initialSize, growStrategy, shrinkStrategy) {
  if (this instanceof BufferPool === false) {
    throw new TypeError("Classes can't be function-called");
  }

  if (typeof initialSize === 'function') {
    shrinkStrategy = growStrategy;
    growStrategy = initialSize;
    initialSize = 0;
  }
  else if (typeof initialSize === 'undefined') {
    initialSize = 0;
  }
  this._growStrategy = (growStrategy || function(db, size) {
    return db.used + size;
  }).bind(null, this);
  this._shrinkStrategy = (shrinkStrategy || function(db) {
    return initialSize;
  }).bind(null, this);
  this._buffer = initialSize ? new Buffer(initialSize) : null;
  this._offset = 0;
  this._used = 0;
  this._changeFactor = 0;
  this.__defineGetter__('size', function(){
    return this._buffer == null ? 0 : this._buffer.length;
  });
  this.__defineGetter__('used', function(){
    return this._used;
  });
}

BufferPool.prototype.get = function(length) {
  if (this._buffer == null || this._offset + length > this._buffer.length) {
    var newBuf = new Buffer(this._growStrategy(length));
    this._buffer = newBuf;
    this._offset = 0;
  }
  this._used += length;
  var buf = this._buffer.slice(this._offset, this._offset + length);
  this._offset += length;
  return buf;
}

BufferPool.prototype.reset = function(forceNewBuffer) {
  var len = this._shrinkStrategy();
  if (len < this.size) this._changeFactor -= 1;
  if (forceNewBuffer || this._changeFactor < -2) {
    this._changeFactor = 0;
    this._buffer = len ? new Buffer(len) : null;
  }
  this._offset = 0;
  this._used = 0;
}

module.exports = BufferPool;

},{"util":undefined}],23:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

module.exports.BufferUtil = {
  merge: function(mergedBuffer, buffers) {
    var offset = 0;
    for (var i = 0, l = buffers.length; i < l; ++i) {
      var buf = buffers[i];
      buf.copy(mergedBuffer, offset);
      offset += buf.length;
    }
  },
  mask: function(source, mask, output, offset, length) {
    var maskNum = mask.readUInt32LE(0, true);
    var i = 0;
    for (; i < length - 3; i += 4) {
      var num = maskNum ^ source.readUInt32LE(i, true);
      if (num < 0) num = 4294967296 + num;
      output.writeUInt32LE(num, offset + i, true);
    }
    switch (length % 4) {
      case 3: output[offset + i + 2] = source[i + 2] ^ mask[2];
      case 2: output[offset + i + 1] = source[i + 1] ^ mask[1];
      case 1: output[offset + i] = source[i] ^ mask[0];
      case 0:;
    }
  },
  unmask: function(data, mask) {
    var maskNum = mask.readUInt32LE(0, true);
    var length = data.length;
    var i = 0;
    for (; i < length - 3; i += 4) {
      var num = maskNum ^ data.readUInt32LE(i, true);
      if (num < 0) num = 4294967296 + num;
      data.writeUInt32LE(num, i, true);
    }
    switch (length % 4) {
      case 3: data[i + 2] = data[i + 2] ^ mask[2];
      case 2: data[i + 1] = data[i + 1] ^ mask[1];
      case 1: data[i] = data[i] ^ mask[0];
      case 0:;
    }
  }
}

},{}],24:[function(require,module,exports){
'use strict';

/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

try {
  module.exports = require('bufferutil');
} catch (e) {
  module.exports = require('./BufferUtil.fallback');
}

},{"./BufferUtil.fallback":23,"bufferutil":undefined}],25:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

module.exports = {
  isValidErrorCode: function(code) {
    return (code >= 1000 && code <= 1011 && code != 1004 && code != 1005 && code != 1006) ||
         (code >= 3000 && code <= 4999);
  },
  1000: 'normal',
  1001: 'going away',
  1002: 'protocol error',
  1003: 'unsupported data',
  1004: 'reserved',
  1005: 'reserved for extensions',
  1006: 'reserved for extensions',
  1007: 'inconsistent or invalid data',
  1008: 'policy violation',
  1009: 'message too big',
  1010: 'extension handshake missing',
  1011: 'an unexpected condition prevented the request from being fulfilled',
};
},{}],26:[function(require,module,exports){

var util = require('util');

/**
 * Module exports.
 */

exports.parse = parse;
exports.format = format;

/**
 * Parse extensions header value
 */

function parse(value) {
  value = value || '';

  var extensions = {};

  value.split(',').forEach(function(v) {
    var params = v.split(';');
    var token = params.shift().trim();
    var paramsList = extensions[token] = extensions[token] || [];
    var parsedParams = {};

    params.forEach(function(param) {
      var parts = param.trim().split('=');
      var key = parts[0];
      var value = parts[1];
      if (typeof value === 'undefined') {
        value = true;
      } else {
        // unquote value
        if (value[0] === '"') {
          value = value.slice(1);
        }
        if (value[value.length - 1] === '"') {
          value = value.slice(0, value.length - 1);
        }
      }
      (parsedParams[key] = parsedParams[key] || []).push(value);
    });

    paramsList.push(parsedParams);
  });

  return extensions;
}

/**
 * Format extensions header value
 */

function format(value) {
  return Object.keys(value).map(function(token) {
    var paramsList = value[token];
    if (!util.isArray(paramsList)) {
      paramsList = [paramsList];
    }
    return paramsList.map(function(params) {
      return [token].concat(Object.keys(params).map(function(k) {
        var p = params[k];
        if (!util.isArray(p)) p = [p];
        return p.map(function(v) {
          return v === true ? k : k + '=' + v;
        }).join('; ');
      })).join('; ');
    }).join(', ');
  }).join(', ');
}

},{"util":undefined}],27:[function(require,module,exports){

var zlib = require('zlib');

var AVAILABLE_WINDOW_BITS = [8, 9, 10, 11, 12, 13, 14, 15];
var DEFAULT_WINDOW_BITS = 15;
var DEFAULT_MEM_LEVEL = 8;

PerMessageDeflate.extensionName = 'permessage-deflate';

/**
 * Per-message Compression Extensions implementation
 */

function PerMessageDeflate(options, isServer) {
  if (this instanceof PerMessageDeflate === false) {
    throw new TypeError("Classes can't be function-called");
  }

  this._options = options || {};
  this._isServer = !!isServer;
  this._inflate = null;
  this._deflate = null;
  this.params = null;
}

/**
 * Create extension parameters offer
 *
 * @api public
 */

PerMessageDeflate.prototype.offer = function() {
  var params = {};
  if (this._options.serverNoContextTakeover) {
    params.server_no_context_takeover = true;
  }
  if (this._options.clientNoContextTakeover) {
    params.client_no_context_takeover = true;
  }
  if (this._options.serverMaxWindowBits) {
    params.server_max_window_bits = this._options.serverMaxWindowBits;
  }
  if (this._options.clientMaxWindowBits) {
    params.client_max_window_bits = this._options.clientMaxWindowBits;
  } else if (this._options.clientMaxWindowBits == null) {
    params.client_max_window_bits = true;
  }
  return params;
};

/**
 * Accept extension offer
 *
 * @api public
 */

PerMessageDeflate.prototype.accept = function(paramsList) {
  paramsList = this.normalizeParams(paramsList);

  var params;
  if (this._isServer) {
    params = this.acceptAsServer(paramsList);
  } else {
    params = this.acceptAsClient(paramsList);
  }

  this.params = params;
  return params;
};

/**
 * Releases all resources used by the extension
 *
 * @api public
 */

PerMessageDeflate.prototype.cleanup = function() {
  if (this._inflate) {
    if (this._inflate.writeInProgress) {
      this._inflate.pendingClose = true;
    } else {
      if (this._inflate.close) this._inflate.close();
      this._inflate = null;
    }
  }
  if (this._deflate) {
    if (this._deflate.writeInProgress) {
      this._deflate.pendingClose = true;
    } else {
      if (this._deflate.close) this._deflate.close();
      this._deflate = null;
    }
  }
};

/**
 * Accept extension offer from client
 *
 * @api private
 */

PerMessageDeflate.prototype.acceptAsServer = function(paramsList) {
  var accepted = {};
  var result = paramsList.some(function(params) {
    accepted = {};
    if (this._options.serverNoContextTakeover === false && params.server_no_context_takeover) {
      return;
    }
    if (this._options.serverMaxWindowBits === false && params.server_max_window_bits) {
      return;
    }
    if (typeof this._options.serverMaxWindowBits === 'number' &&
        typeof params.server_max_window_bits === 'number' &&
        this._options.serverMaxWindowBits > params.server_max_window_bits) {
      return;
    }
    if (typeof this._options.clientMaxWindowBits === 'number' && !params.client_max_window_bits) {
      return;
    }

    if (this._options.serverNoContextTakeover || params.server_no_context_takeover) {
      accepted.server_no_context_takeover = true;
    }
    if (this._options.clientNoContextTakeover) {
      accepted.client_no_context_takeover = true;
    }
    if (this._options.clientNoContextTakeover !== false && params.client_no_context_takeover) {
      accepted.client_no_context_takeover = true;
    }
    if (typeof this._options.serverMaxWindowBits === 'number') {
      accepted.server_max_window_bits = this._options.serverMaxWindowBits;
    } else if (typeof params.server_max_window_bits === 'number') {
      accepted.server_max_window_bits = params.server_max_window_bits;
    }
    if (typeof this._options.clientMaxWindowBits === 'number') {
      accepted.client_max_window_bits = this._options.clientMaxWindowBits;
    } else if (this._options.clientMaxWindowBits !== false && typeof params.client_max_window_bits === 'number') {
      accepted.client_max_window_bits = params.client_max_window_bits;
    }
    return true;
  }, this);

  if (!result) {
    throw new Error('Doesn\'t support the offered configuration');
  }

  return accepted;
};

/**
 * Accept extension response from server
 *
 * @api privaye
 */

PerMessageDeflate.prototype.acceptAsClient = function(paramsList) {
  var params = paramsList[0];
  if (this._options.clientNoContextTakeover != null) {
    if (this._options.clientNoContextTakeover === false && params.client_no_context_takeover) {
      throw new Error('Invalid value for "client_no_context_takeover"');
    }
  }
  if (this._options.clientMaxWindowBits != null) {
    if (this._options.clientMaxWindowBits === false && params.client_max_window_bits) {
      throw new Error('Invalid value for "client_max_window_bits"');
    }
    if (typeof this._options.clientMaxWindowBits === 'number' &&
        (!params.client_max_window_bits || params.client_max_window_bits > this._options.clientMaxWindowBits)) {
      throw new Error('Invalid value for "client_max_window_bits"');
    }
  }
  return params;
};

/**
 * Normalize extensions parameters
 *
 * @api private
 */

PerMessageDeflate.prototype.normalizeParams = function(paramsList) {
  return paramsList.map(function(params) {
    Object.keys(params).forEach(function(key) {
      var value = params[key];
      if (value.length > 1) {
        throw new Error('Multiple extension parameters for ' + key);
      }

      value = value[0];

      switch (key) {
      case 'server_no_context_takeover':
      case 'client_no_context_takeover':
        if (value !== true) {
          throw new Error('invalid extension parameter value for ' + key + ' (' + value + ')');
        }
        params[key] = true;
        break;
      case 'server_max_window_bits':
      case 'client_max_window_bits':
        if (typeof value === 'string') {
          value = parseInt(value, 10);
          if (!~AVAILABLE_WINDOW_BITS.indexOf(value)) {
            throw new Error('invalid extension parameter value for ' + key + ' (' + value + ')');
          }
        }
        if (!this._isServer && value === true) {
          throw new Error('Missing extension parameter value for ' + key);
        }
        params[key] = value;
        break;
      default:
        throw new Error('Not defined extension parameter (' + key + ')');
      }
    }, this);
    return params;
  }, this);
};

/**
 * Decompress message
 *
 * @api public
 */

PerMessageDeflate.prototype.decompress = function (data, fin, callback) {
  var endpoint = this._isServer ? 'client' : 'server';

  if (!this._inflate) {
    var maxWindowBits = this.params[endpoint + '_max_window_bits'];
    this._inflate = zlib.createInflateRaw({
      windowBits: 'number' === typeof maxWindowBits ? maxWindowBits : DEFAULT_WINDOW_BITS
    });
  }
  this._inflate.writeInProgress = true;

  var self = this;
  var buffers = [];

  this._inflate.on('error', onError).on('data', onData);
  this._inflate.write(data);
  if (fin) {
    this._inflate.write(new Buffer([0x00, 0x00, 0xff, 0xff]));
  }
  this._inflate.flush(function() {
    cleanup();
    callback(null, Buffer.concat(buffers));
  });

  function onError(err) {
    cleanup();
    callback(err);
  }

  function onData(data) {
    buffers.push(data);
  }

  function cleanup() {
    if (!self._inflate) return;
    self._inflate.removeListener('error', onError);
    self._inflate.removeListener('data', onData);
    self._inflate.writeInProgress = false;
    if ((fin && self.params[endpoint + '_no_context_takeover']) || self._inflate.pendingClose) {
      if (self._inflate.close) self._inflate.close();
      self._inflate = null;
    }
  }
};

/**
 * Compress message
 *
 * @api public
 */

PerMessageDeflate.prototype.compress = function (data, fin, callback) {
  var endpoint = this._isServer ? 'server' : 'client';

  if (!this._deflate) {
    var maxWindowBits = this.params[endpoint + '_max_window_bits'];
    this._deflate = zlib.createDeflateRaw({
      flush: zlib.Z_SYNC_FLUSH,
      windowBits: 'number' === typeof maxWindowBits ? maxWindowBits : DEFAULT_WINDOW_BITS,
      memLevel: this._options.memLevel || DEFAULT_MEM_LEVEL
    });
  }
  this._deflate.writeInProgress = true;

  var self = this;
  var buffers = [];

  this._deflate.on('error', onError).on('data', onData);
  this._deflate.write(data);
  this._deflate.flush(function() {
    cleanup();
    var data = Buffer.concat(buffers);
    if (fin) {
      data = data.slice(0, data.length - 4);
    }
    callback(null, data);
  });

  function onError(err) {
    cleanup();
    callback(err);
  }

  function onData(data) {
    buffers.push(data);
  }

  function cleanup() {
    if (!self._deflate) return;
    self._deflate.removeListener('error', onError);
    self._deflate.removeListener('data', onData);
    self._deflate.writeInProgress = false;
    if ((fin && self.params[endpoint + '_no_context_takeover']) || self._deflate.pendingClose) {
      if (self._deflate.close) self._deflate.close();
      self._deflate = null;
    }
  }
};

module.exports = PerMessageDeflate;

},{"zlib":undefined}],28:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var util = require('util');

/**
 * State constants
 */

var EMPTY = 0
  , BODY = 1;
var BINARYLENGTH = 2
  , BINARYBODY = 3;

/**
 * Hixie Receiver implementation
 */

function Receiver () {
  if (this instanceof Receiver === false) {
    throw new TypeError("Classes can't be function-called");
  }

  this.state = EMPTY;
  this.buffers = [];
  this.messageEnd = -1;
  this.spanLength = 0;
  this.dead = false;

  this.onerror = function() {};
  this.ontext = function() {};
  this.onbinary = function() {};
  this.onclose = function() {};
  this.onping = function() {};
  this.onpong = function() {};
}

module.exports = Receiver;

/**
 * Add new data to the parser.
 *
 * @api public
 */

Receiver.prototype.add = function(data) {
  var self = this;
  function doAdd() {
    if (self.state === EMPTY) {
      if (data.length == 2 && data[0] == 0xFF && data[1] == 0x00) {
        self.reset();
        self.onclose();
        return;
      }
      if (data[0] === 0x80) {
        self.messageEnd = 0;
        self.state = BINARYLENGTH;
        data = data.slice(1);
      } else {

      if (data[0] !== 0x00) {
        self.error('payload must start with 0x00 byte', true);
        return;
      }
      data = data.slice(1);
      self.state = BODY;

      }
    }
    if (self.state === BINARYLENGTH) {
      var i = 0;
      while ((i < data.length) && (data[i] & 0x80)) {
        self.messageEnd = 128 * self.messageEnd + (data[i] & 0x7f);
        ++i;
      }
      if (i < data.length) {
        self.messageEnd = 128 * self.messageEnd + (data[i] & 0x7f);
        self.state = BINARYBODY;
        ++i;
      }
      if (i > 0)
        data = data.slice(i);
    }
    if (self.state === BINARYBODY) {
      var dataleft = self.messageEnd - self.spanLength;
      if (data.length >= dataleft) {
        // consume the whole buffer to finish the frame
        self.buffers.push(data);
        self.spanLength += dataleft;
        self.messageEnd = dataleft;
        return self.parse();
      }
      // frame's not done even if we consume it all
      self.buffers.push(data);
      self.spanLength += data.length;
      return;
    }
    self.buffers.push(data);
    if ((self.messageEnd = bufferIndex(data, 0xFF)) != -1) {
      self.spanLength += self.messageEnd;
      return self.parse();
    }
    else self.spanLength += data.length;
  }
  while(data) data = doAdd();
};

/**
 * Releases all resources used by the receiver.
 *
 * @api public
 */

Receiver.prototype.cleanup = function() {
  this.dead = true;
  this.state = EMPTY;
  this.buffers = [];
};

/**
 * Process buffered data.
 *
 * @api public
 */

Receiver.prototype.parse = function() {
  var output = new Buffer(this.spanLength);
  var outputIndex = 0;
  for (var bi = 0, bl = this.buffers.length; bi < bl - 1; ++bi) {
    var buffer = this.buffers[bi];
    buffer.copy(output, outputIndex);
    outputIndex += buffer.length;
  }
  var lastBuffer = this.buffers[this.buffers.length - 1];
  if (this.messageEnd > 0) lastBuffer.copy(output, outputIndex, 0, this.messageEnd);
  if (this.state !== BODY) --this.messageEnd;
  var tail = null;
  if (this.messageEnd < lastBuffer.length - 1) {
    tail = lastBuffer.slice(this.messageEnd + 1);
  }
  this.reset();
  this.ontext(output.toString('utf8'));
  return tail;
};

/**
 * Handles an error
 *
 * @api private
 */

Receiver.prototype.error = function (reason, terminate) {
  this.reset();
  this.onerror(reason, terminate);
  return this;
};

/**
 * Reset parser state
 *
 * @api private
 */

Receiver.prototype.reset = function (reason) {
  if (this.dead) return;
  this.state = EMPTY;
  this.buffers = [];
  this.messageEnd = -1;
  this.spanLength = 0;
};

/**
 * Internal api
 */

function bufferIndex(buffer, byte) {
  for (var i = 0, l = buffer.length; i < l; ++i) {
    if (buffer[i] === byte) return i;
  }
  return -1;
}

},{"util":undefined}],29:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var util = require('util')
  , Validation = require('./Validation').Validation
  , ErrorCodes = require('./ErrorCodes')
  , BufferPool = require('./BufferPool')
  , bufferUtil = require('./BufferUtil').BufferUtil
  , PerMessageDeflate = require('./PerMessageDeflate');

/**
 * HyBi Receiver implementation
 */

function Receiver (extensions) {
  if (this instanceof Receiver === false) {
    throw new TypeError("Classes can't be function-called");
  }

  // memory pool for fragmented messages
  var fragmentedPoolPrevUsed = -1;
  this.fragmentedBufferPool = new BufferPool(1024, function(db, length) {
    return db.used + length;
  }, function(db) {
    return fragmentedPoolPrevUsed = fragmentedPoolPrevUsed >= 0 ?
      Math.ceil((fragmentedPoolPrevUsed + db.used) / 2) :
      db.used;
  });

  // memory pool for unfragmented messages
  var unfragmentedPoolPrevUsed = -1;
  this.unfragmentedBufferPool = new BufferPool(1024, function(db, length) {
    return db.used + length;
  }, function(db) {
    return unfragmentedPoolPrevUsed = unfragmentedPoolPrevUsed >= 0 ?
      Math.ceil((unfragmentedPoolPrevUsed + db.used) / 2) :
      db.used;
  });

  this.extensions = extensions || {};
  this.state = {
    activeFragmentedOperation: null,
    lastFragment: false,
    masked: false,
    opcode: 0,
    fragmentedOperation: false
  };
  this.overflow = [];
  this.headerBuffer = new Buffer(10);
  this.expectOffset = 0;
  this.expectBuffer = null;
  this.expectHandler = null;
  this.currentMessage = [];
  this.messageHandlers = [];
  this.expectHeader(2, this.processPacket);
  this.dead = false;
  this.processing = false;

  this.onerror = function() {};
  this.ontext = function() {};
  this.onbinary = function() {};
  this.onclose = function() {};
  this.onping = function() {};
  this.onpong = function() {};
}

module.exports = Receiver;

/**
 * Add new data to the parser.
 *
 * @api public
 */

Receiver.prototype.add = function(data) {
  var dataLength = data.length;
  if (dataLength == 0) return;
  if (this.expectBuffer == null) {
    this.overflow.push(data);
    return;
  }
  var toRead = Math.min(dataLength, this.expectBuffer.length - this.expectOffset);
  fastCopy(toRead, data, this.expectBuffer, this.expectOffset);
  this.expectOffset += toRead;
  if (toRead < dataLength) {
    this.overflow.push(data.slice(toRead));
  }
  while (this.expectBuffer && this.expectOffset == this.expectBuffer.length) {
    var bufferForHandler = this.expectBuffer;
    this.expectBuffer = null;
    this.expectOffset = 0;
    this.expectHandler.call(this, bufferForHandler);
  }
};

/**
 * Releases all resources used by the receiver.
 *
 * @api public
 */

Receiver.prototype.cleanup = function() {
  this.dead = true;
  this.overflow = null;
  this.headerBuffer = null;
  this.expectBuffer = null;
  this.expectHandler = null;
  this.unfragmentedBufferPool = null;
  this.fragmentedBufferPool = null;
  this.state = null;
  this.currentMessage = null;
  this.onerror = null;
  this.ontext = null;
  this.onbinary = null;
  this.onclose = null;
  this.onping = null;
  this.onpong = null;
};

/**
 * Waits for a certain amount of header bytes to be available, then fires a callback.
 *
 * @api private
 */

Receiver.prototype.expectHeader = function(length, handler) {
  if (length == 0) {
    handler(null);
    return;
  }
  this.expectBuffer = this.headerBuffer.slice(this.expectOffset, this.expectOffset + length);
  this.expectHandler = handler;
  var toRead = length;
  while (toRead > 0 && this.overflow.length > 0) {
    var fromOverflow = this.overflow.pop();
    if (toRead < fromOverflow.length) this.overflow.push(fromOverflow.slice(toRead));
    var read = Math.min(fromOverflow.length, toRead);
    fastCopy(read, fromOverflow, this.expectBuffer, this.expectOffset);
    this.expectOffset += read;
    toRead -= read;
  }
};

/**
 * Waits for a certain amount of data bytes to be available, then fires a callback.
 *
 * @api private
 */

Receiver.prototype.expectData = function(length, handler) {
  if (length == 0) {
    handler(null);
    return;
  }
  this.expectBuffer = this.allocateFromPool(length, this.state.fragmentedOperation);
  this.expectHandler = handler;
  var toRead = length;
  while (toRead > 0 && this.overflow.length > 0) {
    var fromOverflow = this.overflow.pop();
    if (toRead < fromOverflow.length) this.overflow.push(fromOverflow.slice(toRead));
    var read = Math.min(fromOverflow.length, toRead);
    fastCopy(read, fromOverflow, this.expectBuffer, this.expectOffset);
    this.expectOffset += read;
    toRead -= read;
  }
};

/**
 * Allocates memory from the buffer pool.
 *
 * @api private
 */

Receiver.prototype.allocateFromPool = function(length, isFragmented) {
  return (isFragmented ? this.fragmentedBufferPool : this.unfragmentedBufferPool).get(length);
};

/**
 * Start processing a new packet.
 *
 * @api private
 */

Receiver.prototype.processPacket = function (data) {
  if (this.extensions[PerMessageDeflate.extensionName]) {
    if ((data[0] & 0x30) != 0) {
      this.error('reserved fields (2, 3) must be empty', 1002);
      return;
    }
  } else {
    if ((data[0] & 0x70) != 0) {
      this.error('reserved fields must be empty', 1002);
      return;
    }
  }
  this.state.lastFragment = (data[0] & 0x80) == 0x80;
  this.state.masked = (data[1] & 0x80) == 0x80;
  var compressed = (data[0] & 0x40) == 0x40;
  var opcode = data[0] & 0xf;
  if (opcode === 0) {
    if (compressed) {
      this.error('continuation frame cannot have the Per-message Compressed bits', 1002);
      return;
    }
    // continuation frame
    this.state.fragmentedOperation = true;
    this.state.opcode = this.state.activeFragmentedOperation;
    if (!(this.state.opcode == 1 || this.state.opcode == 2)) {
      this.error('continuation frame cannot follow current opcode', 1002);
      return;
    }
  }
  else {
    if (opcode < 3 && this.state.activeFragmentedOperation != null) {
      this.error('data frames after the initial data frame must have opcode 0', 1002);
      return;
    }
    if (opcode >= 8 && compressed) {
      this.error('control frames cannot have the Per-message Compressed bits', 1002);
      return;
    }
    this.state.compressed = compressed;
    this.state.opcode = opcode;
    if (this.state.lastFragment === false) {
      this.state.fragmentedOperation = true;
      this.state.activeFragmentedOperation = opcode;
    }
    else this.state.fragmentedOperation = false;
  }
  var handler = opcodes[this.state.opcode];
  if (typeof handler == 'undefined') this.error('no handler for opcode ' + this.state.opcode, 1002);
  else {
    handler.start.call(this, data);
  }
};

/**
 * Endprocessing a packet.
 *
 * @api private
 */

Receiver.prototype.endPacket = function() {
  if (!this.state.fragmentedOperation) this.unfragmentedBufferPool.reset(true);
  else if (this.state.lastFragment) this.fragmentedBufferPool.reset(true);
  this.expectOffset = 0;
  this.expectBuffer = null;
  this.expectHandler = null;
  if (this.state.lastFragment && this.state.opcode === this.state.activeFragmentedOperation) {
    // end current fragmented operation
    this.state.activeFragmentedOperation = null;
  }
  this.state.lastFragment = false;
  this.state.opcode = this.state.activeFragmentedOperation != null ? this.state.activeFragmentedOperation : 0;
  this.state.masked = false;
  this.expectHeader(2, this.processPacket);
};

/**
 * Reset the parser state.
 *
 * @api private
 */

Receiver.prototype.reset = function() {
  if (this.dead) return;
  this.state = {
    activeFragmentedOperation: null,
    lastFragment: false,
    masked: false,
    opcode: 0,
    fragmentedOperation: false
  };
  this.fragmentedBufferPool.reset(true);
  this.unfragmentedBufferPool.reset(true);
  this.expectOffset = 0;
  this.expectBuffer = null;
  this.expectHandler = null;
  this.overflow = [];
  this.currentMessage = [];
  this.messageHandlers = [];
};

/**
 * Unmask received data.
 *
 * @api private
 */

Receiver.prototype.unmask = function (mask, buf, binary) {
  if (mask != null && buf != null) bufferUtil.unmask(buf, mask);
  if (binary) return buf;
  return buf != null ? buf.toString('utf8') : '';
};

/**
 * Concatenates a list of buffers.
 *
 * @api private
 */

Receiver.prototype.concatBuffers = function(buffers) {
  var length = 0;
  for (var i = 0, l = buffers.length; i < l; ++i) length += buffers[i].length;
  var mergedBuffer = new Buffer(length);
  bufferUtil.merge(mergedBuffer, buffers);
  return mergedBuffer;
};

/**
 * Handles an error
 *
 * @api private
 */

Receiver.prototype.error = function (reason, protocolErrorCode) {
  this.reset();
  this.onerror(reason, protocolErrorCode);
  return this;
};

/**
 * Execute message handler buffers
 *
 * @api private
 */

Receiver.prototype.flush = function() {
  if (this.processing || this.dead) return;

  var handler = this.messageHandlers.shift();
  if (!handler) return;

  this.processing = true;
  var self = this;

  handler(function() {
    self.processing = false;
    self.flush();
  });
};

/**
 * Apply extensions to message
 *
 * @api private
 */

Receiver.prototype.applyExtensions = function(messageBuffer, fin, compressed, callback) {
  var self = this;
  if (compressed) {
    this.extensions[PerMessageDeflate.extensionName].decompress(messageBuffer, fin, function(err, buffer) {
      if (self.dead) return;
      if (err) {
        callback(new Error('invalid compressed data'));
        return;
      }
      callback(null, buffer);
    });
  } else {
    callback(null, messageBuffer);
  }
};

/**
 * Buffer utilities
 */

function readUInt16BE(start) {
  return (this[start]<<8) +
         this[start+1];
}

function readUInt32BE(start) {
  return (this[start]<<24) +
         (this[start+1]<<16) +
         (this[start+2]<<8) +
         this[start+3];
}

function fastCopy(length, srcBuffer, dstBuffer, dstOffset) {
  switch (length) {
    default: srcBuffer.copy(dstBuffer, dstOffset, 0, length); break;
    case 16: dstBuffer[dstOffset+15] = srcBuffer[15];
    case 15: dstBuffer[dstOffset+14] = srcBuffer[14];
    case 14: dstBuffer[dstOffset+13] = srcBuffer[13];
    case 13: dstBuffer[dstOffset+12] = srcBuffer[12];
    case 12: dstBuffer[dstOffset+11] = srcBuffer[11];
    case 11: dstBuffer[dstOffset+10] = srcBuffer[10];
    case 10: dstBuffer[dstOffset+9] = srcBuffer[9];
    case 9: dstBuffer[dstOffset+8] = srcBuffer[8];
    case 8: dstBuffer[dstOffset+7] = srcBuffer[7];
    case 7: dstBuffer[dstOffset+6] = srcBuffer[6];
    case 6: dstBuffer[dstOffset+5] = srcBuffer[5];
    case 5: dstBuffer[dstOffset+4] = srcBuffer[4];
    case 4: dstBuffer[dstOffset+3] = srcBuffer[3];
    case 3: dstBuffer[dstOffset+2] = srcBuffer[2];
    case 2: dstBuffer[dstOffset+1] = srcBuffer[1];
    case 1: dstBuffer[dstOffset] = srcBuffer[0];
  }
}

function clone(obj) {
  var cloned = {};
  for (var k in obj) {
    if (obj.hasOwnProperty(k)) {
      cloned[k] = obj[k];
    }
  }
  return cloned;
}

/**
 * Opcode handlers
 */

var opcodes = {
  // text
  '1': {
    start: function(data) {
      var self = this;
      // decode length
      var firstLength = data[1] & 0x7f;
      if (firstLength < 126) {
        opcodes['1'].getData.call(self, firstLength);
      }
      else if (firstLength == 126) {
        self.expectHeader(2, function(data) {
          opcodes['1'].getData.call(self, readUInt16BE.call(data, 0));
        });
      }
      else if (firstLength == 127) {
        self.expectHeader(8, function(data) {
          if (readUInt32BE.call(data, 0) != 0) {
            self.error('packets with length spanning more than 32 bit is currently not supported', 1008);
            return;
          }
          opcodes['1'].getData.call(self, readUInt32BE.call(data, 4));
        });
      }
    },
    getData: function(length) {
      var self = this;
      if (self.state.masked) {
        self.expectHeader(4, function(data) {
          var mask = data;
          self.expectData(length, function(data) {
            opcodes['1'].finish.call(self, mask, data);
          });
        });
      }
      else {
        self.expectData(length, function(data) {
          opcodes['1'].finish.call(self, null, data);
        });
      }
    },
    finish: function(mask, data) {
      var self = this;
      var packet = this.unmask(mask, data, true) || new Buffer(0);
      var state = clone(this.state);
      this.messageHandlers.push(function(callback) {
        self.applyExtensions(packet, state.lastFragment, state.compressed, function(err, buffer) {
          if (err) return self.error(err.message, 1007);
          if (buffer != null) self.currentMessage.push(buffer);

          if (state.lastFragment) {
            var messageBuffer = self.concatBuffers(self.currentMessage);
            self.currentMessage = [];
            if (!Validation.isValidUTF8(messageBuffer)) {
              self.error('invalid utf8 sequence', 1007);
              return;
            }
            self.ontext(messageBuffer.toString('utf8'), {masked: state.masked, buffer: messageBuffer});
          }
          callback();
        });
      });
      this.flush();
      this.endPacket();
    }
  },
  // binary
  '2': {
    start: function(data) {
      var self = this;
      // decode length
      var firstLength = data[1] & 0x7f;
      if (firstLength < 126) {
        opcodes['2'].getData.call(self, firstLength);
      }
      else if (firstLength == 126) {
        self.expectHeader(2, function(data) {
          opcodes['2'].getData.call(self, readUInt16BE.call(data, 0));
        });
      }
      else if (firstLength == 127) {
        self.expectHeader(8, function(data) {
          if (readUInt32BE.call(data, 0) != 0) {
            self.error('packets with length spanning more than 32 bit is currently not supported', 1008);
            return;
          }
          opcodes['2'].getData.call(self, readUInt32BE.call(data, 4, true));
        });
      }
    },
    getData: function(length) {
      var self = this;
      if (self.state.masked) {
        self.expectHeader(4, function(data) {
          var mask = data;
          self.expectData(length, function(data) {
            opcodes['2'].finish.call(self, mask, data);
          });
        });
      }
      else {
        self.expectData(length, function(data) {
          opcodes['2'].finish.call(self, null, data);
        });
      }
    },
    finish: function(mask, data) {
      var self = this;
      var packet = this.unmask(mask, data, true) || new Buffer(0);
      var state = clone(this.state);
      this.messageHandlers.push(function(callback) {
        self.applyExtensions(packet, state.lastFragment, state.compressed, function(err, buffer) {
          if (err) return self.error(err.message, 1007);
          if (buffer != null) self.currentMessage.push(buffer);
          if (state.lastFragment) {
            var messageBuffer = self.concatBuffers(self.currentMessage);
            self.currentMessage = [];
            self.onbinary(messageBuffer, {masked: state.masked, buffer: messageBuffer});
          }
          callback();
        });
      });
      this.flush();
      this.endPacket();
    }
  },
  // close
  '8': {
    start: function(data) {
      var self = this;
      if (self.state.lastFragment == false) {
        self.error('fragmented close is not supported', 1002);
        return;
      }

      // decode length
      var firstLength = data[1] & 0x7f;
      if (firstLength < 126) {
        opcodes['8'].getData.call(self, firstLength);
      }
      else {
        self.error('control frames cannot have more than 125 bytes of data', 1002);
      }
    },
    getData: function(length) {
      var self = this;
      if (self.state.masked) {
        self.expectHeader(4, function(data) {
          var mask = data;
          self.expectData(length, function(data) {
            opcodes['8'].finish.call(self, mask, data);
          });
        });
      }
      else {
        self.expectData(length, function(data) {
          opcodes['8'].finish.call(self, null, data);
        });
      }
    },
    finish: function(mask, data) {
      var self = this;
      data = self.unmask(mask, data, true);

      var state = clone(this.state);
      this.messageHandlers.push(function() {
        if (data && data.length == 1) {
          self.error('close packets with data must be at least two bytes long', 1002);
          return;
        }
        var code = data && data.length > 1 ? readUInt16BE.call(data, 0) : 1000;
        if (!ErrorCodes.isValidErrorCode(code)) {
          self.error('invalid error code', 1002);
          return;
        }
        var message = '';
        if (data && data.length > 2) {
          var messageBuffer = data.slice(2);
          if (!Validation.isValidUTF8(messageBuffer)) {
            self.error('invalid utf8 sequence', 1007);
            return;
          }
          message = messageBuffer.toString('utf8');
        }
        self.onclose(code, message, {masked: state.masked});
        self.reset();
      });
      this.flush();
    },
  },
  // ping
  '9': {
    start: function(data) {
      var self = this;
      if (self.state.lastFragment == false) {
        self.error('fragmented ping is not supported', 1002);
        return;
      }

      // decode length
      var firstLength = data[1] & 0x7f;
      if (firstLength < 126) {
        opcodes['9'].getData.call(self, firstLength);
      }
      else {
        self.error('control frames cannot have more than 125 bytes of data', 1002);
      }
    },
    getData: function(length) {
      var self = this;
      if (self.state.masked) {
        self.expectHeader(4, function(data) {
          var mask = data;
          self.expectData(length, function(data) {
            opcodes['9'].finish.call(self, mask, data);
          });
        });
      }
      else {
        self.expectData(length, function(data) {
          opcodes['9'].finish.call(self, null, data);
        });
      }
    },
    finish: function(mask, data) {
      var self = this;
      data = this.unmask(mask, data, true);
      var state = clone(this.state);
      this.messageHandlers.push(function(callback) {
        self.onping(data, {masked: state.masked, binary: true});
        callback();
      });
      this.flush();
      this.endPacket();
    }
  },
  // pong
  '10': {
    start: function(data) {
      var self = this;
      if (self.state.lastFragment == false) {
        self.error('fragmented pong is not supported', 1002);
        return;
      }

      // decode length
      var firstLength = data[1] & 0x7f;
      if (firstLength < 126) {
        opcodes['10'].getData.call(self, firstLength);
      }
      else {
        self.error('control frames cannot have more than 125 bytes of data', 1002);
      }
    },
    getData: function(length) {
      var self = this;
      if (this.state.masked) {
        this.expectHeader(4, function(data) {
          var mask = data;
          self.expectData(length, function(data) {
            opcodes['10'].finish.call(self, mask, data);
          });
        });
      }
      else {
        this.expectData(length, function(data) {
          opcodes['10'].finish.call(self, null, data);
        });
      }
    },
    finish: function(mask, data) {
      var self = this;
      data = self.unmask(mask, data, true);
      var state = clone(this.state);
      this.messageHandlers.push(function(callback) {
        self.onpong(data, {masked: state.masked, binary: true});
        callback();
      });
      this.flush();
      this.endPacket();
    }
  }
}

},{"./BufferPool":22,"./BufferUtil":24,"./ErrorCodes":25,"./PerMessageDeflate":27,"./Validation":33,"util":undefined}],30:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var events = require('events')
  , util = require('util')
  , EventEmitter = events.EventEmitter;

/**
 * Hixie Sender implementation
 */

function Sender(socket) {
  if (this instanceof Sender === false) {
    throw new TypeError("Classes can't be function-called");
  }

  events.EventEmitter.call(this);

  this.socket = socket;
  this.continuationFrame = false;
  this.isClosed = false;
}

module.exports = Sender;

/**
 * Inherits from EventEmitter.
 */

util.inherits(Sender, events.EventEmitter);

/**
 * Frames and writes data.
 *
 * @api public
 */

Sender.prototype.send = function(data, options, cb) {
  if (this.isClosed) return;

  var isString = typeof data == 'string'
    , length = isString ? Buffer.byteLength(data) : data.length
    , lengthbytes = (length > 127) ? 2 : 1 // assume less than 2**14 bytes
    , writeStartMarker = this.continuationFrame == false
    , writeEndMarker = !options || !(typeof options.fin != 'undefined' && !options.fin)
    , buffer = new Buffer((writeStartMarker ? ((options && options.binary) ? (1 + lengthbytes) : 1) : 0) + length + ((writeEndMarker && !(options && options.binary)) ? 1 : 0))
    , offset = writeStartMarker ? 1 : 0;

  if (writeStartMarker) {
    if (options && options.binary) {
      buffer.write('\x80', 'binary');
      // assume length less than 2**14 bytes
      if (lengthbytes > 1)
        buffer.write(String.fromCharCode(128+length/128), offset++, 'binary');
      buffer.write(String.fromCharCode(length&0x7f), offset++, 'binary');
    } else
      buffer.write('\x00', 'binary');
  }

  if (isString) buffer.write(data, offset, 'utf8');
  else data.copy(buffer, offset, 0);

  if (writeEndMarker) {
    if (options && options.binary) {
      // sending binary, not writing end marker
    } else
      buffer.write('\xff', offset + length, 'binary');
    this.continuationFrame = false;
  }
  else this.continuationFrame = true;

  try {
    this.socket.write(buffer, 'binary', cb);
  } catch (e) {
    this.error(e.toString());
  }
};

/**
 * Sends a close instruction to the remote party.
 *
 * @api public
 */

Sender.prototype.close = function(code, data, mask, cb) {
  if (this.isClosed) return;
  this.isClosed = true;
  try {
    if (this.continuationFrame) this.socket.write(new Buffer([0xff], 'binary'));
    this.socket.write(new Buffer([0xff, 0x00]), 'binary', cb);
  } catch (e) {
    this.error(e.toString());
  }
};

/**
 * Sends a ping message to the remote party. Not available for hixie.
 *
 * @api public
 */

Sender.prototype.ping = function(data, options) {};

/**
 * Sends a pong message to the remote party. Not available for hixie.
 *
 * @api public
 */

Sender.prototype.pong = function(data, options) {};

/**
 * Handles an error
 *
 * @api private
 */

Sender.prototype.error = function (reason) {
  this.emit('error', reason);
  return this;
};

},{"events":undefined,"util":undefined}],31:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var events = require('events')
  , util = require('util')
  , EventEmitter = events.EventEmitter
  , ErrorCodes = require('./ErrorCodes')
  , bufferUtil = require('./BufferUtil').BufferUtil
  , PerMessageDeflate = require('./PerMessageDeflate');

/**
 * HyBi Sender implementation
 */

function Sender(socket, extensions) {
  if (this instanceof Sender === false) {
    throw new TypeError("Classes can't be function-called");
  }

  events.EventEmitter.call(this);

  this._socket = socket;
  this.extensions = extensions || {};
  this.firstFragment = true;
  this.compress = false;
  this.messageHandlers = [];
  this.processing = false;
}

/**
 * Inherits from EventEmitter.
 */

util.inherits(Sender, events.EventEmitter);

/**
 * Sends a close instruction to the remote party.
 *
 * @api public
 */

Sender.prototype.close = function(code, data, mask, cb) {
  if (typeof code !== 'undefined') {
    if (typeof code !== 'number' ||
      !ErrorCodes.isValidErrorCode(code)) throw new Error('first argument must be a valid error code number');
  }
  code = code || 1000;
  var dataBuffer = new Buffer(2 + (data ? Buffer.byteLength(data) : 0));
  writeUInt16BE.call(dataBuffer, code, 0);
  if (dataBuffer.length > 2) dataBuffer.write(data, 2);

  var self = this;
  this.messageHandlers.push(function(callback) {
    self.frameAndSend(0x8, dataBuffer, true, mask);
    callback();
    if (typeof cb == 'function') cb();
  });
  this.flush();
};

/**
 * Sends a ping message to the remote party.
 *
 * @api public
 */

Sender.prototype.ping = function(data, options) {
  var mask = options && options.mask;
  var self = this;
  this.messageHandlers.push(function(callback) {
    self.frameAndSend(0x9, data || '', true, mask);
    callback();
  });
  this.flush();
};

/**
 * Sends a pong message to the remote party.
 *
 * @api public
 */

Sender.prototype.pong = function(data, options) {
  var mask = options && options.mask;
  var self = this;
  this.messageHandlers.push(function(callback) {
    self.frameAndSend(0xa, data || '', true, mask);
    callback();
  });
  this.flush();
};

/**
 * Sends text or binary data to the remote party.
 *
 * @api public
 */

Sender.prototype.send = function(data, options, cb) {
  var finalFragment = options && options.fin === false ? false : true;
  var mask = options && options.mask;
  var compress = options && options.compress;
  var opcode = options && options.binary ? 2 : 1;
  if (this.firstFragment === false) {
    opcode = 0;
    compress = false;
  } else {
    this.firstFragment = false;
    this.compress = compress;
  }
  if (finalFragment) this.firstFragment = true

  var compressFragment = this.compress;

  var self = this;
  this.messageHandlers.push(function(callback) {
    self.applyExtensions(data, finalFragment, compressFragment, function(err, data) {
      if (err) {
        if (typeof cb == 'function') cb(err);
        else self.emit('error', err);
        return;
      }
      self.frameAndSend(opcode, data, finalFragment, mask, compress, cb);
      callback();
    });
  });
  this.flush();
};

/**
 * Frames and sends a piece of data according to the HyBi WebSocket protocol.
 *
 * @api private
 */

Sender.prototype.frameAndSend = function(opcode, data, finalFragment, maskData, compressed, cb) {
  var canModifyData = false;

  if (!data) {
    try {
      this._socket.write(new Buffer([opcode | (finalFragment ? 0x80 : 0), 0 | (maskData ? 0x80 : 0)].concat(maskData ? [0, 0, 0, 0] : [])), 'binary', cb);
    }
    catch (e) {
      if (typeof cb == 'function') cb(e);
      else this.emit('error', e);
    }
    return;
  }

  if (!Buffer.isBuffer(data)) {
    canModifyData = true;
    if (data && (typeof data.byteLength !== 'undefined' || typeof data.buffer !== 'undefined')) {
      data = getArrayBuffer(data);
    } else {
      //
      // If people want to send a number, this would allocate the number in
      // bytes as memory size instead of storing the number as buffer value. So
      // we need to transform it to string in order to prevent possible
      // vulnerabilities / memory attacks.
      //
      if (typeof data === 'number') data = data.toString();

      data = new Buffer(data);
    }
  }

  var dataLength = data.length
    , dataOffset = maskData ? 6 : 2
    , secondByte = dataLength;

  if (dataLength >= 65536) {
    dataOffset += 8;
    secondByte = 127;
  }
  else if (dataLength > 125) {
    dataOffset += 2;
    secondByte = 126;
  }

  var mergeBuffers = dataLength < 32768 || (maskData && !canModifyData);
  var totalLength = mergeBuffers ? dataLength + dataOffset : dataOffset;
  var outputBuffer = new Buffer(totalLength);
  outputBuffer[0] = finalFragment ? opcode | 0x80 : opcode;
  if (compressed) outputBuffer[0] |= 0x40;

  switch (secondByte) {
    case 126:
      writeUInt16BE.call(outputBuffer, dataLength, 2);
      break;
    case 127:
      writeUInt32BE.call(outputBuffer, 0, 2);
      writeUInt32BE.call(outputBuffer, dataLength, 6);
  }

  if (maskData) {
    outputBuffer[1] = secondByte | 0x80;
    var mask = this._randomMask || (this._randomMask = getRandomMask());
    outputBuffer[dataOffset - 4] = mask[0];
    outputBuffer[dataOffset - 3] = mask[1];
    outputBuffer[dataOffset - 2] = mask[2];
    outputBuffer[dataOffset - 1] = mask[3];
    if (mergeBuffers) {
      bufferUtil.mask(data, mask, outputBuffer, dataOffset, dataLength);
      try {
        this._socket.write(outputBuffer, 'binary', cb);
      }
      catch (e) {
        if (typeof cb == 'function') cb(e);
        else this.emit('error', e);
      }
    }
    else {
      bufferUtil.mask(data, mask, data, 0, dataLength);
      try {
        this._socket.write(outputBuffer, 'binary');
        this._socket.write(data, 'binary', cb);
      }
      catch (e) {
        if (typeof cb == 'function') cb(e);
        else this.emit('error', e);
      }
    }
  }
  else {
    outputBuffer[1] = secondByte;
    if (mergeBuffers) {
      data.copy(outputBuffer, dataOffset);
      try {
        this._socket.write(outputBuffer, 'binary', cb);
      }
      catch (e) {
        if (typeof cb == 'function') cb(e);
        else this.emit('error', e);
      }
    }
    else {
      try {
        this._socket.write(outputBuffer, 'binary');
        this._socket.write(data, 'binary', cb);
      }
      catch (e) {
        if (typeof cb == 'function') cb(e);
        else this.emit('error', e);
      }
    }
  }
};

/**
 * Execute message handler buffers
 *
 * @api private
 */

Sender.prototype.flush = function() {
  if (this.processing) return;

  var handler = this.messageHandlers.shift();
  if (!handler) return;

  this.processing = true;

  var self = this;

  handler(function() {
    self.processing = false;
    self.flush();
  });
};

/**
 * Apply extensions to message
 *
 * @api private
 */

Sender.prototype.applyExtensions = function(data, fin, compress, callback) {
  if (compress && data) {
    if ((data.buffer || data) instanceof ArrayBuffer) {
      data = getArrayBuffer(data);
    }
    this.extensions[PerMessageDeflate.extensionName].compress(data, fin, callback);
  } else {
    callback(null, data);
  }
};

module.exports = Sender;

function writeUInt16BE(value, offset) {
  this[offset] = (value & 0xff00)>>8;
  this[offset+1] = value & 0xff;
}

function writeUInt32BE(value, offset) {
  this[offset] = (value & 0xff000000)>>24;
  this[offset+1] = (value & 0xff0000)>>16;
  this[offset+2] = (value & 0xff00)>>8;
  this[offset+3] = value & 0xff;
}

function getArrayBuffer(data) {
  // data is either an ArrayBuffer or ArrayBufferView.
  var array = new Uint8Array(data.buffer || data)
    , l = data.byteLength || data.length
    , o = data.byteOffset || 0
    , buffer = new Buffer(l);
  for (var i = 0; i < l; ++i) {
    buffer[i] = array[o+i];
  }
  return buffer;
}

function getRandomMask() {
  return new Buffer([
    ~~(Math.random() * 255),
    ~~(Math.random() * 255),
    ~~(Math.random() * 255),
    ~~(Math.random() * 255)
  ]);
}

},{"./BufferUtil":24,"./ErrorCodes":25,"./PerMessageDeflate":27,"events":undefined,"util":undefined}],32:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
 
module.exports.Validation = {
  isValidUTF8: function(buffer) {
    return true;
  }
};


},{}],33:[function(require,module,exports){
'use strict';

/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

try {
  module.exports = require('utf-8-validate');
} catch (e) {
  module.exports = require('./Validation.fallback');
}

},{"./Validation.fallback":32,"utf-8-validate":undefined}],34:[function(require,module,exports){
'use strict';

/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var url = require('url')
  , util = require('util')
  , http = require('http')
  , https = require('https')
  , crypto = require('crypto')
  , stream = require('stream')
  , Ultron = require('ultron')
  , Options = require('options')
  , Sender = require('./Sender')
  , Receiver = require('./Receiver')
  , SenderHixie = require('./Sender.hixie')
  , ReceiverHixie = require('./Receiver.hixie')
  , Extensions = require('./Extensions')
  , PerMessageDeflate = require('./PerMessageDeflate')
  , EventEmitter = require('events').EventEmitter;

/**
 * Constants
 */

// Default protocol version

var protocolVersion = 13;

// Close timeout

var closeTimeout = 30 * 1000; // Allow 30 seconds to terminate the connection cleanly

/**
 * WebSocket implementation
 *
 * @constructor
 * @param {String} address Connection address.
 * @param {String|Array} protocols WebSocket protocols.
 * @param {Object} options Additional connection options.
 * @api public
 */
function WebSocket(address, protocols, options) {
  if (this instanceof WebSocket === false) {
    return new WebSocket(address, protocols, options);
  }

  EventEmitter.call(this);

  if (protocols && !Array.isArray(protocols) && 'object' === typeof protocols) {
    // accept the "options" Object as the 2nd argument
    options = protocols;
    protocols = null;
  }

  if ('string' === typeof protocols) {
    protocols = [ protocols ];
  }

  if (!Array.isArray(protocols)) {
    protocols = [];
  }

  this._socket = null;
  this._ultron = null;
  this._closeReceived = false;
  this.bytesReceived = 0;
  this.readyState = null;
  this.supports = {};
  this.extensions = {};

  if (Array.isArray(address)) {
    initAsServerClient.apply(this, address.concat(options));
  } else {
    initAsClient.apply(this, [address, protocols, options]);
  }
}

/**
 * Inherits from EventEmitter.
 */
util.inherits(WebSocket, EventEmitter);

/**
 * Ready States
 */
["CONNECTING", "OPEN", "CLOSING", "CLOSED"].forEach(function each(state, index) {
    WebSocket.prototype[state] = WebSocket[state] = index;
});

/**
 * Gracefully closes the connection, after sending a description message to the server
 *
 * @param {Object} data to be sent to the server
 * @api public
 */
WebSocket.prototype.close = function close(code, data) {
  if (this.readyState === WebSocket.CLOSED) return;

  if (this.readyState === WebSocket.CONNECTING) {
    this.readyState = WebSocket.CLOSED;
    return;
  }

  if (this.readyState === WebSocket.CLOSING) {
    if (this._closeReceived && this._isServer) {
      this.terminate();
    }
    return;
  }

  var self = this;
  try {
    this.readyState = WebSocket.CLOSING;
    this._closeCode = code;
    this._closeMessage = data;
    var mask = !this._isServer;
    this._sender.close(code, data, mask, function(err) {
      if (err) self.emit('error', err);

      if (self._closeReceived && self._isServer) {
        self.terminate();
      } else {
        // ensure that the connection is cleaned up even when no response of closing handshake.
        clearTimeout(self._closeTimer);
        self._closeTimer = setTimeout(cleanupWebsocketResources.bind(self, true), closeTimeout);
      }
    });
  } catch (e) {
    this.emit('error', e);
  }
};

/**
 * Pause the client stream
 *
 * @api public
 */
WebSocket.prototype.pause = function pauser() {
  if (this.readyState !== WebSocket.OPEN) throw new Error('not opened');

  return this._socket.pause();
};

/**
 * Sends a ping
 *
 * @param {Object} data to be sent to the server
 * @param {Object} Members - mask: boolean, binary: boolean
 * @param {boolean} dontFailWhenClosed indicates whether or not to throw if the connection isnt open
 * @api public
 */
WebSocket.prototype.ping = function ping(data, options, dontFailWhenClosed) {
  if (this.readyState !== WebSocket.OPEN) {
    if (dontFailWhenClosed === true) return;
    throw new Error('not opened');
  }

  options = options || {};

  if (typeof options.mask === 'undefined') options.mask = !this._isServer;

  this._sender.ping(data, options);
};

/**
 * Sends a pong
 *
 * @param {Object} data to be sent to the server
 * @param {Object} Members - mask: boolean, binary: boolean
 * @param {boolean} dontFailWhenClosed indicates whether or not to throw if the connection isnt open
 * @api public
 */
WebSocket.prototype.pong = function(data, options, dontFailWhenClosed) {
  if (this.readyState !== WebSocket.OPEN) {
    if (dontFailWhenClosed === true) return;
    throw new Error('not opened');
  }

  options = options || {};

  if (typeof options.mask === 'undefined') options.mask = !this._isServer;

  this._sender.pong(data, options);
};

/**
 * Resume the client stream
 *
 * @api public
 */
WebSocket.prototype.resume = function resume() {
  if (this.readyState !== WebSocket.OPEN) throw new Error('not opened');

  return this._socket.resume();
};

/**
 * Sends a piece of data
 *
 * @param {Object} data to be sent to the server
 * @param {Object} Members - mask: boolean, binary: boolean, compress: boolean
 * @param {function} Optional callback which is executed after the send completes
 * @api public
 */

WebSocket.prototype.send = function send(data, options, cb) {
  if (typeof options === 'function') {
    cb = options;
    options = {};
  }

  if (this.readyState !== WebSocket.OPEN) {
    if (typeof cb === 'function') cb(new Error('not opened'));
    else throw new Error('not opened');
    return;
  }

  if (!data) data = '';
  if (this._queue) {
    var self = this;
    this._queue.push(function() { self.send(data, options, cb); });
    return;
  }

  options = options || {};
  options.fin = true;

  if (typeof options.binary === 'undefined') {
    options.binary = (data instanceof ArrayBuffer || data instanceof Buffer ||
      data instanceof Uint8Array ||
      data instanceof Uint16Array ||
      data instanceof Uint32Array ||
      data instanceof Int8Array ||
      data instanceof Int16Array ||
      data instanceof Int32Array ||
      data instanceof Float32Array ||
      data instanceof Float64Array);
  }

  if (typeof options.mask === 'undefined') options.mask = !this._isServer;
  if (typeof options.compress === 'undefined') options.compress = true;
  if (!this.extensions[PerMessageDeflate.extensionName]) {
    options.compress = false;
  }

  var readable = typeof stream.Readable === 'function'
    ? stream.Readable
    : stream.Stream;

  if (data instanceof readable) {
    startQueue(this);
    var self = this;

    sendStream(this, data, options, function send(error) {
      process.nextTick(function tock() {
        executeQueueSends(self);
      });

      if (typeof cb === 'function') cb(error);
    });
  } else {
    this._sender.send(data, options, cb);
  }
};

/**
 * Streams data through calls to a user supplied function
 *
 * @param {Object} Members - mask: boolean, binary: boolean, compress: boolean
 * @param {function} 'function (error, send)' which is executed on successive ticks of which send is 'function (data, final)'.
 * @api public
 */
WebSocket.prototype.stream = function stream(options, cb) {
  if (typeof options === 'function') {
    cb = options;
    options = {};
  }

  var self = this;

  if (typeof cb !== 'function') throw new Error('callback must be provided');

  if (this.readyState !== WebSocket.OPEN) {
    if (typeof cb === 'function') cb(new Error('not opened'));
    else throw new Error('not opened');
    return;
  }

  if (this._queue) {
    this._queue.push(function () { self.stream(options, cb); });
    return;
  }

  options = options || {};

  if (typeof options.mask === 'undefined') options.mask = !this._isServer;
  if (typeof options.compress === 'undefined') options.compress = true;
  if (!this.extensions[PerMessageDeflate.extensionName]) {
    options.compress = false;
  }

  startQueue(this);

  function send(data, final) {
    try {
      if (self.readyState !== WebSocket.OPEN) throw new Error('not opened');
      options.fin = final === true;
      self._sender.send(data, options);
      if (!final) process.nextTick(cb.bind(null, null, send));
      else executeQueueSends(self);
    } catch (e) {
      if (typeof cb === 'function') cb(e);
      else {
        delete self._queue;
        self.emit('error', e);
      }
    }
  }

  process.nextTick(cb.bind(null, null, send));
};

/**
 * Immediately shuts down the connection
 *
 * @api public
 */
WebSocket.prototype.terminate = function terminate() {
  if (this.readyState === WebSocket.CLOSED) return;

  if (this._socket) {
    this.readyState = WebSocket.CLOSING;

    // End the connection
    try { this._socket.end(); }
    catch (e) {
      // Socket error during end() call, so just destroy it right now
      cleanupWebsocketResources.call(this, true);
      return;
    }

    // Add a timeout to ensure that the connection is completely
    // cleaned up within 30 seconds, even if the clean close procedure
    // fails for whatever reason
    // First cleanup any pre-existing timeout from an earlier "terminate" call,
    // if one exists.  Otherwise terminate calls in quick succession will leak timeouts
    // and hold the program open for `closeTimout` time.
    if (this._closeTimer) { clearTimeout(this._closeTimer); }
    this._closeTimer = setTimeout(cleanupWebsocketResources.bind(this, true), closeTimeout);
  } else if (this.readyState === WebSocket.CONNECTING) {
    cleanupWebsocketResources.call(this, true);
  }
};

/**
 * Expose bufferedAmount
 *
 * @api public
 */
Object.defineProperty(WebSocket.prototype, 'bufferedAmount', {
  get: function get() {
    var amount = 0;
    if (this._socket) {
      amount = this._socket.bufferSize || 0;
    }
    return amount;
  }
});

/**
 * Emulates the W3C Browser based WebSocket interface using function members.
 *
 * @see http://dev.w3.org/html5/websockets/#the-websocket-interface
 * @api public
 */
['open', 'error', 'close', 'message'].forEach(function(method) {
  Object.defineProperty(WebSocket.prototype, 'on' + method, {
    /**
     * Returns the current listener
     *
     * @returns {Mixed} the set function or undefined
     * @api public
     */
    get: function get() {
      var listener = this.listeners(method)[0];
      return listener ? (listener._listener ? listener._listener : listener) : undefined;
    },

    /**
     * Start listening for events
     *
     * @param {Function} listener the listener
     * @returns {Mixed} the set function or undefined
     * @api public
     */
    set: function set(listener) {
      this.removeAllListeners(method);
      this.addEventListener(method, listener);
    }
  });
});

/**
 * Emulates the W3C Browser based WebSocket interface using addEventListener.
 *
 * @see https://developer.mozilla.org/en/DOM/element.addEventListener
 * @see http://dev.w3.org/html5/websockets/#the-websocket-interface
 * @api public
 */
WebSocket.prototype.addEventListener = function(method, listener) {
  var target = this;

  function onMessage (data, flags) {
    listener.call(target, new MessageEvent(data, !!flags.binary, target));
  }

  function onClose (code, message) {
    listener.call(target, new CloseEvent(code, message, target));
  }

  function onError (event) {
    event.type = 'error';
    event.target = target;
    listener.call(target, event);
  }

  function onOpen () {
    listener.call(target, new OpenEvent(target));
  }

  if (typeof listener === 'function') {
    if (method === 'message') {
      // store a reference so we can return the original function from the
      // addEventListener hook
      onMessage._listener = listener;
      this.on(method, onMessage);
    } else if (method === 'close') {
      // store a reference so we can return the original function from the
      // addEventListener hook
      onClose._listener = listener;
      this.on(method, onClose);
    } else if (method === 'error') {
      // store a reference so we can return the original function from the
      // addEventListener hook
      onError._listener = listener;
      this.on(method, onError);
    } else if (method === 'open') {
      // store a reference so we can return the original function from the
      // addEventListener hook
      onOpen._listener = listener;
      this.on(method, onOpen);
    } else {
      this.on(method, listener);
    }
  }
};

module.exports = WebSocket;
module.exports.buildHostHeader = buildHostHeader

/**
 * W3C MessageEvent
 *
 * @see http://www.w3.org/TR/html5/comms.html
 * @constructor
 * @api private
 */
function MessageEvent(dataArg, isBinary, target) {
  this.type = 'message';
  this.data = dataArg;
  this.target = target;
  this.binary = isBinary; // non-standard.
}

/**
 * W3C CloseEvent
 *
 * @see http://www.w3.org/TR/html5/comms.html
 * @constructor
 * @api private
 */
function CloseEvent(code, reason, target) {
  this.type = 'close';
  this.wasClean = (typeof code === 'undefined' || code === 1000);
  this.code = code;
  this.reason = reason;
  this.target = target;
}

/**
 * W3C OpenEvent
 *
 * @see http://www.w3.org/TR/html5/comms.html
 * @constructor
 * @api private
 */
function OpenEvent(target) {
  this.type = 'open';
  this.target = target;
}

// Append port number to Host header, only if specified in the url
// and non-default
function buildHostHeader(isSecure, hostname, port) {
  var headerHost = hostname;
  if (hostname) {
    if ((isSecure && (port != 443)) || (!isSecure && (port != 80))){
      headerHost = headerHost + ':' + port;
    }
  }
  return headerHost;
}

/**
 * Entirely private apis,
 * which may or may not be bound to a sepcific WebSocket instance.
 */
function initAsServerClient(req, socket, upgradeHead, options) {
  options = new Options({
    protocolVersion: protocolVersion,
    protocol: null,
    extensions: {}
  }).merge(options);

  // expose state properties
  this.protocol = options.value.protocol;
  this.protocolVersion = options.value.protocolVersion;
  this.extensions = options.value.extensions;
  this.supports.binary = (this.protocolVersion !== 'hixie-76');
  this.upgradeReq = req;
  this.readyState = WebSocket.CONNECTING;
  this._isServer = true;

  // establish connection
  if (options.value.protocolVersion === 'hixie-76') {
    establishConnection.call(this, ReceiverHixie, SenderHixie, socket, upgradeHead);
  } else {
    establishConnection.call(this, Receiver, Sender, socket, upgradeHead);
  }
}

function initAsClient(address, protocols, options) {
  options = new Options({
    origin: null,
    protocolVersion: protocolVersion,
    host: null,
    headers: null,
    protocol: protocols.join(','),
    agent: null,

    // ssl-related options
    pfx: null,
    key: null,
    passphrase: null,
    cert: null,
    ca: null,
    ciphers: null,
    rejectUnauthorized: null,
    perMessageDeflate: true,
    localAddress: null
  }).merge(options);

  if (options.value.protocolVersion !== 8 && options.value.protocolVersion !== 13) {
    throw new Error('unsupported protocol version');
  }

  // verify URL and establish http class
  var serverUrl = url.parse(address);
  var isUnixSocket = serverUrl.protocol === 'ws+unix:';
  if (!serverUrl.host && !isUnixSocket) throw new Error('invalid url');
  var isSecure = serverUrl.protocol === 'wss:' || serverUrl.protocol === 'https:';
  var httpObj = isSecure ? https : http;
  var port = serverUrl.port || (isSecure ? 443 : 80);
  var auth = serverUrl.auth;

  // prepare extensions
  var extensionsOffer = {};
  var perMessageDeflate;
  if (options.value.perMessageDeflate) {
    perMessageDeflate = new PerMessageDeflate(typeof options.value.perMessageDeflate !== true ? options.value.perMessageDeflate : {}, false);
    extensionsOffer[PerMessageDeflate.extensionName] = perMessageDeflate.offer();
  }

  // expose state properties
  this._isServer = false;
  this.url = address;
  this.protocolVersion = options.value.protocolVersion;
  this.supports.binary = (this.protocolVersion !== 'hixie-76');

  // begin handshake
  var key = new Buffer(options.value.protocolVersion + '-' + Date.now()).toString('base64');
  var shasum = crypto.createHash('sha1');
  shasum.update(key + '258EAFA5-E914-47DA-95CA-C5AB0DC85B11');
  var expectedServerKey = shasum.digest('base64');

  var agent = options.value.agent;

  var headerHost = buildHostHeader(isSecure, serverUrl.hostname, port)

  var requestOptions = {
    port: port,
    host: serverUrl.hostname,
    headers: {
      'Connection': 'Upgrade',
      'Upgrade': 'websocket',
      'Host': headerHost,
      'Sec-WebSocket-Version': options.value.protocolVersion,
      'Sec-WebSocket-Key': key
    }
  };

  // If we have basic auth.
  if (auth) {
    requestOptions.headers.Authorization = 'Basic ' + new Buffer(auth).toString('base64');
  }

  if (options.value.protocol) {
    requestOptions.headers['Sec-WebSocket-Protocol'] = options.value.protocol;
  }

  if (options.value.host) {
    requestOptions.headers.Host = options.value.host;
  }

  if (options.value.headers) {
    for (var header in options.value.headers) {
       if (options.value.headers.hasOwnProperty(header)) {
        requestOptions.headers[header] = options.value.headers[header];
       }
    }
  }

  if (Object.keys(extensionsOffer).length) {
    requestOptions.headers['Sec-WebSocket-Extensions'] = Extensions.format(extensionsOffer);
  }

  if (options.isDefinedAndNonNull('pfx')
   || options.isDefinedAndNonNull('key')
   || options.isDefinedAndNonNull('passphrase')
   || options.isDefinedAndNonNull('cert')
   || options.isDefinedAndNonNull('ca')
   || options.isDefinedAndNonNull('ciphers')
   || options.isDefinedAndNonNull('rejectUnauthorized')) {

    if (options.isDefinedAndNonNull('pfx')) requestOptions.pfx = options.value.pfx;
    if (options.isDefinedAndNonNull('key')) requestOptions.key = options.value.key;
    if (options.isDefinedAndNonNull('passphrase')) requestOptions.passphrase = options.value.passphrase;
    if (options.isDefinedAndNonNull('cert')) requestOptions.cert = options.value.cert;
    if (options.isDefinedAndNonNull('ca')) requestOptions.ca = options.value.ca;
    if (options.isDefinedAndNonNull('ciphers')) requestOptions.ciphers = options.value.ciphers;
    if (options.isDefinedAndNonNull('rejectUnauthorized')) requestOptions.rejectUnauthorized = options.value.rejectUnauthorized;

    if (!agent) {
        // global agent ignores client side certificates
        agent = new httpObj.Agent(requestOptions);
    }
  }

  requestOptions.path = serverUrl.path || '/';

  if (agent) {
    requestOptions.agent = agent;
  }

  if (isUnixSocket) {
    requestOptions.socketPath = serverUrl.pathname;
  }

  if (options.value.localAddress) {
    requestOptions.localAddress = options.value.localAddress;
  }

  if (options.value.origin) {
    if (options.value.protocolVersion < 13) requestOptions.headers['Sec-WebSocket-Origin'] = options.value.origin;
    else requestOptions.headers.Origin = options.value.origin;
  }

  var self = this;
  var req = httpObj.request(requestOptions);

  req.on('error', function onerror(error) {
    self.emit('error', error);
    cleanupWebsocketResources.call(self, error);
  });

  req.once('response', function response(res) {
    var error;

    if (!self.emit('unexpected-response', req, res)) {
      error = new Error('unexpected server response (' + res.statusCode + ')');
      req.abort();
      self.emit('error', error);
    }

    cleanupWebsocketResources.call(self, error);
  });

  req.once('upgrade', function upgrade(res, socket, upgradeHead) {
    if (self.readyState === WebSocket.CLOSED) {
      // client closed before server accepted connection
      self.emit('close');
      self.removeAllListeners();
      socket.end();
      return;
    }

    var serverKey = res.headers['sec-websocket-accept'];
    if (typeof serverKey === 'undefined' || serverKey !== expectedServerKey) {
      self.emit('error', 'invalid server key');
      self.removeAllListeners();
      socket.end();
      return;
    }

    var serverProt = res.headers['sec-websocket-protocol'];
    var protList = (options.value.protocol || "").split(/, */);
    var protError = null;

    if (!options.value.protocol && serverProt) {
      protError = 'server sent a subprotocol even though none requested';
    } else if (options.value.protocol && !serverProt) {
      protError = 'server sent no subprotocol even though requested';
    } else if (serverProt && protList.indexOf(serverProt) === -1) {
      protError = 'server responded with an invalid protocol';
    }

    if (protError) {
      self.emit('error', protError);
      self.removeAllListeners();
      socket.end();
      return;
    } else if (serverProt) {
      self.protocol = serverProt;
    }

    var serverExtensions = Extensions.parse(res.headers['sec-websocket-extensions']);
    if (perMessageDeflate && serverExtensions[PerMessageDeflate.extensionName]) {
      try {
        perMessageDeflate.accept(serverExtensions[PerMessageDeflate.extensionName]);
      } catch (err) {
        self.emit('error', 'invalid extension parameter');
        self.removeAllListeners();
        socket.end();
        return;
      }
      self.extensions[PerMessageDeflate.extensionName] = perMessageDeflate;
    }

    establishConnection.call(self, Receiver, Sender, socket, upgradeHead);

    // perform cleanup on http resources
    req.removeAllListeners();
    req = null;
    agent = null;
  });

  req.end();
  this.readyState = WebSocket.CONNECTING;
}

function establishConnection(ReceiverClass, SenderClass, socket, upgradeHead) {
  var ultron = this._ultron = new Ultron(socket)
    , called = false
    , self = this;

  socket.setTimeout(0);
  socket.setNoDelay(true);

  this._receiver = new ReceiverClass(this.extensions);
  this._socket = socket;

  // socket cleanup handlers
  ultron.on('end', cleanupWebsocketResources.bind(this));
  ultron.on('close', cleanupWebsocketResources.bind(this));
  ultron.on('error', cleanupWebsocketResources.bind(this));

  // ensure that the upgradeHead is added to the receiver
  function firstHandler(data) {
    if (called || self.readyState === WebSocket.CLOSED) return;

    called = true;
    socket.removeListener('data', firstHandler);
    ultron.on('data', realHandler);

    if (upgradeHead && upgradeHead.length > 0) {
      realHandler(upgradeHead);
      upgradeHead = null;
    }

    if (data) realHandler(data);
  }

  // subsequent packets are pushed straight to the receiver
  function realHandler(data) {
    self.bytesReceived += data.length;
    self._receiver.add(data);
  }

  ultron.on('data', firstHandler);

  // if data was passed along with the http upgrade,
  // this will schedule a push of that on to the receiver.
  // this has to be done on next tick, since the caller
  // hasn't had a chance to set event handlers on this client
  // object yet.
  process.nextTick(firstHandler);

  // receiver event handlers
  self._receiver.ontext = function ontext(data, flags) {
    flags = flags || {};

    self.emit('message', data, flags);
  };

  self._receiver.onbinary = function onbinary(data, flags) {
    flags = flags || {};

    flags.binary = true;
    self.emit('message', data, flags);
  };

  self._receiver.onping = function onping(data, flags) {
    flags = flags || {};

    self.pong(data, {
      mask: !self._isServer,
      binary: flags.binary === true
    }, true);

    self.emit('ping', data, flags);
  };

  self._receiver.onpong = function onpong(data, flags) {
    self.emit('pong', data, flags || {});
  };

  self._receiver.onclose = function onclose(code, data, flags) {
    flags = flags || {};

    self._closeReceived = true;
    self.close(code, data);
  };

  self._receiver.onerror = function onerror(reason, errorCode) {
    // close the connection when the receiver reports a HyBi error code
    self.close(typeof errorCode !== 'undefined' ? errorCode : 1002, '');
    self.emit('error', reason, errorCode);
  };

  // finalize the client
  this._sender = new SenderClass(socket, this.extensions);
  this._sender.on('error', function onerror(error) {
    self.close(1002, '');
    self.emit('error', error);
  });

  this.readyState = WebSocket.OPEN;
  this.emit('open');
}

function startQueue(instance) {
  instance._queue = instance._queue || [];
}

function executeQueueSends(instance) {
  var queue = instance._queue;
  if (typeof queue === 'undefined') return;

  delete instance._queue;
  for (var i = 0, l = queue.length; i < l; ++i) {
    queue[i]();
  }
}

function sendStream(instance, stream, options, cb) {
  stream.on('data', function incoming(data) {
    if (instance.readyState !== WebSocket.OPEN) {
      if (typeof cb === 'function') cb(new Error('not opened'));
      else {
        delete instance._queue;
        instance.emit('error', new Error('not opened'));
      }
      return;
    }

    options.fin = false;
    instance._sender.send(data, options);
  });

  stream.on('end', function end() {
    if (instance.readyState !== WebSocket.OPEN) {
      if (typeof cb === 'function') cb(new Error('not opened'));
      else {
        delete instance._queue;
        instance.emit('error', new Error('not opened'));
      }
      return;
    }

    options.fin = true;
    instance._sender.send(null, options);

    if (typeof cb === 'function') cb(null);
  });
}

function cleanupWebsocketResources(error) {
  if (this.readyState === WebSocket.CLOSED) return;

  var emitClose = this.readyState !== WebSocket.CONNECTING;
  this.readyState = WebSocket.CLOSED;

  clearTimeout(this._closeTimer);
  this._closeTimer = null;

  if (emitClose) {
    // If the connection was closed abnormally (with an error), or if
    // the close control frame was not received then the close code
    // must default to 1006.
    if (error || !this._closeReceived) {
      this._closeCode = 1006;
    }
    this.emit('close', this._closeCode || 1000, this._closeMessage || '');
  }

  if (this._socket) {
    if (this._ultron) this._ultron.destroy();
    this._socket.on('error', function onerror() {
      try { this.destroy(); }
      catch (e) {}
    });

    try {
      if (!error) this._socket.end();
      else this._socket.destroy();
    } catch (e) { /* Ignore termination errors */ }

    this._socket = null;
    this._ultron = null;
  }

  if (this._sender) {
    this._sender.removeAllListeners();
    this._sender = null;
  }

  if (this._receiver) {
    this._receiver.cleanup();
    this._receiver = null;
  }

  if (this.extensions[PerMessageDeflate.extensionName]) {
    this.extensions[PerMessageDeflate.extensionName].cleanup();
  }

  this.extensions = null;

  this.removeAllListeners();
  this.on('error', function onerror() {}); // catch all errors after this
  delete this._queue;
}

},{"./Extensions":26,"./PerMessageDeflate":27,"./Receiver":29,"./Receiver.hixie":28,"./Sender":31,"./Sender.hixie":30,"crypto":undefined,"events":undefined,"http":undefined,"https":undefined,"options":19,"stream":undefined,"ultron":20,"url":undefined,"util":undefined}],35:[function(require,module,exports){
/*!
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */

var util = require('util')
  , events = require('events')
  , http = require('http')
  , crypto = require('crypto')
  , Options = require('options')
  , WebSocket = require('./WebSocket')
  , Extensions = require('./Extensions')
  , PerMessageDeflate = require('./PerMessageDeflate')
  , tls = require('tls')
  , url = require('url');

/**
 * WebSocket Server implementation
 */

function WebSocketServer(options, callback) {
  if (this instanceof WebSocketServer === false) {
    return new WebSocketServer(options, callback);
  }

  events.EventEmitter.call(this);

  options = new Options({
    host: '0.0.0.0',
    port: null,
    server: null,
    verifyClient: null,
    handleProtocols: null,
    path: null,
    noServer: false,
    disableHixie: false,
    clientTracking: true,
    perMessageDeflate: true
  }).merge(options);

  if (!options.isDefinedAndNonNull('port') && !options.isDefinedAndNonNull('server') && !options.value.noServer) {
    throw new TypeError('`port` or a `server` must be provided');
  }

  var self = this;

  if (options.isDefinedAndNonNull('port')) {
    this._server = http.createServer(function (req, res) {
      var body = http.STATUS_CODES[426];
      res.writeHead(426, {
        'Content-Length': body.length,
        'Content-Type': 'text/plain'
      });
      res.end(body);
    });
    this._server.allowHalfOpen = false;
    this._server.listen(options.value.port, options.value.host, callback);
    this._closeServer = function() { if (self._server) self._server.close(); };
  }
  else if (options.value.server) {
    this._server = options.value.server;
    if (options.value.path) {
      // take note of the path, to avoid collisions when multiple websocket servers are
      // listening on the same http server
      if (this._server._webSocketPaths && options.value.server._webSocketPaths[options.value.path]) {
        throw new Error('two instances of WebSocketServer cannot listen on the same http server path');
      }
      if (typeof this._server._webSocketPaths !== 'object') {
        this._server._webSocketPaths = {};
      }
      this._server._webSocketPaths[options.value.path] = 1;
    }
  }
  if (this._server) this._server.once('listening', function() { self.emit('listening'); });

  if (typeof this._server != 'undefined') {
    this._server.on('error', function(error) {
      self.emit('error', error)
    });
    this._server.on('upgrade', function(req, socket, upgradeHead) {
      //copy upgradeHead to avoid retention of large slab buffers used in node core
      var head = new Buffer(upgradeHead.length);
      upgradeHead.copy(head);

      self.handleUpgrade(req, socket, head, function(client) {
        self.emit('connection'+req.url, client);
        self.emit('connection', client);
      });
    });
  }

  this.options = options.value;
  this.path = options.value.path;
  this.clients = [];
}

/**
 * Inherits from EventEmitter.
 */

util.inherits(WebSocketServer, events.EventEmitter);

/**
 * Immediately shuts down the connection.
 *
 * @api public
 */

WebSocketServer.prototype.close = function(callback) {
  // terminate all associated clients
  var error = null;
  try {
    for (var i = 0, l = this.clients.length; i < l; ++i) {
      this.clients[i].terminate();
    }
  }
  catch (e) {
    error = e;
  }

  // remove path descriptor, if any
  if (this.path && this._server._webSocketPaths) {
    delete this._server._webSocketPaths[this.path];
    if (Object.keys(this._server._webSocketPaths).length == 0) {
      delete this._server._webSocketPaths;
    }
  }

  // close the http server if it was internally created
  try {
    if (typeof this._closeServer !== 'undefined') {
      this._closeServer();
    }
  }
  finally {
    delete this._server;
  }
  if(callback)
    callback(error);
  else if(error)
    throw error;
}

/**
 * Handle a HTTP Upgrade request.
 *
 * @api public
 */

WebSocketServer.prototype.handleUpgrade = function(req, socket, upgradeHead, cb) {
  // check for wrong path
  if (this.options.path) {
    var u = url.parse(req.url);
    if (u && u.pathname !== this.options.path) return;
  }

  if (typeof req.headers.upgrade === 'undefined' || req.headers.upgrade.toLowerCase() !== 'websocket') {
    abortConnection(socket, 400, 'Bad Request');
    return;
  }

  if (req.headers['sec-websocket-key1']) handleHixieUpgrade.apply(this, arguments);
  else handleHybiUpgrade.apply(this, arguments);
}

module.exports = WebSocketServer;

/**
 * Entirely private apis,
 * which may or may not be bound to a sepcific WebSocket instance.
 */

function handleHybiUpgrade(req, socket, upgradeHead, cb) {
  // handle premature socket errors
  var errorHandler = function() {
    try { socket.destroy(); } catch (e) {}
  }
  socket.on('error', errorHandler);

  // verify key presence
  if (!req.headers['sec-websocket-key']) {
    abortConnection(socket, 400, 'Bad Request');
    return;
  }

  // verify version
  var version = parseInt(req.headers['sec-websocket-version']);
  if ([8, 13].indexOf(version) === -1) {
    abortConnection(socket, 400, 'Bad Request');
    return;
  }

  // verify protocol
  var protocols = req.headers['sec-websocket-protocol'];

  // verify client
  var origin = version < 13 ?
    req.headers['sec-websocket-origin'] :
    req.headers['origin'];

  // handle extensions offer
  var extensionsOffer = Extensions.parse(req.headers['sec-websocket-extensions']);

  // handler to call when the connection sequence completes
  var self = this;
  var completeHybiUpgrade2 = function(protocol) {

    // calc key
    var key = req.headers['sec-websocket-key'];
    var shasum = crypto.createHash('sha1');
    shasum.update(key + "258EAFA5-E914-47DA-95CA-C5AB0DC85B11");
    key = shasum.digest('base64');

    var headers = [
        'HTTP/1.1 101 Switching Protocols'
      , 'Upgrade: websocket'
      , 'Connection: Upgrade'
      , 'Sec-WebSocket-Accept: ' + key
    ];

    if (typeof protocol != 'undefined') {
      headers.push('Sec-WebSocket-Protocol: ' + protocol);
    }

    var extensions = {};
    try {
      extensions = acceptExtensions.call(self, extensionsOffer);
    } catch (err) {
      abortConnection(socket, 400, 'Bad Request');
      return;
    }

    if (Object.keys(extensions).length) {
      var serverExtensions = {};
      Object.keys(extensions).forEach(function(token) {
        serverExtensions[token] = [extensions[token].params]
      });
      headers.push('Sec-WebSocket-Extensions: ' + Extensions.format(serverExtensions));
    }

    // allows external modification/inspection of handshake headers
    self.emit('headers', headers);

    socket.setTimeout(0);
    socket.setNoDelay(true);
    try {
      socket.write(headers.concat('', '').join('\r\n'));
    }
    catch (e) {
      // if the upgrade write fails, shut the connection down hard
      try { socket.destroy(); } catch (e) {}
      return;
    }

    var client = new WebSocket([req, socket, upgradeHead], {
      protocolVersion: version,
      protocol: protocol,
      extensions: extensions
    });

    if (self.options.clientTracking) {
      self.clients.push(client);
      client.on('close', function() {
        var index = self.clients.indexOf(client);
        if (index != -1) {
          self.clients.splice(index, 1);
        }
      });
    }

    // signal upgrade complete
    socket.removeListener('error', errorHandler);
    cb(client);
  }

  // optionally call external protocol selection handler before
  // calling completeHybiUpgrade2
  var completeHybiUpgrade1 = function() {
    // choose from the sub-protocols
    if (typeof self.options.handleProtocols == 'function') {
        var protList = (protocols || "").split(/, */);
        var callbackCalled = false;
        var res = self.options.handleProtocols(protList, function(result, protocol) {
          callbackCalled = true;
          if (!result) abortConnection(socket, 401, 'Unauthorized');
          else completeHybiUpgrade2(protocol);
        });
        if (!callbackCalled) {
            // the handleProtocols handler never called our callback
            abortConnection(socket, 501, 'Could not process protocols');
        }
        return;
    } else {
        if (typeof protocols !== 'undefined') {
            completeHybiUpgrade2(protocols.split(/, */)[0]);
        }
        else {
            completeHybiUpgrade2();
        }
    }
  }

  // optionally call external client verification handler
  if (typeof this.options.verifyClient == 'function') {
    var info = {
      origin: origin,
      secure: typeof req.connection.authorized !== 'undefined' || typeof req.connection.encrypted !== 'undefined',
      req: req
    };
    if (this.options.verifyClient.length == 2) {
      this.options.verifyClient(info, function(result, code, name) {
        if (typeof code === 'undefined') code = 401;
        if (typeof name === 'undefined') name = http.STATUS_CODES[code];

        if (!result) abortConnection(socket, code, name);
        else completeHybiUpgrade1();
      });
      return;
    }
    else if (!this.options.verifyClient(info)) {
      abortConnection(socket, 401, 'Unauthorized');
      return;
    }
  }

  completeHybiUpgrade1();
}

function handleHixieUpgrade(req, socket, upgradeHead, cb) {
  // handle premature socket errors
  var errorHandler = function() {
    try { socket.destroy(); } catch (e) {}
  }
  socket.on('error', errorHandler);

  // bail if options prevent hixie
  if (this.options.disableHixie) {
    abortConnection(socket, 401, 'Hixie support disabled');
    return;
  }

  // verify key presence
  if (!req.headers['sec-websocket-key2']) {
    abortConnection(socket, 400, 'Bad Request');
    return;
  }

  var origin = req.headers['origin']
    , self = this;

  // setup handshake completion to run after client has been verified
  var onClientVerified = function() {
    var wshost;
    if (!req.headers['x-forwarded-host'])
        wshost = req.headers.host;
    else
        wshost = req.headers['x-forwarded-host'];
    var location = ((req.headers['x-forwarded-proto'] === 'https' || socket.encrypted) ? 'wss' : 'ws') + '://' + wshost + req.url
      , protocol = req.headers['sec-websocket-protocol'];

    // handshake completion code to run once nonce has been successfully retrieved
    var completeHandshake = function(nonce, rest) {
      // calculate key
      var k1 = req.headers['sec-websocket-key1']
        , k2 = req.headers['sec-websocket-key2']
        , md5 = crypto.createHash('md5');

      [k1, k2].forEach(function (k) {
        var n = parseInt(k.replace(/[^\d]/g, ''))
          , spaces = k.replace(/[^ ]/g, '').length;
        if (spaces === 0 || n % spaces !== 0){
          abortConnection(socket, 400, 'Bad Request');
          return;
        }
        n /= spaces;
        md5.update(String.fromCharCode(
          n >> 24 & 0xFF,
          n >> 16 & 0xFF,
          n >> 8  & 0xFF,
          n       & 0xFF));
      });
      md5.update(nonce.toString('binary'));

      var headers = [
          'HTTP/1.1 101 Switching Protocols'
        , 'Upgrade: WebSocket'
        , 'Connection: Upgrade'
        , 'Sec-WebSocket-Location: ' + location
      ];
      if (typeof protocol != 'undefined') headers.push('Sec-WebSocket-Protocol: ' + protocol);
      if (typeof origin != 'undefined') headers.push('Sec-WebSocket-Origin: ' + origin);

      socket.setTimeout(0);
      socket.setNoDelay(true);
      try {
        // merge header and hash buffer
        var headerBuffer = new Buffer(headers.concat('', '').join('\r\n'));
        var hashBuffer = new Buffer(md5.digest('binary'), 'binary');
        var handshakeBuffer = new Buffer(headerBuffer.length + hashBuffer.length);
        headerBuffer.copy(handshakeBuffer, 0);
        hashBuffer.copy(handshakeBuffer, headerBuffer.length);

        // do a single write, which - upon success - causes a new client websocket to be setup
        socket.write(handshakeBuffer, 'binary', function(err) {
          if (err) return; // do not create client if an error happens
          var client = new WebSocket([req, socket, rest], {
            protocolVersion: 'hixie-76',
            protocol: protocol
          });
          if (self.options.clientTracking) {
            self.clients.push(client);
            client.on('close', function() {
              var index = self.clients.indexOf(client);
              if (index != -1) {
                self.clients.splice(index, 1);
              }
            });
          }

          // signal upgrade complete
          socket.removeListener('error', errorHandler);
          cb(client);
        });
      }
      catch (e) {
        try { socket.destroy(); } catch (e) {}
        return;
      }
    }

    // retrieve nonce
    var nonceLength = 8;
    if (upgradeHead && upgradeHead.length >= nonceLength) {
      var nonce = upgradeHead.slice(0, nonceLength);
      var rest = upgradeHead.length > nonceLength ? upgradeHead.slice(nonceLength) : null;
      completeHandshake.call(self, nonce, rest);
    }
    else {
      // nonce not present in upgradeHead, so we must wait for enough data
      // data to arrive before continuing
      var nonce = new Buffer(nonceLength);
      upgradeHead.copy(nonce, 0);
      var received = upgradeHead.length;
      var rest = null;
      var handler = function (data) {
        var toRead = Math.min(data.length, nonceLength - received);
        if (toRead === 0) return;
        data.copy(nonce, received, 0, toRead);
        received += toRead;
        if (received == nonceLength) {
          socket.removeListener('data', handler);
          if (toRead < data.length) rest = data.slice(toRead);
          completeHandshake.call(self, nonce, rest);
        }
      }
      socket.on('data', handler);
    }
  }

  // verify client
  if (typeof this.options.verifyClient == 'function') {
    var info = {
      origin: origin,
      secure: typeof req.connection.authorized !== 'undefined' || typeof req.connection.encrypted !== 'undefined',
      req: req
    };
    if (this.options.verifyClient.length == 2) {
      var self = this;
      this.options.verifyClient(info, function(result, code, name) {
        if (typeof code === 'undefined') code = 401;
        if (typeof name === 'undefined') name = http.STATUS_CODES[code];

        if (!result) abortConnection(socket, code, name);
        else onClientVerified.apply(self);
      });
      return;
    }
    else if (!this.options.verifyClient(info)) {
      abortConnection(socket, 401, 'Unauthorized');
      return;
    }
  }

  // no client verification required
  onClientVerified();
}

function acceptExtensions(offer) {
  var extensions = {};
  var options = this.options.perMessageDeflate;
  if (options && offer[PerMessageDeflate.extensionName]) {
    var perMessageDeflate = new PerMessageDeflate(options !== true ? options : {}, true);
    perMessageDeflate.accept(offer[PerMessageDeflate.extensionName]);
    extensions[PerMessageDeflate.extensionName] = perMessageDeflate;
  }
  return extensions;
}

function abortConnection(socket, code, name) {
  try {
    var response = [
      'HTTP/1.1 ' + code + ' ' + name,
      'Content-type: text/html'
    ];
    socket.write(response.concat('', '').join('\r\n'));
  }
  catch (e) { /* ignore errors - we've aborted this connection */ }
  finally {
    // ensure that an early aborted connection is shut down completely
    try { socket.destroy(); } catch (e) {}
  }
}

},{"./Extensions":26,"./PerMessageDeflate":27,"./WebSocket":34,"crypto":undefined,"events":undefined,"http":undefined,"options":19,"tls":undefined,"url":undefined,"util":undefined}],36:[function(require,module,exports){
/**
 * @author qiao / https://github.com/qiao
 * @author mrdoob / http://mrdoob.com
 * @author alteredq / http://alteredqualia.com/
 * @author WestLangley / http://github.com/WestLangley
 * @contributor d3x0r / http://github.com/d3x0r  - add enable/disable to allow disconnecting these events
 */

THREE.OrbitControls = function ( object, clusterLookAt, domElement ) {
	// mode 1, is limited
	this.mode = 2;
	this.object = object;
	this.cluster = clusterLookAt;
	this.domElement = ( domElement !== undefined ) ? domElement : document;

	// API

	this.enabled = true;

	this.center = new THREE.Vector3();

	this.userZoom = true;
	this.userZoomSpeed = 0.10;

	this.userRotate = true;
	this.userRotateSpeed = 1.0;

	this.userPan = true;
	this.userPanSpeed = 2.0;

	this.autoRotate = false;
	this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60

	this.minPolarAngle = 0; // radians
	this.maxPolarAngle = Math.PI; // radians

	this.minDistance = 0;
	this.maxDistance = Infinity;

	// 65 /*A*/, 83 /*S*/, 68 /*D*/
	this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40, ROTATE: 65, ZOOM: 83, PAN: 68 };

	// internals

	var scope = this;

	var EPS = 0.000001;
	var PIXELS_PER_ROUND = 1800;

	var rotateStart = new THREE.Vector2();
	var rotateEnd = new THREE.Vector2();
	var rotateDelta = new THREE.Vector2();

	var zoomStart = new THREE.Vector2();
	var zoomEnd = new THREE.Vector2();
	var zoomDelta = new THREE.Vector2();

	var phiDelta = 0;
	var thetaDelta = 0;
	var scale = 1;

	var lastPosition = new THREE.Vector3();

	var STATE = { NONE: -1, ROTATE: 0, ZOOM: 1, PAN: 2 };
	var state = STATE.NONE;

	// events

	var changeEvent = { type: 'change' };


	this.rotateLeft = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		thetaDelta -= angle;

	};

	this.rotateRight = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		thetaDelta += angle;

	};

	this.rotateUp = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		phiDelta -= angle;

	};

	this.rotateDown = function ( angle ) {

		if ( angle === undefined ) {

			angle = getAutoRotationAngle();

		}

		phiDelta += angle;

	};

	this.zoomIn = function ( zoomScale ) {

		if ( zoomScale === undefined ) {

			zoomScale = getZoomScale();

		}

		scale /= zoomScale;

	};

	this.zoomOut = function ( zoomScale ) {

		if ( zoomScale === undefined ) {

			zoomScale = getZoomScale();

		}

		scale *= zoomScale;

	};

	this.pan = function ( distance ) {

		distance.transformDirection( this.object.matrix );
		distance.multiplyScalar( scope.userPanSpeed );

		this.object.position.add( distance );
		this.center.add( distance );

	};

	this.update = function () {

		var position = this.object.position;
		var offset = position.clone().sub( this.center );

		// angle from z-axis around y-axis

		var theta = Math.atan2( offset.x, offset.z );

		// angle from y-axis

		var phi = Math.atan2( Math.sqrt( offset.x * offset.x + offset.z * offset.z ), offset.y );

		if ( this.autoRotate ) {

			this.rotateLeft( getAutoRotationAngle() );

		}

		if( this.mode == 2 ) {
			if( phiDelta || thetaDelta ) {
				this.object.matrix.rotateRelative( -phiDelta, thetaDelta, 0 );
				this.object.matrix.rotateRelative( 0, 0, -this.object.matrix.roll )
				var tmp = this.center.clone().addScaledVector( this.object.matrix.backward, offset.length() *(scale) );
				this.object.matrix.origin.copy( tmp );
				this.object.matrixWorldNeedsUpdate = true;
			}
		} else {
			theta += thetaDelta;
			phi += phiDelta;

			// restrict phi to be between desired limits
			phi = Math.max( this.minPolarAngle, Math.min( this.maxPolarAngle, phi ) );

			// restrict phi to be betwee EPS and PI-EPS
			phi = Math.max( EPS, Math.min( Math.PI - EPS, phi ) );

			var radius = offset.length() * scale;

			// restrict radius to be between desired limits
			radius = Math.max( this.minDistance, Math.min( this.maxDistance, radius ) );

			offset.x = radius * Math.sin( phi ) * Math.sin( theta );
			offset.y = radius * Math.cos( phi );
			offset.z = radius * Math.sin( phi ) * Math.cos( theta );

			position.copy( this.center ).add( offset );

	        //console.log( "update lookAt?", thetaDelta, phiDelta)

			this.object.lookAt( this.center );

	        this.object.matrixWorldNeedsUpdate = true;
		}
		thetaDelta = 0;
		phiDelta = 0;
		scale = 1;

		if ( lastPosition.distanceTo( this.object.position ) > 0 ) {

			this.dispatchEvent( changeEvent );

			lastPosition.copy( this.object.position );

		}

	};


	function getAutoRotationAngle() {

		return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;

	}

	function getZoomScale() {

		return Math.pow( 0.95, scope.userZoomSpeed );

	}

	function onMouseDown( event ) {

		if ( scope.enabled === false ) return;
		if ( scope.userRotate === false ) return;

		event.preventDefault();

		if ( state === STATE.NONE )
		{
			if ( event.button === 0 )
				state = STATE.ROTATE;
			if ( event.button === 1 )
				state = STATE.ZOOM;
			if ( event.button === 2 )
				state = STATE.PAN;
		}


		if ( state === STATE.ROTATE ) {

			//state = STATE.ROTATE;

			rotateStart.set( event.clientX, event.clientY );

		} else if ( state === STATE.ZOOM ) {

			//state = STATE.ZOOM;

			zoomStart.set( event.clientX, event.clientY );

		} else if ( state === STATE.PAN ) {

			//state = STATE.PAN;

		}

		document.addEventListener( 'mousemove', onMouseMove, false );
		document.addEventListener( 'mouseup', onMouseUp, false );

	}

	function onMouseMove( event ) {

		if ( scope.enabled === false ) return;

		event.preventDefault();



		if ( state === STATE.ROTATE ) {

			rotateEnd.set( event.clientX, event.clientY );
			rotateDelta.subVectors( rotateEnd, rotateStart );

			scope.rotateLeft( 2 * Math.PI * rotateDelta.x / PIXELS_PER_ROUND * scope.userRotateSpeed );
			scope.rotateUp( 2 * Math.PI * rotateDelta.y / PIXELS_PER_ROUND * scope.userRotateSpeed );

			rotateStart.copy( rotateEnd );

		} else if ( state === STATE.ZOOM ) {

			zoomEnd.set( event.clientX, event.clientY );
			zoomDelta.subVectors( zoomEnd, zoomStart );

			if ( zoomDelta.y > 0 ) {

				scope.zoomIn();

			} else {

				scope.zoomOut();

			}

			zoomStart.copy( zoomEnd );

		} else if ( state === STATE.PAN ) {

			var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
			var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;

			scope.pan( new THREE.Vector3( - movementX, movementY, 0 ) );

		}

	}

	function onMouseUp( event ) {

		if ( scope.enabled === false ) return;
		if ( scope.userRotate === false ) return;

		document.removeEventListener( 'mousemove', onMouseMove, false );
		document.removeEventListener( 'mouseup', onMouseUp, false );

		state = STATE.NONE;

	}

	function onMouseWheel( event ) {

		if ( scope.enabled === false ) return;
		if ( scope.userZoom === false ) return;

		var delta = 0;

		if ( event.wheelDelta ) { // WebKit / Opera / Explorer 9

			delta = event.wheelDelta;

		} else if ( event.detail ) { // Firefox

			delta = - event.detail;

		}

		if ( delta > 0 ) {

			scope.zoomOut();

		} else {

			scope.zoomIn();

		}

	}

	function onKeyDown( event ) {

		if ( scope.enabled === false ) return;
		if ( scope.userPan === false ) return;

		switch ( event.keyCode ) {

			/*case scope.keys.UP:
				scope.pan( new THREE.Vector3( 0, 1, 0 ) );
				break;
			case scope.keys.BOTTOM:
				scope.pan( new THREE.Vector3( 0, - 1, 0 ) );
				break;
			case scope.keys.LEFT:
				scope.pan( new THREE.Vector3( - 1, 0, 0 ) );
				break;
			case scope.keys.RIGHT:
				scope.pan( new THREE.Vector3( 1, 0, 0 ) );
				break;
			*/
			case scope.keys.ROTATE:
				state = STATE.ROTATE;
				break;
			case scope.keys.ZOOM:
				state = STATE.ZOOM;
				break;
			case scope.keys.PAN:
				state = STATE.PAN;
				break;

		}

	}

	function onKeyUp( event ) {

		switch ( event.keyCode ) {

			case scope.keys.ROTATE:
			case scope.keys.ZOOM:
			case scope.keys.PAN:
				state = STATE.NONE;
				break;
		}

	}

	var ongoingTouches = [];

	function copyTouch(touch) {
	  return { identifier: touch.identifier, pageX: touch.pageX, pageY: touch.pageY };
	}
	function ongoingTouchIndexById(idToFind) {
	  for (var i = 0; i < ongoingTouches.length; i++) {
	    var id = ongoingTouches[i].identifier;

	    if (id == idToFind) {
	      return i;
	    }
	  }
	  return -1;    // not found
	}
	function onTouchDown(event) {
	  event.preventDefault();
	  var touches = event.changedTouches;
	  for( var i = 0; i < touches.length; i++ ) {

			if ( scope.enabled === false ) return;
			if ( scope.userRotate === false ) return;

			event.preventDefault();

			if ( state === STATE.NONE )
			{
				if ( event.button === 0 )
					state = STATE.ROTATE;
				if ( event.button === 1 )
					state = STATE.ZOOM;
				if ( event.button === 2 )
					state = STATE.PAN;
			}


			if ( state === STATE.ROTATE ) {
				rotateStart.set( touches[0].pageX, touches[0].pageY );
			} else if ( state === STATE.ZOOM ) {
				//state = STATE.ZOOM;
				zoomStart.set( touches[0].pageX, touches[0].pageY );
			} else if ( state === STATE.PAN ) {
				//state = STATE.PAN;
			}


	    console.log( `touch ${i}=${touches[i]}`);
	    ongoingTouches.push( copyTouch( touches[i] ) );

	  }
	}

	function onTouchUp(event) {
	  event.preventDefault();
		var touches = event.changedTouches;
	  for( var i = 0; i < touches.length; i++ ) {
	    var idx = ongoingTouchIndexById(touches[i].identifier);
	    if( idx >= 0 ) {
				ongoingTouches.splice(idx, 1);  // remove it; we're done
			}
		}
	}

	function onTouchMove(event) {
	  event.preventDefault();
	  var touches = event.changedTouches;
	  for( var i = 0; i < touches.length; i++ ) {
	    var idx = ongoingTouchIndexById(touches[i].identifier);
			console.log( `got touch ${idx}` );
	    if( idx >= 0 ) {

				if ( scope.enabled === false ) return;

				if ( state === STATE.ROTATE ) {

					rotateEnd.set( touches[i].pageX, touches[i].pageY );
					rotateDelta.subVectors( rotateEnd, rotateStart );

					scope.rotateLeft( 2 * Math.PI * rotateDelta.x / PIXELS_PER_ROUND * scope.userRotateSpeed );
					scope.rotateUp( 2 * Math.PI * rotateDelta.y / PIXELS_PER_ROUND * scope.userRotateSpeed );

					rotateStart.copy( rotateEnd );

				} else if ( state === STATE.ZOOM ) {

					zoomEnd.set( event.clientX, event.clientY );
					zoomDelta.subVectors( zoomEnd, zoomStart );

					if ( zoomDelta.y > 0 ) {

						scope.zoomIn();

					} else {

						scope.zoomOut();

					}

					zoomStart.copy( zoomEnd );

				} else if ( state === STATE.PAN ) {

					var movementX = event.movementX || event.mozMovementX || event.webkitMovementX || 0;
					var movementY = event.movementY || event.mozMovementY || event.webkitMovementY || 0;

					scope.pan( new THREE.Vector3( - movementX, movementY, 0 ) );

				}



				ongoingTouches[idx].pageX = touches[i].pageX;
				ongoingTouches[idx].pageY = touches[i].pageY;
	      //ongoingTouches.splice( idx, 1, copyTouch( touches[i] ) );
	    }
	  }
	}

	function onTouchCancel(event) {
	  event.preventDefault();
		  console.log("touchcancel.");
		  var touches = event.changedTouches;

		  for (var i = 0; i < touches.length; i++) {
				var idx = ongoingTouchIndexById(touches[i].identifier);
		    if( idx >= 0 ) {
		    	ongoingTouches.splice(i, 1);  // remove it; we're done
				}
		  }
		}




    function ignore(event) {
        event.preventDefault();
    }
    this.disable = function() {
    	scope.domElement.removeEventListener( 'contextmenu', ignore, false );
			scope.domElement.removeEventListener( 'touchstart', onTouchDown, false );
	    scope.domElement.removeEventListener( 'touchend', onTouchUp, false );
	    scope.domElement.removeEventListener( 'touchcancel', onTouchCancel, false );
	    scope.domElement.removeEventListener( 'touchmove', onTouchMove, false );
    	scope.domElement.removeEventListener( 'mousedown', onMouseDown, false );
    	scope.domElement.removeEventListener( 'mousewheel', onMouseWheel, false );
    	scope.domElement.removeEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox
    	window.removeEventListener( 'keydown', onKeyDown, false );
    	window.removeEventListener( 'keyup', onKeyUp, false );
    }

    this.enable = function() {
    	scope.domElement.addEventListener( 'contextmenu', ignore, false );
			scope.domElement.addEventListener( 'touchstart', onTouchDown, false );
	    scope.domElement.addEventListener( 'touchend', onTouchUp, false );
	    scope.domElement.addEventListener( 'touchcancel', onTouchCancel, false );
	    scope.domElement.addEventListener( 'touchmove', onTouchMove, false );
    	scope.domElement.addEventListener( 'mousedown', onMouseDown, false );
    	scope.domElement.addEventListener( 'mousewheel', onMouseWheel, false );
    	scope.domElement.addEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox
    	window.addEventListener( 'keydown', onKeyDown, false );
    	window.addEventListener( 'keyup', onKeyUp, false );
			Voxelarium.camera.matrixAutoUpdate = false;
    }
    this.enable();

};

THREE.OrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );

},{}],37:[function(require,module,exports){


var bit_masks = [];
for( var mask = 0, n = 0; n <= 32; n++ )
{
    bit_masks[n] = mask;
    mask = ( mask << 1 ) | 1;
}


Voxelarium.BitStream = function( base_buffer )
{
    var stream =
	{
		storage : base_buffer || new ArrayBuffer(512 /*available*/),
		available : ( base_buffer && base_buffer.byteLength ) || 512,
        used : 0,
		used_bits : 0,

		getBytes : function(  ) {
			return { data : stream.storage, bytes_used : stream.used + 1 };
		},

		expand : function()
		{
			var new_size = stream.available * 2;
			var new_storage = new ArrayBuffer(new_size);
            for( var n = 0; n < stream.available; n++ )
                new_storage[n] = stream.storage[n];
			stream.storage = new_storage;
			stream.available = new_size;

		},

		seek : function( position )
		{
			if( (position >> 3) >= stream.available )
				throw new Error( "attempt to seek beyond end of data" );

			stream.used = position >> 3;
			stream.used_bits = position & 0x7;
		},

		write : function( value, bits )
		{
			if( bits > 64 )
				throw new Error( "Attempt to write more bits than data passed" );
			var tmp;
			if( stream.used == stream.available ) Expand();
			tmp = stream.storage[stream.used] || 0;
			tmp |= (value << stream.used_bits)&0xFF;
			stream.storage[stream.used] = tmp;
			var bit_counter = 8 - stream.used_bits;
			stream.used_bits += bits;
			while( stream.used_bits >= 8 )
			{
				stream.used_bits -= 8;
				stream.used++;
				if( stream.used == stream.available ) stream.expand();
				if( stream.used_bits > 0 )
				{
					tmp = 0;
					stream.storage[stream.used] = ( value >> ( bit_counter ) ) & 0xFF;
				}
			}
		},


		read : function( bits )
		{
			if( bits > 64 )
				throw new error( "Attempt to read more bits than data passed" );
			var tmp;
			//if( stream.used == stream.available )
			//	throw new Error( "No more data" );
			tmp = stream.storage[stream.used];
			var result = ( tmp >> stream.used_bits );
			var bit_counter = 8 - stream.used_bits;
			stream.used_bits += bits;
			while( stream.used_bits >= 8 )
			{
				stream.used_bits -= 8;
				stream.used++;
				if( stream.used_bits > 0 )
				{
					tmp = stream.storage[stream.used];
					result |= ( tmp << ( bit_counter ) ) & 0xFF;
					stream.bit_counter += 8;
				}
			}
			result &= bit_masks[bits];
            return result;
		}
	}
    return stream;
}



Voxelarium.BitStream.GetMinBitsNeededForValue = function( value )
{
    var n;
   for( n = 1; n <= 32; n++ ) {
       if( ( ( value & bit_masks[n] ) ^ value ) == 0 )
            break;
   }
   return n;
}

},{}],38:[function(require,module,exports){

require( "./constants.js");
require( "./reactor.js" );

Voxelarium.Cluster = function( x, y, z, props ) {
    var cluster = {
        mesher : null,
        WorkingFullSector : null,
        WorkingEmptySector: null,

        SectorList : [],

        sectorSizeX : x || 32,
        sectorSizeY : y || 32,
        sectorSizeZ : z || 32,
        sectorSize : 0, // filled in later

        voxelUnitSize : props && props.unitSize || 20,

        sectorHashSize_x : 8,
        sectorHashSize_y : 8,
        sectorHashSize_z : 8,
        TableSize : 0,//SectorHashSize_x * SectorHashSize_y * SectorHashSize_z,
        SectorTable : new Array( 8*8*8 ),

        pivot : new THREE.Vector3(),
        location : new THREE.Matrix4(),
        UniverseNum : 0,
        lookupTables : null
        ,createSector : function( x, y, z ) {
            var sector = Voxelarium.Sector( this, x, y, z );
            this.SectorList.push( sector );

            var hashOfs;
            sector.next = this.SectorTable[ hashOfs = ( x % this.sectorHashSize_x
                                + ( y % this.sectorHashSize_y ) * ( this.sectorHashSize_x )
                                + ( z % this.sectorHashSize_z ) * (this.sectorHashSize_y*this.sectorHashSize_x) ) ];
            if( sector.next )
                sector.next.pred = sector;
            this.SectorTable[hashOfs] = sector;

			var n;
			for( n = 0; n < 6; n++ )
			{
				var near_sec = this.getSector( x + Voxelarium.NormalBasePosition[n].x
												  , y + Voxelarium.NormalBasePosition[n].y
												  , z + Voxelarium.NormalBasePosition[n].z
                                                  , true );
				if( near_sec != null )
				{
					sector.near_sectors[n] = near_sec;
					near_sec.near_sectors[n ^ 1] = sector;
				}
			}
            return sector;
        }

        ,getVoxelRef : function( is3dSpaceCoords, x, y, z ) {
            if( is3dSpaceCoords ) {
              x = Math.floor( x / this.voxelUnitSize );
              y = Math.floor( y / this.voxelUnitSize );
              z = Math.floor( z / this.voxelUnitSize );
            }
            var sx = Math.floor( x / this.sectorSizeX );
            var sy = Math.floor( y / this.sectorSizeY );
            var sz = Math.floor( z / this.sectorSizeZ );
            //if( !is3dSpaceCoords) {
              //console.log( `Get ${sx} ${sy} ${sz}`)
            //}
            var sector = cluster.getSector( sx, sy, sz, true );
            if( sector ) {
                return sector.getVoxelRef( x % this.sectorSizeX, y % this.sectorSizeY, z % this.sectorSizeZ);
            } else {
                // pass world coordinates, since there's no sector to give a base position
                return Voxelarium.VoxelRef( cluster, null, x, y, z );
            }
            return null;
        }
        , setCube : function( x, y, z, cube ){
            var sx = x / this.sectorSizeX;
            var sy = y / this.sectorSizeY;
            var sz = z / this.sectorSizeZ;
            var subx = ( sx % 1 ) * this.sectorSizeX;
            var suby = ( sy % 1 ) * this.sectorSizeY;
            var subz = ( sz % 1 ) * this.sectorSizeZ;
            var wx = Math.floor( sx );
            var wy = Math.floor( sy );
            var wz = Math.floor( sz );
            var sector = this.getSector( wx, wy, wz );

            sector.setCube( subx, suby, subz, cube );
        }
        , getSector : function( x, y, z, do_not_create ) {
            var base;
            base = this.SectorTable[ x % this.sectorHashSize_x
                                + ( y % this.sectorHashSize_y ) * ( this.sectorHashSize_x )
                                + ( z % this.sectorHashSize_z ) * ( this.sectorHashSize_y*this.sectorHashSize_x) ];
            while( base
                && ( ( base.pos.x !== x )
                    || ( base.pos.y !== y )
                    || ( base.pos.z !== z ) ) )
                base = base.next;
            if( !do_not_create )
                if( !base )
                    base = this.createSector( x, y, z )
            return base;
        }
        , getGeometryBuffer : null
    }

    cluster.TableSize = cluster.sectorHashSize_x * cluster.sectorHashSize_y * cluster.sectorHashSize_z;
    cluster.sectorSize = cluster.sectorSizeX * cluster.sectorSizeY * cluster.sectorSizeZ;
    cluster.lookupTables = InitStatics( cluster.sectorSizeX, cluster.sectorSizeY, cluster.sectorSizeZ )

    cluster.SectorTable = new Array( cluster.TableSize );
    // maybe reactor is universal?
    cluster.reactor = Voxelarium.Reactor( cluster );

    Object.defineProperties( cluster
        , { 'sectorSizeX' : {writeable:false}
            , 'sectorSizeY' : {writeable:false}
            , 'sectorSizeZ' : {writeable:false}
            , 'sectorSize' : {writeable:false}
            , 'sectorHashSize_x' : {writeable:false}
            , 'sectorHashSize_y' : {writeable:false}
            , 'sectorHashSize_z' : {writeable:false}
            , 'TableSize' : {writeable:false}
            , 'voxelUnitSize' : {writeable:false}
            , 'lookupTables' : {writeable:false}
            , 'SectorTable' : {writeable:false}
            , 'reactor' : {writeable:false}
        } )


    cluster.WorkingFullSector = Voxelarium.Sector( cluster );
    cluster.WorkingFullSector.Pos_y = -1;
    cluster.WorkingFullSector.MakeSector( Voxelarium.Voxels.types[1] );
    cluster.WorkingEmptySector= Voxelarium.Sector( cluster );
    cluster.WorkingEmptySector.Pos_y = 0;
    cluster.WorkingEmptySector.MakeSector( Voxelarium.Voxels.types[0] );


    return cluster;
}

var SectorTables = []; // cache of lookup tables
function InitStatics( x,y,z)
		{
			var tables = SectorTables.find( (tab)=>{ return( tab.x==x && tab.y==y && tab.z == z ) });
			if( !tables )
			{
				tables = {
					x: x,
					y: y,
					z: z,
					tableX : new Array( x+2 ),
					tableY : new Array( y+2 ),
					tableZ : new Array( z+2 ),
					ofTableX : new Array( x+2 ),
					ofTableY : new Array( y+2 ),
					ofTableZ : new Array( z+2 )
				}
				//tables.tableX.forEach( (elem)=>{elem=0})
				//console.log( "tableX init is ", tables.tableX)
				tables.tableX[0] = 1;
				tables.tableX[x + 1] = 2;
				tables.tableZ[0] = 3;
				tables.tableZ[y + 1] = 6;
				tables.tableY[0] = 9;
				tables.tableY[z + 1] = 18;
                n = 0;
                tables.ofTableX[n] = ( ( ( n == 0 ) ? ( x - 1 ) : ( n == ( x + 1 ) ) ? 0 : ( n - 1 ) ) * y );
                tables.ofTableY[n] = ( ( ( n == 0 ) ? ( y - 1 ) : ( n == ( y + 1 ) ) ? 0 : ( n - 1 ) ) );
                tables.ofTableZ[n] = ( ( ( n == 0 ) ? ( z - 1 ) : ( n == ( z + 1 ) ) ? 0 : ( n - 1 ) ) * y * z );
                n = x+1;
                tables.ofTableX[n] = ( ( ( n == 0 ) ? ( x - 1 ) : ( n == ( x + 1 ) ) ? 0 : ( n - 1 ) ) * y );
                tables.ofTableY[n] = ( ( ( n == 0 ) ? ( y - 1 ) : ( n == ( y + 1 ) ) ? 0 : ( n - 1 ) ) );
                tables.ofTableZ[n] = ( ( ( n == 0 ) ? ( z - 1 ) : ( n == ( z + 1 ) ) ? 0 : ( n - 1 ) ) * y * z );
        for(  n = 1; n < x + 1; n++ ) {
					tables.ofTableX[n] = ( ( ( n == 0 ) ? ( x - 1 ) : ( n == ( x + 1 ) ) ? 0 : ( n - 1 ) ) * y );
                    tables.tableX[n] = 0;
        }
				for( var n = 1; n < y + 1; n++ ){
					tables.ofTableY[n] = ( ( ( n == 0 ) ? ( y - 1 ) : ( n == ( y + 1 ) ) ? 0 : ( n - 1 ) ) );
                    tables.tableY[n] = 0;
        }
				for(  n = 1; n < z + 1; n++ ) {
					tables.ofTableZ[n] = ( ( ( n == 0 ) ? ( z - 1 ) : ( n == ( z + 1 ) ) ? 0 : ( n - 1 ) ) * y * z );
          tables.tableZ[n] = 0;
        }
				SectorTables.push( tables );
			}
            Object.defineProperties( tables
                , { "x" : { writable:false}
                ,  "y" : { writable:false}
                ,  "z" : { writable:false}
                ,  "tableX" : { writable:false}
                ,  "tableY" : { writable:false}
                ,  "tableZ" : { writable:false}
                ,  "ofTableX" : { writable:false}
                ,  "ofTableY" : { writable:false}
                ,  "ofTableZ" : { writable:false}
            });
            Object.freeze( tables.tableX );
            Object.freeze( tables.tableY );
            Object.freeze( tables.tableZ );
            Object.freeze( tables.ofTableX );
            Object.freeze( tables.ofTableY );
            Object.freeze( tables.ofTableZ );
			return tables;
		}

},{"./constants.js":39,"./reactor.js":49}],39:[function(require,module,exports){

Voxelarium.D = function( valname, value ) {
    if( typeof valname == "object" ) {
        Object.keys(valname).forEach( (key)=>{
            Object.defineProperty(Voxelarium, key, { value:valname[key], writable: false })
        })
    } else
        Object.defineProperty(Voxelarium, valname, { writable: false })
}
Voxelarium.Enum = function( valname, value ) {
    if( typeof valname == "object" ) {
        Object.keys(valname).forEach( (key)=>{
            Object.defineProperty(Voxelarium, key, { value:valname[key], writable: false })
            Object.keys(valname[key]).forEach( (evalue)=>{
                Object.defineProperty(Voxelarium[key], evalue, { value:valname[key][evalue], writable: false })

            })
        })
    } else
        Object.defineProperty(Voxelarium, valname, { writable: false })
}


Voxelarium.D( {
        ZVOXEL_DRAWINFO_VOID : 0,
//public const int ZVOXEL_DRAWINFO_NOTVOID = 1;
    ZVOXEL_DRAWINFO_DRAWFULLVOXELOPACITY : 1,
  ZVOXEL_DRAWINFO_DRAWTRANSPARENTRENDERING : 2,
  ZVOXEL_DRAWINFO_SPECIALRENDERING : 8,
  ZVOXEL_DRAWINFO_SHADER : 16,
  ZVOXEL_DRAWINFO_DECAL : 32,  // image is used over shader output
})
Voxelarium.D( {
    ZVOXEL_DRAWINFO_CULLINGBITS : ( /*ZVOXEL_DRAWINFO_NOTVOID |*/ Voxelarium.ZVOXEL_DRAWINFO_DRAWFULLVOXELOPACITY | Voxelarium.ZVOXEL_DRAWINFO_DRAWTRANSPARENTRENDERING )
});


Voxelarium.Enum( {
    FACEDRAW_Operations : {
			LEFT : 0x00001
		, RIGHT : 0x00002
		, AHEAD : 0x00004
		, BEHIND : 0x00008
		, ABOVE : 0x00010
		, BELOW : 0x00020
		, LEFT_HAS_ABOVE : 0x00000400
		, LEFT_HAS_BELOW : 0x00000800
		, LEFT_HAS_AHEAD : 0x00001000
		, LEFT_HAS_BEHIND : 0x00002000
		, RIGHT_HAS_ABOVE : 0x00004000
		, RIGHT_HAS_BELOW : 0x00008000
		, RIGHT_HAS_AHEAD : 0x00010000
		, RIGHT_HAS_BEHIND : 0x00020000
		, ABOVE_HAS_LEFT : 0x00000400//LEFT_HAS_ABOVE
		, ABOVE_HAS_RIGHT : 0x00004000//RIGHT_HAS_ABOVE
		, ABOVE_HAS_AHEAD : 0x00040000
		, ABOVE_HAS_BEHIND : 0x00080000
		, BELOW_HAS_LEFT : 0x00000800//LEFT_HAS_BELOW
		, BELOW_HAS_RIGHT : 0x00008000//RIGHT_HAS_BELOW
		, BELOW_HAS_AHEAD : 0x00100000
		, BELOW_HAS_BEHIND : 0x00200000
		, AHEAD_HAS_LEFT : 0x00001000//LEFT_HAS_AHEAD
		, AHEAD_HAS_RIGHT : 0x00100000//RIGHT_HAS_AHEAD
		, AHEAD_HAS_ABOVE : 0x00040000//ABOVE_HAS_AHEAD
		, AHEAD_HAS_BELOW : 0x00100000//BELOW_HAS_AHEAD
		, BEHIND_HAS_LEFT : 0x00002000//LEFT_HAS_BEHIND
		, BEHIND_HAS_RIGHT : 0x00020000//RIGHT_HAS_BEHIND
		, BEHIND_HAS_ABOVE : 0x00080000//ABOVE_HAS_BEHIND
		, BEHIND_HAS_BELOW : 0x00200000//BELOW_HAS_BEHIND
		, ALL : ( 1|2|4|8|16|32 /* LEFT | RIGHT | AHEAD | BEHIND | ABOVE | BELOW */ )
		, NONE : 0x00000
		, FLANK : ( 1|2|4|8 /* LEFT | RIGHT | AHEAD | BEHIND */ )
		, UD : ( 16|32 /*ABOVE | BELOW*/ )
		, ALL_BITS : 0x3FFFFF
    }});


Voxelarium.Enum( { RelativeVoxelOrds : {
	INCENTER :0
   , LEFT     :1
   , RIGHT :2
   , INFRONT :3
   , AHEAD : 3 //RelativeVoxelOrds.INFRONT
   , BEHIND  :4
   , ABOVE   :5
   , BELOW   :6

   , LEFT_ABOVE :7
   , ABOVE_LEFT : 7//RelativeVoxelOrds.LEFT_ABOVE
   , RIGHT_ABOVE :8
   , ABOVE_RIGHT : 8//RelativeVoxelOrds.RIGHT_ABOVE

   , INFRONT_ABOVE :9
   , AHEAD_ABOVE : 9// RelativeVoxelOrds.INFRONT_ABOVE
   , ABOVE_AHEAD : 9//RelativeVoxelOrds.INFRONT_ABOVE

   , BEHIND_ABOVE  :10
   , ABOVE_BEHIND : 10//RelativeVoxelOrds.BEHIND_ABOVE

   , LEFT_AHEAD   :11
   , AHEAD_LEFT : 11//RelativeVoxelOrds.LEFT_AHEAD

   , RIGHT_AHEAD   :12
   , AHEAD_RIGHT : 12//RelativeVoxelOrds.RIGHT_AHEAD

   , LEFT_BELOW :13
   , BELOW_LEFT : 13//RelativeVoxelOrds.LEFT_BELOW
   , RIGHT_BELOW :14
   , BELOW_RIGHT : 14//RelativeVoxelOrds.RIGHT_BELOW
   , INFRONT_BELOW :15
   , AHEAD_BELOW : 15//RelativeVoxelOrds.INFRONT_BELOW
   , BELOW_AHEAD : 15//RelativeVoxelOrds.INFRONT_BELOW
   , BEHIND_BELOW  :16
   , BELOW_BEHIND : 16//RelativeVoxelOrds.BEHIND_BELOW

   , LEFT_BEHIND   :17
   , BEHIND_LEFT : 17//RelativeVoxelOrds.LEFT_BEHIND
   , BEHIND_RIGHT   :18
   , RIGHT_BEHIND : 18//RelativeVoxelOrds.BEHIND_RIGHT


   , LEFT_AHEAD_ABOVE   : 19
   , RIGHT_AHEAD_ABOVE  : 20
   , LEFT_AHEAD_BELOW   : 21
   , RIGHT_AHEAD_BELOW  : 22
   , LEFT_BEHIND_ABOVE  : 23
   , RIGHT_BEHIND_ABOVE : 24
   , LEFT_BEHIND_BELOW  : 25
   , RIGHT_BEHIND_BELOW : 26

   , LEFT_ABOVE_AHEAD : 19//RelativeVoxelOrds.LEFT_AHEAD_ABOVE   //: 19
   , RIGHT_ABOVE_AHEAD : 20//RelativeVoxelOrds.RIGHT_AHEAD_ABOVE  // : 20
   , LEFT_BELOW_AHEAD : 21//RelativeVoxelOrds.LEFT_AHEAD_BELOW     //: 21
   , RIGHT_BELOW_AHEAD : 22//RelativeVoxelOrds.RIGHT_AHEAD_BELOW   //: 22
   , LEFT_ABOVE_BEHIND : 23//RelativeVoxelOrds.LEFT_BEHIND_ABOVE  //: 23
   , RIGHT_ABOVE_BEHIND : 24//RelativeVoxelOrds.RIGHT_BEHIND_ABOVE// : 24
   , LEFT_BELOW_BEHIND : 25//RelativeVoxelOrds.LEFT_BEHIND_BELOW  //: 25
   , RIGHT_BELOW_BEHIND : 26//RelativeVoxelOrds.RIGHT_BEHIND_BELOW// : 26

   , ABOVE_AHEAD_LEFT : 19//RelativeVoxelOrds.LEFT_AHEAD_ABOVE   //: 19
   , ABOVE_AHEAD_RIGHT : 20//RelativeVoxelOrds.RIGHT_AHEAD_ABOVE  // : 20
   , BELOW_AHEAD_LEFT : 21//RelativeVoxelOrds.LEFT_AHEAD_BELOW    // : 21
   , BELOW_AHEAD_RIGHT : 22//RelativeVoxelOrds.RIGHT_AHEAD_BELOW  // : 22
   , ABOVE_BEHIND_LEFT : 23//RelativeVoxelOrds.LEFT_BEHIND_ABOVE  //: 23
   , ABOVE_BEHIND_RIGHT : 24//RelativeVoxelOrds.RIGHT_BEHIND_ABOVE //: 24
   , BELOW_BEHIND_LEFT : 25//RelativeVoxelOrds.LEFT_BEHIND_BELOW  //: 25
   , BELOW_BEHIND_RIGHT : 26//RelativeVoxelOrds.RIGHT_BEHIND_BELOW// : 26

   , AHEAD_ABOVE_LEFT : 19//RelativeVoxelOrds.LEFT_AHEAD_ABOVE   //: 19
   , AHEAD_ABOVE_RIGHT : 20//RelativeVoxelOrds.RIGHT_AHEAD_ABOVE //  : 20
   , AHEAD_BELOW_LEFT : 21//RelativeVoxelOrds.LEFT_AHEAD_BELOW   //  : 21
   , BEHIND_ABOVE_LEFT : 22//RelativeVoxelOrds.LEFT_BEHIND_ABOVE // : 23
   , AHEAD_BELOW_RIGHT : 23//RelativeVoxelOrds.RIGHT_AHEAD_BELOW //  : 22
   , BEHIND_ABOVE_RIGHT : 24//RelativeVoxelOrds.RIGHT_BEHIND_ABOVE //: 24
   , BEHIND_BELOW_LEFT : 25//RelativeVoxelOrds.LEFT_BEHIND_BELOW  //: 25
   , BEHIND_BELOW_RIGHT : 26//RelativeVoxelOrds.RIGHT_BEHIND_BELOW //: 26

   , ABOVE_LEFT_AHEAD : 19//RelativeVoxelOrds.LEFT_AHEAD_ABOVE  // : 19
   , ABOVE_RIGHT_AHEAD : 20//RelativeVoxelOrds.RIGHT_AHEAD_ABOVE //  : 20
   , BELOW_LEFT_AHEAD : 21//RelativeVoxelOrds.LEFT_AHEAD_BELOW    // : 21
   , BELOW_RIGHT_AHEAD : 22//RelativeVoxelOrds.RIGHT_AHEAD_BELOW  // : 22
   , ABOVE_LEFT_BEHIND : 23//RelativeVoxelOrds.LEFT_BEHIND_ABOVE  //: 23
   , ABOVE_RIGHT_BEHIND : 24//RelativeVoxelOrds.RIGHT_BEHIND_ABOVE //: 24
   , BELOW_LEFT_BEHIND : 25//RelativeVoxelOrds.LEFT_BEHIND_BELOW  //: 25
   , BELOW_RIGHT_BEHIND : 26//RelativeVoxelOrds.RIGHT_BEHIND_BELOW //: 26

   , AHEAD_LEFT_ABOVE : 19//RelativeVoxelOrds.LEFT_AHEAD_ABOVE  // : 19
   , AHEAD_RIGHT_ABOVE : 20//RelativeVoxelOrds.RIGHT_AHEAD_ABOVE //  : 20
   , AHEAD_LEFT_BELOW : 21//RelativeVoxelOrds.LEFT_AHEAD_BELOW   //  : 21
   , AHEAD_RIGHT_BELOW : 22//RelativeVoxelOrds.RIGHT_AHEAD_BELOW //  : 22
   , BEHIND_LEFT_ABOVE : 23//RelativeVoxelOrds.LEFT_BEHIND_ABOVE // : 23
   , BEHIND_RIGHT_ABOVE : 24//RelativeVoxelOrds.RIGHT_BEHIND_ABOVE //: 24
   , BEHIND_LEFT_BELOW : 25//RelativeVoxelOrds.LEFT_BEHIND_BELOW  //: 25
   , BEHIND_RIGHT_BELOW : 26//RelativeVoxelOrds.RIGHT_BEHIND_BELOW //: 26
}})


const IntFaceStateTable = [
          [ // State 0: Clear = no FullOpaque = no TranspRend = no
            0 , // Clear = 1 FullOpaque = 0 TranspRend = 0
            0 , // Clear = 0 FullOpaque = 1 TranspRend = 0
            0 , // Clear = 0 FullOpaque = 0 TranspRend = 1
            0 , // Clear = 0 FullOpaque = 1 TranspRend = 1
          ] ,
          [ // State 2: Clear = no FullOpaque = yes TranspRend = no
            Voxelarium.FACEDRAW_Operations.ALL_BITS , // Clear = 1 FullOpaque = 0 TranspRend = 0
            0 , // Clear = 0 FullOpaque = 1 TranspRend = 0
            Voxelarium.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 0 TranspRend = 1
            0 , // Clear = 0 FullOpaque = 1 TranspRend = 1
            ],
          [ // State 4 : Clear = no FullOpaque = no TranspRend = yes
            Voxelarium.FACEDRAW_Operations.ALL_BITS , // Clear = 1 FullOpaque = 0 TranspRend = 0
            0  , // Clear = 0 FullOpaque = 1 TranspRend = 0
            0 , // Clear = 0 FullOpaque = 0 TranspRend = 1
            0 , // Clear = 0 FullOpaque = 1 TranspRend = 1
          ],
          null/*new VoxelSector.FACEDRAW_Operations[]{ // State 5: Clear = yes FullOpaque = yes TranspRend = yes
            VoxelSector.FACEDRAW_Operations.ALL_BITS , // Clear = 1 FullOpaque = 0 TranspRend = 0
            VoxelSector.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 1 TranspRend = 0
            VoxelSector.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 0 TranspRend = 1
            VoxelSector.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 1 TranspRend = 1
          }*/,
      ];

      Voxelarium.IntFaceStateTable = IntFaceStateTable;

const ExtFaceStateTable = [
          [ // State 0: Clear = no FullOpaque = no TranspRend = no
            0 , // Clear = 1 FullOpaque = 0 TranspRend = 0
            Voxelarium.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 1 TranspRend = 0
            Voxelarium.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 0 TranspRend = 1
            Voxelarium.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 1 TranspRend = 1
        ],
          [ // State 2: Clear = no FullOpaque = yes TranspRend = no
            0  , // Clear = 0 FullOpaque = 0 TranspRend = 0
            0  , // Clear = 0 FullOpaque = 1 TranspRend = 0
            0  , // Clear = 0 FullOpaque = 0 TranspRend = 1
            0  , // Clear = 1 FullOpaque = 1 TranspRend = 1
        ],
          [ // State 4 : Clear = no FullOpaque = no TranspRend = yes
            0 , // Clear = 1
            Voxelarium.FACEDRAW_Operations.ALL_BITS  , // Clear = 0 FullOpaque = 1 TranspRend = 0
            0  , // FullOpaque = 0 TranspRend = 1
            0  , // FullOpaque = 1 TranspRend = 1
          ],
         null/* new VoxelSector.FACEDRAW_Operations[8]{ // State 7: Clear = yes FullOpaque = yes TranspRend = yes
            0   , // Clear = 1 FullOpaque = 0 TranspRend = 0
            VoxelSector.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 1 TranspRend = 0
            VoxelSector.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 0 TranspRend = 1
            VoxelSector.FACEDRAW_Operations.ALL_BITS , // Clear = 0 FullOpaque = 1 TranspRend = 1
          }*/
      ];
      Voxelarium.ExtFaceStateTable = ExtFaceStateTable;

function ZBlocPosN( x, y, z ) {
    this.x = x;
    this.y = y;
    this.z = z;
}

    const NormalBasePosition = Voxelarium.NormalBasePosition = [
          new ZBlocPosN ( -1, 0, 0 )
          , new ZBlocPosN ( 1, 0, 0 )
          , new ZBlocPosN( 0, 0, 1 )
          , new ZBlocPosN( 0, 0, -1 )
          , new ZBlocPosN( 0, 1, 0 )
          , new ZBlocPosN( 0, -1, 0 ) ];


},{}],40:[function(require,module,exports){
var font = {
height:8, baseline:0, chars:65536, flags:64, name:"TI99.js", characters:[null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:1,w:7,ofs:2,asc:7,dsc:1,data:new Uint8Array([1,1,1,1,1,0,1]) }
,{sz:3,w:7,ofs:1,asc:7,dsc:5,data:new Uint8Array([5,5,5]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([10,10,31,10,31,10,10]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,21,5,14,20,21,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([3,19,8,4,2,25,24]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([2,5,5,2,21,9,22]) }
,{sz:2,w:7,ofs:2,asc:7,dsc:5,data:new Uint8Array([2,2,1]) }
,{sz:3,w:7,ofs:1,asc:7,dsc:1,data:new Uint8Array([4,2,1,1,1,2,4]) }
,{sz:3,w:7,ofs:1,asc:7,dsc:1,data:new Uint8Array([1,2,4,4,4,2,1]) }
,{sz:5,w:7,ofs:0,asc:6,dsc:2,data:new Uint8Array([10,4,31,4,10]) }
,{sz:5,w:7,ofs:0,asc:6,dsc:2,data:new Uint8Array([4,4,31,4,4]) }
,{sz:2,w:7,ofs:1,asc:3,dsc:1,data:new Uint8Array([3,2,1]) }
,{sz:5,w:7,ofs:0,asc:4,dsc:4,data:new Uint8Array([31]) }
,{sz:2,w:7,ofs:1,asc:2,dsc:1,data:new Uint8Array([3,3]) }
,{sz:5,w:7,ofs:0,asc:6,dsc:2,data:new Uint8Array([16,8,4,2,1]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,17,17,17,17,14]) }
,{sz:3,w:7,ofs:1,asc:7,dsc:1,data:new Uint8Array([2,3,2,2,2,2,7]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,16,8,4,2,31]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,16,12,16,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([8,12,10,9,31,8,8]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([31,1,15,16,16,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([12,2,1,15,17,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([31,16,8,4,2,2,2]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,17,14,17,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,17,30,16,8,6]) }
,{sz:2,w:7,ofs:1,asc:6,dsc:2,data:new Uint8Array([3,3,0,3,3]) }
,{sz:2,w:7,ofs:1,asc:6,dsc:1,data:new Uint8Array([3,3,0,3,2,1]) }
,{sz:4,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([8,4,2,1,2,4,8]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:3,data:new Uint8Array([31,0,31]) }
,{sz:4,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([1,2,4,8,4,2,1]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,16,8,4,0,4]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,29,21,29,1,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,17,31,17,17,17]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([15,18,18,14,18,18,15]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,1,1,1,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([15,18,18,18,18,18,15]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([31,1,1,15,1,1,31]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([31,1,1,15,1,1,1]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,1,29,17,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,17,17,31,17,17,17]) }
,{sz:3,w:7,ofs:1,asc:7,dsc:1,data:new Uint8Array([7,2,2,2,2,2,7]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([16,16,16,16,16,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,9,5,3,5,9,17]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([1,1,1,1,1,1,31]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,27,21,21,17,17,17]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,19,19,21,25,25,17]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([31,17,17,17,17,17,31]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([15,17,17,15,1,1,1]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,17,17,21,9,22]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([15,17,17,15,5,9,17]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([14,17,1,14,16,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([31,4,4,4,4,4,4]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,17,17,17,17,17,14]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,17,17,10,10,4,4]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,17,17,21,21,21,10]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,17,10,4,10,17,17]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([17,17,10,4,4,4,4]) }
,{sz:5,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([31,16,8,4,2,1,31]) }
,{sz:3,w:7,ofs:1,asc:7,dsc:1,data:new Uint8Array([7,1,1,1,1,1,7]) }
,{sz:5,w:7,ofs:0,asc:6,dsc:2,data:new Uint8Array([1,2,4,8,16]) }
,{sz:3,w:7,ofs:1,asc:7,dsc:1,data:new Uint8Array([7,4,4,4,4,4,7]) }
,{sz:5,w:7,ofs:0,asc:6,dsc:4,data:new Uint8Array([4,10,17]) }
,{sz:5,w:7,ofs:0,asc:1,dsc:1,data:new Uint8Array([31]) }
,{sz:3,w:7,ofs:1,asc:6,dsc:4,data:new Uint8Array([1,2,4]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([14,17,31,17,17]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([15,18,14,18,15]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([30,1,1,1,30]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([15,18,18,18,15]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([31,1,15,1,31]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([31,1,15,1,1]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([30,1,29,17,14]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,17,31,17,17]) }
,{sz:3,w:7,ofs:1,asc:5,dsc:1,data:new Uint8Array([7,2,2,2,7]) }
,{sz:4,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([8,8,8,9,6]) }
,{sz:4,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([9,5,3,5,9]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([1,1,1,1,31]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,27,21,17,17]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,19,21,25,17]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([31,17,17,17,31]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([15,17,15,1,1]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([14,17,21,9,22]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([15,17,15,9,17]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([30,1,14,16,15]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([31,4,4,4,4]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,17,17,17,14]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,17,10,10,4]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,17,21,21,10]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,10,4,10,17]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([17,10,4,4,4]) }
,{sz:5,w:7,ofs:0,asc:5,dsc:1,data:new Uint8Array([31,8,4,2,31]) }
,{sz:4,w:7,ofs:0,asc:7,dsc:1,data:new Uint8Array([12,2,2,1,2,2,12]) }
,{sz:1,w:7,ofs:2,asc:7,dsc:1,data:new Uint8Array([1,1,1,0,1,1,1]) }
,{sz:4,w:7,ofs:1,asc:7,dsc:1,data:new Uint8Array([3,4,4,8,4,4,3]) }
,{sz:5,w:7,ofs:0,asc:6,dsc:4,data:new Uint8Array([2,21,8]) }
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,null
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:0,w:7,ofs:0,asc:0,dsc:0}
,{sz:5,w:7,ofs:0,asc:4,dsc:4,data:new Uint8Array([31]) }
] };

Voxelarium.Fonts.TI99 = font;

},{}],41:[function(require,module,exports){

if( Number(THREE.REVISION) >= 76 ) {
	var count_is_getter = false;
  Object.freeze( count_is_getter );
}
else {
	var count_is_getter = true;
  Object.freeze( count_is_getter );
}

const attribs = [ { name:"position",
                    bytes:4,
                    size:3,
                    normalize:false,
                    buftype:Float32Array },
                  { name:"uv",
                    bytes:4,
                    size:2,
                    normalize:false,
                    buftype:Float32Array },
                  { name:"color",
                    bytes:4,
                    size:4,
                    normalize:false,
                    buftype:Float32Array },
                  { name:"normal",
                    bytes:4,
                    size:3,
                    normalize:false,
                    buftype:Float32Array },

//, "in_FaceColor", "in_Modulous"
//, "in_Pow"
//, "in_flat_color", "in_use_texture", "in_decal_texture"
];


Voxelarium.GeometryBasicBuffer = function () {
    var buffer = {};
     buffer.geometry = new THREE.BufferGeometry();

     buffer.geometry.uniforms = {
             edge_only : false,
     	};

    // create a simple square shape. We duplicate the top left and bottom right
    // vertices because each vertex needs to appear once per triangle.
    buffer.position = new Float32Array( [] );
    buffer.uv = new Float32Array( [] );
    buffer.color = new Float32Array( [] );
    buffer.normal = new Float32Array( [] );
    /*
    buffer.in_FaceColor = new Uint8Array( [] );
    buffer.in_Pow = new Uint8Array( [] );
    buffer.in_use_texture = new Uint8Array( [] );
    buffer.in_flat_color = new Uint8Array( [] );
    buffer.in_decal_texture = new Uint8Array( [] );
    buffer.in_Modulous = new Int8Array( [] );
    */
    buffer.available = 0;
    buffer.used = 0;

    buffer.clear = function() {
        this.used = 0;
    }

    attribs.forEach( (att)=>{
      buffer.geometry.addAttribute( att.name, new THREE.BufferAttribute( buffer[att.name], att.size, att.normalize ))
    })


     buffer.expand = function() {
         var newbuf;
         this.available = ( this.available + 1 ) * 2;

          attribs.forEach( (attrib)=>{
            newbuf =   new attrib.buftype( new ArrayBuffer( this.available * ( attrib.bytes * attrib.size ) ) );
            newbuf.set( buffer[attrib.name] );
            buffer[attrib.name] = newbuf;
          })
     };

     buffer.markDirty = function () {
        this.geometry.drawRange.count = this.used;
         attribs.forEach( (attrib)=>{
             var attribu = this.geometry.getAttribute(attrib.name);
             attribu.needsUpdate = true;
             attribu.array = buffer[attrib.name];
             if( !count_is_getter )
                attribu.count = this.used;
         })
         //console.log( "dirty", this.geometry.attributes );
     }

     buffer.addPoint = function( v, t, tBase, c, fc, n, p, ut, flat, dt, mod ) {
         if( this.used >= this.available )
            this.expand();
            const u2 = this.used * 2;
            const u3 = this.used * 3;
            const u4 = this.used * 4;
        if( t ) {
            this.uv[u2+0] = t[tBase+0];
            this.uv[u2+1] = t[tBase+1];
        }
        else {
            this.uv[u2+0] = 0;
            this.uv[u2+1] = 0;
        }
        this.position[u3 + 0 ] = v.x;
        this.position[u3 + 1 ] = v.y;
        this.position[u3 + 2 ] = v.z;

          this.color[u4 + 0 ] = 1;
          this.color[u4 + 1 ] = 1;
          this.color[u4 + 2 ] = 1;
          this.color[u4 + 3 ] = 1;

        this.normal[u3 + 0] = n?n.x:0;
        this.normal[u3 + 1] = n?n.y:0;
        this.normal[u3 + 2] = n?n.z:1;

        /*
        if( fc ) {
        this.in_FaceColor[u4 + 0 ] = fc.x*255;
        this.in_FaceColor[u4 + 1 ] = fc.y*255;
        this.in_FaceColor[u4 + 2 ] = fc.z*255;
        this.in_FaceColor[u4 + 3 ] = fc.w*255; }

        this.in_Pow[ this.used ] = p;
        this.in_use_texture[ this.used ] = ut;
        this.in_flat_color[this.used] = flat;
        this.in_decal_texture[this.used] = dt;
        this.in_Modulous[this.used * 2 + 0] = mod[0];
        this.in_Modulous[this.used * 2 + 1] = mod[1];
*/
        this.used++;
    };

     //buffer.

     buffer.AddQuad = function( norm, P1,P2,P3,P4,faceColor,color,pow ) {

         const min = 0;
         const max = 1;
         this.addPoint( P1, undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,min] );
         this.addPoint( P2, undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( P3, undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
         this.addPoint( P2, undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( P4, undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,max] );
         this.addPoint( P3, undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
     }
     buffer.AddQuadTexture = function( norm, P1,P2,P3,P4,textureCoords ) {
         const min = 0;
         const max = 1;
         this.addPoint( P1, textureCoords.uv_array, 0, white, undefined, norm, undefined, 255, false, false, [min,min] );
         this.addPoint( P2, textureCoords.uv_array, 2, white, undefined, norm, undefined, 255, false, false, [max,min] );
         this.addPoint( P3, textureCoords.uv_array, 4, white, undefined, norm, undefined, 255, false, false, [min,max] );
         this.addPoint( P2, textureCoords.uv_array, 2, white, undefined, norm, undefined, 255, false, false, [max,min] );
         this.addPoint( P4, textureCoords.uv_array, 6, white, undefined, norm, undefined, 255, false, false, [max,max] );
         this.addPoint( P3, textureCoords.uv_array, 4, white, undefined, norm, undefined, 255, false, false, [min,max] );
     }
     buffer.addSimpleQuad = function( quad, color, faceColor, norm, pow ) {
         var min = 0;
         var max = 1;
         this.addPoint( quad[0], undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,min] );
         this.addPoint( quad[1], undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( quad[2], undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
         this.addPoint( quad[1], undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( quad[3], undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,max] );
         this.addPoint( quad[2], undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
     }
     const white = new THREE.Vector4( 0.5, 0.5, 0.5, 1 );
     buffer.addSimpleQuadTex = function( quad, uvs, norm, pow ) {
         var min = 0;
         var max = 1.0;
         this.addPoint( quad[0], uvs, 0, white, white, norm, pow, 255, false, false, [min,min] );
         this.addPoint( quad[1], uvs, 2, white, white, norm, pow, 255, false, false, [max,min] );
         this.addPoint( quad[2], uvs, 4, white, white, norm, pow, 255, false, false, [min,max] );
         this.addPoint( quad[1], uvs, 2, white, white, norm, pow, 255, false, false, [max,min] );
         this.addPoint( quad[3], uvs, 6, white, white, norm, pow, 255, false, false, [max,max] );
         this.addPoint( quad[2], uvs, 4, white, white, norm, pow, 255, false, false, [min,max] );
     }

     buffer.makeVoxCube = function( size, voxelType ) {
        var v1 = new THREE.Vector3(1,1,1);
        var v2 = new THREE.Vector3(-1,1,1);
        var v3 = new THREE.Vector3(1,-1,1);
        var v4 = new THREE.Vector3(-1,-1,1);
        var v5 = new THREE.Vector3(1,1,-1);
        var v6 = new THREE.Vector3(-1,1,-1);
        var v7 = new THREE.Vector3(1,-1,-1);
        var v8 = new THREE.Vector3(-1,-1,-1);
        var quad;
        if( voxelType && voxelType.image ) {
            var in_uvs = voxelType.textureCoords.uvs;
            var uvs = voxelType.textureCoords.uv_array;
            buffer.addSimpleQuadTex( quad=[v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size),v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size)]
                , uvs
                , THREE.Vector3Forward
                , 200 )
                //quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();

            buffer.addSimpleQuadTex( quad = [v6.clone().multiplyScalar(size),v5.clone().multiplyScalar(size),v8.clone().multiplyScalar(size),v7.clone().multiplyScalar(size)]
                , voxelType.textureCoords.uvs
                , THREE.Vector3Backward
                , 200 )
                //quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v5.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Up
                    , 200 )
                  //  quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Down
                    , 200 )
                    //quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v5.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v3.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Right
                    , 200 )
                    //quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v2.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Left
                    , 200 )
                    //quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();

        }else {
        buffer.addSimpleQuad( quad=[v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size),v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size)]
            , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 0.2, 0.0, 1, 1.0 )
            , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
            , THREE.Vector3Forward
            , 200 )
            //quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v6.clone().multiplyScalar(size),v5.clone().multiplyScalar(size),v8.clone().multiplyScalar(size),v7.clone().multiplyScalar(size)]
            , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 0.2, 1, 0, 1.0 )
            , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
            , THREE.Vector3Backward
            , 200 )
            //quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v5.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 1, 0.0, 0, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Up
                , 200 )
          //      quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 0, 1, 1, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Down
                , 200 )
            //    quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v5.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v3.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 1, 0.0, 1, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Right
                , 200 )
            //    quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v2.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 1, 1, 0, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Left
                , 200 )
          //      quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        }
        this.markDirty(  );
     }

     //var material = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
     //var mesh = new THREE.Mesh( geometry, material );
     return buffer;
}




function updatePosition() {
    buffer.geometry.attributes.position.needsUpdate = true;
}

},{}],42:[function(require,module,exports){

const attribs = ["position","uv"
,"in_Color", "in_FaceColor", "in_Modulous"
,"normal", "in_Pow", "in_flat_color", "in_use_texture", "in_decal_texture"
];
const attrib_bytes =     [4,4,1,1,1,4,4,1,1,1]
const attrib_sizes =     [3,2,4,4,2,3,1,1,1,1]
const attrib_normalize = [false,false,true,true,0,0,0,0,1,0]
const attrib_buftype = [Float32Array,Float32Array
    ,Uint8Array,Uint8Array,Uint8Array
    ,Float32Array,Float32Array,Uint8Array,Uint8Array, Uint8Array]

Voxelarium.GeometryBuffer = function () {
    var buffer = {};
     buffer.geometry = new THREE.BufferGeometry();

     buffer.geometry.uniforms = {
             edge_only : false,
     	};

    // create a simple square shape. We duplicate the top left and bottom right
    // vertices because each vertex needs to appear once per triangle.
    buffer.position = new Float32Array( [] );
    buffer.uv = new Float32Array( [] );
    buffer.in_Color = new Uint8Array( [] );
    buffer.in_FaceColor = new Uint8Array( [] );
    buffer.normal = new Float32Array( [] );
    buffer.in_Pow = new Float32Array( [] );
    buffer.in_use_texture = new Uint8Array( [] );
    buffer.in_flat_color = new Uint8Array( [] );
    buffer.in_decal_texture = new Uint8Array( [] );
    buffer.in_Modulous = new Int8Array( [] );
    buffer.available = 0;
    buffer.used = 0;

    buffer.clear = function() {
        this.used = 0;
    }

    attribs.forEach( (att,index)=>{
      buffer.geometry.addAttribute( att, new THREE.BufferAttribute( buffer[att], attrib_sizes[index], attrib_normalize[index] ))
    })


     buffer.expand = function() {
         var newbuf;
         this.available = ( this.available + 1 ) * 2;

          attribs.forEach( (att,index)=>{
            newbuf =   new attrib_buftype[index]( new ArrayBuffer( this.available * ( attrib_bytes[index] * attrib_sizes[index] ) ) );
            newbuf.set( buffer[att] );
            buffer[att] = newbuf;
          })
     };

     buffer.markDirty = function () {

         attribs.forEach( (att)=>{
             var attrib = this.geometry.getAttribute(att);
             attrib.needsUpdate = true;
             attrib.array = buffer[att];
             attrib.count = buffer.used;
         })
         //console.log( "dirty", this.geometry.attributes );
     }

     buffer.addPoint = function( v, t, tBase, c, fc, n, p, ut, flat, dt, mod ) {
         if( this.used >= this.available )
            this.expand();
            const u2 = this.used * 2;
            const u3 = this.used * 3;
            const u4 = this.used * 4;
        if( t ) {
            this.uv[u2+0] = t[tBase+0];
            this.uv[u2+1] = t[tBase+1];
        }
        else {
            this.uv[u2+0] = 0;
            this.uv[u2+1] = 0;
        }
        this.position[u3 + 0 ] = v.x;
        this.position[u3 + 1 ] = v.y;
        this.position[u3 + 2 ] = v.z;
        if( c ) {
        this.in_Color[u4 + 0 ] = c.x*255;
        this.in_Color[u4 + 1 ] = c.y*255;
        this.in_Color[u4 + 2 ] = c.z*255;
        this.in_Color[u4 + 3 ] = c.w*255; }

        if( fc ) {
        this.in_FaceColor[u4 + 0 ] = fc.x*255;
        this.in_FaceColor[u4 + 1 ] = fc.y*255;
        this.in_FaceColor[u4 + 2 ] = fc.z*255;
        this.in_FaceColor[u4 + 3 ] = fc.w*255; }

        this.normal[u3 + 0] = n?n.x:0;
        this.normal[u3 + 1] = n?n.y:0;
        this.normal[u3 + 2] = n?n.z:1;

        this.in_Pow[ this.used ] = p;
        this.in_use_texture[ this.used ] = ut;
        this.in_flat_color[this.used] = flat;
        this.in_decal_texture[this.used] = dt;
        this.in_Modulous[this.used * 2 + 0] = mod[0];
        this.in_Modulous[this.used * 2 + 1] = mod[1];

        this.used++;
    };

     //buffer.

     buffer.AddQuad = function( norm, P1,P2,P3,P4,faceColor,color,pow ) {

         const min = 0;
         const max = 1;
         this.addPoint( P1, undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,min] );
         this.addPoint( P2, undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( P3, undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
         this.addPoint( P2, undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( P4, undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,max] );
         this.addPoint( P3, undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
     }
     buffer.AddQuadTexture = function( norm, P1,P2,P3,P4,textureCoords ) {
         const min = 0;
         const max = 1;
         this.addPoint( P1, textureCoords.uv_array, 0, undefined, undefined, norm, undefined, 255, false, false, [min,min] );
         this.addPoint( P2, textureCoords.uv_array, 2, undefined, undefined, norm, undefined, 255, false, false, [max,min] );
         this.addPoint( P3, textureCoords.uv_array, 4, undefined, undefined, norm, undefined, 255, false, false, [min,max] );
         this.addPoint( P2, textureCoords.uv_array, 2, undefined, undefined, norm, undefined, 255, false, false, [max,min] );
         this.addPoint( P4, textureCoords.uv_array, 6, undefined, undefined, norm, undefined, 255, false, false, [max,max] );
         this.addPoint( P3, textureCoords.uv_array, 4, undefined, undefined, norm, undefined, 255, false, false, [min,max] );
     }
     buffer.addSimpleQuad = function( quad, color, faceColor, norm, pow ) {
         var min = 0;
         var max = 1;
         this.addPoint( quad[0], undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,min] );
         this.addPoint( quad[1], undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( quad[2], undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
         this.addPoint( quad[1], undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,min] );
         this.addPoint( quad[3], undefined, undefined, color, faceColor, norm, pow, false, false, false, [max,max] );
         this.addPoint( quad[2], undefined, undefined, color, faceColor, norm, pow, false, false, false, [min,max] );
     }
     const white = new THREE.Vector4( 0.5, 0, 0, 1 );
     buffer.addSimpleQuadTex = function( quad, uvs, norm, pow ) {
         var min = 0;
         var max = 1.0;
         this.addPoint( quad[0], uvs, 0, white, white, norm, pow, 255, false, false, [min,min] );
         this.addPoint( quad[1], uvs, 2, white, white, norm, pow, 255, false, false, [max,min] );
         this.addPoint( quad[2], uvs, 4, white, white, norm, pow, 255, false, false, [min,max] );
         this.addPoint( quad[1], uvs, 2, white, white, norm, pow, 255, false, false, [max,min] );
         this.addPoint( quad[3], uvs, 6, white, white, norm, pow, 255, false, false, [max,max] );
         this.addPoint( quad[2], uvs, 4, white, white, norm, pow, 255, false, false, [min,max] );
     }

     buffer.makeVoxCube = function( size, voxelType ) {
        var v1 = new THREE.Vector3(1,1,1);
        var v2 = new THREE.Vector3(-1,1,1);
        var v3 = new THREE.Vector3(1,-1,1);
        var v4 = new THREE.Vector3(-1,-1,1);
        var v5 = new THREE.Vector3(1,1,-1);
        var v6 = new THREE.Vector3(-1,1,-1);
        var v7 = new THREE.Vector3(1,-1,-1);
        var v8 = new THREE.Vector3(-1,-1,-1);
        var quad;
        if( voxelType && voxelType.image
				   && (( voxelType.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_SHADER ) == 0 )
           ) {
            var in_uvs = voxelType.textureCoords.uvs;
            var uvs = voxelType.textureCoords.uv_array;
            buffer.addSimpleQuadTex( quad=[v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size),v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size)]
                , uvs
                , THREE.Vector3Forward
                , 200 )
                quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();

            buffer.addSimpleQuadTex( quad = [v6.clone().multiplyScalar(size),v5.clone().multiplyScalar(size),v8.clone().multiplyScalar(size),v7.clone().multiplyScalar(size)]
                , voxelType.textureCoords.uvs
                , THREE.Vector3Backward
                , 200 )
                quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v5.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Up
                    , 200 )
                    quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Down
                    , 200 )
                    quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v5.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v3.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Right
                    , 200 )
                    quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
            buffer.addSimpleQuadTex( quad = [v2.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                    , voxelType.textureCoords.uvs
                    , THREE.Vector3Left
                    , 200 )
                    quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();

        }else {
        buffer.addSimpleQuad( quad=[v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size),v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size)]
            , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 0.2, 0.0, 1, 1.0 )
            , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
            , THREE.Vector3Forward
            , 200 )
            quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v6.clone().multiplyScalar(size),v5.clone().multiplyScalar(size),v8.clone().multiplyScalar(size),v7.clone().multiplyScalar(size)]
            , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 0.2, 1, 0, 1.0 )
            , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
            , THREE.Vector3Backward
            , 200 )
            quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v5.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 1, 0.0, 0, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Up
                , 200 )
                quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 0, 1, 1, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Down
                , 200 )
                quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v5.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v3.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 1, 0.0, 1, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Right
                , 200 )
                quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        buffer.addSimpleQuad( quad = [v2.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                , voxelType && voxelType.properties.EdgeColor || new THREE.Vector4( 1, 1, 0, 1.0 )
                , voxelType && voxelType.properties.FaceColor || new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Left
                , 200 )
                quad[0].delete(); quad[1].delete(); quad[2].delete(); quad[3].delete();
        }
        this.markDirty(  );
     }

     //var material = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
     //var mesh = new THREE.Mesh( geometry, material );
     return buffer;
}




function updatePosition() {
    buffer.geometry.attributes.position.needsUpdate = true;
}

},{}],43:[function(require,module,exports){


Voxelarium.GeometryBufferMono = function () {
    var buffer = {};
     buffer.geometry = new THREE.BufferGeometry();
     buffer.geometry.uniforms = {
             in_Color : new THREE.Vector4(1,0,0,1),
             in_FaceColor : new THREE.Vector4(0,1,0,1),
             in_Pow : 20.0 ,
             edge_only : true,
     	};
    // create a simple square shape. We duplicate the top left and bottom right
    // vertices because each vertex needs to appear once per triangle.
    buffer.position = new Float32Array( [] );
    buffer.in_Texture = new Float32Array( [] );
    //buffer.in_Color = new Uint8Array( [] );
    //buffer.in_FaceColor = new Uint8Array( [] );
    buffer.in_Normal = new Float32Array( [] );
    //buffer.in_Pow = new Uint8Array( [] );
    buffer.in_use_texture = new Uint8Array( [] );
    buffer.in_flat_color = new Uint8Array( [] );
    buffer.in_decal_texture = new Uint8Array( [] );
    buffer.in_Modulous = new Int8Array( [] );
    buffer.available = 0;
    buffer.used = 0;

    buffer.clear = function() {
        this.used = 0;
    }
/*
    attribute vec4 vPosition;
    attribute vec2 in_Texture;
    attribute  vec4 in_Color;
    attribute  vec4 in_FaceColor;
    attribute vec3 in_Normal;
    attribute  float in_Pow;

    attribute  float in_use_texture;
    attribute  float in_flat_color;
    attribute  float in_decal_texture;

    attribute  vec2 in_Modulous;
*/
//buffer.geometry
    buffer.geometry.addAttribute( 'position', new THREE.BufferAttribute( buffer.position, 3 ) );
     buffer.geometry.addAttribute( 'in_Texture', new THREE.BufferAttribute( buffer.in_Texture, 2 ) );
     //buffer.geometry.addAttribute( 'in_Color', new THREE.BufferAttribute( buffer.in_Color, 4,true ) );
     //buffer.geometry.addAttribute( 'in_FaceColor', new THREE.BufferAttribute( buffer.in_FaceColor, 4, true ) );
     buffer.geometry.addAttribute( 'in_Normal', new THREE.BufferAttribute( buffer.in_Normal, 3 ) );
     //buffer.geometry.addAttribute( 'in_Pow', new THREE.BufferAttribute( buffer.in_Pow, 1 ) );
     buffer.geometry.addAttribute( 'in_use_texture', new THREE.BufferAttribute( buffer.in_use_texture, 1 ) );
     buffer.geometry.addAttribute( 'in_flat_color', new THREE.BufferAttribute( buffer.in_flat_color, 1 ) );
     buffer.geometry.addAttribute( 'in_decal_texture', new THREE.BufferAttribute( buffer.in_decal_texture, 1 ) );
     buffer.geometry.addAttribute( 'in_Modulous', new THREE.BufferAttribute( buffer.in_Modulous, 2, false ) );



     buffer.expand = function() {
         var newbuf;
         this.available = ( this.available + 1 ) * 2;

         newbuf =   new Float32Array( new ArrayBuffer( this.available * ( 4 * 3 ) ) );
         newbuf.set( buffer.position );
         buffer.position = newbuf;

         newbuf =   new Float32Array( new ArrayBuffer( this.available * ( 4 * 2 ) ) );
         newbuf.set( buffer.in_Texture );
         buffer.in_Texture = newbuf;

         newbuf =   new Float32Array( new ArrayBuffer( this.available * ( 4 * 3 ) ) );
         newbuf.set( buffer.in_Normal );
         buffer.in_Normal = newbuf;

         newbuf =   new Uint8Array( new ArrayBuffer( this.available * ( 1 * 1 ) ) );
         newbuf.set( buffer.in_use_texture );
         buffer.in_use_texture = newbuf;

         newbuf =   new Uint8Array( new ArrayBuffer( this.available * ( 1 * 1 ) ) );
         newbuf.set( buffer.in_flat_color );
         buffer.in_flat_color = newbuf;

         newbuf =   new Uint8Array( new ArrayBuffer( this.available * ( 1 * 1 ) ) );
         newbuf.set( buffer.in_decal_texture );
         buffer.in_decal_texture = newbuf;

         newbuf =   new Int8Array( new ArrayBuffer( this.available * ( 4 * 2 ) ) );
         newbuf.set( buffer.in_Modulous );
         buffer.in_Modulous = newbuf;

     };

     buffer.markDirty = function () {
         ["position","in_Texture"
         ,"in_Modulous"
         ,"in_Normal", "in_flat_color", "in_use_texture", "in_decal_texture"
     ].forEach( (att)=>{
             var attrib = this.geometry.getAttribute(att);
             attrib.needsUpdate = true;
             attrib.array = buffer[att];
         })

         this.geometry.attributes.position.needsUpdate = true;
         this.geometry.attributes.in_Texture.needsUpdate = true;
         this.geometry.attributes.in_Normal.needsUpdate = true;
         this.geometry.attributes.in_use_texture.needsUpdate = true;
         this.geometry.attributes.in_flat_color.needsUpdate = true;
         this.geometry.attributes.in_decal_texture.needsUpdate = true;
         this.geometry.attributes.in_Modulous.needsUpdate = true;
     }

     buffer.addPoint = function( v, n, ut, flat, dt, mod ) {
         if( this.used >= this.available )
            this.expand();
            const u3 = this.used * 3;
            const u4 = this.used * 4;
        this.position[u3 + 0 ] = v.x;
        this.position[u3 + 1 ] = v.y;
        this.position[u3 + 2 ] = v.z;


        this.in_Normal[u3 + 0] = n?n.x:0;
        this.in_Normal[u3 + 1] = n?n.y:0;
        this.in_Normal[u3 + 2] = n?n.z:1;

        this.in_use_texture[ this.used ] = ut;
        this.in_flat_color[this.used] = flat;
        this.in_decal_texture[this.used] = dt;
        this.in_Modulous[this.used * 2 + 0] = mod[0];
        this.in_Modulous[this.used * 2 + 1] = mod[1];

        this.used++;
    };

     //buffer.

     buffer.AddQuad = function( norm, P1,P2,P3,P4 ) {

         const min = 0;
         const max = 1;
         this.addPoint( P1, norm, false, false, false, [min,min] );
         this.addPoint( P2,  norm, false, false, false, [max,min] );
         this.addPoint( P3,  norm, false, false, false, [min,max] );
         this.addPoint( P2,  norm, false, false, false, [max,min] );
         this.addPoint( P4,  norm, false, false, false, [max,max] );
         this.addPoint( P3,  norm, false, false, false, [min,max] );
     }
     buffer.AddQuadTexture = function( norm, P1,P2,P3,P4,textureCoords ) {
         const min = 0;
         const max = 1;
         this.addPoint( P1, norm, false, false, false, [min,min] );
         this.addPoint( P2,  norm, false, false, false, [max,min] );
         this.addPoint( P3,  norm, false, false, false, [min,max] );
         this.addPoint( P2,  norm, false, false, false, [max,min] );
         this.addPoint( P4,  norm, false, false, false, [max,max] );
         this.addPoint( P3,  norm, false, false, false, [min,max] );
     }
     const white = new THREE.Vector4( 0.5, 0.5, 0, 1 );
     buffer.addSimpleQuadTex = function( quad, uvs, norm, pow ) {
         var min = 0;
         var max = 1.0;
         this.addPoint( P1, norm, false, false, false, [min,min] );
         this.addPoint( P2,  norm, false, false, false, [max,min] );
         this.addPoint( P3,  norm, false, false, false, [min,max] );
         this.addPoint( P2,  norm, false, false, false, [max,min] );
         this.addPoint( P4,  norm, false, false, false, [max,max] );
         this.addPoint( P3,  norm, false, false, false, [min,max] );
     }
     buffer.addSimpleQuad = function( quad, norm ) {
         var min = -2;
         var max = 2;
         this.addPoint( quad[0], undefined, norm, false, false, false, [min,min] );
         this.addPoint( quad[1], undefined, norm, false, false, false, [max,min] );
         this.addPoint( quad[2], undefined, norm, false, false, false, [min,max] );
         this.addPoint( quad[1], undefined, norm, false, false, false, [max,min] );
         this.addPoint( quad[3], undefined, norm, false, false, false, [max,max] );
         this.addPoint( quad[2], undefined, norm, false, false, false, [min,max] );
     }

     buffer.makeVoxCube = function(size) {
        var v1 = new THREE.Vector3(1,1,1);
        var v2 = new THREE.Vector3(-1,1,1);
        var v3 = new THREE.Vector3(1,-1,1);
        var v4 = new THREE.Vector3(-1,-1,1);
        var v5 = new THREE.Vector3(1,1,-1);
        var v6 = new THREE.Vector3(-1,1,-1);
        var v7 = new THREE.Vector3(1,-1,-1);
        var v8 = new THREE.Vector3(-1,-1,-1);
        buffer.addSimpleQuad( [v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size),v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size)]
            , new THREE.Vector4( 0.2, 0.0, 1, 1.0 ), new THREE.Vector4( 0, 0, 0, 0.5 )
            , THREE.Vector3Forward
            , 200 )
        buffer.addSimpleQuad( [v6.clone().multiplyScalar(size),v5.clone().multiplyScalar(size),v8.clone().multiplyScalar(size),v7.clone().multiplyScalar(size)]
            , new THREE.Vector4( 0.2, 1, 0, 1.0 ), new THREE.Vector4( 0, 0, 0, 0.5 )
            , THREE.Vector3Backward
            , 200 )
        buffer.addSimpleQuad( [v5.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v2.clone().multiplyScalar(size)]
                , new THREE.Vector4( 1, 0.0, 0, 1.0 ), new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Up
                , 200 )
        buffer.addSimpleQuad( [v3.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                , new THREE.Vector4( 0, 1, 1, 1.0 ), new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Down
                , 200 )
        buffer.addSimpleQuad( [v5.clone().multiplyScalar(size),v1.clone().multiplyScalar(size),v7.clone().multiplyScalar(size),v3.clone().multiplyScalar(size)]
                , new THREE.Vector4( 1, 0.0, 1, 1.0 ), new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Right
                , 200 )
        buffer.addSimpleQuad( [v2.clone().multiplyScalar(size),v6.clone().multiplyScalar(size),v4.clone().multiplyScalar(size),v8.clone().multiplyScalar(size)]
                , new THREE.Vector4( 1, 1, 0, 1.0 )
                , new THREE.Vector4( 0, 0, 0, 0.5 )
                , THREE.Vector3Left
                , 200 )
        this.markDirty(  );
     }

     //var material = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
     //var mesh = new THREE.Mesh( geometry, material );
     return buffer;
}




function updatePosition() {
    buffer.geometry.attributes.position.needsUpdate = true;
}

},{}],44:[function(require,module,exports){


Voxelarium.GeometryShader = function() {
    return new THREE.ShaderMaterial( {

	uniforms: {
        edge_only : { type: "f", value : 0 },
        map : { type : "t", value : null }
	},
    transparent : true,
     blending: THREE.NormalBlending,
	vertexShader: `
    #define USE_MAP

    #include <common>
    #include <uv_pars_vertex>
    #include <uv2_pars_vertex>
    #include <envmap_pars_vertex>
    #include <color_pars_vertex>
    #include <morphtarget_pars_vertex>
    #include <skinning_pars_vertex>
    #include <logdepthbuf_pars_vertex>
    #include <clipping_planes_pars_vertex>

    attribute  vec4 in_Color;
    attribute  vec4 in_FaceColor;
    attribute  float in_Pow;

    attribute  float in_use_texture;
    attribute  float in_flat_color;
    attribute  float in_decal_texture;

    attribute  vec2 in_Modulous;
    varying vec4 ex_Color;
    varying vec2 ex_texCoord;
    varying float ex_Dot;
    varying  float ex_Pow;
    varying  float ex_Pow2;
    varying float vDepth;
    varying float ex_use_texture;
    varying float ex_flat_color;
    varying float ex_decal_texture;
    varying vec4 ex_FaceColor;
    #define EPSILON 1e-6

    varying  vec2 ex_Modulous;

    varying vec4 fe_normal, light_dir, eye_vec, lookat;
    //const float PI =  3.14159265;

    void main() {

    	#include <uv_vertex>
    	#include <uv2_vertex>
    	#include <color_vertex>
    	#include <skinbase_vertex>

    	#ifdef USE_ENVMAP

    	#include <beginnormal_vertex>
    	#include <morphnormal_vertex>
    	#include <skinnormal_vertex>
    	#include <defaultnormal_vertex>

    	#endif

    	#include <begin_vertex>
    	#include <morphtarget_vertex>
    	#include <skinning_vertex>

        #include <project_vertex>
/*

        {
        	vec4 ambient, diffuse, specular;
        	float NdotL, RdotV;

        	//fe_normal = vec4(gl_NormalMatrix * gl_Normal, 0.0);

        	vec4 vVertex = modelViewMatrix * vec4( transformed, 1.0 );

        	//light_dir = gl_LightSource[0].position - vVertex;

        	eye_vec = -vVertex;

        	vec4 temp_pos = projectionMatrix * vVertex;

        	float dist = length(eye_vec);
        	lookat = eye_vec - temp_pos;
        	vec4 dir = temp_pos - eye_vec;
        	vec4 center = normalize(-eye_vec);
        	vec4 proj = dot(temp_pos, normalize(-lookat)) * normalize(-lookat);

        	vec4 c = temp_pos - proj;

        	float magnitude = 1.0-acos(dot(normalize(-eye_vec), normalize(temp_pos)));

        	c = length(c) * magnitude * normalize(c);

        	vec4 dir2 = normalize(c-lookat);

        	dir2 = (dir2 * dist);

        	gl_Position.xyz = dir2.xyz;
        	gl_Position.w = temp_pos.w;

        }
*/
    	#include <logdepthbuf_vertex>

    	#include <worldpos_vertex>
    	#include <clipping_planes_vertex>
    	#include <envmap_vertex>


{
        ex_texCoord = uv;
        ex_Color = in_Color;
        ex_FaceColor = in_FaceColor;

        //normal = normalMatrix * normal;

        //dottmp = dot( normal, vec3( 0.0, 1.0, 0.0 ) );
        //dottmpright = dot( normal, vec3( 1.0, 0.0, 0.0 ) );

        ex_Pow = in_Pow;// * (/*sqrt/(1.0-dottmpright*dottmpright));
        ex_Pow2 = in_Pow;// * (/*sqrt/(1.0-dottmp*dottmp));

        ex_use_texture = in_use_texture;
        ex_flat_color = in_flat_color;
        ex_Modulous = in_Modulous;
}

    }
    `,
fragmentShader:`
    uniform vec3 diffuse;
    uniform float opacity;

    #ifndef FLAT_SHADED

    	varying vec3 vNormal;

    #endif
    #define USE_MAP

    #include <common>
    #include <color_pars_fragment>
    #include <uv_pars_fragment>
    #include <uv2_pars_fragment>
    #include <map_pars_fragment>
    #include <alphamap_pars_fragment>
    #include <aomap_pars_fragment>
    #include <envmap_pars_fragment>
    #include <fog_pars_fragment>
    #include <specularmap_pars_fragment>
    #include <logdepthbuf_pars_fragment>
    #include <clipping_planes_pars_fragment>

    varying vec2 ex_texCoord;
    varying vec4 ex_Color;

    varying float ex_Pow;
    varying float ex_Pow2;
    varying float ex_use_texture;
    varying float ex_flat_color;
    varying vec2 ex_Modulous;
    varying vec4 ex_FaceColor;
    //uniform sampler2D tex;
    uniform float edge_only;

    uniform float logDepthBufFC;
    varying float vFragDepth;

    void main() {

    	#include <clipping_planes_fragment>

    	vec4 diffuseColor = vec4( diffuse, opacity );

    	#include <logdepthbuf_fragment>
    	#include <map_fragment>
    	#include <color_fragment>
    	#include <alphamap_fragment>
    	#include <alphatest_fragment>
    	#include <specularmap_fragment>



        //if(2.0 > 1.0)
        {
                if( ex_use_texture > 0.5 )
                {
                    if( edge_only > 0.5 )
                        diffuseColor = vec4(1.0);
                    else
                        diffuseColor = vec4( texture2D( map, ex_texCoord ).rgb, 1.0 );
                      //  diffuseColor = vec4( ex_texCoord, texture2D( map, ex_texCoord ).r, 1.0 );
                    //diffuseColor =vec4(ex_texCoord.x,ex_texCoord.y,0,1);// ex_Color;
                }
                else if( ex_flat_color > 0.5 )
                {
                    diffuseColor =vec4(1,0,1,1);// ex_Color;
                }
                else
                {
                    float a = mod(ex_Modulous.x +0.5, 1.0 )-0.5;
                    float b = mod(ex_Modulous.y +0.5, 1.0 )-0.5;

                    float g;
                    float h;
                    vec3 white;
                    a = 4.0*(0.25-a*a);
                    b = 4.0*(0.25-b*b);
                    a = pow( abs(a), ex_Pow );
                    b = pow( abs(b), ex_Pow2 );

                 //g = pow( ( max(a,b)),in_Pow);
                    //h = pow( ( a*b),in_Pow/4);
                    g = min(1.0,b+a);
                    h = max((b+a)-1.0,0.0)/3.0;
                    white = vec3(1.0,1.0,1.0) * max(ex_Color.r,max(ex_Color.g,ex_Color.b));
                    //	diffuseColor = vec4( h * white + (g * ex_Color.rgb), ex_Color.a ) ;
                    //  diffuseColor = vec4( g * ex_Color.rgb, ex_Color.a ) ;
                    if( edge_only > 0.5 )
                         diffuseColor = vec4( h* ( white - ex_FaceColor.rgb )+ (g* ex_Color.rgb), (g * ex_Color.a) ) ;
                    else
                         diffuseColor = vec4( ex_FaceColor.a*(1.0-g)*ex_FaceColor.rgb + h* ( white - ex_FaceColor.rgb ) + (g* ex_Color.rgb), (1.0-g)*ex_FaceColor.a + (g * ex_Color.a) ) ;
                    //diffuseColor = vec4( (1.0-g)*ex_FaceColor.rgb + h* ( white - ex_FaceColor.rgb )+ (g* ex_Color.rgb), (1.0-g)*ex_FaceColor.a + (g * ex_Color.a) ) ;
                    //diffuseColor = vec4(g,h,1,1);
                    //diffuseColor = ex_Color;
                }
        }


    	ReflectedLight reflectedLight;
    	reflectedLight.directDiffuse = vec3( 0.0 );
    	reflectedLight.directSpecular = vec3( 0.0 );
    	reflectedLight.indirectDiffuse = diffuseColor.rgb;
    	reflectedLight.indirectSpecular = vec3( 0.0 );

    	#include <aomap_fragment>

    	vec3 outgoingLight = reflectedLight.indirectDiffuse;

    	#include <envmap_fragment>

    	gl_FragColor = diffuseColor;//vec4( outgoingLight, diffuseColor.a );

    	#include <premultiplied_alpha_fragment>
    	#include <tonemapping_fragment>
    	#include <encodings_fragment>
    	#include <fog_fragment>

    }
    `
} );

/*
#if !MORE_ROUNDED
              g = sqrt((a*a+b*b)/2);
              h = pow(g,200.0) * 0.5;  // up to 600 even works...
              g = pow( ( max(a,b)),400);
              h = (g+h);
              gl_FragColor = vec4( h * in_Color.rgb, in_Color.a ) ;
#else
*/

}

},{}],45:[function(require,module,exports){


Voxelarium.GeometryShaderMono = function() {
    return new THREE.ShaderMaterial( {

	uniforms: {
        in_Color : { value : new THREE.Vector3() },
        in_FaceColor : { value : new THREE.Vector3() },
        in_Pow : { value : 0.0 },
        edge_only : { value : 0 },
	},
    transparent : true,
     blending: THREE.NormalBlending,
	vertexShader: `
                //attribute vec4 position;
                uniform mat3 rotation;
    			attribute vec2 in_Texture;
    			uniform  vec4 in_Color;
    			uniform  vec4 in_FaceColor;
    			attribute vec3 in_Normal;
    			uniform  float in_Pow;
                attribute  float in_use_texture;
    			attribute  float in_flat_color;
    			attribute  float in_decal_texture;

        		attribute  vec2 in_Modulous;
    			varying vec4 ex_Color;
    			varying vec2 ex_texCoord;
    			varying float ex_Dot;
    			varying  float ex_Pow;
                varying  float ex_Pow2;
    			float ex_use_texture;
    			float ex_flat_color;
    			float ex_decal_texture;
    			varying vec4 ex_FaceColor;

    			varying  vec2 ex_Modulous;
    			void main(void) {
    				vec3 normal;
    				float dottmp;
                    float dottmpright;
    			    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    				ex_texCoord = in_Texture/32768.0;
    				ex_Color = in_Color;
    				ex_FaceColor = in_FaceColor;

    				normal = normalMatrix * in_Normal;

    				dottmp = dot( normal, vec3( 0.0, 1.0, 0.0 ) );
                    dottmpright = dot( normal, vec3( 1.0, 0.0, 0.0 ) );

    				ex_Pow = in_Pow;// * (/*sqrt*/(1.0-dottmpright*dottmpright));
                    ex_Pow2 = in_Pow;// * (/*sqrt*/(1.0-dottmp*dottmp));

    				ex_use_texture = in_use_texture;
    				ex_flat_color = in_flat_color;
    				ex_Modulous = in_Modulous;
    			}
    `,//.replace(/[^\x00-\x7F]/g, ""),
	fragmentShader:`
    			varying vec2 ex_texCoord;
    			varying vec4 ex_Color;

                varying float ex_Pow;
                varying float ex_Pow2;
    			float ex_use_texture;
    			float ex_flat_color;
    			varying vec2 ex_Modulous;
    			varying vec4 ex_FaceColor;
                uniform  float edge_only;
    			uniform sampler2D tex;
    			void main(void) {
    			  if( ex_use_texture > 0.5 )
    				{
    					gl_FragColor = ex_Color * texture2D( tex, ex_texCoord );
                        gl_FragColor =vec4(1,0,0,1);// ex_Color;
    				}
    				else if( ex_flat_color > 0.5 )
    				{
    					gl_FragColor =vec4(1,0,1,1);// ex_Color;
    				}
    				else
    				{
                        float a = mod(ex_Modulous.x +0.5, 1.0 )-0.5;
        				float b = mod(ex_Modulous.y +0.5, 1.0 )-0.5;

        				float g;
        				float h;
        				vec3 white;
        				a = 4.0*(0.25-a*a);
        				b = 4.0*(0.25-b*b);
        				a = pow( a, ex_Pow );
        				b = pow( b, ex_Pow2 );

        			 //g = pow( ( max(a,b)),in_Pow);
        				//h = pow( ( a*b),in_Pow/4);
        				g = min(1.0,b+a);
        				h = max((b+a)-1.0,0.0)/3.0;
        				white = vec3(1.0,1.0,1.0) * max(ex_Color.r,max(ex_Color.g,ex_Color.b));
        			//	gl_FragColor = vec4( h * white + (g * ex_Color.rgb), ex_Color.a ) ;
        			//  gl_FragColor = vec4( g * ex_Color.rgb, ex_Color.a ) ;
                    if( edge_only > 0.5 )
                        gl_FragColor = vec4( h* ( white - ex_FaceColor.rgb )+ (g* ex_Color.rgb), (g * ex_Color.a) ) ;
                    else
        			    gl_FragColor = vec4( ex_FaceColor.a*(1.0-g)*ex_FaceColor.rgb + h* ( white - ex_FaceColor.rgb )+ (g* ex_Color.rgb), (1.0-g)*ex_FaceColor.a + (g * ex_Color.a) ) ;
                    //    gl_FragColor = vec4( ex_FaceColor.a*(1.0-g)*ex_FaceColor.rgb +  (g* ex_Color.rgb), (1.0-g)*ex_FaceColor.a + (g * ex_Color.a) ) ;
    			}
            }
            `,//.replace(/[^\x00-\x7F]/g, "")

} );

/*
#if !MORE_ROUNDED
              g = sqrt((a*a+b*b)/2);
              h = pow(g,200.0) * 0.5;  // up to 600 even works...
              g = pow( ( max(a,b)),400);
              h = (g+h);
              gl_FragColor = vec4( h * in_Color.rgb, in_Color.a ) ;
#else
*/

}

},{}],46:[function(require,module,exports){
"use strict";
var voxels = require( "./voxels.js")


Voxelarium.BasicMesher = function(  ) {
    var mesher = {
		Culler : function( cluster ) {
            var culler = {
              cluster : cluster,
    			cullSector : function( sector, internal_faces, interesting_faces ) {
    				if( internal_faces )
    					Render_Basic.SectorUpdateFaceCulling( sector, false );
    				else
    					Render_Basic.SectorUpdateFaceCulling_Partial( sector, interesting_faces, false );
    			},

    			cullSingleVoxel : function ( _Sector, offset ) {

    				var Offset = new Array(19);//uint[19];
    				var VoxelState = new Array(19);
    				var Voxel;
    				var sector = new Array(19);

    				var ExtFaceState;
    				var IntFaceState;

    				if( !( sector[Voxelarium.RelativeVoxelOrds.INCENTER] = _Sector ) ) return;
    				Offset[Voxelarium.RelativeVoxelOrds.INCENTER] = offset;
                    var cluster = _Sector.cluster;
    				Offset[Voxelarium.RelativeVoxelOrds.LEFT] = offset - ( 1 * cluster.sectorSizeY );
    				Offset[Voxelarium.RelativeVoxelOrds.RIGHT] = offset + ( 1 * cluster.sectorSizeY );
    				Offset[Voxelarium.RelativeVoxelOrds.AHEAD] = offset + ( 1 * cluster.sectorSizeX * cluster.sectorSizeY );
    				Offset[Voxelarium.RelativeVoxelOrds.BEHIND] = offset - ( 1 * cluster.sectorSizeX * cluster.sectorSizeY );
    				Offset[Voxelarium.RelativeVoxelOrds.ABOVE] = offset + ( 1 );
    				Offset[Voxelarium.RelativeVoxelOrds.BELOW] = offset - ( 1 );

    				if( 0 == ( ( offset / cluster.sectorSizeY ) % cluster.sectorSizeX ) )
    				{
    					if( !( sector[Voxelarium.RelativeVoxelOrds.LEFT] = _Sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1] ) )
    						sector[Voxelarium.RelativeVoxelOrds.LEFT] = VoxelWorld.WorkingFullSector;
    					Offset[Voxelarium.RelativeVoxelOrds.LEFT] += ( cluster.sectorSizeX * cluster.sectorSizeY );
    				}
    				else
    					sector[Voxelarium.RelativeVoxelOrds.LEFT] = _Sector;

    				if( (cluster.sectorSizeX-1) == ( ( offset / cluster.sectorSizeY ) % cluster.sectorSizeX ) )
    				{
    					if( null == ( sector[Voxelarium.RelativeVoxelOrds.RIGHT] = _Sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1] ) )
    						sector[Voxelarium.RelativeVoxelOrds.RIGHT] = VoxelWorld.WorkingFullSector;
    					Offset[Voxelarium.RelativeVoxelOrds.RIGHT] -= ( cluster.sectorSizeX * cluster.sectorSizeY );
    				}
    				else
    					sector[Voxelarium.RelativeVoxelOrds.RIGHT] = _Sector;

    				if( (cluster.sectorSizeZ-1) == ( ( offset / cluster.sectorSizeY ) % cluster.sectorSizeX ) )
    				{
    					if( null == ( sector[Voxelarium.RelativeVoxelOrds.AHEAD] = _Sector.near_sectors[Voxelarium.RelativeVoxelOrds.INFRONT - 1] ) )
    						sector[Voxelarium.RelativeVoxelOrds.AHEAD] = VoxelWorld.WorkingFullSector;
    					Offset[Voxelarium.RelativeVoxelOrds.AHEAD] -= ( cluster.sectorSizeX * cluster.sectorSizeY * cluster.sectorSizeZ );
    				}
    				else
    					sector[Voxelarium.RelativeVoxelOrds.AHEAD] = _Sector;

    				if( 0 == ( ( offset / ( cluster.sectorSizeY * cluster.sectorSizeX ) ) % cluster.sectroSizeZ ) )
    				{
    					if( null == ( sector[Voxelarium.RelativeVoxelOrds.BEHIND] = _Sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1] ) )
    						sector[Voxelarium.RelativeVoxelOrds.BEHIND] = VoxelWorld.WorkingFullSector;
    					Offset[Voxelarium.RelativeVoxelOrds.BEHIND] += ( cluster.sectorSizeX * cluster.sectorSizeY * cluster.sectorSizeZ );
    				}
    				else
    					sector[Voxelarium.RelativeVoxelOrds.BEHIND] = _Sector;

    				if( (cluster.sectorSizeY-1) == ( offset % cluster.sectorSizeY ) )
    				{
    					if( null == ( sector[Voxelarium.RelativeVoxelOrds.ABOVE] = _Sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1] ) )
    						sector[Voxelarium.RelativeVoxelOrds.ABOVE] = VoxelWorld.WorkingFullSector;
    					Offset[Voxelarium.RelativeVoxelOrds.ABOVE] -= ( cluster.sectorSizeY );
    				}
    				else
    					sector[Voxelarium.RelativeVoxelOrds.ABOVE] = _Sector;

    				if( 0 == ( offset % cluster.sectorSizeY ) )
    				{
    					if( null == ( sector[Voxelarium.RelativeVoxelOrds.BELOW] = _Sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1] ) )
    						sector[Voxelarium.RelativeVoxelOrds.BELOW] = VoxelWorld.WorkingFullSector;
    					Offset[Voxelarium.RelativeVoxelOrds.BELOW] += ( cluster.sectorSizeY );
    				}
    				else
    					sector[Voxelarium.RelativeVoxelOrds.BELOW] = _Sector;

    				// Computing absolute memory pointer of blocks
    				for( var i = 0; i < 7; i++ )
    				{
    					sector[i].data.sleepState.clear( Offset[i] );
    					sector[i].Flag_IsActiveVoxels = true;

    					//Voxel_Address[i] = sector[i].Data.Data[Offset[i]];
    					VoxelType = ( sector[i].data.data[Offset[i]] );
    					if( ( VoxelType.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_DRAWFULLVOXELOPACITY ) != 0 )
    						sector[i].Flag_Render_Dirty = true;
    					if( ( VoxelType.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_DRAWTRANSPARENTRENDERING ) != 0 )
    						sector[i].Flag_Render_Dirty_Transparent = true;
    					VoxelState[i] = ( VoxelType.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS );
    				}

    				VoxelType = _Sector.data.data[Offset[Voxelarium.RelativeVoxelOrds.INCENTER]];

    				// Getting case subtables.

    				ExtFaceState = Voxelarium.ExtFaceStateTable[VoxelType.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];
    				IntFaceState = Voxelarium.IntFaceStateTable[VoxelType.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];

    				// Computing face culling for center main stored voxel.

    				FaceCulling[Offset[Voxelarium.RelativeVoxelOrds.INCENTER]]
    												= (( IntFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.LEFT]] & Voxelarium.FACEDRAW_Operations.LEFT )
    													   | ( IntFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.RIGHT]] & Voxelarium.FACEDRAW_Operations.RIGHT )
    													   | ( IntFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.INFRONT]] & Voxelarium.FACEDRAW_Operations.AHEAD )
    													   | ( IntFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.BEHIND]] & Voxelarium.FACEDRAW_Operations.BEHIND )
    													   | ( IntFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.ABOVE]] & Voxelarium.FACEDRAW_Operations.ABOVE )
    													   | ( IntFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.BELOW]] & Voxelarium.FACEDRAW_Operations.BELOW ))
    													   ;

    				// Computing face culling for nearboring voxels faces touching center voxel.
    				{
    					var Culler;
    					var Culling;
    					if( ( Culler = sector[Voxelarium.RelativeVoxelOrds.LEFT].Culler ) != null )
    					{
    						Culling = Culler.FaceCulling;

    						var ofs = Offset[Voxelarium.RelativeVoxelOrds.LEFT];
    						var val = ( ( Culling[ofs] & ( ~Voxelarium.FACEDRAW_Operations.RIGHT ) )
    							| ( ExtFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.LEFT]] & Voxelarium.FACEDRAW_Operations.RIGHT ) );
    						Culling[ofs] = val;

    					}
    					if( ( Culler = sector[Voxelarium.RelativeVoxelOrds.RIGHT].Culler ) != null )
    					{
    						Culling = Culler.FaceCulling;
    						var ofs = Offset[Voxelarium.RelativeVoxelOrds.RIGHT];
    						var val = ( ( Culling[ofs] & ( ~Voxelarium.FACEDRAW_Operations.LEFT ) )
    							| ( ExtFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.RIGHT]] & Voxelarium.FACEDRAW_Operations.LEFT ) );
    						Culling[ofs] = val;
    					}
    					if( ( Culler = sector[Voxelarium.RelativeVoxelOrds.AHEAD].Culler ) != null )
    					{
    						Culling = Culler.FaceCulling;
    						var ofs = Offset[Voxelarium.RelativeVoxelOrds.AHEAD];
    						var val = ( ( Culling[ofs] & ( ~Voxelarium.FACEDRAW_Operations.BEHIND ) )
    							| ( ExtFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.AHEAD]] & Voxelarium.FACEDRAW_Operations.BEHIND ) );
    						Culling[ofs] = val;
    					}
    					if( ( Culler = sector[Voxelarium.RelativeVoxelOrds.BEHIND].Culler ) != null )
    					{
    						Culling = Culler.FaceCulling;
    						var ofs = Offset[Voxelarium.RelativeVoxelOrds.BEHIND];
    						var val = ( ( Culling[ofs] & ( ~Voxelarium.FACEDRAW_Operations.AHEAD ) )
    							| ( ExtFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.BEHIND]] & Voxelarium.FACEDRAW_Operations.AHEAD ) );
    						Culling[ofs] = val;
    					}
    					if( ( Culler = sector[Voxelarium.RelativeVoxelOrds.ABOVE].Culler ) != null )
    					{
    						Culling = Culler.FaceCulling;
    						var ofs = Offset[Voxelarium.RelativeVoxelOrds.ABOVE];
    						var val = ( ( Culling[ofs] & ( ~Voxelarium.FACEDRAW_Operations.BELOW ) )
    							| ( ExtFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.ABOVE]] & Voxelarium.FACEDRAW_Operations.BELOW ) );
    						Culling[ofs] = val;
    					}
    					if( ( Culler = sector[Voxelarium.RelativeVoxelOrds.BELOW].Culler ) != null )
    					{
    						Culling = Culler.FaceCulling;
    						var ofs = Offset[Voxelarium.RelativeVoxelOrds.BELOW];
    						var val = ( ( Culling[ofs] & ( ~Voxelarium.FACEDRAW_Operations.ABOVE ) )
    							| ( ExtFaceState[VoxelState[Voxelarium.RelativeVoxelOrds.BELOW]] & Voxelarium.FACEDRAW_Operations.ABOVE ) );
    						Culling[ofs] = val;
    					}
    				}
    				// printf("State[Center]:%x [Left]%x [Right]%x [INFRONT]%x [BEHIND]%x [ABOVE]%x [BELOW]%x\n",VoxelState[Voxelarium.RelativeVoxelOrds.INCENTER],VoxelState[Voxelarium.RelativeVoxelOrds.LEFT],VoxelState[Voxelarium.RelativeVoxelOrds.RIGHT],VoxelState[Voxelarium.RelativeVoxelOrds.INFRONT],VoxelState[Voxelarium.RelativeVoxelOrds.BEHIND],VoxelState[Voxelarium.RelativeVoxelOrds.ABOVE],VoxelState[Voxelarium.RelativeVoxelOrds.BELOW]);
    			},

    			cullSingleVoxel2 : function( x, y, z ) {
    				var sector = cluster.getSector( x / cluster.sectorSizeX, y / cluster.sectorSizeY, z / cluster.sectorSizeZ );
    				var offset = ( ( ( x % cluster.sectorSizeX ) * cluster.sectorSizeY )
    								+ ( y % cluster.sectorSizeY )
    								+ ( ( z % cluster.sectorSizeZ ) << ( cluster.sectorSizeY + cluster.sectorSizeX ) ) );
    				CullSingleVoxel( sector, offset );
    			}
            }

            culler.FaceCulling = new Array(cluster.sectorSize);
            var n;
            for( n = 0; n < cluster.sectorSize; n++ )
                culler.FaceCulling[n] = 0xFF;
            return culler;
        }
        , sectorTable : new Array(27)
		, SectorDataTable : new Array(27)
		, BlocMatrix : [new Array(9),new Array(9),new Array(9)]

    , initCulling : function( sector ) {
      var tmp = sector.data.FaceCulling = new Array( sector.cluster.sectorSize );
      for( var n = 0; n < tmp.length; n++ )
        tmp[n] = 0xFF;
    }
		,SectorUpdateFaceCulling : function ( sector, isolated )
		{
			var MissingSector;
      var cluster = sector.cluster;
			var tmpp;
			var i;
      var sectorTable = this.sectorTable;
      var SectorDataTable = this.SectorDataTable;
      var BlocMatrix = this.BlocMatrix;

			if( isolated ) MissingSector = cluster.WorkingEmptySector;
			else MissingSector = cluster.WorkingFullSector;

			// (Voxelarium.FACEDRAW_Operations.ABOVE | Voxelarium.FACEDRAW_Operations.BELOW | Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.AHEAD | Voxelarium.FACEDRAW_Operations.BEHIND);
			for( i = 0; i < 27; i++ ) sectorTable[i] = MissingSector;
			sectorTable[0] = sector; if( sectorTable[0] == null ) { return; }
			sectorTable[1] = sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1]; if( sectorTable[1] == null ) { sectorTable[1] = MissingSector; sectorTable[0].PartialCulling |= Voxelarium.FACEDRAW_Operations.LEFT; }
			sectorTable[2] = sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1]; if( sectorTable[2] == null ) { sectorTable[2] = MissingSector; sectorTable[0].PartialCulling |= Voxelarium.FACEDRAW_Operations.RIGHT; }
			sectorTable[3] = sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1]; if( sectorTable[3] == null ) { sectorTable[3] = MissingSector; sectorTable[0].PartialCulling |= Voxelarium.FACEDRAW_Operations.BEHIND; }
			sectorTable[6] = sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1]; if( sectorTable[6] == null ) { sectorTable[6] = MissingSector; sectorTable[0].PartialCulling |= Voxelarium.FACEDRAW_Operations.AHEAD; }
			sectorTable[9] = sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1]; if( sectorTable[9] == null ) { sectorTable[9] = MissingSector; sectorTable[0].PartialCulling |= Voxelarium.FACEDRAW_Operations.BELOW; }
			sectorTable[18] = sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1]; if( sectorTable[18] == null ) { sectorTable[18] = MissingSector; sectorTable[0].PartialCulling |= Voxelarium.FACEDRAW_Operations.ABOVE; }
			for( i = 0; i < 27; i++ ) SectorDataTable[i] = sectorTable[i].data.data;


			var xc, yc, zc;
			var xp, yp, zp;
			var xpp, ypp, zpp;
			var info;

      const tables = sector.cluster.lookupTables;
			//sectorTable[0].Flag_Void_Regular = true;
			//sectorTable[0].Flag_Void_Transparent = true;

			for( xc = 0; xc < cluster.sectorSizeX; xc++ )
			{
				xp = xc + 1; xpp = xc + 2;
				for( zc = 0; zc < cluster.sectorSizeZ; zc++ )
				{
					zp = zc + 1; zpp = zc + 2;

					// Prefetching the bloc matrix (only 2 rows)
					//    BlocMatrix[1][0] = SectorDataTable[(VoxelSector.tables.tableX[xc ]+tables.tableY[0]+tables.tableZ[zc ])][tables.ofTableX[xc]+tables.ofTableY[0]+tables.ofTableZ[zc]];
					BlocMatrix[1][1] = SectorDataTable[( tables.tableX[xp] + tables.tableY[0] + tables.tableZ[zc] )][tables.ofTableX[xp] + tables.ofTableY[0] + tables.ofTableZ[zc]];
					//    BlocMatrix[1][2] = SectorDataTable[(tables.tableX[xpp]+tables.tableY[0]+tables.tableZ[zc ])][tables.ofTableX[xpp]+tables.ofTableY[0]+tables.ofTableZ[zc ]]
					BlocMatrix[1][3] = SectorDataTable[( tables.tableX[xc] + tables.tableY[0] + tables.tableZ[zp] )][tables.ofTableX[xc] + tables.ofTableY[0] + tables.ofTableZ[zp]];
					BlocMatrix[1][4] = SectorDataTable[( tables.tableX[xp] + tables.tableY[0] + tables.tableZ[zp] )][tables.ofTableX[xp] + tables.ofTableY[0] + tables.ofTableZ[zp]];
					BlocMatrix[1][5] = SectorDataTable[( tables.tableX[xpp] + tables.tableY[0] + tables.tableZ[zp] )][tables.ofTableX[xpp] + tables.ofTableY[0] + tables.ofTableZ[zp]];
					//    BlocMatrix[1][6] = SectorDataTable[(tables.tableX[xc ]+tables.tableY[0]+tables.tableZ[zpp])][tables.ofTableX[xc ]+tables.ofTableY[0]+tables.ofTableZ[zpp]]
					BlocMatrix[1][7] = SectorDataTable[( tables.tableX[xp] + tables.tableY[0] + tables.tableZ[zpp] )][tables.ofTableX[xp] + tables.ofTableY[0] + tables.ofTableZ[zpp]];
					//    BlocMatrix[1][8] = SectorDataTable[(tables.tableX[xpp]+tables.tableY[0]+tables.tableZ[zpp])][tables.ofTableX[xpp]+tables.ofTableY[0]+tables.ofTableZ[zpp]]

					//    BlocMatrix[2][0] = SectorDataTable[(tables.tableX[xc ]+tables.tableY[1]+tables.tableZ[zc ])][tables.ofTableX[xc ]+tables.ofTableY[1]+tables.ofTableZ[zc ]]
					BlocMatrix[2][1] = SectorDataTable[( tables.tableX[xp] + tables.tableY[1] + tables.tableZ[zc] )][tables.ofTableX[xp] + tables.ofTableY[1] + tables.ofTableZ[zc]];
					//    BlocMatrix[2][2] = SectorDataTable[(tables.tableX[xpp]+tables.tableY[1]+tables.tableZ[zc ])][tables.ofTableX[xpp]+tables.ofTableY[1]+tables.ofTableZ[zc ]]
					BlocMatrix[2][3] = SectorDataTable[( tables.tableX[xc] + tables.tableY[1] + tables.tableZ[zp] )][tables.ofTableX[xc] + tables.ofTableY[1] + tables.ofTableZ[zp]];
					BlocMatrix[2][4] = SectorDataTable[( tables.tableX[xp] + tables.tableY[1] + tables.tableZ[zp] )][tables.ofTableX[xp] + tables.ofTableY[1] + tables.ofTableZ[zp]];
					BlocMatrix[2][5] = SectorDataTable[( tables.tableX[xpp] + tables.tableY[1] + tables.tableZ[zp] )][tables.ofTableX[xpp] + tables.ofTableY[1] + tables.ofTableZ[zp]];
					//    BlocMatrix[2][6] = SectorDataTable[(tables.tableX[xc ]+tables.tableY[1]+tables.tableZ[zpp])][tables.ofTableX[xc ]+tables.ofTableY[1]+tables.ofTableZ[zpp]]
					BlocMatrix[2][7] = SectorDataTable[( tables.tableX[xp] + tables.tableY[1] + tables.tableZ[zpp] )][tables.ofTableX[xp] + tables.ofTableY[1] + tables.ofTableZ[zpp]];
					//    BlocMatrix[2][8] = SectorDataTable[(tables.tableX[xpp]+tables.tableY[1]+tables.tableZ[zpp])][tables.ofTableX[xpp]+tables.ofTableY[1]+tables.ofTableZ[zpp]]

					for( yc = 0; yc < cluster.sectorSizeY; yc++ )
					{
						yp = yc + 1; ypp = yc + 2;

						// Scrolling bloc matrix by exchangingypp references.
						tmpp = BlocMatrix[0];
						BlocMatrix[0] = BlocMatrix[1];
						BlocMatrix[1] = BlocMatrix[2];
						BlocMatrix[2] = tmpp;

						// Fetching a new bloc of data slice;
                        var hereOfs;

						//      BlocMatrix[2][0] = SectorDataTable[(tables.tableX[xc ]+tables.tableY[ypp]+tables.tableZ[zc ])].Data;    [tables.ofTableX[xc ]+tables.ofTableY[ypp]+tables.ofTableZ[zc ]]
						BlocMatrix[2][1] = SectorDataTable[( tables.tableX[xp] + tables.tableY[ypp] + tables.tableZ[zc] )][tables.ofTableX[xp] + tables.ofTableY[ypp] + tables.ofTableZ[zc]];
						//      BlocMatrix[2][2] = SectorDataTable[(tables.tableX[xpp]+tables.tableY[ypp]+tables.tableZ[zc ])].Data;	   [tables.ofTableX[xpp]+tables.ofTableY[ypp]+tables.ofTableZ[zc ]]
						BlocMatrix[2][3] = SectorDataTable[( tables.tableX[xc] + tables.tableY[ypp] + tables.tableZ[zp] )][tables.ofTableX[xc] + tables.ofTableY[ypp] + tables.ofTableZ[zp]];
						BlocMatrix[2][4] = SectorDataTable[( tables.tableX[xp] + tables.tableY[ypp] + tables.tableZ[zp] )][tables.ofTableX[xp] + tables.ofTableY[ypp] + tables.ofTableZ[zp]];
						BlocMatrix[2][5] = SectorDataTable[( tables.tableX[xpp] + tables.tableY[ypp] + tables.tableZ[zp] )][tables.ofTableX[xpp] + tables.ofTableY[ypp] + tables.ofTableZ[zp]];
                        if( !BlocMatrix[2][5] ){
                            console.log( "voxel in sector has become undefined.")
                            return;
                            //debugger
                        }
						//      BlocMatrix[2][6] = SectorDataTable[(tables.tableX[xc ]+tables.tableY[ypp]+tables.tableZ[zpp])].Data;	   [tables.ofTableX[xc ]+tables.ofTableY[ypp]+tables.ofTableZ[zpp]]
						BlocMatrix[2][7] = SectorDataTable[( tables.tableX[xp] + tables.tableY[ypp] + tables.tableZ[zpp] )][tables.ofTableX[xp] + tables.ofTableY[ypp] + tables.ofTableZ[zpp]];
						//      BlocMatrix[2][8] = SectorDataTable[(tables.tableX[xpp]+tables.tableY[ypp]+tables.tableZ[zpp])].Data;	   [tables.ofTableX[xpp]+tables.ofTableY[ypp]+tables.ofTableZ[zpp]]

						// Compute face culling info
						info = 0;
						if( BlocMatrix[1][4] )
						{
                            let MainVoxelDrawInfo = BlocMatrix[1][4].properties.DrawInfo;
							let SubTable = Voxelarium.IntFaceStateTable[MainVoxelDrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];

							info |= ( ( SubTable[BlocMatrix[1][1].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS] ) & Voxelarium.FACEDRAW_Operations.BEHIND );
							info |= ( ( SubTable[BlocMatrix[1][7].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS] ) & Voxelarium.FACEDRAW_Operations.AHEAD );
							info |= ( ( SubTable[BlocMatrix[1][3].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS] ) & Voxelarium.FACEDRAW_Operations.LEFT );
							info |= ( ( SubTable[BlocMatrix[1][5].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS] ) & Voxelarium.FACEDRAW_Operations.RIGHT );
							info |= ( ( SubTable[BlocMatrix[0][4].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS] ) & Voxelarium.FACEDRAW_Operations.BELOW );
							info |= ( ( SubTable[BlocMatrix[2][4].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS] ) & Voxelarium.FACEDRAW_Operations.ABOVE );
						}

						// Write face culling info to face culling table
                        sector.data.FaceCulling[tables.ofTableX[xp] + tables.ofTableY[yp] + tables.ofTableZ[zp]] = info;
					}
				}
			}

		}


		,SectorUpdateFaceCulling_Partial : function ( cluster, sector
					, FacesToDraw, Isolated )
		{
			var MissingSector;
			var Sector_In, Sector_Out;
			var i;
			var CuledFaces;
			var Off_Ip, Off_In, Off_Op, Off_Out, Off_Aux;
			var VoxelData_In, VoxelData_Out;
			var VoxelFC_In;
			var x, y, z;
			var FaceState;
			//extern ushort IntFaceStateTable[][8];

			x = sector.pos.x;
			y = sector.pos.y;
			z = sector.pos.z;

			if( Isolated ) MissingSector = cluster.WorkingEmptySector;
			else MissingSector = cluster.WorkingFullSector;

			Sector_In = sector; if( Sector_In == null ) return ( 0 );
			Sector_Out = null;  // again a redundant assignment
			CuledFaces = 0;

			// Top Side
      VoxelFC_In = Sector_In.data.FaceCulling;
      VoxelData_In = Sector_In.data;

			if( ( FacesToDraw & Voxelarium.FACEDRAW_Operations.ABOVE ) != 0 )
				if( ( ( Sector_Out = sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1])
           || ( Sector_Out = MissingSector ) )  )
				{
					VoxelData_Out = Sector_Out.data;

					for( Off_Ip = cluster.sectorSizeY - 1, Off_Op = 0;
						Off_Ip < ( cluster.sectorSizeY * cluster.sectorSizeX );
						Off_Ip += cluster.sectorSizeY,
						Off_Op += cluster.sectorSizeY ) // x (0..15)
					{
						for( Off_Aux = 0;
							Off_Aux < ( cluster.sectorSizeX * cluster.sectorSizeY * cluster.sectorSizeZ );
							Off_Aux += ( cluster.sectorSizeX * cluster.sectorSizeY ) ) // z (0..15)
						{
							Off_In = Off_Ip + Off_Aux;
							Off_Out = Off_Op + Off_Aux;
							FaceState = Voxelarium.IntFaceStateTable[VoxelData_In.data[Off_In].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS][VoxelData_Out.data[Off_Out].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];
							if( FaceState != 0 ) VoxelFC_In[Off_In] |= Voxelarium.FACEDRAW_Operations.ABOVE;
							else VoxelFC_In[Off_In] &= ( ( ~Voxelarium.FACEDRAW_Operations.ABOVE ) & 0xFF );
						}
					}
					CuledFaces |= Voxelarium.FACEDRAW_Operations.ABOVE;
				}
			// Bottom Side

			if( ( FacesToDraw & Voxelarium.FACEDRAW_Operations.BELOW ) != 0 )
				if( ( ( Sector_Out = sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1]) || ( Sector_Out = MissingSector)) != null )
				{
					VoxelData_Out = Sector_Out.data;

					for( Off_Ip = 0, Off_Op = cluster.sectorSizeY - 1;
						 Off_Ip < ( cluster.sectorSizeY * cluster.sectorSizeZ );
						 Off_Ip += cluster.sectorSizeY,
						 Off_Op += cluster.sectorSizeY ) // x (0..15)
					{
						for( Off_Aux = 0;
							 Off_Aux < ( cluster.sectorSizeX * cluster.sectorSizeY * cluster.sectorSizeZ );
							 Off_Aux += ( cluster.sectorSizeX * cluster.sectorSizeY ) ) // z (0..15)
						{
							Off_In = Off_Ip + Off_Aux;
							Off_Out = Off_Op + Off_Aux;
							Voxel_In = VoxelData_In.data[Off_In];
							Voxel_Out = VoxelData_Out.data[Off_Out];
							//ZVoxelType * VtIn =  VoxelTypeTable[ Voxel_In ];
							//ZVoxelType * VtOut = VoxelTypeTable[ Voxel_Out ];


							FaceState = Voxelarium.IntFaceStateTable[Voxel_In.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS][Voxel_Out.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];

							//FaceState = IntFaceStateTable[ VoxelTypeTable[ VoxelData_In.Data[Off_In] ].DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS ][ VoxelTypeTable[ VoxelData_Out.Data[Off_Out] ].DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS ];
							if( FaceState != 0 ) VoxelFC_In[Off_In] |= Voxelarium.FACEDRAW_Operations.BELOW;
							else VoxelFC_In[Off_In] &= ( ~Voxelarium.FACEDRAW_Operations.BELOW & 0xFF );
						}
					}
					CuledFaces |= Voxelarium.FACEDRAW_Operations.BELOW;
				}
					// Left Side

					if( ( FacesToDraw & Voxelarium.FACEDRAW_Operations.LEFT ) != 0 )
				if( ( ( Sector_Out = sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1]) || ( Sector_Out = MissingSector)) != null )
				{
					VoxelData_Out = Sector_Out.data;
					// VoxelData_In[63]=1;
					// VoxelData_In[63 + cluster.sectorSizeY*15 ]=14; // x
					// VoxelData_In[63 + cluster.sectorSizeY * cluster.sectorSizeX * 15] = 13; // z

					for( Off_Ip = 0, Off_Op = (cluster.sectorSizeY * ( cluster.sectorSizeX - 1 ));
						Off_Ip < ( cluster.sectorSizeY * cluster.sectorSizeX * cluster.sectorSizeZ );
						Off_Ip += ( cluster.sectorSizeY * cluster.sectorSizeX ),
						Off_Op += ( cluster.sectorSizeY * cluster.sectorSizeX ) ) // z (0..15)
					{
						for( Off_Aux = 0; Off_Aux < cluster.sectorSizeY; Off_Aux++ ) // y (0..63)
						{
							Off_In = Off_Ip + Off_Aux;
							Off_Out = Off_Op + Off_Aux;
							//VoxelData_In[Off_In]=1; VoxelData_Out[Off_Out]=14;
							FaceState = Voxelarium.IntFaceStateTable[VoxelData_In.data[Off_In].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS][VoxelData_Out.data[Off_Out].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];
							if( FaceState != 0 ) VoxelFC_In[Off_In] |= Voxelarium.FACEDRAW_Operations.LEFT;
							else VoxelFC_In[Off_In] &= ( ~Voxelarium.FACEDRAW_Operations.LEFT & 0xFF );
						}
					}
					CuledFaces |= Voxelarium.FACEDRAW_Operations.LEFT;
				}

			// Right Side

			if( ( FacesToDraw & Voxelarium.FACEDRAW_Operations.RIGHT ) != 0 )
				if( ( ( Sector_Out = sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1]) || ( Sector_Out = MissingSector)) != null )
				{
					VoxelData_Out = Sector_Out.data;

					for( Off_Ip = ( cluster.sectorSizeY * ( cluster.sectorSizeX - 1 )), Off_Op = 0;
						Off_Op < ( cluster.sectorSizeY * cluster.sectorSizeX * cluster.sectorSizeZ );
						Off_Ip += ( cluster.sectorSizeY * cluster.sectorSizeX ), Off_Op += ( cluster.sectorSizeY * cluster.sectorSizeX ) ) // z (0..15)
					{
						for( Off_Aux = 0; Off_Aux < cluster.sectorSizeY; Off_Aux++ ) // y (0..63)
						{
							Off_In = Off_Ip + Off_Aux;
							Off_Out = Off_Op + Off_Aux;
							FaceState = Voxelarium.IntFaceStateTable[VoxelData_In.data[Off_In].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS][VoxelData_Out.data[Off_Out].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];
							if( FaceState != 0 ) VoxelFC_In[Off_In] |= Voxelarium.FACEDRAW_Operations.RIGHT; else VoxelFC_In[Off_In] &= ( ~Voxelarium.FACEDRAW_Operations.RIGHT & 0xFF );
						}
					}
					CuledFaces |= Voxelarium.FACEDRAW_Operations.RIGHT;
				}

			// Front Side

			if( ( FacesToDraw & Voxelarium.FACEDRAW_Operations.AHEAD ) != 0 )
				if( ( ( Sector_Out = sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1]) || ( Sector_Out = MissingSector)) != null )
				{
					VoxelData_Out = Sector_Out.data;

					for( Off_Ip = ( cluster.sectorSizeY * cluster.sectorSizeX * ( cluster.sectorSizeZ - 1 ) ), Off_Op = 0;
						Off_Op < ( cluster.sectorSizeY * cluster.sectorSizeX );
						Off_Ip += cluster.sectorSizeY, Off_Op += cluster.sectorSizeY ) // x (0..15)
					{
						for( Off_Aux = 0; Off_Aux < cluster.sectorSizeY; Off_Aux++ ) // y (0..63)
						{
							Off_In = Off_Ip + Off_Aux;
							Off_Out = Off_Op + Off_Aux;
							FaceState = Voxelarium.IntFaceStateTable[VoxelData_In.data[Off_In].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS][VoxelData_Out.data[Off_Out].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];
							if( FaceState != 0 ) VoxelFC_In[Off_In] |= Voxelarium.FACEDRAW_Operations.AHEAD;
							else VoxelFC_In[Off_In] &= ( ~Voxelarium.FACEDRAW_Operations.AHEAD & 0xFF );
						}
					}
					CuledFaces |= Voxelarium.FACEDRAW_Operations.AHEAD;
				}

			// Back Side

			if( ( FacesToDraw & Voxelarium.FACEDRAW_Operations.BEHIND ) != 0 )
				if( ( ( Sector_Out = sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1] ) || ( Sector_Out = MissingSector ) ) != null )
						{
							VoxelData_Out = Sector_Out.data;

							for( Off_Ip = 0, Off_Op = ( cluster.sectorSizeY * cluster.sectorSizeX * ( cluster.sectorSizeZ - 1 ) );
								Off_Ip < ( cluster.sectorSizeY * cluster.sectorSizeX );
								Off_Ip += cluster.sectorSizeY, Off_Op += cluster.sectorSizeY ) // x (0..15)
							{
								for( Off_Aux = 0; Off_Aux < cluster.sectorSizeY; Off_Aux++ ) // y (0..63)
								{
									Off_In = Off_Ip + Off_Aux;
									Off_Out = Off_Op + Off_Aux;
									FaceState = Voxelarium.IntFaceStateTable[VoxelData_In.data[Off_In].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS][VoxelData_Out.data[Off_Out].properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_CULLINGBITS];
									if( FaceState != 0 ) VoxelFC_In[Off_In] |= Voxelarium.FACEDRAW_Operations.BEHIND; else VoxelFC_In[Off_In] &= ( ~Voxelarium.FACEDRAW_Operations.BEHIND & 0xFF );
								}
							}
							CuledFaces |= Voxelarium.FACEDRAW_Operations.BEHIND;
						}

			//sector.PartialCulling ^= CuledFaces & ( Voxelarium.FACEDRAW_Operations.ABOVE | Voxelarium.FACEDRAW_Operations.BELOW | Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.AHEAD | Voxelarium.FACEDRAW_Operations.BEHIND );
			//sector.PartialCulling &= ( Voxelarium.FACEDRAW_Operations.ABOVE | Voxelarium.FACEDRAW_Operations.BELOW | Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.AHEAD | Voxelarium.FACEDRAW_Operations.BEHIND );
			if( CuledFaces != 0 )
			{
				//Log.log( "sector {0} {1} {2} is dirty", sector.pos.x, sector.pos.y, sector.pos.z );
				Sector_Out.Flag_Render_Dirty = true;
        Sector_In.Flag_Render_Dirty = true;
			}

			return ( CuledFaces );
		}

		, UpdateCulling : function ( Location, ImportanceFactor )
		{
			if( Location.sector == null )
			{
				return;
			}
			Location.sector.cluster.culler.CullSingleVoxel( Location.sector, Location.Offset );

			Location.sector.Flag_IsModified |= ImportanceFactor;
		}

		, SetVoxel_WithCullingUpdate : function ( VoxelType
							, ImportanceFactor
							, CreateExtension
							, Location )
		{
			if( !Location.sector )
				return false;

			// Delete Old voxel extended informations if any
			var Voxel = Location.sector.data.data[Location.Offset];
			var OtherInfos = Location.sector.data.otherInfos[Location.Offset];

			if( OtherInfos )
			{
				if( VoxelType.properties.Is_HasAllocatedMemoryExtension ) Voxel.deleteVoxelExtension( otherInfos );
			}

			// Storing Extension
			if( VoxelType.createVoxelExtension )
				Location.sector.Data.OtherInfos[Location.Offset] = VoxelType.createVoxelExtension();

			// Storing Voxel

			Location.sector.data.data[Location.Offset] = VoxelType;

			if( VoxelType.properties.Is_Active )
				Location.sector.Flag_IsActiveVoxels = true;

			UpdateCulling( Location, ImportanceFactor );
			return ( true );
		}

		, MakeSectorRenderingData : function ( sector )
		{
			var face = new THREE.Vector4( 255, 0, 0, 255 ), edge = new THREE.Vector4( 0, 0, 0, 255 );
			var power = 400;
			var x, y, z;
			var ofs;
			var info;
			var cube;
			/* build sector geometry */
      var cluster = sector.cluster;
			var Offset;
			var cubx, cuby, cubz;
			var Sector_Display_x, Sector_Display_y, Sector_Display_z;
			var Draw;
            var P0,P1,P2,P3,P4,P5,P6,P7;

            if( !sector.solid_geometry ) {
                sector.solid_geometry = cluster.getGeometryBuffer();
                sector.Flag_Render_Dirty = true;
            }
            if( !sector.data.FaceCulling )
            {
                sector.culler = cluster.mesher.culler;
                this.initCulling( sector );
              }
			// Display list creation or reuse.
			if( sector.Flag_Render_Dirty )
			{
				var geometry = sector.solid_geometry;
				var voxelSize = cluster.voxelUnitSize;
				var FaceCulling = sector.data.FaceCulling;
				//Log.log( "Is Dirty Building sector {0} {1} {2}", sector.pos.x, sector.pos.y, sector.pos.z );
				Sector_Display_x = ( sector.pos.x * cluster.sectorSizeX * voxelSize );
				Sector_Display_y = ( sector.pos.y * cluster.sectorSizeY * voxelSize );
				Sector_Display_z = ( sector.pos.z * cluster.sectorSizeZ * voxelSize );

				sector.Flag_Void_Regular = true;
				sector.Flag_Void_Transparent = true;
				sector.Flag_Void_Custom = true;
                //sector.physics.Empty = true;
				{
					geometry.clear();
					/*
					Log.log( "sector is {6} {7} {8} near l{0} r{1} ab{2} bl{3} bh{4} ah{5}"
						, ( sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT-1] != null ) ? "Yes" : "no"
						, ( sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1] != null ) ? "Yes" : "no"
						, ( sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1] != null ) ? "Yes" : "no"
						, ( sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1] != null ) ? "Yes" : "no"
						, ( sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1] != null ) ? "Yes" : "no"
						, ( sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1] != null ) ? "Yes" : "no"
						, sector.pos.x, sector.pos.y, sector.pos.z
						);
					*/
          sector.data.data.forEach( (voxel,Offset)=>
					{
                        if( geometry.available > 256000 ){
                            debugger;
                            return;
                        }
                        if( !voxel ) return;
						{
							{
								info = FaceCulling[Offset];

								if( voxel && info != Voxelarium.FACEDRAW_Operations.NONE )
								{
                                    if( voxel.properties.DrawInfo === Voxelarium.ZVOXEL_DRAWINFO_VOID )
                                        Draw = false;
									else if( voxel.properties.Draw_TransparentRendering )
										{ Draw = false; sector.Flag_Void_Transparent = false; }
									else
										{ Draw = true; sector.Flag_Void_Regular = false; }
								}
								else
									Draw = false;

								if( Draw )
								{
									var box = voxel.TextureCoords;
									var face_is_shaded;

									if( !Voxelarium.Settings.use_basic_material &&
                      ( voxel.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_SHADER ) != 0 )
									{
										face = voxel.properties.FaceColor;
										edge = voxel.properties.EdgeColor;
										power = voxel.properties.EdgePower;
										face_is_shaded = true;
									}
									else 
                   {
                    cube = voxel;
	                  face_is_shaded = false; // uses texture instead of algorithm
                  }


									if( info != 0 )
									{
										//Log.log( "Set sector {0} {1} {2} offset {3}   {4:x}", sector.pos.x, sector.pos.y, sector.pos.z, Offset, info );
										//sector.physics.SetVoxel( Offset );
									}
									else
									{
										//sector.physics.ClearVoxel( Offset );
										//continue;
									}


                  cubx = Sector_Display_x + voxelSize * ( Math.floor( Offset / cluster.sectorSizeY ) % cluster.sectorSizeX );
									cuby = Sector_Display_y + voxelSize * ( ( Offset ) % cluster.sectorSizeY );
									cubz = Sector_Display_z + voxelSize * ( Math.floor( Offset / (cluster.sectorSizeX * cluster.sectorSizeY ) ) % cluster.sectorSizeZ );
									//cubx = ( x * voxelSize + Sector_Display_x );
									//cuby = ( y * voxelSize + Sector_Display_y );
									//cubz = ( z * voxelSize + Sector_Display_z );

									if( 0 != ( voxel.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_SPECIALRENDERING ))
									{ /*VoxelTypeTable[cube].SpecialRender( cubx, cuby, cubz ); */
										console.log( "Need to add custom pass for special render" );
										return;//continue;
									}

									P0 = new THREE.Vector3( cubx, cuby, cubz );
									P1 = new THREE.Vector3( cubx + voxelSize, cuby, cubz );
									P2 = new THREE.Vector3( cubx + voxelSize,cuby, cubz + voxelSize );
									P3 = new THREE.Vector3( cubx, cuby, cubz + voxelSize );
									P4 = new THREE.Vector3( cubx, cuby + voxelSize, cubz );
									P5 = new THREE.Vector3( cubx + voxelSize, cuby + voxelSize, cubz );
									P6 = new THREE.Vector3( cubx + voxelSize, cuby + voxelSize, cubz + voxelSize );
									P7 = new THREE.Vector3( cubx, cuby + voxelSize, cubz + voxelSize );

									//Left
									if( ( info & Voxelarium.FACEDRAW_Operations.LEFT ) != 0 )
									{
										//Log.log( "Add {0} {1} {2} {3}", P4 , P0, P3, P7 );
										if( face_is_shaded )
											geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.LEFT], P3, P7, P0, P4, face, edge, power );
										else
											geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.LEFT], P3, P7, P0, P4, voxel.textureCoords );
									}

									// Right
									if( ( info & Voxelarium.FACEDRAW_Operations.RIGHT ) != 0 )
									{
										//Log.log( "Add {0} {1} {2} {3}", P5, P6, P2, P1 );
										if( face_is_shaded )
											geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.RIGHT], P1, P5, P2, P6, face, edge, power );
										else
											geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.RIGHT], P1, P5, P2, P6, voxel.textureCoords );
									}
									//Front
									if( ( info & Voxelarium.FACEDRAW_Operations.BEHIND ) != 0 )
									{
										//Log.log( "Add {0} {1} {2} {3}", P0, P4, P5, P1 );
										if( face_is_shaded )
											geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.BEHIND], P0, P4, P1, P5, face, edge, power );
										else
											geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.BEHIND], P0, P4, P1, P5, voxel.textureCoords );
									}

									//Back
									if( ( info & Voxelarium.FACEDRAW_Operations.AHEAD ) != 0 )
									{
										//Log.log( "Add {0} {1} {2} {3}", P2, P6, P3, P7 );
										if( face_is_shaded )
											geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.AHEAD], P2, P6, P3, P7, face, edge, power );
										else
											geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.AHEAD], P2, P6, P3, P7, voxel.textureCoords );
									}

									// Top
									if( ( info & Voxelarium.FACEDRAW_Operations.ABOVE ) != 0 )
									{
										//Log.log( "Add {0} {1} {2} {3}", P4, P7, P5, P6 );
										if( face_is_shaded )
											geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.ABOVE], P4, P7, P5, P6, face, edge, power );
										else
											geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.ABOVE], P4, P7, P5, P6, voxel.textureCoords );
									}

									// Bottom
									if( ( info & Voxelarium.FACEDRAW_Operations.BELOW ) != 0 )
									{
										//Log.log( "Add {0} {1} {2} {3}", P0, P1, P3, P2 );
										if( face_is_shaded )
											geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.BELOW], P3, P0, P2, P1, face, edge, power );
										else
											geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.BELOW], P3, P0, P2, P1, voxel.textureCoords );
									}
								}
								//else
								//	sector.physics.ClearVoxel( Offset );
							}
						}
					});
				}
        geometry.markDirty();
				sector.Flag_Render_Dirty = false;
			}
		}

        , fixed_lists : false

		, MakeSectorRenderingData_Sorted : function ( sector, viewed_as
											, centerX, centerY, centerZ )
		{
			if( sector.Flag_Void_Transparent )
				return;

			if( !fixed_lists )
			{
				for( var n = 19; n < 27; n++ )
					for( var m = 0; m < 3; m++ )
						OrderedFaces[n][m] = 0;
				fixed_lists = true;
			}

            var face = new THREE.Vector4( 256, 0, 0, 256 ), edge = new THREE.Vector4( 0, 0, 0, 256 );
			var power = 400;
			var x, y, z;
			var info;
			var sorted_draw_info = sorted_draw_infos[viewed_as];
			var cube, prevcube;
			/* build sector geometry */

			var Offset;
			var cubx, cuby, cubz;
			var Sector_Display_x, Sector_Display_y, Sector_Display_z;
			var Draw;

			var P0, P1, P2, P3, P4, P5, P6, P7;

			//Log.log( "Building sector {0} {1} {2}", sector.pos.x, sector.pos.y, sector.pos.z );
			// Display list creation or reuse.
			var geometry = sector.transparent_geometry;
			var voxelSize = sector.cluster.voxelUnitSize;
			var FaceCulling = sector.data.FaceCulling;
			Sector_Display_x = ( sector.pos.x * sector.Size_x * voxelSize );
			Sector_Display_y = ( sector.pos.y * sector.Size_y * voxelSize );
			Sector_Display_z = ( sector.pos.z * sector.Size_z * voxelSize );

			var SectorIndexes = SortedSectorIndexes[viewed_as];
			/*
			if( geometry.transparent_render_sorting != viewed_as )
			{
				geometry.transparent_render_sorting = viewed_as;
				sector.Flag_Render_Dirty_Transparent = true;
				geometry.sortedX = -1;
			}
			if( viewed_as == Voxelarium.RelativeVoxelOrds.INCENTER )
			{
				if( center_sorted_x != centerX
					|| center_sorted_y != centerY
					|| center_sorted_z != centerZ )
				{
					sector.Flag_Render_Dirty_Transparent = true;
					BuildSortListInSector( centerX, centerY, centerZ );
				}
			}
			*/
			if( sector.Flag_Render_Dirty_Transparent )
			{
				//Log.log( "Regnerate Alpha Geometry {0} {1} {2}", sector.pos.x, sector.pos.y, sector.pos.z );
				{
					var face_is_shaded = true;
					var view_order_list = null;
					geometry.Clear();

					prevcube = 0;
					for( var OffsetIndex = 0; OffsetIndex < VoxelSector.ZVOXELBLOCKCOUNT; OffsetIndex++ )
					{
						{
							{
								Offset = SectorIndexes[OffsetIndex];

								cube = sector.data.data[Offset];
								info = FaceCulling[Offset];// & (Voxelarium.FACEDRAW_Operations.ALL_BITS);// sorted_draw_info;
								//info = (Voxelarium.FACEDRAW_Operations)FaceCulling[Offset] & sorted_draw_info;

								if( cube && ( info )!= Voxelarium.FACEDRAW_Operations.NONE )
								{
									Draw = cube.properties.Draw_TransparentRendering;
								}
								else
									Draw = false;

								if( Draw )
								{
									var box;
									if( prevcube !== cube )
									{
										box = voxel.textureCoords;
										if( ( cube.properties.DrawInfo & Voxelarium.ZVOXEL_DRAWINFO_SHADER ) != 0 )
										{
											face = cube.properties.FaceColor;
											edge = cube.properties.EdgeColor;
											power = cube.properties.EdgePower;
											face_is_shaded = true;
										}
										else
											face_is_shaded = false;
									}
									prevcube = cube;

									cubx = ( Offset / cluster.sectorSizeY ) % cluster.sectorSizeX;
									cuby = ( Offset ) % cluster.sectorSizeY;
									cubz = ( Offset / (cluster.sectorSizeX * cluster.sectorSizeY ) ) % cluster.sectorSizeZ;

									P0.X = cubx; P0.Y = cuby; P0.Z = cubz;
									P1.X = cubx + voxelSize; P1.Y = cuby; P1.Z = cubz;
									P2.X = cubx + voxelSize; P2.Y = cuby; P2.Z = cubz + voxelSize;
									P3.X = cubx; P3.Y = cuby; P3.Z = cubz + voxelSize;
									P4.X = cubx; P4.Y = cuby + voxelSize; P4.Z = cubz;
									P5.X = cubx + voxelSize; P5.Y = cuby + voxelSize; P5.Z = cubz;
									P6.X = cubx + voxelSize; P6.Y = cuby + voxelSize; P6.Z = cubz + voxelSize;
									P7.X = cubx; P7.Y = cuby + voxelSize; P7.Z = cubz + voxelSize;


									if( viewed_as < 1 )
									{
										if( cubx < centerX )
											if( cuby < centerY )
												if( cubz < centerZ )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD];
											else
												if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD];
										else
											if( cuby < centerY )
											if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD];
										else
												if( cubz < centerZ )
											view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND];
										else
											view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD];
									}
									else if( viewed_as < 7 )
									{
										switch( viewed_as )
										{
										case Voxelarium.RelativeVoxelOrds.LEFT:
											if( cuby < centerY )
												if( cubz < centerZ )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD];
											else
												if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD];
											break;
										case Voxelarium.RelativeVoxelOrds.RIGHT:
											if( cuby < centerY )
												if( cubz < centerZ )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD];
											else
												if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD];
											break;
										case Voxelarium.RelativeVoxelOrds.AHEAD:
											if( cuby < centerY )
												if( cubx < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD];
											else
												if( cubx < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD];
											break;
										case Voxelarium.RelativeVoxelOrds.BEHIND:
											if( cuby < centerY )
												if( cubz < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND];
											else
												if( cubx < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND];
											break;
										case Voxelarium.RelativeVoxelOrds.ABOVE:
											if( cubz < centerZ )
												if( cubx < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND];
											else
												if( cubx < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD];
											break;
										case Voxelarium.RelativeVoxelOrds.BELOW:
											if( cubz < centerZ )
												if( cubz < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND];
											else
												if( cubx < centerX )
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD];
												else
													view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD];
											break;
										}
									}
									else if( viewed_as < 19 )
									{
										switch( viewed_as )
										{
										case Voxelarium.RelativeVoxelOrds.LEFT_AHEAD:
											if( cuby < centerY )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD:
											if( cuby < centerY )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.LEFT_BEHIND:
											if( cuby < centerY )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BEHIND_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BEHIND_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND:
											if( cuby < centerY )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD:
											if( cubx < centerX )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD_ABOVE];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.BELOW_AHEAD:
											if( cubx < centerX )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD_BELOW];
											break;
										case Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND:
											if( cubx < centerX )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BEHIND_ABOVE];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.BELOW_BEHIND:
											if( cubx < centerX )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BEHIND_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND_BELOW];
											break;
										case Voxelarium.RelativeVoxelOrds.LEFT_ABOVE:
											if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BEHIND_ABOVE];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.LEFT_BELOW:
											if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_BEHIND_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD_BELOW];
											break;
										case Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE:
											if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND_ABOVE];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD_ABOVE];
											break;
										case Voxelarium.RelativeVoxelOrds.RIGHT_BELOW:
											if( cubz < centerZ )
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND_BELOW];
											else
												view_order_list = OrderedFaces[Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD_BELOW];
											break;
										}
									}
									else
										view_order_list = OrderedFaces[viewed_as];
									for( var f = 0; f < 6; f++ )
									{
										switch( view_order_list[f] )
										{
										case Voxelarium.RelativeVoxelOrds.LEFT:
											//Left
											if( ( info & Voxelarium.FACEDRAW_Operations.LEFT ) != 0 )
											{
												//Log.log( "Add {0} {1} {2} {3}", P4 , P0, P3, P7 );
												if( face_is_shaded )
													geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.LEFT], P3, P7, P0, P4, face, edge, power );
												else
													geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.LEFT], P3, P7, P0, P4, voxel.textureCoords );
											}
											break;
										case Voxelarium.RelativeVoxelOrds.RIGHT:

											// Right
											if( ( info & Voxelarium.FACEDRAW_Operations.RIGHT ) != 0 )
											{
												//Log.log( "Add {0} {1} {2} {3}", P5, P6, P2, P1 );
												if( face_is_shaded )
													geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.RIGHT], P1, P5, P2, P6, face, edge, power );
												else
													geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.RIGHT], P1, P5, P2, P6, voxel.textureCoords );
											}
											break;
										case Voxelarium.RelativeVoxelOrds.BEHIND:
											//Front
											if( ( info & Voxelarium.FACEDRAW_Operations.BEHIND ) != 0 )
											{
												//Log.log( "Add {0} {1} {2} {3}", P0, P4, P5, P1 );
												if( face_is_shaded )
													geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.BEHIND], P0, P4, P1, P5, face, edge, power );
												else
													geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.BEHIND], P0, P4, P1, P5, voxel.textureCoords );
											}
											break;
										case Voxelarium.RelativeVoxelOrds.AHEAD:
											//Back
											if( ( info & Voxelarium.FACEDRAW_Operations.AHEAD ) != 0 )
											{
												//Log.log( "Add {0} {1} {2} {3}", P2, P6, P3, P7 );
												if( face_is_shaded )
													geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.AHEAD], P2, P6, P3, P7, face, edge, power );
												else
													geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.AHEAD], P2, P6, P3, P7, voxel.textureCoords );
											}
											break;
										case Voxelarium.RelativeVoxelOrds.ABOVE:
											// Top
											if( ( info & Voxelarium.FACEDRAW_Operations.ABOVE ) != 0 )
											{
												//Log.log( "Add {0} {1} {2} {3}", P4, P7, P5, P6 );
												if( face_is_shaded )
													geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.ABOVE], P4, P7, P5, P6, face, edge, power );
												else
													geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.ABOVE], P4, P7, P5, P6, voxel.textureCoords );
											}
											break;
										case Voxelarium.RelativeVoxelOrds.BELOW:
											// Bottom
											if( ( info & Voxelarium.FACEDRAW_Operations.BELOW ) != 0 )
											{
												//Log.log( "Add {0} {1} {2} {3}", P0, P1, P3, P2 );
												if( face_is_shaded )
													geometry.AddQuad( normals[Voxelarium.RelativeVoxelOrds.BELOW], P3, P0, P2, P1, face, edge, power );
												else
													geometry.AddQuadTexture( normals[Voxelarium.RelativeVoxelOrds.BELOW], P3, P0, P2, P1, voxel.textureCoords );
											}
											break;
										}
									}
								}
							}
						}
					}
				}
                geometry.markDirty();

				sector.Flag_Render_Dirty_Transparent = false;
			}
		}



		, sorted_draw_infos : new Array( 27)
        , SortedSectorIndexes : new Array(27) //ushort[27][];
		, center_sorted_x : -1
        , center_sorted_y : 0
        , center_sorted_z : 0

		/// <summary>
		/// Build the INCENTER order list.
		/// </summary>
		/// <param name="x">voxel position of viewpoint</param>
		/// <param name="y">voxel position of viewpoint</param>
		/// <param name="z">voxel position of viewpoint</param>
		, BuildSortListInSector : function ( cluster, eye_x, eye_y, eye_z )
		{
			var x, y, z;
			var tmpx, tmpy, tmpz;
			var d;
			var val;
			if( center_sorted_x != eye_x || center_sorted_y != eye_y || center_sorted_z != eye_z )
			{
				var n;
				center_sorted_x = eye_x;
				center_sorted_y = eye_y;
				center_sorted_z = eye_z;
				// x, y, z po
				sorter.Clear();
				for( x = 0; x < cluster.sectorSizeX; x++ )
					for( y = 0; y < cluster.sectorSizeY; y++ )
						for( z = 0; z < cluster.sectorSizeZ; z++ )
						{
							val = (ushort)( x * cluster.sectorSizeY + y + z * cluster.sectorSizeX * cluster.sectorSizeY );
							tmpx = x - eye_x;
							tmpy = y - eye_y;
							tmpz = z - eye_z;
							d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
							sorter.Add( d, val );
						}

				var Indexes;
				Indexes = SortedSectorIndexes[0];
				n = VoxelSector.ZVOXELBLOCKCOUNT;
                sorter.forEach( (index)=>{
					// retrieved closest to furthest so... reverse storing it.
					Indexes[--n] = index;
                })
			}
		}


		, BuildSortList : function (  )
		{
			var x, y, z;
			var tmpx, tmpy, tmpz;
			var d;
			var val;
			var binaryOutput = new ushort[VoxelSector.ZVOXELBLOCKCOUNT];
			var binaryOutputIndex = 0;

            var sorter = Voxelarium.sorters[cluster.sectorSize];
            if( !sorter )
                sorter = Voxelarium.sorters[cluster.sectorSize] = Voxelarium.SortingTree( cluster.sectorSize );
			//start_steps += 27;
			sorter.AutoBalance = true;

			var i;
			for( i = Voxelarium.RelativeVoxelOrds.INCENTER;
						i <= Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT_BELOW; i++ )
			{
				var Indexes;
				var n, m;
				var xval, zval;
				Indexes = SortedSectorIndexes[i] = new ushort[VoxelSector.ZVOXELBLOCKCOUNT];
				n = 0;
				m = VoxelSector.ZVOXELBLOCKCOUNT - 1;
				sorter.Clear();
				switch( i )
				{
					case Voxelarium.RelativeVoxelOrds.INCENTER:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL;
						// no information; this one has to be done custom.
						break;
					case Voxelarium.RelativeVoxelOrds.LEFT:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ Voxelarium.FACEDRAW_Operations.LEFT;
						//for( n = 0; n < VoxelSector.ZVOXELBLOCKCOUNT; n++ )
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)(zval + y); //(ushort)( binaryOutput[n] );
									//x = ( val >> VoxelSector.ZVOXELBLOCSHIFT_Y ) & VoxelSector.ZVOXELBLOCMASK_X;
									//y = ( val  ) & VoxelSector.ZVOXELBLOCMASK_Y;
									//z = ( val >> ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) & VoxelSector.ZVOXELBLOCMASK_Z;
									tmpx = cluster.sectorSizeX - x;
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									//Log.log("Add {0} {1} {2}  {3}", x, y, z, d);
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.RIGHT:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ Voxelarium.FACEDRAW_Operations.RIGHT;
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.ABOVE:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ Voxelarium.FACEDRAW_Operations.ABOVE;
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = y;
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BELOW:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ Voxelarium.FACEDRAW_Operations.BELOW;
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = cluster.sectorSizeY - y;
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ Voxelarium.FACEDRAW_Operations.AHEAD;
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ Voxelarium.FACEDRAW_Operations.BEHIND;
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;

					case Voxelarium.RelativeVoxelOrds.LEFT_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ (Voxelarium.FACEDRAW_Operations.LEFT|Voxelarium.FACEDRAW_Operations.AHEAD);
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = cluster.sectorSizeX - x;
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.RIGHT_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.AHEAD );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.LEFT_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.BEHIND );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = cluster.sectorSizeX - x;
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.RIGHT_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.BEHIND );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = y - ( cluster.sectorSizeY / 2 );
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;

					case Voxelarium.RelativeVoxelOrds.ABOVE_LEFT:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = cluster.sectorSizeX - x;
									tmpy = y;
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.ABOVE_RIGHT:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = y;
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.BEHIND | Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = y;
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.AHEAD | Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									val = (ushort)( x * cluster.sectorSizeY + y + z * cluster.sectorSizeX * cluster.sectorSizeY );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = y;
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;

					case Voxelarium.RelativeVoxelOrds.ABOVE_LEFT_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.AHEAD | Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = cluster.sectorSizeX - x;
									tmpy = y;
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.ABOVE_RIGHT_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.AHEAD | Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = y;
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.ABOVE_LEFT_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.BEHIND |Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									val = (ushort)( x * cluster.sectorSizeY + y + z * cluster.sectorSizeX * cluster.sectorSizeY );
									tmpx = cluster.sectorSizeX - x;
									tmpy = y;
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.ABOVE_RIGHT_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.BEHIND |Voxelarium.FACEDRAW_Operations.ABOVE );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = y;
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;

					case Voxelarium.RelativeVoxelOrds.BELOW_LEFT:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.BELOW );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = cluster.sectorSizeX - x;
									tmpy = cluster.sectorSizeY - y;
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BELOW_RIGHT:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.BELOW );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = cluster.sectorSizeY - y;
									tmpz = z - ( cluster.sectorSizeZ / 2 );
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BELOW_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.BEHIND | Voxelarium.FACEDRAW_Operations.BELOW );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = cluster.sectorSizeY - y;
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BELOW_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.AHEAD | Voxelarium.FACEDRAW_Operations.BELOW );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x - ( cluster.sectorSizeX / 2 );
									tmpy = cluster.sectorSizeY - y;
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;

					case Voxelarium.RelativeVoxelOrds.BELOW_LEFT_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.BELOW | Voxelarium.FACEDRAW_Operations.AHEAD );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = cluster.sectorSizeX - x;
									tmpy = cluster.sectorSizeY - y;
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BELOW_RIGHT_AHEAD:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.BELOW | Voxelarium.FACEDRAW_Operations.AHEAD );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = cluster.sectorSizeY - y;
									tmpz = z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BELOW_LEFT_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.LEFT | Voxelarium.FACEDRAW_Operations.BELOW | Voxelarium.FACEDRAW_Operations.BEHIND );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = cluster.sectorSizeX - x;
									tmpy = cluster.sectorSizeY - y;
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
					case Voxelarium.RelativeVoxelOrds.BELOW_RIGHT_BEHIND:
						sorted_draw_infos[i] = Voxelarium.FACEDRAW_Operations.ALL ^ ( Voxelarium.FACEDRAW_Operations.RIGHT | Voxelarium.FACEDRAW_Operations.BELOW | Voxelarium.FACEDRAW_Operations.BEHIND );
						for( x = 0; x < cluster.sectorSizeX; x++ )
						{
							xval = x * cluster.sectorSizeY;
							for( z = 0; z < cluster.sectorSizeZ; z++ )
							{
								zval = xval + z * cluster.sectorSizeX * cluster.sectorSizeY;
								for( y = 0; y < cluster.sectorSizeY; y++ )
								{
									val = (ushort)( zval + y );
									tmpx = x;
									tmpy = cluster.sectorSizeY - y;
									tmpz = cluster.sectorSizeZ - z;
									d = ( tmpx * tmpx ) + ( tmpy * tmpy ) + ( tmpz * tmpz );
									sorter.Add( d, val );
								}
							}
						}
						break;
				}

				n = VoxelSector.ZVOXELBLOCKCOUNT;
				sorcer.forEach( ()=>
    				{
    					// retrieved closest to furthest so... reverse storing it.
    					//Log.log( "index is {0} {1} {2}"
    					//	, ( index >> VoxelSector.ZVOXELBLOCSHIFT_Y ) & VoxelSector.ZVOXELBLOCMASK_X
    					//	, index & VoxelSector.ZVOXELBLOCMASK_Y
    					//	, ( index >> ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) & VoxelSector.ZVOXELBLOCMASK_Z );
    					Indexes[--n] = index;
    				} );
				start_percent = ( ++start_step * 100 ) / start_steps;


				// strong test to make sure every offset is represented once.
				// paranoid debugging.
				/*
				if( i != Voxelarium.RelativeVoxelOrds.INCENTER )
				{
					int ofs, check;
					for( ofs = 0; ofs < VoxelSector.ZVOXELBLOCKCOUNT; ofs++ )
					{
						for( check = 0; check < VoxelSector.ZVOXELBLOCKCOUNT; check++ )
						{
							if( Indexes[check] == ofs )
								break;
						}
						if( check == VoxelSector.ZVOXELBLOCKCOUNT )
							Debugger.Break();
					}
				}
				*/
			}
		}
    }

    return mesher;
}

const normals = [ THREE.Vector3Zero
        , THREE.Vector3Left
        , THREE.Vector3Right
        , THREE.Vector3Ahead
        , THREE.Vector3Behind
        , THREE.Vector3Above
        , THREE.Vector3Below ];


Voxelarium.OrderedFaces = [
    // CENTER
          null
    // LEFT 1
        , null
    // RIGHT 2
        , null
    // AHEAD 3
        , null
    // BEHIND 4
        , null
    // ABOVE 5
        , null
    // BELOW 6
        , null
    // LEFT_ABOVE  7
        , null
    // RIGHT_ABOVE 8
        , null
    // AHEAD_ABOVE 9
        , null
    // BEHIND_ABOVE  10
        , null
    // LEFT_AHEAD 11
        , null
    // RIGHT_AHEAD 12
        , null
    // LEFT_BELOW 13
        , null
    //RIGHT_BELOW //14
        , null
    //INFRONT_BELOW //15
        , null
    //BEHIND_BELOW  //16
        , null
    //LEFT_BEHIND   //17
        , null
    //BEHIND_RIGHT   //18
        , null
    // LEFT_AHEAD_ABOVE   // 19
        , [ Voxelarium.RelativeVoxelOrds.LEFT, Voxelarium.RelativeVoxelOrds.AHEAD,Voxelarium.RelativeVoxelOrds.ABOVE,Voxelarium.RelativeVoxelOrds.BELOW,Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.RIGHT ]
    // RIGHT_AHEAD_ABOVE  // 20
        , [ Voxelarium.RelativeVoxelOrds.RIGHT, Voxelarium.RelativeVoxelOrds.AHEAD, Voxelarium.RelativeVoxelOrds.ABOVE, Voxelarium.RelativeVoxelOrds.BELOW, Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.LEFT ]
    // LEFT_AHEAD_BELOW   // 21
        , [ Voxelarium.RelativeVoxelOrds.LEFT, Voxelarium.RelativeVoxelOrds.AHEAD, Voxelarium.RelativeVoxelOrds.BELOW, Voxelarium.RelativeVoxelOrds.ABOVE, Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.RIGHT ]
    // RIGHT_AHEAD_BELOW  // 22
        , [ Voxelarium.RelativeVoxelOrds.RIGHT, Voxelarium.RelativeVoxelOrds.AHEAD, Voxelarium.RelativeVoxelOrds.BELOW, Voxelarium.RelativeVoxelOrds.ABOVE, Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.LEFT ]
    // LEFT_BEHIND_ABOVE  // 23
        , [ Voxelarium.RelativeVoxelOrds.LEFT, Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.ABOVE, Voxelarium.RelativeVoxelOrds.BELOW, Voxelarium.RelativeVoxelOrds.AHEAD, Voxelarium.RelativeVoxelOrds.RIGHT ]
    // RIGHT_BEHIND_ABOVE // 24
        , [ Voxelarium.RelativeVoxelOrds.RIGHT, Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.ABOVE, Voxelarium.RelativeVoxelOrds.BELOW, Voxelarium.RelativeVoxelOrds.AHEAD, Voxelarium.RelativeVoxelOrds.LEFT ]
    // LEFT_BEHIND_BELOW  // 25
        , [ Voxelarium.RelativeVoxelOrds.LEFT, Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.BELOW, Voxelarium.RelativeVoxelOrds.ABOVE, Voxelarium.RelativeVoxelOrds.AHEAD, Voxelarium.RelativeVoxelOrds.RIGHT ]
    // RIGHT_BEHIND_BELOW // 26
        , [ Voxelarium.RelativeVoxelOrds.RIGHT, Voxelarium.RelativeVoxelOrds.BEHIND, Voxelarium.RelativeVoxelOrds.BELOW, Voxelarium.RelativeVoxelOrds.ABOVE, Voxelarium.RelativeVoxelOrds.AHEAD, Voxelarium.RelativeVoxelOrds.LEFT ]
    ];

Voxelarium.mesher = { sorters : [] }

},{"./voxels.js":68}],47:[function(require,module,exports){

require( "./packedboolarray.js" )
Voxelarium.ModificationTracker = function(size) {
    return {
        lastCycle : -1,
        cycle : 0,
        modified : Voxelarium.PackedBoolArray( size ),
        clear : function(){ this.lastCycle = this.cycle; modified.clear(); },
        setCycle : function(cycle) { this.cycle = cycle },
        get : function( offset ) { if( this.lastCycle != this.cycle ) return false; return this.modified.get(offset); },
        set : function( offset ) { if( this.lastCycle != this.cycle ) this.clear();  this.modified.set(offset); }
    }
}

},{"./packedboolarray.js":48}],48:[function(require,module,exports){


//FastBit_Array_32k


Voxelarium.PackedBoolArray = function ( size ){
    if( !size )
        size = 32*32*32;
    var pba = {
        _bits : new ArrayBuffer( Math.floor( ( size + 31 ) /32 ) * 4 ),
        bits : null,
        get : function( bit ) { return ( this.bits[bit>>5] & 1 << ( bit & 0x1f ) ) !== 0; },
        set : function( bit ) { this.bits[bit>>5] |= 1 << ( bit & 0x1f ); },
        clear : function( bit ) { this.bits[bit>>5] &= ~(1 << ( bit & 0x1f )) },
        clearAll : function() { for( var n = 0; n < bits.length; n++) bits[n] = 0; }
    };
    pba.bits = new Uint32Array( pba._bits );
    return pba;

}

},{}],49:[function(require,module,exports){

Voxelarium.Reactor = function( world ) {
    var reactor = {
     StepOne : true,
     CycleNum : 0,
     world: world,

    processSectors : function ( world, LastLoopTime )
    {
        var x, y, z;

        var LowActivityTrigger;

        //Log.log( "Begin Reaction Processing" );
        var Sectors_processed = 0;
        var Voxels_Processed = 0;

        reactor.cycle++;

        if( !reactor.stepOne ) return;

        world.sectors.forEach( (Sector)=>{

            Sectors_processed++;

            LowActivityTrigger = Sector.Flag_IsActiveLowRefresh
                && ( ( ( CycleNum ) & Sector.LowRefresh_Mask ) == 0 );
            Sector.ModifTracker.SetActualCycleNum( CycleNum );
            if( Sector.Flag_IsActiveVoxels | LowActivityTrigger )
            {
                for( x = 0; x <= 6; x++ )
                {
                    if( Sector.near_sectors[x] != null )
                        Sector.near_sectors[x].ModifTracker.SetActualCycleNum( CycleNum );
                }

                var Extension = Sector.data.otherInfos;
                var VoxelP = Sector.data.data;

                var zofs, xofs;
                var IsActiveVoxels = false;
                MainOffset = 0;
                var RSx = Sector.Pos_x * Sector.size_x;
                var RSy = Sector.Pos_y * Sector.size_y;
                var RSz = Sector.Pos_z * Sector.size_z;
                var vref = {
                    world : world,
                    sector : Sector,
                }
                var sleep = Sector.data.sleepState;
                Sector.data.data.forEach( (voxel, MainOfset)=>{
                    if( sleep.get( MainOffset ) )
                        return;

                    vref.VoxelExtension = Extension[MainOffset];
                    vref.Type = VoxelP[MainOffset]
                    if( vref.Type.properties.Is_Active )
                    {

                        if( !Sector.ModifTracker.Get( MainOffset ) ) // If voxel is already processed, don't process it once more in the same cycle.
                        {
                            Voxels_Processed++;
                            vref.wx = RSx + ( vref.x = x );
                            vref.wy = RSy + ( vref.y = y );
                            vref.wz = RSz + ( vref.z = z );
                            vref.offset = MainOffset;
                            Sector.ModifTracker.Set(SecondaryOffset[i]);
                            try
                            {
                                if( vref.Type.React( vref, LastLoopTime ) )
                                    IsActiveVoxels = true;
                                else
                                    vref.Sector.data.sleepState.set( vref.offset );

                            }
                            catch( err )
                            {
                                console.log( "Voxel Reaction Exception : ", err );
                            }
                        }
                    }
                    else
                        sleep.set( MainOffset );
                    Sector.Flag_IsActiveVoxels = IsActiveVoxels;
                })
            }
        })
        //StepOne = false;
        //Log.log( "Finish Reaction Processing {0} {1} ", Sectors_processed, Voxels_Processed );
    }

    }
    return reactor;
}

},{}],50:[function(require,module,exports){
"use strict";

require( "./packedboolarray.js")
require( "./modtracker.js")



Voxelarium.Sector = function( cluster, x, y, z ) {

	var newSector = {
        next : null,
		pred : null,

		GlobalList_Next : null,
		GlobalList_Pred : null,

		near_sectors : new Array(27), // can index with relativeOrds-1 (self is not in this array)

		handle_x : 0, handle_y:0, handle_z : 0, // used in Genesis templates; 'origin' of this sector
		pos : new THREE.Vector3( x, y, z ),

		// Version control : Added for handling better world evolution.
		ZoneType : 0,     // The type of the zone.
		ZoneVersion : 0,  // The version of the generator used for this zone.
		GeneratorVersion : 0, // Main generator version. Updated at world change.
		RingNum : 0,

		cluster : cluster,

		data : { data : new Array( cluster.sectorSize )
				, sleepState : Voxelarium.PackedBoolArray( cluster.sectorSize )
            	, otherInfos : []
							, FaceCulling : null
            	},
		ModifTracker : Voxelarium.ModificationTracker( cluster.sectorSize ),

        mesher : null,

		THREE_solid : null,
        solid_geometry : null,
		transparent_geometry: null,
		custom_geometry: null,
		cachedString : null,

		enableGeometry : function() {
			this.solid_geometry = Voxelarium.GeometryBuffer();
			this.transparent_geometry = Voxelarium.GeometryBuffer();
			//this.custom_geometry = Voxelarium.GeometryBuffer();
		},

		getOffset : function( x, y, z ) {
			return cluster.lookupTables.ofTableX[x+1] + cluster.lookupTables.ofTableY[y+1] + cluster.lookupTables.ofTableZ[z+1];

			var offset;
			offset = ( y % this.cluster.sectorSizeY )
				+ ( ( x % this.cluster.sectorSizeX ) * this.cluster.sectorSizeY )
				+ ( ( z % this.cluster.sectorSizeZ ) * ( this.cluster.sectorSizeY * this.cluster.sectorSizeX ) );
			return offset;
		},

		setCube : function( x, y, z, CubeValue ) {
			var offset = this.getOffset( x, y, z );
			this.data.data[offset] = CubeValue;

			if( CubeValue && CubeValue.extension )
				this.data.otherInfos[offset] = CubeValue.extension();
			else
				this.data.otherInfos[offset] = null;
			this.Flag_Render_Dirty = true;
		},

		getCube : function( x, y, z ) {
			var offset = getOffset( x, y, z );
			return ( newSector.data.data[Offset] );
		},

		MakeSector : function( type ) {
			var x, y, z;
			var Cnt;
			if( type ) Cnt = type;
			else if( this.Pos_y < 0 ) { Cnt = Voxelarium.Voxels.types[0]; this.Flag_Void_Regular = false; this.Flag_Void_Transparent = true; }
			else { Cnt = null; this.Flag_Void_Regular = true; this.Flag_Void_Transparent = true; }
			for( z = 0; z < this.cluster.sectorSizeX; z++ )
			{
				for( y = 0; y < this.cluster.sectorSizeY; y++ )
				{
					for( x = 0; x < this.cluster.sectorSizeZ; x++ )
					{
						newSector.setCube( x, y, z, Cnt );
					}
				}
			}
		},

		getVoxelRef : function(x,y,z) {
			if( x < 0 ) x += this.cluster.sectorSizeX;
			if( y < 0 ) y += this.cluster.sectorSizeY;
			if( z < 0 ) z += this.cluster.sectorSizeZ;
			 return makeVoxelRef( this.cluster, this, x, y, z ); },

		stringify : function() {
			var v = v|| VoxelCompressor();
			var data = v.CompressVoxelData( this.data.data );
			var n = 0;
			var string = "";
			//var sv = new StringView( data.data );
			//var testString = sv.toString();
			//var testString2 = '\u0008\u0000\u0000\u0001\u0002\u0033\u00ef'
			for( n = 0; n < data.bytes_used; n++ ) {
				var val = data.data[n];
				if( !val )
					string += "\\0";
				else {
					var out = String.fromCodePoint( val );
					if( out === "\\" )
						string += "\\/";
					else if( out === "/" )
						string += "\\|";
					else
						string += out;
				}
			}

			var array = new ArrayBuffer(string.length);
			var escape = false;
			var out = 0;
			for( n = 0; n < string.length; n++ )
				{ var val = string.codePointAt( n );
					if( escape ) {
						if( val === 48 )
							val = 0;
						escape = false;
					}else {
						if( val == 92 ) {
							escape = true;
							continue;
						}
					}
					array[out++] = val;
					//console.log( val )
				 };
				 //console.log( "Buffer was", data.data );
				 //console.log( "which became", string );

				 {
					 var test_out = [];
					 console.log( "decoding string just encoded to see if it's valid;if failed, debugger; will trigger")
                                         var a = JSON.stringify(string);
					 var xfer = JSON.parse( a );
					 if( xfer !== string )
					 	debugger;
					 decodeString( string, test_out );
					 if( test_out.length === data.data.length ) {
						 for( var n = 0; n < test_out.length; n++ ) {
							 if( test_out[n] !== data.data[n] )
							 	debugger;

						 }
					 }
				 }
			 this.cachedString = string;
			return string;
		},

		decode : function( string ) {
			console.log( "decode", string );
			if( string === this.cachedString )
				return; // already have this as the thing.
			this.cachedString = string;
			decodeString( string, this.data.data )
			this.Flag_Render_Dirty = true;
			this.cluster.mesher.SectorUpdateFaceCulling( this, true )
			//basicMesher.SectorUpdateFaceCulling_Partial( cluster, sector, Voxelarium.FACEDRAW_Operations.ALL, true )
			this.cluster.mesher.MakeSectorRenderingData( this );

			}



    }

function decodeString( string, into ){
	var bytes = 0;
			for( var n = 0; n < string.length; n++ ){
				if( string[n] === '\\' ) {
					continue;
				} else bytes++;
			}

			var buffer = new ArrayBuffer(bytes);
			bytes = 0;
			for( var n = 0; n < string.length; n++ ){
				if( string[n] === '\\' ) {
					if( string[n+1] === '0' )
						buffer[bytes++] = 0;
					else if( string[n+1] === '/' )
						buffer[bytes++] = '\\';
					else if( string[n+1] === '|' )
						buffer[bytes++] = '/';
					else
						throw new Error( "Invalid encoding" );
					n++;
					continue;
				}
				else
					buffer[bytes++] = string.codePointAt( n );
			}


			var v = v|| VoxelCompressor();
			var data = v.DecompressVoxelData( buffer, into );

		}


    return newSector;
}


function VoxelCompressor() {
		/*
						{
						VoxelDataCompressor vdc = new VoxelDataCompressor();
						ushort[] decompress = new ushort[32 * 32 * 32];
						byte[] data;
						int bytes;
						vdc.CompressVoxelData( Sector.Data.Data, out data, out bytes );
						Log.log( "compressed sector is {0}", bytes, 0 );
						vdc.DecompressVoxelData( data, decompress );
						{
							int n;
							for( n = 0; n < 32 * 32 * 32; n++ )
								if( decompress[n] != Sector.Data.Data[n] )
								{
									int a = 3;
								}
						}
					}

		*/

			/// <summary>
			/// Handles compressing and decompressing ushort array that is the sector content
			/// </summary>
	var vc = {

			WriteCubes : function( stream, bits, count, index )
			{
				// 1 count 2 bits = 3   vs 9
				// 1 count 3 bits = 4   vs 10
				// 1 count  4 bits  = 5     vs 11
				// 1 count  5 bits  = 6     vs 12
				// 1 count  6 bits  = 7     vs 13
				// 1 count  7 bits  = 8     vs 14

				// 2 count 2 bits = 6   vs 9
				// 2 count 3 bits = 8   vs 10
				// 2 count  4 bits  = 10    vs 11
				// 2 count  5 bits  = 12    vs 12
				// 2 count  6 bits  = 14    vs 13
				// 2 count  7 bits  = 16    vs 14

				// 3 count 2 bits = 9   vs 9
				// 3 count 3 bits = 12  vs 10
				// 3 count  4 bits  = 15    vs 11
				// 3 count  5 bits  = 18    vs 12
				// 3 count  6 bits  = 21    vs 13
				// 3 count  7 bits  = 24    vs 14


				if( ( (bits +1) * count ) <= ( 7 + bits ) )
				{
					for( var n = 0; n < count; n++ )
					{
						stream.write( 0, 1 );
						stream.write( index, bits );
					}
				}
				else
				{
					stream.write( 1, 1 );
					//Log.log( "Write count {0}", count );
					/*
					if( ( count & 0x8000 ) != 0 )
					{
						stream.Write( ( ( count >> 15 ) & 0x1F ) | 0x20, 7 );
						stream.Write( ( ( count >> 10 ) & 0x1F ) | 0x20, 7 );
						stream.Write( ( ( count >> 5 ) & 0x1F ) | 0x20, 7 );
						stream.Write( ( ( count  ) & 0x1F ), 7 );
					}
					else */
					count -= 2; // always at least 1, and then this value always starts at atleast 2; and very small delta sets can be 3, but typically 2.
					if( ( count & 0xFC00 ) != 0 )
					{
						stream.write( ( ( count >> 10 ) & 0x1F ) | 0x20, 6 );
						stream.write( ( ( count >> 5 ) & 0x1F ) | 0x20, 6 );
						stream.write( ( ( count ) & 0x1F ), 6 );
					}
					else if( ( count & 0xFFE0 ) != 0 )
					{
						stream.write( ( ( count >> 5 ) & 0x1F ) | 0x20, 6 );
						stream.write( ( ( count ) & 0x1F ) , 6 );
					}
					else
					{
						stream.write( ( ( count ) & 0x1F ), 6 );
					}
					//stream.Write( count, 16 );
					stream.write( index, bits );
				}

			},

			CompressVoxelData : function( data )
			{
				var stream = Voxelarium.BitStream();
				var len = data.length;
				var n;
				var types = [];

				for( n = 0; n < len; n++ )
				{
					var vox = Voxelarium.Voxels.getIndex( data[n] )
					if( types.findIndex( (v) => v===vox ) < 0 )
						types.push( vox );
				}

				var bits = Voxelarium.BitStream.GetMinBitsNeededForValue( types.length - 1 ); // 4 is 0,1,2,3; needs only 2 bits...
				//bits = (bits + 7 ) & 0xf8;
				stream.seek( 16 ); // seek bit count
				stream.write( bits, 8 );
				stream.write( types.length-1, bits );
				types.forEach( (type)=>{
					stream.write( type, 16 ); } );
				var prior_cube = 0xFFFF, cube;
				var index = 0;
				var count = 0;
	            for( n = 0; n < len; n++ )
				{
					var cube = Voxelarium.Voxels.getIndex( data[n] )
					if( prior_cube != cube )
					{
						if( count > 0 )
							vc.WriteCubes( stream, bits, count, index );
						index = types.findIndex( (v)=>(v=== cube ) );
						prior_cube = cube;
						count = 1;
					}
					else
						count++;
				}
				vc.WriteCubes( stream, bits, count, index );

				var result = stream.getBytes();
				result.data[0] = (( result.bytes_used ) & 0xFF);
				result.data[1] = ( ( result.bytes_used ) >> 8);
				// already compressed as can be.
				if( result.bytes_used < 20 )
					return result;

				/* can gzip the stream at this point too and save 10-20% more */
				/*
				MemoryStream final_stream = new MemoryStream();
				final_stream.Seek( 2, SeekOrigin.Begin );
				//DeflateStream gz_stream = new DeflateStream( final_stream, CompressionMode.Compress );
				//GZipStream gz_stream = new GZipStream( final_stream, CompressionMode.Compress );
				GZipStream gz_stream = new GZipStream( final_stream, CompressionLevel.Fastest );
				//for( n = 2; n < bytes_used; n++ )
				//	gz_stream.WriteByte( result[n] );
				gz_stream.Write( result, 2, bytes_used - 2 );
				gz_stream.Close();
				result = final_stream.ToArray();//.GetBuffer();
				Log.log( "Compressed another {0}%", (float)( 100.0f * (float)( bytes_used - result.Length ) / ( bytes_used - 2 ) ) );
				// store old length so we know how much to request decompressing.
				result[0] = (byte)( ( bytes_used ) & 0xFF );
				result[1] = (byte)( ( bytes_used ) >> 8 );
				bytes_used = result.Length;// (int)final_stream.Length;
				gz_stream.Dispose();
				*/
				return result;
			},

			DecompressVoxelData : function(  data, result )
			{
				var stream;
				var DataBytes;
				{
					stream = Voxelarium.BitStream( data );
					stream.seek( 16 ); // seek by bit position
				}
				var types = [];

				var bits;
				var TypeCount;
				bits = stream.read( 8);
				TypeCount = stream.read( bits );
				TypeCount++; // always at least one.
				var n;
				for( n = 0; n < TypeCount; n++ )
				{
					var val;
					val = stream.read( 16 );
					var assertVal;
					assertVal = Voxelarium.Voxels.types[val];
					if( assertVal )
						types.push( assertVal );
					else
						types.push( Voxelarium.Voxels.Void );
				}

				var outpos = 0;
				do
				{
					var vox;
					var val;
					var count;
					val = stream.read( 1 );
					if( val == 0 )
					{
						val = stream.read( bits );
						vox = types[val];
						if( !vox ) debugger;
						result[outpos++] = vox;
					}
					else
					{
						var count_tmp;
						count_tmp = stream.read( 6  );
						count = count_tmp & 0x1F;
						if( ( count_tmp & 0x20 ) != 0 )
						{
							count <<= 5;
							count_tmp = stream.read( 6 );
							count |= count_tmp & 0x1F;
							if( ( count_tmp & 0x20 ) != 0 )
							{
								count <<= 5;
								count_tmp = stream.read( 6 );
								count |= count_tmp & 0x1F;
							}
						}
						count += 2;
						//stream.Read( 16, out count );
						//Log.log( "Read count {0}", count );
						val = stream.read( bits );
						vox = types[val];
						if( !vox ) {
							vox = types[0];
							debugger;
						}
						//console.log( "Set vox to ", vox )
						for( n = 0; n < count; n++ )
							result[outpos++] = vox;
					}
				} while( outpos < result.length );

			}

		}
	return vc;
}

function NearVoxelRef() {
	var result = {
	 sector:this,
	 voxelType:null,
	 offset:0,
	 voxelExtension:null
 	}
	result.voxelType = this.data.data[result.offset];
	result.voxelExtension = this.data.otherInfos[result.offset];
	 return result;
}

function VoxelRef( x, y, z ) {
}

var refPool = [];

Voxelarium.VoxelRef = makeVoxelRef


function makeVoxelRef( cluster, sector, x, y, z )
{
	var result;
	result = refPool.pop();
	if( !result ) {
		result = { sector : sector
				, offset : 0
				, x : x, y : y, z : z
			 	, wx : sector?(sector.pos.x * cluster.sectorSizeX + x):x
				, wy : sector?(sector.pos.y * cluster.sectorSizeY + y):y
				, wz : sector?(sector.pos.z * cluster.sectorSizeZ + z):z
				, voxelType : null
				, cluster : cluster
				, voxelExtension : null
				, forEach : forEach
				, delete : function() { refPool.push( this ); }
				, clone : function() { return this.sector.getVoxelRef( this.x, this.y, this.z ) }
				, getNearVoxel : GetVoxelRef
				 }
		Object.seal( result );
	}
	else {
		result.sector = sector;
		result.offset = 0;
		result.x = x;
		result.y = y;
		result.z = z;
		result.wx = sector?(sector.pos.x * cluster.sectorSizeX + x):x
		result.wy = sector?(sector.pos.y * cluster.sectorSizeY + y):y
		result.wz = sector?(sector.pos.z * cluster.sectorSizeZ + z):z
		result.voxelType = null;
		result.cluster = cluster;
		result.voxelExtension = null;
	}
    if( sector ) {
		// wx coords will still be accurate even if the sub-range and origin sector move now.
		if( result.x < 0 ) { result.x += cluster.sectorSizeX; result.sector = ( result.sector && result.sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT] || result.sector ) }
		if( result.y < 0 ) { result.y += cluster.sectorSizeY; result.sector = ( result.sector && result.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW] || result.sector ) }
		if( result.z < 0 ) { result.z += cluster.sectorSizeZ; result.sector = ( result.sector && result.sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD] || result.sector ) }
		if( result.x >= cluster.sectorSizeX ) { result.x -= cluster.sectorSizeX; result.sector = ( result.sector && result.sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT] || result.sector ) }
		if( result.y >= cluster.sectorSizeY ) { result.y += cluster.sectorSizeY; result.sector = ( result.sector && result.sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE] || result.sector ) }
		if( result.z >= cluster.sectorSizeZ ) { result.z += cluster.sectorSizeZ; result.sector = ( result.sector && result.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND] || result.sector ) }

		result.offset = ( result.x * cluster.sectorSizeY )  + result.y + ( result.z * ( cluster.sectorSizeY * cluster.sectorSizeX ) );
		  result.voxelType = sector.data.data[result.offset]
		  if( !result.voxelType )
		  	return null;
		  result.voxelExtension = sector.data.otherInfos[result.offset];
    }
	return result;
}

	function forEach( voxelRef2, not_zero, callback )
	{
		var voxelRef1 = this;
		//if( voxelRef1.sector == null || voxelRef2.sector == null )
		//	return not_zero ? 1 : 0;
		if( voxelRef1.cluster !== voxelRef2.cluster )
			return not_zero ? 1 : 0;
		var cluster = voxelRef1.cluster;

		var v1x = voxelRef1.wx;
		var v1y = voxelRef1.wy;
		var v1z = voxelRef1.wz;
		var v2x = voxelRef2.wx;
		var v2y = voxelRef2.wy;
		var v2z = voxelRef2.wz;
		var del_x = v2x - v1x;
		var del_y = v2y - v1y;
		var del_z = v2z - v1z;
		var abs_x = del_x < 0 ? -del_x : del_x;
		var abs_y = del_y < 0 ? -del_y : del_y;
		var abs_z = del_z < 0 ? -del_z : del_z;
		// cannot use iterate if either end is undefined.
		if( del_x != 0 )
		{
			if( del_y != 0 )
			{
				if( del_z != 0 )
				{
					if( abs_x > abs_y || ( abs_z > abs_y ) )
					{
						if( abs_z > abs_x )
						{
							// z is longest path
							var erry = -abs_z / 2;
							var errx = -abs_z / 2;
							var incy = del_y < 0 ? -1 : 1;
							var incx = del_x < 0 ? -1 : 1;
							var incz = del_z < 0 ? -1 : 1;
							{
								var x = v1x;
								var y = v1y;
								for( var z = v1z + incz; z != v2z; z += incz )
								{
									errx += abs_x;
									if( errx > 0 )
									{
										errx -= abs_z;
										x += incx;
									}
									erry += abs_y;
									if( erry > 0 )
									{
										erry -= abs_z;
										y += incy;
									}
									{
										let v = cluster.getVoxelRef( false, x, y, z );
										if( v ) {
											let val = callback( v );
											if( val !== v ) v.delete();
											if( ( !not_zero && val ) || ( not_zero && !val ) )
												return val;
										}
									}
								}
							}
						}
						else
						{
							// x is longest.
							var erry = -abs_x / 2;
							var errz = -abs_x / 2;
							var incy = del_y < 0 ? -1 : 1;
							var incx = del_x < 0 ? -1 : 1;
							var incz = del_z < 0 ? -1 : 1;
							{
								var y = v1y;
								var z = v1z;
								for( var x = v1x + incx; x != v2x; x += incx )
								{
									errz += abs_z;
									if( errz > 0 )
									{
										errz -= abs_x;
										z += incz;
									}
									erry += abs_y;
									if( erry > 0 )
									{
										erry -= abs_x;
										y += incy;
									}
									{
										let v = cluster.getVoxelRef( false, x, y, z );
										if( v ) {
											let val = callback( v );
											if( val !== v ) v.delete();
											if( ( !not_zero && val ) || ( not_zero && !val ) )
												return val;
										}
									}
								}
							}
						}
					}
					else
					{
						// y is longest.
						var errx = -abs_y / 2;
						var errz = -abs_y / 2;
						var incy = del_y < 0 ? -1 : 1;
						var incx = del_x < 0 ? -1 : 1;
						var incz = del_z < 0 ? -1 : 1;
						{
							var x = v1x;
							var z = v1z;
							for( var y = v1y + incy; y != v2y; y += incy )
							{
								errx += abs_x;
								if( errx > 0 )
								{
									errx -= abs_y;
									x += incx;
								}
								errz += abs_z;
								if( errz > 0 )
								{
									errz -= abs_y;
									z += incz;
								}
								{
									let v = cluster.getVoxelRef( false, x, y, z );
									if( v ) {
										let val = callback( v );
										if( val !== v ) v.delete();
										if( ( !not_zero && val ) || ( not_zero && !val ) )
											return val;
									}
								}
							}
						}
					}
				}
				else
				{
					// z is constant
					if( abs_x > abs_y )
					{
						// x is longest
						var erry = -abs_x / 2;
						var incy = del_y < 0 ? -1 : 1;
						var incx = del_x < 0 ? -1 : 1;
						{
							var y = v1y;
							var z = v1z;
							for( var x = v1x + incx; x != v2x; x += incx )
							{
								erry += abs_y;
								if( erry > 0 )
								{
									erry -= abs_x;
									y += incy;
								}
								{
									let v = cluster.getVoxelRef( false, x, y, z );
									if( v ) {
										let val = callback( v );
										if( val !== v ) v.delete();
										if( ( !not_zero && val ) || ( not_zero && !val ) )
											return val;
									}
								}
							}
						}
					}
					else
					{
						// y is longest.
						var errx = -abs_y / 2;
						var incy = del_y < 0 ? -1 : 1;
						var incx = del_x < 0 ? -1 : 1;
						{
							var x = v1x;
							var z = v1z;
							for( var y = v1y + incy; y != v2y; y += incy )
							{
								errx += abs_x;
								if( errx > 0 )
								{
									errx -= abs_y;
									x += incx;
								}
								{
									let v = cluster.getVoxelRef( false, x, y, z );
									if( v ) {
										let val = callback( v );
										if( val !== v ) v.delete();
										if( ( !not_zero && val ) || ( not_zero && !val ) )
											return val;
									}
								}
							}
						}
					}
				}
			}
			else
			{
				if( del_z != 0 )
				{
					if( abs_x > abs_z )
					{
						// x is longest.
						var errz = -abs_x / 2;
						var incx = del_x < 0 ? -1 : 1;
						var incz = del_z < 0 ? -1 : 1;
						{
							var y = v1y;
							var z = v1z;
							for( var x = v1x + incx; x != v2x; x += incx )
							{
								errz += abs_z;
								if( errz > 0 )
								{
									errz -= abs_x;
									z += incz;
								}
								{
									let v = cluster.getVoxelRef( false, x, y, z );
									if( v ) {
										let val = callback( v );
										if( val !== v ) v.delete();
										if( ( !not_zero && val ) || ( not_zero && !val ) )
											return val;
									}
								}
							}
						}
					}
					else
					{
						// z is longest path
						var errx = -abs_z / 2;
						var incx = del_x < 0 ? -1 : 1;
						var incz = del_z < 0 ? -1 : 1;
						{
							var x = v1x;
							var y = v1y;
							for( var z = v1z + incz; z != v2z; z += incz )
							{
								errx += abs_x;
								if( errx > 0 )
								{
									errx -= abs_z;
									x += incx;
								}
								{
									let v = cluster.getVoxelRef( false, x, y, z );
									if( v ) {
										let val = callback( v );
										if( val !== v ) v.delete();
										if( ( !not_zero && val ) || ( not_zero && !val ) )
											return val;
									}
								}
							}
						}
					}
				}
				else
				{
					// x is only changing.
					var incx = del_x < 0 ? -1 : 1;
					for( var x = v1x + incx; x != v2x; x += incx )
					{
						let v = cluster.getVoxelRef( false, x, y, z );
						if( v ) {
							let val = callback( v );
							if( val !== v ) v.delete();
							if( ( !not_zero && val ) || ( not_zero && !val ) )
								return val;
						}
					}
				}
			}
		}
		else
		{
			if( del_y != 0 )
			{
				if( del_z != 0 )
				{
					if( abs_y > abs_z )
					{
						// y is longest.
						var errz = -abs_y / 2;
						var incy = del_y < 0 ? -1 : 1;
						var incz = del_z < 0 ? -1 : 1;
						{
							var x = v1x;
							var z = v1z;
							for( var y = v1y + incy; y != v2y; y += incy )
							{
								errz += abs_z;
								if( errz > 0 )
								{
									errz -= abs_y;
									z += incz;
								}
								{
									let v = cluster.getVoxelRef( false, x, y, z );
									if( v ) {
										let val = callback( v );
										if( val !== v ) v.delete();
										if( ( !not_zero && val ) || ( not_zero && !val ) )
											return val;
									}
								}
							}
						}
					}
					else
					{
						// z is longest path
						var erry = -abs_z / 2;
						var incy = del_y < 0 ? -1 : 1;
						var incz = del_z < 0 ? -1 : 1;
						{
							var x = v1x;
							var y = v1y;
							for( var z = v1z + incz; z != v2z; z += incz )
							{
								erry += abs_y;
								if( erry > 0 )
								{
									erry -= abs_z;
									y += incy;
								}
								{
									let v = cluster.getVoxelRef( false, x, y, z );
									if( v ) {
										let val = callback( v );
										if( val !== v ) v.delete();
										if( ( !not_zero && val ) || ( not_zero && !val ) )
											return val;
									}
								}
							}
						}
					}
				}
				else
				{
					// no del_x, no del_z
					// y is only changing.
					var incy = del_y < 0 ? -1 : 1;
					for( var y = v1y + incy; y != v2y; y += incy )
					{
						let v = cluster.getVoxelRef( false, x, y, z );
						if( v ) {
							let val = callback( v );
							if( val !== v ) v.delete();
							if( ( !not_zero && val ) || ( not_zero && !val ) )
								return val;
						}
					}
				}
			}
			else
			{
				// no del_x, no del_y...
				if( del_z != 0 )
				{
					if( del_z > 0 )
						for( var z = v1z + 1; z < v2z; z++ )
						{
							let v = cluster.getVoxelRef( false, x, y, z );
							if( v ) {
								let val = callback( v );
								if( val !== v ) v.delete();
								if( ( !not_zero && val ) || ( not_zero && !val ) )
									return val;
							}
						}
					else
						for( var z = v2z + 1; z < v1z; z++ )
						{
							let v = cluster.getVoxelRef( false, x, y, z );
							if( v ) {
								let val = callback( v );
								if( val !== v ) v.delete();
								if( ( !not_zero && val ) || ( not_zero && !val ) )
									return val;
							}
						}

				}
				else
				{
					// no delta diff, nothing to do.
				}
			}
		}
		return not_zero ? 1 : 0;
	}

	function GetVoxelRefs( nearOnly )
	{
		var result = {
			ResultSectors : new Array(nearOnly ? 7 : 19),
			ResultOffsets : new Array(nearOnly ? 7 : 19)
		}
		GetVoxelRefs( ResultSectors, ResultOffsets, nearOnly );
	}

	function GetVoxelRef( direction )
	{
		that = this.clone();
		switch( direction )
		{
		default:
			throw new Error( "Creating voxel ref " + direction + " is not implemented " );
			break;
		case Voxelarium.RelativeVoxelOrds.LEFT:
			that.wx--;
			if( that.x > 0 )
			{
				that.x--;
				that.Offset -= that.sector.Size_y;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.x = (byte)( that.sector.Size_x - 1 );
					that.Offset += that.sector.Size_y * ( that.sector.Size_x - 2 );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.RIGHT:
			that.wx++;
			if( that.x < (that.sector.Size_x-1 ) )
			{
				that.x++;
				that.Offset += that.sector.Size_y;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.x = 0;
					that.Offset -= that.sector.Size_y * ( that.sector.Size_x - 2 );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.BEHIND:
			that.wz--;
			if( that.z > 0 )
			{
				that.z--;
				that.Offset -= that.sector.Size_y*that.sector.Size_x;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.z = (byte)( that.sector.Size_z - 1 );
					that.Offset += ( that.sector.Size_x * that.sector.Size_y * ( that.sector.Size_z - 2 ) );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.AHEAD:
			that.wz++;
			if( that.z < ( that.sector.Size_z - 1 ) )
			{
				that.z++;
				that.Offset += that.sector.Size_y*that.sector.Size_x;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.z = 0;
					that.Offset -= ( that.sector.Size_x * that.sector.Size_y * ( that.sector.Size_z - 2 ) );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.BELOW:
			that.wy--;
			if( that.y > 0 )
			{
				that.y--;
				that.Offset--;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.y = (byte)( that.sector.Size_y - 1 );
					that.Offset += ( that.sector.Size_y - 2 );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.ABOVE:
			that.wy++;
			if( that.y < ( that.sector.Size_y - 1 ) )
			{
				that.y++;
				that.Offset++;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.y = 0;
					that.Offset -= ( that.sector.Size_y - 2 );
				}
			}
			break;
		}
		if( that.sector != null )
		{
			that.Type = that.sector.data.data[that.offset];
			that.VoxelExtension = that.sector.data.otherInfos[that.offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
		return that;
	}

	function GetNearVoxelRef( direction )
	{
		var that = GetNearVoxelRef( )
		var cluster = this.sector.cluster;
		that.sector = this.sector;
		that.Offset = this.Offset;
		switch( direction )
		{
		default:
			throw new NotImplementedException( "Creating voxel ref " + direction + " is not implemented " );
			break;
		case Voxelarium.RelativeVoxelOrds.LEFT:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != 0 )
				that.Offset -= that.sector.Size_y;
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
					that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
			}
			break;
		case Voxelarium.RelativeVoxelOrds.RIGHT:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y )
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y;
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
					that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
			}
			break;
		case Voxelarium.RelativeVoxelOrds.BEHIND:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != 0 )
				that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
			}
			break;
		case Voxelarium.RelativeVoxelOrds.AHEAD:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) )
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
			}
			break;
		case Voxelarium.RelativeVoxelOrds.BELOW:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != 0 )
				that.Offset--;
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
			}
			break;
		case Voxelarium.RelativeVoxelOrds.ABOVE:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != VoxelSector.ZVOXELBLOCMASK_Y )
				that.Offset++;
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
			}
			break;
		}
		if( that.sector != null )
		{
			that.Type = self.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}


	function GetNearLeftVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != 0 )
				that.Offset -= that.sector.Size_y;
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
				if( that.sector != null )
					that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
			}
		if( that.sector != null )
		{
			that.Type = self.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearRightVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y )
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y;
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
				if( that.sector != null )
					that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
			}
		if( that.sector != null )
		{
			that.Type = self.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearAheadVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) )
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1];
				if( that.sector != null )
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
			}
		if( that.sector != null )
		{
			that.Type = self.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearBehindVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != 0 )
				that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
				if( that.sector != null )
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
			}
		if( that.sector != null )
		{
			that.Type = self.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearAboveVoxelRef( that,  self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != VoxelSector.ZVOXELBLOCMASK_Y )
				that.Offset++;
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
				if( that.sector != null )
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
			}
		if( that.sector != null )
		{
			that.Type = self.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearBelowVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != 0 )
				that.Offset--;
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
				if( that.sector != null )
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
			}
		if( that.sector != null )
		{
			that.Type = self.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}



	function GetNearVoxelRef( that,  self, direction )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
		switch( direction )
		{
		default:
			throw new NotImplementedException( "Creating voxel ref " + direction + " is not implemented " );
			break;
		case Voxelarium.RelativeVoxelOrds.LEFT:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != 0 )
			{
				that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.RIGHT:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y )
			{
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.BEHIND:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != 0 )
			{
				that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.AHEAD:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) )
			{
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.BELOW:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != 0 )
			{
				that.Offset--;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
				}
			}
			break;
		case Voxelarium.RelativeVoxelOrds.ABOVE:
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != VoxelSector.ZVOXELBLOCMASK_Y )
			{
				that.Offset++;
			}
			else
			{
				that.sector = self.sector.near_sectors[direction - 1];
				if( that.sector != null )
				{
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
				}
			}
			break;
		}
		if( that.sector != null )
		{
			that.Type = self.sector.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearLeftVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != 0 )
			{
				that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y;
			}
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
				if( that.sector != null )
				{
					that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
				}
			}
		if( that.sector != null )
		{
			that.Type = self.sector.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearRightVoxelRef( that,self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y ) ) != VoxelSector.ZVOXELBLOCMASK_X << VoxelSector.ZVOXELBLOCSHIFT_Y )
			{
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y;
			}
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
				if( that.sector != null )
				{
					that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_X - 2 );
				}
			}
		if( that.sector != null )
		{
			that.Type = self.sector.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearAheadVoxelRef( that,self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) )
			{
				that.Offset += VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			}
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1];
				if( that.sector != null )
				{
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
				}
			}
		if( that.sector != null )
		{
			that.Type = self.sector.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearBehindVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) ) ) != 0 )
			{
				that.Offset -= VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			}
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
				if( that.sector != null )
				{
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_X * VoxelSector.ZVOXELBLOCSIZE_Y * ( VoxelSector.ZVOXELBLOCSIZE_Z - 2 ) );
				}
			}
		if( that.sector != null )
		{
			that.Type = self.sector.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearAboveVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != VoxelSector.ZVOXELBLOCMASK_Y )
			{
				that.Offset++;
			}
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
				if( that.sector != null )
				{
					that.Offset -= ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
				}
			}
		if( that.sector != null )
		{
			that.Type = self.sector.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetNearBelowVoxelRef( that, self )
	{
		that.sector = self.sector;
		that.Offset = self.Offset;
			if( ( that.Offset & ( VoxelSector.ZVOXELBLOCMASK_Y ) ) != 0 )
			{
				that.Offset--;
			}
			else
			{
				that.sector = self.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
				if( that.sector != null )
				{
					that.Offset += ( VoxelSector.ZVOXELBLOCSIZE_Y - 2 );
				}
			}
		if( that.sector != null )
		{
			that.Type = self.sector.VoxelTypeManager.VoxelTable[that.sector.Data.Data[that.Offset]];
			that.VoxelExtension = that.sector.Data.OtherInfos[that.Offset];
		}
		else
		{
			that.Type = null;
			that.VoxelExtension = null;
		}
	}

	function GetVoxelRefs( nearOnly )
	{
		if( nearOnly )
		{
			var result = new array(7);
			//result[0] = this;
			GetNearVoxelRef(  result[Voxelarium.RelativeVoxelOrds.LEFT]   , this, Voxelarium.RelativeVoxelOrds.LEFT );
			GetNearVoxelRef(  result[Voxelarium.RelativeVoxelOrds.RIGHT]  , this, Voxelarium.RelativeVoxelOrds.RIGHT );
			GetNearVoxelRef(  result[Voxelarium.RelativeVoxelOrds.AHEAD]  , this, Voxelarium.RelativeVoxelOrds.AHEAD );
			GetNearVoxelRef(  result[Voxelarium.RelativeVoxelOrds.BEHIND] , this, Voxelarium.RelativeVoxelOrds.BEHIND );
			GetNearVoxelRef(  result[Voxelarium.RelativeVoxelOrds.ABOVE]  , this, Voxelarium.RelativeVoxelOrds.ABOVE );
			GetNearVoxelRef(  result[Voxelarium.RelativeVoxelOrds.BELOW]  , this, Voxelarium.RelativeVoxelOrds.BELOW );
		}
		else
		{
			var result = new VoxelRef[27];
		}
		return result;

	}

	function GetVoxelRefs( ResultSectors,  ResultOffsets,  nearOnly )
	{
		//ResultSectors = new VoxelSector[nearOnly ? 7 : 19];
		//ResultOffsets = new uint[nearOnly ? 7 : 19];

		ResultSectors[Voxelarium.RelativeVoxelOrds.INCENTER] = this.sector;
		var origin = this.Offset.clonse();//( this.x <<VoxelSector.ZVOXELBLOCSHIFT_Y ) + this.y + ( this.z << (VoxelSector.ZVOXELBLOCSHIFT_X +VoxelSector.ZVOXELBLOCSHIFT_Y ) );
		{
			var input = VoxelSector.RelativeVoxelOffsets_Unwrapped;
			var n;
			var idx = 0;
			ResultOffsets[idx] = origin + input[idx]; idx++;
			ResultOffsets[idx] = origin + input[idx]; idx++; //1
			ResultOffsets[idx] = origin + input[idx]; idx++; //2
			ResultOffsets[idx] = origin + input[idx]; idx++; //3
			ResultOffsets[idx] = origin + input[idx]; idx++; //4
			ResultOffsets[idx] = origin + input[idx]; idx++; //5
			ResultOffsets[idx] = origin + input[idx]; idx++; //6
			if( !nearOnly ) for( n = 0; n < 20; n++ ) { ResultOffsets[idx] = origin + input[idx]; idx++; }

			if( this.x == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT]
						= this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1]; ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector;
				ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.LEFT - 1, 0]] += ( VoxelSector.ZVOXELBLOCSIZE_X ) * VoxelSector.ZVOXELBLOCSIZE_Y;
				if( !nearOnly ) for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.LEFT - 1, n]] += ( VoxelSector.ZVOXELBLOCSIZE_X ) * VoxelSector.ZVOXELBLOCSIZE_Y;
			}
			else if( this.x == ( VoxelSector.ZVOXELBLOCSIZE_X - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
				ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.RIGHT - 1, 0]] -= ( VoxelSector.ZVOXELBLOCSIZE_X ) * VoxelSector.ZVOXELBLOCSIZE_Y;
				if( !nearOnly ) for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.RIGHT - 1, n]] -= ( VoxelSector.ZVOXELBLOCSIZE_X ) * VoxelSector.ZVOXELBLOCSIZE_Y;
			}
			else
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector;
			}
			if( this.y == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
				ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BELOW - 1, 0]] += ( VoxelSector.ZVOXELBLOCSIZE_Y );
				if( !nearOnly ) for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BELOW - 1, n]] += ( VoxelSector.ZVOXELBLOCSIZE_Y );
			}
			else if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1]; ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
				ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.ABOVE - 1, 0]] -= ( VoxelSector.ZVOXELBLOCSIZE_Y );
				if( !nearOnly ) for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.ABOVE - 1, n]] -= ( VoxelSector.ZVOXELBLOCSIZE_Y );
			}
			else
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
			}

			if( this.z == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
				ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BEHIND - 1, 0]] += ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
				if( !nearOnly ) for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BEHIND - 1, n]] += ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			}
			else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1]; ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector;
				ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.AHEAD - 1, 0]] -= ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
				if( !nearOnly ) for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.AHEAD - 1, n]] -= ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
			}
			else
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector;
			}

			// test to make sure resulting offsets are within range.
			//for( n = 0; n < 27; n++ ) if( ResultOffsets[n] & 0xFFFF8000 ) DebugBreak();
		}
		if( nearOnly )
			return;

		if( this.x == 0 )
		{
			if( this.y == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else //----------------------------------------------
				{
					// left bound, top bound, front nobound
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector;
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector;

					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else //----------------------------------------------
			{
				// left bound, above/below unbound
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector;
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] != null ? ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1] : null;
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					// left bound, y unbound z unbound
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
		}
		else if( this.x == ( VoxelSector.ZVOXELBLOCSIZE_X - 1 ) )
		{
			if( this.y == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
		}
		else //---------------------------------------------------------
		{
			// left/right unbound... left and right should never be terms of equality
			if( this.y == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				}
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
			}
			else if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				}
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
			}
			else  //----------------------------------------------
			{
				// x not on bound, y not on bound.
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
			}
		}
	}

	// result set is only 9 (3x3 face)
	function GetVoxelRefs(  ResultSectors,  ResultOffsets, faceOnly )
	{
		var result = {
			ResultSectors : new Array(27),
			ResultOffsets : new Array(27)
		}

		ResultSectors[Voxelarium.RelativeVoxelOrds.INCENTER] = this.sector;
		var origin = ( this.x << VoxelSector.ZVOXELBLOCSHIFT_Y ) + this.y + ( this.z << ( VoxelSector.ZVOXELBLOCSHIFT_X + VoxelSector.ZVOXELBLOCSHIFT_Y ) );
		{
			var input = VoxelSector.RelativeVoxelOffsets_Unwrapped;
			var n;
			for( n = 0; n < 9; n++ )
				ResultOffsets[n] = (uint)(origin + VoxelSector.RelativeVoxelOffsets_Unwrapped[VoxelSector.VoxelFaceGroups[faceOnly, n]]);

			switch( faceOnly )
			{
				case Voxelarium.RelativeVoxelOrds.LEFT:
					if( this.x == 0 )
					{
						for( n = 0; n < 9; n++ )
						{
							ResultSectors[n] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1]; ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector;
							ResultOffsets[n] += ( VoxelSector.ZVOXELBLOCSIZE_X ) * VoxelSector.ZVOXELBLOCSIZE_Y;
						}
					}
					else
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector;
					}
					break;
				case Voxelarium.RelativeVoxelOrds.RIGHT:
					if( this.x == ( VoxelSector.ZVOXELBLOCSIZE_X - 1 ) )
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
						for( n = 0; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.RIGHT - 1, n]] -= ( VoxelSector.ZVOXELBLOCSIZE_X ) * VoxelSector.ZVOXELBLOCSIZE_Y;
					}
					else
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT] = this.sector;
					}
					break;
				case Voxelarium.RelativeVoxelOrds.ABOVE:
					if( this.y == 0 )
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
						ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BELOW - 1, 0]] += ( VoxelSector.ZVOXELBLOCSIZE_Y );
						for( n = 0; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BELOW - 1, n]] += ( VoxelSector.ZVOXELBLOCSIZE_Y );
					}
					else
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
					}
					break;
				case Voxelarium.RelativeVoxelOrds.BELOW:
					if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1]; ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
						ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.ABOVE - 1, 0]] -= ( VoxelSector.ZVOXELBLOCSIZE_Y );
						for( n = 0; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.ABOVE - 1, n]] -= ( VoxelSector.ZVOXELBLOCSIZE_Y );
					}
					else
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
					}
					break;
				case Voxelarium.RelativeVoxelOrds.BEHIND:
					if( this.z == 0 )
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
						ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BEHIND - 1, 0]] += ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
						for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.BEHIND - 1, n]] += ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
					}
					else
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector;
					}
					break;
				case Voxelarium.RelativeVoxelOrds.AHEAD:
					if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1]; ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector;
						ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.AHEAD - 1, 0]] -= ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
						for( n = 1; n < 9; n++ ) ResultOffsets[VoxelSector.VoxelFaceGroups[Voxelarium.RelativeVoxelOrds.AHEAD - 1, n]] -= ( VoxelSector.ZVOXELBLOCSIZE_Z ) * VoxelSector.ZVOXELBLOCSIZE_Y * VoxelSector.ZVOXELBLOCSIZE_X;
					}
					else
					{
						ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector; ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector;
					}
					break;
			}
			// test to make sure resulting offsets are within range.
			//for( n = 0; n < 27; n++ ) if( ResultOffsets[n] & 0xFFFF8000 ) DebugBreak();
		}


		if( this.x == 0 )
		{
			if( this.y == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else //----------------------------------------------
				{
					// left bound, top bound, front nobound
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD] = this.sector;
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND] = this.sector;

					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else //----------------------------------------------
			{
				// left bound, above/below unbound
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector;
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.LEFT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					// left bound, y unbound z unbound
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
		}
		else if( this.x == ( VoxelSector.ZVOXELBLOCSIZE_X - 1 ) )
		{
			if( this.y == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.BELOW - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE] = this.sector.near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW] = this.sector;
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.ABOVE - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
			else
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD].near_sectors[Voxelarium.RelativeVoxelOrds.RIGHT - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW];
				}
			}
		}
		else //---------------------------------------------------------
		{
			// left/right unbound... left and right should never be terms of equality
			if( this.y == 0 )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW].near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				}
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
			}
			else if( this.y == ( VoxelSector.ZVOXELBLOCSIZE_Y - 1 ) )
			{
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				if( this.z == 0 )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.BEHIND - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];

				}
				else if( this.z == ( VoxelSector.ZVOXELBLOCSIZE_Z - 1 ) )
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE].near_sectors[Voxelarium.RelativeVoxelOrds.AHEAD - 1];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				}
				else
				{
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
					ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW];
				}
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND];
			}
			else  //----------------------------------------------
			{
				// x not on bound, y not on bound.
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW] = ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT];

				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_LEFT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND_RIGHT] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];

				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_AHEAD] = ResultSectors[Voxelarium.RelativeVoxelOrds.AHEAD];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.LEFT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_ABOVE_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
				ResultSectors[Voxelarium.RelativeVoxelOrds.RIGHT_BELOW_BEHIND] = ResultSectors[Voxelarium.RelativeVoxelOrds.BEHIND];
			}
		}
	}

},{"./modtracker.js":47,"./packedboolarray.js":48}],51:[function(require,module,exports){


Voxelarium.SortingTree = function(Capacity){
    var sorter = {
		/// <summary>
		/// storage type for Sorting Tree
		/// </summary>

		storage : [],
		root : -1,
		used : 0,
        autoBalance : false,
        clear : function() { this.root = -1; this.used = 0; },
        add : Add,
        balance : Balance,
        forEach : foreach
    };

	storage = [];
    for( var n = 0; n < Capacit; n++ )
        storage.push( { key : 0, value : null,
                 lesser : 0, greater : 0, parent : 0, children : 0
            } );

    return sorter;
}

function DumpTree( current, level ) {
	if( current == -1 ) {
		if( root == -1 )
			return;
		console.log( "Start Tree Dump" );
		DumpTree( root, level + 1 );
	} else {
		if( this.storage[current].lesser != -1 ) {
			DumpTree( this.storage[current].lesser, level + 1 );
		}
		console.log( "Cur: " + current + " Par: " + this.storage[current].parent
			+ " Les: " + this.storage[current].lesser
			+ " Grt: " + this.storage[current].greater
			+ " Lev: " + level + " cld: " + this.storage[current].children + "  Key: " + this.storage[current].key + " val: " + this.storage[current].value );
		if( this.storage[current].greater != -1 ) {
			DumpTree( this.storage[current].greater, level + 1 );
		}
	}
}


function RotateLeft( node, node_id )
{
	if( node.parent == -1 )
	{
		root = node.greater;
		this.storage[root].parent = -1;
	}
	else
	{
		if( this.storage[node.parent].lesser == node_id )
			this.storage[node.parent].lesser = node.greater;
		else
			this.storage[node.parent].greater = node.greater;
		this.storage[node.greater].parent = node.parent;
	}
	node.children -= ( this.storage[node.greater].children + 1 );
	node.parent = node.greater;
	var temp = this.storage[node.greater].lesser;
	node.greater = temp;
	this.storage[node.parent].lesser = node_id;
	if( temp >= 0 )
	{
		this.storage[temp].parent = node_id;
		this.storage[node.parent].children -= ( this.storage[temp].children + 1 );
		node.children += ( this.storage[temp].children + 1 );
	}
	this.storage[node.parent].children += ( node.children + 1 );
}

function RotateRight( node, node_id )
{
	if( node.parent == -1 )
	{
		root = node.lesser;
		this.storage[root].parent = -1;
	}
	else
	{
		if( this.storage[node.parent].lesser == node_id )
			this.storage[node.parent].lesser = node.lesser;
		else
			this.storage[node.parent].greater = node.lesser;
		this.storage[node.lesser].parent = node.parent;
	}
	node.children -= ( this.storage[node.lesser].children + 1 );
	node.parent = node.lesser;
	var temp = this.storage[node.lesser].greater;
	node.lesser = temp;
	this.storage[node.parent].greater = node_id;  // actually oldnode.lesser
	if( temp >= 0 )
	{
		this.storage[temp].parent = node_id;
		this.storage[node.parent].children -= ( this.storage[temp].children + 1 );
		node.children += ( this.storage[temp].children + 1 );
	}
	this.storage[node.parent].children += ( node.children + 1 );
}

function Balance( node, node_id )
{
	if( !this.AutoBalance ) return;
    var left_children = node.lesser == -1 ? 0 : ( this.storage[node.lesser].children + 1 );
	var right_children = node.greater == -1 ? 0 : ( this.storage[node.greater].children + 1 );
	if( left_children == 0 )
	{
		if( right_children > 1 )
            RotateLeft( node, node_id );
	}
	else if( right_children == 0 )
	{
		if( left_children > 1 )
		{
			RotateRight( node, node_id );
		}
	}
	else if( right_children > ( left_children * 3 ) )
	{
		RotateLeft( node, node_id );
		Balance( storage[node.lesser], node.lesser );
	}
	else if( left_children > ( right_children * 3 ) )
	{
		RotateRight( node, node_id );
		Balance( storage[node.greater], node.greater );
	}
}

function addNode( node,  parent_id, K,  V ) {
	node.key = K;
	node.value = V;
	node.lesser = -1;
	node.greater = -1;
	node.parent = parent_id;
	node.children = 0;
}


function ScanAdd( node, node_id, K, V )
{
	if( K < node.key )
	{
		if( node.lesser == -1 )
		{
			node.children++;
			this.addNode( storage[used], node_id, K, V );
			node.lesser = used;
			used++;
		}
		else
		{
			node.children++;
			ScanAdd( storage[node.lesser], node.lesser, K, V );
			Balance( node, node_id );
		}
	}
	else if( K >= node.key )
	{
		if( node.greater == -1 )
		{
			node.children++;
			this.addNode( storage[used], node_id, K, V );
			node.greater = used;
			used++;
		}
		else
		{
			node.children++;
			ScanAdd( storage[node.greater], node.greater, K, V );
			Balance( node, node_id );
		}
	}
}

function Add( K, V )
{
	if( root == -1 )
	{
		root = 0;
		this.addNode( this.storage[root], -1, K, V );
		used++;
	}
	else
		ScanAdd( this.storage[root], root, K, V );
}


function foreach( callback ) {
    var current = -1;

	var next;
    while( true ) {
		if( current == -1 )
		{
			current = Tree.root;
			if( current == -1 )
				return false;
			while( ( next = Tree.storage[current].lesser ) != -1 )
				current = next;
            callback( this.storage[current].value );
            continue;
		}
		else if( ( next = Tree.storage[current].greater ) != -1 )
		{
			current = next;
			while( ( next = Tree.storage[current].lesser ) != -1 )
				current = next;
            callback( this.storage[current].value );
            continue;
		}

		else while( ( next = Tree.storage[current].parent ) != -1 )
		{
			// came from lesser, so this is next larger.
			if( Tree.storage[next].lesser == current )
			{
				current = next;
                callback( this.storage[current].value );
                continue;
			}
			else
				current = next;
		}
        break;
    }
}

},{}],52:[function(require,module,exports){
"use strict";

Voxelarium.TextureAtlas = {
    texture : null,
    texture_count : 0,
    texture_size : 0,
    renderTarget : null,
    canvas : null,
    context : null,
    texture : null,
    x_ofs : 0,
    y_ofs : 0,
    init : function( count, size ) {
        this.texture_count = count;
        this.texture_size = size;
        this.canvas = document.createElement('canvas');
        this.canvas.width = 2048;
        this.canvas.height = 2048;
    	this.context = this.canvas.getContext('2d');
        this.context.fillStyle="clear";
        this.context.fillRect(0,0,2048,2048);
        //this.context.clearRect(20,20,100,50);
        this.texture = new THREE.Texture(this.canvas)
        this.texture.magFilter = THREE.NearestFilter;
        this.texture.minFilter = THREE.NearestFilter;
    	//this.texture.needsUpdate = true;

    },
    add : function( image )
   {
       var coords = {
           uvs : new Array(8),
           uv_array : null,
           coord : { position : { x : 0, y : 0 }, size : {x : 0,y:0 } }
       }
       if( this.y_ofs >= 32 )
       {
           for(  var n = 0; n < 8; n++ )
               uvs[n] = 0;
           coords.coord.position.x = 0;
           coords.coord.position.y = 0;
           coords.coord.size.x = 0;
           coords.coord.size.y = 0;
           return coords;
       }
       var scalar = 1.0 / ( this.texture_count);
       //Log.log( "output texture to atlas... {0} {1}", x_ofs, y_ofs );
       coords.coord.position.x = ( scalar ) * this.x_ofs;
       coords.coord.position.y = ( scalar ) * this.y_ofs;
       coords.coord.size.x = ( scalar );
       coords.coord.size.y = ( scalar );

       coords.uvs[0 * 2 + 0] = ( scalar ) * this.x_ofs;
       coords.uvs[0 * 2 + 1] = 1-(( scalar ) * this.y_ofs);
       coords.uvs[1 * 2 + 0] = coords.uvs[0 * 2 + 0] + ( scalar );
       coords.uvs[1 * 2 + 1] = coords.uvs[0 * 2 + 1];
       coords.uvs[2 * 2 + 0] = coords.uvs[0 * 2 + 0];
       coords.uvs[2 * 2 + 1] = (coords.uvs[0 * 2 + 1] - ( scalar ));
       coords.uvs[3 * 2 + 0] = coords.uvs[1 * 2 + 0];
       coords.uvs[3 * 2 + 1] = coords.uvs[2 * 2 + 1];

       var in_uvs = coords.uvs;
       coords.uv_array = [in_uvs[1*2+0]
                   ,in_uvs[1*2+1]
                   ,in_uvs[0*2+0]
                   ,in_uvs[0*2+1]
                   ,in_uvs[3*2+0]
                   ,in_uvs[3*2+1]
                   ,in_uvs[2*2+0]
                   ,in_uvs[2*2+1]
               ];


       this.context.drawImage( image, this.texture_size * this.x_ofs, this.texture_size * this.y_ofs, this.texture_size, this.texture_size )

       this.texture.needsUpdate = true;

       this.x_ofs++;
       if( this.x_ofs == this.texture_count )
       {
           this.x_ofs = 0;
           this.y_ofs++;
       }
       return coords;
   }
}

},{}],53:[function(require,module,exports){
/**
 * @author mrdoob / http://mrdoob.com/
 * @author supereggbert / http://www.paulbrunt.co.uk/
 * @author julianwa / https://github.com/julianwa
 */

THREE.RenderableObject = function () {

	this.id = 0;

	this.object = null;
	this.z = 0;
	this.renderOrder = 0;

};

//

THREE.RenderableFace = function () {

	this.id = 0;

	this.v1 = new THREE.RenderableVertex();
	this.v2 = new THREE.RenderableVertex();
	this.v3 = new THREE.RenderableVertex();

	this.normalModel = new THREE.Vector3();

	this.vertexNormalsModel = [ new THREE.Vector3(), new THREE.Vector3(), new THREE.Vector3() ];
	this.vertexNormalsLength = 0;

	this.color = new THREE.Color();
	this.material = null;
	this.uvs = [ new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() ];

	this.z = 0;
	this.renderOrder = 0;

};

//

THREE.RenderableVertex = function () {

	this.position = new THREE.Vector3();
	this.positionWorld = new THREE.Vector3();
	this.positionScreen = new THREE.Vector4();

	this.visible = true;

};

THREE.RenderableVertex.prototype.copy = function ( vertex ) {

	this.positionWorld.copy( vertex.positionWorld );
	this.positionScreen.copy( vertex.positionScreen );

};

//

THREE.RenderableLine = function () {

	this.id = 0;

	this.v1 = new THREE.RenderableVertex();
	this.v2 = new THREE.RenderableVertex();

	this.vertexColors = [ new THREE.Color(), new THREE.Color() ];
	this.material = null;

	this.z = 0;
	this.renderOrder = 0;

};

//

THREE.RenderableSprite = function () {

	this.id = 0;

	this.object = null;

	this.x = 0;
	this.y = 0;
	this.z = 0;

	this.rotation = 0;
	this.scale = new THREE.Vector2();

	this.material = null;
	this.renderOrder = 0;

};

//

THREE.Projector = function () {

	var _object, _objectCount, _objectPool = [], _objectPoolLength = 0,
	_vertex, _vertexCount, _vertexPool = [], _vertexPoolLength = 0,
	_face, _faceCount, _facePool = [], _facePoolLength = 0,
	_line, _lineCount, _linePool = [], _linePoolLength = 0,
	_sprite, _spriteCount, _spritePool = [], _spritePoolLength = 0,

	_renderData = { objects: [], lights: [], elements: [] },

	_vector3 = new THREE.Vector3(),
	_vector4 = new THREE.Vector4(),

	_clipBox = new THREE.Box3( new THREE.Vector3( - 1, - 1, - 1 ), new THREE.Vector3( 1, 1, 1 ) ),
	_boundingBox = new THREE.Box3(),
	_points3 = new Array( 3 ),
	_points4 = new Array( 4 ),

	_viewMatrix = new THREE.Matrix4(),
	_viewProjectionMatrix = new THREE.Matrix4(),

	_modelMatrix,
	_modelViewProjectionMatrix = new THREE.Matrix4(),

	_normalMatrix = new THREE.Matrix3(),

	_frustum = new THREE.Frustum(),

	_clippedVertex1PositionScreen = new THREE.Vector4(),
	_clippedVertex2PositionScreen = new THREE.Vector4();

	//

	this.projectVector = function ( vector, camera ) {

		console.warn( 'THREE.Projector: .projectVector() is now vector.project().' );
		vector.project( camera );

	};

	this.unprojectVector = function ( vector, camera ) {

		console.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );
		vector.unproject( camera );

	};

	this.pickingRay = function ( vector, camera ) {

		console.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );

	};

	//

	var RenderList = function () {

		var normals = [];
		var uvs = [];

		var object = null;
		var material = null;

		var normalMatrix = new THREE.Matrix3();

		function setObject( value ) {

			object = value;
			material = object.material;

			normalMatrix.getNormalMatrix( object.matrixWorld );

			normals.length = 0;
			uvs.length = 0;

		}

		function projectVertex( vertex ) {

			var position = vertex.position;
			var positionWorld = vertex.positionWorld;
			var positionScreen = vertex.positionScreen;

			positionWorld.copy( position ).applyMatrix4( _modelMatrix );
			positionScreen.copy( positionWorld ).applyMatrix4( _viewProjectionMatrix );

			var invW = 1 / positionScreen.w;

			positionScreen.x *= invW;
			positionScreen.y *= invW;
			positionScreen.z *= invW;

			vertex.visible = positionScreen.x >= - 1 && positionScreen.x <= 1 &&
					 positionScreen.y >= - 1 && positionScreen.y <= 1 &&
					 positionScreen.z >= - 1 && positionScreen.z <= 1;

		}

		function pushVertex( x, y, z ) {

			_vertex = getNextVertexInPool();
			_vertex.position.set( x, y, z );

			projectVertex( _vertex );

		}

		function pushNormal( x, y, z ) {

			normals.push( x, y, z );

		}

		function pushUv( x, y ) {

			uvs.push( x, y );

		}

		function checkTriangleVisibility( v1, v2, v3 ) {

			if ( v1.visible === true || v2.visible === true || v3.visible === true ) return true;

			_points3[ 0 ] = v1.positionScreen;
			_points3[ 1 ] = v2.positionScreen;
			_points3[ 2 ] = v3.positionScreen;

			return _clipBox.intersectsBox( _boundingBox.setFromPoints( _points3 ) );

		}

		function checkBackfaceCulling( v1, v2, v3 ) {

			return ( ( v3.positionScreen.x - v1.positionScreen.x ) *
				    ( v2.positionScreen.y - v1.positionScreen.y ) -
				    ( v3.positionScreen.y - v1.positionScreen.y ) *
				    ( v2.positionScreen.x - v1.positionScreen.x ) ) < 0;

		}

		function pushLine( a, b ) {

			var v1 = _vertexPool[ a ];
			var v2 = _vertexPool[ b ];

			_line = getNextLineInPool();

			_line.id = object.id;
			_line.v1.copy( v1 );
			_line.v2.copy( v2 );
			_line.z = ( v1.positionScreen.z + v2.positionScreen.z ) / 2;
			_line.renderOrder = object.renderOrder;

			_line.material = object.material;

			_renderData.elements.push( _line );

		}

		function pushTriangle( a, b, c ) {

			var v1 = _vertexPool[ a ];
			var v2 = _vertexPool[ b ];
			var v3 = _vertexPool[ c ];

			if ( checkTriangleVisibility( v1, v2, v3 ) === false ) return;

			if ( material.side === THREE.DoubleSide || checkBackfaceCulling( v1, v2, v3 ) === true ) {

				_face = getNextFaceInPool();

				_face.id = object.id;
				_face.v1.copy( v1 );
				_face.v2.copy( v2 );
				_face.v3.copy( v3 );
				_face.z = ( v1.positionScreen.z + v2.positionScreen.z + v3.positionScreen.z ) / 3;
				_face.renderOrder = object.renderOrder;

				// use first vertex normal as face normal

				_face.normalModel.fromArray( normals, a * 3 );
				_face.normalModel.applyMatrix3( normalMatrix ).normalize();

				for ( var i = 0; i < 3; i ++ ) {

					var normal = _face.vertexNormalsModel[ i ];
					normal.fromArray( normals, arguments[ i ] * 3 );
					normal.applyMatrix3( normalMatrix ).normalize();

					var uv = _face.uvs[ i ];
					uv.fromArray( uvs, arguments[ i ] * 2 );

				}

				_face.vertexNormalsLength = 3;

				_face.material = object.material;

				_renderData.elements.push( _face );

			}

		}

		return {
			setObject: setObject,
			projectVertex: projectVertex,
			checkTriangleVisibility: checkTriangleVisibility,
			checkBackfaceCulling: checkBackfaceCulling,
			pushVertex: pushVertex,
			pushNormal: pushNormal,
			pushUv: pushUv,
			pushLine: pushLine,
			pushTriangle: pushTriangle
		}

	};

	var renderList = new RenderList();

	this.projectScene = function ( scene, camera, sortObjects, sortElements ) {

		_faceCount = 0;
		_lineCount = 0;
		_spriteCount = 0;

		_renderData.elements.length = 0;

		if ( scene.autoUpdate === true ) scene.updateMatrixWorld();
		if ( camera.parent === null ) camera.updateMatrixWorld();

		_viewMatrix.copy( camera.matrixWorldInverse.getInverse( camera.matrixWorld ) );
		_viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, _viewMatrix );

		_frustum.setFromMatrix( _viewProjectionMatrix );

		//

		_objectCount = 0;

		_renderData.objects.length = 0;
		_renderData.lights.length = 0;

		function addObject( object ) {

			_object = getNextObjectInPool();
			_object.id = object.id;
			_object.object = object;

			_vector3.setFromMatrixPosition( object.matrixWorld );
			_vector3.applyProjection( _viewProjectionMatrix );
			_object.z = _vector3.z;
			_object.renderOrder = object.renderOrder;

			_renderData.objects.push( _object );

		}

		scene.traverseVisible( function ( object ) {

			if ( object instanceof THREE.Light ) {

				_renderData.lights.push( object );

			} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line ) {

				if ( object.material.visible === false ) return;
				if ( object.frustumCulled === true && _frustum.intersectsObject( object ) === false ) return;

				addObject( object );

			} else if ( object instanceof THREE.Sprite ) {

				if ( object.material.visible === false ) return;
				if ( object.frustumCulled === true && _frustum.intersectsSprite( object ) === false ) return;

				addObject( object );

			}

		} );

		if ( sortObjects === true ) {

			_renderData.objects.sort( painterSort );

		}

		//

		for ( var o = 0, ol = _renderData.objects.length; o < ol; o ++ ) {

			var object = _renderData.objects[ o ].object;
			var geometry = object.geometry;

			renderList.setObject( object );

			_modelMatrix = object.matrixWorld;

			_vertexCount = 0;

			if ( object instanceof THREE.Mesh ) {

				if ( geometry instanceof THREE.BufferGeometry ) {

					var attributes = geometry.attributes;
					var groups = geometry.groups;

					if ( attributes.position === undefined ) continue;

					var positions = attributes.position.array;

					for ( var i = 0, l = positions.length; i < l; i += 3 ) {

						renderList.pushVertex( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );

					}

					if ( attributes.normal !== undefined ) {

						var normals = attributes.normal.array;

						for ( var i = 0, l = normals.length; i < l; i += 3 ) {

							renderList.pushNormal( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] );

						}

					}

					if ( attributes.uv !== undefined ) {

						var uvs = attributes.uv.array;

						for ( var i = 0, l = uvs.length; i < l; i += 2 ) {

							renderList.pushUv( uvs[ i ], uvs[ i + 1 ] );

						}

					}

					if ( geometry.index !== null ) {

						var indices = geometry.index.array;

						if ( groups.length > 0 ) {

							for ( var o = 0; o < groups.length; o ++ ) {

								var group = groups[ o ];

								for ( var i = group.start, l = group.start + group.count; i < l; i += 3 ) {

									renderList.pushTriangle( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );

								}

							}

						} else {

							for ( var i = 0, l = indices.length; i < l; i += 3 ) {

								renderList.pushTriangle( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );

							}

						}

					} else {

						for ( var i = 0, l = positions.length / 3; i < l; i += 3 ) {

							renderList.pushTriangle( i, i + 1, i + 2 );

						}

					}

				} else if ( geometry instanceof THREE.Geometry ) {

					var vertices = geometry.vertices;
					var faces = geometry.faces;
					var faceVertexUvs = geometry.faceVertexUvs[ 0 ];

					_normalMatrix.getNormalMatrix( _modelMatrix );

					var material = object.material;

					var isFaceMaterial = material instanceof THREE.MultiMaterial;
					var objectMaterials = isFaceMaterial === true ? object.material : null;

					for ( var v = 0, vl = vertices.length; v < vl; v ++ ) {

						var vertex = vertices[ v ];

						_vector3.copy( vertex );

						if ( material.morphTargets === true ) {

							var morphTargets = geometry.morphTargets;
							var morphInfluences = object.morphTargetInfluences;

							for ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {

								var influence = morphInfluences[ t ];

								if ( influence === 0 ) continue;

								var target = morphTargets[ t ];
								var targetVertex = target.vertices[ v ];

								_vector3.x += ( targetVertex.x - vertex.x ) * influence;
								_vector3.y += ( targetVertex.y - vertex.y ) * influence;
								_vector3.z += ( targetVertex.z - vertex.z ) * influence;

							}

						}

						renderList.pushVertex( _vector3.x, _vector3.y, _vector3.z );

					}

					for ( var f = 0, fl = faces.length; f < fl; f ++ ) {

						var face = faces[ f ];

						material = isFaceMaterial === true
							 ? objectMaterials.materials[ face.materialIndex ]
							 : object.material;

						if ( material === undefined ) continue;

						var side = material.side;

						var v1 = _vertexPool[ face.a ];
						var v2 = _vertexPool[ face.b ];
						var v3 = _vertexPool[ face.c ];

						if ( renderList.checkTriangleVisibility( v1, v2, v3 ) === false ) continue;

						var visible = renderList.checkBackfaceCulling( v1, v2, v3 );

						if ( side !== THREE.DoubleSide ) {

							if ( side === THREE.FrontSide && visible === false ) continue;
							if ( side === THREE.BackSide && visible === true ) continue;

						}

						_face = getNextFaceInPool();

						_face.id = object.id;
						_face.v1.copy( v1 );
						_face.v2.copy( v2 );
						_face.v3.copy( v3 );

						_face.normalModel.copy( face.normal );

						if ( visible === false && ( side === THREE.BackSide || side === THREE.DoubleSide ) ) {

							_face.normalModel.negate();

						}

						_face.normalModel.applyMatrix3( _normalMatrix ).normalize();

						var faceVertexNormals = face.vertexNormals;

						for ( var n = 0, nl = Math.min( faceVertexNormals.length, 3 ); n < nl; n ++ ) {

							var normalModel = _face.vertexNormalsModel[ n ];
							normalModel.copy( faceVertexNormals[ n ] );

							if ( visible === false && ( side === THREE.BackSide || side === THREE.DoubleSide ) ) {

								normalModel.negate();

							}

							normalModel.applyMatrix3( _normalMatrix ).normalize();

						}

						_face.vertexNormalsLength = faceVertexNormals.length;

						var vertexUvs = faceVertexUvs[ f ];

						if ( vertexUvs !== undefined ) {

							for ( var u = 0; u < 3; u ++ ) {

								_face.uvs[ u ].copy( vertexUvs[ u ] );

							}

						}

						_face.color = face.color;
						_face.material = material;

						_face.z = ( v1.positionScreen.z + v2.positionScreen.z + v3.positionScreen.z ) / 3;
						_face.renderOrder = object.renderOrder;

						_renderData.elements.push( _face );

					}

				}

			} else if ( object instanceof THREE.Line ) {

				if ( geometry instanceof THREE.BufferGeometry ) {

					var attributes = geometry.attributes;

					if ( attributes.position !== undefined ) {

						var positions = attributes.position.array;

						for ( var i = 0, l = positions.length; i < l; i += 3 ) {

							renderList.pushVertex( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );

						}

						if ( geometry.index !== null ) {

							var indices = geometry.index.array;

							for ( var i = 0, l = indices.length; i < l; i += 2 ) {

								renderList.pushLine( indices[ i ], indices[ i + 1 ] );

							}

						} else {

							var step = object instanceof THREE.LineSegments ? 2 : 1;

							for ( var i = 0, l = ( positions.length / 3 ) - 1; i < l; i += step ) {

								renderList.pushLine( i, i + 1 );

							}

						}

					}

				} else if ( geometry instanceof THREE.Geometry ) {

					_modelViewProjectionMatrix.multiplyMatrices( _viewProjectionMatrix, _modelMatrix );

					var vertices = object.geometry.vertices;

					if ( vertices.length === 0 ) continue;

					v1 = getNextVertexInPool();
					v1.positionScreen.copy( vertices[ 0 ] ).applyMatrix4( _modelViewProjectionMatrix );

					var step = object instanceof THREE.LineSegments ? 2 : 1;

					for ( var v = 1, vl = vertices.length; v < vl; v ++ ) {

						v1 = getNextVertexInPool();
						v1.positionScreen.copy( vertices[ v ] ).applyMatrix4( _modelViewProjectionMatrix );

						if ( ( v + 1 ) % step > 0 ) continue;

						v2 = _vertexPool[ _vertexCount - 2 ];

						_clippedVertex1PositionScreen.copy( v1.positionScreen );
						_clippedVertex2PositionScreen.copy( v2.positionScreen );

						if ( clipLine( _clippedVertex1PositionScreen, _clippedVertex2PositionScreen ) === true ) {

							// Perform the perspective divide
							_clippedVertex1PositionScreen.multiplyScalar( 1 / _clippedVertex1PositionScreen.w );
							_clippedVertex2PositionScreen.multiplyScalar( 1 / _clippedVertex2PositionScreen.w );

							_line = getNextLineInPool();

							_line.id = object.id;
							_line.v1.positionScreen.copy( _clippedVertex1PositionScreen );
							_line.v2.positionScreen.copy( _clippedVertex2PositionScreen );

							_line.z = Math.max( _clippedVertex1PositionScreen.z, _clippedVertex2PositionScreen.z );
							_line.renderOrder = object.renderOrder;

							_line.material = object.material;

							if ( object.material.vertexColors === THREE.VertexColors ) {

								_line.vertexColors[ 0 ].copy( object.geometry.colors[ v ] );
								_line.vertexColors[ 1 ].copy( object.geometry.colors[ v - 1 ] );

							}

							_renderData.elements.push( _line );

						}

					}

				}

			} else if ( object instanceof THREE.Sprite ) {

				_vector4.set( _modelMatrix.elements[ 12 ], _modelMatrix.elements[ 13 ], _modelMatrix.elements[ 14 ], 1 );
				_vector4.applyMatrix4( _viewProjectionMatrix );

				var invW = 1 / _vector4.w;

				_vector4.z *= invW;

				if ( _vector4.z >= - 1 && _vector4.z <= 1 ) {

					_sprite = getNextSpriteInPool();
					_sprite.id = object.id;
					_sprite.x = _vector4.x * invW;
					_sprite.y = _vector4.y * invW;
					_sprite.z = _vector4.z;
					_sprite.renderOrder = object.renderOrder;
					_sprite.object = object;

					_sprite.rotation = object.rotation;

					_sprite.scale.x = object.scale.x * Math.abs( _sprite.x - ( _vector4.x + camera.projectionMatrix.elements[ 0 ] ) / ( _vector4.w + camera.projectionMatrix.elements[ 12 ] ) );
					_sprite.scale.y = object.scale.y * Math.abs( _sprite.y - ( _vector4.y + camera.projectionMatrix.elements[ 5 ] ) / ( _vector4.w + camera.projectionMatrix.elements[ 13 ] ) );

					_sprite.material = object.material;

					_renderData.elements.push( _sprite );

				}

			}

		}

		if ( sortElements === true ) {

			_renderData.elements.sort( painterSort );

		}

		return _renderData;

	};

	// Pools

	function getNextObjectInPool() {

		if ( _objectCount === _objectPoolLength ) {

			var object = new THREE.RenderableObject();
			_objectPool.push( object );
			_objectPoolLength ++;
			_objectCount ++;
			return object;

		}

		return _objectPool[ _objectCount ++ ];

	}

	function getNextVertexInPool() {

		if ( _vertexCount === _vertexPoolLength ) {

			var vertex = new THREE.RenderableVertex();
			_vertexPool.push( vertex );
			_vertexPoolLength ++;
			_vertexCount ++;
			return vertex;

		}

		return _vertexPool[ _vertexCount ++ ];

	}

	function getNextFaceInPool() {

		if ( _faceCount === _facePoolLength ) {

			var face = new THREE.RenderableFace();
			_facePool.push( face );
			_facePoolLength ++;
			_faceCount ++;
			return face;

		}

		return _facePool[ _faceCount ++ ];


	}

	function getNextLineInPool() {

		if ( _lineCount === _linePoolLength ) {

			var line = new THREE.RenderableLine();
			_linePool.push( line );
			_linePoolLength ++;
			_lineCount ++;
			return line;

		}

		return _linePool[ _lineCount ++ ];

	}

	function getNextSpriteInPool() {

		if ( _spriteCount === _spritePoolLength ) {

			var sprite = new THREE.RenderableSprite();
			_spritePool.push( sprite );
			_spritePoolLength ++;
			_spriteCount ++;
			return sprite;

		}

		return _spritePool[ _spriteCount ++ ];

	}

	//

	function painterSort( a, b ) {

		if ( a.renderOrder !== b.renderOrder ) {

			return a.renderOrder - b.renderOrder;

		} else if ( a.z !== b.z ) {

			return b.z - a.z;

		} else if ( a.id !== b.id ) {

			return a.id - b.id;

		} else {

			return 0;

		}

	}

	function clipLine( s1, s2 ) {

		var alpha1 = 0, alpha2 = 1,

		// Calculate the boundary coordinate of each vertex for the near and far clip planes,
		// Z = -1 and Z = +1, respectively.
		bc1near =  s1.z + s1.w,
		bc2near =  s2.z + s2.w,
		bc1far =  - s1.z + s1.w,
		bc2far =  - s2.z + s2.w;

		if ( bc1near >= 0 && bc2near >= 0 && bc1far >= 0 && bc2far >= 0 ) {

			// Both vertices lie entirely within all clip planes.
			return true;

		} else if ( ( bc1near < 0 && bc2near < 0 ) || ( bc1far < 0 && bc2far < 0 ) ) {

			// Both vertices lie entirely outside one of the clip planes.
			return false;

		} else {

			// The line segment spans at least one clip plane.

			if ( bc1near < 0 ) {

				// v1 lies outside the near plane, v2 inside
				alpha1 = Math.max( alpha1, bc1near / ( bc1near - bc2near ) );

			} else if ( bc2near < 0 ) {

				// v2 lies outside the near plane, v1 inside
				alpha2 = Math.min( alpha2, bc1near / ( bc1near - bc2near ) );

			}

			if ( bc1far < 0 ) {

				// v1 lies outside the far plane, v2 inside
				alpha1 = Math.max( alpha1, bc1far / ( bc1far - bc2far ) );

			} else if ( bc2far < 0 ) {

				// v2 lies outside the far plane, v2 inside
				alpha2 = Math.min( alpha2, bc1far / ( bc1far - bc2far ) );

			}

			if ( alpha2 < alpha1 ) {

				// The line segment spans two boundaries, but is outside both of them.
				// (This can't happen when we're only clipping against just near/far but good
				//  to leave the check here for future usage if other clip planes are added.)
				return false;

			} else {

				// Update the s1 and s2 vertices to match the clipped line segment.
				s1.lerp( s2, alpha1 );
				s2.lerp( s1, 1 - alpha2 );

				return true;

			}

		}

	}

};

},{}],54:[function(require,module,exports){
/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.BloomPass = function ( strength, kernelSize, sigma, resolution ) {

	THREE.Pass.call( this );

	strength = ( strength !== undefined ) ? strength : 1;
	kernelSize = ( kernelSize !== undefined ) ? kernelSize : 25;
	sigma = ( sigma !== undefined ) ? sigma : 4.0;
	resolution = ( resolution !== undefined ) ? resolution : 256;

	// render targets

	var pars = { minFilter: THREE.LinearFilter, magFilter: THREE.LinearFilter, format: THREE.RGBAFormat };

	this.renderTargetX = new THREE.WebGLRenderTarget( resolution, resolution, pars );
	this.renderTargetY = new THREE.WebGLRenderTarget( resolution, resolution, pars );

	// copy material

	if ( THREE.CopyShader === undefined )
		console.error( "THREE.BloomPass relies on THREE.CopyShader" );

	var copyShader = THREE.CopyShader;

	this.copyUniforms = THREE.UniformsUtils.clone( copyShader.uniforms );

	this.copyUniforms[ "opacity" ].value = strength;

	this.materialCopy = new THREE.ShaderMaterial( {

		uniforms: this.copyUniforms,
		vertexShader: copyShader.vertexShader,
		fragmentShader: copyShader.fragmentShader,
		blending: THREE.AdditiveBlending,
		transparent: true

	} );

	// convolution material

	if ( THREE.ConvolutionShader === undefined )
		console.error( "THREE.BloomPass relies on THREE.ConvolutionShader" );

	var convolutionShader = THREE.ConvolutionShader;

	this.convolutionUniforms = THREE.UniformsUtils.clone( convolutionShader.uniforms );

	this.convolutionUniforms[ "uImageIncrement" ].value = THREE.BloomPass.blurX;
	this.convolutionUniforms[ "cKernel" ].value = THREE.ConvolutionShader.buildKernel( sigma );

	this.materialConvolution = new THREE.ShaderMaterial( {

		uniforms: this.convolutionUniforms,
		vertexShader:  convolutionShader.vertexShader,
		fragmentShader: convolutionShader.fragmentShader,
		defines: {
			"KERNEL_SIZE_FLOAT": kernelSize.toFixed( 1 ),
			"KERNEL_SIZE_INT": kernelSize.toFixed( 0 )
		}

	} );

	this.needsSwap = false;

	this.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );
	this.scene  = new THREE.Scene();

	this.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );
	this.scene.add( this.quad );

};

THREE.BloomPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.BloomPass,

	render: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		if ( maskActive ) renderer.context.disable( renderer.context.STENCIL_TEST );

		// Render quad with blured scene into texture (convolution pass 1)

		this.quad.material = this.materialConvolution;

		this.convolutionUniforms[ "tDiffuse" ].value = readBuffer.texture;
		this.convolutionUniforms[ "uImageIncrement" ].value = THREE.BloomPass.blurX;

		renderer.render( this.scene, this.camera, this.renderTargetX, true );


		// Render quad with blured scene into texture (convolution pass 2)

		this.convolutionUniforms[ "tDiffuse" ].value = this.renderTargetX.texture;
		this.convolutionUniforms[ "uImageIncrement" ].value = THREE.BloomPass.blurY;

		renderer.render( this.scene, this.camera, this.renderTargetY, true );

		// Render original scene with superimposed blur to texture

		this.quad.material = this.materialCopy;

		this.copyUniforms[ "tDiffuse" ].value = this.renderTargetY.texture;

		if ( maskActive ) renderer.context.enable( renderer.context.STENCIL_TEST );

		renderer.render( this.scene, this.camera, readBuffer, this.clear );

	}

} );

THREE.BloomPass.blurX = new THREE.Vector2( 0.001953125, 0.0 );
THREE.BloomPass.blurY = new THREE.Vector2( 0.0, 0.001953125 );

},{}],55:[function(require,module,exports){
/**
 * @author mrdoob / http://mrdoob.com/
 */

THREE.ClearPass = function ( clearColor, clearAlpha ) {

	THREE.Pass.call( this );

	this.needsSwap = false;

	this.clearColor = ( clearColor !== undefined ) ? clearColor : 0x000000;
	this.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;

};

THREE.ClearPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.ClearPass,

	render: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		var oldClearColor, oldClearAlpha;

		if ( this.clearColor ) {

			oldClearColor = renderer.getClearColor().getHex();
			oldClearAlpha = renderer.getClearAlpha();

			renderer.setClearColor( this.clearColor, this.clearAlpha );

		}

		renderer.setRenderTarget( this.renderToScreen ? null : readBuffer );
		renderer.clear();

		if ( this.clearColor ) {

			renderer.setClearColor( oldClearColor, oldClearAlpha );

		}

	}

} );

},{}],56:[function(require,module,exports){
/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.EffectComposer = function ( renderer, renderTarget ) {

	this.renderer = renderer;

	if ( renderTarget === undefined ) {

		var parameters = {
			minFilter: THREE.LinearFilter,
			magFilter: THREE.LinearFilter,
			format: THREE.RGBAFormat,
			stencilBuffer: false
		};
		var size = renderer.getSize();
		renderTarget = new THREE.WebGLRenderTarget( size.width, size.height, parameters );

	}

	this.renderTarget1 = renderTarget;
	this.renderTarget2 = renderTarget.clone();

	this.writeBuffer = this.renderTarget1;
	this.readBuffer = this.renderTarget2;

	this.passes = [];

	if ( THREE.CopyShader === undefined )
		console.error( "THREE.EffectComposer relies on THREE.CopyShader" );

	this.copyPass = new THREE.ShaderPass( THREE.CopyShader );

};

Object.assign( THREE.EffectComposer.prototype, {

	swapBuffers: function() {

		var tmp = this.readBuffer;
		this.readBuffer = this.writeBuffer;
		this.writeBuffer = tmp;

	},

	addPass: function ( pass ) {

		this.passes.push( pass );

		var size = this.renderer.getSize();
		pass.setSize( size.width, size.height );

	},

	insertPass: function ( pass, index ) {

		this.passes.splice( index, 0, pass );

	},

	render: function ( delta ) {

		var maskActive = false;

		var pass, i, il = this.passes.length;

		for ( i = 0; i < il; i ++ ) {

			pass = this.passes[ i ];

			if ( pass.enabled === false ) continue;

			pass.render( this.renderer, this.writeBuffer, this.readBuffer, delta, maskActive );

			if ( pass.needsSwap ) {

				if ( maskActive ) {

					var context = this.renderer.context;

					context.stencilFunc( context.NOTEQUAL, 1, 0xffffffff );

					this.copyPass.render( this.renderer, this.writeBuffer, this.readBuffer, delta );

					context.stencilFunc( context.EQUAL, 1, 0xffffffff );

				}

				this.swapBuffers();

			}

			if ( THREE.MaskPass !== undefined ) {

				if ( pass instanceof THREE.MaskPass ) {

					maskActive = true;

				} else if ( pass instanceof THREE.ClearMaskPass ) {

					maskActive = false;

				}

			}

		}

	},

	reset: function ( renderTarget ) {

		if ( renderTarget === undefined ) {

			var size = this.renderer.getSize();

			renderTarget = this.renderTarget1.clone();
			renderTarget.setSize( size.width, size.height );

		}

		this.renderTarget1.dispose();
		this.renderTarget2.dispose();
		this.renderTarget1 = renderTarget;
		this.renderTarget2 = renderTarget.clone();

		this.writeBuffer = this.renderTarget1;
		this.readBuffer = this.renderTarget2;

	},

	setSize: function ( width, height ) {

		this.renderTarget1.setSize( width, height );
		this.renderTarget2.setSize( width, height );

		for ( var i = 0; i < this.passes.length; i ++ ) {

			this.passes[i].setSize( width, height );

		}

	}

} );


THREE.Pass = function () {

	// if set to true, the pass is processed by the composer
	this.enabled = true;

	// if set to true, the pass indicates to swap read and write buffer after rendering
	this.needsSwap = true;

	// if set to true, the pass clears its buffer before rendering
	this.clear = false;

	// if set to true, the result of the pass is rendered to screen
	this.renderToScreen = false;

};

Object.assign( THREE.Pass.prototype, {

	setSize: function( width, height ) {},

	render: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		console.error( "THREE.Pass: .render() must be implemented in derived pass." );

	}

} );

},{}],57:[function(require,module,exports){
/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.MaskPass = function ( scene, camera ) {

	THREE.Pass.call( this );

	this.scene = scene;
	this.camera = camera;

	this.clear = true;
	this.needsSwap = false;

	this.inverse = false;

};

THREE.MaskPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.MaskPass,

	render: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		var context = renderer.context;
		var state = renderer.state;

		// don't update color or depth

		state.buffers.color.setMask( false );
		state.buffers.depth.setMask( false );

		// lock buffers

		state.buffers.color.setLocked( true );
		state.buffers.depth.setLocked( true );

		// set up stencil

		var writeValue, clearValue;

		if ( this.inverse ) {

			writeValue = 0;
			clearValue = 1;

		} else {

			writeValue = 1;
			clearValue = 0;

		}

		state.buffers.stencil.setTest( true );
		state.buffers.stencil.setOp( context.REPLACE, context.REPLACE, context.REPLACE );
		state.buffers.stencil.setFunc( context.ALWAYS, writeValue, 0xffffffff );
		state.buffers.stencil.setClear( clearValue );

		// draw into the stencil buffer

		renderer.render( this.scene, this.camera, readBuffer, this.clear );
		renderer.render( this.scene, this.camera, writeBuffer, this.clear );

		// unlock color and depth buffer for subsequent rendering

		state.buffers.color.setLocked( false );
		state.buffers.depth.setLocked( false );

		// only render where stencil is set to 1

		state.buffers.stencil.setFunc( context.EQUAL, 1, 0xffffffff );  // draw if == 1
		state.buffers.stencil.setOp( context.KEEP, context.KEEP, context.KEEP );

	}

} );


THREE.ClearMaskPass = function () {

	THREE.Pass.call( this );

	this.needsSwap = false;

};

THREE.ClearMaskPass.prototype = Object.create( THREE.Pass.prototype );

Object.assign( THREE.ClearMaskPass.prototype, {

	render: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		renderer.state.buffers.stencil.setTest( false );

	}

} );

},{}],58:[function(require,module,exports){
/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.RenderPass = function ( scene, camera, overrideMaterial, clearColor, clearAlpha ) {

	THREE.Pass.call( this );

	this.scene = scene;
	this.camera = camera;

	this.overrideMaterial = overrideMaterial;

	this.clearColor = clearColor;
	this.clearAlpha = ( clearAlpha !== undefined ) ? clearAlpha : 0;

	this.clear = true;
	this.needsSwap = false;

};

THREE.RenderPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.RenderPass,

	render: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		var oldAutoClear = renderer.autoClear;
		renderer.autoClear = false;

		this.scene.overrideMaterial = this.overrideMaterial;

		var oldClearColor, oldClearAlpha;

		if ( this.clearColor ) {

			oldClearColor = renderer.getClearColor().getHex();
			oldClearAlpha = renderer.getClearAlpha();

			renderer.setClearColor( this.clearColor, this.clearAlpha );

		}

		renderer.render( this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear );

		if ( this.clearColor ) {

			renderer.setClearColor( oldClearColor, oldClearAlpha );

		}

		this.scene.overrideMaterial = null;
		renderer.autoClear = oldAutoClear;
	}

} );

},{}],59:[function(require,module,exports){
/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.ShaderPass = function ( shader, textureID ) {

	THREE.Pass.call( this );

	this.textureID = ( textureID !== undefined ) ? textureID : "tDiffuse";

	if ( shader instanceof THREE.ShaderMaterial ) {

		this.uniforms = shader.uniforms;

		this.material = shader;

	} else if ( shader ) {

		this.uniforms = THREE.UniformsUtils.clone( shader.uniforms );

		this.material = new THREE.ShaderMaterial( {

			defines: shader.defines || {},
			uniforms: this.uniforms,
			vertexShader: shader.vertexShader,
			fragmentShader: shader.fragmentShader

		} );

	}

	this.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );
	this.scene = new THREE.Scene();

	this.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );
	this.scene.add( this.quad );

};

THREE.ShaderPass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.ShaderPass,

	render: function( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		if ( this.uniforms[ this.textureID ] ) {

			this.uniforms[ this.textureID ].value = readBuffer.texture;

		}

		this.quad.material = this.material;

		if ( this.renderToScreen ) {

			renderer.render( this.scene, this.camera );

		} else {

			renderer.render( this.scene, this.camera, writeBuffer, this.clear );

		}

	}

} );

},{}],60:[function(require,module,exports){
/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.TexturePass = function ( map, opacity ) {

	THREE.Pass.call( this );

	if ( THREE.CopyShader === undefined )
		console.error( "THREE.TexturePass relies on THREE.CopyShader" );

	var shader = THREE.CopyShader;

	this.map = map;
	this.opacity = ( opacity !== undefined ) ? opacity : 1.0;

	this.uniforms = THREE.UniformsUtils.clone( shader.uniforms );

	this.material = new THREE.ShaderMaterial( {

		uniforms: this.uniforms,
		vertexShader: shader.vertexShader,
		fragmentShader: shader.fragmentShader,
		depthTest: false,
		depthWrite: false

	} );

	this.needsSwap = false;

	this.camera = new THREE.OrthographicCamera( - 1, 1, 1, - 1, 0, 1 );
	this.scene  = new THREE.Scene();

	this.quad = new THREE.Mesh( new THREE.PlaneBufferGeometry( 2, 2 ), null );
	this.scene.add( this.quad );

};

THREE.TexturePass.prototype = Object.assign( Object.create( THREE.Pass.prototype ), {

	constructor: THREE.TexturePass,

	render: function ( renderer, writeBuffer, readBuffer, delta, maskActive ) {

		var oldAutoClear = renderer.autoClear;
		renderer.autoClear = false;

		this.quad.material = this.material;

		this.uniforms[ "opacity" ].value = this.opacity;
		this.uniforms[ "tDiffuse" ].value = this.map;
		this.material.transparent = ( this.opacity < 1.0 );

		renderer.render( this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear );

		renderer.autoClear = oldAutoClear;
	}

} );

},{}],61:[function(require,module,exports){
/**
 * @author alteredq / http://alteredqualia.com/
 *
 * Full-screen textured quad shader
 */

THREE.CopyShader = {

	uniforms: {

		"tDiffuse": { value: null },
		"opacity":  { value: 1.0 }

	},

	vertexShader: [

		"varying vec2 vUv;",

		"void main() {",

			"vUv = uv;",
			"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

		"}"

	].join( "\n" ),

	fragmentShader: [

		"uniform float opacity;",

		"uniform sampler2D tDiffuse;",

		"varying vec2 vUv;",

		"void main() {",

			"vec4 texel = texture2D( tDiffuse, vUv );",
			"gl_FragColor = opacity * texel;",

		"}"

	].join( "\n" )

};

},{}],62:[function(require,module,exports){
/**
 * @author zz85 / http://www.lab4games.net/zz85/blog
 *
 * Two pass Gaussian blur filter (horizontal and vertical blur shaders)
 * - described in http://www.gamerendering.com/2008/10/11/gaussian-blur-filter-shader/
 *   and used in http://www.cake23.de/traveling-wavefronts-lit-up.html
 *
 * - 9 samples per pass
 * - standard deviation 2.7
 * - "h" and "v" parameters should be set to "1 / width" and "1 / height"
 */

THREE.HorizontalBlurShader = {

	uniforms: {

		"tDiffuse": { value: null },
		"h":        { value: 1.0 / 512.0 }

	},

	vertexShader: [

		"varying vec2 vUv;",

		"void main() {",

			"vUv = uv;",
			"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

		"}"

	].join( "\n" ),

	fragmentShader: [

		"uniform sampler2D tDiffuse;",
		"uniform float h;",

		"varying vec2 vUv;",

		"void main() {",

			"vec4 sum = vec4( 0.0 );",

			"sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;",
			"sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;",
			"sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;",
			"sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;",
			"sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;",
			"sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;",
			"sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;",
			"sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;",

			"gl_FragColor = sum;",

		"}"

	].join( "\n" )

};

},{}],63:[function(require,module,exports){
/**
 * @author zz85 / http://www.lab4games.net/zz85/blog
 *
 * Two pass Gaussian blur filter (horizontal and vertical blur shaders)
 * - described in http://www.gamerendering.com/2008/10/11/gaussian-blur-filter-shader/
 *   and used in http://www.cake23.de/traveling-wavefronts-lit-up.html
 *
 * - 9 samples per pass
 * - standard deviation 2.7
 * - "h" and "v" parameters should be set to "1 / width" and "1 / height"
 */

THREE.VerticalBlurShader = {

	uniforms: {

		"tDiffuse": { value: null },
		"v":        { value: 1.0 / 512.0 }

	},

	vertexShader: [

		"varying vec2 vUv;",

		"void main() {",

			"vUv = uv;",
			"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

		"}"

	].join( "\n" ),

	fragmentShader: [

		"uniform sampler2D tDiffuse;",
		"uniform float v;",

		"varying vec2 vUv;",

		"void main() {",

			"vec4 sum = vec4( 0.0 );",

			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;",
			"sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;",

			"gl_FragColor = sum;",

		"}"

	].join( "\n" )

};

},{}],64:[function(require,module,exports){


exports.drawCharacter = function drawCharacter( cluster, pos, v, c, font ) {
    var pchar;
    if( pchar = font.characters[c] ) {
        var data  = pchar.data;
		// background may have an alpha value -
		// but we should still assume that black is transparent...
		var size = pchar.sz;
		var width = pchar.w;
		if( ( font.flags & 3 ) == 0/*FONT_FLAG_MONO*/ )
		{
			var CharDatax = CharData1;
			var inc = Math.floor( (pchar.sz+7)/8 );
		}
		else if( ( font.flags & 3 ) == 1/*FONT_FLAG_2BIT*/ )
		{
			var CharDatax = CharData2;
			var inc = Math.floor((pchar.sz+3)/4);
		}
		else if( ( font.flags & 3 ) == 3 || ( font.flags & 3 )  == 2 )
		{
			var CharDatax = CharData8;
			var inc = (char.sz);
		}

        if( ( font.flags & 3 ) == 0 ) {
            return drawMonoChar( cluster, pos, v, pchar, font, CharDatax, inc );
        }
    }
}

//---------------------------------------------------------------------------
function CharData8( bits, ofs, bit ) { return bits[ofs+bit]; }
//---------------------------------------------------------------------------
function CharData2( bits, ofs, bit ) { return (bits[ofs+bit>>2] >> (2*(bit&3)))&3; }
//---------------------------------------------------------------------------
function CharData1( bits, ofs, bit ) { return (bits[ofs+(bit>>3)] >> (bit&7))&1; }


function drawMonoChar( cluster, pos, v, pchar, font, CharDatax, inc ) {
    var line_target;
    var y = pos.y + ( font.baseline + pchar.asc );
    var x = pos.x + ( pchar.ofs );
    var line = 0;//UseFont.baseline - pchar.ascent;
    var dOfs = 0;
    var line_target =  pchar.asc - pchar.dsc;//(UseFont.baseline - pchar.asc) + ( UseFont.baseline - pchar.descent );
    var data  = pchar.data;
    var size = pchar.sz;
    for(;
         line <= line_target;
         line++ )
    {
        for( var bit = 0; bit < size; bit++ )
        {
            var chardata = CharDatax( data, dOfs, bit );
            if( chardata )
                cluster.setCube( x + bit, y - line, 0, v );
        }
        dOfs += inc;
    }
    return pchar.w;
}

},{}],65:[function(require,module,exports){


var currentRef;
var currentAddRef;

var selector = Voxelarium.selector = {

    get currentVoxel () {
        return currentRef;
    },
    set currentVoxel (ref) {
        currentRef = ref;
    },
    get currentAddVoxel () {
        return currentAddRef;
    },
    set currentAddVoxel (ref) {
        currentAddRef = ref;
    },
    material : new THREE.LineBasicMaterial({ color:'white'
        ,vertexColors: THREE.VertexColors
        ,linewidth:1 /* windows == 1 always */
        }),
    geometry : new THREE.Geometry(),
    mesh : null,
    meshGlow : null,
};
selector.material.depthWrite = false;
selector.material.depthTest = false;

selector.mesh = new THREE.LineSegments( selector.geometry, selector.material );
selector.meshGlow = new THREE.LineSegments( selector.geometry, selector.material );


Voxelarium.selector.update = function() {
    var color = new THREE.Color( 0.8, 0, 0 );
    var unit = currentRef?currentRef.cluster.voxelUnitSize:10;
    var x = 0
    var y = 0
    var z = 0
    var geometry = selector.geometry;
    geometry.vertices.length = 0;
    geometry.colors.length = 0;
    for( var n = 0; n < 2; n++ ) {
        if( n == 0 ) {
            if( !currentRef )
            {
                //return;
              }
              else {
                unit = currentRef.cluster.voxelUnitSize;
                x = currentRef.wx * unit
                y = currentRef.wy * unit
                z = currentRef.wz * unit
              }
          }else{
              //color.delete();
              color = new THREE.Color( 0, 0.8, 0 );
              if( !currentAddRef )
              {
                  //return;
                }
                else {
                  x = currentAddRef.wx * unit
                  y = currentAddRef.wy * unit
                  z = currentAddRef.wz * unit
                }

          }
    var P = [new THREE.Vector3( x, y, z )
        , new THREE.Vector3( x + unit, y, z )
        , new THREE.Vector3( x, y + unit, z )
        , new THREE.Vector3( x + unit, y + unit, z )
        , new THREE.Vector3( x, y, z + unit )
        , new THREE.Vector3( x + unit, y, z + unit )
        , new THREE.Vector3( x, y + unit, z + unit )
        , new THREE.Vector3( x + unit, y + unit, z + unit )
        ]
    geometry.colors.push( color );
    geometry.vertices.push( P[0] );
    geometry.colors.push( color );
    geometry.vertices.push( P[1] );
    geometry.colors.push( color );
    geometry.vertices.push( P[1] );
    geometry.colors.push( color );
    geometry.vertices.push( P[3] );
    geometry.colors.push( color );
    geometry.vertices.push( P[3] );
    geometry.colors.push( color );
    geometry.vertices.push( P[2] );
    geometry.colors.push( color );
    geometry.vertices.push( P[2] );
    geometry.colors.push( color );
    geometry.vertices.push( P[0] );

    geometry.colors.push( color );
    geometry.vertices.push( P[4] );
    geometry.colors.push( color );
    geometry.vertices.push( P[5] );
    geometry.colors.push( color );
    geometry.vertices.push( P[5] );
    geometry.colors.push( color );
    geometry.vertices.push( P[7] );
    geometry.colors.push( color );
    geometry.vertices.push( P[7] );
    geometry.colors.push( color );
    geometry.vertices.push( P[6] );
    geometry.colors.push( color );
    geometry.vertices.push( P[6] );
    geometry.colors.push( color );
    geometry.vertices.push( P[4] );

    geometry.colors.push( color );
    geometry.vertices.push( P[0] );
    geometry.colors.push( color );
    geometry.vertices.push( P[4] );
    geometry.colors.push( color );
    geometry.vertices.push( P[1] );
    geometry.colors.push( color );
    geometry.vertices.push( P[5] );
    geometry.colors.push( color );
    geometry.vertices.push( P[2] );
    geometry.colors.push( color );
    geometry.vertices.push( P[6] );
    geometry.colors.push( color );
    geometry.vertices.push( P[3] );
    geometry.colors.push( color );
    geometry.vertices.push( P[7] );

    }
    //color.delete();
    geometry.computeBoundingSphere();
    geometry.verticesNeedUpdate = true;
    geometry.colorsNeedUpdate = true;
}

},{}],66:[function(require,module,exports){
"use strict";

var types = Voxelarium.Voxels;

var keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40
	, A:65, S:83, D:68, W:87, SPACE:32, C:67
    , I : 73, ESCAPE : 27 };


function InventoryItem ( voxelType ) {
    var item = {
        voxelType : voxelType,  // voxel type
        THREE_solid : null,
        geometry : Voxelarium.Settings.use_basic_material
					? Voxelarium.GeometryBasicBuffer()
					: Voxelarium.GeometryBuffer() ,

    }
    item.geometry.makeVoxCube( 0.25, voxelType );

    return item;
}

Voxelarium.Inventory = function( geometryShader,domElement ) {
    var domElement = ( domElement !== undefined ) ? domElement : document;
    var inventory = {
         raycaster : new THREE.Raycaster(),
        items : [],
        enabled : false,
        build_vertical : true,
        THREE_solid : new THREE.Object3D(),
         x_max : 15, y_max : 12,
         x_inc : 0.75, y_inc : 0.75,
         mouseRay : { n : THREE.Vector3Zero.clone(), o: new THREE.Vector3().delete() },
         last_intersects : null,
         deactivates : [],
         //mouseClock : new THREE.Clock();

        updatePositions : function() {
            var x = 0, y = 0;
            inventory.items.forEach( (item)=>{
                if( y >= this.y_max || x >= this.x_max ) {
                    item.THREE_solid.visible = false;
                  return;
                }
                item.THREE_solid.visible = true;
                item.THREE_solid.matrix.origin.set( x, y, 0 );
                if( this.build_vertical ) {
                    y += this.y_inc;
                    if( y >= this.y_max ) {
                      y = 0;
                      x += this.x_inc;
                    }
                }else {
                    x += this.x_inc;
                    if( x >= this.x_max ) {
                      x = 0;
                      y += this.y_inc;
                    }
                }
            })
        },
        activate : function(  inactiveCallback ) {
            domElement.addEventListener( 'contextmenu', ignore, false );
        	domElement.addEventListener( 'mousedown', onMouseDown, false );
        	domElement.addEventListener( 'mousewheel', onMouseWheel, false );
            domElement.addEventListener( 'mousemove', onMouseMove, false );
            domElement.addEventListener( 'mouseup', onMouseUp, false );
            window.addEventListener( 'keydown', onKeyDown, false );
            window.addEventListener( 'keyup', onKeyUp, false );
            inventory.THREE_solid.visible = true;
            inventory.enabled = true;
            if( inactiveCallback )
                inventory.deactivates.push( inactiveCallback )
        },
        deactivate : function( ) {
            domElement.removeEventListener( 'contextmenu', ignore, false );
            domElement.removeEventListener( 'mousedown', onMouseDown, false );
            domElement.removeEventListener( 'mousewheel', onMouseWheel, false );
            //domElement.removeEventListener( 'DOMMouseScroll', onMouseWheel, false ); // firefox
            domElement.removeEventListener( 'mousemove', onMouseMove, false );
            domElement.removeEventListener( 'mouseup', onMouseUp, false );
            window.removeEventListener( 'keydown', onKeyDown, false );
            window.removeEventListener( 'keyup', onKeyUp, false );

            inventory.THREE_solid.visible = false;
            inventory.enabled = false;
            if( inventory.deactivates.length ) {
                inventory.deactivates.forEach( (cb)=>cb() );
                inventory.deactivates.length = 0;
            }

        },
        animate : function( camera, tick ) {
            if( !camera )return;
            if( !inventory.enabled) return;
            var o;
			var inventoryO;
            var f;

            ( inventoryO = this.THREE_solid.matrix.origin/*position*/  ).copy( camera.matrix.origin );
            //f = camera.matrix.forward

			o = inventory.raycaster.ray.origin.clone();
			f = inventory.raycaster.ray.direction;

            o.addScaledVector( f, 11 );

			var tmpdel = f.dot( camera.matrix.forward.delete() );
			inventoryO.addScaledVector( camera.matrix.forward.delete(),  11 / tmpdel );

            var m = this.THREE_solid.matrix;
            var away = camera.matrix.origin.clone().addScaledVector( o, 2 )
            m.lookAt( o, camera.matrix.origin, camera.matrix.up )
            m.rotateOrtho( Math.PI, 0, 2 );
            //var d = camera.matrix.down;
            inventoryO.addScaledVector( m.down.delete(), (this.y_max-this.y_inc)/2 );
            inventoryO.addScaledVector( m.right.delete(), (this.x_max-this.x_inc)/2 );


			//inventoryO.copy( o );

            this.THREE_solid.matrixWorldNeedsUpdate = true;

            inventory.last_intersects = inventory.raycaster.intersectObjects( inventory.THREE_solid.children );
            inventory.selector.currentVoxel = null;
            for ( var i = 0; i < inventory.last_intersects.length; i++ ) {
                if( inventory.last_intersects[i].object !== inventory.selector.THREE_solid ) {
                    inventory.selector.currentVoxel = inventory.last_intersects[i];
                    break;
                }
                //inventory.selector.currentVoxel = intersects[i];
                //inventory.selector.currentVoxel = intersects[i].object.item
                //intersects[ i ].object.material.color.set( 0xff0000 );

            }
            var obj;
            if( inventory.selector.currentVoxel ) {
                obj = inventory.selector.currentVoxel.object;
                obj.matrix.motion.rotation.x = 0.50;
                obj.matrix.motion.rotation.y = 1.50;
                obj.matrix.motion.rotation.z = 2.30;
                //obj.matrix.motion.torque.x = 0.25;
                obj.matrix.move(tick);
                obj.matrixWorldNeedsUpdate = true;

            }
            updateSelector();
            //if( inventory.selector.currentVoxel )
            //    inventory.selector.currentVoxel.object.visible = false;
            //for ( var i = 0; i < inventory.last_intersects.length; i++ ) {
                //console.log( inventory.last_intersects[i])
        		//intersects[ i ].object.material.color.set( 0xff0000 );

        	//}
        }
    }
    types.types.forEach( (voxel)=>{
        var item;
        inventory.items.push( item = InventoryItem( voxel ) );
        inventory.THREE_solid.add( item.THREE_solid = new THREE.Mesh( item.geometry.geometry, geometryShader ) );
        item.THREE_solid.frustumCulled = false;
        item.THREE_solid.item = item;
        item.THREE_solid.matrixAutoUpdate = false;
    })
    inventory.updatePositions();
    inventory.THREE_solid.matrixAutoUpdate = false;
    inventory.THREE_solid.visible = false;
    var currentRef;
    var currentAddRef;

    inventory.selector = {

        get currentVoxel () {
            return currentRef;
        },
        set currentVoxel (ref) {
            currentRef = ref;
        },
        get currentAddVoxel () {
            return currentAddRef;
        },
        set currentAddVoxel (ref) {
            currentAddRef = ref;
        },
        material : new THREE.LineBasicMaterial({ color:'white'
            //,vertexColors: THREE.VertexColors
            ,linewidth:1 /* windows == 1 always */
            }),
        geometry : new THREE.Geometry(),
        THREE_solid : null,
        meshGlow : null,
    };
    inventory.selector.material.depthWrite = false;
    inventory.selector.material.depthTest = false;

    inventory.selector.THREE_solid = new THREE.LineSegments( inventory.selector.geometry, inventory.selector.material );
    inventory.selector.meshGlow = new THREE.LineSegments( inventory.selector.geometry, inventory.selector.material );
    inventory.selector.THREE_solid.frustumCulled = false;

    inventory.THREE_solid.add( inventory.selector.THREE_solid );


    function updateSelector() {
        var color = new THREE.Color( 0.8, 0, 0 );
        var unit = 0.8;
        var x = 0
        var y = 0
        var z = 0
        var geometry = inventory.selector.geometry;
        geometry.vertices.length = 0;
        geometry.colors.length = 0;
        if( !currentRef ){
            geometry.computeBoundingSphere();
            geometry.verticesNeedUpdate = true;
            geometry.colorsNeedUpdate = true;

            return;
        }
        var origin = currentRef.object.matrix.origin;
        //console.log( `inventory at ${origin.x} ${origin.y} ${origin.z}`)
        for( var n = 0; n < 1; n++ ) {
            x = origin.x  - unit/2 - 0.1
            y = origin.y  - unit/2 - 0.1
            z = origin.z  - unit/2 - 0.1
          unit += 0.2;
        var P = [new THREE.Vector3( x, y, z )
            , new THREE.Vector3( x + unit, y, z )
            , new THREE.Vector3( x, y + unit, z )
            , new THREE.Vector3( x + unit, y + unit, z )
            , new THREE.Vector3( x, y, z + unit )
            , new THREE.Vector3( x + unit, y, z + unit )
            , new THREE.Vector3( x, y + unit, z + unit )
            , new THREE.Vector3( x + unit, y + unit, z + unit )
            ]
        geometry.colors.push( color );
        geometry.vertices.push( P[0] );
        geometry.colors.push( color );
        geometry.vertices.push( P[1] );
        geometry.colors.push( color );
        geometry.vertices.push( P[1] );
        geometry.colors.push( color );
        geometry.vertices.push( P[3] );
        geometry.colors.push( color );
        geometry.vertices.push( P[3] );
        geometry.colors.push( color );
        geometry.vertices.push( P[2] );
        geometry.colors.push( color );
        geometry.vertices.push( P[2] );
        geometry.colors.push( color );
        geometry.vertices.push( P[0] );

        geometry.colors.push( color );
        geometry.vertices.push( P[4] );
        geometry.colors.push( color );
        geometry.vertices.push( P[5] );
        geometry.colors.push( color );
        geometry.vertices.push( P[5] );
        geometry.colors.push( color );
        geometry.vertices.push( P[7] );
        geometry.colors.push( color );
        geometry.vertices.push( P[7] );
        geometry.colors.push( color );
        geometry.vertices.push( P[6] );
        geometry.colors.push( color );
        geometry.vertices.push( P[6] );
        geometry.colors.push( color );
        geometry.vertices.push( P[4] );

        geometry.colors.push( color );
        geometry.vertices.push( P[0] );
        geometry.colors.push( color );
        geometry.vertices.push( P[4] );
        geometry.colors.push( color );
        geometry.vertices.push( P[1] );
        geometry.colors.push( color );
        geometry.vertices.push( P[5] );
        geometry.colors.push( color );
        geometry.vertices.push( P[2] );
        geometry.colors.push( color );
        geometry.vertices.push( P[6] );
        geometry.colors.push( color );
        geometry.vertices.push( P[3] );
        geometry.colors.push( color );
        geometry.vertices.push( P[7] );

        }
        //color.delete();
        geometry.computeBoundingSphere();
        geometry.verticesNeedUpdate = true;
        geometry.colorsNeedUpdate = true;
    }


    return inventory;


     function setMouseRay( camera, e ) {
        var rect = domElement.getBoundingClientRect();
        const w = rect.right-rect.left;//window.innerWidth;
        const h = rect.bottom-rect.top;//window.innerHeight;
        var x = (((e.clientX-rect.left)-(w/2.0))/w) * 2;
        var y = (((e.clientY-rect.top)-(h/2.0))/h) * 2;
        //console.log( `mouse at ${x}, ${y}` )

        inventory.raycaster.setFromCamera( {x:x,y:-y}, camera );

    }


      function onMouseDown(event) {
          if ( inventory.enabled === false ) return;
          event.preventDefault();
          if( inventory.selector.currentVoxel ) {
              controlGame.setCurrentType( inventory.selector.currentVoxel.object.item.voxelType );

              inventory.deactivate();
          }
          //inventory.last_intersects = inventory.raycaster.intersectObjects( inventory.THREE_solid.children );
          for ( var i = 0; i < inventory.last_intersects.length; i++ ) {
              if( inventory.last_intersects[i].object !== inventory.selector.THREE_solid ) {
                  inventory.selector.currentVoxel = inventory.last_intersects[i];
                  break;
              }
              //inventory.selector.currentVoxel = intersects[i];
              //inventory.selector.currentVoxel = intersects[i].object.item
              //intersects[ i ].object.material.color.set( 0xff0000 );

          }

      }

      function onMouseUp(event) {
          if ( inventory.enabled === false ) return;
          event.preventDefault();
      }

        function onMouseMove( event ) {
        	if ( inventory.enabled === false ) return;
        	event.preventDefault();
            setMouseRay( camera, event );
        }

        function onMouseWheel( event ) {
            event.preventDefault();
            mouseScrollX += event.wheelDeltaX;
            mouseScrollY += event.wheelDeltaY;
        }

      function ignore(event) {
          event.preventDefault();
      }

      function onKeyDown( event ) {


      	switch ( event.keyCode ) {
            case keys.ESCAPE:
      		case keys.I:
      			inventory.deactivate();
      			break;
      	}

      }

      function onKeyUp( event ) {

      	switch ( event.keyCode ) {
      	}
      }


}

},{}],67:[function(require,module,exports){

//var Gun = require( "gun" );
var Gun = require( "../node_modules/gun/gun.js" );

var db = {};
Voxelarium.db = db;

//Voxelarium.db = db;

//global = Gun({prefix: 'global/', peers: ['https://localhost:8080/gun']})
//local = Gun({prefix: 'local/'}).


db.globalDb = Gun( {prefix: 'global/', peers: [`ws://${location.host}/gun`]} ).get( "Voxelarium" );
//db.globalDb = Gun( location.origin + '/gun' ).get( "Voxelarium" );
//db.globalDb = Gun( {prefix: 'global/', peers: [`https://${location.origin}/gun`]} ).get( "Voxelarium" );
db.localDb = Gun( {prefix: 'local/'}).get( "org.d3x0r.voxelarium.local" );
//db.localDb = db.globalDb.path( "local" );

db.world = {
    db : null, //db.globalDb
    cluster : null,
    loadSector : loadSector,
    storeSector : storeSector,
    getPath : getPath,
    listeners : [],
}

db.player = { local: db.localDb.path( "player" )
        , global : null // have to wait for player ID before
        , _quat: new THREE.Quaternion()
        , _origin : new THREE.Vector3()
        , quat: new THREE.Quaternion()
        , origin : new THREE.Vector3()
        , positionUpdate : false
        , inventory : []
        , id : null
        , world_id : null
    }

function sectorUpdated( sector, stuff ) {
  var x, y, z;
  var base_x = ( sector.pos.x >> 2 ) * 4;
  var base_y = ( sector.pos.y >> 2 ) * 4;
  var base_z = ( sector.pos.z >> 2 ) * 4;
  console.log( "Got sector update event", stuff)
  for( x = 0; x <= 3; x++ )
    for( y = 0; y <= 3; y++ )
      for( z = 0; z <= 3; z++ ) {
        var key = `${x}${y}${z}`
        var val;
        if( val = stuff[key] ) {
          var sector = db.world.cluster.getSector( base_x + x, base_y + y, base_z + z, true )
          if( sector )
            if( sector.cachedString !== val ) {
              console.log( "new sector string - need decode.")
              sector.decode( val )
            }
        }
      }

}

function addListener( sector ) {
  var where = getZonePath(sector);
  if( db.world.listeners.findIndex( (val)=>where===val ) < 0 ) {
    db.world.listeners.push( where );
    db.world.db.path( where ).on( (data)=>{ sectorUpdated(sector,data) }, { delta: true } )
    return false;
  }
}
function getZonePath( sector ) {
  return `sector.${sector.pos.x>>2}.${sector.pos.y>>2}.${sector.pos.z>>2}`
}
function getPath( sector ) {
  return `${getZonePath(sector)}.${sector.pos.x&3}${sector.pos.y&3}${sector.pos.z&3}`
}
//db.player = db.globalDb.get( "player" );

function playerPositionChange( data ) {
    var lastq = db.player.quat
    var q = db.player._quat.set( data.qx,data.qy,data.qz,data.qw)
    var lasto = db.player.origin
    var o = db.player._origin.set( data.ox, data.oy, data.oz );
    if( q.x != lastq.x ||
        q.y != lastq.y ||
        q.z != lastq.z ||
        q.w != lastq.w
    ) {
        var a = ( q.x - lastq.x );
        var b = ( q.y - lastq.y );
        var c = ( q.z - lastq.z );

        if( a*a+b*b+c*c > 0.001 )
        {
            db.player.positionUpdate = true; // skip next animate update
            Voxelarium.camera.matrix.makeRotationFromQuaternion( db.player._quat );
            Voxelarium.camera.matrixWorldNeedsUpdate = true;
        }
    }
    if( o.x != lasto.x ||
        o.y != lasto.y ||
        o.z != lasto.z
            ) {
        var a = ( o.x - lasto.x );
        var b = ( o.y - lasto.y );
        var c = ( o.z - lasto.z );

        if( a*a+b*b+c*c > 0.001 )
        {
            db.player.positionUpdate = true; // skip next animate update
            Voxelarium.camera.position.copy( o );
            Voxelarium.camera.matrixWorldNeedsUpdate = true;
        }
    }
    //console.log( "data : ", data);
}


function setupEvents( cb ) {
    //db.player.local.path("position").on( playerPositionChange );
    db.player.global.path("position").on( playerPositionChange );
    loadWorld( cb );
}

function loadVoxels(cb, val){
  var count = val.voxelTypeCount;
  //console.log( "have " , count )
  db.world.voxelInfo.path( "voxelTypes" ).map( (data,field)=>{
      var t = Voxelarium.Voxels.types[Number(field)];
      if( t ) return;
      //console.log( "reloading ", field, data.ID)
      t = Voxelarium.Voxels.types[data.ID] = eval( data.code );

      if( data.texture ) {
        count++;
        ( t.image = new Image() ).src = t.textureData = data.texture;

          t.image.onload = ()=> {
             //console.log( "Wait until load to setup coords")
             t.textureCoords = Voxelarium.TextureAtlas.add( t.image )
             //console.log( "pending ", count );
             if( !--count ) { console.log( "ZERO!" ); cb(); }
          }

      }
      if( !--count ) cb();
  });
}


function initialVoxelTypeLoad(branch,cb) {
    console.log( "Loading initial voxels...")
    Voxelarium.Voxels.load( ()=>{
        var voxelTypes = {};
        var n = 0;
        Voxelarium.Voxels.types.forEach( (type)=>{
            if( !type.ID ) return;
            n++;
            voxelTypes[ type.ID ] = { ID:type.ID, code: type.codeData, texture : type.textureData};
        });
        branch.put( { voxelTypes : voxelTypes, voxelTypeCount : n } );
        cb();
    });
}

function loadWorld( cb ) {
    ( db.world.voxelInfo = db.world.db.path( "voxelInfo" ) )
        .not( function(){
          console.log( "No VoxelInfo; load default");
            initialVoxelTypeLoad(db.world.voxelInfo,cb)
         }).val( (val)=>{
            console.log( "skip a beat and load the voxels....")
           setTimeout(
               ()=>{ loadVoxels(cb,val) }
             )
        } );
}

function doDefaultInit( data ) {
    if( !db.player.id ) {
        console.log( "do default init... pick a player ID and give him an initial world_id")
        db.player.id = new Date().getTime();
        db.player.world_id = 0;
        console.log( "put local.id=player.id")
        db.player.local.path("id").put( db.player.id )
        console.log( "put local.world_id=player.world_id")
        db.player.local.path("world_id").put( db.player.world_id )
        console.log( "done putting world_id")
    }else {
        console.log( "skipped redundant init")
    }
    // the val() in init will fire here; so global gets initialized in normal path...
}

function doDefaultInitTrigger() {
    console.log( "put init=true")
	  db.player.local.path( "init" ).put( true );
    console.log( "local put init has finished for inital Db Kick;" );
}

function doDefaultGlobalInitTrigger() {
    console.log( " kick global?")
    db.player.global.path( "init" ).put( true );
    console.log( "global put init has finished for inital Db Kick")

}

function playerConnect( val, field ) {
  console.log( "player has connected", val, field );
}

var defaultTimeout;
var defaultGlobalTimeout;
db.init = function( cb ) {
    // defaultTimeout = setTimeout( doDefaultInitTrigger, 250 );
    db.player.local.path("id").not( doDefaultInit ).val( (data)=>{
        console.log( "value is ", data)
        //clearTimeout( defaultTimeout );
        db.player.id = data;
        db.globalDb.path( "player" ).map( playerConnect );
        db.player.global = db.globalDb.path( "player" ).path( data );
        console.log( "going to request world_id...")
        db.player.local.path("world_id").val( (data)=> {
            console.log( "received world_id")
          db.player.world_id = data;
          db.world.db = db.globalDb.path( "world" ).path( db.player.world_id );
          db.player.global.map().val( playerConnect );
          db.player.global.path("position").on( playerPositionChange );
          loadWorld( cb );
        } );
        console.log( "requested world id - done with val callback")
    })
    //db.player.local.path("id").put( new Date().getTime() )
}

db.animate = function() {
    //db.player.put( {position:Voxelarium.camera.position} )
    if( !db.player.global )
        return;
    var m = Voxelarium.camera.matrix;
    var oldq = db.player._quat
    var newq = db.player.quat.setFromRotationMatrix( m );
    var oldo = db.player._origin
    var newo = db.player.origin.copy( m.origin );


    if( oldq.x !== newq.x ||
        oldq.y !== newq.y ||
        oldq.z !== newq.z ||
        oldq.w !== newq.w ||
        oldo.x !== newo.x ||
        oldo.y !== newo.y ||
        oldo.z !== newo.z )
    {
        var a = ( oldo.x - newo.x );
        var b = ( oldo.y - newo.y );
        var c = ( oldo.z - newo.z );

        var d = ( oldq.x - newq.x );
        var e = ( oldq.y - newq.y );
        var f = ( oldq.z - newq.z );
        var g = ( oldq.w - newq.w );
        //console.log( `a is ${a*a+b*b+c*c}  b is ${d*d+e*e+f*f+g*g}`)
        if( ( a*a+b*b+c*c > 0.001 )
            ||( d*d+e*e+f*f+g*g > 0.001 ) )
        {
            var pos_msg = {qx:newq.x,qy:newq.y,qz:newq.z,qw:newq.w
                            ,ox:m.origin.x,oy:m.origin.y,oz:m.origin.z}
            //console.log( "put", pos_msg )
            //db.player.local.path( "position").put( pos_msg )
            db.player.global.path( "position").put( pos_msg )
            oldq.copy( newq );
            oldo.copy( newo );
        }
    }
}


function storeSector( sector ) {
    if( !db.world.cluster )
      db.world.cluster = sector.cluster;
    addListener( sector );
    //console.log( "put sector update " )
    var string;
      this.db.path(getPath(sector)).put( string = sector.stringify() );
      console.log( "put-ed sector update ", string )
}

function loadSector( sector ) {
      addListener( sector );
      //this.db.path(getPath(sector)).on( cb );
}

//gun.get( `org.d3x0r.voxelarium.universe.${universe}.player.${self}`)

},{"../node_modules/gun/gun.js":11}],68:[function(require,module,exports){

Voxelarium.Voxels = {
	types : [],
	add : function( type, properties,reaction ) {
        	//this.types.push(
						this[type] = {
						 ID : this.types.length
                		, name : type
                		, properties : properties
				, reaction : reaction
			 	, createVoxelExtension : null
				, deleteVoxelExtension : null
				, textureCoords : {}
				, image : null
				, texture : null
				, codeData : null
				, textureData : null
			}
		  //);
			if( typeof properties.DrawInfo === "undefined" )
				properties.DrawInfo = Voxelarium.ZVOXEL_DRAWINFO_DRAWFULLVOXELOPACITY;
			return this[type];
		}
/*
Is_PlayerCanPassThrough = false;
Draw_TransparentRendering = false;
Draw_FullVoxelOpacity = true;
DrawInfo = VoxelGlobalSettings.ZVOXEL_DRAWINFO_DRAWFULLVOXELOPACITY;
ExtensionType = 0;
Is_VoxelExtension = false;
Is_HasAllocatedMemoryExtension = false;
MiningHardness = 1000.0f;
MiningType = 2;
Is_NoType = false;
Is_UserTypeTransformable = true;
Is_Harming = false;
FrictionCoef = 0.001;
Grip_Horizontal = 0.9;
Grip_Vertical = 0.0;
Is_SpaceGripType = false;
Is_KeepControlOnJumping = true;
HarmingLifePointsPerSecond = 0.0;
Is_Active = false;
Is_CanBeReplacedBy_Water = false;
Is_CanBeReplacedBy_GreenAcid = false;
Is_CanBeReplacedBy_MustardGaz = false;
Is_CombinableWith_GreenAcid = true;
Is_CanTriggerBomb = false;
Is_Liquid = false;
Is_Gaz = false;
Is_Interface_StoreBlock = false;
Is_Interface_PushBlock = false;
Is_Interface_PullBlock = false;
Is_Interface_GetInfo = false;
Is_Interface_SetInfo = false;
Is_Pumpable_ByPump_T1 = false;
Is_Pumpable_ByPump_T2 = false;
Is_Loadable_ByLoader_L1 = true;
BvProp_MoveableByTreadmill = true;
BvProp_FastMoving = false;
Is_Rideable = false;
Is_HasHelpingMessage = false;
BvProp_CanBePickedUpByRobot = true;
BvProp_XrRobotPickMinLevel = 1;
BvProp_PrRobotReplaceMinLevel = 0;
BvProp_PrRobotPickMinLevel = 0;
BvProp_PrRobotMoveMinLevel = 0;
BvProp_AtomicFireResistant = false;
BvProp_EgmyT1Resistant = false;
LiquidDensity = 0.0;
BlastResistance = 1;
FabInfo = null;
Documentation_PageNum = 0;
*/

}

Voxelarium.Voxels.types.push(
Voxelarium.Voxels.add( "Void", {
      Is_PlayerCanPassThrough : true,
      Draw_TransparentRendering : false,
      Draw_FullVoxelOpacity : false,
      DrawInfo : Voxelarium.ZVOXEL_DRAWINFO_VOID,
      Is_Harming : false,
      FrictionCoef : 0.0001,
      Grip_Vertical : 0.0,
      Grip_Horizontal : 0.8,
      Is_SpaceGripType : false,
      Is_KeepControlOnJumping : true,
      Is_Active : false,
      Is_CanBeReplacedBy_Water : true,
      Is_CombinableWith_GreenAcid : false,
      Is_CanBeReplacedBy_GreenAcid : true,
      Is_CanBeReplacedBy_MustardGaz : true,
      BvProp_CanBePickedUpByRobot : false,
      BvProp_XrRobotPickMinLevel : 255,
      BvProp_PrRobotReplaceMinLevel : 0,
      BvProp_PrRobotPickMinLevel : 255,
      BvProp_PrRobotMoveMinLevel : 0,
      BvProp_AtomicFireResistant : true,
      Is_Liquid : false,
      Is_Gaz : true,
      Is_Loadable_ByLoader_L1 : false,
      BvProp_MoveableByTreadmill : false,
      BvProp_EgmyT1Resistant : false,
      LiquidDensity : 0.0,
} ) );

Voxelarium.Voxels.getIndex = function( type ) {
	var types = Voxelarium.Voxels.types;
	return types.findIndex( (v)=>v === type );
}

var xhrObj;
Voxelarium.Voxels.load = function( cb ) {
	var n = 1
	xhrObj = new XMLHttpRequest();
	//var xhrObj2 = new XMLHttpRequest();
	loadAVoxel( n, cb );
}

function loadAVoxel( n, cb ) {
	{
		try {
			xhrObj.open('GET', `./src/voxels/voxel_${n}.js`);
			//xhrObj.responseType = "text";
			//xhrObj.response = "";
			xhrObj.send(null);
			xhrObj.onerror = (err)=>{
				  //console.log( "require ", n );
		      //console.log( err );
					cb();
					return;
			};
			xhrObj.onload = ()=>{
				if( !xhrObj.status || xhrObj.status === 200 ) {
					//console.log( "load ", n)
					Voxelarium.Voxels.types.push( eval(xhrObj.responseText) );
					var t = Voxelarium.Voxels.types[n];

					t.codeData = xhrObj.responseText;
					xhrObj.open('GET', `./src/voxels/images/voxel_${n}.png`);
					xhrObj.onerror = (err)=>{
						 console.log( "error:", err);
				     loadAVoxel( n+1, cb );
				  }
					xhrObj.send(null);
					xhrObj.onload = ()=>{
						if( xhrObj.responseText.length > 0 ) {
							( t.image = new Image() ).src = xhrObj.responseText;
							t.textureData = xhrObj.response;
							t.image.onerror = (err)=>{ console.log( "image load error?", err)}
							//console.log( t );
							if( true || !t.image.width )
							{
								t.image.onload = ()=> {
									 //console.log( "Waited until load to setup coords", t)
								   t.textureCoords = Voxelarium.TextureAtlas.add( t.image )
							  }
							} else {
								//console.log( "don't have to delay load?")
							  //t.textureCoords = Voxelarium.TextureAtlas.add( t.image )
						  }
						}
						loadAVoxel( n+1, cb );
					}
				}
				else {
					console.log( "All completed... out of loadables...")
					cb();
				}
			}
			//require( `./voxels/voxel_${n}.js` )
		}
		catch( err ) {
			console.log( "require ", n );
	        	console.log( err );
				cb();
		}
	}

}

//Voxelarium.Voxels.types[0] = Voxelarium.Voxels.types.Void;
//Voxelarium.Voxels.types[1] = Voxelarium.Voxels.types["BlackRock Blue"];

},{}],69:[function(require,module,exports){

require( "./cluster.js")
var fonts = require( "./voxel.fonts.js" );

Voxelarium.World = function() {
    return {
        clusters : [],

        createCluster : function( mesher, voxelUnitSize ) {
            var cluster = Voxelarium.Cluster(32,32,32);
            cluster.mesher = mesher;
            cluster.voxelUnitSize = voxelUnitSize || 20;
            cluster.getGeometryBuffer = Voxelarium.Settings.use_basic_material
                ? Voxelarium.GeometryBasicBuffer
                : Voxelarium.GeometryBuffer;
            this.clusters.push( cluster );
            return cluster;
        },

        createTextCluster : function( text, v, mesher, font, voxelUnitSize ) {
            var cluster = Voxelarium.Cluster(256*8,8,1);
            cluster.mesher = mesher;
            cluster.voxelUnitSize = voxelUnitSize || 20;
            cluster.getGeometryBuffer = Voxelarium.GeometryBufferMono;
            this.clusters.push( cluster );
            //var sector = cluster.createSector( 0, 0, 0 );
            var pos = { x:0, y:0};

            for( var n = 0; n < text.length; n++ ) {
                var ch = text.codePointAt(n);

                var w = fonts.drawCharacter( cluster, pos, v, ch, font )
                pos.x += w;
            }


            return cluster;
        }
    }
}

},{"./cluster.js":38,"./voxel.fonts.js":64}],70:[function(require,module,exports){
/**
 * @author dmarcos / https://github.com/dmarcos
 * @author mrdoob / http://mrdoob.com
 */

THREE.VRControls = function ( object, onError ) {

	var scope = this;

	var vrDisplay, vrDisplays;

	var standingMatrix = new THREE.Matrix4();

	var frameData = null;

	if ( 'VRFrameData' in window ) {

		frameData = new VRFrameData();

	}

	function gotVRDisplays( displays ) {

		vrDisplays = displays;

		if ( displays.length > 0 ) {

			vrDisplay = displays[ 0 ];

		} else {

			if ( onError ) onError( 'VR input not available.' );

		}

	}

	if ( navigator.getVRDisplays ) {

		navigator.getVRDisplays().then( gotVRDisplays );

	}

  this.roomOrigin = new THREE.Vector3();

	// the Rift SDK returns the position in meters
	// this scale factor allows the user to define how meters
	// are converted to scene units.

	this.scale = 1;

	// If true will use "standing space" coordinate system where y=0 is the
	// floor and x=0, z=0 is the center of the room.
	this.standing = false;

	// Distance from the users eyes to the floor in meters. Used when
	// standing=true but the VRDisplay doesn't provide stageParameters.
	this.userHeight = 1.6;

	this.getVRDisplay = function () {

		return vrDisplay;

	};

	this.setVRDisplay = function ( value ) {

		vrDisplay = value;

	};

	this.getVRDisplays = function () {

		console.warn( 'THREE.VRControls: getVRDisplays() is being deprecated.' );
		return vrDisplays;

	};

	this.getStandingMatrix = function () {

		return standingMatrix;

	};

	this.update = function () {

		if ( vrDisplay ) {

			var pose;

			if ( vrDisplay.getFrameData ) {

				vrDisplay.getFrameData( frameData );
				pose = frameData.pose;

			} else if ( vrDisplay.getPose ) {

				pose = vrDisplay.getPose();

			}

			if ( pose.orientation !== null ) {

				object.quaternion.fromArray( pose.orientation );

			}

			if ( pose.position !== null ) {

				object.position.fromArray( pose.position );
				object.position.add( this.roomOrigin );

			} else {

				object.position.set( 0, 0, 0 );

			}

			if ( this.standing ) {

				if ( vrDisplay.stageParameters ) {

					object.updateMatrix();

					standingMatrix.fromArray( vrDisplay.stageParameters.sittingToStandingTransform );
					object.applyMatrix( standingMatrix );

				} else {

					object.position.setY( object.position.y + this.userHeight );

				}

			}

			object.position.multiplyScalar( scope.scale );

		}

	};

	this.resetPose = function () {

		if ( vrDisplay ) {

			vrDisplay.resetPose();

		}

	};

	this.resetSensor = function () {

		console.warn( 'THREE.VRControls: .resetSensor() is now .resetPose().' );
		this.resetPose();

	};

	this.zeroSensor = function () {

		console.warn( 'THREE.VRControls: .zeroSensor() is now .resetPose().' );
		this.resetPose();

	};

	this.dispose = function () {

		vrDisplay = null;

	};

};

},{}],71:[function(require,module,exports){
/**
 * @author dmarcos / https://github.com/dmarcos
 * @author mrdoob / http://mrdoob.com
 *
 * WebVR Spec: http://mozvr.github.io/webvr-spec/webvr.html
 *
 * Firefox: http://mozvr.com/downloads/
 * Chromium: https://webvr.info/get-chrome
 *
 */

THREE.VREffect = function ( renderer, onError ) {

	var vrDisplay, vrDisplays;
	var eyeTranslationL = new THREE.Vector3();
	var eyeTranslationR = new THREE.Vector3();
	var renderRectL, renderRectR;

	var frameData = null;

	if ( 'VRFrameData' in window ) {

		frameData = new VRFrameData();

	}

	function gotVRDisplays( displays ) {

		vrDisplays = displays;

		if ( displays.length > 0 ) {

			vrDisplay = displays[ 0 ];

		} else {

			if ( onError ) onError( 'HMD not available' );

		}

	}

	if ( navigator.getVRDisplays ) {

		navigator.getVRDisplays().then( gotVRDisplays );

	}

	//

	this.isPresenting = false;
	this.scale = 1;

	var scope = this;

	var rendererSize = renderer.getSize();
	var rendererUpdateStyle = false;
	var rendererPixelRatio = renderer.getPixelRatio();

	this.getVRDisplay = function () {

		return vrDisplay;

	};

	this.setVRDisplay = function ( value ) {

		vrDisplay = value;

	};

	this.getVRDisplays = function () {

		console.warn( 'THREE.VREffect: getVRDisplays() is being deprecated.' );
		return vrDisplays;

	};

  this.getSize = function() {
		return renderer.getSize();
	}
	this.setSize = function ( width, height, updateStyle ) {

		rendererSize = { width: width, height: height };
		rendererUpdateStyle = updateStyle;

		if ( scope.isPresenting ) {

			var eyeParamsL = vrDisplay.getEyeParameters( 'left' );
			renderer.setPixelRatio( 1 );
			renderer.setSize( eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false );

		} else {

			renderer.setPixelRatio( rendererPixelRatio );
			renderer.setSize( width, height, updateStyle );

		}

	};

	// fullscreen

	var canvas = renderer.domElement;
	var requestFullscreen;
	var exitFullscreen;
	var fullscreenElement;
	var defaultLeftBounds = [ 0.0, 0.0, 0.5, 1.0 ];
	var defaultRightBounds = [ 0.5, 0.0, 0.5, 1.0 ];

	function onVRDisplayPresentChange() {

		var wasPresenting = scope.isPresenting;
		scope.isPresenting = vrDisplay !== undefined && vrDisplay.isPresenting;

		if ( scope.isPresenting ) {

			var eyeParamsL = vrDisplay.getEyeParameters( 'left' );
			var eyeWidth = eyeParamsL.renderWidth;
			var eyeHeight = eyeParamsL.renderHeight;

			if ( !wasPresenting ) {

				rendererPixelRatio = renderer.getPixelRatio();
				rendererSize = renderer.getSize();

				renderer.setPixelRatio( 1 );
				renderer.setSize( eyeWidth * 2, eyeHeight, false );

			}

		} else if ( wasPresenting ) {

			renderer.setPixelRatio( rendererPixelRatio );
			renderer.setSize( rendererSize.width, rendererSize.height, rendererUpdateStyle );

		}

	}

	window.addEventListener( 'vrdisplaypresentchange', onVRDisplayPresentChange, false );

	this.setFullScreen = function ( boolean ) {

		return new Promise( function ( resolve, reject ) {

			if ( vrDisplay === undefined ) {

				reject( new Error( 'No VR hardware found.' ) );
				return;

			}

			if ( scope.isPresenting === boolean ) {

				resolve();
				return;

			}

			if ( boolean ) {

				resolve( vrDisplay.requestPresent( [ { source: canvas } ] ) );

			} else {

				resolve( vrDisplay.exitPresent() );

			}

		} );

	};

	this.requestPresent = function () {

		return this.setFullScreen( true );

	};

	this.exitPresent = function () {

		return this.setFullScreen( false );

	};

	this.requestAnimationFrame = function ( f ) {

		if ( vrDisplay !== undefined ) {

			return vrDisplay.requestAnimationFrame( f );

		} else {

			return window.requestAnimationFrame( f );

		}

	};

	this.cancelAnimationFrame = function ( h ) {

		if ( vrDisplay !== undefined ) {

			vrDisplay.cancelAnimationFrame( h );

		} else {

			window.cancelAnimationFrame( h );

		}

	};

	this.submitFrame = function () {

		if ( vrDisplay !== undefined && scope.isPresenting ) {

			vrDisplay.submitFrame();

		}

	};

	this.autoSubmitFrame = true;

	// render

	var cameraL = new THREE.PerspectiveCamera();
	cameraL.layers.enable( 1 );

	var cameraR = new THREE.PerspectiveCamera();
	cameraR.layers.enable( 2 );

	this.render = function ( scene, camera, renderTarget, forceClear ) {

		if ( vrDisplay && scope.isPresenting ) {

			var autoUpdate = scene.autoUpdate;

			if ( autoUpdate ) {

				scene.updateMatrixWorld();
				scene.autoUpdate = false;

			}

			var eyeParamsL = vrDisplay.getEyeParameters( 'left' );
			var eyeParamsR = vrDisplay.getEyeParameters( 'right' );

			eyeTranslationL.fromArray( eyeParamsL.offset );
			eyeTranslationR.fromArray( eyeParamsR.offset );

			if ( Array.isArray( scene ) ) {

				console.warn( 'THREE.VREffect.render() no longer supports arrays. Use object.layers instead.' );
				scene = scene[ 0 ];

			}

			// When rendering we don't care what the recommended size is, only what the actual size
			// of the backbuffer is.
			var size = renderer.getSize();
			var layers = vrDisplay.getLayers();
			var leftBounds;
			var rightBounds;

			if ( layers.length ) {

				var layer = layers[ 0 ];

				leftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : defaultLeftBounds;
				rightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : defaultRightBounds;

			} else {

				leftBounds = defaultLeftBounds;
				rightBounds = defaultRightBounds;

			}

			renderRectL = {
				x: Math.round( size.width * leftBounds[ 0 ] ),
				y: Math.round( size.height * leftBounds[ 1 ] ),
				width: Math.round( size.width * leftBounds[ 2 ] ),
				height: Math.round(size.height * leftBounds[ 3 ] )
			};
			renderRectR = {
				x: Math.round( size.width * rightBounds[ 0 ] ),
				y: Math.round( size.height * rightBounds[ 1 ] ),
				width: Math.round( size.width * rightBounds[ 2 ] ),
				height: Math.round(size.height * rightBounds[ 3 ] )
			};

			if ( renderTarget ) {

				renderer.setRenderTarget( renderTarget );
				renderTarget.scissorTest = true;

			} else {

				renderer.setRenderTarget( null );
				renderer.setScissorTest( true );

			}

			if ( renderer.autoClear || forceClear ) renderer.clear();

			if ( camera.parent === null ) camera.updateMatrixWorld();

			camera.matrixWorld.decompose( cameraL.position, cameraL.quaternion, cameraL.scale );
			camera.matrixWorld.decompose( cameraR.position, cameraR.quaternion, cameraR.scale );

			var scale = this.scale;
			cameraL.translateOnAxis( eyeTranslationL, scale );
			cameraR.translateOnAxis( eyeTranslationR, scale );

			if ( vrDisplay.getFrameData ) {

				vrDisplay.depthNear = camera.near;
				vrDisplay.depthFar = camera.far;

				vrDisplay.getFrameData( frameData );

				cameraL.projectionMatrix.elements = frameData.leftProjectionMatrix;
				cameraR.projectionMatrix.elements = frameData.rightProjectionMatrix;

			} else {

				cameraL.projectionMatrix = fovToProjection( eyeParamsL.fieldOfView, true, camera.near, camera.far );
				cameraR.projectionMatrix = fovToProjection( eyeParamsR.fieldOfView, true, camera.near, camera.far );

			}

			// render left eye
			if ( renderTarget ) {

				renderTarget.viewport.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );
				renderTarget.scissor.set( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );

			} else {

				renderer.setViewport( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );
				renderer.setScissor( renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height );

			}
			renderer.render( scene, cameraL, renderTarget, forceClear );

			// render right eye
			if ( renderTarget ) {

				renderTarget.viewport.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );
				renderTarget.scissor.set( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );

			} else {

				renderer.setViewport( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );
				renderer.setScissor( renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height );

			}
			renderer.render( scene, cameraR, renderTarget, forceClear );

			if ( renderTarget ) {

				renderTarget.viewport.set( 0, 0, size.width, size.height );
				renderTarget.scissor.set( 0, 0, size.width, size.height );
				renderTarget.scissorTest = false;
				renderer.setRenderTarget( null );

			} else {

				renderer.setViewport( 0, 0, size.width, size.height );
				renderer.setScissorTest( false );

			}

			if ( autoUpdate ) {

				scene.autoUpdate = true;

			}

			if ( scope.autoSubmitFrame ) {

				scope.submitFrame();

			}

			return;

		}

		// Regular render mode if not HMD

		renderer.render( scene, camera, renderTarget, forceClear );

	};

	this.dispose = function () {

		window.removeEventListener( 'vrdisplaypresentchange', onVRDisplayPresentChange, false );

	};

	//

	function fovToNDCScaleOffset( fov ) {

		var pxscale = 2.0 / ( fov.leftTan + fov.rightTan );
		var pxoffset = ( fov.leftTan - fov.rightTan ) * pxscale * 0.5;
		var pyscale = 2.0 / ( fov.upTan + fov.downTan );
		var pyoffset = ( fov.upTan - fov.downTan ) * pyscale * 0.5;
		return { scale: [ pxscale, pyscale ], offset: [ pxoffset, pyoffset ] };

	}

	function fovPortToProjection( fov, rightHanded, zNear, zFar ) {

		rightHanded = rightHanded === undefined ? true : rightHanded;
		zNear = zNear === undefined ? 0.01 : zNear;
		zFar = zFar === undefined ? 10000.0 : zFar;

		var handednessScale = rightHanded ? - 1.0 : 1.0;

		// start with an identity matrix
		var mobj = new THREE.Matrix4();
		var m = mobj.elements;

		// and with scale/offset info for normalized device coords
		var scaleAndOffset = fovToNDCScaleOffset( fov );

		// X result, map clip edges to [-w,+w]
		m[ 0 * 4 + 0 ] = scaleAndOffset.scale[ 0 ];
		m[ 0 * 4 + 1 ] = 0.0;
		m[ 0 * 4 + 2 ] = scaleAndOffset.offset[ 0 ] * handednessScale;
		m[ 0 * 4 + 3 ] = 0.0;

		// Y result, map clip edges to [-w,+w]
		// Y offset is negated because this proj matrix transforms from world coords with Y=up,
		// but the NDC scaling has Y=down (thanks D3D?)
		m[ 1 * 4 + 0 ] = 0.0;
		m[ 1 * 4 + 1 ] = scaleAndOffset.scale[ 1 ];
		m[ 1 * 4 + 2 ] = - scaleAndOffset.offset[ 1 ] * handednessScale;
		m[ 1 * 4 + 3 ] = 0.0;

		// Z result (up to the app)
		m[ 2 * 4 + 0 ] = 0.0;
		m[ 2 * 4 + 1 ] = 0.0;
		m[ 2 * 4 + 2 ] = zFar / ( zNear - zFar ) * - handednessScale;
		m[ 2 * 4 + 3 ] = ( zFar * zNear ) / ( zNear - zFar );

		// W result (= Z in)
		m[ 3 * 4 + 0 ] = 0.0;
		m[ 3 * 4 + 1 ] = 0.0;
		m[ 3 * 4 + 2 ] = handednessScale;
		m[ 3 * 4 + 3 ] = 0.0;

		mobj.transpose();

		return mobj;

	}

	function fovToProjection( fov, rightHanded, zNear, zFar ) {

		var DEG2RAD = Math.PI / 180.0;

		var fovPort = {
			upTan: Math.tan( fov.upDegrees * DEG2RAD ),
			downTan: Math.tan( fov.downDegrees * DEG2RAD ),
			leftTan: Math.tan( fov.leftDegrees * DEG2RAD ),
			rightTan: Math.tan( fov.rightDegrees * DEG2RAD )
		};

		return fovPortToProjection( fovPort, rightHanded, zNear, zFar );

	}

};

},{}],72:[function(require,module,exports){
/**
 * @author mrdoob / http://mrdoob.com/
 */

THREE.OBJLoader = function ( manager ) {

	this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;

	this.materials = null;

	this.regexp = {
		// v float float float
		vertex_pattern           : /^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,
		// vn float float float
		normal_pattern           : /^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,
		// vt float float
		uv_pattern               : /^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,
		// f vertex vertex vertex
		face_vertex              : /^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,
		// f vertex/uv vertex/uv vertex/uv
		face_vertex_uv           : /^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,
		// f vertex/uv/normal vertex/uv/normal vertex/uv/normal
		face_vertex_uv_normal    : /^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,
		// f vertex//normal vertex//normal vertex//normal
		face_vertex_normal       : /^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,
		// o object_name | g group_name
		object_pattern           : /^[og]\s*(.+)?/,
		// s boolean
		smoothing_pattern        : /^s\s+(\d+|on|off)/,
		// mtllib file_reference
		material_library_pattern : /^mtllib /,
		// usemtl material_name
		material_use_pattern     : /^usemtl /
	};

};

THREE.OBJLoader.prototype = {

	constructor: THREE.OBJLoader,

	load: function ( url, onLoad, onProgress, onError ) {

		var scope = this;

		var loader = new THREE.XHRLoader( scope.manager );
		loader.setPath( this.path );
		loader.load( url, function ( text ) {

			onLoad( scope.parse( text ) );

		}, onProgress, onError );

	},

	setPath: function ( value ) {

		this.path = value;

	},

	setMaterials: function ( materials ) {

		this.materials = materials;

	},

	_createParserState : function () {

		var state = {
			objects  : [],
			object   : {},

			vertices : [],
			normals  : [],
			uvs      : [],

			materialLibraries : [],

			startObject: function ( name, fromDeclaration ) {

				// If the current object (initial from reset) is not from a g/o declaration in the parsed
				// file. We need to use it for the first parsed g/o to keep things in sync.
				if ( this.object && this.object.fromDeclaration === false ) {

					this.object.name = name;
					this.object.fromDeclaration = ( fromDeclaration !== false );
					return;

				}

				var previousMaterial = ( this.object && typeof this.object.currentMaterial === 'function' ? this.object.currentMaterial() : undefined );

				if ( this.object && typeof this.object._finalize === 'function' ) {

					this.object._finalize( true );

				}

				this.object = {
					name : name || '',
					fromDeclaration : ( fromDeclaration !== false ),

					geometry : {
						vertices : [],
						normals  : [],
						uvs      : []
					},
					materials : [],
					smooth : true,

					startMaterial : function( name, libraries ) {

						var previous = this._finalize( false );

						// New usemtl declaration overwrites an inherited material, except if faces were declared
						// after the material, then it must be preserved for proper MultiMaterial continuation.
						if ( previous && ( previous.inherited || previous.groupCount <= 0 ) ) {

							this.materials.splice( previous.index, 1 );

						}

						var material = {
							index      : this.materials.length,
							name       : name || '',
							mtllib     : ( Array.isArray( libraries ) && libraries.length > 0 ? libraries[ libraries.length - 1 ] : '' ),
							smooth     : ( previous !== undefined ? previous.smooth : this.smooth ),
							groupStart : ( previous !== undefined ? previous.groupEnd : 0 ),
							groupEnd   : -1,
							groupCount : -1,
							inherited  : false,

							clone : function( index ) {
								var cloned = {
									index      : ( typeof index === 'number' ? index : this.index ),
									name       : this.name,
									mtllib     : this.mtllib,
									smooth     : this.smooth,
									groupStart : 0,
									groupEnd   : -1,
									groupCount : -1,
									inherited  : false
								};
								cloned.clone = this.clone.bind(cloned);
								return cloned;
							}
						};

						this.materials.push( material );

						return material;

					},

					currentMaterial : function() {

						if ( this.materials.length > 0 ) {
							return this.materials[ this.materials.length - 1 ];
						}

						return undefined;

					},

					_finalize : function( end ) {

						var lastMultiMaterial = this.currentMaterial();
						if ( lastMultiMaterial && lastMultiMaterial.groupEnd === -1 ) {

							lastMultiMaterial.groupEnd = this.geometry.vertices.length / 3;
							lastMultiMaterial.groupCount = lastMultiMaterial.groupEnd - lastMultiMaterial.groupStart;
							lastMultiMaterial.inherited = false;

						}

						// Ignore objects tail materials if no face declarations followed them before a new o/g started.
						if ( end && this.materials.length > 1 ) {

							for ( var mi = this.materials.length - 1; mi >= 0; mi-- ) {
								if ( this.materials[mi].groupCount <= 0 ) {
									this.materials.splice( mi, 1 );
								}
							}

						}

						// Guarantee at least one empty material, this makes the creation later more straight forward.
						if ( end && this.materials.length === 0 ) {

							this.materials.push({
								name   : '',
								smooth : this.smooth
							});

						}

						return lastMultiMaterial;

					}
				};

				// Inherit previous objects material.
				// Spec tells us that a declared material must be set to all objects until a new material is declared.
				// If a usemtl declaration is encountered while this new object is being parsed, it will
				// overwrite the inherited material. Exception being that there was already face declarations
				// to the inherited material, then it will be preserved for proper MultiMaterial continuation.

				if ( previousMaterial && previousMaterial.name && typeof previousMaterial.clone === "function" ) {

					var declared = previousMaterial.clone( 0 );
					declared.inherited = true;
					this.object.materials.push( declared );

				}

				this.objects.push( this.object );

			},

			finalize : function() {

				if ( this.object && typeof this.object._finalize === 'function' ) {

					this.object._finalize( true );

				}

			},

			parseVertexIndex: function ( value, len ) {

				var index = parseInt( value, 10 );
				return ( index >= 0 ? index - 1 : index + len / 3 ) * 3;

			},

			parseNormalIndex: function ( value, len ) {

				var index = parseInt( value, 10 );
				return ( index >= 0 ? index - 1 : index + len / 3 ) * 3;

			},

			parseUVIndex: function ( value, len ) {

				var index = parseInt( value, 10 );
				return ( index >= 0 ? index - 1 : index + len / 2 ) * 2;

			},

			addVertex: function ( a, b, c ) {

				var src = this.vertices;
				var dst = this.object.geometry.vertices;

				dst.push( src[ a + 0 ] );
				dst.push( src[ a + 1 ] );
				dst.push( src[ a + 2 ] );
				dst.push( src[ b + 0 ] );
				dst.push( src[ b + 1 ] );
				dst.push( src[ b + 2 ] );
				dst.push( src[ c + 0 ] );
				dst.push( src[ c + 1 ] );
				dst.push( src[ c + 2 ] );

			},

			addVertexLine: function ( a ) {

				var src = this.vertices;
				var dst = this.object.geometry.vertices;

				dst.push( src[ a + 0 ] );
				dst.push( src[ a + 1 ] );
				dst.push( src[ a + 2 ] );

			},

			addNormal : function ( a, b, c ) {

				var src = this.normals;
				var dst = this.object.geometry.normals;

				dst.push( src[ a + 0 ] );
				dst.push( src[ a + 1 ] );
				dst.push( src[ a + 2 ] );
				dst.push( src[ b + 0 ] );
				dst.push( src[ b + 1 ] );
				dst.push( src[ b + 2 ] );
				dst.push( src[ c + 0 ] );
				dst.push( src[ c + 1 ] );
				dst.push( src[ c + 2 ] );

			},

			addUV: function ( a, b, c ) {

				var src = this.uvs;
				var dst = this.object.geometry.uvs;

				dst.push( src[ a + 0 ] );
				dst.push( src[ a + 1 ] );
				dst.push( src[ b + 0 ] );
				dst.push( src[ b + 1 ] );
				dst.push( src[ c + 0 ] );
				dst.push( src[ c + 1 ] );

			},

			addUVLine: function ( a ) {

				var src = this.uvs;
				var dst = this.object.geometry.uvs;

				dst.push( src[ a + 0 ] );
				dst.push( src[ a + 1 ] );

			},

			addFace: function ( a, b, c, d, ua, ub, uc, ud, na, nb, nc, nd ) {

				var vLen = this.vertices.length;

				var ia = this.parseVertexIndex( a, vLen );
				var ib = this.parseVertexIndex( b, vLen );
				var ic = this.parseVertexIndex( c, vLen );
				var id;

				if ( d === undefined ) {

					this.addVertex( ia, ib, ic );

				} else {

					id = this.parseVertexIndex( d, vLen );

					this.addVertex( ia, ib, id );
					this.addVertex( ib, ic, id );

				}

				if ( ua !== undefined ) {

					var uvLen = this.uvs.length;

					ia = this.parseUVIndex( ua, uvLen );
					ib = this.parseUVIndex( ub, uvLen );
					ic = this.parseUVIndex( uc, uvLen );

					if ( d === undefined ) {

						this.addUV( ia, ib, ic );

					} else {

						id = this.parseUVIndex( ud, uvLen );

						this.addUV( ia, ib, id );
						this.addUV( ib, ic, id );

					}

				}

				if ( na !== undefined ) {

					// Normals are many times the same. If so, skip function call and parseInt.
					var nLen = this.normals.length;
					ia = this.parseNormalIndex( na, nLen );

					ib = na === nb ? ia : this.parseNormalIndex( nb, nLen );
					ic = na === nc ? ia : this.parseNormalIndex( nc, nLen );

					if ( d === undefined ) {

						this.addNormal( ia, ib, ic );

					} else {

						id = this.parseNormalIndex( nd, nLen );

						this.addNormal( ia, ib, id );
						this.addNormal( ib, ic, id );

					}

				}

			},

			addLineGeometry: function ( vertices, uvs ) {

				this.object.geometry.type = 'Line';

				var vLen = this.vertices.length;
				var uvLen = this.uvs.length;

				for ( var vi = 0, l = vertices.length; vi < l; vi ++ ) {

					this.addVertexLine( this.parseVertexIndex( vertices[ vi ], vLen ) );

				}

				for ( var uvi = 0, l = uvs.length; uvi < l; uvi ++ ) {

					this.addUVLine( this.parseUVIndex( uvs[ uvi ], uvLen ) );

				}

			}

		};

		state.startObject( '', false );

		return state;

	},

	parse: function ( text ) {

		console.time( 'OBJLoader' );

		var state = this._createParserState();

		if ( text.indexOf( '\r\n' ) !== - 1 ) {

			// This is faster than String.split with regex that splits on both
			text = text.replace( /\r\n/g, '\n' );

		}

		if ( text.indexOf( '\\\n' ) !== - 1) {

			// join lines separated by a line continuation character (\)
			text = text.replace( /\\\n/g, '' );

		}

		var lines = text.split( '\n' );
		var line = '', lineFirstChar = '', lineSecondChar = '';
		var lineLength = 0;
		var result = [];

		// Faster to just trim left side of the line. Use if available.
		var trimLeft = ( typeof ''.trimLeft === 'function' );

		for ( var i = 0, l = lines.length; i < l; i ++ ) {

			line = lines[ i ];

			line = trimLeft ? line.trimLeft() : line.trim();

			lineLength = line.length;

			if ( lineLength === 0 ) continue;

			lineFirstChar = line.charAt( 0 );

			// @todo invoke passed in handler if any
			if ( lineFirstChar === '#' ) continue;

			if ( lineFirstChar === 'v' ) {

				lineSecondChar = line.charAt( 1 );

				if ( lineSecondChar === ' ' && ( result = this.regexp.vertex_pattern.exec( line ) ) !== null ) {

					// 0                  1      2      3
					// ["v 1.0 2.0 3.0", "1.0", "2.0", "3.0"]

					state.vertices.push(
						parseFloat( result[ 1 ] ),
						parseFloat( result[ 2 ] ),
						parseFloat( result[ 3 ] )
					);

				} else if ( lineSecondChar === 'n' && ( result = this.regexp.normal_pattern.exec( line ) ) !== null ) {

					// 0                   1      2      3
					// ["vn 1.0 2.0 3.0", "1.0", "2.0", "3.0"]

					state.normals.push(
						parseFloat( result[ 1 ] ),
						parseFloat( result[ 2 ] ),
						parseFloat( result[ 3 ] )
					);

				} else if ( lineSecondChar === 't' && ( result = this.regexp.uv_pattern.exec( line ) ) !== null ) {

					// 0               1      2
					// ["vt 0.1 0.2", "0.1", "0.2"]

					state.uvs.push(
						parseFloat( result[ 1 ] ),
						parseFloat( result[ 2 ] )
					);

				} else {

					throw new Error( "Unexpected vertex/normal/uv line: '" + line  + "'" );

				}

			} else if ( lineFirstChar === "f" ) {

				if ( ( result = this.regexp.face_vertex_uv_normal.exec( line ) ) !== null ) {

					// f vertex/uv/normal vertex/uv/normal vertex/uv/normal
					// 0                        1    2    3    4    5    6    7    8    9   10         11         12
					// ["f 1/1/1 2/2/2 3/3/3", "1", "1", "1", "2", "2", "2", "3", "3", "3", undefined, undefined, undefined]

					state.addFace(
						result[ 1 ], result[ 4 ], result[ 7 ], result[ 10 ],
						result[ 2 ], result[ 5 ], result[ 8 ], result[ 11 ],
						result[ 3 ], result[ 6 ], result[ 9 ], result[ 12 ]
					);

				} else if ( ( result = this.regexp.face_vertex_uv.exec( line ) ) !== null ) {

					// f vertex/uv vertex/uv vertex/uv
					// 0                  1    2    3    4    5    6   7          8
					// ["f 1/1 2/2 3/3", "1", "1", "2", "2", "3", "3", undefined, undefined]

					state.addFace(
						result[ 1 ], result[ 3 ], result[ 5 ], result[ 7 ],
						result[ 2 ], result[ 4 ], result[ 6 ], result[ 8 ]
					);

				} else if ( ( result = this.regexp.face_vertex_normal.exec( line ) ) !== null ) {

					// f vertex//normal vertex//normal vertex//normal
					// 0                     1    2    3    4    5    6   7          8
					// ["f 1//1 2//2 3//3", "1", "1", "2", "2", "3", "3", undefined, undefined]

					state.addFace(
						result[ 1 ], result[ 3 ], result[ 5 ], result[ 7 ],
						undefined, undefined, undefined, undefined,
						result[ 2 ], result[ 4 ], result[ 6 ], result[ 8 ]
					);

				} else if ( ( result = this.regexp.face_vertex.exec( line ) ) !== null ) {

					// f vertex vertex vertex
					// 0            1    2    3   4
					// ["f 1 2 3", "1", "2", "3", undefined]

					state.addFace(
						result[ 1 ], result[ 2 ], result[ 3 ], result[ 4 ]
					);

				} else {

					throw new Error( "Unexpected face line: '" + line  + "'" );

				}

			} else if ( lineFirstChar === "l" ) {

				var lineParts = line.substring( 1 ).trim().split( " " );
				var lineVertices = [], lineUVs = [];

				if ( line.indexOf( "/" ) === - 1 ) {

					lineVertices = lineParts;

				} else {

					for ( var li = 0, llen = lineParts.length; li < llen; li ++ ) {

						var parts = lineParts[ li ].split( "/" );

						if ( parts[ 0 ] !== "" ) lineVertices.push( parts[ 0 ] );
						if ( parts[ 1 ] !== "" ) lineUVs.push( parts[ 1 ] );

					}

				}
				state.addLineGeometry( lineVertices, lineUVs );

			} else if ( ( result = this.regexp.object_pattern.exec( line ) ) !== null ) {

				// o object_name
				// or
				// g group_name

				// WORKAROUND: https://bugs.chromium.org/p/v8/issues/detail?id=2869
				// var name = result[ 0 ].substr( 1 ).trim();
				var name = ( " " + result[ 0 ].substr( 1 ).trim() ).substr( 1 );

				state.startObject( name );

			} else if ( this.regexp.material_use_pattern.test( line ) ) {

				// material

				state.object.startMaterial( line.substring( 7 ).trim(), state.materialLibraries );

			} else if ( this.regexp.material_library_pattern.test( line ) ) {

				// mtl file

				state.materialLibraries.push( line.substring( 7 ).trim() );

			} else if ( ( result = this.regexp.smoothing_pattern.exec( line ) ) !== null ) {

				// smooth shading

				// @todo Handle files that have varying smooth values for a set of faces inside one geometry,
				// but does not define a usemtl for each face set.
				// This should be detected and a dummy material created (later MultiMaterial and geometry groups).
				// This requires some care to not create extra material on each smooth value for "normal" obj files.
				// where explicit usemtl defines geometry groups.
				// Example asset: examples/models/obj/cerberus/Cerberus.obj

				var value = result[ 1 ].trim().toLowerCase();
				state.object.smooth = ( value === '1' || value === 'on' );

				var material = state.object.currentMaterial();
				if ( material ) {

					material.smooth = state.object.smooth;

				}

			} else {

				// Handle null terminated files without exception
				if ( line === '\0' ) continue;

				throw new Error( "Unexpected line: '" + line  + "'" );

			}

		}

		state.finalize();

		var container = new THREE.Group();
		container.materialLibraries = [].concat( state.materialLibraries );

		for ( var i = 0, l = state.objects.length; i < l; i ++ ) {

			var object = state.objects[ i ];
			var geometry = object.geometry;
			var materials = object.materials;
			var isLine = ( geometry.type === 'Line' );

			// Skip o/g line declarations that did not follow with any faces
			if ( geometry.vertices.length === 0 ) continue;

			var buffergeometry = new THREE.BufferGeometry();

			buffergeometry.addAttribute( 'position', new THREE.BufferAttribute( new Float32Array( geometry.vertices ), 3 ) );

			if ( geometry.normals.length > 0 ) {

				buffergeometry.addAttribute( 'normal', new THREE.BufferAttribute( new Float32Array( geometry.normals ), 3 ) );

			} else {

				buffergeometry.computeVertexNormals();

			}

			if ( geometry.uvs.length > 0 ) {

				buffergeometry.addAttribute( 'uv', new THREE.BufferAttribute( new Float32Array( geometry.uvs ), 2 ) );

			}

			// Create materials

			var createdMaterials = [];

			for ( var mi = 0, miLen = materials.length; mi < miLen ; mi++ ) {

				var sourceMaterial = materials[mi];
				var material = undefined;

				if ( this.materials !== null ) {

					material = this.materials.create( sourceMaterial.name );

					// mtl etc. loaders probably can't create line materials correctly, copy properties to a line material.
					if ( isLine && material && ! ( material instanceof THREE.LineBasicMaterial ) ) {

						var materialLine = new THREE.LineBasicMaterial();
						materialLine.copy( material );
						material = materialLine;

					}

				}

				if ( ! material ) {

					material = ( ! isLine ? new THREE.MeshPhongMaterial() : new THREE.LineBasicMaterial() );
					material.name = sourceMaterial.name;

				}

				material.shading = sourceMaterial.smooth ? THREE.SmoothShading : THREE.FlatShading;

				createdMaterials.push(material);

			}

			// Create mesh

			var mesh;

			if ( createdMaterials.length > 1 ) {

				for ( var mi = 0, miLen = materials.length; mi < miLen ; mi++ ) {

					var sourceMaterial = materials[mi];
					buffergeometry.addGroup( sourceMaterial.groupStart, sourceMaterial.groupCount, mi );

				}

				var multiMaterial = new THREE.MultiMaterial( createdMaterials );
				mesh = ( ! isLine ? new THREE.Mesh( buffergeometry, multiMaterial ) : new THREE.LineSegments( buffergeometry, multiMaterial ) );

			} else {

				mesh = ( ! isLine ? new THREE.Mesh( buffergeometry, createdMaterials[ 0 ] ) : new THREE.LineSegments( buffergeometry, createdMaterials[ 0 ] ) );
			}

			mesh.name = object.name;

			container.add( mesh );

		}

		console.timeEnd( 'OBJLoader' );

		return container;

	}

};

},{}],73:[function(require,module,exports){
// stats.js - http://github.com/mrdoob/stats.js
var Stats=function(){function h(a){c.appendChild(a.dom);return a}function k(a){for(var d=0;d<c.children.length;d++)c.children[d].style.display=d===a?"block":"none";l=a}var l=0,c=document.createElement("div");c.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000";c.addEventListener("click",function(a){a.preventDefault();k(++l%c.children.length)},!1);var g=(performance||Date).now(),e=g,a=0,r=h(new Stats.Panel("FPS","#0ff","#002")),f=h(new Stats.Panel("MS","#0f0","#020"));
if(self.performance&&self.performance.memory)var t=h(new Stats.Panel("MB","#f08","#201"));k(0);return{REVISION:16,dom:c,addPanel:h,showPanel:k,begin:function(){g=(performance||Date).now()},end:function(){a++;var c=(performance||Date).now();f.update(c-g,200);if(c>e+1E3&&(r.update(1E3*a/(c-e),100),e=c,a=0,t)){var d=performance.memory;t.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return c},update:function(){g=this.end()},domElement:c,setMode:k}};
Stats.Panel=function(h,k,l){var c=Infinity,g=0,e=Math.round,a=e(window.devicePixelRatio||1),r=80*a,f=48*a,t=3*a,u=2*a,d=3*a,m=15*a,n=74*a,p=30*a,q=document.createElement("canvas");q.width=r;q.height=f;q.style.cssText="width:80px;height:48px";var b=q.getContext("2d");b.font="bold "+9*a+"px Helvetica,Arial,sans-serif";b.textBaseline="top";b.fillStyle=l;b.fillRect(0,0,r,f);b.fillStyle=k;b.fillText(h,t,u);b.fillRect(d,m,n,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d,m,n,p);return{dom:q,update:function(f,
v){c=Math.min(c,f);g=Math.max(g,f);b.fillStyle=l;b.globalAlpha=1;b.fillRect(0,0,r,m);b.fillStyle=k;b.fillText(e(f)+" "+h+" ("+e(c)+"-"+e(g)+")",t,u);b.drawImage(q,d+a,m,n-a,p,d,m,n-a,p);b.fillRect(d+n-a,m,a,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d+n-a,m,a,e((1-f/v)*p))}}};"object"===typeof module&&(module.exports=Stats);

},{}],74:[function(require,module,exports){
/**
 * @author mrdoob / http://mrdoob.com
 */

THREE.PaintViveController = function ( id ) {

	THREE.ViveController.call( this, id );

	var PI2 = Math.PI * 2;

	var MODES = { COLOR: 0, SIZE: 1 };
	var mode = MODES.COLOR;

	var color = new THREE.Color( 1, 1, 1 );
	var size = 1.0;

	//

	function generateHueTexture() {

		var canvas = document.createElement( 'canvas' );
		canvas.width = 256;
		canvas.height = 256;

		var context = canvas.getContext( '2d' );
		var imageData = context.getImageData( 0, 0, 256, 256 );
		var data = imageData.data;

		for ( var i = 0, j = 0; i < data.length; i += 4, j ++ ) {

			var x = ( ( j % 256 ) / 256 ) - 0.5;
			var y = ( Math.floor( j / 256 ) / 256 ) - 0.5;

			color.setHSL( Math.atan2( y, x ) / PI2, 1,( 0.5 - Math.sqrt( x * x + y * y ) ) * 2.0 );

			data[ i + 0 ] = color.r * 256;
			data[ i + 1 ] = color.g * 256;
			data[ i + 2 ] = color.b * 256;
			data[ i + 3 ] = 256;

		}

		context.putImageData( imageData, 0, 0 );

		return new THREE.CanvasTexture( canvas );

	}

	var geometry = new THREE.CircleGeometry( 1, 32 );
	var material = new THREE.MeshBasicMaterial( { map: generateHueTexture() } );
	var mesh = new THREE.Mesh( geometry, material );
	mesh.position.set( 0, 0.005, 0.0495 );
	mesh.rotation.x = - 1.45;
	mesh.scale.setScalar( 0.02 );
	this.add( mesh )

	var geometry = new THREE.IcosahedronGeometry( 0.1, 2 );
	var material = new THREE.MeshBasicMaterial();
	material.color = color;
	var ball = new THREE.Mesh( geometry, material );
	mesh.add( ball );

	function onAxisChanged( event ) {

		if ( this.getButtonState( 'thumbpad' ) === false ) return;

		var x = event.axes[ 0 ] / 2.0;
		var y = - event.axes[ 1 ] / 2.0;

		if ( mode === MODES.COLOR ) {
			color.setHSL( Math.atan2( y, x ) / PI2, 1, ( 0.5 - Math.sqrt( x * x + y * y ) ) * 2.0 );
			ball.position.x = event.axes[ 0 ];
			ball.position.y = event.axes[ 1 ];
		}

		if ( mode === MODES.SIZE ) {
			size = y + 1;
		}

	}

	function onGripsDown( event ) {

		if ( mode === MODES.COLOR ) {
			mode = MODES.SIZE;
			mesh.visible = false;
			return;
		}

		if ( mode === MODES.SIZE ) {
			mode = MODES.COLOR;
			mesh.visible = true;
			return;
		}

	}

	this.getColor = function () { return color; };
	this.getSize = function () { return size; };

	this.addEventListener( 'axischanged', onAxisChanged );
	this.addEventListener( 'gripsdown', onGripsDown );

};

THREE.PaintViveController.prototype = Object.create( THREE.ViveController.prototype );
THREE.PaintViveController.prototype.constructor = THREE.PaintViveController;

},{}],75:[function(require,module,exports){
/**
 * @author mrdoob / http://mrdoob.com
 * @author stewdio / http://stewd.io
 */

THREE.ViveController = function ( id ) {

	THREE.Object3D.call( this );

	var scope = this;
	var gamepad;

	var axes = [ 0, 0 ];
	var thumbpadIsPressed = false;
	var triggerIsPressed = false;
	var gripsArePressed = false;
	var menuIsPressed = false;

	function findGamepad( id ) {

		// Iterate across gamepads as Vive Controllers may not be
		// in position 0 and 1.

		var gamepads = navigator.getGamepads();

		for ( var i = 0, j = 0; i < 4; i ++ ) {

			var gamepad = gamepads[ i ];

			if ( gamepad && gamepad.id === 'OpenVR Gamepad' ) {

				if ( j === id ) return gamepad;

				j ++;

			}

		}

	}

	this.matrixAutoUpdate = false;
	this.standingMatrix = new THREE.Matrix4();

	this.getGamepad = function () {

		return gamepad;

	};

	this.getButtonState = function ( button ) {

		if ( button === 'thumbpad' ) return thumbpadIsPressed;
		if ( button === 'trigger' ) return triggerIsPressed;
		if ( button === 'grips' ) return gripsArePressed;
		if ( button === 'menu' ) return menuIsPressed;

	};

	this.update = function () {

		gamepad = findGamepad( id );

		if ( gamepad !== undefined && gamepad.pose !== undefined ) {

			if ( gamepad.pose === null ) return; // No user action yet

			//  Position and orientation.

			var pose = gamepad.pose;

			if ( pose.position !== null ) scope.position.fromArray( pose.position );
			if ( pose.orientation !== null ) scope.quaternion.fromArray( pose.orientation );
			scope.matrix.compose( scope.position, scope.quaternion, scope.scale );
			scope.matrix.multiplyMatrices( scope.standingMatrix, scope.matrix );
			scope.matrixWorldNeedsUpdate = true;
			scope.visible = true;

			//  Thumbpad and Buttons.

			if ( axes[ 0 ] !== gamepad.axes[ 0 ] || axes[ 1 ] !== gamepad.axes[ 1 ] ) {

				axes[ 0 ] = gamepad.axes[ 0 ]; //  X axis: -1 = Left, +1 = Right.
				axes[ 1 ] = gamepad.axes[ 1 ]; //  Y axis: -1 = Bottom, +1 = Top.
				scope.dispatchEvent( { type: 'axischanged', axes: axes } );

			}

			if ( thumbpadIsPressed !== gamepad.buttons[ 0 ].pressed ) {

				thumbpadIsPressed = gamepad.buttons[ 0 ].pressed;
				scope.dispatchEvent( { type: thumbpadIsPressed ? 'thumbpaddown' : 'thumbpadup' } );

			}

			if ( triggerIsPressed !== gamepad.buttons[ 1 ].pressed ) {

				triggerIsPressed = gamepad.buttons[ 1 ].pressed;
				scope.dispatchEvent( { type: triggerIsPressed ? 'triggerdown' : 'triggerup' } );

			}

			if ( gripsArePressed !== gamepad.buttons[ 2 ].pressed ) {

				gripsArePressed = gamepad.buttons[ 2 ].pressed;
				scope.dispatchEvent( { type: gripsArePressed ? 'gripsdown' : 'gripsup' } );

			}

			if ( menuIsPressed !== gamepad.buttons[ 3 ].pressed ) {

				menuIsPressed = gamepad.buttons[ 3 ].pressed;
				scope.dispatchEvent( { type: menuIsPressed ? 'menudown' : 'menuup' } );

			}

		} else {

			scope.visible = false;

		}

	};

};

THREE.ViveController.prototype = Object.create( THREE.Object3D.prototype );
THREE.ViveController.prototype.constructor = THREE.ViveController;

},{}],76:[function(require,module,exports){
/**
 * @author mrdoob / http://mrdoob.com
 * Based on @tojiro's vr-samples-utils.js
 */

this.WEBVR = {

	isLatestAvailable: function () {

		console.warn( 'WEBVR: isLatestAvailable() is being deprecated. Use .isAvailable() instead.' );
		return this.isAvailable();

	},

	isAvailable: function () {

		return navigator.getVRDisplays !== undefined;

	},

	getMessage: function () {

		var message;

		if ( navigator.getVRDisplays ) {

			navigator.getVRDisplays().then( function ( displays ) {

				if ( displays.length === 0 ) message = 'WebVR supported, but no VRDisplays found.';

			} );

		} else {

			message = 'Your browser does not support WebVR. See <a href="http://webvr.info">webvr.info</a> for assistance.';

		}

		if ( message !== undefined ) {

			var container = document.createElement( 'div' );
			container.style.position = 'absolute';
			container.style.left = '0';
			container.style.top = '0';
			container.style.right = '0';
			container.style.zIndex = '999';
			container.align = 'center';

			var error = document.createElement( 'div' );
			error.style.fontFamily = 'sans-serif';
			error.style.fontSize = '16px';
			error.style.fontStyle = 'normal';
			error.style.lineHeight = '26px';
			error.style.backgroundColor = '#fff';
			error.style.color = '#000';
			error.style.padding = '10px 20px';
			error.style.margin = '50px';
			error.style.display = 'inline-block';
			error.innerHTML = message;
			container.appendChild( error );

			return container;

		}

	},

	getButton: function ( effect ) {

		var button = document.createElement( 'button' );
		button.style.position = 'absolute';
		button.style.left = 'calc(50% - 50px)';
		button.style.bottom = '20px';
		button.style.width = '100px';
		button.style.border = '0';
		button.style.padding = '8px';
		button.style.cursor = 'pointer';
		button.style.backgroundColor = '#000';
		button.style.color = '#fff';
		button.style.fontFamily = 'sans-serif';
		button.style.fontSize = '13px';
		button.style.fontStyle = 'normal';
		button.style.textAlign = 'center';
		button.style.zIndex = '999';
		button.textContent = 'ENTER VR';
		button.onclick = function() {

			effect.isPresenting ? effect.exitPresent() : effect.requestPresent();

		};

		window.addEventListener( 'vrdisplaypresentchange', function ( event ) {

			button.textContent = effect.isPresenting ? 'EXIT VR' : 'ENTER VR';

		}, false );

		return button;

	}

};

},{}],77:[function(require,module,exports){

if( !THREE.REVISION.includes( "d3x0r" ) ) {

if( Number(THREE.REVISION) === 74 ) {
}

var vector3Pool = [];
THREE.Vector3Pool = {
	new : function(x,y,z) {
		var r = vector3Pool.pop();
		if( r ) {
			r.x = x;
			r.y = y;
			r.z = z;
		}
		else{
			r = new THREE.Vector3(x,y,z);
		}
		return r;
	}
}

THREE.Vector3.prototype.delete = function() {
    vector3Pool.push( this );
    return this;
}

var vector4Pool = [];
THREE.Vector4Pool = {
	new : function(x,y,z,w) {
		var r = vector4Pool.pop();
		if( r ) {
			r.x = x;
			r.y = y;
			r.z = z;
			r.w = w;
		}
		else{
			r = new THREE.Vector4(x,y,z,w);
		}
		return r;
	}
}

THREE.Vector4.prototype.delete = function() {
    vector4Pool.push( this );
    return this;
}


/*
	INLINEFUNC( void, Rotate, ( RCOORD dAngle, P_POINT vaxis1, P_POINT vaxis2 ) )
	{
	   _POINT v1, v2;
	   _POINT vsave;
	   RCOORD dsin = (RCOORD)SIN( dAngle )
	   	  , dcos = (RCOORD)COS( dAngle );
	   MemCpy( vsave, vaxis1, sizeof( _POINT ) );
	   DOFUNC(scale)( v1, vaxis1, dcos );
	   DOFUNC(scale)( v2, vaxis2, dsin );
	   DOFUNC(sub)( vaxis1, v1, v2 );
	   DOFUNC(scale)( v2, vsave, dsin );
	   DOFUNC(scale)( v1, vaxis2, dcos );
	   DOFUNC(add)( vaxis2, v2, v1 );
	}
*/

THREE.Vector3Unit = new      THREE.Vector3(  1,  1,  1 );
THREE.Vector3Zero = new      THREE.Vector3(  0,  0,  0 );
THREE.Vector3Right = new     THREE.Vector3( -1,  0,  0 );
THREE.Vector3Backward = new  THREE.Vector3(  0,  0,  1 );
THREE.Vector3Up = new        THREE.Vector3(  0,  1,  0 );
THREE.Vector3Left = new      THREE.Vector3(  1,  0,  0 );
THREE.Vector3Forward = new   THREE.Vector3(  0,  0, -1 );
THREE.Vector3Down = new      THREE.Vector3(  0, -1,  0 );


["Vector3Unit"
,"Vector3Zero"
,"Vector3Right"
,"Vector3Backward"
,"Vector3Up"
,"Vector3Left"
,"Vector3Forward"
,"Vector3Down"].forEach( function(key){
	Object.freeze(THREE[key])
	Object.defineProperty(THREE[key], "x", { writable: false })
	Object.defineProperty(THREE[key], "y", { writable: false })
	Object.defineProperty(THREE[key], "z", { writable: false })
})

var oldProto = THREE.Matrix4.prototype;
var oldMatrixContructor = THREE.Matrix4.prototype.constructor;
THREE.Matrix4x = function() {
	this.elements = new Float32Array( [

		1, 0, 0, 0,
		0, 1, 0, 0,
		0, 0, 1, 0,
		0, 0, 0, 1

	] );

	Object.defineProperty(this, "elements", { writable:false } );


}

THREE.Matrix4.prototype.__defineGetter__( "motion", function(){
	if( !this._motion ){
        this._motion = {
        	tick : 0,
        	speed : new THREE.Vector3(),
                acceleration : new THREE.Vector3(),
                rotation : new THREE.Vector3(),
                torque : new THREE.Vector3(),
                mass : 1.0,
                move : function( m, delta ) {
					this.speed.addScaledVector( this.acceleration, delta );
					var del = this.speed.clone().multiplyScalar( delta );

					m.origin.addScaledVector( m.forward, del.z );
					m.origin.addScaledVector( m.up, del.y );
					m.origin.addScaledVector( m.left, del.x );

					this.rotation.addScaledVector( this.torque, delta );
					var this_move = this.rotation.clone().multiplyScalar( delta )
					m.rotateRelative( this_move.x, this_move.y, this_move.z );
					this_move.delete();
					del.delete();
				},
				rotate : function( m, delta ) {
					var iterations = 1;

					var max = Math.abs( this.rotation.x );
					var tmp = Math.abs( this.rotation.y );
					if( tmp > max ) {
						max = tmp;
						tmp = Math.abs( this.rotation.z );
						if( tmp > max ) {
							max = tmp;
							while( ( ( max * delta ) / iterations ) > 0.1 )
								iterations++;
						} else {
							while( ( ( max * delta ) / iterations ) > 0.1 )
								iterations++;
						}
					} else {
						tmp = Math.abs( this.rotation.z );
						if( tmp > max ) {
							max = tmp;
							while( ( ( max * delta ) / iterations ) > 0.1 )
								iterations++;
						} else {
							while( ( ( max * delta ) / iterations ) > 0.1 )
								iterations++;
						}
					}
					var delx = ( this.rotation.x * delta ) / iterations;
					var dely = ( this.rotation.y * delta ) / iterations;
					var delz = ( this.rotation.z * delta ) / iterations;
					for( var n = 0; n < iterations; n++ ) {
						m.rotateRelative( delx, dely, delz );
					}
					// delta = delta / 1000;
					/*
					   ** this is becoming a physics engine frame...
					   ** might as well just add that.
                	var delta_accel = this.acceleration.clone().multiplyScalar(delta);
					if( ( this.rotation.x > ( Math.PI / 4 ) )
					   ||( this.rotation.x < -( Math.PI / 4 ) )
					   ||( this.rotation.y > ( Math.PI / 4 ) )
					   ||( this.rotation.y < -( Math.PI / 4 ) )
					   ||( this.rotation.z > ( Math.PI / 4 ) )
					   ||( this.rotation.z < -( Math.PI / 4 ) )
					   ){
						   var max = this.rotation.x;
						   if( max < this.rotation.y )
						   	 max = this.rotation.y;
						   if( max < this.rotation.z )
						     max = this.rotation.z;
						 var min = this.rotation.x;
  						   if( min > this.rotation.y )
  						   	 max = this.rotation.y;
  						   if( min > this.rotation.z )
  						     max = this.rotation.z;
							if( min < 0 )
								if( max < -min )
									max = -min;
							var t;
							for( t = 1; t < 100; t++ )
								if( ( max / t ) < ( Math.PI / 4 ))
									break;

							delta_accel.scale( 1 / t );
					   }
					  */
				  },


			rotate : function( m, delta ) {
				var iterations = 1;

				var max = Math.abs( this.rotation.x );
				var tmp = Math.abs( this.rotation.y );
				if( tmp > max ) {
					max = tmp;
					tmp = Math.abs( this.rotation.z );
					if( tmp > max ) {
						max = tmp;
						while( ( ( max * delta ) / iterations ) > 0.1 )
							iterations++;
					} else {
						while( ( ( max * delta ) / iterations ) > 0.1 )
							iterations++;
					}
				} else {
					tmp = Math.abs( this.rotation.z );
					if( tmp > max ) {
						max = tmp;
						while( ( ( max * delta ) / iterations ) > 0.1 )
							iterations++;
					} else {
						while( ( ( max * delta ) / iterations ) > 0.1 )
							iterations++;
					}
				}
				var delx = ( this.rotation.x * delta ) / iterations;
				var dely = ( this.rotation.y * delta ) / iterations;
				var delz = ( this.rotation.z * delta ) / iterations;
				for( var n = 0; n < iterations; n++ ) {
					m.rotateRelative( delx, dely, delz );
				}
				// delta = delta / 1000;
				/*
					 ** this is becoming a physics engine frame...
					 ** might as well just add that.
								var delta_accel = this.acceleration.clone().multiplyScalar(delta);
				if( ( this.rotation.x > ( Math.PI / 4 ) )
					 ||( this.rotation.x < -( Math.PI / 4 ) )
					 ||( this.rotation.y > ( Math.PI / 4 ) )
					 ||( this.rotation.y < -( Math.PI / 4 ) )
					 ||( this.rotation.z > ( Math.PI / 4 ) )
					 ||( this.rotation.z < -( Math.PI / 4 ) )
					 ){
						 var max = this.rotation.x;
						 if( max < this.rotation.y )
							 max = this.rotation.y;
						 if( max < this.rotation.z )
							 max = this.rotation.z;
					 var min = this.rotation.x;
							 if( min > this.rotation.y )
								 max = this.rotation.y;
							 if( min > this.rotation.z )
								 max = this.rotation.z;
						if( min < 0 )
							if( max < -min )
								max = -min;
						var t;
						for( t = 1; t < 100; t++ )
							if( ( max / t ) < ( Math.PI / 4 ))
								break;

						delta_accel.scale( 1 / t );
					 }
					*/
				}

	        };
	}
	return this._motion;
} );

THREE.Matrix4.prototype.__defineGetter__( "origin", function(){
	if( !this._origin ){
		var self = this;
		this._origin = new THREE.Vector3();
		Object.defineProperty(this, "_origin", { writable:false } );
		Object.defineProperty( this._origin, "x", {
			get : function(){
				return self.elements[12];
			},
			set : function(v){
				self.elements[12] = v;
			}
		})
		Object.defineProperty( this._origin, "y", {
			get : ()=>{
				return self.elements[13];
			},
			set : (v)=>{
				self.elements[13] = v;
			}
		})
		Object.defineProperty( this._origin, "z", {
			get : ()=>{
				return self.elements[14];
			},
			set : (v)=>{
				self.elements[14] = v;
			}
		})
	}
	return this._origin;
} );




THREE.Matrix4.prototype.rotateOrtho = function( angle, axis1, axis2 ) {
		if( !angle ) return;
		// 0 = x;  0
		// 1 = y;  4
		// 2 = z;  8
		var te = this.elements;
		var sa = Math.sin( angle );
		var ca = Math.cos( angle );
        switch( axis1 )	{
			case 0: switch( axis2 ){
				case 0:
					throw new Error( "Invalid axis combination, cannot rotate axis toward itself")
				break;
				case 1:
					var save1x = te[0], save1y = te[1], save1z = te[2];
					var tmp1x = te[0] * ca, tmp1y = te[1] * ca, tmp1z = te[2] * ca;
					var tmp2x = te[4] * sa, tmp2y = te[5] * sa, tmp2z = te[6] * sa;
					te[0] = tmp1x - tmp2x; te[1] = tmp1y - tmp2y; te[2] = tmp1z - tmp2z;
					tmp2x = save1x * sa; tmp2y = save1y * sa; tmp2z = save1z * sa;
					tmp1x = te[4] * ca; tmp1y = te[5] * ca; tmp1z = te[6] * ca;
					te[4] = tmp1x + tmp2x; te[5] = tmp1y + tmp2y; te[6] = tmp1z + tmp2z;
					break;
				case 2:
					var save1x = te[0], save1y = te[1], save1z = te[2];
					var tmp1x = te[0] * ca, tmp1y = te[1] * ca, tmp1z = te[2] * ca;
					var tmp2x = te[8] * sa, tmp2y = te[9] * sa, tmp2z = te[10] * sa;
					te[0] = tmp1x - tmp2x; te[1] = tmp1y - tmp2y; te[2] = tmp1z - tmp2z;
					tmp2x = save1x * sa; tmp2y = save1y * sa; tmp2z = save1z * sa;
					tmp1x = te[8] * ca; tmp1y = te[9] * ca; tmp1z = te[10] * ca;
					te[8] = tmp1x + tmp2x; te[9] = tmp1y + tmp2y; te[10] = tmp1z + tmp2z;
					break;
			}
			break;
			case 1: switch( axis2 ){
				case 0:
					var save1x = te[4], save1y = te[5], save1z = te[6];
					var tmp1x = te[4] * ca, tmp1y = te[5] * ca, tmp1z = te[6] * ca;
					var tmp2x = te[0] * sa, tmp2y = te[1] * sa, tmp2z = te[2] * sa;
					te[4] = tmp1x - tmp2x; te[5] = tmp1y - tmp2y; te[6] = tmp1z - tmp2z;
					tmp2x = save1x * sa; tmp2y = save1y * sa; tmp2z = save1z * sa;
					tmp1x = te[0] * ca; tmp1y = te[1] * ca; tmp1z = te[2] * ca;
					te[0] = tmp1x + tmp2x; te[1] = tmp1y + tmp2y; te[2] = tmp1z + tmp2z;
					break;
				case 1:
					throw new Error( "Invalid axis combination, cannot rotate axis toward itself")
				break;
				case 2:
					var save1x = te[4], save1y = te[5], save1z = te[6];
					var tmp1x = te[4] * ca, tmp1y = te[5] * ca, tmp1z = te[6] * ca;
					var tmp2x = te[8] * sa, tmp2y = te[9] * sa, tmp2z = te[10] * sa;
					te[4] = tmp1x - tmp2x; te[5] = tmp1y - tmp2y; te[6] = tmp1z - tmp2z;
					tmp2x = save1x * sa; tmp2y = save1y * sa; tmp2z = save1z * sa;
					tmp1x = te[8] * ca; tmp1y = te[9] * ca; tmp1z = te[10] * ca;
					te[8] = tmp1x + tmp2x; te[9] = tmp1y + tmp2y; te[10] = tmp1z + tmp2z;
				break;
			}
			break;
			case 2: switch( axis2 ){
				case 0:
					var save1x = te[8], save1y = te[9], save1z = te[10];
					var tmp1x = te[8] * ca, tmp1y = te[9] * ca, tmp1z = te[10] * ca;
					var tmp2x = te[0] * sa, tmp2y = te[1] * sa, tmp2z = te[2] * sa;
					te[8] = tmp1x - tmp2x; te[9] = tmp1y - tmp2y; te[10] = tmp1z - tmp2z;
					tmp2x = save1x * sa; tmp2y = save1y * sa; tmp2z = save1z * sa;
					tmp1x = te[0] * ca; tmp1y = te[1] * ca; tmp1z = te[2] * ca;
					te[0] = tmp1x + tmp2x; te[1] = tmp1y + tmp2y; te[2] = tmp1z + tmp2z;
				break;
				case 1:
					var save1x = te[8], save1y = te[9], save1z = te[10];
					var tmp1x = te[8] * ca, tmp1y = te[9] * ca, tmp1z = te[10] * ca;
					var tmp2x = te[4] * sa, tmp2y = te[5] * sa, tmp2z = te[6] * sa;
					te[8] = tmp1x - tmp2x; te[9] = tmp1y - tmp2y; te[10] = tmp1z - tmp2z;
					tmp2x = save1x * sa; tmp2y = save1y * sa; tmp2z = save1z * sa;
					tmp1x = te[4] * ca; tmp1y = te[5] * ca; tmp1z = te[6] * ca;
					te[4] = tmp1x + tmp2x; te[5] = tmp1y + tmp2y; te[6] = tmp1z + tmp2z;
				break;
				case 2:
					throw new Error( "Invalid axis combination, cannot rotate axis toward itself")
				break;
			}
			break;
		}
    };
	THREE.Matrix4.prototype.Translate = function(x,y,z) {
			this.origin.x = x;
			this.origin.y = y;
			this.origin.z = z;
	};
	THREE.Matrix4.prototype.rotateRelative = function( x, y, z ){
		//console.trace( "rotate starts as ", this )
		if( typeof this.tick === "undefined" ) this.tick = 0;
		switch( this.tick++ ) {
			case 0:
				this.rotateOrtho( x, 1, 2 );
				this.rotateOrtho( y, 0, 2 );
				this.rotateOrtho( z, 0, 1 );
				break;
			case 1:
				this.rotateOrtho( y, 0, 2 );
				this.rotateOrtho( x, 1, 2 );
				this.rotateOrtho( z, 0, 1 );
				break;
			case 2:
				this.rotateOrtho( z, 0, 1 );
				this.rotateOrtho( x, 1, 2 );
				this.rotateOrtho( y, 0, 2 );
				break;
			case 3:
				this.rotateOrtho( x, 1, 2 );
				this.rotateOrtho( z, 0, 1 );
				this.rotateOrtho( y, 0, 2 );
				break;
			case 4:
				this.rotateOrtho( y, 0, 2 );
				this.rotateOrtho( z, 0, 1 );
				this.rotateOrtho( x, 1, 2 );
				break;
			case 5:
				this.rotateOrtho( z, 0, 1 );
				this.rotateOrtho( y, 0, 2 );
				this.rotateOrtho( x, 1, 2 );
				this.tick = 0;
				break;
		}
	};
	THREE.Matrix4.prototype.__defineGetter__( "left", function(){
        	return THREE.Vector3Pool.new( this.elements[0], this.elements[1], this.elements[2] );
        } );
	THREE.Matrix4.prototype.__defineGetter__( "right", function(){
		return THREE.Vector3Pool.new( -this.elements[0], -this.elements[1], -this.elements[2] );
	} );
	THREE.Matrix4.prototype.__defineGetter__( "up", function(){
        	return THREE.Vector3Pool.new( this.elements[4], this.elements[5], this.elements[6] );
        } );
	THREE.Matrix4.prototype.__defineGetter__( "down", function(){
		return THREE.Vector3Pool.new( -this.elements[4], -this.elements[5], -this.elements[6] );
        } );
	THREE.Matrix4.prototype.__defineGetter__( "forward", function(){
        	return THREE.Vector3Pool.new( -this.elements[8], -this.elements[9], -this.elements[10] );
        } );
	THREE.Matrix4.prototype.__defineGetter__( "backward", function(){
		return THREE.Vector3Pool.new( this.elements[8], this.elements[9], this.elements[10] );
        } );
	THREE.Matrix4.prototype.move = function (tick) {
        	if( this.motion )
				this.motion.move( this, tick );
        	//this.origin.addScaledVector( this.forward, z ).addScaledVector( this.up, y ).addScaledVector( this.left, x )
		};
	THREE.Matrix4.prototype.moveNow = function ( x,y,z ) { this.origin.addScaledVector( this.forward, z ).addScaledVector( this.up, y ).addScaledVector( this.left, x ) };
	THREE.Matrix4.prototype.moveForward = function ( n ) { this.origin.addScaledVector( this.forward, n ); };
	THREE.Matrix4.prototype.moveUp = function ( n ) { this.origin.addScaledVector( this.up, n ); };
	THREE.Matrix4.prototype.moveLeft = function ( n ) { this.origin.addScaledVector( this.left, n ); };
	THREE.Matrix4.prototype.moveBackward = function ( n ) { this.origin.addScaledVector( this.backward, n ); };
	THREE.Matrix4.prototype.moveDown = function ( n ) { this.origin.addScaledVector( this.down, n ); };
	THREE.Matrix4.prototype.moveRight = function ( n ) { this.origin.addScaledVector( this.right, n ); };

	THREE.Matrix4.prototype.__defineGetter__( "inv_left", function(){
        	return Vector3Pool.new( this.elements[0], this.elements[4], this.elements[8] );
        } );
	THREE.Matrix4.prototype.__defineGetter__( "inv_up", function(){
        	return Vector3Pool.new( this.elements[1], this.elements[5], this.elements[9] );
        } );
	THREE.Matrix4.prototype.__defineGetter__( "inv_forward", function(){
        	return Vector3Pool.new( this.elements[2], this.elements[6], this.elements[10] );
        } );

	THREE.Matrix4.prototype.getRoll = function( relativeUp ) {
		//if( !relativeUp ) relativeUp = THREE.Vector3Up;
		return Math.asin( this.right.dot( relativeUp ) );
	};
	THREE.Matrix4.prototype.getPitch = function( relativeForward ) {
		//if( !relativeForward ) relativeForward = THREE.Vector3Forward;
		return Math.asin( this.up.dot( relativeForward ) );
	};
	THREE.Matrix4.prototype.getYaw = function( relativeRight ) {
		//if( !relativeRight ) relativeRight = THREE.Vector3Right;
		return Math.asin( this.forward.dot( relativeRight ) );
	};
	THREE.Matrix4.prototype.__defineGetter__( "roll", function(){
		return this.getRoll( THREE.Vector3Up );
	} );
	THREE.Matrix4.prototype.__defineGetter__( "pitch", function(){
		return this.getPitch( THREE.Vector3Forward );
	} );
	THREE.Matrix4.prototype.__defineGetter__( "yaw", function(){
		return this.getYaw( THREE.Vector3Right );
	} );
}

},{}],78:[function(require,module,exports){

if( typeof Voxelarium === "undefined" ){
    this.Voxelarium = {};
//	var Voxelarium;
}

Voxelarium = { VERSION : "0.0.1",
  Settings : {
     VR : true,
     AltSpace : true,
      use_basic_material : true,
      use_vive : true,
  }
};

if( typeof updateVoxelariumSettings === 'function' ){
  updateVoxelariumSettings();
}

Object.freeze( Voxelarium.Settings );

if(  THREE === null ) {
//	THREE = require( "./three.js.74/build/three.js")
}
	require( "./three.js/personalFill.js")

//if( Voxelarium.Settings.AltSpace )
//   var altspace = require( "./AltSpaceVR/dist/altspace.js" );

Voxelarium.Stats = (!Voxelarium.Settings.VR)?require( './three.js/js/stats.min.js' ):function(){};
if( !Voxelarium.Settings.AltSpace && Voxelarium.Settings.VR ) {
  require( './three.js/js/controls/VRControls.js' );
  require( './three.js/js/effects/VREffect.js' );

  require( './three.js/js/vr/ViveController.js' );
  require( './three.js/js/vr/PaintViveController.js' );
  require( './three.js/js/vr/WebVR.js' );
  require( './three.js/js/loaders/OBJLoader.js' );
}

Voxelarium.clock = new THREE.Clock()


if( !Voxelarium.Settings.VR ) {
  require( "./orbit_controls.js" )
  require( "./NaturalCamera.js" )
  require( "./gameMouse.js" )
}

if( !Voxelarium.Settings.use_basic_material )
	require( "./glow.renderer.js" );

require( "./src/three.js.example/Projector.js" )
require( "./src/three.js.post/shaders/CopyShader.js")
require( "./src/three.js.post/shaders/HorizontalBlurShader.js")
require( "./src/three.js.post/shaders/VerticalBlurShader.js")
//require( "./src/three.js.post/shaders/ConvolutionShader.js")
//require( "./src/three.js.post/shaders/DotScreenShader.js")
//require( "./src/three.js.post/shaders/FilmShader.js")
require( "./src/three.js.post/EffectComposer.js")
require( "./src/three.js.post/BloomPass.js")


//require( "./src/three.js.post/AdaptiveToneMappingPass.js")
//require( "./src/three.js.post/BokehPass.js")
require( "./src/three.js.post/ClearPass.js")
//require( "./src/three.js.post/DotScreenPass.js")
//require( "./src/three.js.post/FilmPass.js")
//require( "./src/three.js.post/GlitchPass.js")
//require( "./src/three.js.post/ManualMSAARenderPass.js")
require( "./src/three.js.post/MaskPass.js")
require( "./src/three.js.post/RenderPass.js")
//require( "./src/three.js.post/SavePass.js")
require( "./src/three.js.post/ShaderPass.js")
//require( "./src/three.js.post/SMAAPass.js")
//require( "./src/three.js.post/TAARenderPass.js")
require( "./src/three.js.post/TexturePass.js")

Voxelarium.camera = new THREE.PerspectiveCamera( 90, window.innerWidth / window.innerHeight, 0.001, 10000 );
//console.log( Voxelarium.camera.projectionMatrix.toArray() )
require( "./src/voxelarium.gun.db.js" )

//--- fonts ---
Voxelarium.Fonts = {};
require( "./src/fonts/TI99.js")
//require( "./src/fonts/msyh1.js")

require( "./src/constants.js")
require( "./src/bitstream.js")  // read and write bits

require( "./src/sector.js")
require( "./src/cluster.js")
require( "./src/world.js")

require( "./src/geometrybasicbuffer.js")
require( "./src/geometrybuffer.js")
require( "./src/geometrymaterial.js")
require( "./src/geometrybuffer.mono.js")
require( "./src/geometrymaterial.mono.js")
require( "./src/textureAtlas.canvas.js")

require( "./src/voxelSelector.js")

require( "./src/sorting.tree.js")
require( "./src/mesher.basic.js")

require( "./src/voxels.js" )  // must be after atlas


require( "./src/voxel_inventory.js")  // must be after voxels
//Object.freeze( Voxelarium );
//Voxelarium.freeze();

},{"./NaturalCamera.js":1,"./gameMouse.js":2,"./glow.renderer.js":3,"./orbit_controls.js":36,"./src/bitstream.js":37,"./src/cluster.js":38,"./src/constants.js":39,"./src/fonts/TI99.js":40,"./src/geometrybasicbuffer.js":41,"./src/geometrybuffer.js":42,"./src/geometrybuffer.mono.js":43,"./src/geometrymaterial.js":44,"./src/geometrymaterial.mono.js":45,"./src/mesher.basic.js":46,"./src/sector.js":50,"./src/sorting.tree.js":51,"./src/textureAtlas.canvas.js":52,"./src/three.js.example/Projector.js":53,"./src/three.js.post/BloomPass.js":54,"./src/three.js.post/ClearPass.js":55,"./src/three.js.post/EffectComposer.js":56,"./src/three.js.post/MaskPass.js":57,"./src/three.js.post/RenderPass.js":58,"./src/three.js.post/ShaderPass.js":59,"./src/three.js.post/TexturePass.js":60,"./src/three.js.post/shaders/CopyShader.js":61,"./src/three.js.post/shaders/HorizontalBlurShader.js":62,"./src/three.js.post/shaders/VerticalBlurShader.js":63,"./src/voxelSelector.js":65,"./src/voxel_inventory.js":66,"./src/voxelarium.gun.db.js":67,"./src/voxels.js":68,"./src/world.js":69,"./three.js/js/controls/VRControls.js":70,"./three.js/js/effects/VREffect.js":71,"./three.js/js/loaders/OBJLoader.js":72,"./three.js/js/stats.min.js":73,"./three.js/js/vr/PaintViveController.js":74,"./three.js/js/vr/ViveController.js":75,"./three.js/js/vr/WebVR.js":76,"./three.js/personalFill.js":77}]},{},[78])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L1VzZXJzL1lvdXplci9BcHBEYXRhL1JvYW1pbmcvbnBtL25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJOYXR1cmFsQ2FtZXJhLmpzIiwiZ2FtZU1vdXNlLmpzIiwiZ2xvdy5yZW5kZXJlci5qcyIsIm5vZGVfbW9kdWxlcy9mb3JtaWRhYmxlL2xpYi9maWxlLmpzIiwibm9kZV9tb2R1bGVzL2Zvcm1pZGFibGUvbGliL2luY29taW5nX2Zvcm0uanMiLCJub2RlX21vZHVsZXMvZm9ybWlkYWJsZS9saWIvaW5kZXguanMiLCJub2RlX21vZHVsZXMvZm9ybWlkYWJsZS9saWIvanNvbl9wYXJzZXIuanMiLCJub2RlX21vZHVsZXMvZm9ybWlkYWJsZS9saWIvbXVsdGlwYXJ0X3BhcnNlci5qcyIsIm5vZGVfbW9kdWxlcy9mb3JtaWRhYmxlL2xpYi9vY3RldF9wYXJzZXIuanMiLCJub2RlX21vZHVsZXMvZm9ybWlkYWJsZS9saWIvcXVlcnlzdHJpbmdfcGFyc2VyLmpzIiwibm9kZV9tb2R1bGVzL2d1bi9ndW4uanMiLCJub2RlX21vZHVsZXMvZ3VuL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2d1bi9saWIvZmlsZS5qcyIsIm5vZGVfbW9kdWxlcy9ndW4vbGliL2h0dHAuanMiLCJub2RlX21vZHVsZXMvZ3VuL2xpYi9qc29ucC5qcyIsIm5vZGVfbW9kdWxlcy9ndW4vbGliL3NlcnZlci5qcyIsIm5vZGVfbW9kdWxlcy9ndW4vbGliL3dzLmpzIiwibm9kZV9tb2R1bGVzXFxndW5cXGxpYlxcamF2YXNjcmlwdFxcVm94ZWxhcml1bS5qc1xcbm9kZV9tb2R1bGVzXFxndW5cXGxpYlxcd3NwLmpzIiwibm9kZV9tb2R1bGVzL29wdGlvbnMvbGliL29wdGlvbnMuanMiLCJub2RlX21vZHVsZXMvdWx0cm9uL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3dzL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9CdWZmZXJQb29sLmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9CdWZmZXJVdGlsLmZhbGxiYWNrLmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9CdWZmZXJVdGlsLmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9FcnJvckNvZGVzLmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9FeHRlbnNpb25zLmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9QZXJNZXNzYWdlRGVmbGF0ZS5qcyIsIm5vZGVfbW9kdWxlcy93cy9saWIvUmVjZWl2ZXIuaGl4aWUuanMiLCJub2RlX21vZHVsZXMvd3MvbGliL1JlY2VpdmVyLmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9TZW5kZXIuaGl4aWUuanMiLCJub2RlX21vZHVsZXMvd3MvbGliL1NlbmRlci5qcyIsIm5vZGVfbW9kdWxlcy93cy9saWIvVmFsaWRhdGlvbi5mYWxsYmFjay5qcyIsIm5vZGVfbW9kdWxlcy93cy9saWIvVmFsaWRhdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy93cy9saWIvV2ViU29ja2V0LmpzIiwibm9kZV9tb2R1bGVzL3dzL2xpYi9XZWJTb2NrZXRTZXJ2ZXIuanMiLCJvcmJpdF9jb250cm9scy5qcyIsInNyYy9iaXRzdHJlYW0uanMiLCJzcmMvY2x1c3Rlci5qcyIsInNyYy9jb25zdGFudHMuanMiLCJzcmMvZm9udHMvVEk5OS5qcyIsInNyYy9nZW9tZXRyeWJhc2ljYnVmZmVyLmpzIiwic3JjL2dlb21ldHJ5YnVmZmVyLmpzIiwic3JjL2dlb21ldHJ5YnVmZmVyLm1vbm8uanMiLCJzcmMvZ2VvbWV0cnltYXRlcmlhbC5qcyIsInNyYy9nZW9tZXRyeW1hdGVyaWFsLm1vbm8uanMiLCJzcmMvbWVzaGVyLmJhc2ljLmpzIiwic3JjL21vZHRyYWNrZXIuanMiLCJzcmMvcGFja2VkYm9vbGFycmF5LmpzIiwic3JjL3JlYWN0b3IuanMiLCJzcmMvc2VjdG9yLmpzIiwic3JjL3NvcnRpbmcudHJlZS5qcyIsInNyYy90ZXh0dXJlQXRsYXMuY2FudmFzLmpzIiwic3JjL3RocmVlLmpzLmV4YW1wbGUvUHJvamVjdG9yLmpzIiwic3JjL3RocmVlLmpzLnBvc3QvQmxvb21QYXNzLmpzIiwic3JjL3RocmVlLmpzLnBvc3QvQ2xlYXJQYXNzLmpzIiwic3JjL3RocmVlLmpzLnBvc3QvRWZmZWN0Q29tcG9zZXIuanMiLCJzcmMvdGhyZWUuanMucG9zdC9NYXNrUGFzcy5qcyIsInNyYy90aHJlZS5qcy5wb3N0L1JlbmRlclBhc3MuanMiLCJzcmMvdGhyZWUuanMucG9zdC9TaGFkZXJQYXNzLmpzIiwic3JjL3RocmVlLmpzLnBvc3QvVGV4dHVyZVBhc3MuanMiLCJzcmMvdGhyZWUuanMucG9zdC9zaGFkZXJzL0NvcHlTaGFkZXIuanMiLCJzcmMvdGhyZWUuanMucG9zdC9zaGFkZXJzL0hvcml6b250YWxCbHVyU2hhZGVyLmpzIiwic3JjL3RocmVlLmpzLnBvc3Qvc2hhZGVycy9WZXJ0aWNhbEJsdXJTaGFkZXIuanMiLCJzcmMvdm94ZWwuZm9udHMuanMiLCJzcmMvdm94ZWxTZWxlY3Rvci5qcyIsInNyYy92b3hlbF9pbnZlbnRvcnkuanMiLCJzcmMvdm94ZWxhcml1bS5ndW4uZGIuanMiLCJzcmMvdm94ZWxzLmpzIiwic3JjL3dvcmxkLmpzIiwidGhyZWUuanMvanMvY29udHJvbHMvVlJDb250cm9scy5qcyIsInRocmVlLmpzL2pzL2VmZmVjdHMvVlJFZmZlY3QuanMiLCJ0aHJlZS5qcy9qcy9sb2FkZXJzL09CSkxvYWRlci5qcyIsInRocmVlLmpzL2pzL3N0YXRzLm1pbi5qcyIsInRocmVlLmpzL2pzL3ZyL1BhaW50Vml2ZUNvbnRyb2xsZXIuanMiLCJ0aHJlZS5qcy9qcy92ci9WaXZlQ29udHJvbGxlci5qcyIsInRocmVlLmpzL2pzL3ZyL1dlYlZSLmpzIiwidGhyZWUuanMvcGVyc29uYWxGaWxsLmpzIiwidm94ZWxhcml1bS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2huQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNpQkE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4ekVBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN0T0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDclVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3I4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDamdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2prQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbk5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4UkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3UEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3IwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1ekZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6T0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDajZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3Z1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pmQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qKlxyXG4gKiBAYXV0aG9yIGQzeDByIC8gaHR0cHM6Ly9naXRodWIuY29tL2QzeDByXHJcbiAqL1xyXG5cclxuVEhSRUUuTmF0dXJhbENvbnRyb2xzID0gZnVuY3Rpb24gKCBvYmplY3QsIGRvbUVsZW1lbnQgKSB7XHJcblxyXG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3Q7XHJcblx0dGhpcy5kb21FbGVtZW50ID0gKCBkb21FbGVtZW50ICE9PSB1bmRlZmluZWQgKSA/IGRvbUVsZW1lbnQgOiBkb2N1bWVudDtcclxuXHJcblx0dGhpcy5lbmFibGVkID0gdHJ1ZTtcclxuXHJcblx0Ly8gNjUgLypBKi8sIDgzIC8qUyovLCA2OCAvKkQqL1xyXG5cdHRoaXMua2V5cyA9IHsgTEVGVDogMzcsIFVQOiAzOCwgUklHSFQ6IDM5LCBCT1RUT006IDQwXHJcbiAgICAgICAgLCBBOjY1LCBTOjgzLCBEOjY4LCBXOjg3LCBTUEFDRTozMiwgQzo2NyB9O1xyXG5cclxuXHQvLyBpbnRlcm5hbHNcclxuXHJcblx0dmFyIHNjb3BlID0gdGhpcztcclxuXHJcblx0dmFyIHJvdGF0ZVN0YXJ0ID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcclxuXHR2YXIgcm90YXRlRW5kID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcclxuXHR2YXIgcm90YXRlRGVsdGEgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xyXG5cclxuXHR2YXIgcGhpRGVsdGEgPSAwO1xyXG5cdHZhciB0aGV0YURlbHRhID0gMDtcclxuXHR2YXIgc2NhbGUgPSAxO1xyXG5cclxuXHR2YXIgbGFzdFBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcclxuXHJcblxyXG5cclxuXHR0aGlzLnJvdGF0ZUxlZnQgPSBmdW5jdGlvbiAoIGFuZ2xlICkge1xyXG5cclxuXHRcdGlmICggYW5nbGUgPT09IHVuZGVmaW5lZCApIHtcclxuXHJcblx0XHRcdGFuZ2xlID0gZ2V0QXV0b1JvdGF0aW9uQW5nbGUoKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0dGhldGFEZWx0YSAtPSBhbmdsZTtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5yb3RhdGVSaWdodCA9IGZ1bmN0aW9uICggYW5nbGUgKSB7XHJcblxyXG5cdFx0aWYgKCBhbmdsZSA9PT0gdW5kZWZpbmVkICkge1xyXG5cclxuXHRcdFx0YW5nbGUgPSBnZXRBdXRvUm90YXRpb25BbmdsZSgpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHR0aGV0YURlbHRhICs9IGFuZ2xlO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLnJvdGF0ZVVwID0gZnVuY3Rpb24gKCBhbmdsZSApIHtcclxuXHJcblx0XHRpZiAoIGFuZ2xlID09PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0XHRhbmdsZSA9IGdldEF1dG9Sb3RhdGlvbkFuZ2xlKCk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHBoaURlbHRhIC09IGFuZ2xlO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLnJvdGF0ZURvd24gPSBmdW5jdGlvbiAoIGFuZ2xlICkge1xyXG5cclxuXHRcdGlmICggYW5nbGUgPT09IHVuZGVmaW5lZCApIHtcclxuXHJcblx0XHRcdGFuZ2xlID0gZ2V0QXV0b1JvdGF0aW9uQW5nbGUoKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0cGhpRGVsdGEgKz0gYW5nbGU7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKCB0aWNrICkge1xyXG5cclxuICAgIHRvdWNoVXBkYXRlKCk7XHJcblxyXG4gICAgaWYoIHBoaURlbHRhIClcclxuICAgICAgICB2YXIgYSA9IDM7XHJcbiAgICAgICAgc2NvcGUub2JqZWN0Lm1hdHJpeC5tb3Rpb24ucm90YXRpb24ueCA9IC1waGlEZWx0YTtcclxuICAgICAgICBzY29wZS5vYmplY3QubWF0cml4Lm1vdGlvbi5yb3RhdGlvbi55ID0gdGhldGFEZWx0YTsvLywgMCApO1xyXG5cclxuICAgICAgICAvL3Njb3BlLm9iamVjdC5tYXRyaXgucm90YXRlUmVsYXRpdmUoIC1waGlEZWx0YSwgdGhldGFEZWx0YSwgMCApO1xyXG4gICAgICAgIHNjb3BlLm9iamVjdC5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgc2NvcGUub2JqZWN0Lm1hdHJpeC5tb3ZlKCB0aWNrICk7XHJcbiAgICAgICAgc2NvcGUub2JqZWN0Lm1hdHJpeC5yb3RhdGVSZWxhdGl2ZSggMCwgMCwgLXNjb3BlLm9iamVjdC5tYXRyaXgucm9sbCApO1xyXG5cclxuICAgICAgICB0aGV0YURlbHRhID0gMDtcclxuXHRcdHBoaURlbHRhID0gMDtcclxuXHR9O1xyXG5cclxuXHJcblxyXG5cdGZ1bmN0aW9uIG9uTW91c2VEb3duKCBldmVudCApIHtcclxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcblxyXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0XHRyb3RhdGVTdGFydC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcclxuXHJcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XHJcblx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UgKTtcclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBvbk1vdXNlTW92ZSggZXZlbnQgKSB7XHJcblxyXG5cdFx0aWYgKCBzY29wZS5lbmFibGVkID09PSBmYWxzZSApIHJldHVybjtcclxuXHJcblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIHJvdGF0ZUVuZC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcclxuXHRcdHJvdGF0ZURlbHRhLnN1YlZlY3RvcnMoIHJvdGF0ZUVuZCwgcm90YXRlU3RhcnQgKTtcclxuXHJcbiAgICAgICAgcm90YXRlRGVsdGEueCA9IDMyICogKHJvdGF0ZURlbHRhLnggLyB3aW5kb3cuaW5uZXJXaWR0aClcclxuICAgICAgICByb3RhdGVEZWx0YS55ID0gMzIgKiAocm90YXRlRGVsdGEueSAvIHdpbmRvdy5pbm5lckhlaWdodClcclxuXHJcblx0XHRzY29wZS5yb3RhdGVMZWZ0KCAyICogTWF0aC5QSSAqIHJvdGF0ZURlbHRhLnggICk7XHJcblx0XHRzY29wZS5yb3RhdGVVcCggMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS55ICk7XHJcblxyXG5cdFx0cm90YXRlU3RhcnQuY29weSggcm90YXRlRW5kICk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Nb3VzZVVwKCBldmVudCApIHtcclxuXHJcblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cdFx0aWYgKCBzY29wZS51c2VyUm90YXRlID09PSBmYWxzZSApIHJldHVybjtcclxuXHJcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XHJcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UgKTtcclxuXHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Nb3VzZVdoZWVsKCBldmVudCApIHtcclxuXHJcblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cdFx0aWYgKCBzY29wZS51c2VyWm9vbSA9PT0gZmFsc2UgKSByZXR1cm47XHJcblxyXG5cdFx0dmFyIGRlbHRhID0gMDtcclxuXHJcblx0XHRpZiAoIGV2ZW50LndoZWVsRGVsdGEgKSB7IC8vIFdlYktpdCAvIE9wZXJhIC8gRXhwbG9yZXIgOVxyXG5cclxuXHRcdFx0ZGVsdGEgPSBldmVudC53aGVlbERlbHRhO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAoIGV2ZW50LmRldGFpbCApIHsgLy8gRmlyZWZveFxyXG5cclxuXHRcdFx0ZGVsdGEgPSAtIGV2ZW50LmRldGFpbDtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCBkZWx0YSA+IDAgKSB7XHJcblxyXG5cdFx0XHRzY29wZS56b29tT3V0KCk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdHNjb3BlLnpvb21JbigpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBvbktleURvd24oIGV2ZW50ICkge1xyXG5cclxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcblx0XHRpZiAoIHNjb3BlLnVzZXJQYW4gPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cclxuXHRcdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XHJcbiAgICAgICAgICAgIGNhc2Ugc2NvcGUua2V5cy5TUEFDRTpcclxuICAgICAgICAgICAgICAgIHNjb3BlLm9iamVjdC5tYXRyaXgubW90aW9uLnNwZWVkLnkgPSAxMDA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBzY29wZS5rZXlzLkM6XHJcbiAgICAgICAgICAgICAgICBzY29wZS5vYmplY3QubWF0cml4Lm1vdGlvbi5zcGVlZC55ID0gLTEwMDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIHNjb3BlLmtleXMuQTpcclxuICAgICAgICAgICAgICAgIHNjb3BlLm9iamVjdC5tYXRyaXgubW90aW9uLnNwZWVkLnggPSAtMTAwO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuVzpcclxuICAgICAgICAgICAgICAgIHNjb3BlLm9iamVjdC5tYXRyaXgubW90aW9uLnNwZWVkLnogPSAxMDA7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5TOlxyXG4gICAgICAgICAgICAgICAgc2NvcGUub2JqZWN0Lm1hdHJpeC5tb3Rpb24uc3BlZWQueiA9IC0xMDA7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5EOlxyXG4gICAgICAgICAgICAgICAgc2NvcGUub2JqZWN0Lm1hdHJpeC5tb3Rpb24uc3BlZWQueCA9IDEwMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBvbktleVVwKCBldmVudCApIHtcclxuXHJcbiAgICAgICAgc3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcclxuICAgICAgICAgICAgY2FzZSBzY29wZS5rZXlzLlNQQUNFOlxyXG4gICAgICAgICAgICAgICAgc2NvcGUub2JqZWN0Lm1hdHJpeC5tb3Rpb24uc3BlZWQueSA9IDA7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBzY29wZS5rZXlzLkM6XHJcbiAgICAgICAgICAgICAgICBzY29wZS5vYmplY3QubWF0cml4Lm1vdGlvbi5zcGVlZC55ID0gMDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSBzY29wZS5rZXlzLkE6XHJcbiAgICAgICAgICAgICAgICBzY29wZS5vYmplY3QubWF0cml4Lm1vdGlvbi5zcGVlZC54ID0gMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLlc6XHJcbiAgICAgICAgICAgICAgICBzY29wZS5vYmplY3QubWF0cml4Lm1vdGlvbi5zcGVlZC56ID0gMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLlM6XHJcbiAgICAgICAgICAgICAgICBzY29wZS5vYmplY3QubWF0cml4Lm1vdGlvbi5zcGVlZC56ID0gMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLkQ6XHJcbiAgICAgICAgICAgICAgICBzY29wZS5vYmplY3QubWF0cml4Lm1vdGlvbi5zcGVlZC54ID0gMDtcclxuXHRcdFx0XHRicmVhaztcclxuICAgICAgICB9XHJcblx0XHQvL3N3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XHJcblxyXG5cdFx0Ly9cdFx0YnJlYWs7XHJcblx0XHQvL31cclxuXHJcblx0fVxyXG5cclxudmFyIHRvdWNoZXMgPSBbXTtcclxuXHJcblRvdWNoTGlzdC5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGMpeyBmb3IoIHZhciBuID0gMDsgbiA8IHRoaXMubGVuZ3RoOyBuKysgKSBjKHRoaXNbbl0pOyB9XHJcblxyXG5mdW5jdGlvbiB0b3VjaFVwZGF0ZSgpIHtcclxuICBpZiggdG91Y2hlcy5sZW5ndGggPT0gMSApe1xyXG4gICAgdmFyIHQgPSB0b3VjaGVzWzBdO1xyXG4gICAgaWYoIHQubmV3IClcclxuICAgIHtcclxuICAgICAgcm90YXRlU3RhcnQuc2V0KCB0LngsIHQueSApO1xyXG4gICAgICB0Lm5ldyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcblxyXG4gICAgICAgICAgICByb3RhdGVFbmQuc2V0KCB0LngsIHQueSApO1xyXG4gICAgICBcdFx0cm90YXRlRGVsdGEuc3ViVmVjdG9ycyggcm90YXRlRW5kLCByb3RhdGVTdGFydCApO1xyXG5cclxuICAgICAgICAgICAgcm90YXRlRGVsdGEueCA9IC0yICogKHJvdGF0ZURlbHRhLnggLyB3aW5kb3cuaW5uZXJXaWR0aClcclxuICAgICAgICAgICAgcm90YXRlRGVsdGEueSA9IC0gMiAqIChyb3RhdGVEZWx0YS55IC8gd2luZG93LmlubmVySGVpZ2h0KVxyXG4gICAgICBcdFx0c2NvcGUucm90YXRlTGVmdCggTWF0aC5QSS8yICogcm90YXRlRGVsdGEueCAgICk7XHJcbiAgICAgIFx0XHRzY29wZS5yb3RhdGVVcCggTWF0aC5QSS8yICogcm90YXRlRGVsdGEueSApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyggcm90YXRlRGVsdGEgKVxyXG4gICAgICBcdFx0cm90YXRlU3RhcnQuY29weSggcm90YXRlRW5kICk7XHJcblxyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb25Ub3VjaFN0YXJ0KCBlICkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBlLmNoYW5nZWRUb3VjaGVzLmZvckVhY2goICh0b3VjaCk9PntcclxuICAgIHRvdWNoZXMucHVzaCgge0lEOnRvdWNoLmlkZW50aWZpZXIsXHJcbiAgICAgIHggOiB0b3VjaC5jbGllbnRYLFxyXG4gICAgICB5IDogdG91Y2guY2xpZW50WSxcclxuICAgICAgbmV3IDogdHJ1ZVxyXG4gICAgfSlcclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBvblRvdWNoTW92ZSggZSApIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgZS5jaGFuZ2VkVG91Y2hlcy5mb3JFYWNoKCAodG91Y2hDaGFuZ2VkKT0+e1xyXG4gICAgdmFyIHRvdWNoID0gdG91Y2hlcy5maW5kKCAodCk9PiB0LklEID09PSB0b3VjaENoYW5nZWQuaWRlbnRpZmllciApO1xyXG4gICAgaWYoIHRvdWNoICkge1xyXG4gICAgICB0b3VjaC54ID0gdG91Y2hDaGFuZ2VkLmNsaWVudFg7XHJcbiAgICAgIHRvdWNoLnkgPSB0b3VjaENoYW5nZWQuY2xpZW50WTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG5mdW5jdGlvbiBvblRvdWNoRW5kKCBlICkge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBlLmNoYW5nZWRUb3VjaGVzLmZvckVhY2goICh0b3VjaENoYW5nZWQpPT57XHJcbiAgICB2YXIgdG91Y2hJbmRleCA9IHRvdWNoZXMuZmluZEluZGV4KCAodCk9PiB0LklEID09PSB0b3VjaENoYW5nZWQuaWRlbnRpZmllciApO1xyXG4gICAgaWYoIHRvdWNoSW5kZXggPj0gMCApXHJcbiAgICAgICB0b3VjaGVzLnNwbGljZSggdG91Y2hJbmRleCwgMSApXHJcbiAgfSlcclxufVxyXG5cclxuICAgIGZ1bmN0aW9uIGlnbm9yZShldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcclxuICAgIFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnY29udGV4dG1lbnUnLCBpZ25vcmUsIGZhbHNlICk7XHJcbiAgICBcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIG9uTW91c2VEb3duLCBmYWxzZSApO1xyXG4gICAgXHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZXdoZWVsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApO1xyXG4gICAgXHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdET01Nb3VzZVNjcm9sbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTsgLy8gZmlyZWZveFxyXG4gICAgXHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBvbktleURvd24sIGZhbHNlICk7XHJcbiAgICBcdHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAna2V5dXAnLCBvbktleVVwLCBmYWxzZSApO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZW5hYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICBcdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ2NvbnRleHRtZW51JywgaWdub3JlLCBmYWxzZSApO1xyXG4gICAgXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBvbk1vdXNlRG93biwgZmFsc2UgKTtcclxuICAgIFx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V3aGVlbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTtcclxuICAgICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2hzdGFydCcsIG9uVG91Y2hTdGFydCwgZmFsc2UgKTtcclxuICAgICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2htb3ZlJywgb25Ub3VjaE1vdmUsIGZhbHNlICk7XHJcbiAgICAgIHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoZW5kJywgb25Ub3VjaEVuZCwgZmFsc2UgKTtcclxuXHJcbiAgICBcdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ0RPTU1vdXNlU2Nyb2xsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApOyAvLyBmaXJlZm94XHJcbiAgICBcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIG9uS2V5RG93biwgZmFsc2UgKTtcclxuICAgIFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdrZXl1cCcsIG9uS2V5VXAsIGZhbHNlICk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmVuYWJsZSgpO1xyXG5cclxufTtcclxuXHJcbi8vVEhSRUUuTmF0dXJhbENhbWVyYS5cclxuXHJcblRIUkVFLk5hdHVyYWxDb250cm9scy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBUSFJFRS5FdmVudERpc3BhdGNoZXIucHJvdG90eXBlICk7XHJcbiIsIlxyXG5cclxudmFyIGNhc3RpbmcgPSB7XHJcbiAgICByZXNldDogZnVuY3Rpb24oKSB7IHRoaXMuY3ViZXMgPSAwOyB9LFxyXG4gICAgbWF0ZXJpYWwgOiBuZXcgVEhSRUUuTGluZUJhc2ljTWF0ZXJpYWwoe2NvbG9yOidibHVlJyxsaW5ld2lkdGg6M30pLFxyXG4gICAgZ2VvbWV0cnkgOiBuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnksXHJcbiAgICBtZXNoIDogbnVsbCxcclxuICAgIGFkZFJlZiA6IG51bGwsXHJcbiAgICBjdWJlcyA6IDBcclxufTtcclxuY2FzdGluZy5nZW9tZXRyeS5keW5hbWljID0gdHJ1ZTtcclxuY2FzdGluZy5tZXNoID0gbmV3IFRIUkVFLkxpbmVTZWdtZW50cyggY2FzdGluZy5nZW9tZXRyeSwgY2FzdGluZy5tYXRlcmlhbCApO1xyXG4gY2FzdGluZy5tZXNoLmZydXN0dW1DdWxsZWQgPSBmYWxzZTtcclxuIHZhciB2ZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkoIDUwMCAqIDMgKTsgLy8gMyB2ZXJ0aWNlcyBwZXIgcG9pbnRcclxuY2FzdGluZy5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdwb3NpdGlvbicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoIHZlcnRpY2VzLCAzICkgKVxyXG5cclxuY2FzdGluZy5hZGRSZWYgPSBmdW5jdGlvbiB1cGRhdGVDYXN0TWVzaCggY3VycmVudFJlZikge1xyXG4gIHtcclxuICAgIHZhciB1bml0ID0gY3VycmVudFJlZi5jbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICB2YXIgeCA9IGN1cnJlbnRSZWYud3ggKiB1bml0XHJcbiAgICB2YXIgeSA9IGN1cnJlbnRSZWYud3kgKiB1bml0XHJcbiAgICB2YXIgeiA9IGN1cnJlbnRSZWYud3ogKiB1bml0XHJcbiAgfVxyXG4gIHZhciBQID0gW25ldyBUSFJFRS5WZWN0b3IzKCB4LCB5LCB6IClcclxuICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHggKyB1bml0LCB5LCB6IClcclxuICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHgsIHkgKyB1bml0LCB6IClcclxuICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHggKyB1bml0LCB5ICsgdW5pdCwgeiApXHJcbiAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4LCB5LCB6ICsgdW5pdCApXHJcbiAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4ICsgdW5pdCwgeSwgeiArIHVuaXQgKVxyXG4gICAgLCBuZXcgVEhSRUUuVmVjdG9yMyggeCwgeSArIHVuaXQsIHogKyB1bml0IClcclxuICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHggKyB1bml0LCB5ICsgdW5pdCwgeiArIHVuaXQgKVxyXG4gICAgXVxyXG4gICAgdmFyIGdlb21ldHJ5ID0gY2FzdGluZy5nZW9tZXRyeTtcclxuICAgIC8vICAgIGNvbnNvbGUubG9nKCBcImFkZFwiLCB4LCB5LCB6IClcclxuICAgIHZhciB2ID0gY2FzdGluZy5jdWJlcyAqIDI0KjM7XHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFswXS54OyB2ZXJ0aWNlc1t2KytdID0gUFswXS55OyB2ZXJ0aWNlc1t2KytdID0gUFswXS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbMV0ueDsgdmVydGljZXNbdisrXSA9IFBbMV0ueTsgdmVydGljZXNbdisrXSA9IFBbMV0uejtcclxuICAgIHZlcnRpY2VzW3YrK10gPSBQWzFdLng7IHZlcnRpY2VzW3YrK10gPSBQWzFdLnk7IHZlcnRpY2VzW3YrK10gPSBQWzFdLno7XHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFszXS54OyB2ZXJ0aWNlc1t2KytdID0gUFszXS55OyB2ZXJ0aWNlc1t2KytdID0gUFszXS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbM10ueDsgdmVydGljZXNbdisrXSA9IFBbM10ueTsgdmVydGljZXNbdisrXSA9IFBbM10uejtcclxuICAgIHZlcnRpY2VzW3YrK10gPSBQWzJdLng7IHZlcnRpY2VzW3YrK10gPSBQWzJdLnk7IHZlcnRpY2VzW3YrK10gPSBQWzJdLno7XHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFsyXS54OyB2ZXJ0aWNlc1t2KytdID0gUFsyXS55OyB2ZXJ0aWNlc1t2KytdID0gUFsyXS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbMF0ueDsgdmVydGljZXNbdisrXSA9IFBbMF0ueTsgdmVydGljZXNbdisrXSA9IFBbMF0uejtcclxuXHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFs0XS54OyB2ZXJ0aWNlc1t2KytdID0gUFs0XS55OyB2ZXJ0aWNlc1t2KytdID0gUFs0XS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbNV0ueDsgdmVydGljZXNbdisrXSA9IFBbNV0ueTsgdmVydGljZXNbdisrXSA9IFBbNV0uejtcclxuICAgIHZlcnRpY2VzW3YrK10gPSBQWzVdLng7IHZlcnRpY2VzW3YrK10gPSBQWzVdLnk7IHZlcnRpY2VzW3YrK10gPSBQWzVdLno7XHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFs3XS54OyB2ZXJ0aWNlc1t2KytdID0gUFs3XS55OyB2ZXJ0aWNlc1t2KytdID0gUFs3XS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbN10ueDsgdmVydGljZXNbdisrXSA9IFBbN10ueTsgdmVydGljZXNbdisrXSA9IFBbN10uejtcclxuICAgIHZlcnRpY2VzW3YrK10gPSBQWzZdLng7IHZlcnRpY2VzW3YrK10gPSBQWzZdLnk7IHZlcnRpY2VzW3YrK10gPSBQWzZdLno7XHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFs2XS54OyB2ZXJ0aWNlc1t2KytdID0gUFs2XS55OyB2ZXJ0aWNlc1t2KytdID0gUFs2XS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbNF0ueDsgdmVydGljZXNbdisrXSA9IFBbNF0ueTsgdmVydGljZXNbdisrXSA9IFBbNF0uejtcclxuXHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFswXS54OyB2ZXJ0aWNlc1t2KytdID0gUFswXS55OyB2ZXJ0aWNlc1t2KytdID0gUFswXS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbNF0ueDsgdmVydGljZXNbdisrXSA9IFBbNF0ueTsgdmVydGljZXNbdisrXSA9IFBbNF0uejtcclxuICAgIHZlcnRpY2VzW3YrK10gPSBQWzFdLng7IHZlcnRpY2VzW3YrK10gPSBQWzFdLnk7IHZlcnRpY2VzW3YrK10gPSBQWzFdLno7XHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFs1XS54OyB2ZXJ0aWNlc1t2KytdID0gUFs1XS55OyB2ZXJ0aWNlc1t2KytdID0gUFs1XS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbMl0ueDsgdmVydGljZXNbdisrXSA9IFBbMl0ueTsgdmVydGljZXNbdisrXSA9IFBbMl0uejtcclxuICAgIHZlcnRpY2VzW3YrK10gPSBQWzZdLng7IHZlcnRpY2VzW3YrK10gPSBQWzZdLnk7IHZlcnRpY2VzW3YrK10gPSBQWzZdLno7XHJcbiAgICB2ZXJ0aWNlc1t2KytdID0gUFszXS54OyB2ZXJ0aWNlc1t2KytdID0gUFszXS55OyB2ZXJ0aWNlc1t2KytdID0gUFszXS56O1xyXG4gICAgdmVydGljZXNbdisrXSA9IFBbN10ueDsgdmVydGljZXNbdisrXSA9IFBbN10ueTsgdmVydGljZXNbdisrXSA9IFBbN10uejtcclxuICAgIHRoaXMuY3ViZXMrKztcclxuICAgIGdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlXHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlc05lZWRVcGRhdGUgPSB0cnVlO1xyXG59XHJcblxyXG5cclxuXHJcblRIUkVFLkdhbWVNb3VzZSA9IGZ1bmN0aW9uICggb2JqZWN0LCBkb21FbGVtZW50ICkge1xyXG4gICAgdGhpcy5vYmplY3QgPSBvYmplY3Q7XHJcblx0dGhpcy5kb21FbGVtZW50ID0gKCBkb21FbGVtZW50ICE9PSB1bmRlZmluZWQgKSA/IGRvbUVsZW1lbnQgOiBkb2N1bWVudDtcclxuICAgIHRoaXMuY2FzdGluZyA9IGNhc3Rpbmc7XHJcbiAgdGhpcy5jYW1lcmEgPSBudWxsO1xyXG4gIHZhciBzY29wZSA9IHRoaXM7XHJcbiAgdGhpcy5tb2RlID0gMDtcclxuICB0aGlzLnZveGVsU2VsZWN0b3IgPSBudWxsO1xyXG4gIHRoaXMuY2x1c3RlcnMgPSBudWxsO1xyXG4gIHRoaXMubW91c2VSYXkgPSB7IG4gOiBUSFJFRS5WZWN0b3IzWmVyby5jbG9uZSgpLCBvOiBuZXcgVEhSRUUuVmVjdG9yMygpLmRlbGV0ZSgpIH1cclxuICB0aGlzLm1vdXNlQ2xvY2sgPSBuZXcgVEhSRUUuQ2xvY2soKTtcclxuICB0aGlzLm1vdXNlRXZlbnRzID0gW107XHJcbiAgdGhpcy5jdXJyZW50QWRkVHlwZSA9IFZveGVsYXJpdW0uVm94ZWxzLnR5cGVzWzJdO1xyXG5cclxuICB2YXIgbW91c2VCdXR0b25Db3VudCA9IDA7XHJcbiAgdmFyIG1vdXNlU2Nyb2xsWCA9IDA7XHJcbiAgdmFyIG1vdXNlU2Nyb2xsWSA9IDA7XHJcbiAgdmFyIGN1cnNvckRpc3RhbmNlID0gNjUwO1xyXG5cclxuICB0aGlzLnNldEN1cnJlbnRUeXBlID0gZnVuY3Rpb24oIHR5cGUgKSB7XHJcbiAgICAgIHRoaXMuY3VycmVudEFkZFR5cGUgPSB0eXBlO1xyXG4gIH1cclxuICB0aGlzLnNldE1vdXNlUmF5ID0gZnVuY3Rpb24oIGNhbWVyYSwgZSApIHtcclxuICAgICAgLy8jZGVmaW5lIEJFR0lOX1NDQUxFIDFcclxuICAgICAgdmFyIHJlY3QgPSBzY29wZS5kb21FbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICBjb25zdCB3ID0gcmVjdC5yaWdodC1yZWN0LmxlZnQ7Ly93aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgY29uc3QgaCA9IHJlY3QuYm90dG9tLXJlY3QudG9wOy8vd2luZG93LmlubmVySGVpZ2h0O1xyXG4gICAgICB2YXIgeCA9ICgoKGUuY2xpZW50WC1yZWN0LmxlZnQpLSh3LzIuMCkpL3cpICogMjtcclxuICAgICAgdmFyIHkgPSAoKChlLmNsaWVudFktcmVjdC50b3ApLShoLzIuMCkpL2gpICogMjtcclxuICAgICAgLy9jb25zb2xlLmxvZyggYG1vdXNlIGF0ICR7eH0sICR7eX1gIClcclxuXHJcbiAgICAgIHZhciBtb3VzZV9yYXlfc2xvcGUgPSBjYW1lcmEubWF0cml4LmxlZnQuY2xvbmUoKS5tdWx0aXBseVNjYWxhciggeCpjYW1lcmEuYXNwZWN0ICk7XHJcbiAgICAgIG1vdXNlX3JheV9zbG9wZS5hZGRTY2FsZWRWZWN0b3IoIGNhbWVyYS5tYXRyaXgudXAsIC0oeSkgKTtcclxuXHJcbiAgICAgIC8vIDAuNDcgaXMgc29tZSBtYWdpYyBudW1iZXIgZm9yIDkwIGRlZ3JlZSBGT1ZcclxuICAgICAgLy9tb3VzZV9yYXlfc2xvcGUuYWRkU2NhbGVkVmVjdG9yKCBjYW1lcmEubWF0cml4LmZvcndhcmQsIC0wLjQ3ICk7XHJcbiAgICAgIC8vIDc1IGRlZ3JlZSB2aWV3IGFuZCBsaWtlIDMvNCBhc3BlY3RcclxuICAgICAgLy9tb3VzZV9yYXlfc2xvcGUuYWRkU2NhbGVkVmVjdG9yKCBjYW1lcmEubWF0cml4LmZvcndhcmQsIC0wLjYwNSApOy8vLU1hdGguc3FydCgxIC0gbW91c2VfcmF5X3Nsb3BlLmxlbmd0aCgpKSApO1xyXG4gICAgICBtb3VzZV9yYXlfc2xvcGUuYWRkU2NhbGVkVmVjdG9yKCBjYW1lcmEubWF0cml4LmJhY2t3YXJkLCAtMS4zMDQpOy8vMC42NTIgKTsvLy1NYXRoLnNxcnQoMSAtIG1vdXNlX3JheV9zbG9wZS5sZW5ndGgoKSkgKTtcclxuXHJcbiAgICAgIC8vbW91c2VfcmF5X3Nsb3BlLnVucHJvamVjdCggY2FtZXJhICk7XHJcblxyXG4gICAgICAvL3ZhciBtb3VzZV9yYXlfdGFyZ2V0ID0gVEhSRUUuVmVjdG9yM1plcm8uY2xvbmUoKS5hZGRTY2FsZWRWZWN0b3IoIFRIUkVFLlZlY3RvcjNGb3J3YXJkLCAxMDAwICk7XHJcbiAgICAgIC8vbW91c2VfcmF5X3RhcmdldC5hZGRTY2FsZWRWZWN0b3IoIFRIUkVFLlZlY3RvcjNMZWZ0LCAgY2FtZXJhLmFzcGVjdCoxMDAwKnggKTtcclxuICAgICAgLy9tb3VzZV9yYXlfdGFyZ2V0LmFkZFNjYWxlZFZlY3RvciggVEhSRUUuVmVjdG9yM1VwLCAtKDEwMDApKnkgKTtcclxuXHJcbiAgICAgIC8vbW91c2VfcmF5X29yaWdpbi5hcHBseU1hdHJpeDQoIGNhbWVyYS5tYXRyaXggKTtcclxuICAgICAgLy9tb3VzZV9yYXlfdGFyZ2V0LmFwcGx5TWF0cml4NCggY2FtZXJhLm1hdHJpeCApO1xyXG5cclxuICAgICAgLy92YXIgbW91c2VfcmF5X3Nsb3BlID0gbW91c2VfcmF5X3RhcmdldC5jbG9uZSgpLnN1YiggbW91c2VfcmF5X29yaWdpbiApO1xyXG4gICAgICAvL21vdXNlX3JheV9zbG9wZS5zdWIoY2FtZXJhLm1hdHJpeC5vcmlnaW4pO1xyXG4gIFx0ICBtb3VzZV9yYXlfc2xvcGUubm9ybWFsaXplKCk7XHJcbiAgICAgIC8vbW91c2VfcmF5X29yaWdpbi5kZWxldGUoKTtcclxuICAgICAgc2NvcGUubW91c2VSYXkubi5kZWxldGUoKTtcclxuXHJcbiAgICAgIHNjb3BlLm1vdXNlUmF5Lm4gPSBtb3VzZV9yYXlfc2xvcGU7XHJcbiAgICAgIHNjb3BlLm1vdXNlUmF5Lm8gPSBjYW1lcmEubWF0cml4Lm9yaWdpbjtcclxuICB9XHJcblxyXG4gIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpZiggIXNjb3BlLmNsdXN0ZXJzIClcclxuICAgICAgcmV0dXJuO1xyXG4gICAgIHN3aXRjaCggc2NvcGUubW9kZSApXHJcbiAgICAge1xyXG4gICAgIGNhc2UgMDpcclxuICAgICAgICB2YXIgY2x1c3RlciA9IHNjb3BlLmNsdXN0ZXJzWzBdO1xyXG4gICAgICAgIGlmKCBtb3VzZVNjcm9sbFkgKSB7XHJcbiAgICAgICAgICAgIGN1cnNvckRpc3RhbmNlICs9ICggbW91c2VTY3JvbGxZIC8gMTIwICkgKiBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICAgICAgICAgIG1vdXNlU2Nyb2xsWSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKCBzY29wZS5tb3VzZVJheSApIHtcclxuICAgICAgICAgICAgdmFyIG8gPSBzY29wZS5tb3VzZVJheS5vO1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xyXG4gICAgICAgICAgICByZXN1bHQgPSByYXlDYXN0KCBjbHVzdGVyLCBzY29wZS5tb3VzZVJheS5vLCBzY29wZS5tb3VzZVJheS5uIClcclxuXHJcbiAgICAgICAgICAgIGlmKCBWb3hlbGFyaXVtLnNlbGVjdG9yLmN1cnJlbnRWb3hlbCApXHJcbiAgICAgICAgICAgICAgVm94ZWxhcml1bS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwuZGVsZXRlKCk7XHJcblxyXG4gICAgICAgICAgICBpZiggcmVzdWx0ICkge1xyXG4gICAgICAgICAgICAgICAgVm94ZWxhcml1bS5zZWxlY3Rvci5jdXJyZW50QWRkVm94ZWwgPSBjbHVzdGVyLmdldFZveGVsUmVmKCBmYWxzZSwgcmVzdWx0LlByZWRQb2ludGVkVm94ZWwueCwgcmVzdWx0LlByZWRQb2ludGVkVm94ZWwueSwgcmVzdWx0LlByZWRQb2ludGVkVm94ZWwueiApXHJcbiAgICAgICAgICAgICAgVm94ZWxhcml1bS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwgPSByZXN1bHQucmVmO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLyogdGhpcyB3YXMgYW5vdGhlciB3YXkgb2YgZ2V0dGluZyB2b3hlbHMuLi4gcmF5Y2FzdCBpcyB0aGUgcm91dGluZSBmb3IgdGhpcyBub3c/XHJcbiAgICAgICAgICAgIHJheUNhc3QgcHJvamVjdHMgYSBsaW5lIHRocm91Z2ggZWFjaCBwbGFuZSBnb2luZyBnb2luZyBvdXQsIGFuZCBpcyBtb3JlIGFjY3VyYXRlIHRoYW4gdGhpcy5cclxuICAgICAgICAgICAgUGx1cyByYXlDYXN0IGNhbiByZXR1cm4gdGhlIHNpZGUgb2YgZGV0ZWN0aW9uLiAqL1xyXG4gICAgICAgICAgaWYoIGZhbHNlICl7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHZveCA9IG8uY2xvbmUoKS5hZGRTY2FsZWRWZWN0b3IoIHNjb3BlLm1vdXNlUmF5Lm4sIGN1cnNvckRpc3RhbmNlICkuZGVsZXRlKClcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdnJUbyA9IFZveGVsYXJpdW0uVm94ZWxSZWYoIGNsdXN0ZXIsIG51bGxcclxuICAgICAgICAgICAgICAgICAgICAsIE1hdGguZmxvb3Iodm94LngvY2x1c3Rlci52b3hlbFVuaXRTaXplKVxyXG4gICAgICAgICAgICAgICAgICAgICwgTWF0aC5mbG9vcih2b3gueS9jbHVzdGVyLnZveGVsVW5pdFNpemUpXHJcbiAgICAgICAgICAgICAgICAgICAgLCBNYXRoLmZsb29yKHZveC56L2NsdXN0ZXIudm94ZWxVbml0U2l6ZSkgKTtcclxuICAgICAgICAgICAgICAgIHZhciB2ckZyb20gPSBWb3hlbGFyaXVtLlZveGVsUmVmKCBjbHVzdGVyLCBudWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICwgTWF0aC5mbG9vcihvLngvY2x1c3Rlci52b3hlbFVuaXRTaXplKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAsIE1hdGguZmxvb3Ioby55L2NsdXN0ZXIudm94ZWxVbml0U2l6ZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLCBNYXRoLmZsb29yKG8uei9jbHVzdGVyLnZveGVsVW5pdFNpemUpICk7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCBcInRoaW5ncyBhcmUgXCIsIHZyVG8sIHZyRnJvbSApXHJcbiAgICAgICAgICAgICAgICAvL3RoaXMuY2FzdGluZy5yZXNldCgpO1xyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyggXCItLS0tLS0tLS0tIG5ldyBzZXQgLS0tLS0tLS0tLS0gXCIpXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVmID0gdnJGcm9tLmZvckVhY2goIHZyVG8sIGZhbHNlLCAocmVmKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcy5jYXN0aW5nLmFkZFJlZiggcmVmICk7XHJcbiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coIGBjaGVjayBhdCBgLCByZWYud3gsIHJlZi53eSwgcmVmLnd6IClcclxuICAgICAgICAgICAgICAgICAgaWYoIHJlZi52b3hlbFR5cGUgJiYgIXJlZi52b3hlbFR5cGUucHJvcGVydGllcy5Jc19QbGF5ZXJDYW5QYXNzVGhyb3VnaCApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZjtcclxuICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLy9pZiggcmVmICkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy5jYXN0aW5nLmdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgdGhpcy5jYXN0aW5nLmdlb21ldHJ5LnNldERyYXdSYW5nZSggMCwgKHRoaXMuY2FzdGluZy5jdWJlcy0xKSoyNCApO1xyXG4gICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICBpZiggcmVmICkge1xyXG4gICAgICAgICAgICAgICAgICBWb3hlbGFyaXVtLnNlbGVjdG9yLmN1cnJlbnRWb3hlbCA9IHJlZjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgIFZveGVsYXJpdW0uc2VsZWN0b3IuY3VycmVudFZveGVsID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggdHJ1ZSwgdm94LngsIHZveC55LCB2b3gueiApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdnJUby5kZWxldGUoKTtcclxuICAgICAgICAgICAgICAgIHZyRnJvbS5kZWxldGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYoIHNjb3BlLm1vdXNlRXZlbnRzICkge1xyXG4gICAgICAgICAgICB2YXIgbUV2ZW50ID0gc2NvcGUubW91c2VFdmVudHMuc2hpZnQoKTtcclxuICAgICAgICAgICAgaWYoIG1FdmVudCApIHtcclxuICAgICAgICAgICAgICAgIGlmKCBtRXZlbnQuZG93biApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiggbUV2ZW50LmJ1dHRvbiA9PT0gMCApIHsgLy8gbGVmdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmID0gVm94ZWxhcml1bS5zZWxlY3Rvci5jdXJyZW50QWRkVm94ZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCByZWYgJiYgcmVmLnNlY3RvciApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmLnNlY3Rvci5zZXRDdWJlKCByZWYueCwgcmVmLnksIHJlZi56LCBzY29wZS5jdXJyZW50QWRkVHlwZSApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWYuY2x1c3Rlci5tZXNoZXIuU2VjdG9yVXBkYXRlRmFjZUN1bGxpbmcoIHJlZi5zZWN0b3IsIHRydWUgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9iYXNpY01lc2hlci5TZWN0b3JVcGRhdGVGYWNlQ3VsbGluZ19QYXJ0aWFsKCBjbHVzdGVyLCBzZWN0b3IsIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwsIHRydWUgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmLmNsdXN0ZXIubWVzaGVyLk1ha2VTZWN0b3JSZW5kZXJpbmdEYXRhKCByZWYuc2VjdG9yICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWb3hlbGFyaXVtLmRiLndvcmxkLnN0b3JlU2VjdG9yKCByZWYuc2VjdG9yICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBtRXZlbnQuYnV0dG9uID09PSAyICkgeyAvLyByaWdodFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmID0gVm94ZWxhcml1bS5zZWxlY3Rvci5jdXJyZW50Vm94ZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCByZWYgJiYgcmVmLnNlY3RvciApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmLnNlY3Rvci5zZXRDdWJlKCByZWYueCwgcmVmLnksIHJlZi56LCBWb3hlbGFyaXVtLlZveGVscy5Wb2lkIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZi5jbHVzdGVyLm1lc2hlci5TZWN0b3JVcGRhdGVGYWNlQ3VsbGluZyggcmVmLnNlY3RvciwgdHJ1ZSApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2Jhc2ljTWVzaGVyLlNlY3RvclVwZGF0ZUZhY2VDdWxsaW5nX1BhcnRpYWwoIGNsdXN0ZXIsIHNlY3RvciwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCwgdHJ1ZSApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWYuY2x1c3Rlci5tZXNoZXIuTWFrZVNlY3RvclJlbmRlcmluZ0RhdGEoIHJlZi5zZWN0b3IgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZveGVsYXJpdW0uZGIud29ybGQuc3RvcmVTZWN0b3IoIHJlZi5zZWN0b3IgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgfVxyXG4gICAgICAvKlxyXG4gICAgICBzY29wZS5vYmplY3QubWF0cml4LnJvdGF0ZVJlbGF0aXZlKCAtcGhpRGVsdGEsIHRoZXRhRGVsdGEsIDAgKTtcclxuICAgICAgc2NvcGUub2JqZWN0Lm1hdHJpeC5yb3RhdGVSZWxhdGl2ZSggMCwgMCwgLXNjb3BlLm9iamVjdC5tYXRyaXgucm9sbCApO1xyXG4gICAgICBzY29wZS5vYmplY3QubWF0cml4V29ybGROZWVkc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgICovXHJcbiAgfVxyXG5cclxuZnVuY3Rpb24gbW91c2VFdmVudCggeCwgeSwgYiwgZG93biApIHtcclxuICAgIHZhciBldiA9IHsgeCA6IHgsXHJcbiAgICAgICAgeSA6IHksXHJcbiAgICAgICAgYnV0dG9uIDogYixcclxuICAgICAgICBkZWx0YSA6IHNjb3BlLm1vdXNlQ2xvY2suZ2V0RGVsdGEoKSxcclxuICAgICAgICBkb3duIDogZG93blxyXG4gICAgfVxyXG5cclxuICAgIHNjb3BlLm1vdXNlRXZlbnRzLnB1c2goIGV2ICk7XHJcbn1cclxuXHJcbnZhciBvbmdvaW5nVG91Y2hlcyA9IFtdO1xyXG5cclxuZnVuY3Rpb24gY29weVRvdWNoKHRvdWNoKSB7XHJcbiAgcmV0dXJuIHsgaWRlbnRpZmllcjogdG91Y2guaWRlbnRpZmllciwgcGFnZVg6IHRvdWNoLnBhZ2VYLCBwYWdlWTogdG91Y2gucGFnZVkgfTtcclxufVxyXG5mdW5jdGlvbiBvbmdvaW5nVG91Y2hJbmRleEJ5SWQoaWRUb0ZpbmQpIHtcclxuICBmb3IgKHZhciBpID0gMDsgaSA8IG9uZ29pbmdUb3VjaGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICB2YXIgaWQgPSBvbmdvaW5nVG91Y2hlc1tpXS5pZGVudGlmaWVyO1xyXG5cclxuICAgIGlmIChpZCA9PSBpZFRvRmluZCkge1xyXG4gICAgICByZXR1cm4gaTtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIC0xOyAgICAvLyBub3QgZm91bmRcclxufVxyXG5mdW5jdGlvbiBvblRvdWNoRG93bihldmVudCkge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgdmFyIHRvdWNoZXMgPSBldmVudC5jaGFuZ2VkVG91Y2hlcztcclxuICBmb3IoIHZhciBpID0gMDsgaSA8IHRvdWNoZXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICBjb25zb2xlLmxvZyggYHRvdWNoICR7aX09JHt0b3VjaGVzW2ldfWApO1xyXG4gICAgb25nb2luZ1RvdWNoZXMucHVzaCggY29weVRvdWNoKCB0b3VjaGVzW2ldICkgKTtcclxuXHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvblRvdWNoVXAoZXZlbnQpIHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvblRvdWNoTW92ZShldmVudCkge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgdmFyIHRvdWNoZXMgPSBldmVudC5jaGFuZ2VkVG91Y2hlcztcclxuICBmb3IoIHZhciBpID0gMDsgaSA8IHRvdWNoZXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICB2YXIgaWR4ID0gb25nb2luZ1RvdWNoSW5kZXhCeUlkKHRvdWNoZXNbaV0uaWRlbnRpZmllcik7XHJcbiAgICBpZiggaWR4ID49IDAgKSB7XHJcbiAgICAgIG9uZ29pbmdUb3VjaGVzLnNwbGljZSggaWR4LCAxLCBjb3B5VG91Y2goIHRvdWNoZXNbaV0gKSApO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb25Ub3VjaENhbmNlbChldmVudCkge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbn1cclxuXHJcblxyXG5cclxuICBmdW5jdGlvbiBvbk1vdXNlRG93bihldmVudCkge1xyXG4gICAgICBpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBtb3VzZUV2ZW50KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZLCBldmVudC5idXR0b24sIHRydWUgKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG9uTW91c2VVcChldmVudCkge1xyXG4gICAgICBpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBtb3VzZUV2ZW50KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZLCBldmVudC5idXR0b24sIGZhbHNlICk7XHJcbiAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG9uTW91c2VNb3ZlKCBldmVudCApIHtcclxuXHJcbiAgICBcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcblxyXG4gICAgXHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgICBzY29wZS5zZXRNb3VzZVJheSggY2FtZXJhLCBldmVudCApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvbk1vdXNlV2hlZWwoIGV2ZW50ICkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgbW91c2VTY3JvbGxYICs9IGV2ZW50LndoZWVsRGVsdGFYO1xyXG4gICAgICAgIG1vdXNlU2Nyb2xsWSArPSBldmVudC53aGVlbERlbHRhWTtcclxuICAgIH1cclxuXHJcbiAgZnVuY3Rpb24gaWdub3JlKGV2ZW50KSB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgfVxyXG5cclxuICB0aGlzLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcclxuICAgIHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2NvbnRleHRtZW51JywgaWdub3JlLCBmYWxzZSApO1xyXG4gICAgc2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAndG91Y2hzdGFydCcsIG9uVG91Y2hEb3duLCBmYWxzZSApO1xyXG4gICAgc2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAndG91Y2hlbmQnLCBvblRvdWNoVXAsIGZhbHNlICk7XHJcbiAgICBzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaGNhbmNlbCcsIG9uVG91Y2hDYW5jZWwsIGZhbHNlICk7XHJcbiAgICBzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaG1vdmUnLCBvblRvdWNoTW92ZSwgZmFsc2UgKTtcclxuICAgIHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIG9uTW91c2VEb3duLCBmYWxzZSApO1xyXG4gICAgc2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UgKTtcclxuICAgIHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlLCBmYWxzZSApO1xyXG4gICAgc2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V3aGVlbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTtcclxuICAgIHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ0RPTU1vdXNlU2Nyb2xsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApOyAvLyBmaXJlZm94XHJcbiAgICAvL3dpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIG9uS2V5RG93biwgZmFsc2UgKTtcclxuICAgIC8vd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdrZXl1cCcsIG9uS2V5VXAsIGZhbHNlICk7XHJcbiAgfVxyXG5cclxuICB0aGlzLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnY29udGV4dG1lbnUnLCBpZ25vcmUsIGZhbHNlICk7XHJcbiAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaHN0YXJ0Jywgb25Ub3VjaERvd24sIGZhbHNlICk7XHJcbiAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaGVuZCcsIG9uVG91Y2hVcCwgZmFsc2UgKTtcclxuICAgIHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNoY2FuY2VsJywgb25Ub3VjaENhbmNlbCwgZmFsc2UgKTtcclxuICAgIHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlLCBmYWxzZSApO1xyXG4gICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgb25Nb3VzZURvd24sIGZhbHNlICk7XHJcbiAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZXVwJywgb25Nb3VzZVVwLCBmYWxzZSApO1xyXG4gICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XHJcbiAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdtb3VzZXdoZWVsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApOyAvLyBmaXJlZm94XHJcbiAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdET01Nb3VzZVNjcm9sbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTsgLy8gZmlyZWZveFxyXG4gICAgLy93aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ2tleWRvd24nLCBvbktleURvd24sIGZhbHNlICk7XHJcbiAgICAvL3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5dXAnLCBvbktleVVwLCBmYWxzZSApO1xyXG4gIH1cclxuICB0aGlzLmVuYWJsZSgpO1xyXG5cclxuXHJcbn1cclxuXHJcblxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiAgcmF5Q2FzdChjbHVzdGVyLCBvLCBmb3J3YXJkIClcclxue1xyXG4gICAgdmFyIE91dCA9IG51bGw7XHJcbiAgdmFyIERlbHRhX2ggPSBuZXcgVEhSRUUuVmVjdG9yNFBvb2wubmV3KCksRGVsdGFfdiA9IG5ldyBUSFJFRS5WZWN0b3I0UG9vbC5uZXcoKSxEZWx0YV9zID0gbmV3IFRIUkVFLlZlY3RvcjRQb29sLm5ldygpO1xyXG4gIHZhciBPZmZzZXRfaCA9IG5ldyBUSFJFRS5WZWN0b3I0UG9vbC5uZXcoKSwgT2Zmc2V0X3YgPSBuZXcgVEhSRUUuVmVjdG9yNFBvb2wubmV3KCksIE9mZnNldF9zID0gbmV3IFRIUkVFLlZlY3RvcjRQb29sLm5ldygpO1xyXG4gIHZhciBOb3JtX2ggPSBuZXcgVEhSRUUuVmVjdG9yM1Bvb2wubmV3KCksIE5vcm1fdiA9IG5ldyBUSFJFRS5WZWN0b3IzUG9vbC5uZXcoKSwgTm9ybV9zID0gbmV3IFRIUkVFLlZlY3RvcjNQb29sLm5ldygpO1xyXG4gIHZhciBDb2xsaXNpb25faCA9IG5ldyBUSFJFRS5WZWN0b3I0UG9vbC5uZXcoKSwgQ29sbGlzaW9uX3YgPSBuZXcgVEhSRUUuVmVjdG9yNFBvb2wubmV3KCksIENvbGxpc2lvbl9zID0gbmV3IFRIUkVFLlZlY3RvcjRQb29sLm5ldygpO1xyXG5cclxuICB2YXIgQWN0dWFsQ3ViZV94LEFjdHVhbEN1YmVfeSxBY3R1YWxDdWJlX3o7XHJcbiAgdmFyIE5ld0N1YmVfeCxOZXdDdWJlX3ksTmV3Q3ViZV96O1xyXG4gIHZhciBDb2xsaWRlX1gsIENvbGxpZGVfWSwgQ29sbGlkZV9aO1xyXG4gIHZhciBpO1xyXG5cclxuICB2YXIgTm9ybSA9IGZvcndhcmQ7XHJcblxyXG4gIENvbGxpZGVfWCA9IENvbGxpZGVfWSA9IENvbGxpZGVfWiA9IGZhbHNlO1xyXG5cclxuICBpZiAoTm9ybS54ID49IDAuMDEgKVxyXG4gIHtcclxuICAgIENvbGxpZGVfWCA9IHRydWU7XHJcbiAgICBEZWx0YV9oLnggPSAxLjA7XHJcbiAgICBEZWx0YV9oLnkgPSBOb3JtLnkgLyBOb3JtLng7XHJcbiAgICBEZWx0YV9oLnogPSBOb3JtLnogLyBOb3JtLng7XHJcbiAgICBEZWx0YV9oLncgPSAwO1xyXG4gICAgRGVsdGFfaC53ID0gRGVsdGFfaC5sZW5ndGgoKTtcclxuXHJcbiAgICBDb2xsaXNpb25faC54ID0gKE1hdGguZmxvb3Ioby54IC8gY2x1c3Rlci52b3hlbFVuaXRTaXplKSArIDEuMCkqY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgQ29sbGlzaW9uX2gueSA9IChDb2xsaXNpb25faC54IC0gby54KSAqIERlbHRhX2gueSArIG8ueTtcclxuICAgIENvbGxpc2lvbl9oLnogPSAoQ29sbGlzaW9uX2gueCAtIG8ueCkgKiBEZWx0YV9oLnogKyBvLno7XHJcbiAgICBDb2xsaXNpb25faC53ID0gKENvbGxpc2lvbl9oLnggLSBvLngpICogRGVsdGFfaC53O1xyXG5cclxuICAgIE9mZnNldF9oLnggPSBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBPZmZzZXRfaC55ID0gRGVsdGFfaC55ICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgT2Zmc2V0X2gueiA9IERlbHRhX2gueiAqIGNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuICAgIE9mZnNldF9oLncgPSBEZWx0YV9oLncgKiBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBOb3JtX2gueCA9IE9mZnNldF9oLngvMjsvLyAvIChjbHVzdGVyLnZveGVsVW5pdFNpemUvMik7XHJcbiAgICBOb3JtX2gueSA9IDAgLyAoY2x1c3Rlci52b3hlbFVuaXRTaXplLzIpO1xyXG4gICAgTm9ybV9oLnogPSAwIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICB9XHJcbiAgZWxzZSBpZiAoTm9ybS54IDw9IC0wLjAxKVxyXG4gIHtcclxuICAgIENvbGxpZGVfWCA9IHRydWU7XHJcblxyXG4gICAgRGVsdGFfaC54ID0gMS4wO1xyXG4gICAgRGVsdGFfaC55ID0gTm9ybS55IC8gLU5vcm0ueDtcclxuICAgIERlbHRhX2gueiA9IE5vcm0ueiAvIC1Ob3JtLng7XHJcbiAgICBEZWx0YV9oLncgPSAwO1xyXG4gICAgRGVsdGFfaC53ID0gRGVsdGFfaC5sZW5ndGgoKTtcclxuXHJcbiAgICBDb2xsaXNpb25faC54ID0gKE1hdGguZmxvb3Ioby54IC8gY2x1c3Rlci52b3hlbFVuaXRTaXplKSkqY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgQ29sbGlzaW9uX2gueSA9IChvLnggLSBDb2xsaXNpb25faC54KSAqIERlbHRhX2gueSArIG8ueTtcclxuICAgIENvbGxpc2lvbl9oLnogPSAoby54IC0gQ29sbGlzaW9uX2gueCkgKiBEZWx0YV9oLnogKyBvLno7XHJcbiAgICBDb2xsaXNpb25faC53ID0gKG8ueCAtIENvbGxpc2lvbl9oLngpICogRGVsdGFfaC53O1xyXG4gICAgT2Zmc2V0X2gueCA9IC1jbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBPZmZzZXRfaC55ID0gRGVsdGFfaC55ICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgT2Zmc2V0X2gueiA9IERlbHRhX2gueiAqIGNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuICAgIE9mZnNldF9oLncgPSBEZWx0YV9oLncgKiBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBOb3JtX2gueCA9IE9mZnNldF9oLngvMjsvLyAvIChjbHVzdGVyLnZveGVsVW5pdFNpemUvMik7XHJcbiAgICBOb3JtX2gueSA9IDAgLyAoY2x1c3Rlci52b3hlbFVuaXRTaXplLzIpO1xyXG4gICAgTm9ybV9oLnogPSAwIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICB9XHJcblxyXG4gIGlmIChOb3JtLnkgPj0gMC4wMSApXHJcbiAge1xyXG4gICAgQ29sbGlkZV9ZID0gdHJ1ZTtcclxuICAgIERlbHRhX3YueCA9IE5vcm0ueCAvIE5vcm0ueTtcclxuICAgIERlbHRhX3YueSA9IDEuMDtcclxuICAgIERlbHRhX3YueiA9IE5vcm0ueiAvIE5vcm0ueTtcclxuICAgIERlbHRhX3YudyA9IDA7XHJcbiAgICBEZWx0YV92LncgPSBEZWx0YV92Lmxlbmd0aCgpO1xyXG5cclxuICAgIENvbGxpc2lvbl92LnkgPSAoTWF0aC5mbG9vcihvLnkgLyBjbHVzdGVyLnZveGVsVW5pdFNpemUpKzEpICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgdmFyIGRlbHkgPSAoQ29sbGlzaW9uX3YueSAtIG8ueSk7XHJcbiAgICBDb2xsaXNpb25fdi54ID0gZGVseSAqIERlbHRhX3YueCArIG8ueDtcclxuICAgIENvbGxpc2lvbl92LnogPSBkZWx5ICogRGVsdGFfdi56ICsgby56O1xyXG4gICAgQ29sbGlzaW9uX3YudyA9IGRlbHkgKiBEZWx0YV92Lnc7XHJcbiAgICBPZmZzZXRfdi55ID0gY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgT2Zmc2V0X3YueCA9IERlbHRhX3YueCAqIGNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuICAgIE9mZnNldF92LnogPSBEZWx0YV92LnogKiBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBPZmZzZXRfdi53ID0gRGVsdGFfdi53ICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgTm9ybV92LnggPSAwIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICAgIE5vcm1fdi55ID0gT2Zmc2V0X3YueS8yOy8vIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICAgIE5vcm1fdi56ID0gMCAvIChjbHVzdGVyLnZveGVsVW5pdFNpemUvMik7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKE5vcm0ueSA8PSAtMC4wMSlcclxuICB7XHJcbiAgICBDb2xsaWRlX1kgPSB0cnVlO1xyXG4gICAgRGVsdGFfdi54ID0gTm9ybS54IC8gLU5vcm0ueTtcclxuICAgIERlbHRhX3YueSA9IDEuMDtcclxuICAgIERlbHRhX3YueiA9IE5vcm0ueiAvIC1Ob3JtLnk7XHJcbiAgICBEZWx0YV92LncgPSAwO1xyXG4gICAgRGVsdGFfdi53ID0gRGVsdGFfdi5sZW5ndGgoKTtcclxuXHJcbiAgICBDb2xsaXNpb25fdi55ID0gKE1hdGguZmxvb3Ioby55IC8gY2x1c3Rlci52b3hlbFVuaXRTaXplKSkgKiBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICB2YXIgZGVseSA9IChvLnktQ29sbGlzaW9uX3YueSApO1xyXG4gICAgQ29sbGlzaW9uX3YueCA9IChkZWx5KSAqIERlbHRhX3YueCArIG8ueDtcclxuICAgIENvbGxpc2lvbl92LnogPSAoZGVseSkgKiBEZWx0YV92LnogKyBvLno7XHJcbiAgICBDb2xsaXNpb25fdi53ID0gKGRlbHkpICogRGVsdGFfdi53O1xyXG5cclxuICAgIE9mZnNldF92LnkgPSAtY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgT2Zmc2V0X3YueCA9IERlbHRhX3YueCAqIGNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuICAgIE9mZnNldF92LnogPSBEZWx0YV92LnogKiBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBPZmZzZXRfdi53ID0gRGVsdGFfdi53ICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgTm9ybV92LnggPSAwIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICAgIE5vcm1fdi55ID0gT2Zmc2V0X3YueS8yOy8vIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICAgIE5vcm1fdi56ID0gMCAvIChjbHVzdGVyLnZveGVsVW5pdFNpemUvMik7XHJcbiAgfVxyXG5cclxuICBpZiAoTm9ybS56ID49IDAuMDEpXHJcbiAge1xyXG4gICAgQ29sbGlkZV9aID0gdHJ1ZTtcclxuICAgIERlbHRhX3MueCA9IE5vcm0ueCAvIE5vcm0uejtcclxuICAgIERlbHRhX3MueSA9IE5vcm0ueSAvIE5vcm0uejtcclxuICAgIERlbHRhX3MueiA9IDEuMDtcclxuICAgIERlbHRhX3MudyA9IDA7XHJcbiAgICBEZWx0YV9zLncgPSBEZWx0YV9zLmxlbmd0aCgpO1xyXG4gICAgQ29sbGlzaW9uX3MueiA9IChNYXRoLmZsb29yKG8ueiAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSkgKyAxLjApKmNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuICAgIENvbGxpc2lvbl9zLnggPSAoQ29sbGlzaW9uX3MueiAtIG8ueikgKiBEZWx0YV9zLnggKyBvLng7XHJcbiAgICBDb2xsaXNpb25fcy55ID0gKENvbGxpc2lvbl9zLnogLSBvLnopICogRGVsdGFfcy55ICsgby55O1xyXG4gICAgQ29sbGlzaW9uX3MudyA9IChDb2xsaXNpb25fcy56IC0gby56KSAqIERlbHRhX3MudztcclxuXHJcbiAgICBPZmZzZXRfcy54ID0gRGVsdGFfcy54ICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgT2Zmc2V0X3MueSA9IERlbHRhX3MueSAqIGNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuICAgIE9mZnNldF9zLnogPSBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBPZmZzZXRfcy53ID0gRGVsdGFfcy53ICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgTm9ybV9zLnggPSAwIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICAgIE5vcm1fcy55ID0gMCAvIChjbHVzdGVyLnZveGVsVW5pdFNpemUvMik7XHJcbiAgICBOb3JtX3MueiA9IE9mZnNldF9zLnovMjsvLyAvIChjbHVzdGVyLnZveGVsVW5pdFNpemUvMik7XHJcbiAgfVxyXG4gIGVsc2UgaWYgKE5vcm0ueiA8PSAtMC4wMSlcclxuICB7XHJcbiAgICBDb2xsaWRlX1ogPSB0cnVlO1xyXG4gICAgRGVsdGFfcy54ID0gTm9ybS54IC8gLU5vcm0uejtcclxuICAgIERlbHRhX3MueSA9IE5vcm0ueSAvIC1Ob3JtLno7XHJcbiAgICBEZWx0YV9zLnogPSAxLjA7XHJcbiAgICBEZWx0YV9zLncgPSAwO1xyXG4gICAgRGVsdGFfcy53ID0gRGVsdGFfcy5sZW5ndGgoKTtcclxuICAgIENvbGxpc2lvbl9zLnogPSAoTWF0aC5mbG9vcihvLnogLyBjbHVzdGVyLnZveGVsVW5pdFNpemUpICkqY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgQ29sbGlzaW9uX3MueCA9IChvLnogLSBDb2xsaXNpb25fcy56KSAqIERlbHRhX3MueCArIG8ueDtcclxuICAgIENvbGxpc2lvbl9zLnkgPSAoby56IC0gQ29sbGlzaW9uX3MueikgKiBEZWx0YV9zLnkgKyBvLnk7XHJcbiAgICBDb2xsaXNpb25fcy53ID0gKG8ueiAtIENvbGxpc2lvbl9zLnopICogRGVsdGFfcy53O1xyXG5cclxuICAgIE9mZnNldF9zLnggPSBEZWx0YV9zLnggKiBjbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcbiAgICBPZmZzZXRfcy55ID0gRGVsdGFfcy55ICogY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgT2Zmc2V0X3MueiA9IC0gY2x1c3Rlci52b3hlbFVuaXRTaXplO1xyXG4gICAgT2Zmc2V0X3MudyA9IERlbHRhX3MudyAqIGNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuXHJcbiAgICBOb3JtX3MueCA9IDAgLyAoY2x1c3Rlci52b3hlbFVuaXRTaXplLzIpO1xyXG4gICAgTm9ybV9zLnkgPSAwIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICAgIE5vcm1fcy56ID0gT2Zmc2V0X3Muei8yOy8vIC8gKGNsdXN0ZXIudm94ZWxVbml0U2l6ZS8yKTtcclxuICB9XHJcblxyXG5cclxuXHJcbi8vICBwcmludGYoXCJ5YXc6ICUwNGxmIHBpdGNoOiAlbGYgT2Zmc2V0X3k6JWxmIE9mZnNldF96OiVsZiB4eXo6JWxmICVsZiAlbGYgTlhZWjolbGYgJWxmICVsZiBEeHl6OiVsZiAlbGYgJWxmXCIsIHlhdyxwaXRjaCwgRGVsdGFfaC55LCBEZWx0YV9oLnoseCx5LHosIE5vcm1faC54LCBOb3JtX2gueSwgTm9ybV9oLnosIERlbHRhX2gueCwgRGVsdGFfaC55LCBEZWx0YV9oLnopO1xyXG4gLy9wcmludGYoXCJBbmdsZSAoeTolbGYgcDolbGYpIFhZWjooJWxmICVsZiAlbGYpIE9mZiglbGYgJWxmICVsZiAlbGYpIENvbGwoJWxmICVsZiAlbGYgJWxmKSBOb3JtKCVsZyAlbGcgJWxmKSA6XFxuXCIsIHlhdyxwaXRjaCx4LHkseiwgT2Zmc2V0X3MueCwgT2Zmc2V0X3MueSwgT2Zmc2V0X3MueiwgT2Zmc2V0X3MudywgQ29sbGlzaW9uX3MueCwgQ29sbGlzaW9uX3MueSwgQ29sbGlzaW9uX3MueiwgQ29sbGlzaW9uX3MudywgTm9ybV9zLngsTm9ybV9zLnksIE5vcm1fcy56KTtcclxuXHJcbiAgdmFyIE1hdGNoX2ggPSAwO1xyXG4gIHZhciBNYXRjaF9zID0gMDtcclxuICB2YXIgTWF0Y2hfdiA9IDA7XHJcbiAgdmFyIEN5Y2xlID0gMTtcclxuICB2YXIgTWluVyA9IDEwMDAwMDAuMDtcclxuICB2YXIgcmVmO1xyXG4gIC8vY29uc29sZS5sb2coICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XHJcbiAgZm9yIChpPTA7aTwxNTA7aSsrKVxyXG4gIHtcclxuXHJcbiAgICAvLyBIb3Jpem9udGFsIFggYXhpcy5cclxuICAgIGlmIChDb2xsaWRlX1gpXHJcbiAgICB7XHJcbiAgICAgIGlmIChNYXRjaF9oPT0wICYmIENvbGxpc2lvbl9oLncgPCBNaW5XKVxyXG4gICAgICB7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV94ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX2gueCAtIE5vcm1faC54KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV95ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX2gueSAtIE5vcm1faC55KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV96ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX2gueiAtIE5vcm1faC56KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV94ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX2gueCArIE5vcm1faC54KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV95ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX2gueSArIE5vcm1faC55KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV96ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX2gueiArIE5vcm1faC56KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgaWYoICggcmVmID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggZmFsc2UsIE5ld0N1YmVfeCwgTmV3Q3ViZV95LCBOZXdDdWJlX3opICkgJiYgcmVmLnNlY3RvciAmJiAhcmVmLnZveGVsVHlwZS5wcm9wZXJ0aWVzLklzX1BsYXllckNhblBhc3NUaHJvdWdoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyggYHggY2hlY2sgJHtOZXdDdWJlX3h9ICAke05ld0N1YmVfeX0gICR7TmV3Q3ViZV96fSAgICAke0FjdHVhbEN1YmVfeH0gJHtBY3R1YWxDdWJlX3l9ICR7QWN0dWFsQ3ViZV96fSAgJHtNaW5XfSAgJHtDb2xsaXNpb25faC53fWApXHJcbiAgICAgICAgICAgIE91dCA9IHsgUHJlZFBvaW50ZWRWb3hlbCA6IG5ldyBUSFJFRS5WZWN0b3IzKCBBY3R1YWxDdWJlX3gsIEFjdHVhbEN1YmVfeSwgQWN0dWFsQ3ViZV96ICksXHJcbiAgICAgICAgICAgICAgICAgICAgUG9pbnRlZFZveGVsIDogbmV3IFRIUkVFLlZlY3RvcjMoIE5ld0N1YmVfeCwgTmV3Q3ViZV95LCBOZXdDdWJlX3ogKSxcclxuICAgICAgICAgICAgICAgICAgICByZWYgOiByZWZcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgLy8gcHJpbnRmKFwiIE1BVENIX0g6ICVsZlxcblwiLENvbGxpc2lvbl9oLncpO1xyXG4gICAgICAgICAgTWF0Y2hfaCA9IEN5Y2xlO1xyXG4gICAgICAgICAgTWluVyA9IENvbGxpc2lvbl9oLnc7XHJcbiAgICAgICAgfSBlbHNlIGlmKCByZWYgKSByZWYuZGVsZXRlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBIb3Jpem9udGFsIFogYXhpcy5cclxuXHJcbiAgICBpZiAoQ29sbGlkZV9aKVxyXG4gICAge1xyXG4gICAgICBpZiAoTWF0Y2hfcyA9PSAwICYmIENvbGxpc2lvbl9zLncgPCBNaW5XKVxyXG4gICAgICB7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV94ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3MueCAtIE5vcm1fcy54KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV95ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3MueSAtIE5vcm1fcy55KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV96ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3MueiAtIE5vcm1fcy56KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV94ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3MueCArIE5vcm1fcy54KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV95ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3MueSArIE5vcm1fcy55KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV96ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3MueiArIE5vcm1fcy56KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyggYHogY2hlY2sgJHtOZXdDdWJlX3h9ICAke05ld0N1YmVfeX0gICR7TmV3Q3ViZV96fSAgJHtNaW5XfSAgJHtDb2xsaXNpb25fcy53fSBgKVxyXG4gICAgICAgIGlmKCAoIHJlZiA9IGNsdXN0ZXIuZ2V0Vm94ZWxSZWYoIGZhbHNlLCBOZXdDdWJlX3gsIE5ld0N1YmVfeSwgTmV3Q3ViZV96KSApICYmIHJlZi5zZWN0b3IgJiYgIXJlZi52b3hlbFR5cGUucHJvcGVydGllcy5Jc19QbGF5ZXJDYW5QYXNzVGhyb3VnaClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIGB6IGNoZWNrICR7TmV3Q3ViZV94fSAgJHtOZXdDdWJlX3l9ICAke05ld0N1YmVfen0gICR7TWluV30gICR7Q29sbGlzaW9uX3Mud30gYClcclxuICAgICAgICAgIE91dCA9IHsgUHJlZFBvaW50ZWRWb3hlbCA6IG5ldyBUSFJFRS5WZWN0b3IzKCBBY3R1YWxDdWJlX3gsIEFjdHVhbEN1YmVfeSwgQWN0dWFsQ3ViZV96ICksXHJcbiAgICAgICAgICAgICAgICAgIFBvaW50ZWRWb3hlbCA6IG5ldyBUSFJFRS5WZWN0b3IzKCBOZXdDdWJlX3gsIE5ld0N1YmVfeSwgTmV3Q3ViZV96ICksXHJcbiAgICAgICAgICAgICAgICAgIHJlZiA6IHJlZlxyXG4gICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgIC8vIHByaW50ZihcIiBNQVRDSF9TOiAlbGZcXG5cIixDb2xsaXNpb25fcy53KTtcclxuICAgICAgICAgIE1hdGNoX3MgPSBDeWNsZTtcclxuICAgICAgICAgIE1pblcgPSBDb2xsaXNpb25fcy53O1xyXG4gICAgICAgIH0gZWxzZSBpZiggcmVmICkgcmVmLmRlbGV0ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVydGljYWwgWSBheGlzLlxyXG5cclxuICAgIGlmIChDb2xsaWRlX1kpXHJcbiAgICB7XHJcbiAgICAgIGlmIChNYXRjaF92PT0wICYmIENvbGxpc2lvbl92LncgPCBNaW5XKVxyXG4gICAgICB7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV94ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3YueCAtIE5vcm1fdi54KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV95ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3YueSAtIE5vcm1fdi55KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgQWN0dWFsQ3ViZV96ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3YueiAtIE5vcm1fdi56KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV94ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3YueCArIE5vcm1fdi54KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV95ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3YueSArIE5vcm1fdi55KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgTmV3Q3ViZV96ID0gTWF0aC5mbG9vcigoQ29sbGlzaW9uX3YueiArIE5vcm1fdi56KSAvIGNsdXN0ZXIudm94ZWxVbml0U2l6ZSk7XHJcbiAgICAgICAgaWYoICggcmVmID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggZmFsc2UsIE5ld0N1YmVfeCwgTmV3Q3ViZV95LCBOZXdDdWJlX3opICkgJiYgcmVmLnNlY3RvciAmJiAhcmVmLnZveGVsVHlwZS5wcm9wZXJ0aWVzLklzX1BsYXllckNhblBhc3NUaHJvdWdoIClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coIGB5IGNoZWNrICR7TmV3Q3ViZV94fSAgJHtOZXdDdWJlX3l9ICAke05ld0N1YmVfen0gICR7TWluV30gICR7Q29sbGlzaW9uX3Yud30gYClcclxuICAgICAgICAgIE91dCA9IHsgUHJlZFBvaW50ZWRWb3hlbCA6IG5ldyBUSFJFRS5WZWN0b3IzKCBBY3R1YWxDdWJlX3gsIEFjdHVhbEN1YmVfeSwgQWN0dWFsQ3ViZV96ICksXHJcbiAgICAgICAgICAgICAgICAgIFBvaW50ZWRWb3hlbCA6IG5ldyBUSFJFRS5WZWN0b3IzKCBOZXdDdWJlX3gsIE5ld0N1YmVfeSwgTmV3Q3ViZV96ICksXHJcbiAgICAgICAgICAgICAgICAgIHJlZiA6IHJlZlxyXG4gICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgIC8vIHByaW50ZihcIiBNQVRDSF9WOiAlbGZcXG5cIixDb2xsaXNpb25fdi53KTtcclxuICAgICAgICAgIE1hdGNoX3YgPSBDeWNsZTtcclxuICAgICAgICAgIE1pblcgPSBDb2xsaXNpb25fdi53O1xyXG4gICAgICAgIH0gZWxzZSBpZiggcmVmICkgcmVmLmRlbGV0ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgICAvL3ByaW50ZihcIiBNYXRjaCAoSDolbGYgUzolbGYgVjolbGYpIFxcblwiLCBDb2xsaXNpb25faC53LCBDb2xsaXNpb25fcy53LCBDb2xsaXNpb25fdi53KTtcclxuICAgICAgaWYgKE1hdGNoX2g+MCAmJiAoTWF0Y2hfaCAtIEN5Y2xlKTwtMTAwKSByZXR1cm4gT3V0O1xyXG4gICAgICBpZiAoTWF0Y2hfcz4wICYmIChNYXRjaF9zIC0gQ3ljbGUpPC0xMDApIHJldHVybiBPdXQ7XHJcbiAgICAgIGlmIChNYXRjaF92PjAgJiYgKE1hdGNoX3YgLSBDeWNsZSk8LTEwMCkgcmV0dXJuIE91dDtcclxuXHJcbiAgICBDb2xsaXNpb25faC54ICs9IE9mZnNldF9oLng7IENvbGxpc2lvbl9oLnkgKz0gT2Zmc2V0X2gueTsgQ29sbGlzaW9uX2gueiArPSBPZmZzZXRfaC56OyBDb2xsaXNpb25faC53ICs9IE9mZnNldF9oLnc7XHJcbiAgICBDb2xsaXNpb25fdi54ICs9IE9mZnNldF92Lng7IENvbGxpc2lvbl92LnkgKz0gT2Zmc2V0X3YueTsgQ29sbGlzaW9uX3YueiArPSBPZmZzZXRfdi56OyBDb2xsaXNpb25fdi53ICs9IE9mZnNldF92Lnc7XHJcbiAgICBDb2xsaXNpb25fcy54ICs9IE9mZnNldF9zLng7IENvbGxpc2lvbl9zLnkgKz0gT2Zmc2V0X3MueTsgQ29sbGlzaW9uX3MueiArPSBPZmZzZXRfcy56OyBDb2xsaXNpb25fcy53ICs9IE9mZnNldF9zLnc7XHJcbiAgICBDeWNsZSArKztcclxuICB9XHJcbiAgRGVsdGFfaC5kZWxldGUoKTtcclxuICBEZWx0YV92LmRlbGV0ZSgpO1xyXG4gIERlbHRhX3MuZGVsZXRlKCk7XHJcbiAgT2Zmc2V0X2guZGVsZXRlKCk7XHJcbiAgT2Zmc2V0X3YuZGVsZXRlKCk7XHJcbiAgT2Zmc2V0X3MuZGVsZXRlKCk7XHJcbiAgTm9ybV9oLmRlbGV0ZSgpO1xyXG4gIE5vcm1fdi5kZWxldGUoKTtcclxuICBOb3JtX3MuZGVsZXRlKCk7XHJcbiAgQ29sbGlzaW9uX2guZGVsZXRlKCk7XHJcbiAgQ29sbGlzaW9uX3YuZGVsZXRlKCk7XHJcbiAgQ29sbGlzaW9uX3MuZGVsZXRlKCk7XHJcblxyXG4gIHJldHVybiBPdXQ7XHJcbn1cclxuIiwiXHJcblxyXG5nbG93ID0ge1xuXG4gZ2xvd2NvbXBvc2VyIDogbnVsbCxcclxuIHNjZW5lY29tcG9zZXIgOiBudWxsLFxyXG4gZmluYWxjb21wb3NlciA6IG51bGwsXHJcblxyXG4gcmVuZGVyVGFyZ2V0R2xvdyA6IG51bGwsXHJcblx0cmVuZGVyVGFyZ2V0IDogbnVsbCxcclxuICAgICAgICByZW5kZXIgOiBudWxsLFxuICAgIH07XG5cblxudmFyIGdsb3djb21wb3NlcjtcclxudmFyIHNjZW5lY29tcG9zZXI7XHJcbnZhciBmaW5hbGNvbXBvc2VyO1xyXG5cclxudmFyIHJlbmRlclRhcmdldEdsb3c7XHJcbnZhclx0cmVuZGVyVGFyZ2V0O1xyXG5cclxudmFyIGZpbmFsc2hhZGVyID0ge1xyXG4gICAgdW5pZm9ybXM6IHtcclxuICAgICAgICB0RGlmZnVzZTogeyB0eXBlOiBcInRcIiwgdmFsdWU6IDAsIHRleHR1cmU6IG51bGwgfSwgLy8gVGhlIGJhc2Ugc2NlbmUgYnVmZmVyXHJcbiAgICAgICAgdEdsb3c6IHsgdHlwZTogXCJ0XCIsIHZhbHVlOiAxLCB0ZXh0dXJlOiBudWxsIH0sIC8vIFRoZSBnbG93IHNjZW5lIGJ1ZmZlclxyXG5cdFx0dERpZmZ1c2VEZXB0aDogeyB0eXBlOiBcInRcIiwgdmFsdWU6IDAsIHRleHR1cmU6IG51bGwgfSwgLy8gVGhlIGJhc2Ugc2NlbmUgYnVmZmVyXHJcbiAgICAgICAgdEdsb3dEZXB0aDogeyB0eXBlOiBcInRcIiwgdmFsdWU6IDEsIHRleHR1cmU6IG51bGwgfSwgLy8gVGhlIGdsb3cgc2NlbmUgYnVmZmVyXHJcblx0XHRjYW1lcmFOZWFyOiB7IHR5cGU6ICdmJywgdmFsdWU6IDEgfSxcclxuXHRcdGNhbWVyYUZhcjogeyB0eXBlOiAnZicsIHZhbHVlOiAxMDAwMCB9LFxyXG4gICAgfSxcclxuXHJcbiAgICB2ZXJ0ZXhTaGFkZXI6IFtcclxuICAgICAgICBcInZhcnlpbmcgdmVjMiB2VXY7XCIsXHJcblxyXG4gICAgICAgIFwidm9pZCBtYWluKCkge1wiLFxyXG5cclxuICAgICAgICAgICAgXCJ2VXYgPSB2ZWMyKCB1di54LCB1di55ICk7XCIsXHJcbiAgICAgICAgICAgIFwiZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1wiLFxyXG5cclxuICAgICAgICBcIn1cIlxyXG4gICAgXS5qb2luKFwiXCIpLFxyXG5cclxuICAgIGZyYWdtZW50U2hhZGVyOiBbXHJcbiAgICAgICAgXCJ1bmlmb3JtIHNhbXBsZXIyRCB0RGlmZnVzZTtcIixcclxuICAgICAgICBcInVuaWZvcm0gc2FtcGxlcjJEIHRHbG93O1wiLFxyXG5cdFx0XCJ1bmlmb3JtIHNhbXBsZXIyRCB0RGlmZnVzZURlcHRoO1wiLFxyXG5cdFx0XCJ1bmlmb3JtIHNhbXBsZXIyRCB0R2xvd0RlcHRoO1wiLFxyXG5cdFx0XCJ1bmlmb3JtIGZsb2F0IGNhbWVyYU5lYXI7XCIsXHJcbiBcdFx0XCJ1bmlmb3JtIGZsb2F0IGNhbWVyYUZhcjtcIixcclxuXHJcbiAgICAgICAgXCJ2YXJ5aW5nIHZlYzIgdlV2O1wiLFxyXG5cclxuXHRcdFwiZmxvYXQgcmVhZERlcHRoIChzYW1wbGVyMkQgZGVwdGhTYW1wbGVyLCB2ZWMyIGNvb3JkKSB7XCIsXHJcbiAgICAgICAgXCIgIGZsb2F0IGNhbWVyYUZhclBsdXNOZWFyID0gY2FtZXJhRmFyICsgY2FtZXJhTmVhcjtcIixcclxuICAgICAgICBcIiAgZmxvYXQgY2FtZXJhRmFyTWludXNOZWFyID0gY2FtZXJhRmFyIC0gY2FtZXJhTmVhcjtcIixcclxuICAgICAgICBcIiAgZmxvYXQgY2FtZXJhQ29lZiA9IDIuMCAqIGNhbWVyYU5lYXI7XCIsXHJcbiAgICAgICAgXCIgIHJldHVybiAxLjAtKGNhbWVyYUNvZWYgLyAoY2FtZXJhRmFyUGx1c05lYXIgLSB0ZXh0dXJlMkQoZGVwdGhTYW1wbGVyLCBjb29yZCkueCAqIGNhbWVyYUZhck1pbnVzTmVhcikpO1wiLFxyXG4gICAgICAgIFwifVwiLFxyXG5cclxuICAgICAgICBcInZvaWQgbWFpbigpIHtcIixcclxuXHJcbiAgICAgICAgICAgIFwidmVjNCB0ZXhlbCA9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZVdiApO1wiLFxyXG4gICAgICAgICAgICBcInZlYzQgZ2xvdyA9IHRleHR1cmUyRCggdEdsb3csIHZVdiApO1wiLFxyXG5cdFx0XHRcImZsb2F0IHRleGVsRGVwdGggPSByZWFkRGVwdGgoIHREaWZmdXNlRGVwdGgsIHZVdiApO1wiLFxyXG5cdFx0XHRcImZsb2F0IGdsb3dEZXB0aCA9IHJlYWREZXB0aCggdEdsb3dEZXB0aCwgdlV2ICk7XCIsXHJcblx0XHRcdC8vXCJmbG9hdCB0ZXhlbERlcHRoID0gdGV4dHVyZTJEKHREaWZmdXNlRGVwdGgsIHZVdikueDtcIixcclxuICAgICAgICAgICAgLy9cImlmKCAodGV4ZWwucit0ZXhlbC5nK3RleGVsLmIpPT0gMC4wICkgXCIsXHJcblx0XHRcdFwiICAgIGdsX0ZyYWdDb2xvciA9ICh0ZXhlbCArIHZlYzQoMC41LCAwLjc1LCAxLjAsIDMuMCkgKiBnbG93ICogMS4wKTtcIiwgLy8gQmxlbmQgdGhlIHR3byBidWZmZXJzIHRvZ2V0aGVyIChJIGNvbG9yaXplZCBhbmQgaW50ZW5zaWZpZWQgdGhlIGdsb3cgYXQgdGhlIHNhbWUgdGltZSlcclxuXHRcdFx0Ly9cIiAgICBnbF9GcmFnQ29sb3IgKz0gIHZlYzQodGV4ZWxEZXB0aCwgZ2xvd0RlcHRoLCAwLCAxLjApO1wiLCAvLyBCbGVuZCB0aGUgdHdvIGJ1ZmZlcnMgdG9nZXRoZXIgKEkgY29sb3JpemVkIGFuZCBpbnRlbnNpZmllZCB0aGUgZ2xvdyBhdCB0aGUgc2FtZSB0aW1lKVxyXG5cdFx0XHQvL1wiZWxzZSBnbF9GcmFnQ29sb3IgPSB0ZXhlbDtcIixcclxuXHRcdFx0Ly9cImdsX0ZyYWdDb2xvciA9IHRleGVsO1wiLFxyXG5cclxuICAgICAgICBcIn1cIlxyXG4gICAgXS5qb2luKFwiXCIpXHJcbn07XHJcblxyXG52YXIgcHJlR2xvdztcclxudmFyIHByZUZsYXQ7XHJcbnZhciBvdmVybGF5O1xyXG52YXIgc2NlbmU7XHJcblxuZ2xvdy5tYWtlQ29tcG9zZXJzID1cbmZ1bmN0aW9uIG1ha2VDb21wb3NlcnMoIHJlbmRlcmVyLCBzY2VuZUZsYXQsIHByZUZsYXRTZXR1cCwgc2NlbmVHbG93LCBwcmVHbG93U2V0dXAsIHNjZW5lT3ZlciApIHtcclxuICBzY2VuZSA9IHNjZW5lRmxhdDtcclxuICBnbG93LnJlbmRlcmVyID0gcmVuZGVyZXI7XG5cdHJlbmRlcmVyLmF1dG9DbGVhciA9IGZhbHNlO1xyXG5cclxuICBpZiggIVZveGVsYXJpdW0uU2V0dGluZ3MudXNlX2Jhc2ljX21hdGVyaWFsICkge1xyXG5cclxuICAgIG92ZXJsYXkgPSBzY2VuZU92ZXI7XHJcbiAgICBwcmVHbG93ID0gcHJlR2xvd1NldHVwO1xyXG4gICAgcHJlRmxhdCA9IHByZUZsYXRTZXR1cDtcclxuXHQvLyBQcmVwYXJlIHRoZSBnbG93IGNvbXBvc2VyJ3MgcmVuZGVyIHRhcmdldFxyXG5cdHZhciByZW5kZXJUYXJnZXRQYXJhbWV0ZXJzID0geyBtaW5GaWx0ZXI6IFRIUkVFLkxpbmVhckZpbHRlclxyXG5cdFx0XHQsIG1hZ0ZpbHRlcjogVEhSRUUuTGluZWFyRmlsdGVyXHJcblx0XHRcdC8vLCBmb3JtYXQ6IFRIUkVFLlJHQkZvcm1hdFxyXG5cdFx0XHQsIHN0ZW5jaWxCdWZlcjogZmFsc2UgfTtcclxuXHRpZiggIXJlbmRlclRhcmdldEdsb3cgKXtcclxuXHQgIHJlbmRlclRhcmdldEdsb3cgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQoIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQvKiwgcmVuZGVyVGFyZ2V0UGFyYW1ldGVycyovICk7XHJcblx0ICByZW5kZXJUYXJnZXRHbG93LnRleHR1cmUubWluRmlsdGVyID0gVEhSRUUuTGluZWFyRmlsdGVyO1xyXG5cdCAgcmVuZGVyVGFyZ2V0R2xvdy50ZXh0dXJlLm1hZ0ZpbHRlciA9IFRIUkVFLkxpbmVhckZpbHRlcjtcclxuXHQgIHJlbmRlclRhcmdldEdsb3cudGV4dHVyZS5zdGVuY2lsQnVmZXIgPSBmYWxzZTtcclxuXHQgIHJlbmRlclRhcmdldEdsb3cuZGVwdGhUZXh0dXJlID0gbmV3IFRIUkVFLkRlcHRoVGV4dHVyZSggKTtcclxuXHRcdC8vcmVuZGVyVGFyZ2V0R2xvdy5kZXB0aFRleHR1cmUudHlwZSA9IGlzV2ViR0wyID8gVEhSRUUuRmxvYXRUeXBlIDogVEhSRUUuVW5zaWduZWRTaG9ydFR5cGU7XHJcblx0fVxyXG5cdC8vIFByZXBhcmUgdGhlIGJsdXIgc2hhZGVyIHBhc3Nlc1xyXG5cdHZhciBoYmx1ciA9IG5ldyBUSFJFRS5TaGFkZXJQYXNzKCBUSFJFRS5Ib3Jpem9udGFsQmx1clNoYWRlciApO1xyXG5cdHZhciB2Ymx1ciA9IG5ldyBUSFJFRS5TaGFkZXJQYXNzKCBUSFJFRS5WZXJ0aWNhbEJsdXJTaGFkZXIgKTtcclxuXHJcblx0dmFyIGJsdXJpbmVzcyA9IDE7XHJcblxyXG5cdGhibHVyLnVuaWZvcm1zWyBcImhcIiBdLnZhbHVlID0gYmx1cmluZXNzIC8gd2luZG93LmlubmVyV2lkdGg7XHJcblx0Ly9oYmx1ci5tYXRlcmlhbC5kZXB0aFRlc3QgPSBmYWxzZTtcclxuXHQvL2hibHVyLm1hdGVyaWFsLmRlcHRoV3JpdGUgPSBmYWxzZTtcclxuXHJcblx0dmJsdXIudW5pZm9ybXNbIFwidlwiIF0udmFsdWUgPSBibHVyaW5lc3MgLyB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcblx0Ly92Ymx1ci5tYXRlcmlhbC5kZXB0aFRlc3QgPSBmYWxzZTtcclxuXHQvL3ZibHVyLm1hdGVyaWFsLmRlcHRoV3JpdGUgPSBmYWxzZTtcclxuXHJcblx0Ly8gUHJlcGFyZSB0aGUgZ2xvdyBzY2VuZSByZW5kZXIgcGFzc1xyXG5cdHZhciByZW5kZXJNb2RlbEdsb3cgPSBuZXcgVEhSRUUuUmVuZGVyUGFzcyggc2NlbmVHbG93LCBjYW1lcmEpO1xyXG5cclxuXHQvLyBDcmVhdGUgdGhlIGdsb3cgY29tcG9zZXJcclxuXHRnbG93Y29tcG9zZXIgPSBuZXcgVEhSRUUuRWZmZWN0Q29tcG9zZXIoIHJlbmRlcmVyLCByZW5kZXJUYXJnZXRHbG93ICk7XHJcblxyXG5cdC8vIEFkZCBhbGwgdGhlIGdsb3cgcGFzc2VzXHJcblx0Z2xvd2NvbXBvc2VyLmFkZFBhc3MoIHJlbmRlck1vZGVsR2xvdyApO1xyXG5cdGdsb3djb21wb3Nlci5hZGRQYXNzKCBoYmx1ciApO1xyXG5cdGdsb3djb21wb3Nlci5hZGRQYXNzKCB2Ymx1ciApO1xyXG5cclxuXHJcblx0Ly8gUHJlcGFyZSB0aGUgYmFzZSBzY2VuZSByZW5kZXIgcGFzc1xyXG5cdHZhciByZW5kZXJNb2RlbCA9IG5ldyBUSFJFRS5SZW5kZXJQYXNzKCBzY2VuZUZsYXQsIGNhbWVyYSApO1xyXG5cdHZhciByZW5kZXJNb2RlbDIgPSBuZXcgVEhSRUUuUmVuZGVyUGFzcyggc2NlbmVHbG93LCBjYW1lcmEgKTtcclxuICAgIC8vdmFyIHJlbmRlck1vZGVsMyA9IG5ldyBUSFJFRS5SZW5kZXJQYXNzKCBzY2VuZU92ZXIsIGNhbWVyYSApO1xyXG5cdHJlbmRlck1vZGVsLmNsZWFyID0gdHJ1ZTtcclxuXHRyZW5kZXJNb2RlbDIuY2xlYXIgPSBmYWxzZTtcclxuICAgIC8vcmVuZGVyTW9kZWwzLmNsZWFyID0gZmFsc2U7XHJcblxyXG5cclxuXHQvLyBQcmVwYXJlIHRoZSBjb21wb3NlcidzIHJlbmRlciB0YXJnZXRcclxuXHRpZiggIXJlbmRlclRhcmdldCApIHtcclxuXHRcdHJlbmRlclRhcmdldCA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlclRhcmdldCggd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodC8qLCByZW5kZXJUYXJnZXRQYXJhbWV0ZXJzKi8gKTtcclxuXHRcdHJlbmRlclRhcmdldEdsb3cudGV4dHVyZS5taW5GaWx0ZXIgPSBUSFJFRS5MaW5lYXJGaWx0ZXI7XHJcblx0XHRyZW5kZXJUYXJnZXRHbG93LnRleHR1cmUubWFnRmlsdGVyID0gVEhSRUUuTGluZWFyRmlsdGVyO1xyXG5cdFx0cmVuZGVyVGFyZ2V0R2xvdy50ZXh0dXJlLnN0ZW5jaWxCdWZlciA9IGZhbHNlO1xyXG5cdFx0cmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZSA9IG5ldyBUSFJFRS5EZXB0aFRleHR1cmUoKTtcclxuXHRcdC8vcmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZS50eXBlID0gaXNXZWJHTDIgPyBUSFJFRS5GbG9hdFR5cGUgOiBUSFJFRS5VbnNpZ25lZFNob3J0VHlwZTtcclxuXHRcdC8vcmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZS50eXBlID0gVEhSRUUuRmxvYXRUeXBlIDsvLzogVEhSRUUuVW5zaWduZWRTaG9ydFR5cGU7XHJcblx0fVxyXG5cdC8vIENyZWF0ZSB0aGUgY29tcG9zZXJcclxuLy9cdHNjZW5lY29tcG9zZXIgPSBuZXcgVEhSRUUuRWZmZWN0Q29tcG9zZXIoIHJlbmRlcmVyLCByZW5kZXJUYXJnZXQgKTtcclxuXHJcblx0Ly8gRmlyc3Qgd2UgbmVlZCB0byBhc3NpZ24gdGhlIGdsb3cgY29tcG9zZXIncyBvdXRwdXQgcmVuZGVyIHRhcmdldCB0byB0aGUgdEdsb3cgc2FtcGxlcjJEIG9mIG91ciBzaGFkZXJcclxuXHQvLyBPbGQgVGhyZWUuanMgcHJlLXI1MFxyXG5cdC8vZmluYWxzaGFkZXIudW5pZm9ybXNbIFwidEdsb3dcIiBdLnRleHR1cmUgPSBnbG93Y29tcG9zZXIucmVuZGVyVGFyZ2V0MjtcclxuXHQvLyBOZXcgVGhyZWUuanNcclxuXHRmaW5hbHNoYWRlci51bmlmb3Jtc1sgXCJ0R2xvd1wiIF0udmFsdWUgPSBnbG93Y29tcG9zZXIucmVuZGVyVGFyZ2V0MjtcclxuXHRmaW5hbHNoYWRlci51bmlmb3Jtc1sgXCJ0R2xvd0RlcHRoXCIgXS52YWx1ZSA9IHJlbmRlclRhcmdldEdsb3cuZGVwdGhUZXh0dXJlO1xyXG5cdGZpbmFsc2hhZGVyLnVuaWZvcm1zWyBcInREaWZmdXNlRGVwdGhcIiBdLnZhbHVlID0gcmVuZGVyVGFyZ2V0LmRlcHRoVGV4dHVyZTtcclxuXHRmaW5hbHNoYWRlci51bmlmb3Jtc1sgXCJjYW1lcmFOZWFyXCJdLnZhbHVlID0gY2FtZXJhLm5lYXI7XHJcblx0ZmluYWxzaGFkZXIudW5pZm9ybXNbIFwiY2FtZXJhRmFyXCJdLnZhbHVlID0gY2FtZXJhLmZhcjtcclxuXHJcblx0Ly9maW5hbHNoYWRlci51bmlmb3Jtc1sgXCJ0RGlmZnVzZVwiIF0udmFsdWUgPSBzY2VuZWNvbXBvc2VyLnJlbmRlclRhcmdldDI7XHJcblx0Ly8gTm90ZSB0aGF0IHRoZSB0RGlmZnVzZSBzYW1wbGVyMkQgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGZpbGxlZCBieSB0aGUgRWZmZWN0Q29tcG9zZXJcclxuXHJcblx0Ly8gUHJlcGFyZSB0aGUgYWRkaXRpdmUgYmxlbmRpbmcgcGFzc1xyXG5cdHZhciBmaW5hbFBhc3MgPSBuZXcgVEhSRUUuU2hhZGVyUGFzcyggZmluYWxzaGFkZXIgKTtcclxuICAgIC8vZmluYWxQYXNzLlxyXG5cdGZpbmFsUGFzcy5uZWVkc1N3YXAgPSBmYWxzZTtcclxuXHQvLyBNYWtlIHN1cmUgdGhlIGFkZGl0aXZlIGJsZW5kaW5nIGlzIHJlbmRlcmVkIHRvIHRoZSBzY3JlZW4gKHNpbmNlIGl0J3MgdGhlIGxhc3QgcGFzcylcclxuXHRmaW5hbFBhc3MucmVuZGVyVG9TY3JlZW4gPSB0cnVlO1xyXG4gICAgLy9yZW5kZXJNb2RlbDMucmVuZGVyVG9TY3JlZW4gPSB0cnVlO1xyXG5cclxuXHQvLyBDcmVhdGUgdGhlIGNvbXBvc2VyXHJcblx0ZmluYWxjb21wb3NlciA9IG5ldyBUSFJFRS5FZmZlY3RDb21wb3NlciggcmVuZGVyZXIsIHJlbmRlclRhcmdldCApO1xyXG5cclxuXHQvLyBBZGQgYWxsIHBhc3Nlc1xyXG5cdGZpbmFsY29tcG9zZXIuYWRkUGFzcyggcmVuZGVyTW9kZWwgKTtcclxuXHRmaW5hbGNvbXBvc2VyLmFkZFBhc3MoIHJlbmRlck1vZGVsMiApO1xyXG5cdGZpbmFsY29tcG9zZXIuYWRkUGFzcyggZmluYWxQYXNzICk7XHJcbn1cclxuICAgIC8vZmluYWxjb21wb3Nlci5hZGRQYXNzKCByZW5kZXJNb2RlbDMgKTtcclxufVxyXG5cclxuXHJcblxyXG4vL2V4cG9ydHMucmVuZGVyID1cbmdsb3cucmVuZGVyID0gZnVuY3Rpb24gZ2xvd1JlbmRlcigpIHtcbiAgaWYoICFWb3hlbGFyaXVtLlNldHRpbmdzLnVzZV9iYXNpY19tYXRlcmlhbCApIHtcclxuICAgIHByZUdsb3coKTtcclxuICAgIGdsb3djb21wb3Nlci5yZW5kZXIoKTtcclxuXHJcbiAgICBwcmVGbGF0KCk7XHJcblx0Ly9zY2VuZWNvbXBvc2VyLnJlbmRlcigpO1xyXG5cclxuXHRmaW5hbHNoYWRlci51bmlmb3Jtc1sgXCJ0R2xvd1wiIF0udmFsdWUgPSBnbG93Y29tcG9zZXIucmVuZGVyVGFyZ2V0MjtcclxuXHRmaW5hbHNoYWRlci51bmlmb3Jtc1sgXCJ0R2xvd0RlcHRoXCIgXS52YWx1ZSA9IHJlbmRlclRhcmdldEdsb3cuZGVwdGhUZXh0dXJlLnRleHR1cmU7XHJcblx0ZmluYWxzaGFkZXIudW5pZm9ybXNbIFwidERpZmZ1c2VEZXB0aFwiIF0udmFsdWUgPSByZW5kZXJUYXJnZXQuZGVwdGhUZXh0dXJlLnRleHR1cmU7XHJcblx0ZmluYWxzaGFkZXIudW5pZm9ybXNbIFwiY2FtZXJhTmVhclwiXS52YWx1ZSA9IGNhbWVyYS5uZWFyO1xyXG5cdGZpbmFsc2hhZGVyLnVuaWZvcm1zWyBcImNhbWVyYUZhclwiXS52YWx1ZSA9IGNhbWVyYS5mYXI7XHJcblxyXG5cclxuICAgIGZpbmFsY29tcG9zZXIucmVuZGVyKCk7XHJcblx0ICAgaWYoIG92ZXJsYXkgKVxyXG5cdCAgICAgZ2xvdy5yZW5kZXJlci5yZW5kZXIoIG92ZXJsYXksIGNhbWVyYSApO1xyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIGdsb3cucmVuZGVyZXIucmVuZGVyKCBzY2VuZSwgY2FtZXJhICk7XHJcbiAgICBpZiggb3ZlcmxheSApXHJcbiAgXHQgICAgIGdsb3cucmVuZGVyZXIucmVuZGVyKCBvdmVybGF5LCBjYW1lcmEgKTtcclxuXHJcbiAgfVxyXG4gIGlmKCBWb3hlbGFyaXVtLlNldHRpbmdzLlZSIClcblx0ICBlZmZlY3Quc3VibWl0RnJhbWUoKTtcclxuXHJcbn1cclxuIiwiaWYgKGdsb2JhbC5HRU5UTFkpIHJlcXVpcmUgPSBHRU5UTFkuaGlqYWNrKHJlcXVpcmUpO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKSxcbiAgICBXcml0ZVN0cmVhbSA9IHJlcXVpcmUoJ2ZzJykuV3JpdGVTdHJlYW0sXG4gICAgRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnZXZlbnRzJykuRXZlbnRFbWl0dGVyLFxuICAgIGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xuXG5mdW5jdGlvbiBGaWxlKHByb3BlcnRpZXMpIHtcbiAgRXZlbnRFbWl0dGVyLmNhbGwodGhpcyk7XG5cbiAgdGhpcy5zaXplID0gMDtcbiAgdGhpcy5wYXRoID0gbnVsbDtcbiAgdGhpcy5uYW1lID0gbnVsbDtcbiAgdGhpcy50eXBlID0gbnVsbDtcbiAgdGhpcy5oYXNoID0gbnVsbDtcbiAgdGhpcy5sYXN0TW9kaWZpZWREYXRlID0gbnVsbDtcblxuICB0aGlzLl93cml0ZVN0cmVhbSA9IG51bGw7XG4gIFxuICBmb3IgKHZhciBrZXkgaW4gcHJvcGVydGllcykge1xuICAgIHRoaXNba2V5XSA9IHByb3BlcnRpZXNba2V5XTtcbiAgfVxuXG4gIGlmKHR5cGVvZiB0aGlzLmhhc2ggPT09ICdzdHJpbmcnKSB7XG4gICAgdGhpcy5oYXNoID0gY3J5cHRvLmNyZWF0ZUhhc2gocHJvcGVydGllcy5oYXNoKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmhhc2ggPSBudWxsO1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cyA9IEZpbGU7XG51dGlsLmluaGVyaXRzKEZpbGUsIEV2ZW50RW1pdHRlcik7XG5cbkZpbGUucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5fd3JpdGVTdHJlYW0gPSBuZXcgV3JpdGVTdHJlYW0odGhpcy5wYXRoKTtcbn07XG5cbkZpbGUucHJvdG90eXBlLnRvSlNPTiA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4ge1xuICAgIHNpemU6IHRoaXMuc2l6ZSxcbiAgICBwYXRoOiB0aGlzLnBhdGgsXG4gICAgbmFtZTogdGhpcy5uYW1lLFxuICAgIHR5cGU6IHRoaXMudHlwZSxcbiAgICBtdGltZTogdGhpcy5sYXN0TW9kaWZpZWREYXRlLFxuICAgIGxlbmd0aDogdGhpcy5sZW5ndGgsXG4gICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWUsXG4gICAgbWltZTogdGhpcy5taW1lXG4gIH07XG59O1xuXG5GaWxlLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKGJ1ZmZlciwgY2IpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBpZiAoc2VsZi5oYXNoKSB7XG4gICAgc2VsZi5oYXNoLnVwZGF0ZShidWZmZXIpO1xuICB9XG4gIHRoaXMuX3dyaXRlU3RyZWFtLndyaXRlKGJ1ZmZlciwgZnVuY3Rpb24oKSB7XG4gICAgc2VsZi5sYXN0TW9kaWZpZWREYXRlID0gbmV3IERhdGUoKTtcbiAgICBzZWxmLnNpemUgKz0gYnVmZmVyLmxlbmd0aDtcbiAgICBzZWxmLmVtaXQoJ3Byb2dyZXNzJywgc2VsZi5zaXplKTtcbiAgICBjYigpO1xuICB9KTtcbn07XG5cbkZpbGUucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKGNiKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgaWYgKHNlbGYuaGFzaCkge1xuICAgIHNlbGYuaGFzaCA9IHNlbGYuaGFzaC5kaWdlc3QoJ2hleCcpO1xuICB9XG4gIHRoaXMuX3dyaXRlU3RyZWFtLmVuZChmdW5jdGlvbigpIHtcbiAgICBzZWxmLmVtaXQoJ2VuZCcpO1xuICAgIGNiKCk7XG4gIH0pO1xufTtcbiIsImlmIChnbG9iYWwuR0VOVExZKSByZXF1aXJlID0gR0VOVExZLmhpamFjayhyZXF1aXJlKTtcblxudmFyIGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xudmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbCcpLFxuICAgIHBhdGggPSByZXF1aXJlKCdwYXRoJyksXG4gICAgRmlsZSA9IHJlcXVpcmUoJy4vZmlsZScpLFxuICAgIE11bHRpcGFydFBhcnNlciA9IHJlcXVpcmUoJy4vbXVsdGlwYXJ0X3BhcnNlcicpLk11bHRpcGFydFBhcnNlcixcbiAgICBRdWVyeXN0cmluZ1BhcnNlciA9IHJlcXVpcmUoJy4vcXVlcnlzdHJpbmdfcGFyc2VyJykuUXVlcnlzdHJpbmdQYXJzZXIsXG4gICAgT2N0ZXRQYXJzZXIgICAgICAgPSByZXF1aXJlKCcuL29jdGV0X3BhcnNlcicpLk9jdGV0UGFyc2VyLFxuICAgIEpTT05QYXJzZXIgPSByZXF1aXJlKCcuL2pzb25fcGFyc2VyJykuSlNPTlBhcnNlcixcbiAgICBTdHJpbmdEZWNvZGVyID0gcmVxdWlyZSgnc3RyaW5nX2RlY29kZXInKS5TdHJpbmdEZWNvZGVyLFxuICAgIEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoJ2V2ZW50cycpLkV2ZW50RW1pdHRlcixcbiAgICBTdHJlYW0gPSByZXF1aXJlKCdzdHJlYW0nKS5TdHJlYW0sXG4gICAgb3MgPSByZXF1aXJlKCdvcycpO1xuXG5mdW5jdGlvbiBJbmNvbWluZ0Zvcm0ob3B0cykge1xuICBpZiAoISh0aGlzIGluc3RhbmNlb2YgSW5jb21pbmdGb3JtKSkgcmV0dXJuIG5ldyBJbmNvbWluZ0Zvcm0ob3B0cyk7XG4gIEV2ZW50RW1pdHRlci5jYWxsKHRoaXMpO1xuXG4gIG9wdHM9b3B0c3x8e307XG5cbiAgdGhpcy5lcnJvciA9IG51bGw7XG4gIHRoaXMuZW5kZWQgPSBmYWxzZTtcblxuICB0aGlzLm1heEZpZWxkcyA9IG9wdHMubWF4RmllbGRzIHx8IDEwMDA7XG4gIHRoaXMubWF4RmllbGRzU2l6ZSA9IG9wdHMubWF4RmllbGRzU2l6ZSB8fCAyICogMTAyNCAqIDEwMjQ7XG4gIHRoaXMua2VlcEV4dGVuc2lvbnMgPSBvcHRzLmtlZXBFeHRlbnNpb25zIHx8IGZhbHNlO1xuICB0aGlzLnVwbG9hZERpciA9IG9wdHMudXBsb2FkRGlyIHx8IG9zLnRtcERpcigpO1xuICB0aGlzLmVuY29kaW5nID0gb3B0cy5lbmNvZGluZyB8fCAndXRmLTgnO1xuICB0aGlzLmhlYWRlcnMgPSBudWxsO1xuICB0aGlzLnR5cGUgPSBudWxsO1xuICB0aGlzLmhhc2ggPSBvcHRzLmhhc2ggfHwgZmFsc2U7XG4gIHRoaXMubXVsdGlwbGVzID0gb3B0cy5tdWx0aXBsZXMgfHwgZmFsc2U7XG5cbiAgdGhpcy5ieXRlc1JlY2VpdmVkID0gbnVsbDtcbiAgdGhpcy5ieXRlc0V4cGVjdGVkID0gbnVsbDtcblxuICB0aGlzLl9wYXJzZXIgPSBudWxsO1xuICB0aGlzLl9mbHVzaGluZyA9IDA7XG4gIHRoaXMuX2ZpZWxkc1NpemUgPSAwO1xuICB0aGlzLm9wZW5lZEZpbGVzID0gW107XG5cbiAgcmV0dXJuIHRoaXM7XG59XG51dGlsLmluaGVyaXRzKEluY29taW5nRm9ybSwgRXZlbnRFbWl0dGVyKTtcbmV4cG9ydHMuSW5jb21pbmdGb3JtID0gSW5jb21pbmdGb3JtO1xuXG5JbmNvbWluZ0Zvcm0ucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24ocmVxLCBjYikge1xuICB0aGlzLnBhdXNlID0gZnVuY3Rpb24oKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJlcS5wYXVzZSgpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgLy8gdGhlIHN0cmVhbSB3YXMgZGVzdHJveWVkXG4gICAgICBpZiAoIXRoaXMuZW5kZWQpIHtcbiAgICAgICAgLy8gYmVmb3JlIGl0IHdhcyBjb21wbGV0ZWQsIGNyYXNoICYgYnVyblxuICAgICAgICB0aGlzLl9lcnJvcihlcnIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICB0aGlzLnJlc3VtZSA9IGZ1bmN0aW9uKCkge1xuICAgIHRyeSB7XG4gICAgICByZXEucmVzdW1lKCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyB0aGUgc3RyZWFtIHdhcyBkZXN0cm95ZWRcbiAgICAgIGlmICghdGhpcy5lbmRlZCkge1xuICAgICAgICAvLyBiZWZvcmUgaXQgd2FzIGNvbXBsZXRlZCwgY3Jhc2ggJiBidXJuXG4gICAgICAgIHRoaXMuX2Vycm9yKGVycik7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH07XG5cbiAgLy8gU2V0dXAgY2FsbGJhY2sgZmlyc3QsIHNvIHdlIGRvbid0IG1pc3MgYW55dGhpbmcgZnJvbSBkYXRhIGV2ZW50cyBlbWl0dGVkXG4gIC8vIGltbWVkaWF0ZWx5LlxuICBpZiAoY2IpIHtcbiAgICB2YXIgZmllbGRzID0ge30sIGZpbGVzID0ge307XG4gICAgdGhpc1xuICAgICAgLm9uKCdmaWVsZCcsIGZ1bmN0aW9uKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGZpZWxkc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgfSlcbiAgICAgIC5vbignZmlsZScsIGZ1bmN0aW9uKG5hbWUsIGZpbGUpIHtcbiAgICAgICAgaWYgKHRoaXMubXVsdGlwbGVzKSB7XG4gICAgICAgICAgaWYgKGZpbGVzW25hbWVdKSB7XG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoZmlsZXNbbmFtZV0pKSB7XG4gICAgICAgICAgICAgIGZpbGVzW25hbWVdID0gW2ZpbGVzW25hbWVdXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbGVzW25hbWVdLnB1c2goZmlsZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbGVzW25hbWVdID0gZmlsZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZmlsZXNbbmFtZV0gPSBmaWxlO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGVycikge1xuICAgICAgICBjYihlcnIsIGZpZWxkcywgZmlsZXMpO1xuICAgICAgfSlcbiAgICAgIC5vbignZW5kJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGNiKG51bGwsIGZpZWxkcywgZmlsZXMpO1xuICAgICAgfSk7XG4gIH1cblxuICAvLyBQYXJzZSBoZWFkZXJzIGFuZCBzZXR1cCB0aGUgcGFyc2VyLCByZWFkeSB0byBzdGFydCBsaXN0ZW5pbmcgZm9yIGRhdGEuXG4gIHRoaXMud3JpdGVIZWFkZXJzKHJlcS5oZWFkZXJzKTtcblxuICAvLyBTdGFydCBsaXN0ZW5pbmcgZm9yIGRhdGEuXG4gIHZhciBzZWxmID0gdGhpcztcbiAgcmVxXG4gICAgLm9uKCdlcnJvcicsIGZ1bmN0aW9uKGVycikge1xuICAgICAgc2VsZi5fZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5vbignYWJvcnRlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5lbWl0KCdhYm9ydGVkJyk7XG4gICAgICBzZWxmLl9lcnJvcihuZXcgRXJyb3IoJ1JlcXVlc3QgYWJvcnRlZCcpKTtcbiAgICB9KVxuICAgIC5vbignZGF0YScsIGZ1bmN0aW9uKGJ1ZmZlcikge1xuICAgICAgc2VsZi53cml0ZShidWZmZXIpO1xuICAgIH0pXG4gICAgLm9uKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChzZWxmLmVycm9yKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgdmFyIGVyciA9IHNlbGYuX3BhcnNlci5lbmQoKTtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgc2VsZi5fZXJyb3IoZXJyKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbkluY29taW5nRm9ybS5wcm90b3R5cGUud3JpdGVIZWFkZXJzID0gZnVuY3Rpb24oaGVhZGVycykge1xuICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xuICB0aGlzLl9wYXJzZUNvbnRlbnRMZW5ndGgoKTtcbiAgdGhpcy5fcGFyc2VDb250ZW50VHlwZSgpO1xufTtcblxuSW5jb21pbmdGb3JtLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKGJ1ZmZlcikge1xuICBpZiAodGhpcy5lcnJvcikge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoIXRoaXMuX3BhcnNlcikge1xuICAgIHRoaXMuX2Vycm9yKG5ldyBFcnJvcigndW5pbml0aWFsaXplZCBwYXJzZXInKSk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5ieXRlc1JlY2VpdmVkICs9IGJ1ZmZlci5sZW5ndGg7XG4gIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCB0aGlzLmJ5dGVzUmVjZWl2ZWQsIHRoaXMuYnl0ZXNFeHBlY3RlZCk7XG5cbiAgdmFyIGJ5dGVzUGFyc2VkID0gdGhpcy5fcGFyc2VyLndyaXRlKGJ1ZmZlcik7XG4gIGlmIChieXRlc1BhcnNlZCAhPT0gYnVmZmVyLmxlbmd0aCkge1xuICAgIHRoaXMuX2Vycm9yKG5ldyBFcnJvcigncGFyc2VyIGVycm9yLCAnK2J5dGVzUGFyc2VkKycgb2YgJytidWZmZXIubGVuZ3RoKycgYnl0ZXMgcGFyc2VkJykpO1xuICB9XG5cbiAgcmV0dXJuIGJ5dGVzUGFyc2VkO1xufTtcblxuSW5jb21pbmdGb3JtLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uKCkge1xuICAvLyB0aGlzIGRvZXMgbm90aGluZywgdW5sZXNzIG92ZXJ3cml0dGVuIGluIEluY29taW5nRm9ybS5wYXJzZVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5JbmNvbWluZ0Zvcm0ucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uKCkge1xuICAvLyB0aGlzIGRvZXMgbm90aGluZywgdW5sZXNzIG92ZXJ3cml0dGVuIGluIEluY29taW5nRm9ybS5wYXJzZVxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5JbmNvbWluZ0Zvcm0ucHJvdG90eXBlLm9uUGFydCA9IGZ1bmN0aW9uKHBhcnQpIHtcbiAgLy8gdGhpcyBtZXRob2QgY2FuIGJlIG92ZXJ3cml0dGVuIGJ5IHRoZSB1c2VyXG4gIHRoaXMuaGFuZGxlUGFydChwYXJ0KTtcbn07XG5cbkluY29taW5nRm9ybS5wcm90b3R5cGUuaGFuZGxlUGFydCA9IGZ1bmN0aW9uKHBhcnQpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gIGlmIChwYXJ0LmZpbGVuYW1lID09PSB1bmRlZmluZWQpIHtcbiAgICB2YXIgdmFsdWUgPSAnJ1xuICAgICAgLCBkZWNvZGVyID0gbmV3IFN0cmluZ0RlY29kZXIodGhpcy5lbmNvZGluZyk7XG5cbiAgICBwYXJ0Lm9uKCdkYXRhJywgZnVuY3Rpb24oYnVmZmVyKSB7XG4gICAgICBzZWxmLl9maWVsZHNTaXplICs9IGJ1ZmZlci5sZW5ndGg7XG4gICAgICBpZiAoc2VsZi5fZmllbGRzU2l6ZSA+IHNlbGYubWF4RmllbGRzU2l6ZSkge1xuICAgICAgICBzZWxmLl9lcnJvcihuZXcgRXJyb3IoJ21heEZpZWxkc1NpemUgZXhjZWVkZWQsIHJlY2VpdmVkICcrc2VsZi5fZmllbGRzU2l6ZSsnIGJ5dGVzIG9mIGZpZWxkIGRhdGEnKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZhbHVlICs9IGRlY29kZXIud3JpdGUoYnVmZmVyKTtcbiAgICB9KTtcblxuICAgIHBhcnQub24oJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5lbWl0KCdmaWVsZCcsIHBhcnQubmFtZSwgdmFsdWUpO1xuICAgIH0pO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuX2ZsdXNoaW5nKys7XG5cbiAgdmFyIGZpbGUgPSBuZXcgRmlsZSh7XG4gICAgcGF0aDogdGhpcy5fdXBsb2FkUGF0aChwYXJ0LmZpbGVuYW1lKSxcbiAgICBuYW1lOiBwYXJ0LmZpbGVuYW1lLFxuICAgIHR5cGU6IHBhcnQubWltZSxcbiAgICBoYXNoOiBzZWxmLmhhc2hcbiAgfSk7XG5cbiAgdGhpcy5lbWl0KCdmaWxlQmVnaW4nLCBwYXJ0Lm5hbWUsIGZpbGUpO1xuXG4gIGZpbGUub3BlbigpO1xuICB0aGlzLm9wZW5lZEZpbGVzLnB1c2goZmlsZSk7XG5cbiAgcGFydC5vbignZGF0YScsIGZ1bmN0aW9uKGJ1ZmZlcikge1xuICAgIGlmIChidWZmZXIubGVuZ3RoID09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2VsZi5wYXVzZSgpO1xuICAgIGZpbGUud3JpdGUoYnVmZmVyLCBmdW5jdGlvbigpIHtcbiAgICAgIHNlbGYucmVzdW1lKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHBhcnQub24oJ2VuZCcsIGZ1bmN0aW9uKCkge1xuICAgIGZpbGUuZW5kKGZ1bmN0aW9uKCkge1xuICAgICAgc2VsZi5fZmx1c2hpbmctLTtcbiAgICAgIHNlbGYuZW1pdCgnZmlsZScsIHBhcnQubmFtZSwgZmlsZSk7XG4gICAgICBzZWxmLl9tYXliZUVuZCgpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmZ1bmN0aW9uIGR1bW15UGFyc2VyKHNlbGYpIHtcbiAgcmV0dXJuIHtcbiAgICBlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgIHNlbGYuZW5kZWQgPSB0cnVlO1xuICAgICAgc2VsZi5fbWF5YmVFbmQoKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfTtcbn1cblxuSW5jb21pbmdGb3JtLnByb3RvdHlwZS5fcGFyc2VDb250ZW50VHlwZSA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy5ieXRlc0V4cGVjdGVkID09PSAwKSB7XG4gICAgdGhpcy5fcGFyc2VyID0gZHVtbXlQYXJzZXIodGhpcyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCF0aGlzLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddKSB7XG4gICAgdGhpcy5fZXJyb3IobmV3IEVycm9yKCdiYWQgY29udGVudC10eXBlIGhlYWRlciwgbm8gY29udGVudC10eXBlJykpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddLm1hdGNoKC9vY3RldC1zdHJlYW0vaSkpIHtcbiAgICB0aGlzLl9pbml0T2N0ZXRTdHJlYW0oKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodGhpcy5oZWFkZXJzWydjb250ZW50LXR5cGUnXS5tYXRjaCgvdXJsZW5jb2RlZC9pKSkge1xuICAgIHRoaXMuX2luaXRVcmxlbmNvZGVkKCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHRoaXMuaGVhZGVyc1snY29udGVudC10eXBlJ10ubWF0Y2goL211bHRpcGFydC9pKSkge1xuICAgIHZhciBtID0gdGhpcy5oZWFkZXJzWydjb250ZW50LXR5cGUnXS5tYXRjaCgvYm91bmRhcnk9KD86XCIoW15cIl0rKVwifChbXjtdKykpL2kpO1xuICAgIGlmIChtKSB7XG4gICAgICB0aGlzLl9pbml0TXVsdGlwYXJ0KG1bMV0gfHwgbVsyXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2Vycm9yKG5ldyBFcnJvcignYmFkIGNvbnRlbnQtdHlwZSBoZWFkZXIsIG5vIG11bHRpcGFydCBib3VuZGFyeScpKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHRoaXMuaGVhZGVyc1snY29udGVudC10eXBlJ10ubWF0Y2goL2pzb24vaSkpIHtcbiAgICB0aGlzLl9pbml0SlNPTmVuY29kZWQoKTtcbiAgICByZXR1cm47XG4gIH1cblxuICB0aGlzLl9lcnJvcihuZXcgRXJyb3IoJ2JhZCBjb250ZW50LXR5cGUgaGVhZGVyLCB1bmtub3duIGNvbnRlbnQtdHlwZTogJyt0aGlzLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddKSk7XG59O1xuXG5JbmNvbWluZ0Zvcm0ucHJvdG90eXBlLl9lcnJvciA9IGZ1bmN0aW9uKGVycikge1xuICBpZiAodGhpcy5lcnJvciB8fCB0aGlzLmVuZGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdGhpcy5lcnJvciA9IGVycjtcbiAgdGhpcy5lbWl0KCdlcnJvcicsIGVycik7XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5vcGVuZWRGaWxlcykpIHtcbiAgICB0aGlzLm9wZW5lZEZpbGVzLmZvckVhY2goZnVuY3Rpb24oZmlsZSkge1xuICAgICAgZmlsZS5fd3JpdGVTdHJlYW0uZGVzdHJveSgpO1xuICAgICAgc2V0VGltZW91dChmcy51bmxpbmssIDAsIGZpbGUucGF0aCwgZnVuY3Rpb24oZXJyb3IpIHsgfSk7XG4gICAgfSk7XG4gIH1cbn07XG5cbkluY29taW5nRm9ybS5wcm90b3R5cGUuX3BhcnNlQ29udGVudExlbmd0aCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLmJ5dGVzUmVjZWl2ZWQgPSAwO1xuICBpZiAodGhpcy5oZWFkZXJzWydjb250ZW50LWxlbmd0aCddKSB7XG4gICAgdGhpcy5ieXRlc0V4cGVjdGVkID0gcGFyc2VJbnQodGhpcy5oZWFkZXJzWydjb250ZW50LWxlbmd0aCddLCAxMCk7XG4gIH0gZWxzZSBpZiAodGhpcy5oZWFkZXJzWyd0cmFuc2Zlci1lbmNvZGluZyddID09PSB1bmRlZmluZWQpIHtcbiAgICB0aGlzLmJ5dGVzRXhwZWN0ZWQgPSAwO1xuICB9XG5cbiAgaWYgKHRoaXMuYnl0ZXNFeHBlY3RlZCAhPT0gbnVsbCkge1xuICAgIHRoaXMuZW1pdCgncHJvZ3Jlc3MnLCB0aGlzLmJ5dGVzUmVjZWl2ZWQsIHRoaXMuYnl0ZXNFeHBlY3RlZCk7XG4gIH1cbn07XG5cbkluY29taW5nRm9ybS5wcm90b3R5cGUuX25ld1BhcnNlciA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gbmV3IE11bHRpcGFydFBhcnNlcigpO1xufTtcblxuSW5jb21pbmdGb3JtLnByb3RvdHlwZS5faW5pdE11bHRpcGFydCA9IGZ1bmN0aW9uKGJvdW5kYXJ5KSB7XG4gIHRoaXMudHlwZSA9ICdtdWx0aXBhcnQnO1xuXG4gIHZhciBwYXJzZXIgPSBuZXcgTXVsdGlwYXJ0UGFyc2VyKCksXG4gICAgICBzZWxmID0gdGhpcyxcbiAgICAgIGhlYWRlckZpZWxkLFxuICAgICAgaGVhZGVyVmFsdWUsXG4gICAgICBwYXJ0O1xuXG4gIHBhcnNlci5pbml0V2l0aEJvdW5kYXJ5KGJvdW5kYXJ5KTtcblxuICBwYXJzZXIub25QYXJ0QmVnaW4gPSBmdW5jdGlvbigpIHtcbiAgICBwYXJ0ID0gbmV3IFN0cmVhbSgpO1xuICAgIHBhcnQucmVhZGFibGUgPSB0cnVlO1xuICAgIHBhcnQuaGVhZGVycyA9IHt9O1xuICAgIHBhcnQubmFtZSA9IG51bGw7XG4gICAgcGFydC5maWxlbmFtZSA9IG51bGw7XG4gICAgcGFydC5taW1lID0gbnVsbDtcblxuICAgIHBhcnQudHJhbnNmZXJFbmNvZGluZyA9ICdiaW5hcnknO1xuICAgIHBhcnQudHJhbnNmZXJCdWZmZXIgPSAnJztcblxuICAgIGhlYWRlckZpZWxkID0gJyc7XG4gICAgaGVhZGVyVmFsdWUgPSAnJztcbiAgfTtcblxuICBwYXJzZXIub25IZWFkZXJGaWVsZCA9IGZ1bmN0aW9uKGIsIHN0YXJ0LCBlbmQpIHtcbiAgICBoZWFkZXJGaWVsZCArPSBiLnRvU3RyaW5nKHNlbGYuZW5jb2RpbmcsIHN0YXJ0LCBlbmQpO1xuICB9O1xuXG4gIHBhcnNlci5vbkhlYWRlclZhbHVlID0gZnVuY3Rpb24oYiwgc3RhcnQsIGVuZCkge1xuICAgIGhlYWRlclZhbHVlICs9IGIudG9TdHJpbmcoc2VsZi5lbmNvZGluZywgc3RhcnQsIGVuZCk7XG4gIH07XG5cbiAgcGFyc2VyLm9uSGVhZGVyRW5kID0gZnVuY3Rpb24oKSB7XG4gICAgaGVhZGVyRmllbGQgPSBoZWFkZXJGaWVsZC50b0xvd2VyQ2FzZSgpO1xuICAgIHBhcnQuaGVhZGVyc1toZWFkZXJGaWVsZF0gPSBoZWFkZXJWYWx1ZTtcblxuICAgIHZhciBtID0gaGVhZGVyVmFsdWUubWF0Y2goL1xcYm5hbWU9XCIoW15cIl0rKVwiL2kpO1xuICAgIGlmIChoZWFkZXJGaWVsZCA9PSAnY29udGVudC1kaXNwb3NpdGlvbicpIHtcbiAgICAgIGlmIChtKSB7XG4gICAgICAgIHBhcnQubmFtZSA9IG1bMV07XG4gICAgICB9XG5cbiAgICAgIHBhcnQuZmlsZW5hbWUgPSBzZWxmLl9maWxlTmFtZShoZWFkZXJWYWx1ZSk7XG4gICAgfSBlbHNlIGlmIChoZWFkZXJGaWVsZCA9PSAnY29udGVudC10eXBlJykge1xuICAgICAgcGFydC5taW1lID0gaGVhZGVyVmFsdWU7XG4gICAgfSBlbHNlIGlmIChoZWFkZXJGaWVsZCA9PSAnY29udGVudC10cmFuc2Zlci1lbmNvZGluZycpIHtcbiAgICAgIHBhcnQudHJhbnNmZXJFbmNvZGluZyA9IGhlYWRlclZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgfVxuXG4gICAgaGVhZGVyRmllbGQgPSAnJztcbiAgICBoZWFkZXJWYWx1ZSA9ICcnO1xuICB9O1xuXG4gIHBhcnNlci5vbkhlYWRlcnNFbmQgPSBmdW5jdGlvbigpIHtcbiAgICBzd2l0Y2gocGFydC50cmFuc2ZlckVuY29kaW5nKXtcbiAgICAgIGNhc2UgJ2JpbmFyeSc6XG4gICAgICBjYXNlICc3Yml0JzpcbiAgICAgIGNhc2UgJzhiaXQnOlxuICAgICAgcGFyc2VyLm9uUGFydERhdGEgPSBmdW5jdGlvbihiLCBzdGFydCwgZW5kKSB7XG4gICAgICAgIHBhcnQuZW1pdCgnZGF0YScsIGIuc2xpY2Uoc3RhcnQsIGVuZCkpO1xuICAgICAgfTtcblxuICAgICAgcGFyc2VyLm9uUGFydEVuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBwYXJ0LmVtaXQoJ2VuZCcpO1xuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdiYXNlNjQnOlxuICAgICAgcGFyc2VyLm9uUGFydERhdGEgPSBmdW5jdGlvbihiLCBzdGFydCwgZW5kKSB7XG4gICAgICAgIHBhcnQudHJhbnNmZXJCdWZmZXIgKz0gYi5zbGljZShzdGFydCwgZW5kKS50b1N0cmluZygnYXNjaWknKTtcblxuICAgICAgICAvKlxuICAgICAgICBmb3VyIGJ5dGVzIChjaGFycykgaW4gYmFzZTY0IGNvbnZlcnRzIHRvIHRocmVlIGJ5dGVzIGluIGJpbmFyeVxuICAgICAgICBlbmNvZGluZy4gU28gd2Ugc2hvdWxkIGFsd2F5cyB3b3JrIHdpdGggYSBudW1iZXIgb2YgYnl0ZXMgdGhhdFxuICAgICAgICBjYW4gYmUgZGl2aWRlZCBieSA0LCBpdCB3aWxsIHJlc3VsdCBpbiBhIG51bWJlciBvZiBidXl0ZXMgdGhhdFxuICAgICAgICBjYW4gYmUgZGl2aWRlZCB2eSAzLlxuICAgICAgICAqL1xuICAgICAgICB2YXIgb2Zmc2V0ID0gcGFyc2VJbnQocGFydC50cmFuc2ZlckJ1ZmZlci5sZW5ndGggLyA0LCAxMCkgKiA0O1xuICAgICAgICBwYXJ0LmVtaXQoJ2RhdGEnLCBuZXcgQnVmZmVyKHBhcnQudHJhbnNmZXJCdWZmZXIuc3Vic3RyaW5nKDAsIG9mZnNldCksICdiYXNlNjQnKSk7XG4gICAgICAgIHBhcnQudHJhbnNmZXJCdWZmZXIgPSBwYXJ0LnRyYW5zZmVyQnVmZmVyLnN1YnN0cmluZyhvZmZzZXQpO1xuICAgICAgfTtcblxuICAgICAgcGFyc2VyLm9uUGFydEVuZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBwYXJ0LmVtaXQoJ2RhdGEnLCBuZXcgQnVmZmVyKHBhcnQudHJhbnNmZXJCdWZmZXIsICdiYXNlNjQnKSk7XG4gICAgICAgIHBhcnQuZW1pdCgnZW5kJyk7XG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gc2VsZi5fZXJyb3IobmV3IEVycm9yKCd1bmtub3duIHRyYW5zZmVyLWVuY29kaW5nJykpO1xuICAgIH1cblxuICAgIHNlbGYub25QYXJ0KHBhcnQpO1xuICB9O1xuXG5cbiAgcGFyc2VyLm9uRW5kID0gZnVuY3Rpb24oKSB7XG4gICAgc2VsZi5lbmRlZCA9IHRydWU7XG4gICAgc2VsZi5fbWF5YmVFbmQoKTtcbiAgfTtcblxuICB0aGlzLl9wYXJzZXIgPSBwYXJzZXI7XG59O1xuXG5JbmNvbWluZ0Zvcm0ucHJvdG90eXBlLl9maWxlTmFtZSA9IGZ1bmN0aW9uKGhlYWRlclZhbHVlKSB7XG4gIHZhciBtID0gaGVhZGVyVmFsdWUubWF0Y2goL1xcYmZpbGVuYW1lPVwiKC4qPylcIigkfDsgKS9pKTtcbiAgaWYgKCFtKSByZXR1cm47XG5cbiAgdmFyIGZpbGVuYW1lID0gbVsxXS5zdWJzdHIobVsxXS5sYXN0SW5kZXhPZignXFxcXCcpICsgMSk7XG4gIGZpbGVuYW1lID0gZmlsZW5hbWUucmVwbGFjZSgvJTIyL2csICdcIicpO1xuICBmaWxlbmFtZSA9IGZpbGVuYW1lLnJlcGxhY2UoLyYjKFtcXGRdezR9KTsvZywgZnVuY3Rpb24obSwgY29kZSkge1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUpO1xuICB9KTtcbiAgcmV0dXJuIGZpbGVuYW1lO1xufTtcblxuSW5jb21pbmdGb3JtLnByb3RvdHlwZS5faW5pdFVybGVuY29kZWQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy50eXBlID0gJ3VybGVuY29kZWQnO1xuXG4gIHZhciBwYXJzZXIgPSBuZXcgUXVlcnlzdHJpbmdQYXJzZXIodGhpcy5tYXhGaWVsZHMpXG4gICAgLCBzZWxmID0gdGhpcztcblxuICBwYXJzZXIub25GaWVsZCA9IGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgc2VsZi5lbWl0KCdmaWVsZCcsIGtleSwgdmFsKTtcbiAgfTtcblxuICBwYXJzZXIub25FbmQgPSBmdW5jdGlvbigpIHtcbiAgICBzZWxmLmVuZGVkID0gdHJ1ZTtcbiAgICBzZWxmLl9tYXliZUVuZCgpO1xuICB9O1xuXG4gIHRoaXMuX3BhcnNlciA9IHBhcnNlcjtcbn07XG5cbkluY29taW5nRm9ybS5wcm90b3R5cGUuX2luaXRPY3RldFN0cmVhbSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnR5cGUgPSAnb2N0ZXQtc3RyZWFtJztcbiAgdmFyIGZpbGVuYW1lID0gdGhpcy5oZWFkZXJzWyd4LWZpbGUtbmFtZSddO1xuICB2YXIgbWltZSA9IHRoaXMuaGVhZGVyc1snY29udGVudC10eXBlJ107XG5cbiAgdmFyIGZpbGUgPSBuZXcgRmlsZSh7XG4gICAgcGF0aDogdGhpcy5fdXBsb2FkUGF0aChmaWxlbmFtZSksXG4gICAgbmFtZTogZmlsZW5hbWUsXG4gICAgdHlwZTogbWltZVxuICB9KTtcblxuICB0aGlzLmVtaXQoJ2ZpbGVCZWdpbicsIGZpbGVuYW1lLCBmaWxlKTtcbiAgZmlsZS5vcGVuKCk7XG5cbiAgdGhpcy5fZmx1c2hpbmcrKztcblxuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgc2VsZi5fcGFyc2VyID0gbmV3IE9jdGV0UGFyc2VyKCk7XG5cbiAgLy9LZWVwIHRyYWNrIG9mIHdyaXRlcyB0aGF0IGhhdmVuJ3QgZmluaXNoZWQgc28gd2UgZG9uJ3QgZW1pdCB0aGUgZmlsZSBiZWZvcmUgaXQncyBkb25lIGJlaW5nIHdyaXR0ZW5cbiAgdmFyIG91dHN0YW5kaW5nV3JpdGVzID0gMDtcblxuICBzZWxmLl9wYXJzZXIub24oJ2RhdGEnLCBmdW5jdGlvbihidWZmZXIpe1xuICAgIHNlbGYucGF1c2UoKTtcbiAgICBvdXRzdGFuZGluZ1dyaXRlcysrO1xuXG4gICAgZmlsZS53cml0ZShidWZmZXIsIGZ1bmN0aW9uKCkge1xuICAgICAgb3V0c3RhbmRpbmdXcml0ZXMtLTtcbiAgICAgIHNlbGYucmVzdW1lKCk7XG5cbiAgICAgIGlmKHNlbGYuZW5kZWQpe1xuICAgICAgICBzZWxmLl9wYXJzZXIuZW1pdCgnZG9uZVdyaXRpbmdGaWxlJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIHNlbGYuX3BhcnNlci5vbignZW5kJywgZnVuY3Rpb24oKXtcbiAgICBzZWxmLl9mbHVzaGluZy0tO1xuICAgIHNlbGYuZW5kZWQgPSB0cnVlO1xuXG4gICAgdmFyIGRvbmUgPSBmdW5jdGlvbigpe1xuICAgICAgZmlsZS5lbmQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGYuZW1pdCgnZmlsZScsICdmaWxlJywgZmlsZSk7XG4gICAgICAgIHNlbGYuX21heWJlRW5kKCk7XG4gICAgICB9KTtcbiAgICB9O1xuXG4gICAgaWYob3V0c3RhbmRpbmdXcml0ZXMgPT09IDApe1xuICAgICAgZG9uZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZWxmLl9wYXJzZXIub25jZSgnZG9uZVdyaXRpbmdGaWxlJywgZG9uZSk7XG4gICAgfVxuICB9KTtcbn07XG5cbkluY29taW5nRm9ybS5wcm90b3R5cGUuX2luaXRKU09OZW5jb2RlZCA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLnR5cGUgPSAnanNvbic7XG5cbiAgdmFyIHBhcnNlciA9IG5ldyBKU09OUGFyc2VyKClcbiAgICAsIHNlbGYgPSB0aGlzO1xuXG4gIGlmICh0aGlzLmJ5dGVzRXhwZWN0ZWQpIHtcbiAgICBwYXJzZXIuaW5pdFdpdGhMZW5ndGgodGhpcy5ieXRlc0V4cGVjdGVkKTtcbiAgfVxuXG4gIHBhcnNlci5vbkZpZWxkID0gZnVuY3Rpb24oa2V5LCB2YWwpIHtcbiAgICBzZWxmLmVtaXQoJ2ZpZWxkJywga2V5LCB2YWwpO1xuICB9O1xuXG4gIHBhcnNlci5vbkVuZCA9IGZ1bmN0aW9uKCkge1xuICAgIHNlbGYuZW5kZWQgPSB0cnVlO1xuICAgIHNlbGYuX21heWJlRW5kKCk7XG4gIH07XG5cbiAgdGhpcy5fcGFyc2VyID0gcGFyc2VyO1xufTtcblxuSW5jb21pbmdGb3JtLnByb3RvdHlwZS5fdXBsb2FkUGF0aCA9IGZ1bmN0aW9uKGZpbGVuYW1lKSB7XG4gIHZhciBuYW1lID0gJ3VwbG9hZF8nO1xuICB2YXIgYnVmID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDE2KTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWYubGVuZ3RoOyArK2kpIHtcbiAgICBuYW1lICs9ICgnMCcgKyBidWZbaV0udG9TdHJpbmcoMTYpKS5zbGljZSgtMik7XG4gIH1cblxuICBpZiAodGhpcy5rZWVwRXh0ZW5zaW9ucykge1xuICAgIHZhciBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZW5hbWUpO1xuICAgIGV4dCAgICAgPSBleHQucmVwbGFjZSgvKFxcLlthLXowLTldKykuKi9pLCAnJDEnKTtcblxuICAgIG5hbWUgKz0gZXh0O1xuICB9XG5cbiAgcmV0dXJuIHBhdGguam9pbih0aGlzLnVwbG9hZERpciwgbmFtZSk7XG59O1xuXG5JbmNvbWluZ0Zvcm0ucHJvdG90eXBlLl9tYXliZUVuZCA9IGZ1bmN0aW9uKCkge1xuICBpZiAoIXRoaXMuZW5kZWQgfHwgdGhpcy5fZmx1c2hpbmcgfHwgdGhpcy5lcnJvcikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHRoaXMuZW1pdCgnZW5kJyk7XG59O1xuXG4iLCJ2YXIgSW5jb21pbmdGb3JtID0gcmVxdWlyZSgnLi9pbmNvbWluZ19mb3JtJykuSW5jb21pbmdGb3JtO1xuSW5jb21pbmdGb3JtLkluY29taW5nRm9ybSA9IEluY29taW5nRm9ybTtcbm1vZHVsZS5leHBvcnRzID0gSW5jb21pbmdGb3JtO1xuIiwiaWYgKGdsb2JhbC5HRU5UTFkpIHJlcXVpcmUgPSBHRU5UTFkuaGlqYWNrKHJlcXVpcmUpO1xuXG52YXIgQnVmZmVyID0gcmVxdWlyZSgnYnVmZmVyJykuQnVmZmVyO1xuXG5mdW5jdGlvbiBKU09OUGFyc2VyKCkge1xuICB0aGlzLmRhdGEgPSBuZXcgQnVmZmVyKCcnKTtcbiAgdGhpcy5ieXRlc1dyaXR0ZW4gPSAwO1xufVxuZXhwb3J0cy5KU09OUGFyc2VyID0gSlNPTlBhcnNlcjtcblxuSlNPTlBhcnNlci5wcm90b3R5cGUuaW5pdFdpdGhMZW5ndGggPSBmdW5jdGlvbihsZW5ndGgpIHtcbiAgdGhpcy5kYXRhID0gbmV3IEJ1ZmZlcihsZW5ndGgpO1xufTtcblxuSlNPTlBhcnNlci5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbihidWZmZXIpIHtcbiAgaWYgKHRoaXMuZGF0YS5sZW5ndGggPj0gdGhpcy5ieXRlc1dyaXR0ZW4gKyBidWZmZXIubGVuZ3RoKSB7XG4gICAgYnVmZmVyLmNvcHkodGhpcy5kYXRhLCB0aGlzLmJ5dGVzV3JpdHRlbik7XG4gIH0gZWxzZSB7XG4gICAgdGhpcy5kYXRhID0gQnVmZmVyLmNvbmNhdChbdGhpcy5kYXRhLCBidWZmZXJdKTtcbiAgfVxuICB0aGlzLmJ5dGVzV3JpdHRlbiArPSBidWZmZXIubGVuZ3RoO1xuICByZXR1cm4gYnVmZmVyLmxlbmd0aDtcbn07XG5cbkpTT05QYXJzZXIucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKCkge1xuICB0cnkge1xuICAgIHZhciBmaWVsZHMgPSBKU09OLnBhcnNlKHRoaXMuZGF0YS50b1N0cmluZygndXRmOCcpKTtcbiAgICBmb3IgKHZhciBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICAgIHRoaXMub25GaWVsZChmaWVsZCwgZmllbGRzW2ZpZWxkXSk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7fVxuICB0aGlzLmRhdGEgPSBudWxsO1xuXG4gIHRoaXMub25FbmQoKTtcbn07XG4iLCJ2YXIgQnVmZmVyID0gcmVxdWlyZSgnYnVmZmVyJykuQnVmZmVyLFxuICAgIHMgPSAwLFxuICAgIFMgPVxuICAgIHsgUEFSU0VSX1VOSU5JVElBTElaRUQ6IHMrKyxcbiAgICAgIFNUQVJUOiBzKyssXG4gICAgICBTVEFSVF9CT1VOREFSWTogcysrLFxuICAgICAgSEVBREVSX0ZJRUxEX1NUQVJUOiBzKyssXG4gICAgICBIRUFERVJfRklFTEQ6IHMrKyxcbiAgICAgIEhFQURFUl9WQUxVRV9TVEFSVDogcysrLFxuICAgICAgSEVBREVSX1ZBTFVFOiBzKyssXG4gICAgICBIRUFERVJfVkFMVUVfQUxNT1NUX0RPTkU6IHMrKyxcbiAgICAgIEhFQURFUlNfQUxNT1NUX0RPTkU6IHMrKyxcbiAgICAgIFBBUlRfREFUQV9TVEFSVDogcysrLFxuICAgICAgUEFSVF9EQVRBOiBzKyssXG4gICAgICBQQVJUX0VORDogcysrLFxuICAgICAgRU5EOiBzKytcbiAgICB9LFxuXG4gICAgZiA9IDEsXG4gICAgRiA9XG4gICAgeyBQQVJUX0JPVU5EQVJZOiBmLFxuICAgICAgTEFTVF9CT1VOREFSWTogZiAqPSAyXG4gICAgfSxcblxuICAgIExGID0gMTAsXG4gICAgQ1IgPSAxMyxcbiAgICBTUEFDRSA9IDMyLFxuICAgIEhZUEhFTiA9IDQ1LFxuICAgIENPTE9OID0gNTgsXG4gICAgQSA9IDk3LFxuICAgIFogPSAxMjIsXG5cbiAgICBsb3dlciA9IGZ1bmN0aW9uKGMpIHtcbiAgICAgIHJldHVybiBjIHwgMHgyMDtcbiAgICB9O1xuXG5mb3IgKHMgaW4gUykge1xuICBleHBvcnRzW3NdID0gU1tzXTtcbn1cblxuZnVuY3Rpb24gTXVsdGlwYXJ0UGFyc2VyKCkge1xuICB0aGlzLmJvdW5kYXJ5ID0gbnVsbDtcbiAgdGhpcy5ib3VuZGFyeUNoYXJzID0gbnVsbDtcbiAgdGhpcy5sb29rYmVoaW5kID0gbnVsbDtcbiAgdGhpcy5zdGF0ZSA9IFMuUEFSU0VSX1VOSU5JVElBTElaRUQ7XG5cbiAgdGhpcy5pbmRleCA9IG51bGw7XG4gIHRoaXMuZmxhZ3MgPSAwO1xufVxuZXhwb3J0cy5NdWx0aXBhcnRQYXJzZXIgPSBNdWx0aXBhcnRQYXJzZXI7XG5cbk11bHRpcGFydFBhcnNlci5zdGF0ZVRvU3RyaW5nID0gZnVuY3Rpb24oc3RhdGVOdW1iZXIpIHtcbiAgZm9yICh2YXIgc3RhdGUgaW4gUykge1xuICAgIHZhciBudW1iZXIgPSBTW3N0YXRlXTtcbiAgICBpZiAobnVtYmVyID09PSBzdGF0ZU51bWJlcikgcmV0dXJuIHN0YXRlO1xuICB9XG59O1xuXG5NdWx0aXBhcnRQYXJzZXIucHJvdG90eXBlLmluaXRXaXRoQm91bmRhcnkgPSBmdW5jdGlvbihzdHIpIHtcbiAgdGhpcy5ib3VuZGFyeSA9IG5ldyBCdWZmZXIoc3RyLmxlbmd0aCs0KTtcbiAgdGhpcy5ib3VuZGFyeS53cml0ZSgnXFxyXFxuLS0nLCAwKTtcbiAgdGhpcy5ib3VuZGFyeS53cml0ZShzdHIsIDQpO1xuICB0aGlzLmxvb2tiZWhpbmQgPSBuZXcgQnVmZmVyKHRoaXMuYm91bmRhcnkubGVuZ3RoKzgpO1xuICB0aGlzLnN0YXRlID0gUy5TVEFSVDtcblxuICB0aGlzLmJvdW5kYXJ5Q2hhcnMgPSB7fTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmJvdW5kYXJ5Lmxlbmd0aDsgaSsrKSB7XG4gICAgdGhpcy5ib3VuZGFyeUNoYXJzW3RoaXMuYm91bmRhcnlbaV1dID0gdHJ1ZTtcbiAgfVxufTtcblxuTXVsdGlwYXJ0UGFyc2VyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKGJ1ZmZlcikge1xuICB2YXIgc2VsZiA9IHRoaXMsXG4gICAgICBpID0gMCxcbiAgICAgIGxlbiA9IGJ1ZmZlci5sZW5ndGgsXG4gICAgICBwcmV2SW5kZXggPSB0aGlzLmluZGV4LFxuICAgICAgaW5kZXggPSB0aGlzLmluZGV4LFxuICAgICAgc3RhdGUgPSB0aGlzLnN0YXRlLFxuICAgICAgZmxhZ3MgPSB0aGlzLmZsYWdzLFxuICAgICAgbG9va2JlaGluZCA9IHRoaXMubG9va2JlaGluZCxcbiAgICAgIGJvdW5kYXJ5ID0gdGhpcy5ib3VuZGFyeSxcbiAgICAgIGJvdW5kYXJ5Q2hhcnMgPSB0aGlzLmJvdW5kYXJ5Q2hhcnMsXG4gICAgICBib3VuZGFyeUxlbmd0aCA9IHRoaXMuYm91bmRhcnkubGVuZ3RoLFxuICAgICAgYm91bmRhcnlFbmQgPSBib3VuZGFyeUxlbmd0aCAtIDEsXG4gICAgICBidWZmZXJMZW5ndGggPSBidWZmZXIubGVuZ3RoLFxuICAgICAgYyxcbiAgICAgIGNsLFxuXG4gICAgICBtYXJrID0gZnVuY3Rpb24obmFtZSkge1xuICAgICAgICBzZWxmW25hbWUrJ01hcmsnXSA9IGk7XG4gICAgICB9LFxuICAgICAgY2xlYXIgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgICAgIGRlbGV0ZSBzZWxmW25hbWUrJ01hcmsnXTtcbiAgICAgIH0sXG4gICAgICBjYWxsYmFjayA9IGZ1bmN0aW9uKG5hbWUsIGJ1ZmZlciwgc3RhcnQsIGVuZCkge1xuICAgICAgICBpZiAoc3RhcnQgIT09IHVuZGVmaW5lZCAmJiBzdGFydCA9PT0gZW5kKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGNhbGxiYWNrU3ltYm9sID0gJ29uJytuYW1lLnN1YnN0cigwLCAxKS50b1VwcGVyQ2FzZSgpK25hbWUuc3Vic3RyKDEpO1xuICAgICAgICBpZiAoY2FsbGJhY2tTeW1ib2wgaW4gc2VsZikge1xuICAgICAgICAgIHNlbGZbY2FsbGJhY2tTeW1ib2xdKGJ1ZmZlciwgc3RhcnQsIGVuZCk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBkYXRhQ2FsbGJhY2sgPSBmdW5jdGlvbihuYW1lLCBjbGVhcikge1xuICAgICAgICB2YXIgbWFya1N5bWJvbCA9IG5hbWUrJ01hcmsnO1xuICAgICAgICBpZiAoIShtYXJrU3ltYm9sIGluIHNlbGYpKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjbGVhcikge1xuICAgICAgICAgIGNhbGxiYWNrKG5hbWUsIGJ1ZmZlciwgc2VsZlttYXJrU3ltYm9sXSwgYnVmZmVyLmxlbmd0aCk7XG4gICAgICAgICAgc2VsZlttYXJrU3ltYm9sXSA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FsbGJhY2sobmFtZSwgYnVmZmVyLCBzZWxmW21hcmtTeW1ib2xdLCBpKTtcbiAgICAgICAgICBkZWxldGUgc2VsZlttYXJrU3ltYm9sXTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICBjID0gYnVmZmVyW2ldO1xuICAgIHN3aXRjaCAoc3RhdGUpIHtcbiAgICAgIGNhc2UgUy5QQVJTRVJfVU5JTklUSUFMSVpFRDpcbiAgICAgICAgcmV0dXJuIGk7XG4gICAgICBjYXNlIFMuU1RBUlQ6XG4gICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgc3RhdGUgPSBTLlNUQVJUX0JPVU5EQVJZO1xuICAgICAgY2FzZSBTLlNUQVJUX0JPVU5EQVJZOlxuICAgICAgICBpZiAoaW5kZXggPT0gYm91bmRhcnkubGVuZ3RoIC0gMikge1xuICAgICAgICAgIGlmIChjID09IEhZUEhFTikge1xuICAgICAgICAgICAgZmxhZ3MgfD0gRi5MQVNUX0JPVU5EQVJZO1xuICAgICAgICAgIH0gZWxzZSBpZiAoYyAhPSBDUikge1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5kZXggLSAxID09IGJvdW5kYXJ5Lmxlbmd0aCAtIDIpIHtcbiAgICAgICAgICBpZiAoZmxhZ3MgJiBGLkxBU1RfQk9VTkRBUlkgJiYgYyA9PSBIWVBIRU4pe1xuICAgICAgICAgICAgY2FsbGJhY2soJ2VuZCcpO1xuICAgICAgICAgICAgc3RhdGUgPSBTLkVORDtcbiAgICAgICAgICAgIGZsYWdzID0gMDtcbiAgICAgICAgICB9IGVsc2UgaWYgKCEoZmxhZ3MgJiBGLkxBU1RfQk9VTkRBUlkpICYmIGMgPT0gTEYpIHtcbiAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgIGNhbGxiYWNrKCdwYXJ0QmVnaW4nKTtcbiAgICAgICAgICAgIHN0YXRlID0gUy5IRUFERVJfRklFTERfU1RBUlQ7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjICE9IGJvdW5kYXJ5W2luZGV4KzJdKSB7XG4gICAgICAgICAgaW5kZXggPSAtMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYyA9PSBib3VuZGFyeVtpbmRleCsyXSkge1xuICAgICAgICAgIGluZGV4Kys7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFMuSEVBREVSX0ZJRUxEX1NUQVJUOlxuICAgICAgICBzdGF0ZSA9IFMuSEVBREVSX0ZJRUxEO1xuICAgICAgICBtYXJrKCdoZWFkZXJGaWVsZCcpO1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICBjYXNlIFMuSEVBREVSX0ZJRUxEOlxuICAgICAgICBpZiAoYyA9PSBDUikge1xuICAgICAgICAgIGNsZWFyKCdoZWFkZXJGaWVsZCcpO1xuICAgICAgICAgIHN0YXRlID0gUy5IRUFERVJTX0FMTU9TVF9ET05FO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5kZXgrKztcbiAgICAgICAgaWYgKGMgPT0gSFlQSEVOKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYyA9PSBDT0xPTikge1xuICAgICAgICAgIGlmIChpbmRleCA9PSAxKSB7XG4gICAgICAgICAgICAvLyBlbXB0eSBoZWFkZXIgZmllbGRcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBkYXRhQ2FsbGJhY2soJ2hlYWRlckZpZWxkJywgdHJ1ZSk7XG4gICAgICAgICAgc3RhdGUgPSBTLkhFQURFUl9WQUxVRV9TVEFSVDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGNsID0gbG93ZXIoYyk7XG4gICAgICAgIGlmIChjbCA8IEEgfHwgY2wgPiBaKSB7XG4gICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFMuSEVBREVSX1ZBTFVFX1NUQVJUOlxuICAgICAgICBpZiAoYyA9PSBTUEFDRSkge1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgbWFyaygnaGVhZGVyVmFsdWUnKTtcbiAgICAgICAgc3RhdGUgPSBTLkhFQURFUl9WQUxVRTtcbiAgICAgIGNhc2UgUy5IRUFERVJfVkFMVUU6XG4gICAgICAgIGlmIChjID09IENSKSB7XG4gICAgICAgICAgZGF0YUNhbGxiYWNrKCdoZWFkZXJWYWx1ZScsIHRydWUpO1xuICAgICAgICAgIGNhbGxiYWNrKCdoZWFkZXJFbmQnKTtcbiAgICAgICAgICBzdGF0ZSA9IFMuSEVBREVSX1ZBTFVFX0FMTU9TVF9ET05FO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBTLkhFQURFUl9WQUxVRV9BTE1PU1RfRE9ORTpcbiAgICAgICAgaWYgKGMgIT0gTEYpIHtcbiAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgICAgICBzdGF0ZSA9IFMuSEVBREVSX0ZJRUxEX1NUQVJUO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgUy5IRUFERVJTX0FMTU9TVF9ET05FOlxuICAgICAgICBpZiAoYyAhPSBMRikge1xuICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG5cbiAgICAgICAgY2FsbGJhY2soJ2hlYWRlcnNFbmQnKTtcbiAgICAgICAgc3RhdGUgPSBTLlBBUlRfREFUQV9TVEFSVDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFMuUEFSVF9EQVRBX1NUQVJUOlxuICAgICAgICBzdGF0ZSA9IFMuUEFSVF9EQVRBO1xuICAgICAgICBtYXJrKCdwYXJ0RGF0YScpO1xuICAgICAgY2FzZSBTLlBBUlRfREFUQTpcbiAgICAgICAgcHJldkluZGV4ID0gaW5kZXg7XG5cbiAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgICAgLy8gYm95ZXItbW9vcmUgZGVycml2ZWQgYWxnb3JpdGhtIHRvIHNhZmVseSBza2lwIG5vbi1ib3VuZGFyeSBkYXRhXG4gICAgICAgICAgaSArPSBib3VuZGFyeUVuZDtcbiAgICAgICAgICB3aGlsZSAoaSA8IGJ1ZmZlckxlbmd0aCAmJiAhKGJ1ZmZlcltpXSBpbiBib3VuZGFyeUNoYXJzKSkge1xuICAgICAgICAgICAgaSArPSBib3VuZGFyeUxlbmd0aDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaSAtPSBib3VuZGFyeUVuZDtcbiAgICAgICAgICBjID0gYnVmZmVyW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGluZGV4IDwgYm91bmRhcnkubGVuZ3RoKSB7XG4gICAgICAgICAgaWYgKGJvdW5kYXJ5W2luZGV4XSA9PSBjKSB7XG4gICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgZGF0YUNhbGxiYWNrKCdwYXJ0RGF0YScsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5kZXgrKztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpbmRleCA9PSBib3VuZGFyeS5sZW5ndGgpIHtcbiAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgIGlmIChjID09IENSKSB7XG4gICAgICAgICAgICAvLyBDUiA9IHBhcnQgYm91bmRhcnlcbiAgICAgICAgICAgIGZsYWdzIHw9IEYuUEFSVF9CT1VOREFSWTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGMgPT0gSFlQSEVOKSB7XG4gICAgICAgICAgICAvLyBIWVBIRU4gPSBlbmQgYm91bmRhcnlcbiAgICAgICAgICAgIGZsYWdzIHw9IEYuTEFTVF9CT1VOREFSWTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpbmRleCAtIDEgPT0gYm91bmRhcnkubGVuZ3RoKSAge1xuICAgICAgICAgIGlmIChmbGFncyAmIEYuUEFSVF9CT1VOREFSWSkge1xuICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgICAgaWYgKGMgPT0gTEYpIHtcbiAgICAgICAgICAgICAgLy8gdW5zZXQgdGhlIFBBUlRfQk9VTkRBUlkgZmxhZ1xuICAgICAgICAgICAgICBmbGFncyAmPSB+Ri5QQVJUX0JPVU5EQVJZO1xuICAgICAgICAgICAgICBjYWxsYmFjaygncGFydEVuZCcpO1xuICAgICAgICAgICAgICBjYWxsYmFjaygncGFydEJlZ2luJyk7XG4gICAgICAgICAgICAgIHN0YXRlID0gUy5IRUFERVJfRklFTERfU1RBUlQ7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoZmxhZ3MgJiBGLkxBU1RfQk9VTkRBUlkpIHtcbiAgICAgICAgICAgIGlmIChjID09IEhZUEhFTikge1xuICAgICAgICAgICAgICBjYWxsYmFjaygncGFydEVuZCcpO1xuICAgICAgICAgICAgICBjYWxsYmFjaygnZW5kJyk7XG4gICAgICAgICAgICAgIHN0YXRlID0gUy5FTkQ7XG4gICAgICAgICAgICAgIGZsYWdzID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGluZGV4ID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW5kZXggPSAwO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgICAvLyB3aGVuIG1hdGNoaW5nIGEgcG9zc2libGUgYm91bmRhcnksIGtlZXAgYSBsb29rYmVoaW5kIHJlZmVyZW5jZVxuICAgICAgICAgIC8vIGluIGNhc2UgaXQgdHVybnMgb3V0IHRvIGJlIGEgZmFsc2UgbGVhZFxuICAgICAgICAgIGxvb2tiZWhpbmRbaW5kZXgtMV0gPSBjO1xuICAgICAgICB9IGVsc2UgaWYgKHByZXZJbmRleCA+IDApIHtcbiAgICAgICAgICAvLyBpZiBvdXIgYm91bmRhcnkgdHVybmVkIG91dCB0byBiZSBydWJiaXNoLCB0aGUgY2FwdHVyZWQgbG9va2JlaGluZFxuICAgICAgICAgIC8vIGJlbG9uZ3MgdG8gcGFydERhdGFcbiAgICAgICAgICBjYWxsYmFjaygncGFydERhdGEnLCBsb29rYmVoaW5kLCAwLCBwcmV2SW5kZXgpO1xuICAgICAgICAgIHByZXZJbmRleCA9IDA7XG4gICAgICAgICAgbWFyaygncGFydERhdGEnKTtcblxuICAgICAgICAgIC8vIHJlY29uc2lkZXIgdGhlIGN1cnJlbnQgY2hhcmFjdGVyIGV2ZW4gc28gaXQgaW50ZXJydXB0ZWQgdGhlIHNlcXVlbmNlXG4gICAgICAgICAgLy8gaXQgY291bGQgYmUgdGhlIGJlZ2lubmluZyBvZiBhIG5ldyBzZXF1ZW5jZVxuICAgICAgICAgIGktLTtcbiAgICAgICAgfVxuXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBTLkVORDpcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cblxuICBkYXRhQ2FsbGJhY2soJ2hlYWRlckZpZWxkJyk7XG4gIGRhdGFDYWxsYmFjaygnaGVhZGVyVmFsdWUnKTtcbiAgZGF0YUNhbGxiYWNrKCdwYXJ0RGF0YScpO1xuXG4gIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICB0aGlzLmZsYWdzID0gZmxhZ3M7XG5cbiAgcmV0dXJuIGxlbjtcbn07XG5cbk11bHRpcGFydFBhcnNlci5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24oKSB7XG4gIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGYsIG5hbWUpIHtcbiAgICB2YXIgY2FsbGJhY2tTeW1ib2wgPSAnb24nK25hbWUuc3Vic3RyKDAsIDEpLnRvVXBwZXJDYXNlKCkrbmFtZS5zdWJzdHIoMSk7XG4gICAgaWYgKGNhbGxiYWNrU3ltYm9sIGluIHNlbGYpIHtcbiAgICAgIHNlbGZbY2FsbGJhY2tTeW1ib2xdKCk7XG4gICAgfVxuICB9O1xuICBpZiAoKHRoaXMuc3RhdGUgPT0gUy5IRUFERVJfRklFTERfU1RBUlQgJiYgdGhpcy5pbmRleCA9PT0gMCkgfHxcbiAgICAgICh0aGlzLnN0YXRlID09IFMuUEFSVF9EQVRBICYmIHRoaXMuaW5kZXggPT0gdGhpcy5ib3VuZGFyeS5sZW5ndGgpKSB7XG4gICAgY2FsbGJhY2sodGhpcywgJ3BhcnRFbmQnKTtcbiAgICBjYWxsYmFjayh0aGlzLCAnZW5kJyk7XG4gIH0gZWxzZSBpZiAodGhpcy5zdGF0ZSAhPSBTLkVORCkge1xuICAgIHJldHVybiBuZXcgRXJyb3IoJ011bHRpcGFydFBhcnNlci5lbmQoKTogc3RyZWFtIGVuZGVkIHVuZXhwZWN0ZWRseTogJyArIHRoaXMuZXhwbGFpbigpKTtcbiAgfVxufTtcblxuTXVsdGlwYXJ0UGFyc2VyLnByb3RvdHlwZS5leHBsYWluID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAnc3RhdGUgPSAnICsgTXVsdGlwYXJ0UGFyc2VyLnN0YXRlVG9TdHJpbmcodGhpcy5zdGF0ZSk7XG59O1xuIiwidmFyIEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoJ2V2ZW50cycpLkV2ZW50RW1pdHRlclxuXHQsIHV0aWwgPSByZXF1aXJlKCd1dGlsJyk7XG5cbmZ1bmN0aW9uIE9jdGV0UGFyc2VyKG9wdGlvbnMpe1xuXHRpZighKHRoaXMgaW5zdGFuY2VvZiBPY3RldFBhcnNlcikpIHJldHVybiBuZXcgT2N0ZXRQYXJzZXIob3B0aW9ucyk7XG5cdEV2ZW50RW1pdHRlci5jYWxsKHRoaXMpO1xufVxuXG51dGlsLmluaGVyaXRzKE9jdGV0UGFyc2VyLCBFdmVudEVtaXR0ZXIpO1xuXG5leHBvcnRzLk9jdGV0UGFyc2VyID0gT2N0ZXRQYXJzZXI7XG5cbk9jdGV0UGFyc2VyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKGJ1ZmZlcikge1xuICAgIHRoaXMuZW1pdCgnZGF0YScsIGJ1ZmZlcik7XG5cdHJldHVybiBidWZmZXIubGVuZ3RoO1xufTtcblxuT2N0ZXRQYXJzZXIucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLmVtaXQoJ2VuZCcpO1xufTtcbiIsImlmIChnbG9iYWwuR0VOVExZKSByZXF1aXJlID0gR0VOVExZLmhpamFjayhyZXF1aXJlKTtcblxuLy8gVGhpcyBpcyBhIGJ1ZmZlcmluZyBwYXJzZXIsIG5vdCBxdWl0ZSBhcyBuaWNlIGFzIHRoZSBtdWx0aXBhcnQgb25lLlxuLy8gSWYgSSBmaW5kIHRpbWUgSSdsbCByZXdyaXRlIHRoaXMgdG8gYmUgZnVsbHkgc3RyZWFtaW5nIGFzIHdlbGxcbnZhciBxdWVyeXN0cmluZyA9IHJlcXVpcmUoJ3F1ZXJ5c3RyaW5nJyk7XG5cbmZ1bmN0aW9uIFF1ZXJ5c3RyaW5nUGFyc2VyKG1heEtleXMpIHtcbiAgdGhpcy5tYXhLZXlzID0gbWF4S2V5cztcbiAgdGhpcy5idWZmZXIgPSAnJztcbn1cbmV4cG9ydHMuUXVlcnlzdHJpbmdQYXJzZXIgPSBRdWVyeXN0cmluZ1BhcnNlcjtcblxuUXVlcnlzdHJpbmdQYXJzZXIucHJvdG90eXBlLndyaXRlID0gZnVuY3Rpb24oYnVmZmVyKSB7XG4gIHRoaXMuYnVmZmVyICs9IGJ1ZmZlci50b1N0cmluZygnYXNjaWknKTtcbiAgcmV0dXJuIGJ1ZmZlci5sZW5ndGg7XG59O1xuXG5RdWVyeXN0cmluZ1BhcnNlci5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24oKSB7XG4gIHZhciBmaWVsZHMgPSBxdWVyeXN0cmluZy5wYXJzZSh0aGlzLmJ1ZmZlciwgJyYnLCAnPScsIHsgbWF4S2V5czogdGhpcy5tYXhLZXlzIH0pO1xuICBmb3IgKHZhciBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICB0aGlzLm9uRmllbGQoZmllbGQsIGZpZWxkc1tmaWVsZF0pO1xuICB9XG4gIHRoaXMuYnVmZmVyID0gJyc7XG5cbiAgdGhpcy5vbkVuZCgpO1xufTtcblxuIiwiLy9jb25zb2xlLmxvZyhcIiEhISEhISEhISEhISEhISEgV0FSTklORyBUSElTIElTIEdVTiAwLjUgISEhISEhISEhISEhISEhISEhISEhIVwiKTtcclxuOyhmdW5jdGlvbigpe1xyXG5cclxuXHQvKiBVTkJVSUxEICovXHJcblx0dmFyIHJvb3Q7XHJcblx0aWYodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIil7IHJvb3QgPSB3aW5kb3cgfVxyXG5cdGlmKHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIpeyByb290ID0gZ2xvYmFsIH1cclxuXHRyb290ID0gcm9vdCB8fCB7fTtcclxuXHR2YXIgY29uc29sZSA9IHJvb3QuY29uc29sZSA9IHJvb3QuY29uc29sZSB8fCB7bG9nOiBmdW5jdGlvbigpe319O1xyXG5cdGZ1bmN0aW9uIHJlcXVpcmUoYXJnKXtcclxuXHRcdHJldHVybiBhcmcuc2xpY2U/IHJlcXVpcmVbcmVzb2x2ZShhcmcpXSA6IGZ1bmN0aW9uKG1vZCwgcGF0aCl7XHJcblx0XHRcdGFyZyhtb2QgPSB7ZXhwb3J0czoge319KTtcclxuXHRcdFx0cmVxdWlyZVtyZXNvbHZlKHBhdGgpXSA9IG1vZC5leHBvcnRzO1xyXG5cdFx0fVxyXG5cdFx0ZnVuY3Rpb24gcmVzb2x2ZShwYXRoKXtcclxuXHRcdFx0cmV0dXJuIHBhdGguc3BsaXQoJy8nKS5zbGljZSgtMSkudG9TdHJpbmcoKS5yZXBsYWNlKCcuanMnLCcnKTtcclxuXHRcdH1cclxuXHR9XHJcblx0aWYodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIil7IHZhciBjb21tb24gPSBtb2R1bGUgfVxyXG5cdC8qIFVOQlVJTEQgKi9cclxuXHJcblx0O3JlcXVpcmUoZnVuY3Rpb24obW9kdWxlKXtcclxuXHRcdC8vIEdlbmVyaWMgamF2YXNjcmlwdCB1dGlsaXRpZXMuXHJcblx0XHR2YXIgVHlwZSA9IHt9O1xyXG5cdFx0VHlwZS5mbnMgPSBUeXBlLmZuID0ge2lzOiBmdW5jdGlvbihmbil7IHJldHVybiAoISFmbiAmJiBmbiBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB9fVxyXG5cdFx0VHlwZS5iaSA9IHtpczogZnVuY3Rpb24oYil7IHJldHVybiAoYiBpbnN0YW5jZW9mIEJvb2xlYW4gfHwgdHlwZW9mIGIgPT0gJ2Jvb2xlYW4nKSB9fVxyXG5cdFx0VHlwZS5udW0gPSB7aXM6IGZ1bmN0aW9uKG4peyByZXR1cm4gIWxpc3RfaXMobikgJiYgKChuIC0gcGFyc2VGbG9hdChuKSArIDEpID49IDAgfHwgSW5maW5pdHkgPT09IG4gfHwgLUluZmluaXR5ID09PSBuKSB9fVxyXG5cdFx0VHlwZS50ZXh0ID0ge2lzOiBmdW5jdGlvbih0KXsgcmV0dXJuICh0eXBlb2YgdCA9PSAnc3RyaW5nJykgfX1cclxuXHRcdFR5cGUudGV4dC5pZnkgPSBmdW5jdGlvbih0KXtcclxuXHRcdFx0aWYoVHlwZS50ZXh0LmlzKHQpKXsgcmV0dXJuIHQgfVxyXG5cdFx0XHRpZih0eXBlb2YgSlNPTiAhPT0gXCJ1bmRlZmluZWRcIil7IHJldHVybiBKU09OLnN0cmluZ2lmeSh0KSB9XHJcblx0XHRcdHJldHVybiAodCAmJiB0LnRvU3RyaW5nKT8gdC50b1N0cmluZygpIDogdDtcclxuXHRcdH1cclxuXHRcdFR5cGUudGV4dC5yYW5kb20gPSBmdW5jdGlvbihsLCBjKXtcclxuXHRcdFx0dmFyIHMgPSAnJztcclxuXHRcdFx0bCA9IGwgfHwgMjQ7IC8vIHlvdSBhcmUgbm90IGdvaW5nIHRvIG1ha2UgYSAwIGxlbmd0aCByYW5kb20gbnVtYmVyLCBzbyBubyBuZWVkIHRvIGNoZWNrIHR5cGVcclxuXHRcdFx0YyA9IGMgfHwgJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1haYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonO1xyXG5cdFx0XHR3aGlsZShsID4gMCl7IHMgKz0gYy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYy5sZW5ndGgpKTsgbC0tIH1cclxuXHRcdFx0cmV0dXJuIHM7XHJcblx0XHR9XHJcblx0XHRUeXBlLnRleHQubWF0Y2ggPSBmdW5jdGlvbih0LCBvKXsgdmFyIHIgPSBmYWxzZTtcclxuXHRcdFx0dCA9IHQgfHwgJyc7XHJcblx0XHRcdG8gPSBUeXBlLnRleHQuaXMobyk/IHsnPSc6IG99IDogbyB8fCB7fTsgLy8geyd+JywgJz0nLCAnKicsICc8JywgJz4nLCAnKycsICctJywgJz8nLCAnISd9IC8vIGlnbm9yZSBjYXNlLCBleGFjdGx5IGVxdWFsLCBhbnl0aGluZyBhZnRlciwgbGV4aWNhbGx5IGxhcmdlciwgbGV4aWNhbGx5IGxlc3NlciwgYWRkZWQgaW4sIHN1YnRhY3RlZCBmcm9tLCBxdWVzdGlvbmFibGUgZnV6enkgbWF0Y2gsIGFuZCBlbmRzIHdpdGguXHJcblx0XHRcdGlmKFR5cGUub2JqLmhhcyhvLCd+JykpeyB0ID0gdC50b0xvd2VyQ2FzZSgpOyBvWyc9J10gPSAob1snPSddIHx8IG9bJ34nXSkudG9Mb3dlckNhc2UoKSB9XHJcblx0XHRcdGlmKFR5cGUub2JqLmhhcyhvLCc9JykpeyByZXR1cm4gdCA9PT0gb1snPSddIH1cclxuXHRcdFx0aWYoVHlwZS5vYmouaGFzKG8sJyonKSl7IGlmKHQuc2xpY2UoMCwgb1snKiddLmxlbmd0aCkgPT09IG9bJyonXSl7IHIgPSB0cnVlOyB0ID0gdC5zbGljZShvWycqJ10ubGVuZ3RoKSB9IGVsc2UgeyByZXR1cm4gZmFsc2UgfX1cclxuXHRcdFx0aWYoVHlwZS5vYmouaGFzKG8sJyEnKSl7IGlmKHQuc2xpY2UoLW9bJyEnXS5sZW5ndGgpID09PSBvWychJ10peyByID0gdHJ1ZSB9IGVsc2UgeyByZXR1cm4gZmFsc2UgfX1cclxuXHRcdFx0aWYoVHlwZS5vYmouaGFzKG8sJysnKSl7XHJcblx0XHRcdFx0aWYoVHlwZS5saXN0Lm1hcChUeXBlLmxpc3QuaXMob1snKyddKT8gb1snKyddIDogW29bJysnXV0sIGZ1bmN0aW9uKG0pe1xyXG5cdFx0XHRcdFx0aWYodC5pbmRleE9mKG0pID49IDApeyByID0gdHJ1ZSB9IGVsc2UgeyByZXR1cm4gdHJ1ZSB9XHJcblx0XHRcdFx0fSkpeyByZXR1cm4gZmFsc2UgfVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKFR5cGUub2JqLmhhcyhvLCctJykpe1xyXG5cdFx0XHRcdGlmKFR5cGUubGlzdC5tYXAoVHlwZS5saXN0LmlzKG9bJy0nXSk/IG9bJy0nXSA6IFtvWyctJ11dLCBmdW5jdGlvbihtKXtcclxuXHRcdFx0XHRcdGlmKHQuaW5kZXhPZihtKSA8IDApeyByID0gdHJ1ZSB9IGVsc2UgeyByZXR1cm4gdHJ1ZSB9XHJcblx0XHRcdFx0fSkpeyByZXR1cm4gZmFsc2UgfVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKFR5cGUub2JqLmhhcyhvLCc+JykpeyBpZih0ID4gb1snPiddKXsgciA9IHRydWUgfSBlbHNlIHsgcmV0dXJuIGZhbHNlIH19XHJcblx0XHRcdGlmKFR5cGUub2JqLmhhcyhvLCc8JykpeyBpZih0IDwgb1snPCddKXsgciA9IHRydWUgfSBlbHNlIHsgcmV0dXJuIGZhbHNlIH19XHJcblx0XHRcdGZ1bmN0aW9uIGZ1enp5KHQsZil7IHZhciBuID0gLTEsIGkgPSAwLCBjOyBmb3IoO2MgPSBmW2krK107KXsgaWYoIX4obiA9IHQuaW5kZXhPZihjLCBuKzEpKSl7IHJldHVybiBmYWxzZSB9fSByZXR1cm4gdHJ1ZSB9IC8vIHZpYSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzkyMDYwMTMvamF2YXNjcmlwdC1mdXp6eS1zZWFyY2hcclxuXHRcdFx0aWYoVHlwZS5vYmouaGFzKG8sJz8nKSl7IGlmKGZ1enp5KHQsIG9bJz8nXSkpeyByID0gdHJ1ZSB9IGVsc2UgeyByZXR1cm4gZmFsc2UgfX0gLy8gY2hhbmdlIG5hbWUhXHJcblx0XHRcdHJldHVybiByO1xyXG5cdFx0fVxyXG5cdFx0VHlwZS5saXN0ID0ge2lzOiBmdW5jdGlvbihsKXsgcmV0dXJuIChsIGluc3RhbmNlb2YgQXJyYXkpIH19XHJcblx0XHRUeXBlLmxpc3Quc2xpdCA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcclxuXHRcdFR5cGUubGlzdC5zb3J0ID0gZnVuY3Rpb24oayl7IC8vIGNyZWF0ZXMgYSBuZXcgc29ydCBmdW5jdGlvbiBiYXNlZCBvZmYgc29tZSBmaWVsZFxyXG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oQSxCKXtcclxuXHRcdFx0XHRpZighQSB8fCAhQil7IHJldHVybiAwIH0gQSA9IEFba107IEIgPSBCW2tdO1xyXG5cdFx0XHRcdGlmKEEgPCBCKXsgcmV0dXJuIC0xIH1lbHNlIGlmKEEgPiBCKXsgcmV0dXJuIDEgfVxyXG5cdFx0XHRcdGVsc2UgeyByZXR1cm4gMCB9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFR5cGUubGlzdC5tYXAgPSBmdW5jdGlvbihsLCBjLCBfKXsgcmV0dXJuIG9ial9tYXAobCwgYywgXykgfVxyXG5cdFx0VHlwZS5saXN0LmluZGV4ID0gMTsgLy8gY2hhbmdlIHRoaXMgdG8gMCBpZiB5b3Ugd2FudCBub24tbG9naWNhbCwgbm9uLW1hdGhlbWF0aWNhbCwgbm9uLW1hdHJpeCwgbm9uLWNvbnZlbmllbnQgYXJyYXkgbm90YXRpb25cclxuXHRcdFR5cGUub2JqID0ge2lzOiBmdW5jdGlvbihvKXsgcmV0dXJuIG8/IChvIGluc3RhbmNlb2YgT2JqZWN0ICYmIG8uY29uc3RydWN0b3IgPT09IE9iamVjdCkgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLm1hdGNoKC9eXFxbb2JqZWN0IChcXHcrKVxcXSQvKVsxXSA9PT0gJ09iamVjdCcgOiBmYWxzZSB9fVxyXG5cdFx0VHlwZS5vYmoucHV0ID0gZnVuY3Rpb24obywgZiwgdil7IHJldHVybiAob3x8e30pW2ZdID0gdiwgbyB9IFxyXG5cdFx0VHlwZS5vYmouaGFzID0gZnVuY3Rpb24obywgZil7IHJldHVybiBvICYmIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBmKSB9XHJcblx0XHRUeXBlLm9iai5kZWwgPSBmdW5jdGlvbihvLCBrKXtcclxuXHRcdFx0aWYoIW8peyByZXR1cm4gfVxyXG5cdFx0XHRvW2tdID0gbnVsbDtcclxuXHRcdFx0ZGVsZXRlIG9ba107XHJcblx0XHRcdHJldHVybiBvO1xyXG5cdFx0fVxyXG5cdFx0VHlwZS5vYmouYXMgPSBmdW5jdGlvbihvLCBmLCB2KXsgcmV0dXJuIG9bZl0gPSBvW2ZdIHx8IChhcmd1bWVudHMubGVuZ3RoID49IDM/IHYgOiB7fSkgfVxyXG5cdFx0VHlwZS5vYmouaWZ5ID0gZnVuY3Rpb24obyl7XHJcblx0XHRcdGlmKG9ial9pcyhvKSl7IHJldHVybiBvIH1cclxuXHRcdFx0dHJ5e28gPSBKU09OLnBhcnNlKG8pO1xyXG5cdFx0XHR9Y2F0Y2goZSl7bz17fX07XHJcblx0XHRcdHJldHVybiBvO1xyXG5cdFx0fVxyXG5cdFx0OyhmdW5jdGlvbigpeyB2YXIgdTtcclxuXHRcdFx0ZnVuY3Rpb24gbWFwKHYsZil7XHJcblx0XHRcdFx0aWYob2JqX2hhcyh0aGlzLGYpICYmIHUgIT09IHRoaXNbZl0peyByZXR1cm4gfVxyXG5cdFx0XHRcdHRoaXNbZl0gPSB2O1xyXG5cdFx0XHR9XHJcblx0XHRcdFR5cGUub2JqLnRvID0gZnVuY3Rpb24oZnJvbSwgdG8pe1xyXG5cdFx0XHRcdHRvID0gdG8gfHwge307XHJcblx0XHRcdFx0b2JqX21hcChmcm9tLCBtYXAsIHRvKTtcclxuXHRcdFx0XHRyZXR1cm4gdG87XHJcblx0XHRcdH1cclxuXHRcdH0oKSk7XHJcblx0XHRUeXBlLm9iai5jb3B5ID0gZnVuY3Rpb24obyl7IC8vIGJlY2F1c2UgaHR0cDovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxNDAzMjgyMjQwMjUvaHR0cDovL2pzcGVyZi5jb20vY2xvbmluZy1hbi1vYmplY3QvMlxyXG5cdFx0XHRyZXR1cm4gIW8/IG8gOiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG8pKTsgLy8gaXMgc2hvY2tpbmdseSBmYXN0ZXIgdGhhbiBhbnl0aGluZyBlbHNlLCBhbmQgb3VyIGRhdGEgaGFzIHRvIGJlIGEgc3Vic2V0IG9mIEpTT04gYW55d2F5cyFcclxuXHRcdH1cclxuXHRcdDsoZnVuY3Rpb24oKXtcclxuXHRcdFx0ZnVuY3Rpb24gZW1wdHkodixpKXsgdmFyIG4gPSB0aGlzLm47XHJcblx0XHRcdFx0aWYobiAmJiAoaSA9PT0gbiB8fCAob2JqX2lzKG4pICYmIG9ial9oYXMobiwgaSkpKSl7IHJldHVybiB9XHJcblx0XHRcdFx0aWYoaSl7IHJldHVybiB0cnVlIH1cclxuXHRcdFx0fVxyXG5cdFx0XHRUeXBlLm9iai5lbXB0eSA9IGZ1bmN0aW9uKG8sIG4pe1xyXG5cdFx0XHRcdGlmKCFvKXsgcmV0dXJuIHRydWUgfVxyXG5cdFx0XHRcdHJldHVybiBvYmpfbWFwKG8sZW1wdHkse246bn0pPyBmYWxzZSA6IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH0oKSk7XHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdGZ1bmN0aW9uIHQoayx2KXtcclxuXHRcdFx0XHRpZigyID09PSBhcmd1bWVudHMubGVuZ3RoKXtcclxuXHRcdFx0XHRcdHQuciA9IHQuciB8fCB7fTtcclxuXHRcdFx0XHRcdHQucltrXSA9IHY7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fSB0LnIgPSB0LnIgfHwgW107XHJcblx0XHRcdFx0dC5yLnB1c2goayk7XHJcblx0XHRcdH07XHJcblx0XHRcdFR5cGUub2JqLm1hcCA9IGZ1bmN0aW9uKGwsIGMsIF8pe1xyXG5cdFx0XHRcdHZhciB1LCBpID0gMCwgeCwgciwgbGwsIGxsZSwgZiA9IGZuX2lzKGMpO1xyXG5cdFx0XHRcdHQuciA9IG51bGw7XHJcblx0XHRcdFx0aWYoT2JqZWN0LmtleXMgJiYgb2JqX2lzKGwpKXtcclxuXHRcdFx0XHRcdGxsID0gT2JqZWN0LmtleXMobCk7IGxsZSA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGxpc3RfaXMobCkgfHwgbGwpe1xyXG5cdFx0XHRcdFx0eCA9IChsbCB8fCBsKS5sZW5ndGg7XHJcblx0XHRcdFx0XHRmb3IoO2kgPCB4OyBpKyspe1xyXG5cdFx0XHRcdFx0XHR2YXIgaWkgPSAoaSArIFR5cGUubGlzdC5pbmRleCk7XHJcblx0XHRcdFx0XHRcdGlmKGYpe1xyXG5cdFx0XHRcdFx0XHRcdHIgPSBsbGU/IGMuY2FsbChfIHx8IHRoaXMsIGxbbGxbaV1dLCBsbFtpXSwgdCkgOiBjLmNhbGwoXyB8fCB0aGlzLCBsW2ldLCBpaSwgdCk7XHJcblx0XHRcdFx0XHRcdFx0aWYociAhPT0gdSl7IHJldHVybiByIH1cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQvL2lmKFR5cGUudGVzdC5pcyhjLGxbaV0pKXsgcmV0dXJuIGlpIH0gLy8gc2hvdWxkIGltcGxlbWVudCBkZWVwIGVxdWFsaXR5IHRlc3RpbmchXHJcblx0XHRcdFx0XHRcdFx0aWYoYyA9PT0gbFtsbGU/IGxsW2ldIDogaV0peyByZXR1cm4gbGw/IGxsW2ldIDogaWkgfSAvLyB1c2UgdGhpcyBmb3Igbm93XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0Zm9yKGkgaW4gbCl7XHJcblx0XHRcdFx0XHRcdGlmKGYpe1xyXG5cdFx0XHRcdFx0XHRcdGlmKG9ial9oYXMobCxpKSl7XHJcblx0XHRcdFx0XHRcdFx0XHRyID0gXz8gYy5jYWxsKF8sIGxbaV0sIGksIHQpIDogYyhsW2ldLCBpLCB0KTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKHIgIT09IHUpeyByZXR1cm4gciB9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vaWYoYS50ZXN0LmlzKGMsbFtpXSkpeyByZXR1cm4gaSB9IC8vIHNob3VsZCBpbXBsZW1lbnQgZGVlcCBlcXVhbGl0eSB0ZXN0aW5nIVxyXG5cdFx0XHRcdFx0XHRcdGlmKGMgPT09IGxbaV0peyByZXR1cm4gaSB9IC8vIHVzZSB0aGlzIGZvciBub3dcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gZj8gdC5yIDogVHlwZS5saXN0LmluZGV4PyAwIDogLTE7XHJcblx0XHRcdH1cclxuXHRcdH0oKSk7XHJcblx0XHRUeXBlLnRpbWUgPSB7fTtcclxuXHRcdFR5cGUudGltZS5pcyA9IGZ1bmN0aW9uKHQpeyByZXR1cm4gdD8gdCBpbnN0YW5jZW9mIERhdGUgOiAoK25ldyBEYXRlKCkuZ2V0VGltZSgpKSB9XHJcblxyXG5cdFx0dmFyIGZuX2lzID0gVHlwZS5mbi5pcztcclxuXHRcdHZhciBsaXN0X2lzID0gVHlwZS5saXN0LmlzO1xyXG5cdFx0dmFyIG9iaiA9IFR5cGUub2JqLCBvYmpfaXMgPSBvYmouaXMsIG9ial9oYXMgPSBvYmouaGFzLCBvYmpfbWFwID0gb2JqLm1hcDtcclxuXHRcdG1vZHVsZS5leHBvcnRzID0gVHlwZTtcclxuXHR9KShyZXF1aXJlLCAnLi90eXBlJyk7XHJcblx0XHRcclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cdFx0Ly8gT24gZXZlbnQgZW1pdHRlciBnZW5lcmljIGphdmFzY3JpcHQgdXRpbGl0eS5cclxuXHRcdGZ1bmN0aW9uIFNjb3BlKCl7XHJcblx0XHRcdGZ1bmN0aW9uIE9uKHRhZywgYXJnLCBhcywgZWFzLCBza2lwKXtcclxuXHRcdFx0XHR2YXIgY3R4ID0gdGhpcywgb25zID0gY3R4Lm9ucyB8fCAoY3R4Lm9ucyA9IHt9KSwgb24gPSBvbnNbdGFnXSB8fCAob25zW3RhZ10gPSB7czogW119KSwgYWN0LCBtZW0sIE8gPSBPbi5vbnM7XHJcblx0XHRcdFx0aWYoIWFyZyl7XHJcblx0XHRcdFx0XHRpZigxID09PSBhcmd1bWVudHMubGVuZ3RoKXsgLy8gUGVyZm9ybWFuY2UgZHJvcHMgc2lnbmlmaWNhbnRseSBldmVuIHRob3VnaCBgYXJndW1lbnRzLmxlbmd0aGAgc2hvdWxkIGJlIG9rYXkgdG8gdXNlLlxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gb247XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGFyZyBpbnN0YW5jZW9mIEZ1bmN0aW9uKXtcclxuXHRcdFx0XHRcdGFjdCA9IG5ldyBBY3QodGFnLCBhcmcsIGFzLCBvbiwgY3R4KTtcclxuXHRcdFx0XHRcdGlmKE8gJiYgTy5ldmVudCAmJiBjdHggIT09IE9uKXtcclxuXHRcdFx0XHRcdFx0T24ub24oJ2V2ZW50JywgYWN0KTtcclxuXHRcdFx0XHRcdFx0aWYobm9vcCA9PT0gYWN0LmZuKXtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gYWN0O1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKC0xIDwgYWN0LmkpeyByZXR1cm4gYWN0IH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdG9uLnMucHVzaChhY3QpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGFjdDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIHByb3h5O1xyXG5cdFx0XHRcdGlmKE8gJiYgTy5lbWl0ICYmIGN0eCAhPT0gT24pe1xyXG5cdFx0XHRcdFx0dmFyIGV2ID0ge3RhZzogdGFnLCBhcmc6IGFyZywgb246IG9uLCBjdHg6IGN0eH0sIHU7XHJcblx0XHRcdFx0XHRPbi5vbignZW1pdCcsIGV2KTtcclxuXHRcdFx0XHRcdGlmKHUgPT09IGV2LmFyZyl7IHJldHVybiB9XHJcblx0XHRcdFx0XHRhcmcgPSBldi5hcmc7XHJcblx0XHRcdFx0XHRwcm94eSA9IGV2LnByb3h5O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRvbi5hcmcgPSBhcmc7XHJcblx0XHRcdFx0b24uZW5kID0gYXM7XHJcblx0XHRcdFx0b24uYXMgPSBlYXM7XHJcblx0XHRcdFx0dmFyIGkgPSAwLCBhY3RzID0gb24ucywgbCA9IGFjdHMubGVuZ3RoLCBhcnIgPSAoYXJnIGluc3RhbmNlb2YgQXJyYXkpLCBnYXAsIG9mZiwgYWN0O1xyXG5cdFx0XHRcdGZvcig7IGkgPCBsOyBpKyspeyBhY3QgPSBhY3RzW2ldO1xyXG5cdFx0XHRcdFx0aWYoc2tpcCl7XHJcblx0XHRcdFx0XHRcdGlmKHNraXAgPT09IGFjdCl7XHJcblx0XHRcdFx0XHRcdFx0c2tpcCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dmFyIHRtcCA9IGFjdC50bXAgPSB7fTtcclxuXHRcdFx0XHRcdGlmKCFhcnIpe1xyXG5cdFx0XHRcdFx0XHRhY3QuZm4uY2FsbChhY3QuYXMsIGFyZywgcHJveHl8fGFjdCk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRhY3QuZm4uYXBwbHkoYWN0LmFzLCBhcmcuY29uY2F0KHByb3h5fHxhY3QpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKG5vb3AgPT09IGFjdC5mbil7XHJcblx0XHRcdFx0XHRcdG9mZiA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZih0bXAuaGFsdCl7XHJcblx0XHRcdFx0XHRcdGlmKDEgPT09IHRtcC5oYWx0KXtcclxuXHRcdFx0XHRcdFx0XHRnYXAgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihvZmYpe1xyXG5cdFx0XHRcdFx0dmFyIHN0aWxsID0gW107XHJcblx0XHRcdFx0XHRmb3IoaSA9IDA7IGkgPCBsOyBpKyspeyBhY3QgPSBhY3RzW2ldO1xyXG5cdFx0XHRcdFx0XHRpZihub29wICE9PSBhY3QuZm4pe1xyXG5cdFx0XHRcdFx0XHRcdHN0aWxsLnB1c2goYWN0KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0b24ucyA9IHN0aWxsO1xyXG5cdFx0XHRcdFx0aWYoMCA9PT0gc3RpbGwubGVuZ3RoKXtcclxuXHRcdFx0XHRcdFx0ZGVsZXRlIG9uc1t0YWddO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZighZ2FwICYmIGFzICYmIGFzIGluc3RhbmNlb2YgRnVuY3Rpb24pe1xyXG5cdFx0XHRcdFx0YXMuY2FsbChlYXMsIGFyZyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0XHRPbi5vbiA9IE9uO1xyXG5cdFx0XHRPbi5zY29wZSA9IFNjb3BlO1xyXG5cdFx0XHRyZXR1cm4gT247XHJcblx0XHR9XHJcblx0XHRmdW5jdGlvbiBBY3QodGFnLCBmbiwgYXMsIG9uLCBjdHgpe1xyXG5cdFx0XHR0aGlzLnRhZyA9IHRhZztcclxuXHRcdFx0dGhpcy5mbiA9IGZuO1xyXG5cdFx0XHR0aGlzLmFzID0gYXM7XHJcblx0XHRcdHRoaXMub24gPSBvbjtcclxuXHRcdFx0dGhpcy5jdHggPSBjdHg7XHJcblx0XHR9XHJcblx0XHRBY3QuY2hhaW4gPSBBY3QucHJvdG90eXBlO1xyXG5cdFx0QWN0LmNoYWluLnN0dW4gPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRpZighdGhpcy50bXApeyB0aGlzLnRtcCA9IHt9IH1cclxuXHRcdFx0aWYoIWFyZ3VtZW50cy5sZW5ndGgpe1xyXG5cdFx0XHRcdHJldHVybiB0aGlzLnRtcC5oYWx0ID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgYWN0ID0gdGhpcywgb24gPSBhY3Qub24sIGhhbHQgPSB7XHJcblx0XHRcdFx0cmVzdW1lOiBmdW5jdGlvbihhcmcpe1xyXG5cdFx0XHRcdFx0LypcclxuXHRcdFx0XHRcdFx0VE9ETzogQlVHIVxyXG5cdFx0XHRcdFx0XHRUT0RPOiBCVUchXHJcblx0XHRcdFx0XHRcdFRPRE86IEJVRyFcclxuXHRcdFx0XHRcdFx0VE9ETzogQlVHIVxyXG5cdFx0XHRcdFx0XHRUT0RPOiBCVUchXHJcblx0XHRcdFx0XHRcdFdoeSBkb2VzIG91ciBtYXAgbm90IGdldCB1cGRhdGVzP1xyXG5cdFx0XHRcdFx0XHRQb3J0aW9ucyBkbyBpZiB3ZSBkbyBub3QgdXNlIC5rZXkgdG8gc2F2ZSB0aGUgaW5pdGlhbCBkYXRhLlxyXG5cdFx0XHRcdFx0XHRXaGljaCBtYWtlcyBtZSB0aGluayBpdCByZWxhdGVzIHRvIHBzZXVkbywgaG93ZXZlciBpdCBkb2Vzbid0IGZ1bGx5IHdvcmsgaWYgSSBnZXQgcmlkIG9mIHRoYXQuXHJcblx0XHRcdFx0XHRcdFdoeSB3aHkgd2h5PyBQcm9iYWJseSBzb21ldGhpbmcgdG8gZG8gd2l0aCBtYXAgZXZlbnRzIGFuZCBtZW1vaXppbmc/XHJcblx0XHRcdFx0XHQqL1xyXG5cdFx0XHRcdFx0YWN0LmN0eC5vbihhY3QudGFnLCAoYXJndW1lbnRzLmxlbmd0aD9cclxuXHRcdFx0XHRcdFx0MSA9PT0gYXJndW1lbnRzLmxlbmd0aD8gYXJnIDogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKVxyXG5cdFx0XHRcdFx0OiBoYWx0LmFyZyksIGhhbHQuZW5kLCBoYWx0LmFzLCBhY3QpO1xyXG5cdFx0XHRcdH0sIGFyZzogb24uYXJnLFxyXG5cdFx0XHRcdGVuZDogb24uZW5kLFxyXG5cdFx0XHRcdGFzOiBvbi5hc1xyXG5cdFx0XHR9O1xyXG5cdFx0XHRhY3QudG1wLmhhbHQgPSAxO1xyXG5cdFx0XHRyZXR1cm4gaGFsdC5yZXN1bWU7XHJcblx0XHR9XHJcblx0XHRBY3QuY2hhaW4ub2ZmID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0dGhpcy5mbiA9IG5vb3A7XHJcblx0XHR9XHJcblx0XHRBY3QuY2hhaW4uZW1pdCA9IGZ1bmN0aW9uKGFyZyl7XHJcblx0XHRcdHZhciBhY3QgPSB0aGlzLCBhcnIgPSAoYXJnIGluc3RhbmNlb2YgQXJyYXkpO1xyXG5cdFx0XHRpZighYXJyKXtcclxuXHRcdFx0XHRhY3QuZm4uY2FsbChhY3QuYXMsIGFyZywgYWN0KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRhY3QuZm4uYXBwbHkoYWN0LmFzLCBhcmcuY29uY2F0KGFjdCkpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRmdW5jdGlvbiBub29wKCl7fTtcclxuXHRcdG1vZHVsZS5leHBvcnRzID0gU2NvcGUoKTtcclxuXHR9KShyZXF1aXJlLCAnLi9vbicpO1xyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cdFx0dmFyIE9uID0gcmVxdWlyZSgnLi9vbicpO1xyXG5cdFx0XHJcblx0XHRmdW5jdGlvbiBDaGFpbihjcmVhdGUsIG9wdCl7XHJcblx0XHRcdG9wdCA9IG9wdCB8fCB7fTtcclxuXHRcdFx0b3B0LmlkID0gb3B0LmlkIHx8ICcjJztcclxuXHRcdFx0b3B0LnJpZCA9IG9wdC5yaWQgfHwgJ0AnO1xyXG5cdFx0XHRvcHQudXVpZCA9IG9wdC51dWlkIHx8IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0cmV0dXJuICgrbmV3IERhdGUoKSkgKyBNYXRoLnJhbmRvbSgpO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHR2YXIgb24gPSBPbi5zY29wZSgpO1xyXG5cclxuXHRcdFx0b24uc3R1biA9IGZ1bmN0aW9uKGNoYWluLCBmbiwgYXMpe1xyXG5cdFx0XHRcdHZhciByZXMgPSBmdW5jdGlvbihuKXtcclxuXHRcdFx0XHRcdGlmKDEgPT09IG4pe1xyXG5cdFx0XHRcdFx0XHRhdC5zdHVuLnNraXAgPSAxO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihhdC5zdHVuID09PSBzdHVuKXtcclxuXHRcdFx0XHRcdFx0ZGVsZXRlIGF0LnN0dW47XHRcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdG9mZiA9IHRydWU7XHJcblx0XHRcdFx0XHR2YXIgaSA9IDAsIHEgPSByZXMucXVldWUsIGwgPSBxLmxlbmd0aCwgYywgdjtcclxuXHRcdFx0XHRcdGZvcihpOyBpIDwgbDsgaSsrKXsgdiA9IHFbaV07XHJcblx0XHRcdFx0XHRcdGMgPSB2WzBdO1xyXG5cdFx0XHRcdFx0XHR2ID0gdlsxXTtcclxuXHRcdFx0XHRcdFx0Yy5vbignaW4nLCB2LmdldCwgdik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSwgYXQgPSBjaGFpbi5fLCBvZmYsIHN0dW4gPSBhdC5zdHVuID0gZnVuY3Rpb24oYXJnKXtcclxuXHRcdFx0XHRcdGlmKG9mZil7XHJcblx0XHRcdFx0XHRcdGRlbGV0ZSB0aGlzLnN0dW47XHJcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmKGF0LnN0dW4uc2tpcCl7XHJcblx0XHRcdFx0XHRcdHJldHVybiBhdC5zdHVuLnNraXAgPSBmYWxzZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJlcy5xdWV1ZS5wdXNoKFt0aGlzLCBhcmddKTtcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXMucXVldWUgPSBbXTtcclxuXHRcdFx0XHRyZXR1cm4gcmVzO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgYXNrID0gb24uYXNrID0gZnVuY3Rpb24oY2IsIGFzKXtcclxuXHRcdFx0XHRpZighYXNrLm9uKXsgYXNrLm9uID0gT24uc2NvcGUoKSB9XHJcblx0XHRcdFx0dmFyIGlkID0gb3B0LnV1aWQoKTtcclxuXHRcdFx0XHRpZihjYil7IGFzay5vbihpZCwgY2IsIGFzKSB9XHJcblx0XHRcdFx0cmV0dXJuIGlkO1xyXG5cdFx0XHR9XHJcblx0XHRcdGFzay5fID0gb3B0LmlkO1xyXG5cdFx0XHRvbi5hY2sgPSBmdW5jdGlvbihhdCwgcmVwbHkpe1xyXG5cdFx0XHRcdGlmKCFhdCB8fCAhcmVwbHkgfHwgIWFzay5vbil7IHJldHVybiB9XHJcblx0XHRcdFx0dmFyIGlkID0gYXRbb3B0LmlkXSB8fCBhdDtcclxuXHRcdFx0XHRhc2sub24oaWQsIHJlcGx5KTtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRvbi5hY2suXyA9IG9wdC5yaWQ7XHJcblx0XHRcdC8qXHJcblx0XHRcdG9uLm9uKCdldmVudCcsIGZ1bmN0aW9uIGV2ZW50KGFjdCl7XHJcblx0XHRcdFx0dmFyIGxhc3QgPSBhY3Qub24ubGFzdCwgdG1wO1xyXG5cdFx0XHRcdGlmKGxhc3Qpe1xyXG5cdFx0XHRcdFx0aWYobGFzdCBpbnN0YW5jZW9mIEFycmF5KXtcclxuXHRcdFx0XHRcdFx0YWN0LmZuLmFwcGx5KGFjdC5hcywgbGFzdC5jb25jYXQoYWN0KSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRhY3QuZm4uY2FsbChhY3QuYXMsIGxhc3QsIGFjdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihsYXN0ICE9PSBhY3Qub24ubGFzdCl7XHJcblx0XHRcdFx0XHRcdGV2ZW50KGFjdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTsqL1xyXG5cclxuXHRcdFx0b24ub24oJ2V2ZW50JywgZnVuY3Rpb24gZXZlbnQoYWN0KXtcclxuXHRcdFx0XHR2YXIgbGFzdCA9IGFjdC5vbi5sYXN0LCB0bXA7XHJcblx0XHRcdFx0aWYobGFzdCl7XHJcblx0XHRcdFx0XHRpZihhY3Qub24ubWFwKXtcclxuXHRcdFx0XHRcdFx0R3VuLm9iai5tYXAoYWN0Lm9uLm1hcCwgZnVuY3Rpb24odixmKXsgLy8gVE9ETzogQlVHISBHdW4gaXMgbm90IGF2YWlsYWJsZSBpbiB0aGlzIG1vZHVsZS5cclxuXHRcdFx0XHRcdFx0XHQvL2VtaXQodlswXSwgYWN0LCBldmVudCwgdlsxXSk7IC8vIGJlbG93IGVuYWJsZXMgbW9yZSBjb250cm9sXHJcblx0XHRcdFx0XHRcdFx0ZW1pdCh2WzFdLCBhY3QsIGV2ZW50LCB2WzJdKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRlbWl0KGxhc3QsIGFjdCwgZXZlbnQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYobGFzdCAhPT0gYWN0Lm9uLmxhc3Qpe1xyXG5cdFx0XHRcdFx0XHRldmVudChhY3QpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdGZ1bmN0aW9uIGVtaXQobGFzdCwgYWN0LCBldmVudCwgZXYpe1xyXG5cdFx0XHRcdGlmKGxhc3QgaW5zdGFuY2VvZiBBcnJheSl7XHJcblx0XHRcdFx0XHRhY3QuZm4uYXBwbHkoYWN0LmFzLCBsYXN0LmNvbmNhdChldnx8YWN0KSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGFjdC5mbi5jYWxsKGFjdC5hcywgbGFzdCwgZXZ8fGFjdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRvbi5vbignZW1pdCcsIGZ1bmN0aW9uKGV2KXtcclxuXHRcdFx0XHRpZihldi5vbi5tYXApe1xyXG5cdFx0XHRcdFx0LypcclxuXHRcdFx0XHRcdGV2LmlkID0gZXYuaWQgfHwgR3VuLnRleHQucmFuZG9tKDYpO1xyXG5cdFx0XHRcdFx0ZXYub24ubWFwW2V2LmlkXSA9IGV2LmFyZztcclxuXHRcdFx0XHRcdGV2LnByb3h5ID0gZXYuYXJnWzFdO1xyXG5cdFx0XHRcdFx0ZXYuYXJnID0gZXYuYXJnWzBdO1xyXG5cdFx0XHRcdFx0Ki8gLy8gYmVsb3cgZ2l2ZXMgbW9yZSBjb250cm9sLlxyXG5cdFx0XHRcdFx0ZXYub24ubWFwW2V2LmFyZ1swXV0gPSBldi5hcmc7XHJcblx0XHRcdFx0XHRldi5wcm94eSA9IGV2LmFyZ1syXTtcclxuXHRcdFx0XHRcdGV2LmFyZyA9IGV2LmFyZ1sxXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZXYub24ubGFzdCA9IGV2LmFyZztcclxuXHRcdFx0fSk7XHJcblx0XHRcdHJldHVybiBvbjtcclxuXHRcdH1cclxuXHRcdC8qXHJcblx0XHRmdW5jdGlvbiBiYWNrd2FyZChzY29wZSwgZXYpeyB2YXIgdG1wO1xyXG5cdFx0XHRpZighc2NvcGUgfHwgIXNjb3BlLm9uKXsgcmV0dXJuIH1cclxuXHRcdFx0Ly9pZihzY29wZS5vbignYmFjaycpLmxlbmd0aCl7XHJcblx0XHRcdGlmKCh0bXAgPSBzY29wZS5vbnMpICYmICh0bXAgPSB0bXBbZXZdKSAmJiB0bXAucy5sZW5ndGgpe1xyXG5cdFx0XHRcdHJldHVybiBzY29wZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gYmFja3dhcmQoKHNjb3BlLmJhY2t8fGJhY2t3YXJkKS5fLCBldik7XHJcblx0XHR9XHJcblx0XHQqL1xyXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBDaGFpbjtcclxuXHR9KShyZXF1aXJlLCAnLi9vbmlmeScpO1xyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cdFx0Ly8gR2VuZXJpYyBqYXZhc2NyaXB0IHNjaGVkdWxlciB1dGlsaXR5LlxyXG5cdFx0dmFyIFR5cGUgPSByZXF1aXJlKCcuL3R5cGUnKTtcclxuXHRcdGZ1bmN0aW9uIHMoc3RhdGUsIGNiLCB0aW1lKXsgLy8gbWF5YmUgdXNlIGxydS1jYWNoZT9cclxuXHRcdFx0cy50aW1lID0gdGltZSB8fCBHdW4udGltZS5pcztcclxuXHRcdFx0cy53YWl0aW5nLnB1c2goe3doZW46IHN0YXRlLCBldmVudDogY2IgfHwgZnVuY3Rpb24oKXt9fSk7XHJcblx0XHRcdGlmKHMuc29vbmVzdCA8IHN0YXRlKXsgcmV0dXJuIH1cclxuXHRcdFx0cy5zZXQoc3RhdGUpO1xyXG5cdFx0fVxyXG5cdFx0cy53YWl0aW5nID0gW107XHJcblx0XHRzLnNvb25lc3QgPSBJbmZpbml0eTtcclxuXHRcdHMuc29ydCA9IFR5cGUubGlzdC5zb3J0KCd3aGVuJyk7XHJcblx0XHRzLnNldCA9IGZ1bmN0aW9uKGZ1dHVyZSl7XHJcblx0XHRcdGlmKEluZmluaXR5IDw9IChzLnNvb25lc3QgPSBmdXR1cmUpKXsgcmV0dXJuIH1cclxuXHRcdFx0dmFyIG5vdyA9IHMudGltZSgpO1xyXG5cdFx0XHRmdXR1cmUgPSAoZnV0dXJlIDw9IG5vdyk/IDAgOiAoZnV0dXJlIC0gbm93KTtcclxuXHRcdFx0Y2xlYXJUaW1lb3V0KHMuaWQpO1xyXG5cdFx0XHRzLmlkID0gc2V0VGltZW91dChzLmNoZWNrLCBmdXR1cmUpO1xyXG5cdFx0fVxyXG5cdFx0cy5lYWNoID0gZnVuY3Rpb24od2FpdCwgaSwgbWFwKXtcclxuXHRcdFx0dmFyIGN0eCA9IHRoaXM7XHJcblx0XHRcdGlmKCF3YWl0KXsgcmV0dXJuIH1cclxuXHRcdFx0aWYod2FpdC53aGVuIDw9IGN0eC5ub3cpe1xyXG5cdFx0XHRcdGlmKHdhaXQuZXZlbnQgaW5zdGFuY2VvZiBGdW5jdGlvbil7XHJcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IHdhaXQuZXZlbnQoKSB9LDApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjdHguc29vbmVzdCA9IChjdHguc29vbmVzdCA8IHdhaXQud2hlbik/IGN0eC5zb29uZXN0IDogd2FpdC53aGVuO1xyXG5cdFx0XHRcdG1hcCh3YWl0KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cy5jaGVjayA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHZhciBjdHggPSB7bm93OiBzLnRpbWUoKSwgc29vbmVzdDogSW5maW5pdHl9O1xyXG5cdFx0XHRzLndhaXRpbmcuc29ydChzLnNvcnQpO1xyXG5cdFx0XHRzLndhaXRpbmcgPSBUeXBlLmxpc3QubWFwKHMud2FpdGluZywgcy5lYWNoLCBjdHgpIHx8IFtdO1xyXG5cdFx0XHRzLnNldChjdHguc29vbmVzdCk7XHJcblx0XHR9XHJcblx0XHRtb2R1bGUuZXhwb3J0cyA9IHM7XHJcblx0fSkocmVxdWlyZSwgJy4vc2NoZWR1bGUnKTtcclxuXHJcblx0O3JlcXVpcmUoZnVuY3Rpb24obW9kdWxlKXtcclxuXHRcdC8qIEJhc2VkIG9uIHRoZSBIeXBvdGhldGljYWwgQW1uZXNpYSBNYWNoaW5lIHRob3VnaHQgZXhwZXJpbWVudCAqL1xyXG5cdFx0ZnVuY3Rpb24gSEFNKG1hY2hpbmVTdGF0ZSwgaW5jb21pbmdTdGF0ZSwgY3VycmVudFN0YXRlLCBpbmNvbWluZ1ZhbHVlLCBjdXJyZW50VmFsdWUpe1xyXG5cdFx0XHRpZihtYWNoaW5lU3RhdGUgPCBpbmNvbWluZ1N0YXRlKXtcclxuXHRcdFx0XHRyZXR1cm4ge2RlZmVyOiB0cnVlfTsgLy8gdGhlIGluY29taW5nIHZhbHVlIGlzIG91dHNpZGUgdGhlIGJvdW5kYXJ5IG9mIHRoZSBtYWNoaW5lJ3Mgc3RhdGUsIGl0IG11c3QgYmUgcmVwcm9jZXNzZWQgaW4gYW5vdGhlciBzdGF0ZS5cclxuXHRcdFx0fVxyXG5cdFx0XHRpZihpbmNvbWluZ1N0YXRlIDwgY3VycmVudFN0YXRlKXtcclxuXHRcdFx0XHRyZXR1cm4ge2hpc3RvcmljYWw6IHRydWV9OyAvLyB0aGUgaW5jb21pbmcgdmFsdWUgaXMgd2l0aGluIHRoZSBib3VuZGFyeSBvZiB0aGUgbWFjaGluZSdzIHN0YXRlLCBidXQgbm90IHdpdGhpbiB0aGUgcmFuZ2UuXHJcblx0XHRcdFx0XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoY3VycmVudFN0YXRlIDwgaW5jb21pbmdTdGF0ZSl7XHJcblx0XHRcdFx0cmV0dXJuIHtjb252ZXJnZTogdHJ1ZSwgaW5jb21pbmc6IHRydWV9OyAvLyB0aGUgaW5jb21pbmcgdmFsdWUgaXMgd2l0aGluIGJvdGggdGhlIGJvdW5kYXJ5IGFuZCB0aGUgcmFuZ2Ugb2YgdGhlIG1hY2hpbmUncyBzdGF0ZS5cclxuXHRcdFx0XHRcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihpbmNvbWluZ1N0YXRlID09PSBjdXJyZW50U3RhdGUpe1xyXG5cdFx0XHRcdGlmKGluY29taW5nVmFsdWUgPT09IGN1cnJlbnRWYWx1ZSl7IC8vIE5vdGU6IHdoaWxlIHRoZXNlIGFyZSBwcmFjdGljYWxseSB0aGUgc2FtZSwgdGhlIGRlbHRhcyBjb3VsZCBiZSB0ZWNobmljYWxseSBkaWZmZXJlbnRcclxuXHRcdFx0XHRcdHJldHVybiB7c3RhdGU6IHRydWV9O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvKlxyXG5cdFx0XHRcdFx0VGhlIGZvbGxvd2luZyBpcyBhIG5haXZlIGltcGxlbWVudGF0aW9uLCBidXQgd2lsbCBhbHdheXMgd29yay5cclxuXHRcdFx0XHRcdE5ldmVyIGNoYW5nZSBpdCB1bmxlc3MgeW91IGhhdmUgc3BlY2lmaWMgbmVlZHMgdGhhdCBhYnNvbHV0ZWx5IHJlcXVpcmUgaXQuXHJcblx0XHRcdFx0XHRJZiBjaGFuZ2VkLCB5b3VyIGRhdGEgd2lsbCBkaXZlcmdlIHVubGVzcyB5b3UgZ3VhcmFudGVlIGV2ZXJ5IHBlZXIncyBhbGdvcml0aG0gaGFzIGFsc28gYmVlbiBjaGFuZ2VkIHRvIGJlIHRoZSBzYW1lLlxyXG5cdFx0XHRcdFx0QXMgYSByZXN1bHQsIGl0IGlzIGhpZ2hseSBkaXNjb3VyYWdlZCB0byBtb2RpZnkgZGVzcGl0ZSB0aGUgZmFjdCB0aGF0IGl0IGlzIG5haXZlLFxyXG5cdFx0XHRcdFx0YmVjYXVzZSBjb252ZXJnZW5jZSAoZGF0YSBpbnRlZ3JpdHkpIGlzIGdlbmVyYWxseSBtb3JlIGltcG9ydGFudC5cclxuXHRcdFx0XHRcdEFueSBkaWZmZXJlbmNlIGluIHRoaXMgYWxnb3JpdGhtIG11c3QgYmUgZ2l2ZW4gYSBuZXcgYW5kIGRpZmZlcmVudCBuYW1lLlxyXG5cdFx0XHRcdCovXHJcblx0XHRcdFx0aWYoTGV4aWNhbChpbmNvbWluZ1ZhbHVlKSA8IExleGljYWwoY3VycmVudFZhbHVlKSl7IC8vIExleGljYWwgb25seSB3b3JrcyBvbiBzaW1wbGUgdmFsdWUgdHlwZXMhXHJcblx0XHRcdFx0XHRyZXR1cm4ge2NvbnZlcmdlOiB0cnVlLCBjdXJyZW50OiB0cnVlfTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoTGV4aWNhbChjdXJyZW50VmFsdWUpIDwgTGV4aWNhbChpbmNvbWluZ1ZhbHVlKSl7IC8vIExleGljYWwgb25seSB3b3JrcyBvbiBzaW1wbGUgdmFsdWUgdHlwZXMhXHJcblx0XHRcdFx0XHRyZXR1cm4ge2NvbnZlcmdlOiB0cnVlLCBpbmNvbWluZzogdHJ1ZX07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB7ZXJyOiBcInlvdSBoYXZlIG5vdCBwcm9wZXJseSBoYW5kbGVkIHJlY3Vyc2lvbiB0aHJvdWdoIHlvdXIgZGF0YSBvciBmaWx0ZXJlZCBpdCBhcyBKU09OXCJ9O1xyXG5cdFx0fVxyXG5cdFx0ZnVuY3Rpb24gTGV4aWNhbCh2YWx1ZSl7XHJcblx0XHRcdC8vIFRPRE86IEJVRyEgSEFNIHNob3VsZCB1bmRlcnN0YW5kIGEgcmVsYXRpb24gKHBvaW50ZXIpIGFzIGEgdHlwZSBhcyB3ZWxsLlxyXG5cdFx0XHRpZih0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKXsgLy8gVGV4dFxyXG5cdFx0XHRcdHJldHVybiAnYWFhYWEnK3ZhbHVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKCh2YWx1ZSAtIHBhcnNlRmxvYXQodmFsdWUpICsgMSkgPj0gMCl7IC8vIE51bWJlcnMgKEpTT04tYWJsZSlcclxuXHRcdFx0XHRyZXR1cm4gJ2FhYWEnK3ZhbHVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHRydWUgPT09IHZhbHVlKXsgLy8gQm9vbGVhblxyXG5cdFx0XHRcdHJldHVybiAnYWFhJztcclxuXHRcdFx0fVxyXG5cdFx0XHRpZihmYWxzZSA9PT0gdmFsdWUpeyAvLyBCb29sZWFuXHJcblx0XHRcdFx0cmV0dXJuICdhYSc7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYobnVsbCA9PT0gdmFsdWUpeyAvLyBOdWxsXHJcblx0XHRcdFx0cmV0dXJuICdhJztcclxuXHRcdFx0fVxyXG5cdFx0XHRpZih1bmRlZmluZWQgPT09IHZhbHVlKXsgLy8gVW5kZWZpbmVkXHJcblx0XHRcdFx0cmV0dXJuICcnO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiAnJzsgLy8gTm90IHN1cHBvcnRlZFxyXG5cdFx0fVxyXG5cdFx0dmFyIHVuZGVmaW5lZDtcclxuXHRcdG1vZHVsZS5leHBvcnRzID0gSEFNO1xyXG5cdH0pKHJlcXVpcmUsICcuL0hBTScpO1xyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cdFx0dmFyIFR5cGUgPSByZXF1aXJlKCcuL3R5cGUnKTtcclxuXHRcdHZhciBWYWwgPSB7fTtcclxuXHRcdFZhbC5pcyA9IGZ1bmN0aW9uKHYpeyAvLyBWYWxpZCB2YWx1ZXMgYXJlIGEgc3Vic2V0IG9mIEpTT046IG51bGwsIGJpbmFyeSwgbnVtYmVyICghSW5maW5pdHkpLCB0ZXh0LCBvciBhIHNvdWwgcmVsYXRpb24uIEFycmF5cyBuZWVkIHNwZWNpYWwgYWxnb3JpdGhtcyB0byBoYW5kbGUgY29uY3VycmVuY3ksIHNvIHRoZXkgYXJlIG5vdCBzdXBwb3J0ZWQgZGlyZWN0bHkuIFVzZSBhbiBleHRlbnNpb24gdGhhdCBzdXBwb3J0cyB0aGVtIGlmIG5lZWRlZCBidXQgcmVzZWFyY2ggdGhlaXIgcHJvYmxlbXMgZmlyc3QuXHJcblx0XHRcdHZhciB1O1xyXG5cdFx0XHRpZih2ID09PSB1KXsgcmV0dXJuIGZhbHNlIH1cclxuXHRcdFx0aWYodiA9PT0gbnVsbCl7IHJldHVybiB0cnVlIH0gLy8gXCJkZWxldGVzXCIsIG51bGxpbmcgb3V0IGZpZWxkcy5cclxuXHRcdFx0aWYodiA9PT0gSW5maW5pdHkpeyByZXR1cm4gZmFsc2UgfSAvLyB3ZSB3YW50IHRoaXMgdG8gYmUsIGJ1dCBKU09OIGRvZXMgbm90IHN1cHBvcnQgaXQsIHNhZCBmYWNlLlxyXG5cdFx0XHRpZihiaV9pcyh2KSAvLyBieSBcImJpbmFyeVwiIHdlIG1lYW4gYm9vbGVhbi5cclxuXHRcdFx0fHwgbnVtX2lzKHYpXHJcblx0XHRcdHx8IHRleHRfaXModikpeyAvLyBieSBcInRleHRcIiB3ZSBtZWFuIHN0cmluZ3MuXHJcblx0XHRcdFx0cmV0dXJuIHRydWU7IC8vIHNpbXBsZSB2YWx1ZXMgYXJlIHZhbGlkLlxyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBWYWwucmVsLmlzKHYpIHx8IGZhbHNlOyAvLyBpcyB0aGUgdmFsdWUgYSBzb3VsIHJlbGF0aW9uPyBUaGVuIGl0IGlzIHZhbGlkIGFuZCByZXR1cm4gaXQuIElmIG5vdCwgZXZlcnl0aGluZyBlbHNlIHJlbWFpbmluZyBpcyBhbiBpbnZhbGlkIGRhdGEgdHlwZS4gQ3VzdG9tIGV4dGVuc2lvbnMgY2FuIGJlIGJ1aWx0IG9uIHRvcCBvZiB0aGVzZSBwcmltaXRpdmVzIHRvIHN1cHBvcnQgb3RoZXIgdHlwZXMuXHJcblx0XHR9XHJcblx0XHRWYWwucmVsID0ge186ICcjJ307XHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFZhbC5yZWwuaXMgPSBmdW5jdGlvbih2KXsgLy8gdGhpcyBkZWZpbmVzIHdoZXRoZXIgYW4gb2JqZWN0IGlzIGEgc291bCByZWxhdGlvbiBvciBub3QsIHRoZXkgbG9vayBsaWtlIHRoaXM6IHsnIyc6ICdVVUlEJ31cclxuXHRcdFx0XHRpZih2ICYmICF2Ll8gJiYgb2JqX2lzKHYpKXsgLy8gbXVzdCBiZSBhbiBvYmplY3QuXHJcblx0XHRcdFx0XHR2YXIgbyA9IHt9O1xyXG5cdFx0XHRcdFx0b2JqX21hcCh2LCBtYXAsIG8pO1xyXG5cdFx0XHRcdFx0aWYoby5pZCl7IC8vIGEgdmFsaWQgaWQgd2FzIGZvdW5kLlxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gby5pZDsgLy8geWF5ISBSZXR1cm4gaXQuXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBmYWxzZTsgLy8gdGhlIHZhbHVlIHdhcyBub3QgYSB2YWxpZCBzb3VsIHJlbGF0aW9uLlxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIG1hcChzLCBmKXsgdmFyIG8gPSB0aGlzOyAvLyBtYXAgb3ZlciB0aGUgb2JqZWN0Li4uXHJcblx0XHRcdFx0aWYoby5pZCl7IHJldHVybiBvLmlkID0gZmFsc2UgfSAvLyBpZiBJRCBpcyBhbHJlYWR5IGRlZmluZWQgQU5EIHdlJ3JlIHN0aWxsIGxvb3BpbmcgdGhyb3VnaCB0aGUgb2JqZWN0LCBpdCBpcyBjb25zaWRlcmVkIGludmFsaWQuXHJcblx0XHRcdFx0aWYoZiA9PSBfcmVsICYmIHRleHRfaXMocykpeyAvLyB0aGUgZmllbGQgc2hvdWxkIGJlICcjJyBhbmQgaGF2ZSBhIHRleHQgdmFsdWUuXHJcblx0XHRcdFx0XHRvLmlkID0gczsgLy8gd2UgZm91bmQgdGhlIHNvdWwhXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHJldHVybiBvLmlkID0gZmFsc2U7IC8vIGlmIHRoZXJlIGV4aXN0cyBhbnl0aGluZyBlbHNlIG9uIHRoZSBvYmplY3QgdGhhdCBpc24ndCB0aGUgc291bCwgdGhlbiBpdCBpcyBjb25zaWRlcmVkIGludmFsaWQuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KCkpO1xyXG5cdFx0VmFsLnJlbC5pZnkgPSBmdW5jdGlvbih0KXsgcmV0dXJuIG9ial9wdXQoe30sIF9yZWwsIHQpIH0gLy8gY29udmVydCBhIHNvdWwgaW50byBhIHJlbGF0aW9uIGFuZCByZXR1cm4gaXQuXHJcblx0XHR2YXIgX3JlbCA9IFZhbC5yZWwuXztcclxuXHRcdHZhciBiaV9pcyA9IFR5cGUuYmkuaXM7XHJcblx0XHR2YXIgbnVtX2lzID0gVHlwZS5udW0uaXM7XHJcblx0XHR2YXIgdGV4dF9pcyA9IFR5cGUudGV4dC5pcztcclxuXHRcdHZhciBvYmogPSBUeXBlLm9iaiwgb2JqX2lzID0gb2JqLmlzLCBvYmpfcHV0ID0gb2JqLnB1dCwgb2JqX21hcCA9IG9iai5tYXA7XHJcblx0XHRtb2R1bGUuZXhwb3J0cyA9IFZhbDtcclxuXHR9KShyZXF1aXJlLCAnLi92YWwnKTtcclxuXHJcblx0O3JlcXVpcmUoZnVuY3Rpb24obW9kdWxlKXtcclxuXHRcdHZhciBUeXBlID0gcmVxdWlyZSgnLi90eXBlJyk7XHJcblx0XHR2YXIgVmFsID0gcmVxdWlyZSgnLi92YWwnKTtcclxuXHRcdHZhciBOb2RlID0ge186ICdfJ307XHJcblx0XHROb2RlLnNvdWwgPSBmdW5jdGlvbihuLCBvKXsgcmV0dXJuIChuICYmIG4uXyAmJiBuLl9bbyB8fCBfc291bF0pIH0gLy8gY29udmVuaWVuY2UgZnVuY3Rpb24gdG8gY2hlY2sgdG8gc2VlIGlmIHRoZXJlIGlzIGEgc291bCBvbiBhIG5vZGUgYW5kIHJldHVybiBpdC5cclxuXHRcdE5vZGUuc291bC5pZnkgPSBmdW5jdGlvbihuLCBvKXsgLy8gcHV0IGEgc291bCBvbiBhbiBvYmplY3QuXHJcblx0XHRcdG8gPSAodHlwZW9mIG8gPT09ICdzdHJpbmcnKT8ge3NvdWw6IG99IDogbyB8fCB7fTtcclxuXHRcdFx0biA9IG4gfHwge307IC8vIG1ha2Ugc3VyZSBpdCBleGlzdHMuXHJcblx0XHRcdG4uXyA9IG4uXyB8fCB7fTsgLy8gbWFrZSBzdXJlIG1ldGEgZXhpc3RzLlxyXG5cdFx0XHRuLl9bX3NvdWxdID0gby5zb3VsIHx8IG4uX1tfc291bF0gfHwgdGV4dF9yYW5kb20oKTsgLy8gcHV0IHRoZSBzb3VsIG9uIGl0LlxyXG5cdFx0XHRyZXR1cm4gbjtcclxuXHRcdH1cclxuXHRcdDsoZnVuY3Rpb24oKXtcclxuXHRcdFx0Tm9kZS5pcyA9IGZ1bmN0aW9uKG4sIGNiLCBvKXsgdmFyIHM7IC8vIGNoZWNrcyB0byBzZWUgaWYgYW4gb2JqZWN0IGlzIGEgdmFsaWQgbm9kZS5cclxuXHRcdFx0XHRpZighb2JqX2lzKG4pKXsgcmV0dXJuIGZhbHNlIH0gLy8gbXVzdCBiZSBhbiBvYmplY3QuXHJcblx0XHRcdFx0aWYocyA9IE5vZGUuc291bChuKSl7IC8vIG11c3QgaGF2ZSBhIHNvdWwgb24gaXQuXHJcblx0XHRcdFx0XHRyZXR1cm4gIW9ial9tYXAobiwgbWFwLCB7bzpvLG46bixjYjpjYn0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7IC8vIG5vcGUhIFRoaXMgd2FzIG5vdCBhIHZhbGlkIG5vZGUuXHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gbWFwKHYsIGYpeyAvLyB3ZSBpbnZlcnQgdGhpcyBiZWNhdXNlIHRoZSB3YXkgd2UgY2hlY2sgZm9yIHRoaXMgaXMgdmlhIGEgbmVnYXRpb24uXHJcblx0XHRcdFx0aWYoZiA9PT0gTm9kZS5fKXsgcmV0dXJuIH0gLy8gc2tpcCBvdmVyIHRoZSBtZXRhZGF0YS5cclxuXHRcdFx0XHRpZighVmFsLmlzKHYpKXsgcmV0dXJuIHRydWUgfSAvLyBpdCBpcyB0cnVlIHRoYXQgdGhpcyBpcyBhbiBpbnZhbGlkIG5vZGUuXHJcblx0XHRcdFx0aWYodGhpcy5jYil7IHRoaXMuY2IuY2FsbCh0aGlzLm8sIHYsIGYsIHRoaXMubikgfSAvLyBvcHRpb25hbGx5IGNhbGxiYWNrIGVhY2ggZmllbGQvdmFsdWUuXHJcblx0XHRcdH1cclxuXHRcdH0oKSk7XHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdE5vZGUuaWZ5ID0gZnVuY3Rpb24ob2JqLCBvLCBhcyl7IC8vIHJldHVybnMgYSBub2RlIGZyb20gYSBzaGFsbG93IG9iamVjdC5cclxuXHRcdFx0XHRpZighbyl7IG8gPSB7fSB9XHJcblx0XHRcdFx0ZWxzZSBpZih0eXBlb2YgbyA9PT0gJ3N0cmluZycpeyBvID0ge3NvdWw6IG99IH1cclxuXHRcdFx0XHRlbHNlIGlmKG8gaW5zdGFuY2VvZiBGdW5jdGlvbil7IG8gPSB7bWFwOiBvfSB9XHJcblx0XHRcdFx0aWYoby5tYXApeyBvLm5vZGUgPSBvLm1hcC5jYWxsKGFzLCBvYmosIHUsIG8ubm9kZSB8fCB7fSkgfVxyXG5cdFx0XHRcdGlmKG8ubm9kZSA9IE5vZGUuc291bC5pZnkoby5ub2RlIHx8IHt9LCBvKSl7XHJcblx0XHRcdFx0XHRvYmpfbWFwKG9iaiwgbWFwLCB7b3B0Om8sYXM6YXN9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIG8ubm9kZTsgLy8gVGhpcyB3aWxsIG9ubHkgYmUgYSB2YWxpZCBub2RlIGlmIHRoZSBvYmplY3Qgd2Fzbid0IGFscmVhZHkgZGVlcCFcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBtYXAodiwgZil7IHZhciBvID0gdGhpcy5vcHQsIHRtcCwgdTsgLy8gaXRlcmF0ZSBvdmVyIGVhY2ggZmllbGQvdmFsdWUuXHJcblx0XHRcdFx0aWYoby5tYXApe1xyXG5cdFx0XHRcdFx0dG1wID0gby5tYXAuY2FsbCh0aGlzLmFzLCB2LCAnJytmLCBvLm5vZGUpO1xyXG5cdFx0XHRcdFx0aWYodSA9PT0gdG1wKXtcclxuXHRcdFx0XHRcdFx0b2JqX2RlbChvLm5vZGUsIGYpO1xyXG5cdFx0XHRcdFx0fSBlbHNlXHJcblx0XHRcdFx0XHRpZihvLm5vZGUpeyBvLm5vZGVbZl0gPSB0bXAgfVxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihWYWwuaXModikpeyBcclxuXHRcdFx0XHRcdG8ubm9kZVtmXSA9IHY7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KCkpO1xyXG5cdFx0dmFyIG9iaiA9IFR5cGUub2JqLCBvYmpfaXMgPSBvYmouaXMsIG9ial9kZWwgPSBvYmouZGVsLCBvYmpfbWFwID0gb2JqLm1hcDtcclxuXHRcdHZhciB0ZXh0ID0gVHlwZS50ZXh0LCB0ZXh0X3JhbmRvbSA9IHRleHQucmFuZG9tO1xyXG5cdFx0dmFyIF9zb3VsID0gVmFsLnJlbC5fO1xyXG5cdFx0dmFyIHU7XHJcblx0XHRtb2R1bGUuZXhwb3J0cyA9IE5vZGU7XHJcblx0fSkocmVxdWlyZSwgJy4vbm9kZScpO1xyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cdFx0dmFyIFR5cGUgPSByZXF1aXJlKCcuL3R5cGUnKTtcclxuXHRcdHZhciBOb2RlID0gcmVxdWlyZSgnLi9ub2RlJyk7XHJcblx0XHRmdW5jdGlvbiBTdGF0ZSgpe1xyXG5cdFx0XHR2YXIgdCA9IHRpbWUoKTtcclxuXHRcdFx0aWYobGFzdCA8IHQpe1xyXG5cdFx0XHRcdG4gPSAwO1xyXG5cdFx0XHRcdHJldHVybiBsYXN0ID0gdDtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gbGFzdCA9IHQgKyAoKG4gKz0gMSkgLyBkKTtcclxuXHRcdH1cclxuXHRcdFN0YXRlLl8gPSAnPic7XHJcblx0XHR2YXIgdGltZSA9IFR5cGUudGltZS5pcywgbGFzdCA9IC1JbmZpbml0eSwgbiA9IDAsIGQgPSAxMDAwO1xyXG5cdFx0U3RhdGUuaWZ5ID0gZnVuY3Rpb24obiwgZiwgcyl7IC8vIHB1dCBhIGZpZWxkJ3Mgc3RhdGUgb24gYSBub2RlLlxyXG5cdFx0XHRpZighbiB8fCAhbltOX10peyByZXR1cm4gfSAvLyByZWplY3QgaWYgaXQgaXMgbm90IG5vZGUtbGlrZS5cclxuXHRcdFx0dmFyIHRtcCA9IG9ial9hcyhuW05fXSwgU3RhdGUuXyk7IC8vIGdyYWIgdGhlIHN0YXRlcyBkYXRhLlxyXG5cdFx0XHRpZih1ICE9PSBmICYmIG51bV9pcyhzKSl7IHRtcFtmXSA9IHMgfSAvLyBhZGQgdGhlIHZhbGlkIHN0YXRlLlxyXG5cdFx0XHRyZXR1cm4gbjtcclxuXHRcdH1cclxuXHRcdFN0YXRlLmlzID0gZnVuY3Rpb24obiwgZil7IC8vIGNvbnZlbmllbmNlIGZ1bmN0aW9uIHRvIGdldCB0aGUgc3RhdGUgb24gYSBmaWVsZCBvbiBhIG5vZGUgYW5kIHJldHVybiBpdC5cclxuXHRcdFx0dmFyIHRtcCA9IGYgJiYgbiAmJiBuW05fXSAmJiBuW05fXVtTdGF0ZS5fXTtcclxuXHRcdFx0aWYoIXRtcCl7IHJldHVybiB9XHJcblx0XHRcdHJldHVybiBudW1faXModG1wW2ZdKT8gdG1wW2ZdIDogLUluZmluaXR5O1xyXG5cdFx0fVxyXG5cdFx0OyhmdW5jdGlvbigpe1xyXG5cdFx0XHRTdGF0ZS5tYXAgPSBmdW5jdGlvbihjYiwgcywgYXMpeyB2YXIgdTsgLy8gZm9yIHVzZSB3aXRoIE5vZGUuaWZ5XHJcblx0XHRcdFx0dmFyIG8gPSBvYmpfaXMobyA9IGNiIHx8IHMpPyBvIDogbnVsbDtcclxuXHRcdFx0XHRjYiA9IGZuX2lzKGNiID0gY2IgfHwgcyk/IGNiIDogbnVsbDtcclxuXHRcdFx0XHRpZihvICYmICFjYil7XHJcblx0XHRcdFx0XHRzID0gbnVtX2lzKHMpPyBzIDogU3RhdGUoKTtcclxuXHRcdFx0XHRcdG9bTl9dID0gb1tOX10gfHwge307XHJcblx0XHRcdFx0XHRvYmpfbWFwKG8sIG1hcCwge286byxzOnN9KTtcclxuXHRcdFx0XHRcdHJldHVybiBvO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhcyA9IGFzIHx8IG9ial9pcyhzKT8gcyA6IHU7XHJcblx0XHRcdFx0cyA9IG51bV9pcyhzKT8gcyA6IFN0YXRlKCk7XHJcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uKHYsIGYsIG8sIG9wdCl7XHJcblx0XHRcdFx0XHRpZighY2Ipe1xyXG5cdFx0XHRcdFx0XHRtYXAuY2FsbCh7bzogbywgczogc30sIHYsZik7XHJcblx0XHRcdFx0XHRcdHJldHVybiB2O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Y2IuY2FsbChhcyB8fCB0aGlzIHx8IHt9LCB2LCBmLCBvLCBvcHQpO1xyXG5cdFx0XHRcdFx0aWYob2JqX2hhcyhvLGYpICYmIHUgPT09IG9bZl0peyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0bWFwLmNhbGwoe286IG8sIHM6IHN9LCB2LGYpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBtYXAodixmKXtcclxuXHRcdFx0XHRpZihOXyA9PT0gZil7IHJldHVybiB9XHJcblx0XHRcdFx0U3RhdGUuaWZ5KHRoaXMubywgZiwgdGhpcy5zKSA7XHJcblx0XHRcdH1cclxuXHRcdH0oKSk7XHJcblx0XHR2YXIgb2JqID0gVHlwZS5vYmosIG9ial9hcyA9IG9iai5hcywgb2JqX2hhcyA9IG9iai5oYXMsIG9ial9pcyA9IG9iai5pcywgb2JqX21hcCA9IG9iai5tYXA7XHJcblx0XHR2YXIgbnVtID0gVHlwZS5udW0sIG51bV9pcyA9IG51bS5pcztcclxuXHRcdHZhciBmbiA9IFR5cGUuZm4sIGZuX2lzID0gZm4uaXM7XHJcblx0XHR2YXIgTl8gPSBOb2RlLl8sIHU7XHJcblx0XHRtb2R1bGUuZXhwb3J0cyA9IFN0YXRlO1xyXG5cdH0pKHJlcXVpcmUsICcuL3N0YXRlJyk7XHJcblxyXG5cdDtyZXF1aXJlKGZ1bmN0aW9uKG1vZHVsZSl7XHJcblx0XHR2YXIgVHlwZSA9IHJlcXVpcmUoJy4vdHlwZScpO1xyXG5cdFx0dmFyIFZhbCA9IHJlcXVpcmUoJy4vdmFsJyk7XHJcblx0XHR2YXIgTm9kZSA9IHJlcXVpcmUoJy4vbm9kZScpO1xyXG5cdFx0dmFyIEdyYXBoID0ge307XHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdEdyYXBoLmlzID0gZnVuY3Rpb24oZywgY2IsIGZuLCBhcyl7IC8vIGNoZWNrcyB0byBzZWUgaWYgYW4gb2JqZWN0IGlzIGEgdmFsaWQgZ3JhcGguXHJcblx0XHRcdFx0aWYoIWcgfHwgIW9ial9pcyhnKSB8fCBvYmpfZW1wdHkoZykpeyByZXR1cm4gZmFsc2UgfSAvLyBtdXN0IGJlIGFuIG9iamVjdC5cclxuXHRcdFx0XHRyZXR1cm4gIW9ial9tYXAoZywgbWFwLCB7Zm46Zm4sY2I6Y2IsYXM6YXN9KTsgLy8gbWFrZXMgc3VyZSBpdCB3YXNuJ3QgYW4gZW1wdHkgb2JqZWN0LlxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIG5mKGZuKXsgLy8gb3B0aW9uYWwgY2FsbGJhY2sgZm9yIGVhY2ggbm9kZS5cclxuXHRcdFx0XHRpZihmbil7IE5vZGUuaXMobmYubiwgZm4sIG5mLmFzKSB9IC8vIHdoZXJlIHdlIHRoZW4gaGF2ZSBhbiBvcHRpb25hbCBjYWxsYmFjayBmb3IgZWFjaCBmaWVsZC92YWx1ZS5cclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBtYXAobiwgcyl7IC8vIHdlIGludmVydCB0aGlzIGJlY2F1c2UgdGhlIHdheSB3ZSBjaGVjayBmb3IgdGhpcyBpcyB2aWEgYSBuZWdhdGlvbi5cclxuXHRcdFx0XHRpZighbiB8fCBzICE9PSBOb2RlLnNvdWwobikgfHwgIU5vZGUuaXMobiwgdGhpcy5mbikpeyByZXR1cm4gdHJ1ZSB9IC8vIGl0IGlzIHRydWUgdGhhdCB0aGlzIGlzIGFuIGludmFsaWQgZ3JhcGguXHJcblx0XHRcdFx0aWYoIWZuX2lzKHRoaXMuY2IpKXsgcmV0dXJuIH1cdFxyXG5cdFx0XHRcdG5mLm4gPSBuOyBuZi5hcyA9IHRoaXMuYXM7XHQgXHJcblx0XHRcdFx0dGhpcy5jYi5jYWxsKG5mLmFzLCBuLCBzLCBuZik7XHJcblx0XHRcdH1cclxuXHRcdH0oKSk7XHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdEdyYXBoLmlmeSA9IGZ1bmN0aW9uKG9iaiwgZW52LCBhcyl7XHJcblx0XHRcdFx0dmFyIGF0ID0ge3BhdGg6IFtdLCBvYmo6IG9ian07XHJcblx0XHRcdFx0aWYoIWVudil7XHJcblx0XHRcdFx0XHRlbnYgPSB7fTtcclxuXHRcdFx0XHR9IGVsc2UgXHJcblx0XHRcdFx0aWYodHlwZW9mIGVudiA9PT0gJ3N0cmluZycpe1xyXG5cdFx0XHRcdFx0ZW52ID0ge3NvdWw6IGVudn07XHJcblx0XHRcdFx0fSBlbHNlXHJcblx0XHRcdFx0aWYoZW52IGluc3RhbmNlb2YgRnVuY3Rpb24pe1xyXG5cdFx0XHRcdFx0ZW52Lm1hcCA9IGVudjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoZW52LnNvdWwpe1xyXG5cdFx0XHRcdFx0YXQucmVsID0gVmFsLnJlbC5pZnkoZW52LnNvdWwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbnYuZ3JhcGggPSBlbnYuZ3JhcGggfHwge307XHJcblx0XHRcdFx0ZW52LnNlZW4gPSBlbnYuc2VlbiB8fCBbXTtcclxuXHRcdFx0XHRlbnYuYXMgPSBlbnYuYXMgfHwgYXM7XHJcblx0XHRcdFx0bm9kZShlbnYsIGF0KTtcclxuXHRcdFx0XHRlbnYucm9vdCA9IGF0Lm5vZGU7XHJcblx0XHRcdFx0cmV0dXJuIGVudi5ncmFwaDtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBub2RlKGVudiwgYXQpeyB2YXIgdG1wO1xyXG5cdFx0XHRcdGlmKHRtcCA9IHNlZW4oZW52LCBhdCkpeyByZXR1cm4gdG1wIH1cclxuXHRcdFx0XHRhdC5lbnYgPSBlbnY7XHJcblx0XHRcdFx0YXQuc291bCA9IHNvdWw7XHJcblx0XHRcdFx0aWYoTm9kZS5pZnkoYXQub2JqLCBtYXAsIGF0KSl7XHJcblx0XHRcdFx0XHRhdC5yZWwgPSBhdC5yZWwgfHwgVmFsLnJlbC5pZnkoTm9kZS5zb3VsKGF0Lm5vZGUpKTtcclxuXHRcdFx0XHRcdGVudi5ncmFwaFtWYWwucmVsLmlzKGF0LnJlbCldID0gYXQubm9kZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIGF0O1xyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIG1hcCh2LGYsbil7XHJcblx0XHRcdFx0dmFyIGF0ID0gdGhpcywgZW52ID0gYXQuZW52LCBpcywgdG1wO1xyXG5cdFx0XHRcdGlmKE5vZGUuXyA9PT0gZiAmJiBvYmpfaGFzKHYsVmFsLnJlbC5fKSl7XHJcblx0XHRcdFx0XHRyZXR1cm4gbi5fOyAvLyBUT0RPOiBCdWc/XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCEoaXMgPSB2YWxpZCh2LGYsbiwgYXQsZW52KSkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdGlmKCFmKXtcclxuXHRcdFx0XHRcdGF0Lm5vZGUgPSBhdC5ub2RlIHx8IG4gfHwge307XHJcblx0XHRcdFx0XHRpZihvYmpfaGFzKHYsIE5vZGUuXykpe1xyXG5cdFx0XHRcdFx0XHRhdC5ub2RlLl8gPSBHdW4ub2JqLmNvcHkodi5fKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGF0Lm5vZGUgPSBOb2RlLnNvdWwuaWZ5KGF0Lm5vZGUsIFZhbC5yZWwuaXMoYXQucmVsKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKHRtcCA9IGVudi5tYXApe1xyXG5cdFx0XHRcdFx0dG1wLmNhbGwoZW52LmFzIHx8IHt9LCB2LGYsbiwgYXQpO1xyXG5cdFx0XHRcdFx0aWYob2JqX2hhcyhuLGYpKXtcclxuXHRcdFx0XHRcdFx0diA9IG5bZl07XHJcblx0XHRcdFx0XHRcdGlmKHUgPT09IHYpe1xyXG5cdFx0XHRcdFx0XHRcdG9ial9kZWwobiwgZik7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmKCEoaXMgPSB2YWxpZCh2LGYsbiwgYXQsZW52KSkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZighZil7IHJldHVybiBhdC5ub2RlIH1cclxuXHRcdFx0XHRpZih0cnVlID09PSBpcyl7XHJcblx0XHRcdFx0XHRyZXR1cm4gdjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dG1wID0gbm9kZShlbnYsIHtvYmo6IHYsIHBhdGg6IGF0LnBhdGguY29uY2F0KGYpfSk7XHJcblx0XHRcdFx0aWYoIXRtcC5ub2RlKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRyZXR1cm4gdG1wLnJlbDsgLy97JyMnOiBOb2RlLnNvdWwodG1wLm5vZGUpfTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBzb3VsKGlkKXsgdmFyIGF0ID0gdGhpcztcclxuXHRcdFx0XHR2YXIgcHJldiA9IFZhbC5yZWwuaXMoYXQucmVsKSwgZ3JhcGggPSBhdC5lbnYuZ3JhcGg7XHJcblx0XHRcdFx0YXQucmVsID0gYXQucmVsIHx8IFZhbC5yZWwuaWZ5KGlkKTtcclxuXHRcdFx0XHRhdC5yZWxbVmFsLnJlbC5fXSA9IGlkO1xyXG5cdFx0XHRcdGlmKGF0Lm5vZGUgJiYgYXQubm9kZVtOb2RlLl9dKXtcclxuXHRcdFx0XHRcdGF0Lm5vZGVbTm9kZS5fXVtWYWwucmVsLl9dID0gaWQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKG9ial9oYXMoZ3JhcGgsIHByZXYpKXtcclxuXHRcdFx0XHRcdGdyYXBoW2lkXSA9IGdyYXBoW3ByZXZdO1xyXG5cdFx0XHRcdFx0b2JqX2RlbChncmFwaCwgcHJldik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIHZhbGlkKHYsZixuLCBhdCxlbnYpeyB2YXIgdG1wO1xyXG5cdFx0XHRcdGlmKFZhbC5pcyh2KSl7IHJldHVybiB0cnVlIH1cclxuXHRcdFx0XHRpZihvYmpfaXModikpeyByZXR1cm4gMSB9XHJcblx0XHRcdFx0aWYodG1wID0gZW52LmludmFsaWQpe1xyXG5cdFx0XHRcdFx0diA9IHRtcC5jYWxsKGVudi5hcyB8fCB7fSwgdixmLG4pO1xyXG5cdFx0XHRcdFx0cmV0dXJuIHZhbGlkKHYsZixuLCBhdCxlbnYpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbnYuZXJyID0gXCJJbnZhbGlkIHZhbHVlIGF0ICdcIiArIGF0LnBhdGguY29uY2F0KGYpLmpvaW4oJy4nKSArIFwiJyFcIjtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBzZWVuKGVudiwgYXQpe1xyXG5cdFx0XHRcdHZhciBhcnIgPSBlbnYuc2VlbiwgaSA9IGFyci5sZW5ndGgsIGhhcztcclxuXHRcdFx0XHR3aGlsZShpLS0peyBoYXMgPSBhcnJbaV07XHJcblx0XHRcdFx0XHRpZihhdC5vYmogPT09IGhhcy5vYmopeyByZXR1cm4gaGFzIH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YXJyLnB1c2goYXQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KCkpO1xyXG5cdFx0R3JhcGgubm9kZSA9IGZ1bmN0aW9uKG5vZGUpe1xyXG5cdFx0XHR2YXIgc291bCA9IE5vZGUuc291bChub2RlKTtcclxuXHRcdFx0aWYoIXNvdWwpeyByZXR1cm4gfVxyXG5cdFx0XHRyZXR1cm4gb2JqX3B1dCh7fSwgc291bCwgbm9kZSk7XHJcblx0XHR9XHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdEdyYXBoLnRvID0gZnVuY3Rpb24oZ3JhcGgsIHJvb3QsIG9wdCl7XHJcblx0XHRcdFx0aWYoIWdyYXBoKXsgcmV0dXJuIH1cclxuXHRcdFx0XHR2YXIgb2JqID0ge307XHJcblx0XHRcdFx0b3B0ID0gb3B0IHx8IHtzZWVuOiB7fX07XHJcblx0XHRcdFx0b2JqX21hcChncmFwaFtyb290XSwgbWFwLCB7b2JqOm9iaiwgZ3JhcGg6IGdyYXBoLCBvcHQ6IG9wdH0pO1xyXG5cdFx0XHRcdHJldHVybiBvYmo7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gbWFwKHYsZil7IHZhciB0bXAsIG9iajtcclxuXHRcdFx0XHRpZihOb2RlLl8gPT09IGYpe1xyXG5cdFx0XHRcdFx0aWYob2JqX2VtcHR5KHYsIFZhbC5yZWwuXykpe1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0aGlzLm9ialtmXSA9IG9ial9jb3B5KHYpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZighKHRtcCA9IFZhbC5yZWwuaXModikpKXtcclxuXHRcdFx0XHRcdHRoaXMub2JqW2ZdID0gdjtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYob2JqID0gdGhpcy5vcHQuc2Vlblt0bXBdKXtcclxuXHRcdFx0XHRcdHRoaXMub2JqW2ZdID0gb2JqO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLm9ialtmXSA9IHRoaXMub3B0LnNlZW5bdG1wXSA9IEdyYXBoLnRvKHRoaXMuZ3JhcGgsIHRtcCwgdGhpcy5vcHQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KCkpO1xyXG5cdFx0dmFyIGZuX2lzID0gVHlwZS5mbi5pcztcclxuXHRcdHZhciBvYmogPSBUeXBlLm9iaiwgb2JqX2lzID0gb2JqLmlzLCBvYmpfZGVsID0gb2JqLmRlbCwgb2JqX2hhcyA9IG9iai5oYXMsIG9ial9lbXB0eSA9IG9iai5lbXB0eSwgb2JqX3B1dCA9IG9iai5wdXQsIG9ial9tYXAgPSBvYmoubWFwLCBvYmpfY29weSA9IG9iai5jb3B5O1xyXG5cdFx0dmFyIHU7XHJcblx0XHRtb2R1bGUuZXhwb3J0cyA9IEdyYXBoO1xyXG5cdH0pKHJlcXVpcmUsICcuL2dyYXBoJyk7XHJcblxyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cclxuXHRcdGZ1bmN0aW9uIEd1bihvKXtcclxuXHRcdFx0aWYoISh0aGlzIGluc3RhbmNlb2YgR3VuKSl7IHJldHVybiBHdW4uY3JlYXRlKG8pIH1cclxuXHRcdFx0dGhpcy5fID0ge2d1bjogdGhpc307XHJcblx0XHR9XHJcblxyXG5cdFx0R3VuLmNyZWF0ZSA9IGZ1bmN0aW9uKG8pe1xyXG5cdFx0XHRyZXR1cm4gbmV3IEd1bigpLm9wdChvKTtcclxuXHRcdH07XHJcblxyXG5cdFx0R3VuLl8gPSB7IC8vIHNvbWUgcmVzZXJ2ZWQga2V5IHdvcmRzLCB0aGVzZSBhcmUgbm90IHRoZSBvbmx5IG9uZXMuXHJcblx0XHRcdG1ldGE6ICdfJyAvLyBhbGwgbWV0YWRhdGEgb2YgdGhlIG5vZGUgaXMgc3RvcmVkIGluIHRoZSBtZXRhIHByb3BlcnR5IG9uIHRoZSBub2RlLlxyXG5cdFx0XHQsc291bDogJyMnIC8vIGEgc291bCBpcyBhIFVVSUQgb2YgYSBub2RlIGJ1dCBpdCBhbHdheXMgcG9pbnRzIHRvIHRoZSBcImxhdGVzdFwiIGRhdGEga25vd24uXHJcblx0XHRcdCxmaWVsZDogJy4nIC8vIGEgZmllbGQgaXMgYSBwcm9wZXJ0eSBvbiBhIG5vZGUgd2hpY2ggcG9pbnRzIHRvIGEgdmFsdWUuXHJcblx0XHRcdCxzdGF0ZTogJz4nIC8vIG90aGVyIHRoYW4gdGhlIHNvdWwsIHdlIHN0b3JlIEhBTSBtZXRhZGF0YS5cclxuXHRcdFx0LHZhbHVlOiAnPScgLy8gdGhlIHByaW1pdGl2ZSB2YWx1ZS5cclxuXHRcdH1cclxuXHJcblx0XHRHdW4uX18gPSB7XHJcblx0XHRcdCdfJzonbWV0YSdcclxuXHRcdFx0LCcjJzonc291bCdcclxuXHRcdFx0LCcuJzonZmllbGQnXHJcblx0XHRcdCwnPSc6J3ZhbHVlJ1xyXG5cdFx0XHQsJz4nOidzdGF0ZSdcclxuXHRcdH1cclxuXHJcblx0XHRHdW4udmVyc2lvbiA9IDAuNDtcclxuXHJcblx0XHRHdW4uaXMgPSBmdW5jdGlvbihndW4peyByZXR1cm4gKGd1biBpbnN0YW5jZW9mIEd1bikgfSAvLyBjaGVjayB0byBzZWUgaWYgaXQgaXMgYSBHVU4gaW5zdGFuY2UuXHJcblxyXG5cdFx0dmFyIFR5cGUgPSByZXF1aXJlKCcuL3R5cGUnKTtcclxuXHRcdFR5cGUub2JqLm1hcChUeXBlLCBmdW5jdGlvbih2LGYpe1xyXG5cdFx0XHRHdW5bZl0gPSB2O1xyXG5cdFx0fSk7XHJcblx0XHRHdW4uSEFNID0gcmVxdWlyZSgnLi9IQU0nKTtcclxuXHRcdEd1bi52YWwgPSByZXF1aXJlKCcuL3ZhbCcpO1xyXG5cdFx0R3VuLm5vZGUgPSByZXF1aXJlKCcuL25vZGUnKTtcclxuXHRcdEd1bi5zdGF0ZSA9IHJlcXVpcmUoJy4vc3RhdGUnKTtcclxuXHRcdEd1bi5ncmFwaCA9IHJlcXVpcmUoJy4vZ3JhcGgnKTtcclxuXHJcblx0XHRHdW4ub24gPSByZXF1aXJlKCcuL29uaWZ5JykoKTtcclxuXHRcdFxyXG5cdFx0LypcclxuXHRcdHZhciBvcHQgPSB7Y2hhaW46ICdpbicsIGJhY2s6ICdvdXQnLCBleHRlbmQ6ICdyb290JywgaWQ6IEd1bi5fLnNvdWx9O1xyXG5cdFx0R3VuLmNoYWluID0gcmVxdWlyZSgnLi9jaGFpbicpKEd1biwgb3B0KTtcclxuXHRcdEd1bi5jaGFpbi5jaGFpbi5vcHQgPSBvcHQ7XHJcblx0XHQqL1xyXG5cdFx0KEd1bi5jaGFpbiA9IEd1bi5wcm90b3R5cGUpLmNoYWluID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0dmFyIGNoYWluID0gbmV3IHRoaXMuY29uc3RydWN0b3IoKSwgXztcclxuXHRcdFx0XyA9IGNoYWluLl8gfHwgKGNoYWluLl8gPSB7fSk7XHJcblx0XHRcdF8ucm9vdCA9IHRoaXMuXy5yb290O1xyXG5cdFx0XHRfLmJhY2sgPSB0aGlzO1xyXG5cdFx0XHRyZXR1cm4gY2hhaW47XHJcblx0XHR9XHJcblx0XHRHdW4uY2hhaW4udG9KU09OID0gZnVuY3Rpb24oKXt9O1xyXG5cclxuXHRcdDsoZnVuY3Rpb24oKXtcclxuXHJcblx0XHRcdEd1bi5jaGFpbi5vcHQgPSBmdW5jdGlvbihvcHQpe1xyXG5cdFx0XHRcdG9wdCA9IG9wdCB8fCB7fTtcclxuXHRcdFx0XHR2YXIgZ3VuID0gdGhpcywgYXQgPSBndW4uXywgdG1wLCB1O1xyXG5cdFx0XHRcdGlmKCFhdC5yb290KXsgcm9vdChhdCkgfVxyXG5cdFx0XHRcdHRtcCA9IGF0Lm9wdCA9IGF0Lm9wdCB8fCB7fTtcclxuXHRcdFx0XHRpZih0ZXh0X2lzKG9wdCkpeyBvcHQgPSB7cGVlcnM6IG9wdH0gfVxyXG5cdFx0XHRcdGVsc2UgaWYobGlzdF9pcyhvcHQpKXsgb3B0ID0ge3BlZXJzOiBvcHR9IH1cclxuXHRcdFx0XHRpZih0ZXh0X2lzKG9wdC5wZWVycykpeyBvcHQucGVlcnMgPSBbb3B0LnBlZXJzXSB9XHJcblx0XHRcdFx0aWYobGlzdF9pcyhvcHQucGVlcnMpKXsgb3B0LnBlZXJzID0gb2JqX21hcChvcHQucGVlcnMsIGZ1bmN0aW9uKG4sZixtKXttKG4se30pfSkgfVxyXG5cdFx0XHRcdG9ial9tYXAob3B0LCBmdW5jdGlvbiBtYXAodixmKXtcclxuXHRcdFx0XHRcdGlmKG9ial9pcyh2KSl7XHJcblx0XHRcdFx0XHRcdHRtcCA9IHRtcFtmXSB8fCAodG1wW2ZdID0ge30pOyAvLyBUT0RPOiBCdWc/IEJlIGNhcmVmdWwgb2YgZmFsc2V5IHZhbHVlcyBnZXR0aW5nIG92ZXJ3cml0dGVuP1xyXG5cdFx0XHRcdFx0XHRvYmpfbWFwKHYsIG1hcCk7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRtcFtmXSA9IHY7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0R3VuLm9uKCdvcHQnLCBhdCk7XHJcblx0XHRcdFx0cmV0dXJuIGd1bjtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiByb290KGF0KXtcclxuXHRcdFx0XHR2YXIgZ3VuID0gYXQuZ3VuO1xyXG5cdFx0XHRcdGF0LnJvb3QgPSBndW47XHJcblx0XHRcdFx0YXQuZ3JhcGggPSB7fTtcclxuXHRcdFx0XHRndW4ub24oJ2luJywgaW5wdXQsIGF0KTtcclxuXHRcdFx0XHRndW4ub24oJ291dCcsIG91dHB1dCwgYXQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIG91dHB1dChhdCl7XHJcblx0XHRcdFx0dmFyIGNhdCA9IHRoaXMsIGd1biA9IGNhdC5ndW4sIHRtcDtcclxuXHRcdFx0XHRpZihhdC5wdXQpe1xyXG5cdFx0XHRcdFx0Y2F0Lm9uKCdpbicsIG9ial90byhhdCwge2d1bjogY2F0Lmd1bn0pKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoIWF0Lmd1bil7XHJcblx0XHRcdFx0XHRhdCA9IEd1bi5vYmoudG8oYXQsIHtndW46IGd1bn0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihhdC5wdXQpeyBHdW4ub24oJ3B1dCcsIGF0KSB9XHJcblx0XHRcdFx0aWYoYXQuZ2V0KXsgZ2V0KGF0LCBjYXQpIH1cclxuXHRcdFx0XHRHdW4ub24oJ291dCcsIGF0KTtcclxuXHRcdFx0XHRpZighY2F0LmJhY2speyByZXR1cm4gfVxyXG5cdFx0XHRcdGNhdC5iYWNrLm9uKCdvdXQnLCBhdCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gZ2V0KGF0LCBjYXQpe1xyXG5cdFx0XHRcdHZhciBzb3VsID0gYXQuZ2V0W19zb3VsXSwgbm9kZSA9IGNhdC5ncmFwaFtzb3VsXSwgZmllbGQgPSBhdC5nZXRbX2ZpZWxkXTtcclxuXHRcdFx0XHRpZihub2RlICYmICghZmllbGQgfHwgb2JqX2hhcyhub2RlLCBmaWVsZCkpKXtcclxuXHRcdFx0XHRcdC8vIFRPRE86IEJVRyEhISBTaG91bGRuJ3QgdGhpcyBhY2s/Pz8/P1xyXG5cdFx0XHRcdFx0aWYoZmllbGQpe1xyXG5cdFx0XHRcdFx0XHRub2RlID0gR3VuLm9iai5wdXQoe186IG5vZGUuX30sIGZpZWxkLCBub2RlW2ZpZWxkXSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRjYXQub24oJ2luJywge1xyXG5cdFx0XHRcdFx0XHQnQCc6IGF0LnJlcT8gYXRbJyMnXSA6IDAsIC8vIHRlbXBvcmFyeSBoYWNrXHJcblx0XHRcdFx0XHRcdHB1dDogR3VuLmdyYXBoLm5vZGUobm9kZSkgLy8gVE9ETzogQlVHISBDbG9uZSBub2RlIVxyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdEd1bi5vbignZ2V0JywgYXQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGlucHV0KGF0KXsgdmFyIGNhdCA9IHRoaXM7XHJcblx0XHRcdFx0aWYoYXRbJ0AnXSB8fCBhdC5lcnIgfHwgdSA9PT0gYXQucHV0KXtcclxuXHRcdFx0XHRcdGF0Lmd1biA9IGF0Lmd1biB8fCBjYXQuZ3VuO1xyXG5cdFx0XHRcdFx0R3VuLm9uLmFjayhhdFsnQCddLCBhdCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGNhdC5ncmFwaCl7XHJcblx0XHRcdFx0XHRHdW4ub2JqLm1hcChhdC5wdXQsIGhhbSwge2F0OiBhdCwgY2F0OiB0aGlzfSk7IC8vIGFsbCB1bmlvbnMgbXVzdCBoYXBwZW4gZmlyc3QsIHNhZGx5LlxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRHdW4ub2JqLm1hcChhdC5wdXQsIG1hcCwge2F0OiBhdCwgY2F0OiB0aGlzfSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gaGFtKGRhdGEsIGtleSl7XHJcblx0XHRcdFx0dmFyIGNhdCA9IHRoaXMuY2F0LCBncmFwaCA9IGNhdC5ncmFwaDtcclxuXHRcdFx0XHRncmFwaFtrZXldID0gR3VuLkhBTS51bmlvbihncmFwaFtrZXldIHx8IGRhdGEsIGRhdGEpIHx8IGdyYXBoW2tleV07XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gbWFwKGRhdGEsIGtleSl7XHJcblx0XHRcdFx0dmFyIGNhdCA9IHRoaXMuY2F0LCBncmFwaCA9IGNhdC5ncmFwaCwgcGF0aCA9IGNhdC5wYXRoIHx8IChjYXQucGF0aCA9IHt9KSwgZ3VuLCBhdDtcclxuXHRcdFx0XHRndW4gPSBwYXRoW2tleV0gfHwgKHBhdGhba2V5XSA9IGNhdC5ndW4uZ2V0KGtleSkpO1xyXG5cdFx0XHRcdChhdCA9IGd1bi5fKS5jaGFuZ2UgPSBkYXRhO1xyXG5cdFx0XHRcdGlmKGdyYXBoKXtcclxuXHRcdFx0XHRcdGRhdGEgPSBncmFwaFtrZXldOyAvLyBUT0RPISBCVUcvUEVSRiEgQ09QWSE/XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGF0LnB1dCA9IGRhdGE7XHJcblx0XHRcdFx0Z3VuLm9uKCdpbicsIHtcclxuXHRcdFx0XHRcdHB1dDogZGF0YSxcclxuXHRcdFx0XHRcdGdldDoga2V5LFxyXG5cdFx0XHRcdFx0Z3VuOiBndW4sXHJcblx0XHRcdFx0XHR2aWE6IHRoaXMuYXRcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSgpKTtcclxuXHRcdHZhciB0ZXh0ID0gVHlwZS50ZXh0LCB0ZXh0X2lzID0gdGV4dC5pcywgdGV4dF9yYW5kb20gPSB0ZXh0LnJhbmRvbTtcclxuXHRcdHZhciBsaXN0ID0gVHlwZS5saXN0LCBsaXN0X2lzID0gbGlzdC5pcztcclxuXHRcdHZhciBvYmogPSBUeXBlLm9iaiwgb2JqX2lzID0gb2JqLmlzLCBvYmpfaGFzID0gb2JqLmhhcywgb2JqX3RvID0gb2JqLnRvLCBvYmpfbWFwID0gb2JqLm1hcDtcclxuXHRcdHZhciBfc291bCA9IEd1bi5fLnNvdWwsIF9maWVsZCA9IEd1bi5fLmZpZWxkO1xyXG5cdFx0dmFyIHU7XHJcblxyXG5cdFx0Y29uc29sZS5kZWJ1ZyA9IGZ1bmN0aW9uKGksIHMpeyByZXR1cm4gKGNvbnNvbGUuZGVidWcuaSAmJiBpID09PSBjb25zb2xlLmRlYnVnLmkgJiYgY29uc29sZS5kZWJ1Zy5pKyspICYmIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyksIHMgfTtcclxuXHJcblx0XHRHdW4ubG9nID0gZnVuY3Rpb24oKXsgcmV0dXJuICghR3VuLmxvZy5vZmYgJiYgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKSksIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKS5qb2luKCcgJykgfVxyXG5cdFx0R3VuLmxvZy5vbmNlID0gZnVuY3Rpb24odyxzLG8peyByZXR1cm4gKG8gPSBHdW4ubG9nLm9uY2UpW3ddID0gb1t3XSB8fCAwLCBvW3ddKysgfHwgR3VuLmxvZyhzKSB9XHJcblxyXG5cdFx0aWYodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIil7IHdpbmRvdy5HdW4gPSBHdW4gfVxyXG5cdFx0aWYodHlwZW9mIGNvbW1vbiAhPT0gXCJ1bmRlZmluZWRcIil7IGNvbW1vbi5leHBvcnRzID0gR3VuIH1cclxuXHRcdG1vZHVsZS5leHBvcnRzID0gR3VuO1xyXG5cdH0pKHJlcXVpcmUsICcuL2d1bicpO1xyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cclxuXHRcdHZhciBHdW4gPSByZXF1aXJlKCcuL2d1bicpO1xyXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBHdW47XHJcblxyXG5cdFx0OyhmdW5jdGlvbigpe1xyXG5cdFx0XHRmdW5jdGlvbiBtZXRhKHYsZil7XHJcblx0XHRcdFx0aWYob2JqX2hhcyhHdW4uX18sIGYpKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRvYmpfcHV0KHRoaXMuXywgZiwgdik7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gbWFwKHZhbHVlLCBmaWVsZCl7XHJcblx0XHRcdFx0aWYoR3VuLl8ubWV0YSA9PT0gZmllbGQpeyByZXR1cm4gfVxyXG5cdFx0XHRcdHZhciBub2RlID0gdGhpcy5ub2RlLCB2ZXJ0ZXggPSB0aGlzLnZlcnRleCwgdW5pb24gPSB0aGlzLnVuaW9uLCBtYWNoaW5lID0gdGhpcy5tYWNoaW5lO1xyXG5cdFx0XHRcdHZhciBpcyA9IHN0YXRlX2lzKG5vZGUsIGZpZWxkKSwgY3MgPSBzdGF0ZV9pcyh2ZXJ0ZXgsIGZpZWxkKTtcclxuXHRcdFx0XHRpZih1ID09PSBpcyB8fCB1ID09PSBjcyl7IHJldHVybiB0cnVlIH0gLy8gaXQgaXMgdHJ1ZSB0aGF0IHRoaXMgaXMgYW4gaW52YWxpZCBIQU0gY29tcGFyaXNvbi5cclxuXHRcdFx0XHR2YXIgaXYgPSByZWxfaXModmFsdWUpIHx8IHZhbHVlLCBjdiA9IHJlbF9pcyh2ZXJ0ZXhbZmllbGRdKSB8fCB2ZXJ0ZXhbZmllbGRdO1xyXG5cdFx0XHRcdFxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHRcdFx0XHQvLyBUT0RPOiBCVUchIE5lZWQgdG8gY29tcGFyZSByZWxhdGlvbiB0byBub3QgcmVsYXRpb24sIGFuZCBjaG9vc2UgdGhlIHJlbGF0aW9uIGlmIHRoZXJlIGlzIGEgc3RhdGUgY29uZmxpY3QuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHRcdFx0XHRpZighdmFsX2lzKGl2KSAmJiB1ICE9PSBpdil7IHJldHVybiB0cnVlIH0gLy8gVW5kZWZpbmVkIGlzIG9rYXkgc2luY2UgYSB2YWx1ZSBtaWdodCBub3QgZXhpc3Qgb24gYm90aCBub2Rlcy4gLy8gaXQgaXMgdHJ1ZSB0aGF0IHRoaXMgaXMgYW4gaW52YWxpZCBIQU0gY29tcGFyaXNvbi5cclxuXHRcdFx0XHRpZighdmFsX2lzKGN2KSAmJiB1ICE9PSBjdil7IHJldHVybiB0cnVlIH0gIC8vIFVuZGVmaW5lZCBpcyBva2F5IHNpbmNlIGEgdmFsdWUgbWlnaHQgbm90IGV4aXN0IG9uIGJvdGggbm9kZXMuIC8vIGl0IGlzIHRydWUgdGhhdCB0aGlzIGlzIGFuIGludmFsaWQgSEFNIGNvbXBhcmlzb24uXHJcblx0XHRcdFx0dmFyIEhBTSA9IEd1bi5IQU0obWFjaGluZSwgaXMsIGNzLCBpdiwgY3YpO1xyXG5cdFx0XHRcdGlmKEhBTS5lcnIpe1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCIuIUhZUE9USEVUSUNBTCBBTU5FU0lBIE1BQ0hJTkUgRVJSIS5cIiwgSEFNLmVycik7IC8vIHRoaXMgZXJyb3Igc2hvdWxkIG5ldmVyIGhhcHBlbi5cclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoSEFNLnN0YXRlIHx8IEhBTS5oaXN0b3JpY2FsIHx8IEhBTS5jdXJyZW50KXsgLy8gVE9ETzogQlVHISBOb3QgaW1wbGVtZW50ZWQuXHJcblx0XHRcdFx0XHQvL29wdC5sb3dlcih2ZXJ0ZXgsIHtmaWVsZDogZmllbGQsIHZhbHVlOiB2YWx1ZSwgc3RhdGU6IGlzfSk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKEhBTS5pbmNvbWluZyl7XHJcblx0XHRcdFx0XHR1bmlvbltmaWVsZF0gPSB2YWx1ZTtcclxuXHRcdFx0XHRcdHN0YXRlX2lmeSh1bmlvbiwgZmllbGQsIGlzKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoSEFNLmRlZmVyKXsgLy8gVE9ETzogQlVHISBOb3QgaW1wbGVtZW50ZWQuXHJcblx0XHRcdFx0XHQvKnVwcGVyLndhaXQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0b3B0LnVwcGVyLmNhbGwoc3RhdGUsIHZlcnRleCwgZmllbGQsIGluY29taW5nLCBjdHguaW5jb21pbmcuc3RhdGUpOyAvLyBzaWduYWxzIHRoYXQgdGhlcmUgYXJlIHN0aWxsIGZ1dHVyZSBtb2RpZmljYXRpb25zLlxyXG5cdFx0XHRcdFx0R3VuLnNjaGVkdWxlKGN0eC5pbmNvbWluZy5zdGF0ZSwgZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0dXBkYXRlKGluY29taW5nLCBmaWVsZCk7XHJcblx0XHRcdFx0XHRcdGlmKGN0eC5pbmNvbWluZy5zdGF0ZSA9PT0gdXBwZXIubWF4KXsgKHVwcGVyLmxhc3QgfHwgZnVuY3Rpb24oKXt9KSgpIH1cclxuXHRcdFx0XHRcdH0sIGd1bi5fXy5vcHQuc3RhdGUpOyovXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdEd1bi5IQU0udW5pb24gPSBmdW5jdGlvbih2ZXJ0ZXgsIG5vZGUsIG9wdCl7XHJcblx0XHRcdFx0aWYoIW5vZGUgfHwgIXZlcnRleCB8fCAhbm9kZS5fIHx8ICF2ZXJ0ZXguXyl7IHJldHVybiB9XHJcblx0XHRcdFx0b3B0ID0gbnVtX2lzKG9wdCk/IHttYWNoaW5lOiBvcHR9IDoge21hY2hpbmU6ICgrbmV3IERhdGUpfTtcclxuXHRcdFx0XHRvcHQudW5pb24gPSBHdW4ub2JqLmNvcHkodmVydGV4KTtcclxuXHRcdFx0XHRvcHQudmVydGV4ID0gdmVydGV4O1xyXG5cdFx0XHRcdG9wdC5ub2RlID0gbm9kZTtcclxuXHRcdFx0XHRvYmpfbWFwKG5vZGUuXywgbWV0YSwgb3B0LnVuaW9uKTtcclxuXHRcdFx0XHRpZihvYmpfbWFwKG5vZGUsIG1hcCwgb3B0KSl7IC8vIGlmIHRoaXMgcmV0dXJucyB0cnVlIHRoZW4gc29tZXRoaW5nIHdhcyBpbnZhbGlkLlxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gb3B0LnVuaW9uO1xyXG5cdFx0XHR9XHJcblx0XHRcdHZhciBUeXBlID0gR3VuO1xyXG5cdFx0XHR2YXIgbnVtID0gVHlwZS5udW0sIG51bV9pcyA9IG51bS5pcztcclxuXHRcdFx0dmFyIG9iaiA9IFR5cGUub2JqLCBvYmpfaGFzID0gb2JqLmhhcywgb2JqX3B1dCA9IG9iai5wdXQsIG9ial9tYXAgPSBvYmoubWFwO1xyXG5cdFx0XHR2YXIgbm9kZSA9IEd1bi5ub2RlLCBub2RlX3NvdWwgPSBub2RlLnNvdWwsIG5vZGVfaXMgPSBub2RlLmlzLCBub2RlX2lmeSA9IG5vZGUuaWZ5O1xyXG5cdFx0XHR2YXIgc3RhdGUgPSBHdW4uc3RhdGUsIHN0YXRlX2lzID0gc3RhdGUuaXMsIHN0YXRlX2lmeSA9IHN0YXRlLmlmeTtcclxuXHRcdFx0dmFyIHZhbCA9IEd1bi52YWwsIHZhbF9pcyA9IHZhbC5pcywgcmVsX2lzID0gdmFsLnJlbC5pcztcclxuXHRcdFx0dmFyIHU7XHJcblx0XHR9KCkpO1xyXG5cclxuXHR9KShyZXF1aXJlLCAnLi9pbmRleCcpO1xyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cdFx0dmFyIEd1biA9IHJlcXVpcmUoJy4vaW5kZXgnKTtcclxuXHRcdHZhciBvYmogPSBHdW4ub2JqLCBvYmpfaXMgPSBvYmouaXMsIG9ial9wdXQgPSBvYmoucHV0LCBvYmpfbWFwID0gb2JqLm1hcCwgb2JqX2VtcHR5ID0gb2JqLmVtcHR5O1xyXG5cdFx0dmFyIG51bSA9IEd1bi5udW0sIG51bV9pcyA9IG51bS5pcztcclxuXHRcdHZhciBfc291bCA9IEd1bi52YWwucmVsLl8sIF9maWVsZCA9ICcuJztcclxuXHRcdFxyXG5cdFx0OyhmdW5jdGlvbigpeyB2YXIgb2JqID0ge30sIHU7XHJcblx0XHRcdEd1bi5jaGFpbi5CYWNrID0gZnVuY3Rpb24obiwgb3B0KXsgdmFyIHRtcDtcclxuXHRcdFx0XHRpZigtMSA9PT0gbiB8fCBJbmZpbml0eSA9PT0gbil7XHJcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fLnJvb3Q7XHJcblx0XHRcdFx0fSBlbHNlXHJcblx0XHRcdFx0aWYoMSA9PT0gbil7XHJcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fLmJhY2s7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBndW4gPSB0aGlzLCBhdCA9IGd1bi5fO1xyXG5cdFx0XHRcdGlmKHR5cGVvZiBuID09PSAnc3RyaW5nJyl7XHJcblx0XHRcdFx0XHRuID0gbi5zcGxpdCgnLicpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihuIGluc3RhbmNlb2YgQXJyYXkpe1xyXG5cdFx0XHRcdFx0dmFyIGkgPSAwLCBsID0gbi5sZW5ndGgsIHRtcCA9IGF0O1xyXG5cdFx0XHRcdFx0Zm9yKGk7IGkgPCBsOyBpKyspe1xyXG5cdFx0XHRcdFx0XHR0bXAgPSAodG1wfHxvYmopW25baV1dO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYodSAhPT0gdG1wKXtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIG9wdD8gZ3VuIDogdG1wO1xyXG5cdFx0XHRcdFx0fSBlbHNlXHJcblx0XHRcdFx0XHRpZih0bXAgPSBhdC5iYWNrKXtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHRtcC5CYWNrKG4sIG9wdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKG4gaW5zdGFuY2VvZiBGdW5jdGlvbil7XHJcblx0XHRcdFx0XHR2YXIgeWVzLCB0bXAgPSB7Xzp7YmFjazogZ3VufX07XHJcblx0XHRcdFx0XHR3aGlsZSgodG1wID0gdG1wLl8pICYmICh0bXAgPSB0bXAuYmFjaykgJiYgISh5ZXMgPSBuKHRtcCwgb3B0KSkpe31cclxuXHRcdFx0XHRcdHJldHVybiB5ZXM7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KCkpXHJcblxyXG5cdFx0OyhmdW5jdGlvbigpe1xyXG5cclxuXHRcdFx0R3VuLmNoYWluLnB1dCA9IGZ1bmN0aW9uKGRhdGEsIGNiLCBvcHQsIGFzKXtcclxuXHRcdFx0XHQvLyBUT0RPOiBCVUchIFB1dCBwcm9iYWJseSBjYW5ub3QgaGFuZGxlIHBsdXJhbCBjaGFpbnMhXHJcblx0XHRcdFx0dmFyIGd1biA9IHRoaXMsIHJvb3QgPSBndW4uQmFjaygtMSksIHRtcDtcclxuXHRcdFx0XHRvcHQgPSAob3B0ICYmIHR5cGVvZiBvcHQgPT09ICdzdHJpbmcnKT8ge3NvdWw6IG9wdH0gOiBvcHQgfHwge307XHJcblx0XHRcdFx0YXMgPSBhcyB8fCB7b3B0OiBvcHQsIHNvdWw6IG9wdC5zb3VsfTtcclxuXHRcdFx0XHRhcy5ndW4gPSBndW47XHJcblx0XHRcdFx0YXMuZGF0YSA9IGRhdGE7XHJcblx0XHRcdFx0b3B0LmFueSA9IG9wdC5hbnkgfHwgY2I7XHJcblx0XHRcdFx0aWYocm9vdCA9PT0gZ3VuIHx8IGFzLnNvdWwpe1xyXG5cdFx0XHRcdFx0aWYoIW9ial9pcyhhcy5kYXRhKSl7XHJcblx0XHRcdFx0XHRcdChvcHQuYW55fHxub29wKS5jYWxsKG9wdC5hcyB8fCBndW4sIGFzLm91dCA9IHtlcnI6IEd1bi5sb2coXCJObyBmaWVsZCB0byBwdXRcIiwgKHR5cGVvZiBhcy5kYXRhKSwgJ1wiJyArIGFzLmRhdGEgKyAnXCIgb24hJyl9KTtcclxuXHRcdFx0XHRcdFx0aWYoYXMucmVzKXsgYXMucmVzKCkgfVxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZ3VuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoIWFzLnNvdWwpe1xyXG5cdFx0XHRcdFx0XHRpZihvcHQuaW5pdCB8fCBhcy5ndW4uQmFjaygnb3B0LmluaXQnKSl7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGd1bjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0YXMuZ3VuID0gZ3VuID0gcm9vdC5nZXQoYXMuc291bCA9IGFzLnNvdWwgfHwgKGFzLm5vdCA9IEd1bi5ub2RlLnNvdWwoYXMuZGF0YSkgfHwgKG9wdC51dWlkIHx8IHJvb3QuQmFjaygnb3B0LnV1aWQnKSB8fCBHdW4udGV4dC5yYW5kb20pKCkpKTtcclxuXHRcdFx0XHRcdGFzLnJlZiA9IGFzLnJlZiB8fCBhcy5ndW47XHJcblx0XHRcdFx0XHRpZnkoYXMpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGd1bjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoR3VuLmlzKGRhdGEpKXtcclxuXHRcdFx0XHRcdGRhdGEuYW55KGZ1bmN0aW9uKGUsZCxrLGF0LGV2KXtcclxuXHRcdFx0XHRcdFx0ZXYub2ZmKCk7XHJcblx0XHRcdFx0XHRcdHZhciBzID0gR3VuLm5vZGUuc291bChkKTtcclxuXHRcdFx0XHRcdFx0aWYoIXMpe0d1bi5sb2coXCJDYW4gb25seSBzYXZlIGEgbm9kZSwgbm90IGEgcHJvcGVydHkuXCIpO3JldHVybn1cclxuXHRcdFx0XHRcdFx0Z3VuLnB1dChHdW4udmFsLnJlbC5pZnkocyksIGNiLCBvcHQpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRyZXR1cm4gZ3VuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhcy5yZWYgPSBhcy5yZWYgfHwgKHJvb3QgPT09ICh0bXAgPSBndW4uQmFjaygxKSkpPyBndW4gOiB0bXA7XHJcblx0XHRcdFx0YXMucmVmLmFueShhbnksIHthczogYXMsICcuJzogbnVsbH0pO1xyXG5cdFx0XHRcdGlmKCFhcy5vdXQpe1xyXG5cdFx0XHRcdFx0YXMucmVzID0gYXMucmVzIHx8IEd1bi5vbi5zdHVuKGFzLnJlZik7XHJcblx0XHRcdFx0XHRhcy5ndW4uXy5zdHVuID0gYXMucmVmLl8uc3R1bjsgLy8gVE9ETzogQlVHISBUaGVzZSBzdHVucyBuZWVkIHRvIGJlIGF0dGFjaGVkIGFsbCB0aGUgd2F5IGRvd24sIG5vdCBqdXN0IG9uZSBsZXZlbC5cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIGd1bjtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdGZ1bmN0aW9uIGlmeShhcyl7XHJcblx0XHRcdFx0YXMuYmF0Y2ggPSBiYXRjaDtcclxuXHRcdFx0XHR2YXIgb3B0ID0gYXMub3B0LCBlbnYgPSBhcy5lbnYgPSBHdW4uc3RhdGUubWFwKG1hcCwgb3B0LnN0YXRlKTtcclxuXHRcdFx0XHRlbnYuc291bCA9IGFzLnNvdWw7XHJcblx0XHRcdFx0YXMuZ3JhcGggPSBHdW4uZ3JhcGguaWZ5KGFzLmRhdGEsIGVudiwgYXMpO1xyXG5cdFx0XHRcdGlmKGVudi5lcnIpe1xyXG5cdFx0XHRcdFx0KG9wdC5hbnl8fG5vb3ApLmNhbGwob3B0LmFzIHx8IGFzLmd1biwgYXMub3V0ID0ge2VycjogR3VuLmxvZyhlbnYuZXJyKX0pO1xyXG5cdFx0XHRcdFx0aWYoYXMucmVzKXsgYXMucmVzKCkgfVxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhcy5iYXRjaCgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRmdW5jdGlvbiBiYXRjaCgpeyB2YXIgYXMgPSB0aGlzO1xyXG5cdFx0XHRcdGlmKCFhcy5ncmFwaCB8fCBvYmpfbWFwKGFzLnN0dW4sIG5vKSl7IHJldHVybiB9XHJcblx0XHRcdFx0YXMucmVmLm9uKCdvdXQnLCB7XHJcblx0XHRcdFx0XHRndW46IGFzLnJlZiwgcHV0OiBhcy5vdXQgPSBhcy5lbnYuZ3JhcGgsIG9wdDogYXMub3B0LFxyXG5cdFx0XHRcdFx0JyMnOiBHdW4ub24uYXNrKGZ1bmN0aW9uKGFjaywgZXYpe1xyXG5cdFx0XHRcdFx0XHRpZihhY2sgJiYgMCA9PT0gYWNrLm9rKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdFx0ZXYub2ZmKCk7IC8vIE9uZSByZXNwb25zZSBpcyBnb29kIGVub3VnaCBmb3IgdXMgY3VycmVudGx5LiBMYXRlciB3ZSBtYXkgd2FudCB0byBhZGp1c3QgdGhpcy5cclxuXHRcdFx0XHRcdFx0aWYoIWFzLm9wdC5hbnkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0XHRhcy5vcHQuYW55LmNhbGwoYXMub3B0LmFzIHx8IGFzLmd1biwgYWNrLmVyciwgYWNrLm9rKTtcclxuXHRcdFx0XHRcdH0sIGFzLm9wdClcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRpZihhcy5yZXMpeyBhcy5yZXMoKSB9XHJcblx0XHRcdH0gZnVuY3Rpb24gbm8odixmKXsgaWYodil7IHJldHVybiB0cnVlIH0gfVxyXG5cclxuXHRcdFx0ZnVuY3Rpb24gbWFwKHYsZixuLCBhdCl7IHZhciBhcyA9IHRoaXM7XHJcblx0XHRcdFx0aWYoZiB8fCAhYXQucGF0aC5sZW5ndGgpeyByZXR1cm4gfVxyXG5cdFx0XHRcdHZhciBwYXRoID0gYXQucGF0aCwgcmVmID0gYXMucmVmLCBvcHQgPSBhcy5vcHQ7XHJcblx0XHRcdFx0dmFyIGkgPSAwLCBsID0gcGF0aC5sZW5ndGg7XHJcblx0XHRcdFx0Zm9yKGk7IGkgPCBsOyBpKyspe1xyXG5cdFx0XHRcdFx0cmVmID0gcmVmLmdldChwYXRoW2ldLCBudWxsLCB7cGF0aDogdHJ1ZX0pOyAvLyBUT0RPOiBBUEkgY2hhbmdlISBXZSB3b24ndCBuZWVkICdwYXRoOiB0cnVlJyBhbnltb3JlLlxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihhcy5ub3QgfHwgR3VuLm5vZGUuc291bChhdC5vYmopKXtcclxuXHRcdFx0XHRcdGF0LnNvdWwoR3VuLm5vZGUuc291bChhdC5vYmopIHx8IChhcy5vcHQudXVpZCB8fCBhcy5ndW4uQmFjaygnb3B0LnV1aWQnKSB8fCBHdW4udGV4dC5yYW5kb20pKCkpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQoYXMuc3R1biA9IGFzLnN0dW4gfHwge30pW3BhdGhdID0gdHJ1ZTtcclxuXHRcdFx0XHRpZihhcy5yZXMpe1xyXG5cdFx0XHRcdFx0YXMucmVzKDEpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZWYuYW55KHNvdWwsIHthczoge2F0OiBhdCwgYXM6IGFzfSwgJy4nOiBudWxsfSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGZ1bmN0aW9uIHNvdWwoYXQsIGV2KXsgdmFyIGFzID0gdGhpcy5hcywgY2F0ID0gdGhpcy5hdDtcclxuXHRcdFx0XHRldi5zdHVuKCk7IC8vIFRPRE86IEJVRyE/XHJcblx0XHRcdFx0ZXYub2ZmKCk7XHJcblx0XHRcdFx0Y2F0LnNvdWwoR3VuLm5vZGUuc291bChjYXQub2JqKSB8fCBHdW4ubm9kZS5zb3VsKGF0LnB1dCkgfHwgR3VuLnZhbC5yZWwuaXMoYXQucHV0KSB8fCAoYXMub3B0LnV1aWQgfHwgYXMuZ3VuLkJhY2soJ29wdC51dWlkJykgfHwgR3VuLnRleHQucmFuZG9tKSgpKTsgLy8gVE9ETzogQlVHIT8gRG8gd2UgcmVhbGx5IHdhbnQgdGhlIHNvdWwgb2YgdGhlIG9iamVjdCBnaXZlbiB0byB1cz8gQ291bGQgdGhhdCBiZSBkYW5nZXJvdXM/XHJcblx0XHRcdFx0YXMuc3R1bltjYXQucGF0aF0gPSBmYWxzZTtcclxuXHRcdFx0XHRhcy5iYXRjaCgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRmdW5jdGlvbiBhbnkoYXQsIGV2KXsgXHJcblx0XHRcdFx0ZnVuY3Rpb24gaW1wbGljaXQoYXQpeyAvLyBUT0RPOiBDTEVBTiBVUCEhISEhXHJcblx0XHRcdFx0XHRpZighYXQgfHwgIWF0LmdldCl7IHJldHVybiB9IC8vIFRPRE86IENMRUFOIFVQISEhISFcclxuXHRcdFx0XHRcdGFzLmRhdGEgPSBvYmpfcHV0KHt9LCB0bXAgPSBhdC5nZXQsIGFzLmRhdGEpOyAvLyBUT0RPOiBDTEVBTiBVUCEhISEhXHJcblx0XHRcdFx0XHRhdCA9IGF0LnZpYTsgLy8gVE9ETzogQ0xFQU4gVVAhISEhIVxyXG5cdFx0XHRcdFx0aWYoIWF0KXsgcmV0dXJuIH0gLy8gVE9ETzogQ0xFQU4gVVAhISEhIVxyXG5cdFx0XHRcdFx0dG1wID0gYXQuZ2V0OyAvLyBUT0RPOiBDTEVBTiBVUCEhISEhXHJcblx0XHRcdFx0XHRpZighYXQudmlhIHx8ICFhdC52aWEuZ2V0KXsgcmV0dXJuIH0gLy8gVE9ETzogQ0xFQU4gVVAhISEhIVxyXG5cdFx0XHRcdFx0aW1wbGljaXQoYXQpOyAgLy8gVE9ETzogQ0xFQU4gVVAhISEhIVxyXG5cdFx0XHRcdH0gLy8gVE9ETzogQ0xFQU4gVVAhISEhIVxyXG5cdFx0XHRcdHZhciBhcyA9IHRoaXM7XHJcblx0XHRcdFx0aWYoYXQuZXJyKXsgXHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIlBsZWFzZSByZXBvcnQgdGhpcyBhcyBhbiBpc3N1ZSEgUHV0LmFueS5lcnJcIik7XHJcblx0XHRcdFx0XHRyZXR1cm4gXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBjYXQgPSBhcy5yZWYuXywgZGF0YSA9IGF0LnB1dCwgb3B0ID0gYXMub3B0LCByb290LCB0bXA7XHJcblx0XHRcdFx0aWYodSA9PT0gZGF0YSl7XHJcblx0XHRcdFx0XHRpZihvcHQuaW5pdCB8fCBhcy5ndW4uQmFjaygnb3B0LmluaXQnKSl7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8qXHJcblx0XHRcdFx0XHRcdFRPRE86IFRISVMgV0hPTEUgU0VDVElPTiBORUVEUyBUTyBCRSBDTEVBTkVEIFVQIVxyXG5cdFx0XHRcdFx0XHRJbXBsaWNpdCBiZWhhdmlvciBzaG91bGQgYmUgbXVjaCBjbGVhbmVyLiBSaWdodCBub3cgaXQgaXMgaGFja3kuXHJcblx0XHRcdFx0XHQqL1xyXG5cdFx0XHRcdFx0Ly8gVE9ETzogQlVHISEhISEhISBBcHBhcmVudGx5IEd1bi5ub2RlLmlmeSBkb2Vzbid0IHByb2R1Y2UgYSB2YWxpZCBIQU0gbm9kZT9cclxuXHRcdFx0XHRcdGlmKGFzLnJlZiAhPT0gYXMuZ3VuKXsgLy8gVE9ETzogQ0xFQU4gVVAhISEhIVxyXG5cdFx0XHRcdFx0XHR0bXAgPSBhcy5ndW4uXy5nZXQ7IC8vIFRPRE86IENMRUFOIFVQISEhISFcclxuXHRcdFx0XHRcdFx0aWYoIXRtcCl7IHJldHVybiB9IC8vIFRPRE86IENMRUFOIFVQISEhISFcclxuXHRcdFx0XHRcdFx0YXMuZGF0YSA9IG9ial9wdXQoe30sIHRtcCwgYXMuZGF0YSk7XHJcblx0XHRcdFx0XHRcdHRtcCA9IHU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZihhcy5ndW4uQmFjaygtMSkgIT09IGNhdC5iYWNrKXtcclxuXHRcdFx0XHRcdFx0aW1wbGljaXQoYXQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dG1wID0gdG1wIHx8IGF0LmdldDtcclxuXHRcdFx0XHRcdGFueS5jYWxsKGFzLCB7XHJcblx0XHRcdFx0XHRcdHB1dDogYXMuZGF0YSxcclxuXHRcdFx0XHRcdFx0Z2V0OiBhcy5ub3QgPSBhcy5zb3VsID0gdG1wXHJcblx0XHRcdFx0XHR9LCBldik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGV2Lm9mZihldi5zdHVuKCkpO1xyXG5cdFx0XHRcdGlmKCFhcy5ub3QgJiYgIShhcy5zb3VsID0gR3VuLm5vZGUuc291bChkYXRhKSkpe1xyXG5cdFx0XHRcdFx0aWYoYXMucGF0aCAmJiBvYmpfaXMoYXMuZGF0YSkpeyAvLyBBcHBhcmVudGx5IG5lY2Vzc2FyeVxyXG5cdFx0XHRcdFx0XHRhcy5zb3VsID0gKG9wdC51dWlkIHx8IGFzLmd1bi5CYWNrKCdvcHQudXVpZCcpIHx8IEd1bi50ZXh0LnJhbmRvbSkoKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8qXHJcblx0XHRcdFx0XHRcdFx0VE9ETzogQ0xFQU4gVVAhIElzIGFueSBvZiB0aGlzIG5lY2Vzc2FyeT9cclxuXHRcdFx0XHRcdFx0Ki9cclxuXHRcdFx0XHRcdFx0aWYoIWF0LmdldCl7XHJcblx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCJQbGVhc2UgcmVwb3J0IHRoaXMgYXMgYW4gaXNzdWUhIFB1dC5hbnkubm8uc291bFwiKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0KGFzLm5leHQgPSBhcy5uZXh0IHx8IEd1bi5vbi5uZXh0KGFzLnJlZikpKGZ1bmN0aW9uKG5leHQpe1xyXG5cdFx0XHRcdFx0XHRcdC8vIFRPRE86IEJVRyEgTWF5YmUgZG9uJ3QgZ28gYmFjayB1cCAxIGJlY2F1c2UgLnB1dCBhbHJlYWR5IGRvZXMgdGhhdCBpZiByZWYgaXNuJ3QgYWxyZWFkeSBzcGVjaWZpZWQ/XHJcblx0XHRcdFx0XHRcdFx0KHJvb3QgPSBhcy5yZWYuQmFjaygxKSkucHV0KGRhdGEgPSBvYmpfcHV0KHt9LCBhdC5nZXQsIGFzLmRhdGEpLCBvcHQuYW55LCBvcHQsIHtcclxuXHRcdFx0XHRcdFx0XHRcdG9wdDogb3B0LFxyXG5cdFx0XHRcdFx0XHRcdFx0cmVmOiByb290XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0Ly9HdW4ub2JqLnRvKG9wdCwge1xyXG5cdFx0XHRcdFx0XHRcdC8vXHRyZWY6IG51bGwsXHJcblx0XHRcdFx0XHRcdFx0Ly9cdGd1bjogbnVsbCxcclxuXHRcdFx0XHRcdFx0XHQvL1x0bmV4dDogbnVsbCxcclxuXHRcdFx0XHRcdFx0XHQvL1x0ZGF0YTogZGF0YVxyXG5cdFx0XHRcdFx0XHRcdC8vfSkpO1xyXG5cdFx0XHRcdFx0XHRcdC8vbmV4dCgpOyAvLyBUT0RPOiBCVUchIE5lZWRlZD8gTm90IG5lZWRlZD9cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoYXMucmVmICE9PSBhcy5ndW4gJiYgIWFzLm5vdCl7XHJcblx0XHRcdFx0XHR0bXAgPSBhcy5ndW4uXy5nZXQ7XHJcblx0XHRcdFx0XHRpZighdG1wKXtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCJQbGVhc2UgcmVwb3J0IHRoaXMgYXMgYW4gaXNzdWUhIFB1dC5uby5nZXRcIik7IC8vIFRPRE86IEJVRyE/P1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRhcy5kYXRhID0gb2JqX3B1dCh7fSwgdG1wLCBhcy5kYXRhKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0YXMucmVmLnB1dChhcy5kYXRhLCBvcHQuYW55LCBvcHQsIGFzKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgb2JqID0gR3VuLm9iaiwgb2JqX2hhcyA9IG9iai5oYXMsIG9ial9wdXQgPSBvYmoucHV0O1xyXG5cdFx0XHR2YXIgdSwgbm9vcCA9IGZ1bmN0aW9uKCl7fTtcclxuXHRcdH0oKSk7XHJcblxyXG5cdFx0OyhmdW5jdGlvbigpe1xyXG5cdFx0XHRHdW4uY2hhaW4uZ2V0ID0gZnVuY3Rpb24obGV4LCBjYiwgb3B0KXtcclxuXHRcdFx0XHRpZighb3B0IHx8ICFvcHQucGF0aCl7IHZhciBiYWNrID0gdGhpcy5CYWNrKC0xKTsgfSAvLyBUT0RPOiBDSEFOR0lORyBBUEkhIFJlbW92ZSB0aGlzIGxpbmUhXHJcblx0XHRcdFx0dmFyIGd1biwgYmFjayA9IGJhY2sgfHwgdGhpcywgY2F0ID0gYmFjay5fO1xyXG5cdFx0XHRcdHZhciBwYXRoID0gY2F0LnBhdGggfHwgZW1wdHksIHRtcDtcclxuXHRcdFx0XHRpZih0eXBlb2YgbGV4ID09PSAnc3RyaW5nJyl7XHJcblx0XHRcdFx0XHRpZighKGd1biA9IHBhdGhbbGV4XSkpe1xyXG5cdFx0XHRcdFx0XHRndW4gPSBjYWNoZShsZXgsIGJhY2spO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZVxyXG5cdFx0XHRcdGlmKCFsZXggJiYgMCAhPSBsZXgpe1xyXG5cdFx0XHRcdFx0KGd1biA9IGJhY2suY2hhaW4oKSkuXy5lcnIgPSB7ZXJyOiBHdW4ubG9nKCdJbnZhbGlkIGdldCByZXF1ZXN0IScsIGxleCl9O1xyXG5cdFx0XHRcdFx0aWYoY2IpeyBjYi5jYWxsKGd1biwgZ3VuLl8uZXJyKSB9XHJcblx0XHRcdFx0XHRyZXR1cm4gZ3VuO1xyXG5cdFx0XHRcdH0gZWxzZVxyXG5cdFx0XHRcdGlmKG51bV9pcyhsZXgpKXtcclxuXHRcdFx0XHRcdHJldHVybiBiYWNrLmdldCgnJytsZXgsIGNiLCBvcHQpO1xyXG5cdFx0XHRcdH0gZWxzZVxyXG5cdFx0XHRcdGlmKHRtcCA9IGxleC5zb3VsKXtcclxuXHRcdFx0XHRcdGlmKCEoZ3VuID0gcGF0aFt0bXBdKSl7XHJcblx0XHRcdFx0XHRcdGd1biA9IGNhY2hlKHRtcCwgYmFjayk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZih0bXAgPSBsZXguZmllbGQpe1xyXG5cdFx0XHRcdFx0XHQob3B0ID0gb3B0IHx8IHt9KS5wYXRoID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGd1bi5nZXQodG1wLCBjYiwgb3B0KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2VcclxuXHRcdFx0XHRpZih0bXAgPSBsZXhbX3NvdWxdKXtcclxuXHRcdFx0XHRcdGlmKCEoZ3VuID0gcGF0aFt0bXBdKSl7XHJcblx0XHRcdFx0XHRcdGd1biA9IGNhY2hlKHRtcCwgYmFjayk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZih0bXAgPSBsZXhbX2ZpZWxkXSl7XHJcblx0XHRcdFx0XHRcdChvcHQgPSBvcHQgfHwge30pLnBhdGggPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZ3VuLmdldCh0bXAsIGNiLCBvcHQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0bXAgPSBjYXQuc3R1bil7XHJcblx0XHRcdFx0XHRndW4uXy5zdHVuID0gZ3VuLl8uc3R1biB8fCB0bXA7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGNiICYmIGNiIGluc3RhbmNlb2YgRnVuY3Rpb24pe1xyXG5cdFx0XHRcdFx0KChvcHQgPSBvcHQgfHwge30pLmd1biA9IG9wdC5ndW4gfHwgZ3VuKS5hbnkoY2IsIG9wdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gY2FjaGUoa2V5LCBiYWNrKXtcclxuXHRcdFx0XHR2YXIgY2F0ID0gYmFjay5fLCBwYXRoID0gY2F0LnBhdGgsIGd1biA9IGJhY2suY2hhaW4oKSwgYXQgPSBndW4uXztcclxuXHRcdFx0XHRpZighcGF0aCl7IHBhdGggPSBjYXQucGF0aCA9IHt9IH1cclxuXHRcdFx0XHRwYXRoW2F0LmdldCA9IGtleV0gPSBndW47XHJcblx0XHRcdFx0YXQuc3R1biA9IGF0LnN0dW4gfHwgY2F0LnN0dW47IC8vIFRPRE86IEJVRyEgQ2xlYW4gdXAhIFRoaXMgaXMga2luZGEgdWdseS4gVGhlc2UgbmVlZCB0byBiZSBhdHRhY2hlZCBhbGwgdGhlIHdheSBkb3duIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciBhIGd1biBjaGFpbiBoYXMgYmVlbiBjYWNoZWQgb3Igbm90IGZvciB0aGUgZmlyc3QgdGltZS4gXHJcblx0XHRcdFx0R3VuLm9uKCdwYXRoJywgYXQpO1xyXG5cdFx0XHRcdC8vZ3VuLm9uKCdpbicsIGlucHV0LCBhdCk7IC8vIEZvciAnaW4nIGlmIEkgYWRkIG15IG93biBsaXN0ZW5lcnMgdG8gZWFjaCB0aGVuIEkgTVVTVCBkbyBpdCBiZWZvcmUgaW4gZ2V0cyBjYWxsZWQuIElmIEkgbGlzdGVuIGdsb2JhbGx5IGZvciBhbGwgaW5jb21pbmcgZGF0YSBpbnN0ZWFkIHRob3VnaCwgcmVnYXJkbGVzcyBvZiBpbmRpdmlkdWFsIGxpc3RlbmVycywgSSBjYW4gdHJhbnNmb3JtIHRoZSBkYXRhIHRoZXJlIGFuZCB0aGVuIGFzIHdlbGwuXHJcblx0XHRcdFx0Z3VuLm9uKCdvdXQnLCBvdXRwdXQsIGF0KTsgLy8gSG93ZXZlciBmb3Igb3V0cHV0LCB0aGVyZSBpc24ndCByZWFsbHkgdGhlIGdsb2JhbCBvcHRpb24uIEkgbXVzdCBsaXN0ZW4gYnkgYWRkaW5nIG15IG93biBsaXN0ZW5lciBpbmRpdmlkdWFsbHkgQkVGT1JFIHRoaXMgb25lIGlzIGV2ZXIgY2FsbGVkLlxyXG5cdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gb3V0cHV0KGF0KXtcclxuXHRcdFx0XHR2YXIgY2F0ID0gdGhpcywgZ3VuID0gY2F0Lmd1biwgcm9vdCA9IGd1bi5CYWNrKC0xKSwgcHV0LCBnZXQsIHRtcDtcclxuXHRcdFx0XHRpZighYXQuZ3VuKXtcclxuXHRcdFx0XHRcdGF0Lmd1biA9IGd1bjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y29uc29sZS5kZWJ1ZygxMCwgJ291dCcsIGNhdC5nZXQsIGF0LmdldCk7XHJcblx0XHRcdFx0aWYoYXQuZ2V0ICYmICFhdC5nZXRbX3NvdWxdKXtcclxuXHRcdFx0XHRcdGlmKHR5cGVvZiBhdC5nZXQgPT09ICdzdHJpbmcnKXsgLy8gcmVxdWVzdCBmb3Igc291bCFcclxuXHRcdFx0XHRcdFx0aWYoY2F0LmFzayl7XHJcblx0XHRcdFx0XHRcdFx0aWYoY2F0LmFza1thdC5nZXRdKXtcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0Y2F0LmFza1thdC5nZXRdID0gYXRbJyMnXSB8fCAxO1xyXG5cdFx0XHRcdFx0XHRcdGNhdC5vbignaW4nLCBmdW5jdGlvbih0YWMsIGV2KXsgZXYub2ZmKCk7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgdG1wID0gdGFjLnB1dDtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKHRtcCAmJiB1ICE9PSB0bXBbYXQuZ2V0XSAmJiAodG1wID0gKGNhdC5wYXRofHxlbXB0eSlbYXQuZ2V0XSkpe1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXAgPSB0bXAuXztcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1wLmNoYW5nZSA9IHRhYy5wdXRbYXQuZ2V0XTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1wLnB1dCA9IHRhYy5wdXRbYXQuZ2V0XTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gVE9ETzogQ291bGQgd2UgcGFzcyBpdCB0byBpbnB1dC9tYXAgZnVuY3Rpb24gc2luY2UgdGhleSBhbHJlYWR5IGRvIHRoaXM/XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcC5vbignaW4nLCB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Z2V0OiBhdC5nZXQsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cHV0OiB0YWMucHV0W2F0LmdldF0sXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Z3VuOiB0bXAuZ3VuLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZpYTogdGFjXHJcblx0XHRcdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGlmKCEodG1wID0gR3VuLm5vZGUuc291bCh0bXAgPSB0YWMucHV0KSB8fCBHdW4udmFsLnJlbC5pcyh0bXApKSl7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcCA9IChjYXQucGF0aHx8ZW1wdHkpW2F0LmdldF07XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCF0bXApeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXAub24oJ2luJywge2dldDogYXQuZ2V0LCBndW46dG1wLCB2aWE6IHRhY30pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRjYXQuYXNrW2F0LmdldF0gPSAwO1xyXG5cdFx0XHRcdFx0XHRcdFx0dG1wID0geycjJzogdG1wLCAnLic6IGF0LmdldH07XHJcblx0XHRcdFx0XHRcdFx0XHR0bXAgPSB7Z3VuOiBhdC5ndW4sIGdldDogdG1wfTtcclxuXHRcdFx0XHRcdFx0XHRcdHRtcFsnIyddID0gR3VuLm9uLmFzayhhY2ssIHRtcCk7XHJcblx0XHRcdFx0XHRcdFx0XHRhdC5ndW4ub24oJ291dCcsIHRtcCk7XHJcblx0XHRcdFx0XHRcdFx0fSkub2ZmKCk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGNhdC5hc2sgPSBvYmpfcHV0KHt9LCBhdC5nZXQsIGF0WycjJ10gfHwgMSk7XHJcblx0XHRcdFx0XHRcdGd1bi5vbignaW4nLCBpbnB1dCwgY2F0KTtcclxuXHRcdFx0XHRcdFx0aWYocm9vdCA9PT0gY2F0LmJhY2spe1xyXG5cdFx0XHRcdFx0XHRcdGNhdC5hc2tbYXQuZ2V0XSA9IDA7XHJcblx0XHRcdFx0XHRcdFx0dG1wID0geycjJzogY2F0LmdldCwgJy4nOiBhdC5nZXR9O1xyXG5cdFx0XHRcdFx0XHRcdHRtcCA9IHtndW46IGF0Lmd1biwgZ2V0OiB0bXB9O1xyXG5cdFx0XHRcdFx0XHRcdHRtcFsnIyddID0gR3VuLm9uLmFzayhhY2ssIHRtcCk7XHJcblx0XHRcdFx0XHRcdFx0YXQuZ3VuLm9uKCdvdXQnLCB0bXApO1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmRlYnVnKDcsICdvdXQnLCBjYXQuZ2V0LCBhdC5nZXQsIGNhdC5hc2spO1xyXG5cdFx0XHRcdFx0XHRjYXQuYmFjay5vbignb3V0Jywge1xyXG5cdFx0XHRcdFx0XHRcdGd1bjogY2F0Lmd1bixcclxuXHRcdFx0XHRcdFx0XHRnZXQ6IGNhdC5nZXRcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH0gZWxzZVxyXG5cdFx0XHRcdFx0aWYoYXQuZ2V0IGluc3RhbmNlb2YgRnVuY3Rpb24pe1xyXG5cdFx0XHRcdFx0XHRpZighY2F0LmFzayl7XHJcblx0XHRcdFx0XHRcdFx0dmFyIG9wdCA9IGF0Lm9wdCB8fCB7fTtcclxuXHRcdFx0XHRcdFx0XHR0bXAgPSBvYmpfaGFzKG9wdCwgJy4nKTsgLy8gVE9ETzogQ0xFQU4gVVAhXHJcblx0XHRcdFx0XHRcdFx0Y2F0LmFzayA9IHRtcD8ge30gOiB7XzoxfTsgLy8gVE9ETzogQ0xFQU4gVVAhXHJcblx0XHRcdFx0XHRcdFx0Z3VuLm9uKCdpbicsIGlucHV0LCBjYXQpO1xyXG5cdFx0XHRcdFx0XHRcdGlmKHJvb3QgPT09IGNhdC5iYWNrKXtcclxuXHRcdFx0XHRcdFx0XHRcdGlmKGNhdC5hc2sgJiYgY2F0LmFzay5fKXsgY2F0LmFzay5fID0gMCB9IC8vIFRPRE86IENMRUFOIFVQIVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYodG1wICYmIG9wdFsnLiddKXsgY2F0LmFza1tvcHRbJy4nXV0gPSAwIH0gLy8gVE9ETzogQ0xFQU4gVVAhXHJcblx0XHRcdFx0XHRcdFx0XHR0bXAgPSB0bXA/IHsnIyc6IGNhdC5nZXQsICcuJzogb3B0WycuJ119IDogeycjJzogY2F0LmdldH07IC8vIFRPRE86IENMRUFOIFVQIVxyXG5cdFx0XHRcdFx0XHRcdFx0dG1wID0ge2d1bjogYXQuZ3VuLCBnZXQ6IHRtcH07XHJcblx0XHRcdFx0XHRcdFx0XHR0bXBbJyMnXSA9IEd1bi5vbi5hc2soYWNrLCB0bXApO1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2F0LmJhY2sub24oJ291dCcsIHRtcCk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnNvbGUuZGVidWcoNiwgJ291dCcsIGNhdC5nZXQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2F0LmJhY2sub24oJ291dCcsIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Z3VuOiBjYXQuZ3VuLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRnZXQ6IGNhdC5nZXRcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmRlYnVnKDksICdvdXQnLCBjYXQuZ2V0KTtcclxuXHRcdFx0XHRcdFx0aWYoY2F0LnN0dW4gJiYgY2F0LnN0dW4oYXQpKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdFx0Z3VuLm9uKCdpbicsIGF0LmdldCwgYXQpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGNhdC5iYWNrLm9uKCdvdXQnLCBhdCk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gaW5wdXQoYXQsIGV2KXsgdmFyIGNhdCA9IHRoaXMsIHRtcDtcclxuXHRcdFx0XHRjYXQuaWQgPSBjYXQuaWQgfHwgR3VuLnRleHQucmFuZG9tKDUpOyAvLyBUT0Q6IEJVRyEgVGhpcyBhbGxvd3MgZm9yIDFCIGl0ZW0gZW50cm9weSBpbiBtZW1vcnkuIEluIHRoZSBmdXR1cmUsIHBlb3BsZSBtaWdodCB3YW50IHRvIGV4cGFuZCB0aGlzIHRvIGJlIGxhcmdlci5cclxuXHRcdFx0XHRpZihhdC5lcnIpe1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCJQbGVhc2UgcmVwb3J0IHRoaXMgYXMgYW4gaXNzdWUhIEluLmVyclwiKTsgLy8gVE9ETzogQlVHIVxyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjb25zb2xlLmRlYnVnKDEwLCAnaW5wdXQnLCBhdCwgY2F0LmdldCk7XHJcblx0XHRcdFx0aWYodmFsdWUuY2FsbChjYXQsIGF0LCBldikpe1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0bXAgPSBjYXQubGluayl7XHJcblx0XHRcdFx0XHRpZih0bXAgPSB0bXAucmVzKXtcclxuXHRcdFx0XHRcdFx0Ly8gVE9ETzogQlVHISBPcmRlcmluZyBvZiB0aGUgY2hhbmdlIHNldD8gV2hhdCBpZiB0aGUgcHJveGllZCBvYmplY3QgaGFzIGEgY2hhbmdlIGJ1dCB0aGUgcGFyZW50IGhhcyBhIGhhcHBlbmVkIHRvby4gUHJldGVuZCB0aGF0IHRoZSBwYXJlbnQgY2hhbmdlZCB0aGUgZmllbGQgc3VjaCB0aGF0IGl0IG5vIGxvbmdlciBwb2ludCB0byB0aGUgcHJveHkuIEJ1dCBpbiB0aGUgY2hhbmdlc2V0IGl0IG1pZ2h0IGdldCBpdGVyYXRlZCBvdmVyIGxhc3QsIHRodXMgaXQgdGhlIHVwZGF0ZSB3aWxsIGdldCB0cmlnZ2VyZWQgaGVyZSBub3cgZm9yIHRoZSBwcm94eSwgZXZlbiB0aG91Z2ggdGhpcyB1cGRhdGUgaXMgc3VwcG9zZSB0byB1bnN1YnNjcmliZSBpdHNlbGYuIE9yIHdoYXQgaWYgdGhpcyBvcmRlcmluZyBpcyBpbmNvbnNpc3RlbnQ/IE9yIGlzIHRoaXMganVzdCBiYXNpY2FsbHkgaW1wb3NzaWJsZSBmcm9tIHRoZSBBUEkncyBwdXQgcGVyc3BlY3RpdmU/XHJcblx0XHRcdFx0XHRcdHRtcChjYXQpOyAvLyBUT0RPOiBCVUchIFdoYXQgYWJvdXQgdmlhPyBEbyB3ZSBuZWVkIHRvIGNsb25lIHRoaXM/XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdG9ial9tYXAoY2F0LmNoYW5nZSwgbWFwLCB7YXQ6IGF0LCBjYXQ6IGNhdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdEd1bi5jaGFpbi5nZXQuaW5wdXQgPSBpbnB1dDtcclxuXHRcdFx0ZnVuY3Rpb24gdmFsdWUoYXQsIGV2KXtcclxuXHRcdFx0XHQvL3ZhciBjYXQgPSB0aGlzLCBpcyA9ICh1ID09PSBhdC5wdXQpIHx8IEd1bi52YWwuaXMoYXQucHV0KSwgcmVsID0gR3VuLnZhbC5yZWwuaXMoYXQucHV0KSwgdG1wLCB1O1xyXG5cdFx0XHRcdHZhciBjYXQgPSB0aGlzLCBwdXQgPSBjYXQuY2hhbmdlLCByZWwsIHRtcCwgdTtcclxuXHRcdFx0XHRpZih1ID09PSBwdXQpe1xyXG5cdFx0XHRcdFx0bm90KGNhdCwgYXQpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCFjYXQubGluayAmJiBHdW4ubm9kZS5zb3VsKHB1dCkgJiYgKHJlbCA9IEd1bi5ub2RlLnNvdWwoYXQucHV0KSkpe1xyXG5cdFx0XHRcdGNvbnNvbGUuZGVidWcoMTEsICd2YWx1ZScsIHB1dCk7XHJcblx0XHRcdFx0XHRhc2soY2F0LCByZWwpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZighKHJlbCA9IEd1bi52YWwucmVsLmlzKHB1dCkpKXtcclxuXHRcdFx0XHRcdGlmKCFHdW4udmFsLmlzKHB1dCkpe1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRub3QoY2F0LCBhdCk7XHJcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly9jYXQuY2hhbmdlID0gYXQucHV0O1xyXG5cdFx0XHRcdGlmKGNhdC5saW5rKXtcclxuXHRcdFx0XHRcdGlmKHJlbCA9PT0gY2F0LmxpbmsucmVsKXtcclxuXHRcdFx0XHRcdFx0ZXYuc3R1bigpO1xyXG5cdFx0XHRcdFx0XHR0bXAgPSBjYXQubGluay5yZWYuXztcclxuXHRcdFx0XHRcdFx0Y2F0LmNoYW5nZSA9IHRtcC5jaGFuZ2U7XHJcblx0XHRcdFx0XHRcdGNhdC5wdXQgPSBhdC5wdXQgPSB0bXAucHV0OyAvLyBUT0RPOiBCVUchIE11dGF0aW5nIGF0IGV2ZW50PyBOZWVkZWQgZm9yIGNlcnRhaW4gdGVzdHMsIGJ1dCBpcyB0aGlzIGJhZD9cclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0bm90KGNhdCwgYXQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0bXAgPSBldi5zdHVuKHRtcCk7XHJcblx0XHRcdFx0Ly9jYXQucHV0ID0gdTsgLy8gRm9yIHBlcmZvcm1hbmNlIHNha2UsIGRvIHRoaXMgbm93IHRvIHByZXZlbnQgYC52YWxgIGZyb20gZmlyaW5nLlxyXG5cdFx0XHRcdHRtcCA9IGNhdC5saW5rID0ge3JlbDogcmVsLCByZWY6IGNhdC5ndW4uQmFjaygtMSkuZ2V0KHJlbCksIHJlczogdG1wLCBhczogY2F0fTtcclxuXHRcdFx0XHQvLyBUT0RPOiBCVUc/Pz8/IEJlbG93IGFsbG93cyBzdWJzY3JpcHRpb25zIHRvIGhhcHBlbiB3aXRob3V0IHRoZSBzb3VsIGl0c2VsZiBiZWluZyBzdWJzY3JpYmVkLiBXaWxsIHRoaXMgY2F1c2UgcHJvYmxlbXM/IEkgdGhpbmsgaXQgc2hvdWxkIGJlIG9rYXkuIE5vdCBzdXJlIHdoYXQgdGVzdCBpcyBuZWNlc3NhcnkuXHJcblx0XHRcdFx0dG1wLnN1YiA9IHRtcC5yZWYuXy5vbignaW4nLCBwcm94eSwgdG1wKTsgLy8gVE9ETzogQlVHISBJZiBzb21lYm9keSBkb2VzIGAub2ZmYCBob3cgZG8gd2UgY2xlYW4gdXAgdGhlc2UgdGhpbmdzIGZyb20gbWVtb3J5P1xyXG5cdFx0XHRcdGlmKHRtcC5yYW4peyByZXR1cm4gfVxyXG5cdFx0XHRcdGFzayhjYXQsIHJlbCk7XHJcblx0XHRcdFx0aWYoIXRtcC5yYW4pe1xyXG5cdFx0XHRcdFx0dG1wLnJlcygpOyAvLyBUaGlzIGlzIG5lY2Vzc2FyeSBmb3IgdGhpbmdzIHRoYXQgbGlzdGVuIGZvciBhIHNvdWwgb3IgcmVsYXRpb24gb25seS5cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gbWFwKGRhdGEsIGtleSl7IC8vIE1hcCBvdmVyIG9ubHkgdGhlIGNoYW5nZXMgb24gZXZlcnkgdXBkYXRlLlxyXG5cdFx0XHRcdGlmKEd1bi5fLm1ldGEgPT09IGtleSl7IHJldHVybiB9XHJcblx0XHRcdFx0dmFyIGNhdCA9IHRoaXMuY2F0LCBwYXRoID0gY2F0LnBhdGggfHwge30sIGd1biwgYXQsIHRtcDtcclxuXHRcdFx0XHRpZighKGd1biA9IHBhdGhba2V5XSkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdGlmKGNhdC5wdXQgJiYgb2JqX2hhcyhjYXQucHV0LCBrZXkpKXsgZGF0YSA9IGNhdC5wdXRba2V5XSB9IC8vIEJ1dCB1c2UgdGhlIGFjdHVhbCBkYXRhLlxyXG5cdFx0XHRcdChhdCA9IGd1bi5fKS5jaGFuZ2UgPSBjYXQuY2hhbmdlW2tleV07XHJcblx0XHRcdFx0YXQucHV0ID0gZGF0YTtcclxuXHRcdFx0XHRpZih0bXAgPSBHdW4udmFsLnJlbC5pcyhhdC5wdXQpKXsgLy8gUEVSRk9STUFOQ0UgSEFDSyFcclxuXHRcdFx0XHRcdGlmKHRtcCA9IGd1bi5CYWNrKC0xKS5nZXQodG1wKS5fLnB1dCl7IC8vIFBFUkZPUk1BTkNFIEhBQ0shXHJcblx0XHRcdFx0XHRcdGF0LnB1dCA9IGRhdGEgPSB0bXA7IC8vIFBFUkZPUk1BTkNFIEhBQ0shXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGd1bi5vbignaW4nLCB7XHJcblx0XHRcdFx0XHRwdXQ6IGRhdGEsXHJcblx0XHRcdFx0XHRnZXQ6IGtleSxcclxuXHRcdFx0XHRcdGd1bjogZ3VuLFxyXG5cdFx0XHRcdFx0dmlhOiB0aGlzLmF0XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gbm90KGNhdCwgYXQpe1xyXG5cdFx0XHRcdHZhciB0bXAsIHU7XHJcblx0XHRcdFx0dG1wID0gY2F0Lmxpbms7XHJcblx0XHRcdFx0aWYodSAhPT0gY2F0LnB1dCl7IGNhdC5saW5rID0gbnVsbDsgfSAvLyBUT0RPOiBCVUchIFRoaXMgbWF5IG1lYW4gYG5vdGAgd2lsbCBiZSBmaXJlZCBtdWx0aXBsZSB0aW1lcyB1bnRpbCBkYXRhIGlzIGZvdW5kLiBJcyB0aGlzIG9rYXk/XHJcblx0XHRcdFx0aWYobnVsbCA9PT0gdG1wKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRpZih0bXApe1xyXG5cdFx0XHRcdFx0aWYodG1wLnN1Yil7XHJcblx0XHRcdFx0XHRcdHRtcC5zdWIub2ZmKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0bXAuc3ViID0gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdG9ial9tYXAoY2F0LmFzaywgZnVuY3Rpb24odixrZXkpe1xyXG5cdFx0XHRcdFx0Y2F0LmFza1trZXldID0gMTtcclxuXHRcdFx0XHRcdGlmKCEodiA9IChjYXQucGF0aHx8ZW1wdHkpW2tleV0pKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdCh0bXAgPSB2Ll8pLnB1dCA9IHRtcC5jaGFuZ2UgPSB1O1xyXG5cdFx0XHRcdFx0di5vbignaW4nLCB7Z2V0OiBrZXksIHB1dDogdSwgZ3VuOiB2LCB2aWE6IGF0fSk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gYXNrKGNhdCwgc291bCl7XHJcblx0XHRcdFx0aWYoIWNhdC5hc2speyByZXR1cm4gfVxyXG5cdFx0XHRcdHZhciB0bXAgPSBjYXQuYXNrLCBsZXg7XHJcblx0XHRcdFx0aWYob2JqX2hhcyh0bXAsICdfJykpe1xyXG5cdFx0XHRcdFx0aWYoIXRtcC5fKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdHRtcC5fID0gMDtcclxuXHRcdFx0XHRcdGxleCA9IHtndW46IGNhdC5ndW4sIGdldDogeycjJzogc291bH19O1xyXG5cdFx0XHRcdFx0bGV4WycjJ10gPSBHdW4ub24uYXNrKGFjaywgbGV4KTtcclxuXHRcdFx0XHRcdGNhdC5ndW4ub24oJ291dCcsIGxleCk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIFRPRE86IFBFUkYhIE1ha2UgaXQgc28gd2UgZG8gbm90IGhhdmUgdG8gaXRlcmF0ZSB0aHJvdWdoIHRoaXMgZXZlcnkgdGltZT9cclxuXHRcdFx0XHRvYmpfbWFwKHRtcCwgZnVuY3Rpb24odixrZXkpe1xyXG5cdFx0XHRcdFx0aWYoIXYgfHwgKGNhdC5wdXQgJiYgY2F0LnB1dFtrZXldKSl7IHJldHVybiB9IC8vIFRPRE86IFRoaXMgc2VlbXMgbGlrZSBhbiBvcHRpbWl6YXRpb24/IEJ1dCBkb2VzIGl0IGhhdmUgc2lkZSBlZmZlY3RzPyBQcm9iYWJseSBub3Qgd2l0aG91dCB0aGUgdG1wW2tleV0gPSAwO1xyXG5cdFx0XHRcdFx0aWYoISh2ID0gKGNhdC5wYXRofHxlbXB0eSlba2V5XSkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0dG1wW2tleV0gPSAwO1xyXG5cdFx0XHRcdFx0bGV4ID0ge2d1bjogdiwgZ2V0OiB7JyMnOiBzb3VsLCAnLic6IGtleX19O1xyXG5cdFx0XHRcdFx0bGV4WycjJ10gPSBHdW4ub24uYXNrKGFjaywgbGV4KTtcclxuXHRcdFx0XHRcdHYub24oJ291dCcsIGxleCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gcHJveHkoYXQsIGV2KXsgdmFyIGxpbmsgPSB0aGlzO1xyXG5cdFx0XHRcdGxpbmsucmFuID0gdHJ1ZTtcclxuXHRcdFx0XHRpZihmYWxzZSA9PT0gbGluay5zdWIpeyByZXR1cm4gZXYub2ZmKCkgfSAvLyB3aWxsIHRoaXMgYXV0byBjbGVhbiBpdHNlbGYgdXA/XHJcblx0XHRcdFx0bGluay5hcy5jaGFuZ2UgPSBsaW5rLnJlZi5fLmNoYW5nZTtcclxuXHRcdFx0XHRsaW5rLmFzLnB1dCA9IGF0LnB1dDtcclxuXHRcdFx0XHRpbnB1dC5jYWxsKGxpbmsuYXMsIGF0LCBldik7IC8vIFRPRE86IEJVRyEgV2hhdCBhYm91dCB2aWE/IERvIHdlIG5lZWQgdG8gY2xvbmUgdGhpcz9cclxuXHRcdFx0fVxyXG5cdFx0XHRHdW4uY2hhaW4uYW55ID0gZnVuY3Rpb24oYW55LCBvcHQpe1xyXG5cdFx0XHRcdGlmKCFhbnkpeyByZXR1cm4gdGhpcyB9XHJcblx0XHRcdFx0dmFyIGNoYWluID0gdGhpcywgY2F0ID0gY2hhaW4uXywgb3B0ID0gb3B0IHx8IHt9LCBsYXN0ID0ge307Ly9mdW5jdGlvbigpe307XHJcblx0XHRcdFx0aWYob3B0LmNoYW5nZSl7IG9wdC5jaGFuZ2UgPSAxIH1cclxuXHRcdFx0XHRjb25zb2xlLmRlYnVnKDUsICdhbnknKTtcclxuXHRcdFx0XHRjaGFpbi5vbignb3V0Jywge2dldDogZnVuY3Rpb24oYXQsIGV2KXtcclxuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImFueSFcIiwgYXQpO1xyXG5cdFx0XHRcdFx0XHRpZighYXQuZ3VuKXsgY29uc29sZS5sb2coJyUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlRVhQTE9ERSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJywgYXQpIH1cclxuXHRcdFx0XHRcdFx0dmFyIGd1biA9IGF0Lmd1biB8fCBjaGFpbiwgY2F0ID0gZ3VuLl87XHJcblx0XHRcdFx0XHRcdHZhciBkYXRhID0gY2F0LnB1dCB8fCBhdC5wdXQsIHRtcDtcclxuXHRcdFx0XHRcdFx0aWYoKHRtcCA9IGF0LnB1dCkgJiYgdG1wW0d1bi52YWwucmVsLl9dICYmICh0bXAgPSBHdW4udmFsLnJlbC5pcyh0bXApKSl7XHJcblx0XHRcdFx0XHRcdFx0aWYobnVsbCAhPT0gb3B0WycuJ10pe1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRhdCA9IG9ial90byhhdCwge3B1dDogZGF0YSA9IGNhdC5jaGFuZ2UgPSBjYXQucHV0ID0gR3VuLnN0YXRlLmlmeShHdW4ubm9kZS5pZnkoe30sIHRtcCkpfSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0Ly8gVE9ETzogQlVHISBOZWVkIHRvIHVzZSBhdC5wdXQgPiBjYXQucHV0IGZvciBtZXJnZWQgY2FjaGU/XHJcblx0XHRcdFx0XHRcdGlmKHRtcCA9IG9wdC5jaGFuZ2UpeyAvLyBUT0RPOiBCVUchIE9wdCBpcyBvdXRlciBzY29wZSwgZ3VuL2NhdC9kYXRhIG1pZ2h0IGJlIGl0ZXJhdGl2ZSBhbmQgdGh1cyBvbmx5IGlubmVyIHNjb3BlPyBBa2EsIHdlIGNhbid0IHVzZSBpdCBmb3IgYWxsIG9mIHRoZW0uIFxyXG5cdFx0XHRcdFx0XHRcdGlmKDEgPT09IHRtcCl7XHJcblx0XHRcdFx0XHRcdFx0XHRvcHQuY2hhbmdlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0ZGF0YSA9IGNhdC5jaGFuZ2U7XHJcblx0XHRcdFx0XHRcdFx0XHRhdCA9IG9ial90byhhdCwge3B1dDogZGF0YX0pO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR2YXIgaWQgPSBjYXQuaWQrYXQuZ2V0O1xyXG5cdFx0XHRcdFx0XHQvKlxyXG5cdFx0XHRcdFx0XHRpZihsYXN0W2lkXSA9PSBkYXRhICYmIG9ial9oYXMobGFzdCwgaWQpKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdFx0bGFzdFtpZF0gPSBkYXRhOyAvLyBUT0RPOiBQRVJGISBNZW1vcnkgb3B0aW1pemFpdG9uPyBDYW4gd2UgYXZvaWQgdGhpcy5cclxuXHRcdFx0XHRcdFx0Ki9cclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRpZihsYXN0LnB1dCA9PT0gZGF0YSAmJiBsYXN0LmdldCA9PT0gaWQpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0XHRsYXN0LmdldCA9IGlkO1xyXG5cdFx0XHRcdFx0XHRsYXN0LnB1dCA9IGRhdGE7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRjYXQubGFzdCA9IGRhdGE7XHJcblx0XHRcdFx0XHRcdGlmKG9wdC5hcyl7XHJcblx0XHRcdFx0XHRcdFx0YW55LmNhbGwob3B0LmFzLCBhdCwgZXYpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGFueS5jYWxsKGd1biwgYXQuZXJyLCBkYXRhLCBhdC5nZXQsIGNhdCwgZXYpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9LCBvcHQ6IG9wdFxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHJldHVybiBjaGFpbjtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBhY2soYXQsIGV2KXsgdmFyIGxleCA9IHRoaXMuZ2V0LCBjaGFpbiA9IHRoaXMuZ3VuO1xyXG5cdFx0XHRcdHZhciBzID0gbGV4WycjJ10sIGYgPSBsZXhbJy4nXSwgcm9vdCA9IGF0Lmd1bi5CYWNrKC0xKSwgZ3VuID0gcm9vdC5nZXQocyksIHRtcDtcclxuXHRcdFx0XHRpZih0bXAgPSBhdC5wdXQpe1xyXG5cdFx0XHRcdFx0aWYoIWYgfHwgb2JqX2hhcyh0bXBbc10sIGYpKXtcclxuXHRcdFx0XHRcdFx0ZXYub2ZmKCk7XHJcblx0XHRcdFx0XHRcdGF0WydAJ10gPSAwO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gcm9vdC5vbignaW4nLCBhdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvKlxyXG5cdFx0XHRcdFx0aWYoIXRtcFtzXSAmJiAhb2JqX2VtcHR5KHRtcCkpeyAvLyBUT0RPOiBCVUchIFNlZW1zIGxpa2UgaXQganVzdCBjYXVzZXMgdW5uZWNlc3NhcnkgZGF0YS9ldmVudCB0byBiZSB0cmlnZ2VyZWQuIE5vdGhpbmcgZ2VudWluZWx5IHVzZWZ1bC5cclxuXHRcdFx0XHRcdFx0ZXYub2ZmKCk7IC8vIFRPRE86IEJVRyE/IEl0IGlzbid0IG1hdGNoaW5nIGRhdGEgYnkgbGV4IG1lYW5zLCBidXQgaXQgSVMgYSByZXBseT9cclxuXHRcdFx0XHRcdFx0YXRbJ0AnXSA9IDA7XHJcblx0XHRcdFx0XHRcdHJldHVybiByb290Lm9uKCdpbicsIGF0KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdCovXHJcblx0XHRcdFx0XHRpZihmICYmIGd1bi5fLnB1dCl7XHJcblx0XHRcdFx0XHRcdGd1biA9IGd1bi5nZXQoZiwgbnVsbCwge3BhdGg6dHJ1ZX0pO1xyXG5cdFx0XHRcdFx0XHRpZighY2hhaW4pe1xyXG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiUGxlYXNlIHJlcG9ydCB0aGlzIGFzIGFuIGlzc3VlISBhY2suY2hhaW5cIik7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGNoYWluLm9uKCdpbicsIHtcclxuXHRcdFx0XHRcdFx0XHRlcnI6IGF0LmVycixcclxuXHRcdFx0XHRcdFx0XHRnZXQ6IGYsXHJcblx0XHRcdFx0XHRcdFx0Z3VuOiBjaGFpbixcclxuXHRcdFx0XHRcdFx0XHR2aWE6IHtnZXQ6cyx2aWE6YXR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGd1bi5fLnB1dCl7XHJcblx0XHRcdFx0XHRndW4gPSBndW4uZ2V0KGYsIG51bGwsIHtwYXRoOnRydWV9KTtcclxuXHRcdFx0XHRcdGd1bi5vbignaW4nLCB7XHJcblx0XHRcdFx0XHRcdGVycjogYXQuZXJyLFxyXG5cdFx0XHRcdFx0XHRnZXQ6IGYsXHJcblx0XHRcdFx0XHRcdGd1bjogZ3VuLFxyXG5cdFx0XHRcdFx0XHR2aWE6IHtnZXQ6cyx2aWE6YXR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Z3VuLm9uKCdpbicsIHtcclxuXHRcdFx0XHRcdGVycjogYXQuZXJyLFxyXG5cdFx0XHRcdFx0cHV0OiBhdC5wdXQ/IGF0LnB1dFtzXSB8fCBhdC5wdXQgOiBhdC5wdXQsXHJcblx0XHRcdFx0XHRnZXQ6IHMsXHJcblx0XHRcdFx0XHRndW46IGd1bixcclxuXHRcdFx0XHRcdHZpYTogYXRcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgb2JqID0gR3VuLm9iaiwgb2JqX2hhcyA9IG9iai5oYXMsIG9ial90byA9IG9iai50bztcclxuXHRcdFx0dmFyIGVtcHR5ID0ge30sIHU7XHJcblx0XHRcdHZhciBfc291bCA9IEd1bi5fLnNvdWwsIF9maWVsZCA9IEd1bi5fLmZpZWxkLCBfc2lkID0gR3VuLm9uLmFzay5fLCBfcmlkID0gR3VuLm9uLmFjay5fO1xyXG5cdFx0fSgpKTtcclxuXHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdEd1bi5jaGFpbi5rZXkgPSBmdW5jdGlvbihpbmRleCwgY2IsIG9wdCl7XHJcblx0XHRcdFx0aWYoIWluZGV4KXtcclxuXHRcdFx0XHRcdGlmKGNiKXtcclxuXHRcdFx0XHRcdFx0Y2IuY2FsbCh0aGlzLCB7ZXJyOiBHdW4ubG9nKCdObyBrZXkhJyl9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR2YXIgZ3VuID0gdGhpcztcclxuXHRcdFx0XHRpZih0eXBlb2Ygb3B0ID09PSAnc3RyaW5nJyl7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIlBsZWFzZSByZXBvcnQgdGhpcyBhcyBhbiBpc3N1ZSEga2V5Lm9wdC5zdHJpbmdcIik7XHJcblx0XHRcdFx0XHRyZXR1cm4gZ3VuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihndW4gPT09IGd1bi5fLnJvb3Qpe2lmKGNiKXtjYih7ZXJyOiBHdW4ubG9nKFwiQ2FuJ3QgZG8gdGhhdCBvbiByb290IGluc3RhbmNlLlwiKX0pfTtyZXR1cm4gZ3VufVxyXG5cdFx0XHRcdG9wdCA9IG9wdCB8fCB7fTtcclxuXHRcdFx0XHRvcHQua2V5ID0gaW5kZXg7XHJcblx0XHRcdFx0b3B0LmFueSA9IGNiIHx8IGZ1bmN0aW9uKCl7fTtcclxuXHRcdFx0XHRvcHQucmVmID0gZ3VuLkJhY2soLTEpLmdldChvcHQua2V5KTtcclxuXHRcdFx0XHRvcHQuZ3VuID0gb3B0Lmd1biB8fCBndW47XHJcblx0XHRcdFx0Z3VuLm9uKGtleSwge2FzOiBvcHR9KTtcclxuXHRcdFx0XHRpZighb3B0LmRhdGEpe1xyXG5cdFx0XHRcdFx0b3B0LnJlcyA9IEd1bi5vbi5zdHVuKG9wdC5yZWYpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gZ3VuO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZ1bmN0aW9uIGtleShhdCwgZXYpeyB2YXIgb3B0ID0gdGhpcztcclxuXHRcdFx0XHRldi5vZmYoKTtcclxuXHRcdFx0XHRvcHQuc291bCA9IEd1bi5ub2RlLnNvdWwoYXQucHV0KTtcclxuXHRcdFx0XHRpZighb3B0LnNvdWwgfHwgb3B0LmtleSA9PT0gb3B0LnNvdWwpeyByZXR1cm4gb3B0LmRhdGEgPSB7fSB9XHJcblx0XHRcdFx0b3B0LmRhdGEgPSBvYmpfcHV0KHt9LCBrZXllZC5fLCBHdW4ubm9kZS5pZnkob2JqX3B1dCh7fSwgb3B0LnNvdWwsIEd1bi52YWwucmVsLmlmeShvcHQuc291bCkpLCAnIycrb3B0LmtleSsnIycpKVxyXG5cdFx0XHRcdGlmKG9wdC5yZXMpe1xyXG5cdFx0XHRcdFx0b3B0LnJlcygxKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0b3B0LnJlZi5wdXQob3B0LmRhdGEsIG9wdC5hbnksIHtzb3VsOiBvcHQua2V5LCBrZXk6IG9wdC5rZXl9KTtcclxuXHRcdFx0XHRpZihvcHQucmVzKXtcclxuXHRcdFx0XHRcdG9wdC5yZXMoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24ga2V5ZWQoZil7XHJcblx0XHRcdFx0aWYoIWYgfHwgISgnIycgPT09IGZbMF0gJiYgJyMnID09PSBmW2YubGVuZ3RoLTFdKSl7IHJldHVybiB9XHJcblx0XHRcdFx0dmFyIHMgPSBmLnNsaWNlKDEsLTEpO1xyXG5cdFx0XHRcdGlmKCFzKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRyZXR1cm4gcztcclxuXHRcdFx0fVxyXG5cdFx0XHRrZXllZC5fID0gJyMjJztcclxuXHRcdFx0R3VuLm9uKCdwYXRoJywgZnVuY3Rpb24oYXQpe1xyXG5cdFx0XHRcdHZhciBndW4gPSBhdC5ndW47XHJcblx0XHRcdFx0aWYoZ3VuLkJhY2soLTEpICE9PSBhdC5iYWNrKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRndW4ub24oJ2luJywgcHNldWRvLCBndW4uXyk7XHJcblx0XHRcdFx0Z3VuLm9uKCdvdXQnLCBub3JtYWxpemUsIGd1bi5fKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGZ1bmN0aW9uIG5vcm1hbGl6ZShhdCl7IHZhciBjYXQgPSB0aGlzO1xyXG5cdFx0XHRcdGlmKCFhdC5wdXQpe1xyXG5cdFx0XHRcdFx0aWYoYXQuZ2V0KXtcclxuXHRcdFx0XHRcdFx0c2VhcmNoLmNhbGwoY2F0LCBhdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGF0Lm9wdCAmJiBhdC5vcHQua2V5KXsgcmV0dXJuIH1cclxuXHRcdFx0XHR2YXIgcHV0ID0gYXQucHV0LCBncmFwaCA9IGNhdC5ndW4uQmFjaygtMSkuXy5ncmFwaDtcclxuXHRcdFx0XHRHdW4uZ3JhcGguaXMocHV0LCBmdW5jdGlvbihub2RlLCBzb3VsKXtcclxuXHRcdFx0XHRcdGlmKCFHdW4ubm9kZS5pcyhncmFwaFsnIycrc291bCsnIyddLCBmdW5jdGlvbiBlYWNoKHJlbCxpZCl7XHJcblx0XHRcdFx0XHRcdGlmKGlkICE9PSBHdW4udmFsLnJlbC5pcyhyZWwpKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdFx0aWYocmVsID0gZ3JhcGhbJyMnK2lkKycjJ10pe1xyXG5cdFx0XHRcdFx0XHRcdEd1bi5ub2RlLmlzKHJlbCwgZWFjaCk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdEd1bi5ub2RlLnNvdWwuaWZ5KHJlbCA9IHB1dFtpZF0gPSBHdW4ub2JqLmNvcHkobm9kZSksIGlkKTtcclxuXHRcdFx0XHRcdH0pKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdEd1bi5vYmouZGVsKHB1dCwgc291bCk7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gc2VhcmNoKGF0KXsgdmFyIGNhdCA9IHRoaXM7XHJcblx0XHRcdFx0dmFyIHRtcDtcclxuXHRcdFx0XHRpZighR3VuLm9iai5pcyhhdC5nZXQpKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRpZihjYXQucHNldWRvKXtcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKCh0bXAgPSBhdC5vcHQpICYmIChudWxsID09PSB0bXBbJy4nXSkpe1xyXG5cdFx0XHRcdFx0dG1wWycuJ10gPSAnIyMnO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZigodG1wID0gYXQuZ2V0KSAmJiBHdW4ub2JqLmhhcyh0bXAsICcuJykpe1xyXG5cdFx0XHRcdFx0dG1wID0gYXRbJyMnXTtcclxuXHRcdFx0XHRcdGF0WycjJ10gPSBHdW4ub24uYXNrKHByb3h5KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIHRyaWVkID0ge307XHJcblx0XHRcdFx0ZnVuY3Rpb24gcHJveHkoYWNrLCBldil7XHJcblx0XHRcdFx0XHRldi5vZmYoKTtcclxuXHRcdFx0XHRcdHZhciBwdXQgPSBhY2sucHV0LCBsZXggPSBhdC5nZXQ7XHJcblx0XHRcdFx0XHRpZighY2F0LnBzZXVkbyl7IHJldHVybiBHdW4ub24uYWNrKHRtcCwgYWNrKSB9XHJcblx0XHRcdFx0XHRpZihhY2sucHV0KXtcclxuXHRcdFx0XHRcdFx0aWYoIWxleFsnLiddKXtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gR3VuLm9uLmFjayh0bXAsIGFjayk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYob2JqX2hhcyhhY2sucHV0W2xleFsnIyddXSwgbGV4WycuJ10pKXtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gR3VuLm9uLmFjayh0bXAsIGFjayk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdEd1bi5vYmoubWFwKGNhdC5zZWVuLCBmdW5jdGlvbihyZWYsaWQpeyAvLyBUT0RPOiBCVUchIEluLW1lbW9yeSB2ZXJzdXMgZnV0dXJlP1xyXG5cdFx0XHRcdFx0XHRpZih0cmllZFtpZF0pe1xyXG5cdFx0XHRcdFx0XHRcdHJldHVybiBHdW4ub24uYWNrKHRtcCwgYWNrKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR0cmllZFtpZF0gPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRyZWYub24oJ291dCcsIHtcclxuXHRcdFx0XHRcdFx0XHRndW46IHJlZixcclxuXHRcdFx0XHRcdFx0XHRnZXQ6IGlkID0geycjJzogaWQsICcuJzogYXQuZ2V0WycuJ119LFxyXG5cdFx0XHRcdFx0XHRcdCcjJzogR3VuLm9uLmFzayhwcm94eSlcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZnVuY3Rpb24gcHNldWRvKGF0LCBldil7IHZhciBjYXQgPSB0aGlzO1xyXG5cdFx0XHRcdGlmKGNhdC5wc2V1ZG8pe1xyXG5cdFx0XHRcdFx0ZXYuc3R1bigpO1xyXG5cdFx0XHRcdFx0aWYoY2F0LnBzZXVkbyA9PT0gYXQucHV0KXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdGNhdC5jaGFuZ2UgPSBjYXQuY2hhbmdlZCB8fCBjYXQucHNldWRvO1xyXG5cdFx0XHRcdFx0Y2F0Lm9uKCdpbicsIEd1bi5vYmoudG8oYXQsIHtwdXQ6IGNhdC5wdXQgPSBjYXQucHNldWRvfSkpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZighYXQucHV0KXsgcmV0dXJuIH1cclxuXHRcdFx0XHR2YXIgcmVsID0gR3VuLnZhbC5yZWwuaXMoYXQucHV0W2tleWVkLl9dKTtcclxuXHRcdFx0XHRpZighcmVsKXsgcmV0dXJuIH1cclxuXHRcdFx0XHR2YXIgc291bCA9IEd1bi5ub2RlLnNvdWwoYXQucHV0KSwgcmVzdW1lID0gZXYuc3R1bihyZXN1bWUpLCByb290ID0gY2F0Lmd1bi5CYWNrKC0xKSwgc2VlbiA9IGNhdC5zZWVuID0ge307XHJcblx0XHRcdFx0Y2F0LnBzZXVkbyA9IGNhdC5wdXQgPSBHdW4uc3RhdGUuaWZ5KEd1bi5ub2RlLmlmeSh7fSwgc291bCkpO1xyXG5cdFx0XHRcdHJvb3QuZ2V0KHJlbCkub24oZWFjaCwgdHJ1ZSk7XHJcblx0XHRcdFx0ZnVuY3Rpb24gZWFjaChjaGFuZ2Upe1xyXG5cdFx0XHRcdFx0R3VuLm5vZGUuaXMoY2hhbmdlLCBtYXApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmdW5jdGlvbiBtYXAocmVsLCBzb3VsKXtcclxuXHRcdFx0XHRcdGlmKHNvdWwgIT09IEd1bi52YWwucmVsLmlzKHJlbCkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0aWYoc2Vlbltzb3VsXSl7IHJldHVybiB9XHJcblx0XHRcdFx0XHRzZWVuW3NvdWxdID0gcm9vdC5nZXQoc291bCkub24ob24sIHRydWUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRmdW5jdGlvbiBvbihwdXQpe1xyXG5cdFx0XHRcdFx0Y2F0LnBzZXVkbyA9IEd1bi5IQU0udW5pb24oY2F0LnBzZXVkbywgcHV0KSB8fCBjYXQucHNldWRvO1xyXG5cdFx0XHRcdFx0Y2F0LmNoYW5nZSA9IGNhdC5jaGFuZ2VkID0gcHV0O1xyXG5cdFx0XHRcdFx0Y2F0LnB1dCA9IGNhdC5wc2V1ZG87XHJcblx0XHRcdFx0XHRyZXN1bWUoe1xyXG5cdFx0XHRcdFx0XHRndW46IGNhdC5ndW4sXHJcblx0XHRcdFx0XHRcdHB1dDogY2F0LnBzZXVkbyxcclxuXHRcdFx0XHRcdFx0Z2V0OiBzb3VsXHJcblx0XHRcdFx0XHRcdC8vdmlhOiB0aGlzLmF0XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIG9iaiA9IEd1bi5vYmosIG9ial9oYXMgPSBvYmouaGFzO1xyXG5cdFx0fSgpKTtcclxuXHJcblx0XHRHdW4uY2hhaW4ucGF0aCA9IGZ1bmN0aW9uKGZpZWxkLCBjYiwgb3B0KXtcclxuXHRcdFx0dmFyIGJhY2sgPSB0aGlzLCBndW4gPSBiYWNrLCB0bXA7XHJcblx0XHRcdG9wdCA9IG9wdCB8fCB7fTsgb3B0LnBhdGggPSB0cnVlO1xyXG5cdFx0XHRpZihndW4gPT09IGd1bi5fLnJvb3Qpe2lmKGNiKXtjYih7ZXJyOiBHdW4ubG9nKFwiQ2FuJ3QgZG8gdGhhdCBvbiByb290IGluc3RhbmNlLlwiKX0pfXJldHVybiBndW59XHJcblx0XHRcdGlmKHR5cGVvZiBmaWVsZCA9PT0gJ3N0cmluZycpe1xyXG5cdFx0XHRcdHRtcCA9IGZpZWxkLnNwbGl0KG9wdC5zcGxpdCB8fCAnLicpO1xyXG5cdFx0XHRcdGlmKDEgPT09IHRtcC5sZW5ndGgpe1xyXG5cdFx0XHRcdFx0cmV0dXJuIGJhY2suZ2V0KGZpZWxkLCBjYiwgb3B0KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZmllbGQgPSB0bXA7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoZmllbGQgaW5zdGFuY2VvZiBBcnJheSl7XHJcblx0XHRcdFx0aWYoZmllbGQubGVuZ3RoID4gMSl7XHJcblx0XHRcdFx0XHRndW4gPSBiYWNrO1xyXG5cdFx0XHRcdFx0dmFyIGkgPSAwLCBsID0gZmllbGQubGVuZ3RoO1xyXG5cdFx0XHRcdFx0Zm9yKGk7IGkgPCBsOyBpKyspe1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmRlYnVnKDMsICdwYXRoJywgZmllbGRbaV0pO1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmRlYnVnKDIsICdwYXRoJywgZmllbGRbaV0pO1xyXG5cdFx0XHRcdFx0XHRndW4gPSBndW4uZ2V0KGZpZWxkW2ldLCAoaSsxID09PSBsKT8gY2IgOiBudWxsLCBvcHQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Z3VuLmJhY2sgPSBiYWNrOyAvLyBUT0RPOiBBUEkgY2hhbmdlIVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRndW4gPSBiYWNrLmdldChmaWVsZFswXSwgY2IsIG9wdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoIWZpZWxkICYmIDAgIT0gZmllbGQpe1xyXG5cdFx0XHRcdHJldHVybiBiYWNrO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBiYWNrLmdldCgnJytmaWVsZCwgY2IsIG9wdCk7XHJcblx0XHR9XHJcblxyXG5cdFx0OyhmdW5jdGlvbigpe1xyXG5cdFx0XHRHdW4uY2hhaW4ub24gPSBmdW5jdGlvbih0YWcsIGFyZywgZWFzLCBhcyl7XHJcblx0XHRcdFx0dmFyIGd1biA9IHRoaXMsIGF0ID0gZ3VuLl8sIHRtcDtcclxuXHRcdFx0XHRpZighYXQub24peyBhdC5vbiA9IEd1bi5vbiB9XHJcblx0XHRcdFx0aWYodHlwZW9mIHRhZyA9PT0gJ3N0cmluZycpe1xyXG5cdFx0XHRcdFx0aWYoIWFyZyl7IHJldHVybiBhdC5vbih0YWcpIH1cclxuXHRcdFx0XHRcdGF0Lm9uKHRhZywgYXJnLCBlYXMgfHwgYXQsIGFzKTtcclxuXHRcdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHZhciBvcHQgPSBhcmc7XHJcblx0XHRcdFx0b3B0ID0gKHRydWUgPT09IG9wdCk/IHtjaGFuZ2U6IHRydWV9IDogb3B0IHx8IHt9OyBcclxuXHRcdFx0XHRvcHQub2sgPSB0YWc7XHJcblx0XHRcdFx0Z3VuLmFueShvaywge2FzOiBvcHQsIGNoYW5nZTogb3B0LmNoYW5nZX0pOyAvLyBUT0RPOiBQRVJGISBFdmVudCBsaXN0ZW5lciBsZWFrISEhPz8/P1xyXG5cdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGZ1bmN0aW9uIG9rKGNhdCwgZXYpeyB2YXIgb3B0ID0gdGhpcztcclxuXHRcdFx0XHR2YXIgZGF0YSA9IGNhdC5wdXQsIHRtcDsgXHJcblx0XHRcdFx0Ly8gVE9ETzogQlVHISBOZWVkIHRvIHVzZSBhdC5wdXQgPiBjYXQucHV0IGZvciBtZXJnZWQgY2FjaGU/XHJcblx0XHRcdFx0aWYodSA9PT0gZGF0YSl7IHJldHVybiB9XHJcblx0XHRcdFx0aWYob3B0LmFzKXtcclxuXHRcdFx0XHRcdC8vY29uc29sZS5sb2coXCJCQU5BTkEgQ1JFQU0gUElFXCIsIG9wdCk7XHJcblx0XHRcdFx0XHRvcHQub2suY2FsbChvcHQuYXMsIGNhdCwgZXYpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiSElDQURPTyBEQUFIXCIsIGNhdCwgb3B0KTtcclxuXHRcdFx0XHRcdG9wdC5vay5jYWxsKGNhdC5ndW4sIGRhdGEsIGNhdC5nZXQsIGNhdCwgZXYpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vaWYob2JqX2VtcHR5KHZhbHVlLCBHdW4uXy5tZXRhKSAmJiAhKG9wdCAmJiBvcHQuZW1wdHkpKXsgLy8gVE9ETzogUEVSRiEgRGVwcmVjYXRlIT8/P1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdC8vfSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcInZhbHVlXCIsIHZhbHVlKTtcclxuXHRcdFx0XHRcdFx0Ly9pZighKHZhbHVlfHxlbXB0eSlbJyMnXS8qIHx8ICF2YWxfcmVsX2lzKHZhbHVlKSovKXsgLy8gVE9ETzogUGVyZm9ybWFuY2UgaGl0IT8/Pz8gLy8gVE9ETzogQlVHISBXRSBzaG91bGQgYXZvaWQgdGhpcy4gU28gdGhhdCB3YXkgaXQgaXMgdXNhYmxlIHdpdGggZ3VuIHBsdWdpbiBjaGFpbnMuXHJcblx0XHRcdFx0XHRcdFx0Ly9jYi5jYWxsKGd1biwgdmFsdWUsIGF0LmdldCk7IC8vIFRPRE86IEJVRyEgV2hhdCBhYm91dCBzdHVuP1xyXG5cdFx0XHRcdFx0XHRcdC8vcmV0dXJuIGd1bjtcclxuXHRcdFx0XHRcdFx0Ly99XHJcblx0XHRcdFx0XHQvL31cclxuXHJcblx0XHRcdC8vIFRPRE86IEJVRyEgV2hhdCBhYm91dCBzdHVuP1xyXG5cdFx0XHRHdW4uY2hhaW4udmFsID0gZnVuY3Rpb24oY2IsIG9wdCl7XHJcblx0XHRcdFx0dmFyIGd1biA9IHRoaXMsIGF0ID0gZ3VuLl8sIHZhbHVlID0gYXQucHV0O1xyXG5cdFx0XHRcdGlmKCFhdC5zdHVuICYmIHUgIT09IHZhbHVlKXtcclxuXHRcdFx0XHRcdGNiLmNhbGwoZ3VuLCB2YWx1ZSwgYXQuZ2V0KTtcclxuXHRcdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmKGNiKXtcclxuXHRcdFx0XHRcdChvcHQgPSBvcHQgfHwge30pLm9rID0gY2I7XHJcblx0XHRcdFx0XHRvcHQuY2F0ID0gYXQ7XHJcblx0XHRcdFx0XHRjb25zb2xlLmRlYnVnKDQsICd2YWwnLCBhdCk7XHJcblx0XHRcdFx0XHRndW4uYW55KHZhbCwge2FzOiBvcHR9KTtcclxuXHRcdFx0XHRcdG9wdC5hc3luYyA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGZ1bmN0aW9uIHZhbChhdCwgZXYsIHRvKXsgdmFyIG9wdCA9IHRoaXM7XHJcblx0XHRcdFx0dmFyIGNhdCA9IG9wdC5jYXQsIGRhdGEgPSBhdC5wdXQ7XHJcblx0XHRcdFx0aWYodSA9PT0gZGF0YSl7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGNsZWFyVGltZW91dChldi50byk7XHJcblx0XHRcdFx0aWYoIXRvICYmIG9wdC5hc3luYyl7XHJcblx0XHRcdFx0XHRldi50byA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRcdFx0dmFsLmNhbGwob3B0LCBhdCwgZXYsIGV2LnRvIHx8IDEpXHJcblx0XHRcdFx0XHR9LCBvcHQud2FpdCB8fCA5OSk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGV2Lm9mZigpO1xyXG5cdFx0XHRcdG9wdC5vay5jYWxsKGF0Lmd1biB8fCBvcHQuZ3VuLCBkYXRhLCBhdC5nZXQpOyAvLyBUT0RPOiBCVUchIG9wdC5ndW4/XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdEd1bi5jaGFpbi5vZmYgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHZhciBndW4gPSB0aGlzLCBhdCA9IGd1bi5fLCB0bXA7XHJcblx0XHRcdFx0dmFyIGJhY2sgPSBhdC5iYWNrIHx8IHt9LCBjYXQgPSBiYWNrLl87XHJcblx0XHRcdFx0aWYoIWNhdCl7IHJldHVybiB9XHJcblx0XHRcdFx0aWYodG1wID0gY2F0LnBhdGgpe1xyXG5cdFx0XHRcdFx0aWYodG1wW2F0LmdldF0pe1xyXG5cdFx0XHRcdFx0XHRvYmpfZGVsKHRtcCwgYXQuZ2V0KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdG9ial9tYXAodG1wLCBmdW5jdGlvbihwYXRoLCBrZXkpe1xyXG5cdFx0XHRcdFx0XHRcdGlmKGd1biAhPT0gcGF0aCl7IHJldHVybiB9XHJcblx0XHRcdFx0XHRcdFx0b2JqX2RlbCh0bXAsIGtleSk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZigodG1wID0gZ3VuLkJhY2soLTEpKSA9PT0gYmFjayl7XHJcblx0XHRcdFx0XHRvYmpfZGVsKHRtcC5ncmFwaCwgYXQuZ2V0KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoYXQub25zICYmICh0bXAgPSBhdC5vbnNbJ0AkJ10pKXtcclxuXHRcdFx0XHRcdG9ial9tYXAodG1wLnMsIGZ1bmN0aW9uKGV2KXtcclxuXHRcdFx0XHRcdFx0ZXYub2ZmKCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIGd1bjtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgb2JqID0gR3VuLm9iaiwgb2JqX2hhcyA9IG9iai5oYXMsIG9ial9kZWwgPSBvYmouZGVsLCBvYmpfdG8gPSBvYmoudG87XHJcblx0XHRcdHZhciB2YWxfcmVsX2lzID0gR3VuLnZhbC5yZWwuaXM7XHJcblx0XHRcdHZhciBlbXB0eSA9IHt9LCB1O1xyXG5cdFx0fSgpKTtcclxuXHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdEd1bi5jaGFpbi5ub3QgPSBmdW5jdGlvbihjYiwgb3B0LCB0KXtcclxuXHRcdFx0XHR2YXIgZ3VuID0gdGhpcywgYXQgPSBHdW4ub2JqLnRvKGd1bi5fLCB7bm90OiB7bm90OiBjYn19KTtcclxuXHRcdFx0XHRndW4uYW55KG91Z2h0LCB7YXM6IGF0fSk7XHJcblx0XHRcdFx0cmV0dXJuIGd1bjtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBvdWdodChjYXQsIGV2KXsgZXYub2ZmKCk7IHZhciBhdCA9IHRoaXM7IC8vIFRPRE86IEJVRyEgSXMgdGhpcyBjb3JyZWN0P1xyXG5cdFx0XHRcdGlmKGNhdC5lcnIgfHwgY2F0LnB1dCl7IHJldHVybiB9XHJcblx0XHRcdFx0aWYoIWF0Lm5vdCB8fCAhYXQubm90Lm5vdCl7IHJldHVybiB9XHJcblx0XHRcdFx0Ly9ldi5zdHVuKCk7IC8vIFRPRE86IEJVRz8gSSB0aGluayB0aGlzIGlzIGNvcnJlY3QuIE5PVyBJTkNPUlJFQ1QgYmVjYXVzZSBhcyB0aGluZ3MgbXV0YXRlIHdlIG1pZ2h0IHdhbnQgdG8gcmV0cmlnZ2VyIVxyXG5cdFx0XHRcdGF0Lm5vdC5ub3QuY2FsbChhdC5ndW4sIGF0LmdldCwgZnVuY3Rpb24oKXsgY29uc29sZS5sb2coXCJQbGVhc2UgcmVwb3J0IHRoaXMgYnVnIG9uIGh0dHBzOi8vZ2l0dGVyLmltL2FtYXJrL2d1biBhbmQgaW4gdGhlIGlzc3Vlcy5cIik7IG5lZWQudG8uaW1wbGVtZW50OyB9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSgpKTtcclxuXHJcblx0XHQ7KGZ1bmN0aW9uKCl7XHJcblx0XHRcdEd1bi5jaGFpbi5tYXAgPSBmdW5jdGlvbihjYiwgb3B0LCB0KXtcclxuXHRcdFx0XHR2YXIgZ3VuID0gdGhpcywgY2F0ID0gZ3VuLl8sIGNoYWluID0gY2F0Lm1hcDtcclxuXHRcdFx0XHRpZighY2hhaW4pe1xyXG5cdFx0XHRcdFx0Y2hhaW4gPSBjYXQubWFwID0gZ3VuLmNoYWluKCk7XHJcblx0XHRcdFx0XHR2YXIgbGlzdCA9IChjYXQgPSBjaGFpbi5fKS5saXN0ID0gY2F0Lmxpc3QgfHwge307XHJcblx0XHRcdFx0XHRjaGFpbi5vbignaW4nKS5tYXAgPSB7fTtcclxuXHRcdFx0XHRcdGNoYWluLm9uKCdvdXQnLCBmdW5jdGlvbihhdCl7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUuZGVidWcoOCwgJ21hcCBvdXQnLCBhdCk7XHJcblx0XHRcdFx0IFx0XHRpZihhdC5nZXQgaW5zdGFuY2VvZiBGdW5jdGlvbil7XHJcblx0XHRcdFx0XHRcdFx0Y2hhaW4ub24oJ2luJywgYXQuZ2V0LCBhdCk7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUuZGVidWcoOSwgJ21hcCBvdXQnLCBhdCk7XHJcblx0XHRcdFx0XHRcdFx0Y2hhaW4ub24oJ2luJywgZ3VuLmdldC5pbnB1dCwgYXQuZ3VuLl8pO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGlmKG9wdCAhPT0gZmFsc2Upe1xyXG5cdFx0XHRcdFx0XHRndW4ub24obWFwLCB7Y2hhbmdlOiB0cnVlLCBhczogY2F0fSk7XHJcblx0XHRcdFx0XHRcdGNvbnNvbGUuZGVidWcoMSwgJ21hcCcpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZihjYil7XHJcblx0XHRcdFx0XHRjaGFpbi5vbihjYik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHJldHVybiBjaGFpbjtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBtYXAoYXQsZXYpe1xyXG5cdFx0XHRcdHZhciBjYXQgPSB0aGlzLCBndW4gPSBhdC5ndW4gfHwgdGhpcy5iYWNrLCB0YWMgPSBndW4uXztcclxuXHRcdFx0XHRvYmpfbWFwKGF0LnB1dCwgZWFjaCwge2d1bjpndW4sIGNhdDogY2F0LCBpZDogdGFjLmlkfHxhdC5nZXR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmdW5jdGlvbiBlYWNoKHYsZil7XHJcblx0XHRcdFx0aWYobl8gPT09IGYpeyByZXR1cm4gfVxyXG5cdFx0XHRcdHZhciBndW4gPSB0aGlzLmd1biwgY2F0ID0gdGhpcy5jYXQsIGlkID0gdGhpcy5pZDtcclxuXHRcdFx0XHRpZihjYXQubGlzdFtpZCtmXSl7IHJldHVybiB9XHJcblx0XHRcdFx0Ly8gVE9ETzogQlVHISBHaG9zdGluZyFcclxuXHRcdFx0XHRjYXQubGlzdFtpZCtmXSA9IGd1bi5wYXRoKGYpLm9uKGZ1bmN0aW9uKHYsZixhLGV2KXtcclxuXHRcdFx0XHRcdC8vY2F0Lm9uKCdpbicsW3tndW46dGhpcyxnZXQ6ZixwdXQ6dn0sZXZdKTtcclxuXHRcdFx0XHRcdGNhdC5vbignaW4nLFtpZCtmLHtndW46dGhpcyxnZXQ6ZixwdXQ6dn0sZXZdKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgb2JqX21hcCA9IEd1bi5vYmoubWFwLCBub29wID0gZnVuY3Rpb24oKXt9LCBldmVudCA9IHtzdHVuOiBub29wLCBvZmY6IG5vb3B9LCBuXyA9IEd1bi5ub2RlLl87XHJcblx0XHR9KCkpO1xyXG5cclxuXHRcdDsoZnVuY3Rpb24oKXtcclxuXHRcdFx0R3VuLmNoYWluLmluaXQgPSBmdW5jdGlvbigpeyAvLyBUT0RPOiBERVBSRUNBVEU/XHJcblx0XHRcdFx0KHRoaXMuXy5vcHQgPSB0aGlzLl8ub3B0IHx8IHt9KS5pbml0ID0gdHJ1ZTtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5CYWNrKC0xKS5wdXQoR3VuLm5vZGUuaWZ5KHt9LCB0aGlzLl8uZ2V0KSwgbnVsbCwgdGhpcy5fLmdldCk7XHJcblx0XHRcdH1cclxuXHRcdH0oKSk7XHJcblxyXG5cdFx0OyhmdW5jdGlvbigpe1xyXG5cdFx0XHRHdW4uY2hhaW4uc2V0ID0gZnVuY3Rpb24oaXRlbSwgY2IsIG9wdCl7XHJcblx0XHRcdFx0dmFyIGd1biA9IHRoaXM7XHJcblx0XHRcdFx0Y2IgPSBjYiB8fCBmdW5jdGlvbigpe307XHJcblx0XHRcdFx0cmV0dXJuIGl0ZW0udmFsKGZ1bmN0aW9uKG5vZGUpe1xyXG5cdFx0XHRcdFx0dmFyIHB1dCA9IHt9LCBzb3VsID0gR3VuLm5vZGUuc291bChub2RlKTtcclxuXHRcdFx0XHRcdGlmKCFzb3VsKXsgcmV0dXJuIGNiLmNhbGwoZ3VuLCB7ZXJyOiBHdW4ubG9nKCdPbmx5IGEgbm9kZSBjYW4gYmUgbGlua2VkISBOb3QgXCInICsgbm9kZSArICdcIiEnKX0pIH1cclxuXHRcdFx0XHRcdGd1bi5wdXQoR3VuLm9iai5wdXQocHV0LCBzb3VsLCBHdW4udmFsLnJlbC5pZnkoc291bCkpLCBjYiwgb3B0KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSgpKTtcclxuXHR9KShyZXF1aXJlLCAnLi9hcGknKTtcclxuXHJcblx0O3JlcXVpcmUoZnVuY3Rpb24obW9kdWxlKXtcclxuXHRcdGlmKHR5cGVvZiBKU09OID09PSAndW5kZWZpbmVkJyl7IHRocm93IG5ldyBFcnJvcihcIkluY2x1ZGUgSlNPTiBmaXJzdDogYWpheC5jZG5qcy5jb20vYWpheC9saWJzL2pzb24yLzIwMTEwMjIzL2pzb24yLmpzXCIpIH0gLy8gZm9yIG9sZCBJRSB1c2VcclxuXHRcdGlmKHR5cGVvZiBHdW4gPT09ICd1bmRlZmluZWQnKXsgcmV0dXJuIH0gLy8gVE9ETzogbG9jYWxTdG9yYWdlIGlzIEJyb3dzZXIgb25seS4gQnV0IGl0IHdvdWxkIGJlIG5pY2UgaWYgaXQgY291bGQgc29tZWhvdyBwbHVnaW4gaW50byBOb2RlSlMgY29tcGF0aWJsZSBsb2NhbFN0b3JhZ2UgQVBJcz9cclxuXHRcdFxyXG5cdFx0dmFyIHJvb3QsIG5vb3AgPSBmdW5jdGlvbigpe307XHJcblx0XHRpZih0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyl7IHJvb3QgPSB3aW5kb3cgfVxyXG5cdFx0dmFyIHN0b3JlID0gcm9vdC5sb2NhbFN0b3JhZ2UgfHwge3NldEl0ZW06IG5vb3AsIHJlbW92ZUl0ZW06IG5vb3AsIGdldEl0ZW06IG5vb3B9O1xyXG5cclxuXHRcdGZ1bmN0aW9uIHB1dChhdCl7IHZhciBlcnIsIGlkLCBvcHQsIHJvb3QgPSBhdC5ndW4uXy5yb290O1xyXG5cdFx0XHQob3B0ID0gYXQub3B0IHx8IHt9KS5wcmVmaXggPSBvcHQucHJlZml4IHx8ICdndW4vJztcclxuXHRcdFx0R3VuLmdyYXBoLmlzKGF0LnB1dCwgZnVuY3Rpb24obm9kZSwgc291bCl7XHJcblx0XHRcdFx0Ly90cnl7c3RvcmUuc2V0SXRlbShvcHQucHJlZml4ICsgc291bCwgR3VuLnRleHQuaWZ5KG5vZGUpKTtcclxuXHRcdFx0XHR0cnl7c3RvcmUuc2V0SXRlbShvcHQucHJlZml4ICsgc291bCwgR3VuLnRleHQuaWZ5KHJvb3QuXy5ncmFwaFtzb3VsXXx8bm9kZSkpO1xyXG5cdFx0XHRcdH1jYXRjaChlKXsgZXJyID0gZSB8fCBcImxvY2FsU3RvcmFnZSBmYWlsdXJlXCIgfVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0Ly9jb25zb2xlLmxvZygnQEBAQEBAQEBAQGxvY2FsIHB1dCEnKTtcclxuXHRcdFx0R3VuLm9uLmFjayhhdCwge2VycjogZXJyLCBvazogMH0pOyAvLyBUT0RPOiBSZWxpYWJpbGl0eSEgQXJlIHdlIHN1cmUgd2Ugd2FudCB0byBoYXZlIGxvY2FsU3RvcmFnZSBhY2s/XHJcblx0XHR9XHJcblx0XHRmdW5jdGlvbiBnZXQoYXQpe1xyXG5cdFx0XHR2YXIgZ3VuID0gYXQuZ3VuLCBsZXggPSBhdC5nZXQsIHNvdWwsIGRhdGEsIG9wdCwgdTtcclxuXHRcdFx0Ly9zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdChvcHQgPSBhdC5vcHQgfHwge30pLnByZWZpeCA9IG9wdC5wcmVmaXggfHwgJ2d1bi8nO1xyXG5cdFx0XHRpZighbGV4IHx8ICEoc291bCA9IGxleFtHdW4uXy5zb3VsXSkpeyByZXR1cm4gfVxyXG5cdFx0XHRkYXRhID0gR3VuLm9iai5pZnkoc3RvcmUuZ2V0SXRlbShvcHQucHJlZml4ICsgc291bCkgfHwgbnVsbCk7XHJcblx0XHRcdGlmKCFkYXRhKXsgcmV0dXJuIH0gLy8gbG9jYWxTdG9yYWdlIGlzbid0IHRydXN0d29ydGh5IHRvIHNheSBcIm5vdCBmb3VuZFwiLlxyXG5cdFx0XHRpZihHdW4ub2JqLmhhcyhsZXgsICcuJykpe3ZhciB0bXAgPSBkYXRhW2xleFsnLiddXTtkYXRhID0ge186IGRhdGEuX307aWYodSAhPT0gdG1wKXtkYXRhW2xleFsnLiddXSA9IHRtcH19XHJcblx0XHRcdC8vY29uc29sZS5sb2coJ0BAQEBAQEBAQEBAQGxvY2FsIGdldCcsIGRhdGEsIGF0KTtcclxuXHRcdFx0Z3VuLkJhY2soLTEpLm9uKCdpbicsIHsnQCc6IGF0WycjJ10sIHB1dDogR3VuLmdyYXBoLm5vZGUoZGF0YSl9KTtcclxuXHRcdFx0Ly99LDEwMCk7XHJcblx0XHR9XHJcblx0XHRHdW4ub24oJ3B1dCcsIHB1dCk7XHJcblx0XHRHdW4ub24oJ2dldCcsIGdldCk7XHJcblx0fSkocmVxdWlyZSwgJy4vYWRhcHRlcnMvbG9jYWxTdG9yYWdlJyk7XHJcblx0XHJcblx0O3JlcXVpcmUoZnVuY3Rpb24obW9kdWxlKXtcclxuXHRcdGZ1bmN0aW9uIHIoYmFzZSwgYm9keSwgY2IsIG9wdCl7XHJcblx0XHRcdHZhciBvID0gYmFzZS5sZW5ndGg/IHtiYXNlOiBiYXNlfSA6IHt9O1xyXG5cdFx0XHRvLmJhc2UgPSBvcHQuYmFzZSB8fCBiYXNlO1xyXG5cdFx0XHRvLmJvZHkgPSBvcHQuYm9keSB8fCBib2R5O1xyXG5cdFx0XHRvLmhlYWRlcnMgPSBvcHQuaGVhZGVycztcclxuXHRcdFx0by51cmwgPSBvcHQudXJsO1xyXG5cdFx0XHRvLm91dCA9IG9wdC5vdXQ7XHJcblx0XHRcdGNiID0gY2IgfHwgZnVuY3Rpb24oKXt9O1xyXG5cdFx0XHRpZighby5iYXNlKXsgcmV0dXJuIH1cclxuXHRcdFx0ci50cmFuc3BvcnQobywgY2IpO1xyXG5cdFx0fVxyXG5cdFx0ci5jcmVhdGVTZXJ2ZXIgPSBmdW5jdGlvbihmbil7IHIuY3JlYXRlU2VydmVyLnMucHVzaChmbikgfVxyXG5cdFx0ci5jcmVhdGVTZXJ2ZXIuaW5nID0gZnVuY3Rpb24ocmVxLCBjYil7XHJcblx0XHRcdHZhciBpID0gci5jcmVhdGVTZXJ2ZXIucy5sZW5ndGg7XHJcblx0XHRcdHdoaWxlKGktLSl7IChyLmNyZWF0ZVNlcnZlci5zW2ldIHx8IGZ1bmN0aW9uKCl7fSkocmVxLCBjYikgfVxyXG5cdFx0fVxyXG5cdFx0ci5jcmVhdGVTZXJ2ZXIucyA9IFtdO1xyXG5cdFx0ci5iYWNrID0gMjsgci5iYWNrb2ZmID0gMjtcclxuXHRcdHIudHJhbnNwb3J0ID0gZnVuY3Rpb24ob3B0LCBjYil7XHJcblx0XHRcdC8vR3VuLmxvZyhcIlRSQU5TUE9SVDpcIiwgb3B0KTtcclxuXHRcdFx0aWYoci53cyhvcHQsIGNiKSl7IHJldHVybiB9XHJcblx0XHRcdHIuanNvbnAob3B0LCBjYik7XHJcblx0XHR9XHJcblx0XHRyLndzID0gZnVuY3Rpb24ob3B0LCBjYiwgcmVxKXtcclxuXHRcdFx0dmFyIHdzLCBXUyA9IHdpbmRvdy5XZWJTb2NrZXQgfHwgd2luZG93Lm1veldlYlNvY2tldCB8fCB3aW5kb3cud2Via2l0V2ViU29ja2V0O1xyXG5cdFx0XHRpZighV1MpeyByZXR1cm4gfVxyXG5cdFx0XHRpZih3cyA9IHIud3MucGVlcnNbb3B0LmJhc2VdKXtcclxuXHRcdFx0XHRyZXEgPSByZXEgfHwge307XHJcblx0XHRcdFx0aWYob3B0LmhlYWRlcnMpeyByZXEuaGVhZGVycyA9IG9wdC5oZWFkZXJzIH1cclxuXHRcdFx0XHRpZihvcHQuYm9keSl7IHJlcS5ib2R5ID0gb3B0LmJvZHkgfVxyXG5cdFx0XHRcdGlmKG9wdC51cmwpeyByZXEudXJsID0gb3B0LnVybCB9XHJcblx0XHRcdFx0cmVxLmhlYWRlcnMgPSByZXEuaGVhZGVycyB8fCB7fTtcclxuXHRcdFx0XHRpZighb3B0Lm91dCAmJiAhd3MuY2JzW3JlcS5oZWFkZXJzWyd3cy1yaWQnXV0pe1xyXG5cdFx0XHRcdFx0d3MuY2JzW3JlcS5oZWFkZXJzWyd3cy1yaWQnXSA9ICdXUycgKyAoKyBuZXcgRGF0ZSgpKSArICcuJyArIE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkqNjU1MzUpKzEpXSA9IGZ1bmN0aW9uKGVycixyZXMpe1xyXG5cdFx0XHRcdFx0XHRpZighcmVzIHx8IHJlcy5ib2R5IHx8IHJlcy5lbmQpeyBkZWxldGUgd3MuY2JzW3JlcS5oZWFkZXJzWyd3cy1yaWQnXV0gfVxyXG5cdFx0XHRcdFx0XHRjYihlcnIscmVzKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYoIXdzLnJlYWR5U3RhdGUpeyByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpeyByLndzKG9wdCwgY2IsIHJlcSkgfSwxMDApLCB0cnVlIH1cclxuXHRcdFx0XHR3cy5zZW5kaW5nID0gdHJ1ZTtcclxuXHRcdFx0XHR3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHJlcSkpO1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHdzID09PSBmYWxzZSl7IHJldHVybiB9XHJcblx0XHRcdCh3cyA9IHIud3MucGVlcnNbb3B0LmJhc2VdID0gbmV3IFdTKG9wdC5iYXNlLnJlcGxhY2UoJ2h0dHAnLCd3cycpKSkuY2JzID0ge307XHJcblx0XHRcdHdzLm9ub3BlbiA9IGZ1bmN0aW9uKG8peyByLmJhY2sgPSAyOyByLndzKG9wdCwgY2IpIH07XHJcblx0XHRcdHdzLm9uY2xvc2UgPSB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSBmdW5jdGlvbihjKXtcclxuXHRcdFx0XHRpZighd3MgfHwgIWMpeyByZXR1cm4gfVxyXG5cdFx0XHRcdGlmKHdzLmNsb3NlIGluc3RhbmNlb2YgRnVuY3Rpb24peyB3cy5jbG9zZSgpIH1cclxuXHRcdFx0XHRpZighd3Muc2VuZGluZyl7XHJcblx0XHRcdFx0XHR3cyA9IHIud3MucGVlcnNbb3B0LmJhc2VdID0gZmFsc2U7XHJcblx0XHRcdFx0XHRyZXR1cm4gci50cmFuc3BvcnQob3B0LCBjYik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHIuZWFjaCh3cy5jYnMsIGZ1bmN0aW9uKGNiKXtcclxuXHRcdFx0XHRcdGNiKHtlcnI6IFwiV2ViU29ja2V0IGRpc2Nvbm5lY3RlZCFcIiwgY29kZTogIXdzLnNlbmRpbmc/IC0xIDogKHdzfHx7fSkuZXJyIHx8IGMuY29kZX0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHdzID0gci53cy5wZWVyc1tvcHQuYmFzZV0gPSBudWxsOyAvLyB0aGlzIHdpbGwgbWFrZSB0aGUgbmV4dCByZXF1ZXN0IHRyeSB0byByZWNvbm5lY3RcclxuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IC8vIFRPRE86IEhhdmUgdGhlIGRyaXZlciBoYW5kbGUgdGhpcyFcclxuXHRcdFx0XHRcdHIud3Mob3B0LCBmdW5jdGlvbigpe30pOyAvLyBvcHQgaGVyZSBpcyBhIHJhY2UgY29uZGl0aW9uLCBpcyBpdCBub3Q/IERvZXMgdGhpcyBtYXR0ZXI/XHJcblx0XHRcdFx0fSwgci5iYWNrICo9IHIuYmFja29mZik7XHJcblx0XHRcdH07XHJcblx0XHRcdHdzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKG0peyB2YXIgcmVzO1xyXG5cdFx0XHRcdGlmKCFtIHx8ICFtLmRhdGEpeyByZXR1cm4gfVxyXG5cdFx0XHRcdHRyeXtyZXMgPSBKU09OLnBhcnNlKG0uZGF0YSk7XHJcblx0XHRcdFx0fWNhdGNoKGUpeyByZXR1cm4gfVxyXG5cdFx0XHRcdGlmKCFyZXMpeyByZXR1cm4gfVxyXG5cdFx0XHRcdHJlcy5oZWFkZXJzID0gcmVzLmhlYWRlcnMgfHwge307XHJcblx0XHRcdFx0aWYocmVzLmhlYWRlcnNbJ3dzLXJpZCddKXsgcmV0dXJuICh3cy5jYnNbcmVzLmhlYWRlcnNbJ3dzLXJpZCddXXx8ZnVuY3Rpb24oKXt9KShudWxsLCByZXMpIH1cclxuXHRcdFx0XHRpZihyZXMuYm9keSl7IHIuY3JlYXRlU2VydmVyLmluZyhyZXMsIGZ1bmN0aW9uKHJlcyl7IHJlcy5vdXQgPSB0cnVlOyByKG9wdC5iYXNlLCBudWxsLCBudWxsLCByZXMpfSkgfSAvLyBlbWl0IGV4dHJhIGV2ZW50cy5cclxuXHRcdFx0fTtcclxuXHRcdFx0d3Mub25lcnJvciA9IGZ1bmN0aW9uKGUpeyAod3N8fHt9KS5lcnIgPSBlIH07XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0ci53cy5wZWVycyA9IHt9O1xyXG5cdFx0ci53cy5jYnMgPSB7fTtcclxuXHRcdHIuanNvbnAgPSBmdW5jdGlvbihvcHQsIGNiKXtcclxuXHRcdFx0ci5qc29ucC5pZnkob3B0LCBmdW5jdGlvbih1cmwpe1xyXG5cdFx0XHRcdGlmKCF1cmwpeyByZXR1cm4gfVxyXG5cdFx0XHRcdHIuanNvbnAuc2VuZCh1cmwsIGZ1bmN0aW9uKGVyciwgcmVwbHkpe1xyXG5cdFx0XHRcdFx0Y2IoZXJyLCByZXBseSk7XHJcblx0XHRcdFx0XHRyLmpzb25wLnBvbGwob3B0LCByZXBseSk7XHJcblx0XHRcdFx0fSwgb3B0Lmpzb25wKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRyLmpzb25wLnNlbmQgPSBmdW5jdGlvbih1cmwsIGNiLCBpZCl7XHJcblx0XHRcdHZhciBqcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xyXG5cdFx0XHRqcy5zcmMgPSB1cmw7XHJcblx0XHRcdGpzLm9uZXJyb3IgPSBmdW5jdGlvbihjKXtcclxuXHRcdFx0XHQod2luZG93W2pzLmlkXXx8ZnVuY3Rpb24oKXt9KShudWxsLCB7ZXJyOiBcIkpTT05QIGZhaWxlZCFcIn0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdHdpbmRvd1tqcy5pZCA9IGlkXSA9IGZ1bmN0aW9uKHJlcywgZXJyKXtcclxuXHRcdFx0XHRjYihlcnIsIHJlcyk7XHJcblx0XHRcdFx0Y2IuaWQgPSBqcy5pZDtcclxuXHRcdFx0XHRqcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGpzKTtcclxuXHRcdFx0XHR3aW5kb3dbY2IuaWRdID0gbnVsbDsgLy8gVE9ETzogQlVHOiBUaGlzIG5lZWRzIHRvIGhhbmRsZSBjaHVua2luZyFcclxuXHRcdFx0XHR0cnl7ZGVsZXRlIHdpbmRvd1tjYi5pZF07XHJcblx0XHRcdFx0fWNhdGNoKGUpe31cclxuXHRcdFx0fVxyXG5cdFx0XHRqcy5hc3luYyA9IHRydWU7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0uYXBwZW5kQ2hpbGQoanMpO1xyXG5cdFx0XHRyZXR1cm4ganM7XHJcblx0XHR9XHJcblx0XHRyLmpzb25wLnBvbGwgPSBmdW5jdGlvbihvcHQsIHJlcyl7XHJcblx0XHRcdGlmKCFvcHQgfHwgIW9wdC5iYXNlIHx8ICFyZXMgfHwgIXJlcy5oZWFkZXJzIHx8ICFyZXMuaGVhZGVycy5wb2xsKXsgcmV0dXJuIH1cclxuXHRcdFx0KHIuanNvbnAucG9sbC5zID0gci5qc29ucC5wb2xsLnMgfHwge30pW29wdC5iYXNlXSA9IHIuanNvbnAucG9sbC5zW29wdC5iYXNlXSB8fCBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IC8vIFRPRE86IE5lZWQgdG8gb3B0aW1pemUgZm9yIENocm9tZSdzIDYgcmVxIGxpbWl0P1xyXG5cdFx0XHRcdC8vR3VuLmxvZyhcInBvbGxpbmcgYWdhaW5cIik7XHJcblx0XHRcdFx0dmFyIG8gPSB7YmFzZTogb3B0LmJhc2UsIGhlYWRlcnM6IHtwdWxsOiAxfX07XHJcblx0XHRcdFx0ci5lYWNoKG9wdC5oZWFkZXJzLCBmdW5jdGlvbih2LGkpeyBvLmhlYWRlcnNbaV0gPSB2IH0pXHJcblx0XHRcdFx0ci5qc29ucChvLCBmdW5jdGlvbihlcnIsIHJlcGx5KXtcclxuXHRcdFx0XHRcdGRlbGV0ZSByLmpzb25wLnBvbGwuc1tvcHQuYmFzZV07XHJcblx0XHRcdFx0XHR3aGlsZShyZXBseS5ib2R5ICYmIHJlcGx5LmJvZHkubGVuZ3RoICYmIHJlcGx5LmJvZHkuc2hpZnQpeyAvLyB3ZSdyZSBhc3N1bWluZyBhbiBhcnJheSByYXRoZXIgdGhhbiBjaHVuayBlbmNvZGluZy4gOihcclxuXHRcdFx0XHRcdFx0dmFyIHJlcyA9IHJlcGx5LmJvZHkuc2hpZnQoKTtcclxuXHRcdFx0XHRcdFx0aWYocmVzICYmIHJlcy5ib2R5KXsgci5jcmVhdGVTZXJ2ZXIuaW5nKHJlcywgZnVuY3Rpb24oKXsgcihvcHQuYmFzZSwgbnVsbCwgbnVsbCwgcmVzKSB9KSB9IC8vIGVtaXQgZXh0cmEgZXZlbnRzLlxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9LCByZXMuaGVhZGVycy5wb2xsKTtcclxuXHRcdH1cclxuXHRcdHIuanNvbnAuaWZ5ID0gZnVuY3Rpb24ob3B0LCBjYil7XHJcblx0XHRcdHZhciB1cmkgPSBlbmNvZGVVUklDb21wb25lbnQsIHEgPSAnPyc7XHJcblx0XHRcdGlmKG9wdC51cmwgJiYgb3B0LnVybC5wYXRobmFtZSl7IHEgPSBvcHQudXJsLnBhdGhuYW1lICsgcTsgfVxyXG5cdFx0XHRxID0gb3B0LmJhc2UgKyBxO1xyXG5cdFx0XHRyLmVhY2goKG9wdC51cmx8fHt9KS5xdWVyeSwgZnVuY3Rpb24odiwgaSl7IHEgKz0gdXJpKGkpICsgJz0nICsgdXJpKHYpICsgJyYnIH0pO1xyXG5cdFx0XHRpZihvcHQuaGVhZGVycyl7IHEgKz0gdXJpKCdgJykgKyAnPScgKyB1cmkoSlNPTi5zdHJpbmdpZnkob3B0LmhlYWRlcnMpKSArICcmJyB9XHJcblx0XHRcdGlmKHIuanNvbnAubWF4IDwgcS5sZW5ndGgpeyByZXR1cm4gY2IoKSB9XHJcblx0XHRcdHEgKz0gdXJpKCdqc29ucCcpICsgJz0nICsgdXJpKG9wdC5qc29ucCA9ICdQJytNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpKjY1NTM1KSsxKSk7XHJcblx0XHRcdGlmKG9wdC5ib2R5KXtcclxuXHRcdFx0XHRxICs9ICcmJztcclxuXHRcdFx0XHR2YXIgdyA9IG9wdC5ib2R5LCB3bHMgPSBmdW5jdGlvbih3LGwscyl7XHJcblx0XHRcdFx0XHRyZXR1cm4gdXJpKCclJykgKyAnPScgKyB1cmkodysnLScrKGx8fHcpKycvJysoc3x8dykpICArICcmJyArIHVyaSgnJCcpICsgJz0nO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZih0eXBlb2YgdyAhPSAnc3RyaW5nJyl7XHJcblx0XHRcdFx0XHR3ID0gSlNPTi5zdHJpbmdpZnkodyk7XHJcblx0XHRcdFx0XHRxICs9IHVyaSgnXicpICsgJz0nICsgdXJpKCdqc29uJykgKyAnJic7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHcgPSB1cmkodyk7XHJcblx0XHRcdFx0dmFyIGkgPSAwLCBsID0gdy5sZW5ndGhcclxuXHRcdFx0XHQsIHMgPSByLmpzb25wLm1heCAtIChxLmxlbmd0aCArIHdscyhsLnRvU3RyaW5nKCkpLmxlbmd0aCk7XHJcblx0XHRcdFx0aWYocyA8IDApeyByZXR1cm4gY2IoKSB9XHJcblx0XHRcdFx0d2hpbGUodyl7XHJcblx0XHRcdFx0XHRjYihxICsgd2xzKGksIChpID0gaSArIHMpLCBsKSArIHcuc2xpY2UoMCwgaSkpO1xyXG5cdFx0XHRcdFx0dyA9IHcuc2xpY2UoaSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNiKHEpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyLmpzb25wLm1heCA9IDIwMDA7XHJcblx0XHRyLmVhY2ggPSBmdW5jdGlvbihvYmosIGNiLCBhcyl7XHJcblx0XHRcdGlmKCFvYmogfHwgIWNiKXsgcmV0dXJuIH1cclxuXHRcdFx0Zm9yKHZhciBpIGluIG9iail7XHJcblx0XHRcdFx0aWYob2JqLmhhc093blByb3BlcnR5KGkpKXtcclxuXHRcdFx0XHRcdGNiLmNhbGwoYXMsIG9ialtpXSwgaSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRtb2R1bGUuZXhwb3J0cyA9IHI7XHJcblx0fSkocmVxdWlyZSwgJy4vcG9seWZpbGwvcmVxdWVzdCcpO1xyXG5cclxuXHQ7cmVxdWlyZShmdW5jdGlvbihtb2R1bGUpe1xyXG5cdFx0UC5yZXF1ZXN0ID0gcmVxdWlyZSgnLi9yZXF1ZXN0Jyk7XHJcblx0XHRmdW5jdGlvbiBQKHApe1xyXG5cdFx0XHRpZighUC5pcyh0aGlzKSl7IHJldHVybiBuZXcgUChwKSB9XHJcblx0XHRcdHRoaXMucGVlcnMgPSBwO1xyXG5cdFx0fVxyXG5cdFx0UC5pcyA9IGZ1bmN0aW9uKHApeyByZXR1cm4gKHAgaW5zdGFuY2VvZiBQKSB9XHJcblx0XHRQLmNoYWluID0gUC5wcm90b3R5cGU7XHJcblx0XHRmdW5jdGlvbiBtYXAocGVlciwgdXJsKXtcclxuXHRcdFx0dmFyIG1zZyA9IHRoaXMubXNnO1xyXG5cdFx0XHR2YXIgb3B0ID0gdGhpcy5vcHQgfHwge307XHJcblx0XHRcdG9wdC5vdXQgPSB0cnVlO1xyXG5cdFx0XHRQLnJlcXVlc3QodXJsLCBtc2csIG51bGwsIG9wdCk7XHJcblx0XHR9XHJcblx0XHRQLmNoYWluLnNlbmQgPSBmdW5jdGlvbihtc2csIG9wdCl7XHJcblx0XHRcdFAucmVxdWVzdC5lYWNoKHRoaXMucGVlcnMsIG1hcCwge21zZzogbXNnLCBvcHQ6IG9wdH0pO1xyXG5cdFx0fVxyXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBQO1xyXG5cdH0pKHJlcXVpcmUsICcuL3BvbHlmaWxsL3BlZXInKTtcclxuXHJcblx0O3JlcXVpcmUoZnVuY3Rpb24obW9kdWxlKXtcclxuXHRcdGlmKHR5cGVvZiBKU09OID09PSAndW5kZWZpbmVkJyl7IHRocm93IG5ldyBFcnJvcihcIkluY2x1ZGUgSlNPTiBmaXJzdDogYWpheC5jZG5qcy5jb20vYWpheC9saWJzL2pzb24yLzIwMTEwMjIzL2pzb24yLmpzXCIpIH0gLy8gZm9yIG9sZCBJRSB1c2VcclxuXHRcdGlmKHR5cGVvZiBHdW4gPT09ICd1bmRlZmluZWQnKXsgcmV0dXJuIH0gLy8gVE9ETzogd2luZG93LldlYnNvY2tldCBpcyBCcm93c2VyIG9ubHkuIEJ1dCBpdCB3b3VsZCBiZSBuaWNlIGlmIGl0IGNvdWxkIHNvbWVob3cgbWVyZ2UgaXQgd2l0aCBsaWIvV1NQP1xyXG5cdFx0XHJcblx0XHR2YXIgcm9vdCwgbm9vcCA9IGZ1bmN0aW9uKCl7fTtcclxuXHRcdGlmKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKXsgcm9vdCA9IHdpbmRvdyB9XHJcblxyXG5cdFx0dmFyIFRhYiA9IHt9O1xyXG5cdFx0VGFiLm9uID0gR3VuLm9uOy8vR3VuLm9uLmNyZWF0ZSgpO1xyXG5cdFx0VGFiLnBlZXJzID0gcmVxdWlyZSgnLi4vcG9seWZpbGwvcGVlcicpO1xyXG5cdFx0R3VuLm9uKCdnZXQnLCBmdW5jdGlvbihhdCl7XHJcblx0XHRcdHZhciBndW4gPSBhdC5ndW4sIG9wdCA9IGd1bi5CYWNrKCdvcHQnKSB8fCB7fSwgcGVlcnMgPSBvcHQucGVlcnM7XHJcblx0XHRcdGlmKCFwZWVycyB8fCBHdW4ub2JqLmVtcHR5KHBlZXJzKSl7XHJcblx0XHRcdFx0Ly9zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0R3VuLmxvZy5vbmNlKCdwZWVycycsIFwiV2FybmluZyEgWW91IGhhdmUgbm8gcGVlcnMgdG8gY29ubmVjdCB0byFcIik7XHJcblx0XHRcdFx0YXQuZ3VuLkJhY2soLTEpLm9uKCdpbicsIHsnQCc6IGF0WycjJ119KTtcclxuXHRcdFx0XHQvL30sMTAwKTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIG1zZyA9IHtcclxuXHRcdFx0XHQnIyc6IGF0WycjJ10gfHwgR3VuLnRleHQucmFuZG9tKDkpLCAvLyBtc2cgSURcclxuXHRcdFx0XHQnJCc6IGF0LmdldCAvLyBtc2cgQk9EWVxyXG5cdFx0XHR9O1xyXG5cdFx0XHRUYWIub24obXNnWycjJ10sIGZ1bmN0aW9uKGVyciwgZGF0YSl7IC8vIFRPRE86IE9ORT8gUEVSRiEgQ2xlYXIgb3V0IGxpc3RlbmVycywgbWF5YmUgd2l0aCBzZXRUaW1lb3V0P1xyXG5cdFx0XHRcdGlmKGRhdGEpe1xyXG5cdFx0XHRcdFx0YXQuZ3VuLkJhY2soLTEpLm9uKCdvdXQnLCB7J0AnOiBhdFsnIyddLCBlcnI6IGVyciwgcHV0OiBkYXRhfSk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGF0Lmd1bi5CYWNrKC0xKS5vbignaW4nLCB7J0AnOiBhdFsnIyddLCBlcnI6IGVyciwgcHV0OiBkYXRhfSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0VGFiLnBlZXJzKHBlZXJzKS5zZW5kKG1zZywge2hlYWRlcnM6IHsnZ3VuLXNpZCc6IFRhYi5zZXJ2ZXIuc2lkfX0pO1xyXG5cdFx0fSk7XHJcblx0XHRHdW4ub24oJ3B1dCcsIGZ1bmN0aW9uKGF0KXtcclxuXHRcdFx0aWYoYXRbJ0AnXSl7IHJldHVybiB9XHJcblx0XHRcdHZhciBvcHQgPSBhdC5ndW4uQmFjaygnb3B0JykgfHwge30sIHBlZXJzID0gb3B0LnBlZXJzO1xyXG5cdFx0XHRpZighcGVlcnMgfHwgR3VuLm9iai5lbXB0eShwZWVycykpe1xyXG5cdFx0XHRcdEd1bi5sb2cub25jZSgncGVlcnMnLCBcIldhcm5pbmchIFlvdSBoYXZlIG5vIHBlZXJzIHRvIHNhdmUgdG8hXCIpO1xyXG5cdFx0XHRcdGF0Lmd1bi5CYWNrKC0xKS5vbignaW4nLCB7J0AnOiBhdFsnIyddfSk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKGZhbHNlID09PSBvcHQud2Vic29ja2V0IHx8IChhdC5vcHQgJiYgZmFsc2UgPT09IGF0Lm9wdC53ZWJzb2NrZXQpKXsgcmV0dXJuIH1cclxuXHRcdFx0dmFyIG1zZyA9IHtcclxuXHRcdFx0XHQnIyc6IGF0WycjJ10gfHwgR3VuLnRleHQucmFuZG9tKDkpLCAvLyBtc2cgSURcclxuXHRcdFx0XHQnJCc6IGF0LnB1dCAvLyBtc2cgQk9EWVxyXG5cdFx0XHR9O1xyXG5cdFx0XHRUYWIub24obXNnWycjJ10sIGZ1bmN0aW9uKGVyciwgb2speyAvLyBUT0RPOiBPTkU/IFBFUkYhIENsZWFyIG91dCBsaXN0ZW5lcnMsIG1heWJlIHdpdGggc2V0VGltZW91dD9cclxuXHRcdFx0XHRhdC5ndW4uQmFjaygtMSkub24oJ2luJywgeydAJzogYXRbJyMnXSwgZXJyOiBlcnIsIG9rOiBva30pO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0VGFiLnBlZXJzKHBlZXJzKS5zZW5kKG1zZywge2hlYWRlcnM6IHsnZ3VuLXNpZCc6IFRhYi5zZXJ2ZXIuc2lkfX0pO1xyXG5cdFx0fSk7XHJcblx0XHQvLyBicm93c2VyL2NsaWVudCBzaWRlIFNlcnZlciFcclxuXHRcdEd1bi5vbignb3B0JywgZnVuY3Rpb24oYXQpeyAvLyBUT0RPOiBCVUchIERvZXMgbm90IHJlc3BlY3Qgc2VwYXJhdGUgaW5zdGFuY2VzISEhXHJcblx0XHRcdGlmKFRhYi5zZXJ2ZXIpeyByZXR1cm4gfVxyXG5cdFx0XHR2YXIgZ3VuID0gYXQuZ3VuLCBzZXJ2ZXIgPSBUYWIuc2VydmVyID0ge30sIHRtcDtcclxuXHRcdFx0c2VydmVyLnNpZCA9IEd1bi50ZXh0LnJhbmRvbSgpO1xyXG5cdFx0XHRUYWIucGVlcnMucmVxdWVzdC5jcmVhdGVTZXJ2ZXIoZnVuY3Rpb24ocmVxLCByZXMpe1xyXG5cdFx0XHRcdGlmKCFyZXEgfHwgIXJlcyB8fCAhcmVxLmJvZHkgfHwgIXJlcS5oZWFkZXJzKXsgcmV0dXJuIH1cclxuXHRcdFx0XHR2YXIgbXNnID0gcmVxLmJvZHk7XHJcblx0XHRcdFx0Ly8gQVVUSCBmb3Igbm9uLXJlcGxpZXMuXHJcblx0XHRcdFx0aWYoc2VydmVyLm1zZyhtc2dbJyMnXSkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdC8vc2VydmVyLm9uKCduZXR3b3JrJywgR3VuLm9iai5jb3B5KHJlcSkpOyAvLyBVbmxlc3Mgd2UgaGF2ZSBXZWJSVEMsIG5vdCBuZWVkZWQuXHJcblx0XHRcdFx0aWYobXNnWydAJ10peyAvLyBubyBuZWVkIHRvIHByb2Nlc3MuXHJcblx0XHRcdFx0XHRpZihUYWIub25zW3RtcCA9IG1zZ1snQCddIHx8IG1zZ1snIyddXSl7XHJcblx0XHRcdFx0XHRcdFRhYi5vbih0bXAsIFttc2dbJyEnXSwgbXNnWyckJ11dKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYobXNnWyckJ10gJiYgbXNnWyckJ11bJyMnXSl7IHJldHVybiBzZXJ2ZXIuZ2V0KHJlcSwgcmVzKSB9XHJcblx0XHRcdFx0ZWxzZSB7IHJldHVybiBzZXJ2ZXIucHV0KHJlcSwgcmVzKSB9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRzZXJ2ZXIuZ2V0ID0gZnVuY3Rpb24ocmVxLCBjYil7XHJcblx0XHRcdFx0dmFyIGJvZHkgPSByZXEuYm9keSwgbGV4ID0gYm9keVsnJCddLCBvcHQ7XHJcblx0XHRcdFx0dmFyIGdyYXBoID0gZ3VuLl8ucm9vdC5fLmdyYXBoLCBub2RlO1xyXG5cdFx0XHRcdGlmKCEobm9kZSA9IGdyYXBoW2xleFsnIyddXSkpeyByZXR1cm4gfSAvLyBEb24ndCByZXBseSB0byBkYXRhIHdlIGRvbid0IGhhdmUgaXQgaW4gbWVtb3J5LiBUT0RPOiBBZGQgbG9jYWxTdG9yYWdlP1xyXG5cdFx0XHRcdGNiKHtib2R5OiB7XHJcblx0XHRcdFx0XHQnIyc6IHNlcnZlci5tc2coKSxcclxuXHRcdFx0XHRcdCdAJzogYm9keVsnIyddLFxyXG5cdFx0XHRcdFx0JyQnOiBub2RlXHJcblx0XHRcdFx0fX0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdHNlcnZlci5wdXQgPSBmdW5jdGlvbihyZXEsIGNiKXtcclxuXHRcdFx0XHR2YXIgYm9keSA9IHJlcS5ib2R5LCBncmFwaCA9IGJvZHlbJyQnXTtcclxuXHRcdFx0XHR2YXIgX18gPSBndW4uXy5yb290Ll87XHJcblx0XHRcdFx0aWYoIShncmFwaCA9IEd1bi5vYmoubWFwKGdyYXBoLCBmdW5jdGlvbihub2RlLCBzb3VsLCBtYXApeyAvLyBmaWx0ZXIgb3V0IHdoYXQgd2UgZG9uJ3QgaGF2ZSBpbiBtZW1vcnkuXHJcblx0XHRcdFx0XHRpZighX18ucGF0aFtzb3VsXSl7IHJldHVybiB9XHJcblx0XHRcdFx0XHRtYXAoc291bCwgbm9kZSk7XHJcblx0XHRcdFx0fSkpKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRndW4ub24oJ291dCcsIHtndW46IGd1biwgb3B0OiB7d2Vic29ja2V0OiBmYWxzZX0sIHB1dDogZ3JhcGgsICcjJzogR3VuLm9uLmFzayhmdW5jdGlvbihhY2ssIGV2KXtcclxuXHRcdFx0XHRcdGlmKCFhY2speyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0ZXYub2ZmKCk7XHJcblx0XHRcdFx0XHRyZXR1cm4gY2Ioe2JvZHk6IHtcclxuXHRcdFx0XHRcdFx0JyMnOiBzZXJ2ZXIubXNnKCksXHJcblx0XHRcdFx0XHRcdCdAJzogYm9keVsnIyddLFxyXG5cdFx0XHRcdFx0XHQnJCc6IGFjayxcclxuXHRcdFx0XHRcdFx0JyEnOiBhY2suZXJyXHJcblx0XHRcdFx0XHR9fSk7XHJcblx0XHRcdFx0fSl9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRzZXJ2ZXIubXNnID0gZnVuY3Rpb24oaWQpe1xyXG5cdFx0XHRcdGlmKCFpZCl7XHJcblx0XHRcdFx0XHRyZXR1cm4gc2VydmVyLm1zZy5kZWJvdW5jZVtpZCA9IEd1bi50ZXh0LnJhbmRvbSg5KV0gPSBHdW4udGltZS5pcygpLCBpZDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KHNlcnZlci5tc2cuY2xlYXIpO1xyXG5cdFx0XHRcdHNlcnZlci5tc2cuY2xlYXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0XHR2YXIgbm93ID0gR3VuLnRpbWUuaXMoKTtcclxuXHRcdFx0XHRcdEd1bi5vYmoubWFwKHNlcnZlci5tc2cuZGVib3VuY2UsIGZ1bmN0aW9uKHQsaWQpe1xyXG5cdFx0XHRcdFx0XHRpZigobm93IC0gdCkgPCAoMTAwMCAqIDYwICogNSkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0XHRHdW4ub2JqLmRlbChzZXJ2ZXIubXNnLmRlYm91bmNlLCBpZCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9LDUwMCk7XHJcblx0XHRcdFx0aWYoc2VydmVyLm1zZy5kZWJvdW5jZVtpZF0peyBcclxuXHRcdFx0XHRcdHJldHVybiBzZXJ2ZXIubXNnLmRlYm91bmNlW2lkXSA9IEd1bi50aW1lLmlzKCksIGlkO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzZXJ2ZXIubXNnLmRlYm91bmNlW2lkXSA9IEd1bi50aW1lLmlzKCk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9O1x0XHJcblx0XHRcdHNlcnZlci5tc2cuZGVib3VuY2UgPSBzZXJ2ZXIubXNnLmRlYm91bmNlIHx8IHt9O1xyXG5cdFx0fSk7XHJcblxyXG5cdH0pKHJlcXVpcmUsICcuL2FkYXB0ZXJzL3dzcCcpO1xyXG5cclxufSgpKTtcclxuIiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2xpYi9zZXJ2ZXInKTsiLCIvLyBUaGlzIHdhcyB3cml0dGVuIGJ5IHRoZSB3b25kZXJmdWwgRm9ycmVzdCBUYWl0XG4vLyBtb2RpZmllZCBieSBNYXJrIHRvIGJlIHBhcnQgb2YgY29yZSBmb3IgY29udmVuaWVuY2Vcbi8vIHR3YXMgbm90IGRlc2lnbmVkIGZvciBwcm9kdWN0aW9uIHVzZVxuLy8gb25seSBzaW1wbGUgbG9jYWwgZGV2ZWxvcG1lbnQuXG52YXIgR3VuID0gcmVxdWlyZSgnLi4vZ3VuJyksXG5cdGZzID0gcmVxdWlyZSgnZnMnKSxcblx0ZmlsZSA9IHt9O1xuXG4vLyBxdWV1ZSB3cml0ZXMsIGFkYXB0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vdG9vbG5lc3MvanNvbmRvd24vYmxvYi9tYXN0ZXIvanNvbmRvd24uanNcbnZhciBpc1dyaXRpbmcgPSBmYWxzZSwgcXVldWVkV3JpdGVzID0gW107XG5mdW5jdGlvbiB3cml0ZUZpbGUocGF0aCwgZGlzaywgYXQpe1xuXHRpZihpc1dyaXRpbmcpIHJldHVybiBxdWV1ZWRXcml0ZXMucHVzaChhdCk7XG5cdGlzV3JpdGluZyA9IHRydWU7XG5cdHZhciBjb250ZW50cyA9IEpTT04uc3RyaW5naWZ5KGRpc2ssIG51bGwsIDIpO1xuXHRmcy53cml0ZUZpbGUoU3RyaW5nKHBhdGgpLCBjb250ZW50cywgZnVuY3Rpb24oZXJyKSB7XG5cdFx0dmFyIGJhdGNoID0gcXVldWVkV3JpdGVzLnNwbGljZSgwKTtcblx0XHRpc1dyaXRpbmcgPSBmYWxzZTtcblx0XHRhdC5ndW4uQmFjaygtMSkub24oJ2luJywgeydAJzogYXRbJyMnXSwgZXJyOiBlcnIsIG9rOiBlcnI/IGZhbHNlIDogMX0pO1xuXHRcdGlmKCFiYXRjaC5sZW5ndGgpeyByZXR1cm4gfVxuXHRcdGJhdGNoLmZvckVhY2goZnVuY3Rpb24oYXQpe1xuXHRcdFx0YXQuZ3VuLkJhY2soLTEpLm9uKCdpbicsIHsnQCc6IGF0WycjJ10sIGVycjogZXJyLCBvazogZXJyPyBmYWxzZSA6IDF9KTtcblx0XHR9KTtcblx0fSk7XG59XG5cbkd1bi5vbigncHV0JywgZnVuY3Rpb24oYXQpe1xuXHR2YXIgZ3VuID0gYXQuZ3VuLCBncmFwaCA9IGF0LnB1dCwgb3B0ID0gYXQub3B0IHx8IHt9O1xuXHR2YXIgX18gPSBndW4uXy5yb290Ll87XG5cdEd1bi5vYmoubWFwKGdyYXBoLCBmdW5jdGlvbihub2RlLCBzb3VsKXtcblx0XHRmaWxlLmRpc2suZ3JhcGhbc291bF0gPSBfXy5ncmFwaFtzb3VsXSB8fCBncmFwaFtzb3VsXTtcblx0fSk7XG5cdHdyaXRlRmlsZShvcHQuZmlsZSB8fCBmaWxlLmZpbGUsIGZpbGUuZGlzaywgYXQpO1xufSk7XG5HdW4ub24oJ2dldCcsIGZ1bmN0aW9uKGF0KXtcblx0dmFyIGd1biA9IGF0Lmd1biwgbGV4ID0gYXQuZ2V0LCBvcHQgPSBhdC5vcHQ7XG5cdGlmKCFsZXgpe3JldHVybn1cblx0Z3VuLkJhY2soLTEpLm9uKCdpbicsIHsnQCc6IGF0WycjJ10sIHB1dDogR3VuLmdyYXBoLm5vZGUoZmlsZS5kaXNrLmdyYXBoW2xleFsnIyddXSl9KTtcblx0Ly9hdC5jYihudWxsLCBmaWxlLmRpc2suZ3JhcGhbbGV4WycjJ11dKTtcbn0pO1xuXG5HdW4ub24oJ29wdCcsIGZ1bmN0aW9uKGF0KXtcblx0dmFyIGd1biA9IGF0Lmd1biwgb3B0cyA9IGF0Lm9wdDtcblx0aWYgKChvcHRzLmZpbGUgPT09IGZhbHNlKSB8fCAob3B0cy5zMyAmJiBvcHRzLnMzLmtleSkpIHtcblx0XHRyZXR1cm47IC8vIGRvbid0IHVzZSB0aGlzIHBsdWdpbiBpZiBTMyBpcyBiZWluZyB1c2VkLlxuXHR9XG5cdGNvbnNvbGUubG9nKFwiV0FSTklORyEgVGhpcyBgZmlsZS5qc2AgbW9kdWxlIGZvciBndW4gaXMgaW50ZW5kZWQgb25seSBmb3IgbG9jYWwgZGV2ZWxvcG1lbnQgdGVzdGluZyFcIilcblx0ZmlsZS5maWxlID0gb3B0cy5maWxlIHx8IGZpbGUuZmlsZSB8fCAnZGF0YS5qc29uJztcblx0ZmlsZS5yYXcgPSBmaWxlLnJhdyB8fCAoZnMuZXhpc3RzU3luYyB8fCByZXF1aXJlKCdwYXRoJykuZXhpc3RzU3luYykob3B0cy5maWxlKSA/IGZzLnJlYWRGaWxlU3luYyhvcHRzLmZpbGUpLnRvU3RyaW5nKCkgOiBudWxsO1xuXHRmaWxlLmRpc2sgPSBmaWxlLmRpc2sgfHwgR3VuLm9iai5pZnkoZmlsZS5yYXcgfHwge2dyYXBoOiB7fX0pO1xuXHRmaWxlLmRpc2suZ3JhcGggPSBmaWxlLmRpc2suZ3JhcGggfHwge307XG59KTtcbiIsInZhciBHdW4gPSByZXF1aXJlKCcuLi9ndW4nKVxyXG4sXHRmb3JtaWRhYmxlID0gcmVxdWlyZSgnZm9ybWlkYWJsZScpXHJcbixcdHVybCA9IHJlcXVpcmUoJ3VybCcpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KXtcclxuXHRuZXh0ID0gbmV4dCB8fCBmdW5jdGlvbigpe307IC8vIGlmIG5vdCBuZXh0LCBhbmQgd2UgZG9uJ3QgaGFuZGxlIGl0LCB3ZSBzaG91bGQgcmVzLmVuZFxyXG5cdGlmKCFyZXEgfHwgIXJlcyl7IHJldHVybiBuZXh0KCkgfVxyXG5cdGlmKCFyZXEudXJsKXsgcmV0dXJuIG5leHQoKSB9XHJcblx0aWYoIXJlcS5tZXRob2QpeyByZXR1cm4gbmV4dCgpIH1cclxuXHR2YXIgbXNnID0ge307XHJcblx0bXNnLnVybCA9IHVybC5wYXJzZShyZXEudXJsLCB0cnVlKTtcclxuXHRtc2cubWV0aG9kID0gKHJlcS5tZXRob2R8fCcnKS50b0xvd2VyQ2FzZSgpO1xyXG5cdG1zZy5oZWFkZXJzID0gcmVxLmhlYWRlcnM7XHJcblx0dmFyIHUsIGJvZHlcclxuXHQsXHRmb3JtID0gbmV3IGZvcm1pZGFibGUuSW5jb21pbmdGb3JtKClcclxuXHQsXHRwb3N0ID0gZnVuY3Rpb24oZXJyLCBib2R5KXtcclxuXHRcdGlmKHUgIT09IGJvZHkpeyBtc2cuYm9keSA9IGJvZHkgfVxyXG5cdFx0bmV4dChtc2csIGZ1bmN0aW9uKHJlcGx5KXtcclxuXHRcdFx0aWYoIXJlcyl7IHJldHVybiB9XHJcblx0XHRcdGlmKCFyZXBseSl7IHJldHVybiByZXMuZW5kKCkgfVxyXG5cdFx0XHRpZihHdW4ub2JqLmhhcyhyZXBseSwgJ3N0YXR1c0NvZGUnKSB8fCBHdW4ub2JqLmhhcyhyZXBseSwgJ3N0YXR1cycpKXtcclxuXHRcdFx0XHRyZXMuc3RhdHVzQ29kZSA9IHJlcGx5LnN0YXR1c0NvZGUgfHwgcmVwbHkuc3RhdHVzO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmKHJlcGx5LmhlYWRlcnMpe1xyXG5cdFx0XHRcdGlmKCEocmVzLmhlYWRlcnNTZW50IHx8IHJlcy5oZWFkZXJTZW50IHx8IHJlcy5faGVhZGVyU2VudCB8fCByZXMuX2hlYWRlcnNTZW50KSl7XHJcblx0XHRcdFx0XHRHdW4ub2JqLm1hcChyZXBseS5oZWFkZXJzLCBmdW5jdGlvbih2YWwsIGZpZWxkKXtcclxuXHRcdFx0XHRcdFx0aWYodmFsICE9PSAwICYmICF2YWwpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0XHRyZXMuc2V0SGVhZGVyKGZpZWxkLCB2YWwpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKEd1bi5vYmouaGFzKHJlcGx5LCdjaHVuaycpIHx8IEd1bi5vYmouaGFzKHJlcGx5LCd3cml0ZScpKXtcclxuXHRcdFx0XHRyZXMud3JpdGUoR3VuLnRleHQuaWZ5KHJlcGx5LmNodW5rIHx8IHJlcGx5LndyaXRlKSB8fCAnJyk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoR3VuLm9iai5oYXMocmVwbHksJ2JvZHknKSB8fCBHdW4ub2JqLmhhcyhyZXBseSwnZW5kJykpe1xyXG5cdFx0XHRcdHJlcy5lbmQoR3VuLnRleHQuaWZ5KHJlcGx5LmJvZHkgfHwgcmVwbHkuZW5kKSB8fCAnJyk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHRmb3JtLm9uKCdmaWVsZCcsZnVuY3Rpb24oayx2KXtcclxuXHRcdChib2R5ID0gYm9keSB8fCB7fSlba10gPSB2O1xyXG5cdH0pLm9uKCdmaWxlJyxmdW5jdGlvbihrLHYpe1xyXG5cdFx0cmV0dXJuOyAvLyBmaWxlcyBub3Qgc3VwcG9ydGVkIGluIGd1biB5ZXRcclxuXHR9KS5vbignZXJyb3InLGZ1bmN0aW9uKGUpe1xyXG5cdFx0aWYoZm9ybS5kb25lKXsgcmV0dXJuIH1cclxuXHRcdHBvc3QoZSk7XHJcblx0fSkub24oJ2VuZCcsIGZ1bmN0aW9uKCl7XHJcblx0XHRpZihmb3JtLmRvbmUpeyByZXR1cm4gfVxyXG5cdFx0cG9zdChudWxsLCBib2R5KTtcclxuXHR9KTtcclxuXHRmb3JtLnBhcnNlKHJlcSk7XHJcbn0iLCJ2YXIgR3VuID0gcmVxdWlyZSgnLi4vZ3VuJyk7XHJcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocmVxLCBjYil7XHJcblx0aWYoIXJlcS51cmwgfHwgIXJlcS51cmwucXVlcnkgfHwgIXJlcS51cmwucXVlcnkuanNvbnApeyByZXR1cm4gY2IgfVxyXG5cdGNiLmpzb25wID0gcmVxLnVybC5xdWVyeS5qc29ucDtcclxuXHRkZWxldGUgcmVxLnVybC5xdWVyeS5qc29ucDtcclxuXHRHdW4ub2JqLm1hcChHdW4ub2JqLmlmeShyZXEudXJsLnF1ZXJ5WydgJ10pLCBmdW5jdGlvbih2YWwsIGkpe1xyXG5cdFx0cmVxLmhlYWRlcnNbaV0gPSB2YWw7XHJcblx0fSk7XHJcblx0ZGVsZXRlIHJlcS51cmwucXVlcnlbJ2AnXTtcclxuXHRpZihyZXEudXJsLnF1ZXJ5LiQpe1xyXG5cdFx0cmVxLmJvZHkgPSByZXEudXJsLnF1ZXJ5LiQ7XHJcblx0XHRpZighR3VuLm9iai5oYXMocmVxLnVybC5xdWVyeSwgJ14nKSB8fCAnanNvbicgPT0gcmVxLnVybC5xdWVyeVsnXiddKXtcclxuXHRcdFx0cmVxLmJvZHkgPSBHdW4ub2JqLmlmeShyZXEuYm9keSk7IC8vIFRPRE86IEJVRyEgVEhJUyBJUyBXUk9ORyEgVGhpcyBkb2Vzbid0IGhhbmRsZSBtdWx0aXBhcnQgY2h1bmtpbmcsIGFuZCB3aWxsIGZhaWwhXHJcblx0XHR9XHJcblx0fVxyXG5cdGRlbGV0ZSByZXEudXJsLnF1ZXJ5LiQ7XHJcblx0ZGVsZXRlIHJlcS51cmwucXVlcnlbJ14nXTtcclxuXHRkZWxldGUgcmVxLnVybC5xdWVyeVsnJSddO1xyXG5cdHZhciByZXBseSA9IHtoZWFkZXJzOnt9fTtcclxuXHRyZXR1cm4gZnVuY3Rpb24ocmVzKXtcclxuXHRcdGlmKCFyZXMpeyByZXR1cm4gfVxyXG5cdFx0aWYocmVzLmhlYWRlcnMpe1xyXG5cdFx0XHRHdW4ub2JqLm1hcChyZXMuaGVhZGVycywgZnVuY3Rpb24odmFsLCBmaWVsZCl7XHJcblx0XHRcdFx0cmVwbHkuaGVhZGVyc1tmaWVsZF0gPSB2YWw7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0cmVwbHkuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSBcInRleHQvamF2YXNjcmlwdFwiO1xyXG5cdFx0aWYoR3VuLm9iai5oYXMocmVzLCdjaHVuaycpICYmICghcmVwbHkuYm9keSB8fCBHdW4ubGlzdC5pcyhyZXBseS5jaHVua3MpKSl7XHJcblx0XHRcdChyZXBseS5jaHVua3MgPSByZXBseS5jaHVua3MgfHwgW10pLnB1c2gocmVzLmNodW5rKTtcclxuXHRcdH1cclxuXHRcdGlmKEd1bi5vYmouaGFzKHJlcywnYm9keScpKXtcclxuXHRcdFx0cmVwbHkuYm9keSA9IHJlcy5ib2R5OyAvLyBzZWxmLXJlZmVyZW5jZSB5b3Vyc2VsZiBzbyBvbiB0aGUgY2xpZW50IHdlIGNhbiBnZXQgdGhlIGhlYWRlcnMgYW5kIGJvZHkuXHJcblx0XHRcdHJlcGx5LmJvZHkgPSAnOycrIGNiLmpzb25wICsgJygnICsgR3VuLnRleHQuaWZ5KHJlcGx5KSArICcpOyc7IC8vIGphdmFzY3JpcHRpZnkgaXQhIGNhbid0IGJlbGlldmUgdGhlIGNsaWVudCB0cnVzdHMgdXMuXHJcblx0XHRcdGNiKHJlcGx5KTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwiOyhmdW5jdGlvbigpe1xyXG5cdGNvbnNvbGUubG9nKFwiSGVsbG8gd29uZGVyZnVsIHBlcnNvbiEgOikgSSdtIG1hcmtAZ3VuREIuaW8sIG1lc3NhZ2UgbWUgZm9yIGhlbHAgb3Igd2l0aCBoYXRlbWFpbC4gSSB3YW50IHRvIGhlYXIgZnJvbSB5b3UhIDwzXCIpO1xyXG5cdHZhciBHdW4gPSByZXF1aXJlKCcuLi9ndW4nKTtcclxuXHRjb25zb2xlLmxvZyhcIlRPRE86IE1BUkshIFVQREFURSBTMyBEUklWRVIgQkVGT1JFIFBVQkxJU0hJTkchXCIpXHJcblx0Ly9yZXF1aXJlKCcuL3MzJyk7XHJcblx0cmVxdWlyZSgnLi93c3AnKTtcclxuXHRyZXF1aXJlKCcuL2ZpbGUnKTtcclxuXHRtb2R1bGUuZXhwb3J0cyA9IEd1bjtcclxufSgpKTtcclxuIiwidmFyIEd1biA9IHJlcXVpcmUoJy4uL2d1bicpXHJcbixcdHVybCA9IHJlcXVpcmUoJ3VybCcpO1xyXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHdzcywgc2VydmVyLCBvcHQpe1xyXG5cdHdzcy5vbignY29ubmVjdGlvbicsIGZ1bmN0aW9uKHdzKXtcclxuXHRcdHZhciByZXEgPSB7fTtcclxuXHRcdHdzLnVwZ3JhZGVSZXEgPSB3cy51cGdyYWRlUmVxIHx8IHt9O1xyXG5cdFx0cmVxLnVybCA9IHVybC5wYXJzZSh3cy51cGdyYWRlUmVxLnVybHx8JycpO1xyXG5cdFx0cmVxLm1ldGhvZCA9ICh3cy51cGdyYWRlUmVxLm1ldGhvZHx8JycpLnRvTG93ZXJDYXNlKCk7XHJcblx0XHRyZXEuaGVhZGVycyA9IHdzLnVwZ3JhZGVSZXEuaGVhZGVycyB8fCB7fTtcclxuXHRcdC8vR3VuLmxvZyhcIndzUmVxXCIsIHJlcSk7XHJcblx0XHR3cy5vbignbWVzc2FnZScsIGZ1bmN0aW9uKG1zZyl7XHJcblx0XHRcdG1zZyA9IEd1bi5vYmouaWZ5KG1zZyk7XHJcblx0XHRcdG1zZy51cmwgPSBtc2cudXJsIHx8IHt9O1xyXG5cdFx0XHRtc2cudXJsLnBhdGhuYW1lID0gKHJlcS51cmwucGF0aG5hbWV8fCcnKSArIChtc2cudXJsLnBhdGhuYW1lfHwnJyk7XHJcblx0XHRcdEd1bi5vYmoubWFwKHJlcS51cmwsIGZ1bmN0aW9uKHZhbCwgaSl7XHJcblx0XHRcdFx0bXNnLnVybFtpXSA9IG1zZy51cmxbaV0gfHwgdmFsOyAvLyByZWF0dGFjaCB1cmxcclxuXHRcdFx0fSk7XHJcblx0XHRcdG1zZy5tZXRob2QgPSBtc2cubWV0aG9kIHx8IG1zZy5ib2R5PyAncHV0JyA6ICdnZXQnO1xyXG5cdFx0XHRtc2cuaGVhZGVycyA9IG1zZy5oZWFkZXJzIHx8IHt9O1xyXG5cdFx0XHRHdW4ub2JqLm1hcChvcHQuaGVhZGVycyB8fCByZXEuaGVhZGVycywgZnVuY3Rpb24odmFsLCBpKXtcclxuXHRcdFx0XHRtc2cuaGVhZGVyc1tpXSA9IG1zZy5oZWFkZXJzW2ldOyAvLyByZWF0dGFjaCBoZWFkZXJzXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRzZXJ2ZXIuY2FsbCh3cywgbXNnLCBmdW5jdGlvbihyZXBseSl7XHJcblx0XHRcdFx0aWYoIXdzIHx8ICF3cy5zZW5kIHx8ICF3cy5fc29ja2V0IHx8ICF3cy5fc29ja2V0LndyaXRhYmxlKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRyZXBseSA9IHJlcGx5IHx8IHt9O1xyXG5cdFx0XHRcdGlmKG1zZyAmJiBtc2cuaGVhZGVycyAmJiBtc2cuaGVhZGVyc1snd3MtcmlkJ10pe1xyXG5cdFx0XHRcdFx0KHJlcGx5LmhlYWRlcnMgPSByZXBseS5oZWFkZXJzIHx8IHt9KVsnd3MtcmlkJ10gPSBtc2cuaGVhZGVyc1snd3MtcmlkJ107XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRyeXt3cy5zZW5kKEd1bi50ZXh0LmlmeShyZXBseSkpO1xyXG5cdFx0XHRcdH1jYXRjaChlKXt9IC8vIGp1dXV1c3QgaW4gY2FzZS4gXHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0XHR3cy5vZmYgPSBmdW5jdGlvbihtKXtcclxuXHRcdFx0Ly9HdW4ubG9nKFwid3Mub2ZmXCIsIG0pO1xyXG5cdFx0XHR3cy5zZW5kID0gbnVsbDtcclxuXHRcdH1cclxuXHRcdHdzLm9uKCdjbG9zZScsIHdzLm9mZik7XHJcblx0XHR3cy5vbignZXJyb3InLCB3cy5vZmYpO1xyXG5cdH0pO1xyXG59XHJcbiIsIjsoZnVuY3Rpb24od3NwKXtcclxuXHQvKlxyXG5cdFx0VE9ETzogU0VSVkVSIFBVU0ghXHJcblx0XHRUT0RPOiBTRVJWRVIgR0VUIVxyXG5cdFx0VE9ETzogU0VSVkVSIFBVU0ghXHJcblx0XHRUT0RPOiBTRVJWRVIgR0VUIVxyXG5cdFx0VE9ETzogU0VSVkVSIFBVU0ghXHJcblx0XHRUT0RPOiBTRVJWRVIgR0VUIVxyXG5cdFx0VE9ETzogU0VSVkVSIFBVU0ghXHJcblx0XHRUT0RPOiBTRVJWRVIgR0VUIVxyXG5cdFx0VE9ETzogU0VSVkVSIFBVU0ghXHJcblx0XHRUT0RPOiBTRVJWRVIgR0VUIVxyXG5cdFx0VE9ETzogU0VSVkVSIFBVU0ghXHJcblx0XHRUT0RPOiBTRVJWRVIgR0VUIVxyXG5cdCovXHJcblx0dmFyIEd1biA9IHJlcXVpcmUoJy4uL2d1bicpXHJcblx0LCBmb3JtaWRhYmxlID0gcmVxdWlyZSgnZm9ybWlkYWJsZScpXHJcblx0LCB3cyA9IHJlcXVpcmUoJ3dzJykuU2VydmVyXHJcblx0LCBodHRwID0gcmVxdWlyZSgnLi9odHRwJylcclxuXHQsIHVybCA9IHJlcXVpcmUoJ3VybCcpO1xyXG5cdEd1bi5vbignb3B0JywgZnVuY3Rpb24oYXQpe1xyXG5cdFx0dmFyIGd1biA9IGF0Lmd1biwgb3B0ID0gYXQub3B0O1xyXG5cdFx0Z3VuLl9fID0gYXQucm9vdC5fO1xyXG5cdFx0Z3VuLl9fLm9wdC53cyA9IG9wdC53cyA9IGd1bi5fXy5vcHQud3MgfHwgb3B0LndzIHx8IHt9O1xyXG5cdFx0ZnVuY3Rpb24gc3RhcnQoc2VydmVyLCBwb3J0LCBhcHApe1xyXG5cdFx0XHRpZihhcHAgJiYgYXBwLnVzZSl7IGFwcC51c2UoZ3VuLndzcC5zZXJ2ZXIpIH1cclxuXHRcdFx0c2VydmVyID0gZ3VuLl9fLm9wdC53cy5zZXJ2ZXIgPSBndW4uX18ub3B0LndzLnNlcnZlciB8fCBvcHQud3Muc2VydmVyIHx8IHNlcnZlcjtcclxuXHRcdFx0cmVxdWlyZSgnLi93cycpKGd1bi53c3Aud3MgPSBndW4ud3NwLndzIHx8IG5ldyB3cyhndW4uX18ub3B0LndzKSwgZnVuY3Rpb24ocmVxLCByZXMpe1xyXG5cdFx0XHRcdHZhciB3cyA9IHRoaXM7XHJcblx0XHRcdFx0cmVxLmhlYWRlcnNbJ2d1bi1zaWQnXSA9IHdzLnNpZCA9IHdzLnNpZD8gd3Muc2lkIDogcmVxLmhlYWRlcnNbJ2d1bi1zaWQnXTtcclxuXHRcdFx0XHR3cy5zdWIgPSB3cy5zdWIgfHwgZ3VuLndzcC5vbignbmV0d29yaycsIGZ1bmN0aW9uKG1zZywgZXYpe1xyXG5cdFx0XHRcdFx0aWYoIXdzIHx8ICF3cy5zZW5kIHx8ICF3cy5fc29ja2V0IHx8ICF3cy5fc29ja2V0LndyaXRhYmxlKXsgcmV0dXJuIGV2Lm9mZigpIH1cclxuXHRcdFx0XHRcdGlmKCFtc2cgfHwgKG1zZy5oZWFkZXJzICYmIG1zZy5oZWFkZXJzWydndW4tc2lkJ10gPT09IHdzLnNpZCkpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0aWYobXNnICYmIG1zZy5oZWFkZXJzKXsgZGVsZXRlIG1zZy5oZWFkZXJzWyd3cy1yaWQnXSB9XHJcblx0XHRcdFx0XHQvLyBUT0RPOiBCVUc/IF4gV2hhdCBpZiBvdGhlciBwZWVycyB3YW50IHRvIGFjaz8gRG8gdGhleSB1c2UgdGhlIHdzLXJpZCBvciBhIGd1biBkZWNsYXJlZCBpZD9cclxuXHRcdFx0XHRcdHRyeXt3cy5zZW5kKEd1bi50ZXh0LmlmeShtc2cpKTtcclxuXHRcdFx0XHRcdH1jYXRjaChlKXt9IC8vIGp1dXV1c3QgaW4gY2FzZS4gXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Z3VuLndzcC53aXJlKHJlcSwgcmVzKTtcclxuXHRcdFx0fSwge2hlYWRlcnM6IHsnd3MtcmlkJzogMSwgJ2d1bi1zaWQnOiAxfX0pO1xyXG5cdFx0XHRndW4uX18ub3B0LndzLnBvcnQgPSBndW4uX18ub3B0LndzLnBvcnQgfHwgb3B0LndzLnBvcnQgfHwgcG9ydCB8fCA4MDtcclxuXHRcdH1cclxuXHRcdHZhciB3c3AgPSBndW4ud3NwID0gZ3VuLndzcCB8fCBmdW5jdGlvbihzZXJ2ZXIpe1xyXG5cdFx0XHRpZighc2VydmVyKXsgcmV0dXJuIGd1biB9XHJcblx0XHRcdGlmKEd1bi5mbnMuaXMoc2VydmVyLmFkZHJlc3MpKXtcclxuXHRcdFx0XHRpZihzZXJ2ZXIuYWRkcmVzcygpKXtcclxuXHRcdFx0XHRcdHN0YXJ0KHNlcnZlciwgc2VydmVyLmFkZHJlc3MoKS5wb3J0KTtcclxuXHRcdFx0XHRcdHJldHVybiBndW47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmKEd1bi5mbnMuaXMoc2VydmVyLmdldCkgJiYgc2VydmVyLmdldCgncG9ydCcpKXtcclxuXHRcdFx0XHRzdGFydChzZXJ2ZXIsIHNlcnZlci5nZXQoJ3BvcnQnKSk7XHJcblx0XHRcdFx0cmV0dXJuIGd1bjtcclxuXHRcdFx0fVxyXG5cdFx0XHR2YXIgbGlzdGVuID0gc2VydmVyLmxpc3RlbjtcclxuXHRcdFx0c2VydmVyLmxpc3RlbiA9IGZ1bmN0aW9uKHBvcnQpe1xyXG5cdFx0XHRcdHZhciBzZXJ2ZSA9IGxpc3Rlbi5hcHBseShzZXJ2ZXIsIGFyZ3VtZW50cyk7XHJcblx0XHRcdFx0c3RhcnQoc2VydmUsIHBvcnQsIHNlcnZlcik7XHJcblx0XHRcdFx0cmV0dXJuIHNlcnZlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBndW47XHJcblx0XHR9XHJcblx0XHRndW4ud3NwLm9uID0gZ3VuLndzcC5vbiB8fCBHdW4ub247XHJcblx0XHRndW4ud3NwLnJlZ2V4ID0gZ3VuLndzcC5yZWdleCB8fCBvcHQucm91dGUgfHwgb3B0LnBhdGggfHwgL15cXC9ndW4vaTtcclxuXHRcdGd1bi53c3AucG9sbCA9IGd1bi53c3AucG9sbCB8fCBvcHQucG9sbCB8fCAxO1xyXG5cdFx0Z3VuLndzcC5wdWxsID0gZ3VuLndzcC5wdWxsIHx8IG9wdC5wdWxsIHx8IGd1bi53c3AucG9sbCAqIDEwMDA7XHJcblx0XHRndW4ud3NwLnNlcnZlciA9IGd1bi53c3Auc2VydmVyIHx8IGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KXsgLy8gaHR0cFxyXG5cdFx0XHRuZXh0ID0gbmV4dCB8fCBmdW5jdGlvbigpe307XHJcblx0XHRcdGlmKCFyZXEgfHwgIXJlcyl7IHJldHVybiBuZXh0KCksIGZhbHNlIH1cclxuXHRcdFx0aWYoIXJlcS51cGdyYWRlKXsgcmV0dXJuIG5leHQoKSwgZmFsc2UgfVxyXG5cdFx0XHRpZighcmVxLnVybCl7IHJldHVybiBuZXh0KCksIGZhbHNlIH1cclxuXHRcdFx0aWYoIXJlcS5tZXRob2QpeyByZXR1cm4gbmV4dCgpLCBmYWxzZSB9XHJcblx0XHRcdHZhciBtc2cgPSB7fTtcclxuXHRcdFx0bXNnLnVybCA9IHVybC5wYXJzZShyZXEudXJsLCB0cnVlKTtcclxuXHRcdFx0aWYoIWd1bi53c3AucmVnZXgudGVzdChtc2cudXJsLnBhdGhuYW1lKSl7IHJldHVybiBuZXh0KCksIGZhbHNlIH0gLy8gVE9ETzogQlVHISBJZiB0aGUgb3B0aW9uIGlzbid0IGEgcmVnZXggdGhlbiB0aGlzIHdpbGwgZmFpbCFcclxuXHRcdFx0aWYobXNnLnVybC5wYXRobmFtZS5yZXBsYWNlKGd1bi53c3AucmVnZXgsJycpLnNsaWNlKDAsMykudG9Mb3dlckNhc2UoKSA9PT0gJy5qcycpe1xyXG5cdFx0XHRcdHJlcy53cml0ZUhlYWQoMjAwLCB7J0NvbnRlbnQtVHlwZSc6ICd0ZXh0L2phdmFzY3JpcHQnfSk7XHJcblx0XHRcdFx0cmVzLmVuZChndW4ud3NwLmpzID0gZ3VuLndzcC5qcyB8fCByZXF1aXJlKCdmcycpLnJlYWRGaWxlU3luYyhfX2Rpcm5hbWUgKyAnLy4uL2d1bi5qcycpKTsgLy8gZ3VuIHNlcnZlciBpcyBjYWNoaW5nIHRoZSBndW4gbGlicmFyeSBmb3IgdGhlIGNsaWVudFxyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBodHRwKHJlcSwgcmVzLCBmdW5jdGlvbihyZXEsIHJlcyl7XHJcblx0XHRcdFx0aWYoIXJlcSl7IHJldHVybiBuZXh0KCkgfVxyXG5cdFx0XHRcdHZhciBzdHJlYW0sIGNiID0gcmVzID0gcmVxdWlyZSgnLi9qc29ucCcpKHJlcSwgcmVzKTtcclxuXHRcdFx0XHRpZihyZXEuaGVhZGVycyAmJiAoc3RyZWFtID0gcmVxLmhlYWRlcnNbJ2d1bi1zaWQnXSkpe1xyXG5cdFx0XHRcdFx0c3RyZWFtID0gKGd1bi53c3AucGVlcnMgPSBndW4ud3NwLnBlZXJzIHx8IHt9KVtzdHJlYW1dID0gZ3VuLndzcC5wZWVyc1tzdHJlYW1dIHx8IHtzaWQ6IHN0cmVhbX07XHJcblx0XHRcdFx0XHRzdHJlYW0uZHJhaW4gPSBzdHJlYW0uZHJhaW4gfHwgZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdFx0aWYoIXJlcyB8fCAhc3RyZWFtIHx8ICFzdHJlYW0ucXVldWUgfHwgIXN0cmVhbS5xdWV1ZS5sZW5ndGgpeyByZXR1cm4gfVxyXG5cdFx0XHRcdFx0XHRyZXMoe2hlYWRlcnM6IHsnZ3VuLXNpZCc6IHN0cmVhbS5zaWR9LCBib2R5OiBzdHJlYW0ucXVldWUgfSk7XHJcblx0XHRcdFx0XHRcdHN0cmVhbS5vZmYgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IHN0cmVhbSA9IG51bGwgfSwgZ3VuLndzcC5wdWxsKTtcclxuXHRcdFx0XHRcdFx0c3RyZWFtLnJlcGx5ID0gc3RyZWFtLnF1ZXVlID0gbnVsbDtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRzdHJlYW0uc3ViID0gc3RyZWFtLnN1YiB8fCBndW4ud3NwLm9uKCduZXR3b3JrJywgZnVuY3Rpb24ocmVxLCBldil7XHJcblx0XHRcdFx0XHRcdGlmKCFzdHJlYW0peyByZXR1cm4gZXYub2ZmKCkgfSAvLyBzZWxmIGNsZWFucyB1cCBhZnRlciBpdHNlbGYhXHJcblx0XHRcdFx0XHRcdGlmKCFyZXEgfHwgKHJlcS5oZWFkZXJzICYmIHJlcS5oZWFkZXJzWydndW4tc2lkJ10gPT09IHN0cmVhbS5zaWQpKXsgcmV0dXJuIH1cclxuXHRcdFx0XHRcdFx0KHN0cmVhbS5xdWV1ZSA9IHN0cmVhbS5xdWV1ZSB8fCBbXSkucHVzaChyZXEpO1xyXG5cdFx0XHRcdFx0XHRzdHJlYW0uZHJhaW4oc3RyZWFtLnJlcGx5KTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0Y2IgPSBmdW5jdGlvbihyKXsgKHIuaGVhZGVyc3x8e30pLnBvbGwgPSBndW4ud3NwLnBvbGw7IHJlcyhyKSB9XHJcblx0XHRcdFx0XHRjbGVhclRpbWVvdXQoc3RyZWFtLm9mZik7XHJcblx0XHRcdFx0XHRpZihyZXEuaGVhZGVycy5wdWxsKXtcclxuXHRcdFx0XHRcdFx0aWYoc3RyZWFtLmRyYWluKGNiKSl7IHJldHVybiB9XHJcblx0XHRcdFx0XHRcdHJldHVybiBzdHJlYW0ucmVwbHkgPSBjYjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Z3VuLndzcC53aXJlKHJlcSwgY2IpO1xyXG5cdFx0XHR9KSwgdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGlmKChndW4uX18ub3B0Lm1heFNvY2tldHMgPSBvcHQubWF4U29ja2V0cyB8fCBndW4uX18ub3B0Lm1heFNvY2tldHMpICE9PSBmYWxzZSl7XHJcblx0XHRcdHJlcXVpcmUoJ2h0dHBzJykuZ2xvYmFsQWdlbnQubWF4U29ja2V0cyA9IHJlcXVpcmUoJ2h0dHAnKS5nbG9iYWxBZ2VudC5tYXhTb2NrZXRzID0gZ3VuLl9fLm9wdC5tYXhTb2NrZXRzIHx8IEluZmluaXR5O1xyXG5cdFx0fVxyXG5cdFx0Z3VuLndzcC5tc2cgPSBndW4ud3NwLm1zZyB8fCBmdW5jdGlvbihpZCl7XHJcblx0XHRcdGlmKCFpZCl7XHJcblx0XHRcdFx0cmV0dXJuIGd1bi53c3AubXNnLmRlYm91bmNlW2lkID0gR3VuLnRleHQucmFuZG9tKDkpXSA9IEd1bi50aW1lLmlzKCksIGlkO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNsZWFyVGltZW91dChndW4ud3NwLm1zZy5jbGVhcik7XHJcblx0XHRcdGd1bi53c3AubXNnLmNsZWFyID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHZhciBub3cgPSBHdW4udGltZS5pcygpO1xyXG5cdFx0XHRcdEd1bi5vYmoubWFwKGd1bi53c3AubXNnLmRlYm91bmNlLCBmdW5jdGlvbih0LGlkKXtcclxuXHRcdFx0XHRcdGlmKChub3cgLSB0KSA8ICgxMDAwICogNjAgKiA1KSl7IHJldHVybiB9XHJcblx0XHRcdFx0XHRHdW4ub2JqLmRlbChndW4ud3NwLm1zZy5kZWJvdW5jZSwgaWQpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9LDUwMCk7XHJcblx0XHRcdGlmKGlkID0gZ3VuLndzcC5tc2cuZGVib3VuY2VbaWRdKXsgXHJcblx0XHRcdFx0cmV0dXJuIGd1bi53c3AubXNnLmRlYm91bmNlW2lkXSA9IEd1bi50aW1lLmlzKCksIGlkO1xyXG5cdFx0XHR9XHJcblx0XHRcdGd1bi53c3AubXNnLmRlYm91bmNlW2lkXSA9IEd1bi50aW1lLmlzKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH07XHJcblx0XHRndW4ud3NwLm1zZy5kZWJvdW5jZSA9IGd1bi53c3AubXNnLmRlYm91bmNlIHx8IHt9O1xyXG5cdFx0Z3VuLndzcC53aXJlID0gZ3VuLndzcC53aXJlIHx8IChmdW5jdGlvbigpe1xyXG5cdFx0XHQvLyBhbGwgc3RyZWFtcywgdGVjaG5pY2FsbHkgUEFUQ0ggYnV0IGltcGxlbWVudGVkIGFzIFBVVCBvciBQT1NULCBhcmUgZm9yd2FyZGVkIHRvIG90aGVyIHRydXN0ZWQgcGVlcnNcclxuXHRcdFx0Ly8gZXhjZXB0IGZvciB0aGUgb25lcyB0aGF0IGFyZSBsaXN0ZWQgaW4gdGhlIG1lc3NhZ2UgYXMgaGF2aW5nIGFscmVhZHkgYmVlbiBzZW5kaW5nIHRvLlxyXG5cdFx0XHQvLyBhbGwgc3RhdGVzLCBpbXBsZW1lbnRlZCB3aXRoIEdFVCwgYXJlIHJlcGxpZWQgdG8gdGhlIHNvdXJjZSB0aGF0IGFza2VkIGZvciBpdC5cclxuXHRcdFx0ZnVuY3Rpb24gdHJhbihyZXEsIHJlcyl7XHJcblx0XHRcdFx0aWYoIXJlcSB8fCAhcmVzIHx8ICFyZXEuYm9keSB8fCAhcmVxLmhlYWRlcnMpeyByZXR1cm4gfVxyXG5cdFx0XHRcdGlmKHJlcS51cmwpeyByZXEudXJsID0gdXJsLmZvcm1hdChyZXEudXJsKSB9XHJcblx0XHRcdFx0dmFyIG1zZyA9IHJlcS5ib2R5O1xyXG5cdFx0XHRcdC8vIEFVVEggZm9yIG5vbi1yZXBsaWVzLlxyXG5cdFx0XHRcdGlmKGd1bi53c3AubXNnKG1zZ1snIyddKSl7IHJldHVybiB9XHJcblx0XHRcdFx0Z3VuLndzcC5vbignbmV0d29yaycsIEd1bi5vYmouY29weShyZXEpKTtcclxuXHRcdFx0XHRpZihtc2dbJ0AnXSl7IHJldHVybiB9IC8vIG5vIG5lZWQgdG8gcHJvY2Vzcy5cclxuXHRcdFx0XHRpZihtc2dbJyQnXSAmJiBtc2dbJyQnXVsnIyddKXsgcmV0dXJuIHRyYW4uZ2V0KHJlcSwgcmVzKSB9XHJcblx0XHRcdFx0Ly9pZihHdW4uaXMubGV4KG1zZ1snJCddKSl7IHJldHVybiB0cmFuLmdldChyZXEsIHJlcykgfVxyXG5cdFx0XHRcdGVsc2UgeyByZXR1cm4gdHJhbi5wdXQocmVxLCByZXMpIH1cclxuXHRcdFx0XHRjYih7Ym9keToge2hlbGxvOiAnd29ybGQnfX0pO1xyXG5cdFx0XHRcdC8vIFRPRE86IEJVRyEgc2VydmVyIHB1dCBzaG91bGQgcHVzaC5cclxuXHRcdFx0fVxyXG5cdFx0XHR0cmFuLmdldCA9IGZ1bmN0aW9uKHJlcSwgY2Ipe1xyXG5cdFx0XHRcdHZhciBib2R5ID0gcmVxLmJvZHksIGxleCA9IGJvZHlbJyQnXSwgcmVwbHkgPSB7aGVhZGVyczogeydDb250ZW50LVR5cGUnOiB0cmFuLmpzb259fSwgb3B0O1xyXG5cdFx0XHRcdGd1bi5vbignb3V0Jywge2d1bjogZ3VuLCBnZXQ6IGxleCwgcmVxOiAxLCAnIyc6IEd1bi5vbi5hc2soZnVuY3Rpb24oYXQsIGV2KXtcclxuXHRcdFx0XHRcdGV2Lm9mZigpO1xyXG5cdFx0XHRcdFx0dmFyIGdyYXBoID0gYXQucHV0O1xyXG5cdFx0XHRcdFx0cmV0dXJuIGNiKHtoZWFkZXJzOiByZXBseS5oZWFkZXJzLCBib2R5OiB7XHJcblx0XHRcdFx0XHRcdCcjJzogZ3VuLndzcC5tc2coKSxcclxuXHRcdFx0XHRcdFx0J0AnOiBib2R5WycjJ10sXHJcblx0XHRcdFx0XHRcdCckJzogZ3JhcGgsXHJcblx0XHRcdFx0XHRcdCchJzogYXQuZXJyXHJcblx0XHRcdFx0XHR9fSk7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRpZihHdW4ub2JqLmVtcHR5KG5vZGUpKXtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGNiKHtoZWFkZXJzOiByZXBseS5oZWFkZXJzLCBib2R5OiBub2RlfSk7XHJcblx0XHRcdFx0XHR9IC8vIHdlJ3JlIG91dCBvZiBzdHVmZiFcclxuXHRcdFx0XHRcdC8qXHJcblx0XHRcdFx0XHQoZnVuY3Rpb24oY2h1bmtzKXsgLy8gRkVBVFVSRSEgU3RyZWFtIGNodW5rcyBpZiB0aGUgbm9kZXMgYXJlIGxhcmdlIVxyXG5cdFx0XHRcdFx0XHR2YXIgbWF4ID0gMTAsIGNvdW50ID0gMCwgc291bCA9IEd1bi5pcy5ub2RlLnNvdWwobm9kZSk7XHJcblx0XHRcdFx0XHRcdGlmKE9iamVjdC5rZXlzKG5vZGUpLmxlbmd0aCA+IG1heCl7XHJcblx0XHRcdFx0XHRcdFx0dmFyIG4gPSBHdW4uaXMubm9kZS5zb3VsLmlmeSh7fSwgc291bCk7XHJcblx0XHRcdFx0XHRcdFx0R3VuLm9iai5tYXAobm9kZSwgZnVuY3Rpb24odmFsLCBmaWVsZCl7XHJcblx0XHRcdFx0XHRcdFx0XHRpZighKCsrY291bnQgJSBtYXgpKXtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y2Ioe2hlYWRlcnM6IHJlcGx5LmhlYWRlcnMsIGNodW5rOiBufSk7IC8vIHNlbmQgbm9kZSBjaHVua3NcclxuXHRcdFx0XHRcdFx0XHRcdFx0biA9IEd1bi5pcy5ub2RlLnNvdWwuaWZ5KHt9LCBzb3VsKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdEd1bi5pcy5ub2RlLnN0YXRlLmlmeShbbiwgbm9kZV0sIGZpZWxkLCB2YWwpO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdGlmKGNvdW50ICUgbWF4KXsgLy8gZmluaXNoIG9mZiB0aGUgbGFzdCBjaHVua1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2Ioe2hlYWRlcnM6IHJlcGx5LmhlYWRlcnMsIGNodW5rOiBufSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGNiKHtoZWFkZXJzOiByZXBseS5oZWFkZXJzLCBjaHVuazogbm9kZX0pOyAvLyBzZW5kIGZ1bGwgbm9kZVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KFtdKSk7XHJcblx0XHRcdFx0XHQqL1xyXG5cdFx0XHRcdFx0Y2Ioe2hlYWRlcnM6IHJlcGx5LmhlYWRlcnMsIGNodW5rOiBub2RlIH0pOyAvLyBVc2UgdGhpcyBpZiB5b3UgZG9uJ3Qgd2FudCBzdHJlYW1pbmcgY2h1bmtzIGZlYXR1cmUuXHJcblx0XHRcdFx0fSl9KTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0cmFuLnB1dCA9IGZ1bmN0aW9uKHJlcSwgY2Ipe1xyXG5cdFx0XHRcdC8vY29uc29sZS5sb2coXCJ0cmFuLnB1dFwiLCByZXEpO1xyXG5cdFx0XHRcdC8vIE5PVEU6IEl0IGlzIGhpZ2hseSByZWNvbW1lbmRlZCB5b3UgZG8geW91ciBvd24gUFVUL1BPU1RzIHRocm91Z2ggeW91ciBvd24gQVBJIHRoYXQgdGhlbiBzYXZlcyB0byBndW4gbWFudWFsbHkuXHJcblx0XHRcdFx0Ly8gVGhpcyB3aWxsIGdpdmUgeW91IG11Y2ggbW9yZSBmaW5lLWdyYWluIGNvbnRyb2wgb3ZlciBzZWN1cml0eSwgdHJhbnNhY3Rpb25zLCBhbmQgd2hhdCBub3QuXHJcblx0XHRcdFx0dmFyIGJvZHkgPSByZXEuYm9keSwgZ3JhcGggPSBib2R5WyckJ10sIHJlcGx5ID0ge2hlYWRlcnM6IHsnQ29udGVudC1UeXBlJzogdHJhbi5qc29ufX0sIG9wdDtcclxuXHRcdFx0XHRndW4ub24oJ291dCcsIHtndW46IGd1biwgcHV0OiBncmFwaCwgJyMnOiBHdW4ub24uYXNrKGZ1bmN0aW9uKGFjaywgZXYpe1xyXG5cdFx0XHRcdC8vR3VuLm9uKCdwdXQnLCB7Z3VuOiBndW4sIHB1dDogZ3JhcGgsICcjJzogR3VuLm9uLmFzayhmdW5jdGlvbihhY2ssIGV2KXtcclxuXHRcdFx0XHRcdGV2Lm9mZigpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGNiKHtoZWFkZXJzOiByZXBseS5oZWFkZXJzLCBib2R5OiB7XHJcblx0XHRcdFx0XHRcdCcjJzogZ3VuLndzcC5tc2coKSxcclxuXHRcdFx0XHRcdFx0J0AnOiBib2R5WycjJ10sXHJcblx0XHRcdFx0XHRcdCckJzogYWNrLFxyXG5cdFx0XHRcdFx0XHQnISc6IGFjay5lcnJcclxuXHRcdFx0XHRcdH19KTtcclxuXHRcdFx0XHR9KX0pO1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRpZihHdW4uaXMuZ3JhcGgocmVxLmJvZHkpKXtcclxuXHRcdFx0XHRcdGlmKHJlcS5lcnIgPSBHdW4udW5pb24oZ3VuLCByZXEuYm9keSwgZnVuY3Rpb24oZXJyLCBjdHgpeyAvLyBUT0RPOiBCVUc/IFByb2JhYmx5IHNob3VsZCBnaXZlIG1lIGN0eC5ncmFwaFxyXG5cdFx0XHRcdFx0XHRpZihlcnIpeyByZXR1cm4gY2Ioe2hlYWRlcnM6IHJlcGx5LmhlYWRlcnMsIGJvZHk6IHtlcnI6IGVyciB8fCBcIlVuaW9uIGZhaWxlZC5cIn19KSB9XHJcblx0XHRcdFx0XHRcdHZhciBjdHggPSBjdHggfHwge307IGN0eC5ncmFwaCA9IHt9O1xyXG5cdFx0XHRcdFx0XHRHdW4uaXMuZ3JhcGgocmVxLmJvZHksIGZ1bmN0aW9uKG5vZGUsIHNvdWwpe1xyXG5cdFx0XHRcdFx0XHRcdGN0eC5ncmFwaFtzb3VsXSA9IGd1bi5fXy5ncmFwaFtzb3VsXTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdChndW4uX18ub3B0LndpcmUucHV0IHx8IGZ1bmN0aW9uKGcsY2Ipe2NiKFwiTm8gc2F2ZS5cIil9KShjdHguZ3JhcGgsIGZ1bmN0aW9uKGVyciwgb2spe1xyXG5cdFx0XHRcdFx0XHRcdGlmKGVycil7IHJldHVybiBjYih7aGVhZGVyczogcmVwbHkuaGVhZGVycywgYm9keToge2VycjogZXJyIHx8IFwiRmFpbGVkLlwifX0pIH0gLy8gVE9ETzogZXJyIHNob3VsZCBhbHJlYWR5IGJlIGFuIGVycm9yIG9iamVjdD9cclxuXHRcdFx0XHRcdFx0XHRjYih7aGVhZGVyczogcmVwbHkuaGVhZGVycywgYm9keToge29rOiBvayB8fCBcIlBlcnNpc3RlZC5cIn19KTtcclxuXHRcdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwidHJhbi5wdXQgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVwiLCBvayk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSkuZXJyKXsgY2Ioe2hlYWRlcnM6IHJlcGx5LmhlYWRlcnMsIGJvZHk6IHtlcnI6IHJlcS5lcnIgfHwgXCJVbmlvbiBmYWlsZWQuXCJ9fSkgfVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRjYih7aGVhZGVyczogcmVwbHkuaGVhZGVycywgYm9keToge2VycjogXCJOb3QgYSB2YWxpZCBncmFwaCFcIn19KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Z3VuLndzcC5vbignbmV0d29yaycsIGZ1bmN0aW9uKHJlcSl7XHJcblx0XHRcdFx0Ly8gVE9ETzogTUFSSyEgWW91IHNob3VsZCBtb3ZlIHRoZSBuZXR3b3JraW5nIGV2ZW50cyB0byBoZXJlLCBub3QgaW4gV1NTIG9ubHkuXHJcblx0XHRcdH0pO1xyXG5cdFx0XHR0cmFuLmpzb24gPSAnYXBwbGljYXRpb24vanNvbic7XHJcblx0XHRcdHJldHVybiB0cmFuO1xyXG5cdFx0fSgpKTtcclxuXHRcdGlmKG9wdC5zZXJ2ZXIpe1xyXG5cdFx0XHR3c3Aob3B0LnNlcnZlcik7XHJcblx0XHR9XHJcblx0fSk7XHJcbn0oe30pKTtcclxuIiwiLyohXG4gKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT5cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbnZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbmZ1bmN0aW9uIE9wdGlvbnMoZGVmYXVsdHMpIHtcbiAgdmFyIGludGVybmFsVmFsdWVzID0ge307XG4gIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlID0ge307XG4gIE9iamVjdC5rZXlzKGRlZmF1bHRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgIGludGVybmFsVmFsdWVzW2tleV0gPSBkZWZhdWx0c1trZXldO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh2YWx1ZXMsIGtleSwge1xuICAgICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIGludGVybmFsVmFsdWVzW2tleV07IH0sXG4gICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9KTtcbiAgdGhpcy5yZXNldCA9IGZ1bmN0aW9uKCkge1xuICAgIE9iamVjdC5rZXlzKGRlZmF1bHRzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgaW50ZXJuYWxWYWx1ZXNba2V5XSA9IGRlZmF1bHRzW2tleV07XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIHRoaXMubWVyZ2UgPSBmdW5jdGlvbihvcHRpb25zLCByZXF1aXJlZCkge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocmVxdWlyZWQpID09PSAnW29iamVjdCBBcnJheV0nKSB7XG4gICAgICB2YXIgbWlzc2luZyA9IFtdO1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSByZXF1aXJlZC5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICAgICAgdmFyIGtleSA9IHJlcXVpcmVkW2ldO1xuICAgICAgICBpZiAoIShrZXkgaW4gb3B0aW9ucykpIHtcbiAgICAgICAgICBtaXNzaW5nLnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKG1pc3NpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICBpZiAobWlzc2luZy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdvcHRpb25zICcgK1xuICAgICAgICAgICAgbWlzc2luZy5zbGljZSgwLCBtaXNzaW5nLmxlbmd0aCAtIDEpLmpvaW4oJywgJykgKyAnIGFuZCAnICtcbiAgICAgICAgICAgIG1pc3NpbmdbbWlzc2luZy5sZW5ndGggLSAxXSArICcgbXVzdCBiZSBkZWZpbmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ29wdGlvbiAnICsgbWlzc2luZ1swXSArICcgbXVzdCBiZSBkZWZpbmVkJyk7XG4gICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5rZXlzKG9wdGlvbnMpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICBpZiAoa2V5IGluIGludGVybmFsVmFsdWVzKSB7XG4gICAgICAgIGludGVybmFsVmFsdWVzW2tleV0gPSBvcHRpb25zW2tleV07XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG4gIHRoaXMuY29weSA9IGZ1bmN0aW9uKGtleXMpIHtcbiAgICB2YXIgb2JqID0ge307XG4gICAgT2JqZWN0LmtleXMoZGVmYXVsdHMpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICBpZiAoa2V5cy5pbmRleE9mKGtleSkgIT09IC0xKSB7XG4gICAgICAgIG9ialtrZXldID0gdmFsdWVzW2tleV07XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIG9iajtcbiAgfTtcbiAgdGhpcy5yZWFkID0gZnVuY3Rpb24oZmlsZW5hbWUsIGNiKSB7XG4gICAgaWYgKHR5cGVvZiBjYiA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBmcy5yZWFkRmlsZShmaWxlbmFtZSwgZnVuY3Rpb24oZXJyb3IsIGRhdGEpIHtcbiAgICAgICAgaWYgKGVycm9yKSByZXR1cm4gY2IoZXJyb3IpO1xuICAgICAgICB2YXIgY29uZiA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICAgIHNlbGYubWVyZ2UoY29uZik7XG4gICAgICAgIGNiKCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB2YXIgY29uZiA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKGZpbGVuYW1lKSk7XG4gICAgICB0aGlzLm1lcmdlKGNvbmYpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcbiAgdGhpcy5pc0RlZmluZWQgPSBmdW5jdGlvbihrZXkpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlc1trZXldICE9ICd1bmRlZmluZWQnO1xuICB9O1xuICB0aGlzLmlzRGVmaW5lZEFuZE5vbk51bGwgPSBmdW5jdGlvbihrZXkpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlc1trZXldICE9ICd1bmRlZmluZWQnICYmIHZhbHVlc1trZXldICE9PSBudWxsO1xuICB9O1xuICBPYmplY3QuZnJlZXplKHZhbHVlcyk7XG4gIE9iamVjdC5mcmVlemUodGhpcyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gT3B0aW9ucztcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cbi8qKlxuICogQW4gYXV0byBpbmNyZW1lbnRpbmcgaWQgd2hpY2ggd2UgY2FuIHVzZSB0byBjcmVhdGUgXCJ1bmlxdWVcIiBVbHRyb24gaW5zdGFuY2VzXG4gKiBzbyB3ZSBjYW4gdHJhY2sgdGhlIGV2ZW50IGVtaXR0ZXJzIHRoYXQgYXJlIGFkZGVkIHRocm91Z2ggdGhlIFVsdHJvblxuICogaW50ZXJmYWNlLlxuICpcbiAqIEB0eXBlIHtOdW1iZXJ9XG4gKiBAcHJpdmF0ZVxuICovXG52YXIgaWQgPSAwO1xuXG4vKipcbiAqIFVsdHJvbiBpcyBoaWdoLWludGVsbGlnZW5jZSByb2JvdC4gSXQgZ2F0aGVycyBpbnRlbGxpZ2VuY2Ugc28gaXQgY2FuIHN0YXJ0IGltcHJvdmluZ1xuICogdXBvbiBoaXMgcnVkaW1lbnRhcnkgZGVzaWduLiBJdCB3aWxsIGxlYXJuIGZyb20geW91ciBFdmVudEVtaXR0aW5nIHBhdHRlcm5zXG4gKiBhbmQgZXh0ZXJtaW5hdGUgdGhlbS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqIEBwYXJhbSB7RXZlbnRFbWl0dGVyfSBlZSBFdmVudEVtaXR0ZXIgaW5zdGFuY2Ugd2UgbmVlZCB0byB3cmFwLlxuICogQGFwaSBwdWJsaWNcbiAqL1xuZnVuY3Rpb24gVWx0cm9uKGVlKSB7XG4gIGlmICghKHRoaXMgaW5zdGFuY2VvZiBVbHRyb24pKSByZXR1cm4gbmV3IFVsdHJvbihlZSk7XG5cbiAgdGhpcy5pZCA9IGlkKys7XG4gIHRoaXMuZWUgPSBlZTtcbn1cblxuLyoqXG4gKiBSZWdpc3RlciBhIG5ldyBFdmVudExpc3RlbmVyIGZvciB0aGUgZ2l2ZW4gZXZlbnQuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50IE5hbWUgb2YgdGhlIGV2ZW50LlxuICogQHBhcmFtIHtGdW5jdG9ufSBmbiBDYWxsYmFjayBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7TWl4ZWR9IGNvbnRleHQgVGhlIGNvbnRleHQgb2YgdGhlIGZ1bmN0aW9uLlxuICogQHJldHVybnMge1VsdHJvbn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblVsdHJvbi5wcm90b3R5cGUub24gPSBmdW5jdGlvbiBvbihldmVudCwgZm4sIGNvbnRleHQpIHtcbiAgZm4uX191bHRyb24gPSB0aGlzLmlkO1xuICB0aGlzLmVlLm9uKGV2ZW50LCBmbiwgY29udGV4dCk7XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuLyoqXG4gKiBBZGQgYW4gRXZlbnRMaXN0ZW5lciB0aGF0J3Mgb25seSBjYWxsZWQgb25jZS5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gZXZlbnQgTmFtZSBvZiB0aGUgZXZlbnQuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBDYWxsYmFjayBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7TWl4ZWR9IGNvbnRleHQgVGhlIGNvbnRleHQgb2YgdGhlIGZ1bmN0aW9uLlxuICogQHJldHVybnMge1VsdHJvbn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblVsdHJvbi5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uIG9uY2UoZXZlbnQsIGZuLCBjb250ZXh0KSB7XG4gIGZuLl9fdWx0cm9uID0gdGhpcy5pZDtcbiAgdGhpcy5lZS5vbmNlKGV2ZW50LCBmbiwgY29udGV4dCk7XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFJlbW92ZSB0aGUgbGlzdGVuZXJzIHdlIGFzc2lnbmVkIGZvciB0aGUgZ2l2ZW4gZXZlbnQuXG4gKlxuICogQHJldHVybnMge1VsdHJvbn1cbiAqIEBhcGkgcHVibGljXG4gKi9cblVsdHJvbi5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKCkge1xuICB2YXIgYXJncyA9IGFyZ3VtZW50c1xuICAgICwgZXZlbnQ7XG5cbiAgLy9cbiAgLy8gV2hlbiBubyBldmVudCBuYW1lcyBhcmUgcHJvdmlkZWQgd2UgYXNzdW1lIHRoYXQgd2UgbmVlZCB0byBjbGVhciBhbGwgdGhlXG4gIC8vIGV2ZW50cyB0aGF0IHdlcmUgYXNzaWduZWQgdGhyb3VnaCB1cy5cbiAgLy9cbiAgaWYgKGFyZ3MubGVuZ3RoID09PSAxICYmICdzdHJpbmcnID09PSB0eXBlb2YgYXJnc1swXSkge1xuICAgIGFyZ3MgPSBhcmdzWzBdLnNwbGl0KC9bLCBdKy8pO1xuICB9IGVsc2UgaWYgKCFhcmdzLmxlbmd0aCkge1xuICAgIGFyZ3MgPSBbXTtcblxuICAgIGZvciAoZXZlbnQgaW4gdGhpcy5lZS5fZXZlbnRzKSB7XG4gICAgICBpZiAoaGFzLmNhbGwodGhpcy5lZS5fZXZlbnRzLCBldmVudCkpIGFyZ3MucHVzaChldmVudCk7XG4gICAgfVxuICB9XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIGxpc3RlbmVycyA9IHRoaXMuZWUubGlzdGVuZXJzKGFyZ3NbaV0pO1xuXG4gICAgZm9yICh2YXIgaiA9IDA7IGogPCBsaXN0ZW5lcnMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGV2ZW50ID0gbGlzdGVuZXJzW2pdO1xuXG4gICAgICAvL1xuICAgICAgLy8gT25jZSBsaXN0ZW5lcnMgaGF2ZSBhIGBsaXN0ZW5lcmAgcHJvcGVydHkgdGhhdCBzdG9yZXMgdGhlIHJlYWwgbGlzdGVuZXJcbiAgICAgIC8vIGluIHRoZSBFdmVudEVtaXR0ZXIgdGhhdCBzaGlwcyB3aXRoIE5vZGUuanMuXG4gICAgICAvL1xuICAgICAgaWYgKGV2ZW50Lmxpc3RlbmVyKSB7XG4gICAgICAgIGlmIChldmVudC5saXN0ZW5lci5fX3VsdHJvbiAhPT0gdGhpcy5pZCkgY29udGludWU7XG4gICAgICAgIGRlbGV0ZSBldmVudC5saXN0ZW5lci5fX3VsdHJvbjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChldmVudC5fX3VsdHJvbiAhPT0gdGhpcy5pZCkgY29udGludWU7XG4gICAgICAgIGRlbGV0ZSBldmVudC5fX3VsdHJvbjtcbiAgICAgIH1cblxuICAgICAgdGhpcy5lZS5yZW1vdmVMaXN0ZW5lcihhcmdzW2ldLCBldmVudCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIERlc3Ryb3kgdGhlIFVsdHJvbiBpbnN0YW5jZSwgcmVtb3ZlIGFsbCBsaXN0ZW5lcnMgYW5kIHJlbGVhc2UgYWxsIHJlZmVyZW5jZXMuXG4gKlxuICogQHJldHVybnMge0Jvb2xlYW59XG4gKiBAYXBpIHB1YmxpY1xuICovXG5VbHRyb24ucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbiBkZXN0cm95KCkge1xuICBpZiAoIXRoaXMuZWUpIHJldHVybiBmYWxzZTtcblxuICB0aGlzLnJlbW92ZSgpO1xuICB0aGlzLmVlID0gbnVsbDtcblxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbi8vXG4vLyBFeHBvc2UgdGhlIG1vZHVsZS5cbi8vXG5tb2R1bGUuZXhwb3J0cyA9IFVsdHJvbjtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyohXG4gKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnRcbiAqIENvcHlyaWdodChjKSAyMDExIEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPlxuICogTUlUIExpY2Vuc2VkXG4gKi9cblxudmFyIFdTID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2xpYi9XZWJTb2NrZXQnKTtcblxuV1MuU2VydmVyID0gcmVxdWlyZSgnLi9saWIvV2ViU29ja2V0U2VydmVyJyk7XG5XUy5TZW5kZXIgPSByZXF1aXJlKCcuL2xpYi9TZW5kZXInKTtcbldTLlJlY2VpdmVyID0gcmVxdWlyZSgnLi9saWIvUmVjZWl2ZXInKTtcblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgV2ViU29ja2V0IHNlcnZlci5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBTZXJ2ZXIgb3B0aW9uc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gT3B0aW9uYWwgY29ubmVjdGlvbiBsaXN0ZW5lci5cbiAqIEByZXR1cm5zIHtXUy5TZXJ2ZXJ9XG4gKiBAYXBpIHB1YmxpY1xuICovXG5XUy5jcmVhdGVTZXJ2ZXIgPSBmdW5jdGlvbiBjcmVhdGVTZXJ2ZXIob3B0aW9ucywgZm4pIHtcbiAgdmFyIHNlcnZlciA9IG5ldyBXUy5TZXJ2ZXIob3B0aW9ucyk7XG5cbiAgaWYgKHR5cGVvZiBmbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHNlcnZlci5vbignY29ubmVjdGlvbicsIGZuKTtcbiAgfVxuXG4gIHJldHVybiBzZXJ2ZXI7XG59O1xuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBXZWJTb2NrZXQgY29ubmVjdGlvbi5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gYWRkcmVzcyBUaGUgVVJML2FkZHJlc3Mgd2UgbmVlZCB0byBjb25uZWN0IHRvLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gT3BlbiBsaXN0ZW5lci5cbiAqIEByZXR1cm5zIHtXU31cbiAqIEBhcGkgcHVibGljXG4gKi9cbldTLmNvbm5lY3QgPSBXUy5jcmVhdGVDb25uZWN0aW9uID0gZnVuY3Rpb24gY29ubmVjdChhZGRyZXNzLCBmbikge1xuICB2YXIgY2xpZW50ID0gbmV3IFdTKGFkZHJlc3MpO1xuXG4gIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICBjbGllbnQub24oJ29wZW4nLCBmbik7XG4gIH1cblxuICByZXR1cm4gY2xpZW50O1xufTtcbiIsIi8qIVxuICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50XG4gKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT5cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xuXG5mdW5jdGlvbiBCdWZmZXJQb29sKGluaXRpYWxTaXplLCBncm93U3RyYXRlZ3ksIHNocmlua1N0cmF0ZWd5KSB7XG4gIGlmICh0aGlzIGluc3RhbmNlb2YgQnVmZmVyUG9vbCA9PT0gZmFsc2UpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3NlcyBjYW4ndCBiZSBmdW5jdGlvbi1jYWxsZWRcIik7XG4gIH1cblxuICBpZiAodHlwZW9mIGluaXRpYWxTaXplID09PSAnZnVuY3Rpb24nKSB7XG4gICAgc2hyaW5rU3RyYXRlZ3kgPSBncm93U3RyYXRlZ3k7XG4gICAgZ3Jvd1N0cmF0ZWd5ID0gaW5pdGlhbFNpemU7XG4gICAgaW5pdGlhbFNpemUgPSAwO1xuICB9XG4gIGVsc2UgaWYgKHR5cGVvZiBpbml0aWFsU2l6ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpbml0aWFsU2l6ZSA9IDA7XG4gIH1cbiAgdGhpcy5fZ3Jvd1N0cmF0ZWd5ID0gKGdyb3dTdHJhdGVneSB8fCBmdW5jdGlvbihkYiwgc2l6ZSkge1xuICAgIHJldHVybiBkYi51c2VkICsgc2l6ZTtcbiAgfSkuYmluZChudWxsLCB0aGlzKTtcbiAgdGhpcy5fc2hyaW5rU3RyYXRlZ3kgPSAoc2hyaW5rU3RyYXRlZ3kgfHwgZnVuY3Rpb24oZGIpIHtcbiAgICByZXR1cm4gaW5pdGlhbFNpemU7XG4gIH0pLmJpbmQobnVsbCwgdGhpcyk7XG4gIHRoaXMuX2J1ZmZlciA9IGluaXRpYWxTaXplID8gbmV3IEJ1ZmZlcihpbml0aWFsU2l6ZSkgOiBudWxsO1xuICB0aGlzLl9vZmZzZXQgPSAwO1xuICB0aGlzLl91c2VkID0gMDtcbiAgdGhpcy5fY2hhbmdlRmFjdG9yID0gMDtcbiAgdGhpcy5fX2RlZmluZUdldHRlcl9fKCdzaXplJywgZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy5fYnVmZmVyID09IG51bGwgPyAwIDogdGhpcy5fYnVmZmVyLmxlbmd0aDtcbiAgfSk7XG4gIHRoaXMuX19kZWZpbmVHZXR0ZXJfXygndXNlZCcsIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuX3VzZWQ7XG4gIH0pO1xufVxuXG5CdWZmZXJQb29sLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbihsZW5ndGgpIHtcbiAgaWYgKHRoaXMuX2J1ZmZlciA9PSBudWxsIHx8IHRoaXMuX29mZnNldCArIGxlbmd0aCA+IHRoaXMuX2J1ZmZlci5sZW5ndGgpIHtcbiAgICB2YXIgbmV3QnVmID0gbmV3IEJ1ZmZlcih0aGlzLl9ncm93U3RyYXRlZ3kobGVuZ3RoKSk7XG4gICAgdGhpcy5fYnVmZmVyID0gbmV3QnVmO1xuICAgIHRoaXMuX29mZnNldCA9IDA7XG4gIH1cbiAgdGhpcy5fdXNlZCArPSBsZW5ndGg7XG4gIHZhciBidWYgPSB0aGlzLl9idWZmZXIuc2xpY2UodGhpcy5fb2Zmc2V0LCB0aGlzLl9vZmZzZXQgKyBsZW5ndGgpO1xuICB0aGlzLl9vZmZzZXQgKz0gbGVuZ3RoO1xuICByZXR1cm4gYnVmO1xufVxuXG5CdWZmZXJQb29sLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKGZvcmNlTmV3QnVmZmVyKSB7XG4gIHZhciBsZW4gPSB0aGlzLl9zaHJpbmtTdHJhdGVneSgpO1xuICBpZiAobGVuIDwgdGhpcy5zaXplKSB0aGlzLl9jaGFuZ2VGYWN0b3IgLT0gMTtcbiAgaWYgKGZvcmNlTmV3QnVmZmVyIHx8IHRoaXMuX2NoYW5nZUZhY3RvciA8IC0yKSB7XG4gICAgdGhpcy5fY2hhbmdlRmFjdG9yID0gMDtcbiAgICB0aGlzLl9idWZmZXIgPSBsZW4gPyBuZXcgQnVmZmVyKGxlbikgOiBudWxsO1xuICB9XG4gIHRoaXMuX29mZnNldCA9IDA7XG4gIHRoaXMuX3VzZWQgPSAwO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEJ1ZmZlclBvb2w7XG4iLCIvKiFcbiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudFxuICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+XG4gKiBNSVQgTGljZW5zZWRcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cy5CdWZmZXJVdGlsID0ge1xuICBtZXJnZTogZnVuY3Rpb24obWVyZ2VkQnVmZmVyLCBidWZmZXJzKSB7XG4gICAgdmFyIG9mZnNldCA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBidWZmZXJzLmxlbmd0aDsgaSA8IGw7ICsraSkge1xuICAgICAgdmFyIGJ1ZiA9IGJ1ZmZlcnNbaV07XG4gICAgICBidWYuY29weShtZXJnZWRCdWZmZXIsIG9mZnNldCk7XG4gICAgICBvZmZzZXQgKz0gYnVmLmxlbmd0aDtcbiAgICB9XG4gIH0sXG4gIG1hc2s6IGZ1bmN0aW9uKHNvdXJjZSwgbWFzaywgb3V0cHV0LCBvZmZzZXQsIGxlbmd0aCkge1xuICAgIHZhciBtYXNrTnVtID0gbWFzay5yZWFkVUludDMyTEUoMCwgdHJ1ZSk7XG4gICAgdmFyIGkgPSAwO1xuICAgIGZvciAoOyBpIDwgbGVuZ3RoIC0gMzsgaSArPSA0KSB7XG4gICAgICB2YXIgbnVtID0gbWFza051bSBeIHNvdXJjZS5yZWFkVUludDMyTEUoaSwgdHJ1ZSk7XG4gICAgICBpZiAobnVtIDwgMCkgbnVtID0gNDI5NDk2NzI5NiArIG51bTtcbiAgICAgIG91dHB1dC53cml0ZVVJbnQzMkxFKG51bSwgb2Zmc2V0ICsgaSwgdHJ1ZSk7XG4gICAgfVxuICAgIHN3aXRjaCAobGVuZ3RoICUgNCkge1xuICAgICAgY2FzZSAzOiBvdXRwdXRbb2Zmc2V0ICsgaSArIDJdID0gc291cmNlW2kgKyAyXSBeIG1hc2tbMl07XG4gICAgICBjYXNlIDI6IG91dHB1dFtvZmZzZXQgKyBpICsgMV0gPSBzb3VyY2VbaSArIDFdIF4gbWFza1sxXTtcbiAgICAgIGNhc2UgMTogb3V0cHV0W29mZnNldCArIGldID0gc291cmNlW2ldIF4gbWFza1swXTtcbiAgICAgIGNhc2UgMDo7XG4gICAgfVxuICB9LFxuICB1bm1hc2s6IGZ1bmN0aW9uKGRhdGEsIG1hc2spIHtcbiAgICB2YXIgbWFza051bSA9IG1hc2sucmVhZFVJbnQzMkxFKDAsIHRydWUpO1xuICAgIHZhciBsZW5ndGggPSBkYXRhLmxlbmd0aDtcbiAgICB2YXIgaSA9IDA7XG4gICAgZm9yICg7IGkgPCBsZW5ndGggLSAzOyBpICs9IDQpIHtcbiAgICAgIHZhciBudW0gPSBtYXNrTnVtIF4gZGF0YS5yZWFkVUludDMyTEUoaSwgdHJ1ZSk7XG4gICAgICBpZiAobnVtIDwgMCkgbnVtID0gNDI5NDk2NzI5NiArIG51bTtcbiAgICAgIGRhdGEud3JpdGVVSW50MzJMRShudW0sIGksIHRydWUpO1xuICAgIH1cbiAgICBzd2l0Y2ggKGxlbmd0aCAlIDQpIHtcbiAgICAgIGNhc2UgMzogZGF0YVtpICsgMl0gPSBkYXRhW2kgKyAyXSBeIG1hc2tbMl07XG4gICAgICBjYXNlIDI6IGRhdGFbaSArIDFdID0gZGF0YVtpICsgMV0gXiBtYXNrWzFdO1xuICAgICAgY2FzZSAxOiBkYXRhW2ldID0gZGF0YVtpXSBeIG1hc2tbMF07XG4gICAgICBjYXNlIDA6O1xuICAgIH1cbiAgfVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKiFcbiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudFxuICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+XG4gKiBNSVQgTGljZW5zZWRcbiAqL1xuXG50cnkge1xuICBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJ2J1ZmZlcnV0aWwnKTtcbn0gY2F0Y2ggKGUpIHtcbiAgbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL0J1ZmZlclV0aWwuZmFsbGJhY2snKTtcbn1cbiIsIi8qIVxuICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50XG4gKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT5cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc1ZhbGlkRXJyb3JDb2RlOiBmdW5jdGlvbihjb2RlKSB7XG4gICAgcmV0dXJuIChjb2RlID49IDEwMDAgJiYgY29kZSA8PSAxMDExICYmIGNvZGUgIT0gMTAwNCAmJiBjb2RlICE9IDEwMDUgJiYgY29kZSAhPSAxMDA2KSB8fFxuICAgICAgICAgKGNvZGUgPj0gMzAwMCAmJiBjb2RlIDw9IDQ5OTkpO1xuICB9LFxuICAxMDAwOiAnbm9ybWFsJyxcbiAgMTAwMTogJ2dvaW5nIGF3YXknLFxuICAxMDAyOiAncHJvdG9jb2wgZXJyb3InLFxuICAxMDAzOiAndW5zdXBwb3J0ZWQgZGF0YScsXG4gIDEwMDQ6ICdyZXNlcnZlZCcsXG4gIDEwMDU6ICdyZXNlcnZlZCBmb3IgZXh0ZW5zaW9ucycsXG4gIDEwMDY6ICdyZXNlcnZlZCBmb3IgZXh0ZW5zaW9ucycsXG4gIDEwMDc6ICdpbmNvbnNpc3RlbnQgb3IgaW52YWxpZCBkYXRhJyxcbiAgMTAwODogJ3BvbGljeSB2aW9sYXRpb24nLFxuICAxMDA5OiAnbWVzc2FnZSB0b28gYmlnJyxcbiAgMTAxMDogJ2V4dGVuc2lvbiBoYW5kc2hha2UgbWlzc2luZycsXG4gIDEwMTE6ICdhbiB1bmV4cGVjdGVkIGNvbmRpdGlvbiBwcmV2ZW50ZWQgdGhlIHJlcXVlc3QgZnJvbSBiZWluZyBmdWxmaWxsZWQnLFxufTsiLCJcbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xuXG4vKipcbiAqIE1vZHVsZSBleHBvcnRzLlxuICovXG5cbmV4cG9ydHMucGFyc2UgPSBwYXJzZTtcbmV4cG9ydHMuZm9ybWF0ID0gZm9ybWF0O1xuXG4vKipcbiAqIFBhcnNlIGV4dGVuc2lvbnMgaGVhZGVyIHZhbHVlXG4gKi9cblxuZnVuY3Rpb24gcGFyc2UodmFsdWUpIHtcbiAgdmFsdWUgPSB2YWx1ZSB8fCAnJztcblxuICB2YXIgZXh0ZW5zaW9ucyA9IHt9O1xuXG4gIHZhbHVlLnNwbGl0KCcsJykuZm9yRWFjaChmdW5jdGlvbih2KSB7XG4gICAgdmFyIHBhcmFtcyA9IHYuc3BsaXQoJzsnKTtcbiAgICB2YXIgdG9rZW4gPSBwYXJhbXMuc2hpZnQoKS50cmltKCk7XG4gICAgdmFyIHBhcmFtc0xpc3QgPSBleHRlbnNpb25zW3Rva2VuXSA9IGV4dGVuc2lvbnNbdG9rZW5dIHx8IFtdO1xuICAgIHZhciBwYXJzZWRQYXJhbXMgPSB7fTtcblxuICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtKSB7XG4gICAgICB2YXIgcGFydHMgPSBwYXJhbS50cmltKCkuc3BsaXQoJz0nKTtcbiAgICAgIHZhciBrZXkgPSBwYXJ0c1swXTtcbiAgICAgIHZhciB2YWx1ZSA9IHBhcnRzWzFdO1xuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdmFsdWUgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdW5xdW90ZSB2YWx1ZVxuICAgICAgICBpZiAodmFsdWVbMF0gPT09ICdcIicpIHtcbiAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnNsaWNlKDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZVt2YWx1ZS5sZW5ndGggLSAxXSA9PT0gJ1wiJykge1xuICAgICAgICAgIHZhbHVlID0gdmFsdWUuc2xpY2UoMCwgdmFsdWUubGVuZ3RoIC0gMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIChwYXJzZWRQYXJhbXNba2V5XSA9IHBhcnNlZFBhcmFtc1trZXldIHx8IFtdKS5wdXNoKHZhbHVlKTtcbiAgICB9KTtcblxuICAgIHBhcmFtc0xpc3QucHVzaChwYXJzZWRQYXJhbXMpO1xuICB9KTtcblxuICByZXR1cm4gZXh0ZW5zaW9ucztcbn1cblxuLyoqXG4gKiBGb3JtYXQgZXh0ZW5zaW9ucyBoZWFkZXIgdmFsdWVcbiAqL1xuXG5mdW5jdGlvbiBmb3JtYXQodmFsdWUpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKHZhbHVlKS5tYXAoZnVuY3Rpb24odG9rZW4pIHtcbiAgICB2YXIgcGFyYW1zTGlzdCA9IHZhbHVlW3Rva2VuXTtcbiAgICBpZiAoIXV0aWwuaXNBcnJheShwYXJhbXNMaXN0KSkge1xuICAgICAgcGFyYW1zTGlzdCA9IFtwYXJhbXNMaXN0XTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcmFtc0xpc3QubWFwKGZ1bmN0aW9uKHBhcmFtcykge1xuICAgICAgcmV0dXJuIFt0b2tlbl0uY29uY2F0KE9iamVjdC5rZXlzKHBhcmFtcykubWFwKGZ1bmN0aW9uKGspIHtcbiAgICAgICAgdmFyIHAgPSBwYXJhbXNba107XG4gICAgICAgIGlmICghdXRpbC5pc0FycmF5KHApKSBwID0gW3BdO1xuICAgICAgICByZXR1cm4gcC5tYXAoZnVuY3Rpb24odikge1xuICAgICAgICAgIHJldHVybiB2ID09PSB0cnVlID8gayA6IGsgKyAnPScgKyB2O1xuICAgICAgICB9KS5qb2luKCc7ICcpO1xuICAgICAgfSkpLmpvaW4oJzsgJyk7XG4gICAgfSkuam9pbignLCAnKTtcbiAgfSkuam9pbignLCAnKTtcbn1cbiIsIlxudmFyIHpsaWIgPSByZXF1aXJlKCd6bGliJyk7XG5cbnZhciBBVkFJTEFCTEVfV0lORE9XX0JJVFMgPSBbOCwgOSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNV07XG52YXIgREVGQVVMVF9XSU5ET1dfQklUUyA9IDE1O1xudmFyIERFRkFVTFRfTUVNX0xFVkVMID0gODtcblxuUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZSA9ICdwZXJtZXNzYWdlLWRlZmxhdGUnO1xuXG4vKipcbiAqIFBlci1tZXNzYWdlIENvbXByZXNzaW9uIEV4dGVuc2lvbnMgaW1wbGVtZW50YXRpb25cbiAqL1xuXG5mdW5jdGlvbiBQZXJNZXNzYWdlRGVmbGF0ZShvcHRpb25zLCBpc1NlcnZlcikge1xuICBpZiAodGhpcyBpbnN0YW5jZW9mIFBlck1lc3NhZ2VEZWZsYXRlID09PSBmYWxzZSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzc2VzIGNhbid0IGJlIGZ1bmN0aW9uLWNhbGxlZFwiKTtcbiAgfVxuXG4gIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB0aGlzLl9pc1NlcnZlciA9ICEhaXNTZXJ2ZXI7XG4gIHRoaXMuX2luZmxhdGUgPSBudWxsO1xuICB0aGlzLl9kZWZsYXRlID0gbnVsbDtcbiAgdGhpcy5wYXJhbXMgPSBudWxsO1xufVxuXG4vKipcbiAqIENyZWF0ZSBleHRlbnNpb24gcGFyYW1ldGVycyBvZmZlclxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuUGVyTWVzc2FnZURlZmxhdGUucHJvdG90eXBlLm9mZmVyID0gZnVuY3Rpb24oKSB7XG4gIHZhciBwYXJhbXMgPSB7fTtcbiAgaWYgKHRoaXMuX29wdGlvbnMuc2VydmVyTm9Db250ZXh0VGFrZW92ZXIpIHtcbiAgICBwYXJhbXMuc2VydmVyX25vX2NvbnRleHRfdGFrZW92ZXIgPSB0cnVlO1xuICB9XG4gIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE5vQ29udGV4dFRha2VvdmVyKSB7XG4gICAgcGFyYW1zLmNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyID0gdHJ1ZTtcbiAgfVxuICBpZiAodGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzKSB7XG4gICAgcGFyYW1zLnNlcnZlcl9tYXhfd2luZG93X2JpdHMgPSB0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHM7XG4gIH1cbiAgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0cykge1xuICAgIHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzID0gdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzO1xuICB9IGVsc2UgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50TWF4V2luZG93Qml0cyA9PSBudWxsKSB7XG4gICAgcGFyYW1zLmNsaWVudF9tYXhfd2luZG93X2JpdHMgPSB0cnVlO1xuICB9XG4gIHJldHVybiBwYXJhbXM7XG59O1xuXG4vKipcbiAqIEFjY2VwdCBleHRlbnNpb24gb2ZmZXJcbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblBlck1lc3NhZ2VEZWZsYXRlLnByb3RvdHlwZS5hY2NlcHQgPSBmdW5jdGlvbihwYXJhbXNMaXN0KSB7XG4gIHBhcmFtc0xpc3QgPSB0aGlzLm5vcm1hbGl6ZVBhcmFtcyhwYXJhbXNMaXN0KTtcblxuICB2YXIgcGFyYW1zO1xuICBpZiAodGhpcy5faXNTZXJ2ZXIpIHtcbiAgICBwYXJhbXMgPSB0aGlzLmFjY2VwdEFzU2VydmVyKHBhcmFtc0xpc3QpO1xuICB9IGVsc2Uge1xuICAgIHBhcmFtcyA9IHRoaXMuYWNjZXB0QXNDbGllbnQocGFyYW1zTGlzdCk7XG4gIH1cblxuICB0aGlzLnBhcmFtcyA9IHBhcmFtcztcbiAgcmV0dXJuIHBhcmFtcztcbn07XG5cbi8qKlxuICogUmVsZWFzZXMgYWxsIHJlc291cmNlcyB1c2VkIGJ5IHRoZSBleHRlbnNpb25cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblBlck1lc3NhZ2VEZWZsYXRlLnByb3RvdHlwZS5jbGVhbnVwID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLl9pbmZsYXRlKSB7XG4gICAgaWYgKHRoaXMuX2luZmxhdGUud3JpdGVJblByb2dyZXNzKSB7XG4gICAgICB0aGlzLl9pbmZsYXRlLnBlbmRpbmdDbG9zZSA9IHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLl9pbmZsYXRlLmNsb3NlKSB0aGlzLl9pbmZsYXRlLmNsb3NlKCk7XG4gICAgICB0aGlzLl9pbmZsYXRlID0gbnVsbDtcbiAgICB9XG4gIH1cbiAgaWYgKHRoaXMuX2RlZmxhdGUpIHtcbiAgICBpZiAodGhpcy5fZGVmbGF0ZS53cml0ZUluUHJvZ3Jlc3MpIHtcbiAgICAgIHRoaXMuX2RlZmxhdGUucGVuZGluZ0Nsb3NlID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuX2RlZmxhdGUuY2xvc2UpIHRoaXMuX2RlZmxhdGUuY2xvc2UoKTtcbiAgICAgIHRoaXMuX2RlZmxhdGUgPSBudWxsO1xuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBBY2NlcHQgZXh0ZW5zaW9uIG9mZmVyIGZyb20gY2xpZW50XG4gKlxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuUGVyTWVzc2FnZURlZmxhdGUucHJvdG90eXBlLmFjY2VwdEFzU2VydmVyID0gZnVuY3Rpb24ocGFyYW1zTGlzdCkge1xuICB2YXIgYWNjZXB0ZWQgPSB7fTtcbiAgdmFyIHJlc3VsdCA9IHBhcmFtc0xpc3Quc29tZShmdW5jdGlvbihwYXJhbXMpIHtcbiAgICBhY2NlcHRlZCA9IHt9O1xuICAgIGlmICh0aGlzLl9vcHRpb25zLnNlcnZlck5vQ29udGV4dFRha2VvdmVyID09PSBmYWxzZSAmJiBwYXJhbXMuc2VydmVyX25vX2NvbnRleHRfdGFrZW92ZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuX29wdGlvbnMuc2VydmVyTWF4V2luZG93Qml0cyA9PT0gZmFsc2UgJiYgcGFyYW1zLnNlcnZlcl9tYXhfd2luZG93X2JpdHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLnNlcnZlck1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInICYmXG4gICAgICAgIHR5cGVvZiBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cyA9PT0gJ251bWJlcicgJiZcbiAgICAgICAgdGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzID4gcGFyYW1zLnNlcnZlcl9tYXhfd2luZG93X2JpdHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInICYmICFwYXJhbXMuY2xpZW50X21heF93aW5kb3dfYml0cykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9vcHRpb25zLnNlcnZlck5vQ29udGV4dFRha2VvdmVyIHx8IHBhcmFtcy5zZXJ2ZXJfbm9fY29udGV4dF90YWtlb3Zlcikge1xuICAgICAgYWNjZXB0ZWQuc2VydmVyX25vX2NvbnRleHRfdGFrZW92ZXIgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnROb0NvbnRleHRUYWtlb3Zlcikge1xuICAgICAgYWNjZXB0ZWQuY2xpZW50X25vX2NvbnRleHRfdGFrZW92ZXIgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnROb0NvbnRleHRUYWtlb3ZlciAhPT0gZmFsc2UgJiYgcGFyYW1zLmNsaWVudF9ub19jb250ZXh0X3Rha2VvdmVyKSB7XG4gICAgICBhY2NlcHRlZC5jbGllbnRfbm9fY29udGV4dF90YWtlb3ZlciA9IHRydWU7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdGhpcy5fb3B0aW9ucy5zZXJ2ZXJNYXhXaW5kb3dCaXRzID09PSAnbnVtYmVyJykge1xuICAgICAgYWNjZXB0ZWQuc2VydmVyX21heF93aW5kb3dfYml0cyA9IHRoaXMuX29wdGlvbnMuc2VydmVyTWF4V2luZG93Qml0cztcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cyA9PT0gJ251bWJlcicpIHtcbiAgICAgIGFjY2VwdGVkLnNlcnZlcl9tYXhfd2luZG93X2JpdHMgPSBwYXJhbXMuc2VydmVyX21heF93aW5kb3dfYml0cztcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09ICdudW1iZXInKSB7XG4gICAgICBhY2NlcHRlZC5jbGllbnRfbWF4X3dpbmRvd19iaXRzID0gdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzO1xuICAgIH0gZWxzZSBpZiAodGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzICE9PSBmYWxzZSAmJiB0eXBlb2YgcGFyYW1zLmNsaWVudF9tYXhfd2luZG93X2JpdHMgPT09ICdudW1iZXInKSB7XG4gICAgICBhY2NlcHRlZC5jbGllbnRfbWF4X3dpbmRvd19iaXRzID0gcGFyYW1zLmNsaWVudF9tYXhfd2luZG93X2JpdHM7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9LCB0aGlzKTtcblxuICBpZiAoIXJlc3VsdCkge1xuICAgIHRocm93IG5ldyBFcnJvcignRG9lc25cXCd0IHN1cHBvcnQgdGhlIG9mZmVyZWQgY29uZmlndXJhdGlvbicpO1xuICB9XG5cbiAgcmV0dXJuIGFjY2VwdGVkO1xufTtcblxuLyoqXG4gKiBBY2NlcHQgZXh0ZW5zaW9uIHJlc3BvbnNlIGZyb20gc2VydmVyXG4gKlxuICogQGFwaSBwcml2YXllXG4gKi9cblxuUGVyTWVzc2FnZURlZmxhdGUucHJvdG90eXBlLmFjY2VwdEFzQ2xpZW50ID0gZnVuY3Rpb24ocGFyYW1zTGlzdCkge1xuICB2YXIgcGFyYW1zID0gcGFyYW1zTGlzdFswXTtcbiAgaWYgKHRoaXMuX29wdGlvbnMuY2xpZW50Tm9Db250ZXh0VGFrZW92ZXIgIT0gbnVsbCkge1xuICAgIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE5vQ29udGV4dFRha2VvdmVyID09PSBmYWxzZSAmJiBwYXJhbXMuY2xpZW50X25vX2NvbnRleHRfdGFrZW92ZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCB2YWx1ZSBmb3IgXCJjbGllbnRfbm9fY29udGV4dF90YWtlb3ZlclwiJyk7XG4gICAgfVxuICB9XG4gIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgIT0gbnVsbCkge1xuICAgIGlmICh0aGlzLl9vcHRpb25zLmNsaWVudE1heFdpbmRvd0JpdHMgPT09IGZhbHNlICYmIHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgdmFsdWUgZm9yIFwiY2xpZW50X21heF93aW5kb3dfYml0c1wiJyk7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzID09PSAnbnVtYmVyJyAmJlxuICAgICAgICAoIXBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzIHx8IHBhcmFtcy5jbGllbnRfbWF4X3dpbmRvd19iaXRzID4gdGhpcy5fb3B0aW9ucy5jbGllbnRNYXhXaW5kb3dCaXRzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHZhbHVlIGZvciBcImNsaWVudF9tYXhfd2luZG93X2JpdHNcIicpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyYW1zO1xufTtcblxuLyoqXG4gKiBOb3JtYWxpemUgZXh0ZW5zaW9ucyBwYXJhbWV0ZXJzXG4gKlxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuUGVyTWVzc2FnZURlZmxhdGUucHJvdG90eXBlLm5vcm1hbGl6ZVBhcmFtcyA9IGZ1bmN0aW9uKHBhcmFtc0xpc3QpIHtcbiAgcmV0dXJuIHBhcmFtc0xpc3QubWFwKGZ1bmN0aW9uKHBhcmFtcykge1xuICAgIE9iamVjdC5rZXlzKHBhcmFtcykuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgIHZhciB2YWx1ZSA9IHBhcmFtc1trZXldO1xuICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdWx0aXBsZSBleHRlbnNpb24gcGFyYW1ldGVycyBmb3IgJyArIGtleSk7XG4gICAgICB9XG5cbiAgICAgIHZhbHVlID0gdmFsdWVbMF07XG5cbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICBjYXNlICdzZXJ2ZXJfbm9fY29udGV4dF90YWtlb3Zlcic6XG4gICAgICBjYXNlICdjbGllbnRfbm9fY29udGV4dF90YWtlb3Zlcic6XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdHJ1ZSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBleHRlbnNpb24gcGFyYW1ldGVyIHZhbHVlIGZvciAnICsga2V5ICsgJyAoJyArIHZhbHVlICsgJyknKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJhbXNba2V5XSA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc2VydmVyX21heF93aW5kb3dfYml0cyc6XG4gICAgICBjYXNlICdjbGllbnRfbWF4X3dpbmRvd19iaXRzJzpcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICB2YWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7XG4gICAgICAgICAgaWYgKCF+QVZBSUxBQkxFX1dJTkRPV19CSVRTLmluZGV4T2YodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgZXh0ZW5zaW9uIHBhcmFtZXRlciB2YWx1ZSBmb3IgJyArIGtleSArICcgKCcgKyB2YWx1ZSArICcpJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5faXNTZXJ2ZXIgJiYgdmFsdWUgPT09IHRydWUpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZXh0ZW5zaW9uIHBhcmFtZXRlciB2YWx1ZSBmb3IgJyArIGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgcGFyYW1zW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBkZWZpbmVkIGV4dGVuc2lvbiBwYXJhbWV0ZXIgKCcgKyBrZXkgKyAnKScpO1xuICAgICAgfVxuICAgIH0sIHRoaXMpO1xuICAgIHJldHVybiBwYXJhbXM7XG4gIH0sIHRoaXMpO1xufTtcblxuLyoqXG4gKiBEZWNvbXByZXNzIG1lc3NhZ2VcbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblBlck1lc3NhZ2VEZWZsYXRlLnByb3RvdHlwZS5kZWNvbXByZXNzID0gZnVuY3Rpb24gKGRhdGEsIGZpbiwgY2FsbGJhY2spIHtcbiAgdmFyIGVuZHBvaW50ID0gdGhpcy5faXNTZXJ2ZXIgPyAnY2xpZW50JyA6ICdzZXJ2ZXInO1xuXG4gIGlmICghdGhpcy5faW5mbGF0ZSkge1xuICAgIHZhciBtYXhXaW5kb3dCaXRzID0gdGhpcy5wYXJhbXNbZW5kcG9pbnQgKyAnX21heF93aW5kb3dfYml0cyddO1xuICAgIHRoaXMuX2luZmxhdGUgPSB6bGliLmNyZWF0ZUluZmxhdGVSYXcoe1xuICAgICAgd2luZG93Qml0czogJ251bWJlcicgPT09IHR5cGVvZiBtYXhXaW5kb3dCaXRzID8gbWF4V2luZG93Qml0cyA6IERFRkFVTFRfV0lORE9XX0JJVFNcbiAgICB9KTtcbiAgfVxuICB0aGlzLl9pbmZsYXRlLndyaXRlSW5Qcm9ncmVzcyA9IHRydWU7XG5cbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB2YXIgYnVmZmVycyA9IFtdO1xuXG4gIHRoaXMuX2luZmxhdGUub24oJ2Vycm9yJywgb25FcnJvcikub24oJ2RhdGEnLCBvbkRhdGEpO1xuICB0aGlzLl9pbmZsYXRlLndyaXRlKGRhdGEpO1xuICBpZiAoZmluKSB7XG4gICAgdGhpcy5faW5mbGF0ZS53cml0ZShuZXcgQnVmZmVyKFsweDAwLCAweDAwLCAweGZmLCAweGZmXSkpO1xuICB9XG4gIHRoaXMuX2luZmxhdGUuZmx1c2goZnVuY3Rpb24oKSB7XG4gICAgY2xlYW51cCgpO1xuICAgIGNhbGxiYWNrKG51bGwsIEJ1ZmZlci5jb25jYXQoYnVmZmVycykpO1xuICB9KTtcblxuICBmdW5jdGlvbiBvbkVycm9yKGVycikge1xuICAgIGNsZWFudXAoKTtcbiAgICBjYWxsYmFjayhlcnIpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25EYXRhKGRhdGEpIHtcbiAgICBidWZmZXJzLnB1c2goZGF0YSk7XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgIGlmICghc2VsZi5faW5mbGF0ZSkgcmV0dXJuO1xuICAgIHNlbGYuX2luZmxhdGUucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25FcnJvcik7XG4gICAgc2VsZi5faW5mbGF0ZS5yZW1vdmVMaXN0ZW5lcignZGF0YScsIG9uRGF0YSk7XG4gICAgc2VsZi5faW5mbGF0ZS53cml0ZUluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICBpZiAoKGZpbiAmJiBzZWxmLnBhcmFtc1tlbmRwb2ludCArICdfbm9fY29udGV4dF90YWtlb3ZlciddKSB8fCBzZWxmLl9pbmZsYXRlLnBlbmRpbmdDbG9zZSkge1xuICAgICAgaWYgKHNlbGYuX2luZmxhdGUuY2xvc2UpIHNlbGYuX2luZmxhdGUuY2xvc2UoKTtcbiAgICAgIHNlbGYuX2luZmxhdGUgPSBudWxsO1xuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBDb21wcmVzcyBtZXNzYWdlXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5QZXJNZXNzYWdlRGVmbGF0ZS5wcm90b3R5cGUuY29tcHJlc3MgPSBmdW5jdGlvbiAoZGF0YSwgZmluLCBjYWxsYmFjaykge1xuICB2YXIgZW5kcG9pbnQgPSB0aGlzLl9pc1NlcnZlciA/ICdzZXJ2ZXInIDogJ2NsaWVudCc7XG5cbiAgaWYgKCF0aGlzLl9kZWZsYXRlKSB7XG4gICAgdmFyIG1heFdpbmRvd0JpdHMgPSB0aGlzLnBhcmFtc1tlbmRwb2ludCArICdfbWF4X3dpbmRvd19iaXRzJ107XG4gICAgdGhpcy5fZGVmbGF0ZSA9IHpsaWIuY3JlYXRlRGVmbGF0ZVJhdyh7XG4gICAgICBmbHVzaDogemxpYi5aX1NZTkNfRkxVU0gsXG4gICAgICB3aW5kb3dCaXRzOiAnbnVtYmVyJyA9PT0gdHlwZW9mIG1heFdpbmRvd0JpdHMgPyBtYXhXaW5kb3dCaXRzIDogREVGQVVMVF9XSU5ET1dfQklUUyxcbiAgICAgIG1lbUxldmVsOiB0aGlzLl9vcHRpb25zLm1lbUxldmVsIHx8IERFRkFVTFRfTUVNX0xFVkVMXG4gICAgfSk7XG4gIH1cbiAgdGhpcy5fZGVmbGF0ZS53cml0ZUluUHJvZ3Jlc3MgPSB0cnVlO1xuXG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIGJ1ZmZlcnMgPSBbXTtcblxuICB0aGlzLl9kZWZsYXRlLm9uKCdlcnJvcicsIG9uRXJyb3IpLm9uKCdkYXRhJywgb25EYXRhKTtcbiAgdGhpcy5fZGVmbGF0ZS53cml0ZShkYXRhKTtcbiAgdGhpcy5fZGVmbGF0ZS5mbHVzaChmdW5jdGlvbigpIHtcbiAgICBjbGVhbnVwKCk7XG4gICAgdmFyIGRhdGEgPSBCdWZmZXIuY29uY2F0KGJ1ZmZlcnMpO1xuICAgIGlmIChmaW4pIHtcbiAgICAgIGRhdGEgPSBkYXRhLnNsaWNlKDAsIGRhdGEubGVuZ3RoIC0gNCk7XG4gICAgfVxuICAgIGNhbGxiYWNrKG51bGwsIGRhdGEpO1xuICB9KTtcblxuICBmdW5jdGlvbiBvbkVycm9yKGVycikge1xuICAgIGNsZWFudXAoKTtcbiAgICBjYWxsYmFjayhlcnIpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25EYXRhKGRhdGEpIHtcbiAgICBidWZmZXJzLnB1c2goZGF0YSk7XG4gIH1cblxuICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgIGlmICghc2VsZi5fZGVmbGF0ZSkgcmV0dXJuO1xuICAgIHNlbGYuX2RlZmxhdGUucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25FcnJvcik7XG4gICAgc2VsZi5fZGVmbGF0ZS5yZW1vdmVMaXN0ZW5lcignZGF0YScsIG9uRGF0YSk7XG4gICAgc2VsZi5fZGVmbGF0ZS53cml0ZUluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICBpZiAoKGZpbiAmJiBzZWxmLnBhcmFtc1tlbmRwb2ludCArICdfbm9fY29udGV4dF90YWtlb3ZlciddKSB8fCBzZWxmLl9kZWZsYXRlLnBlbmRpbmdDbG9zZSkge1xuICAgICAgaWYgKHNlbGYuX2RlZmxhdGUuY2xvc2UpIHNlbGYuX2RlZmxhdGUuY2xvc2UoKTtcbiAgICAgIHNlbGYuX2RlZmxhdGUgPSBudWxsO1xuICAgIH1cbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQZXJNZXNzYWdlRGVmbGF0ZTtcbiIsIi8qIVxuICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50XG4gKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT5cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xuXG4vKipcbiAqIFN0YXRlIGNvbnN0YW50c1xuICovXG5cbnZhciBFTVBUWSA9IDBcbiAgLCBCT0RZID0gMTtcbnZhciBCSU5BUllMRU5HVEggPSAyXG4gICwgQklOQVJZQk9EWSA9IDM7XG5cbi8qKlxuICogSGl4aWUgUmVjZWl2ZXIgaW1wbGVtZW50YXRpb25cbiAqL1xuXG5mdW5jdGlvbiBSZWNlaXZlciAoKSB7XG4gIGlmICh0aGlzIGluc3RhbmNlb2YgUmVjZWl2ZXIgPT09IGZhbHNlKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzZXMgY2FuJ3QgYmUgZnVuY3Rpb24tY2FsbGVkXCIpO1xuICB9XG5cbiAgdGhpcy5zdGF0ZSA9IEVNUFRZO1xuICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgdGhpcy5tZXNzYWdlRW5kID0gLTE7XG4gIHRoaXMuc3Bhbkxlbmd0aCA9IDA7XG4gIHRoaXMuZGVhZCA9IGZhbHNlO1xuXG4gIHRoaXMub25lcnJvciA9IGZ1bmN0aW9uKCkge307XG4gIHRoaXMub250ZXh0ID0gZnVuY3Rpb24oKSB7fTtcbiAgdGhpcy5vbmJpbmFyeSA9IGZ1bmN0aW9uKCkge307XG4gIHRoaXMub25jbG9zZSA9IGZ1bmN0aW9uKCkge307XG4gIHRoaXMub25waW5nID0gZnVuY3Rpb24oKSB7fTtcbiAgdGhpcy5vbnBvbmcgPSBmdW5jdGlvbigpIHt9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlY2VpdmVyO1xuXG4vKipcbiAqIEFkZCBuZXcgZGF0YSB0byB0aGUgcGFyc2VyLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuUmVjZWl2ZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBmdW5jdGlvbiBkb0FkZCgpIHtcbiAgICBpZiAoc2VsZi5zdGF0ZSA9PT0gRU1QVFkpIHtcbiAgICAgIGlmIChkYXRhLmxlbmd0aCA9PSAyICYmIGRhdGFbMF0gPT0gMHhGRiAmJiBkYXRhWzFdID09IDB4MDApIHtcbiAgICAgICAgc2VsZi5yZXNldCgpO1xuICAgICAgICBzZWxmLm9uY2xvc2UoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGRhdGFbMF0gPT09IDB4ODApIHtcbiAgICAgICAgc2VsZi5tZXNzYWdlRW5kID0gMDtcbiAgICAgICAgc2VsZi5zdGF0ZSA9IEJJTkFSWUxFTkdUSDtcbiAgICAgICAgZGF0YSA9IGRhdGEuc2xpY2UoMSk7XG4gICAgICB9IGVsc2Uge1xuXG4gICAgICBpZiAoZGF0YVswXSAhPT0gMHgwMCkge1xuICAgICAgICBzZWxmLmVycm9yKCdwYXlsb2FkIG11c3Qgc3RhcnQgd2l0aCAweDAwIGJ5dGUnLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZGF0YSA9IGRhdGEuc2xpY2UoMSk7XG4gICAgICBzZWxmLnN0YXRlID0gQk9EWTtcblxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoc2VsZi5zdGF0ZSA9PT0gQklOQVJZTEVOR1RIKSB7XG4gICAgICB2YXIgaSA9IDA7XG4gICAgICB3aGlsZSAoKGkgPCBkYXRhLmxlbmd0aCkgJiYgKGRhdGFbaV0gJiAweDgwKSkge1xuICAgICAgICBzZWxmLm1lc3NhZ2VFbmQgPSAxMjggKiBzZWxmLm1lc3NhZ2VFbmQgKyAoZGF0YVtpXSAmIDB4N2YpO1xuICAgICAgICArK2k7XG4gICAgICB9XG4gICAgICBpZiAoaSA8IGRhdGEubGVuZ3RoKSB7XG4gICAgICAgIHNlbGYubWVzc2FnZUVuZCA9IDEyOCAqIHNlbGYubWVzc2FnZUVuZCArIChkYXRhW2ldICYgMHg3Zik7XG4gICAgICAgIHNlbGYuc3RhdGUgPSBCSU5BUllCT0RZO1xuICAgICAgICArK2k7XG4gICAgICB9XG4gICAgICBpZiAoaSA+IDApXG4gICAgICAgIGRhdGEgPSBkYXRhLnNsaWNlKGkpO1xuICAgIH1cbiAgICBpZiAoc2VsZi5zdGF0ZSA9PT0gQklOQVJZQk9EWSkge1xuICAgICAgdmFyIGRhdGFsZWZ0ID0gc2VsZi5tZXNzYWdlRW5kIC0gc2VsZi5zcGFuTGVuZ3RoO1xuICAgICAgaWYgKGRhdGEubGVuZ3RoID49IGRhdGFsZWZ0KSB7XG4gICAgICAgIC8vIGNvbnN1bWUgdGhlIHdob2xlIGJ1ZmZlciB0byBmaW5pc2ggdGhlIGZyYW1lXG4gICAgICAgIHNlbGYuYnVmZmVycy5wdXNoKGRhdGEpO1xuICAgICAgICBzZWxmLnNwYW5MZW5ndGggKz0gZGF0YWxlZnQ7XG4gICAgICAgIHNlbGYubWVzc2FnZUVuZCA9IGRhdGFsZWZ0O1xuICAgICAgICByZXR1cm4gc2VsZi5wYXJzZSgpO1xuICAgICAgfVxuICAgICAgLy8gZnJhbWUncyBub3QgZG9uZSBldmVuIGlmIHdlIGNvbnN1bWUgaXQgYWxsXG4gICAgICBzZWxmLmJ1ZmZlcnMucHVzaChkYXRhKTtcbiAgICAgIHNlbGYuc3Bhbkxlbmd0aCArPSBkYXRhLmxlbmd0aDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2VsZi5idWZmZXJzLnB1c2goZGF0YSk7XG4gICAgaWYgKChzZWxmLm1lc3NhZ2VFbmQgPSBidWZmZXJJbmRleChkYXRhLCAweEZGKSkgIT0gLTEpIHtcbiAgICAgIHNlbGYuc3Bhbkxlbmd0aCArPSBzZWxmLm1lc3NhZ2VFbmQ7XG4gICAgICByZXR1cm4gc2VsZi5wYXJzZSgpO1xuICAgIH1cbiAgICBlbHNlIHNlbGYuc3Bhbkxlbmd0aCArPSBkYXRhLmxlbmd0aDtcbiAgfVxuICB3aGlsZShkYXRhKSBkYXRhID0gZG9BZGQoKTtcbn07XG5cbi8qKlxuICogUmVsZWFzZXMgYWxsIHJlc291cmNlcyB1c2VkIGJ5IHRoZSByZWNlaXZlci5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS5jbGVhbnVwID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuZGVhZCA9IHRydWU7XG4gIHRoaXMuc3RhdGUgPSBFTVBUWTtcbiAgdGhpcy5idWZmZXJzID0gW107XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYnVmZmVyZWQgZGF0YS5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKCkge1xuICB2YXIgb3V0cHV0ID0gbmV3IEJ1ZmZlcih0aGlzLnNwYW5MZW5ndGgpO1xuICB2YXIgb3V0cHV0SW5kZXggPSAwO1xuICBmb3IgKHZhciBiaSA9IDAsIGJsID0gdGhpcy5idWZmZXJzLmxlbmd0aDsgYmkgPCBibCAtIDE7ICsrYmkpIHtcbiAgICB2YXIgYnVmZmVyID0gdGhpcy5idWZmZXJzW2JpXTtcbiAgICBidWZmZXIuY29weShvdXRwdXQsIG91dHB1dEluZGV4KTtcbiAgICBvdXRwdXRJbmRleCArPSBidWZmZXIubGVuZ3RoO1xuICB9XG4gIHZhciBsYXN0QnVmZmVyID0gdGhpcy5idWZmZXJzW3RoaXMuYnVmZmVycy5sZW5ndGggLSAxXTtcbiAgaWYgKHRoaXMubWVzc2FnZUVuZCA+IDApIGxhc3RCdWZmZXIuY29weShvdXRwdXQsIG91dHB1dEluZGV4LCAwLCB0aGlzLm1lc3NhZ2VFbmQpO1xuICBpZiAodGhpcy5zdGF0ZSAhPT0gQk9EWSkgLS10aGlzLm1lc3NhZ2VFbmQ7XG4gIHZhciB0YWlsID0gbnVsbDtcbiAgaWYgKHRoaXMubWVzc2FnZUVuZCA8IGxhc3RCdWZmZXIubGVuZ3RoIC0gMSkge1xuICAgIHRhaWwgPSBsYXN0QnVmZmVyLnNsaWNlKHRoaXMubWVzc2FnZUVuZCArIDEpO1xuICB9XG4gIHRoaXMucmVzZXQoKTtcbiAgdGhpcy5vbnRleHQob3V0cHV0LnRvU3RyaW5nKCd1dGY4JykpO1xuICByZXR1cm4gdGFpbDtcbn07XG5cbi8qKlxuICogSGFuZGxlcyBhbiBlcnJvclxuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChyZWFzb24sIHRlcm1pbmF0ZSkge1xuICB0aGlzLnJlc2V0KCk7XG4gIHRoaXMub25lcnJvcihyZWFzb24sIHRlcm1pbmF0ZSk7XG4gIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBSZXNldCBwYXJzZXIgc3RhdGVcbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5SZWNlaXZlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAocmVhc29uKSB7XG4gIGlmICh0aGlzLmRlYWQpIHJldHVybjtcbiAgdGhpcy5zdGF0ZSA9IEVNUFRZO1xuICB0aGlzLmJ1ZmZlcnMgPSBbXTtcbiAgdGhpcy5tZXNzYWdlRW5kID0gLTE7XG4gIHRoaXMuc3Bhbkxlbmd0aCA9IDA7XG59O1xuXG4vKipcbiAqIEludGVybmFsIGFwaVxuICovXG5cbmZ1bmN0aW9uIGJ1ZmZlckluZGV4KGJ1ZmZlciwgYnl0ZSkge1xuICBmb3IgKHZhciBpID0gMCwgbCA9IGJ1ZmZlci5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICBpZiAoYnVmZmVyW2ldID09PSBieXRlKSByZXR1cm4gaTtcbiAgfVxuICByZXR1cm4gLTE7XG59XG4iLCIvKiFcbiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudFxuICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+XG4gKiBNSVQgTGljZW5zZWRcbiAqL1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKVxuICAsIFZhbGlkYXRpb24gPSByZXF1aXJlKCcuL1ZhbGlkYXRpb24nKS5WYWxpZGF0aW9uXG4gICwgRXJyb3JDb2RlcyA9IHJlcXVpcmUoJy4vRXJyb3JDb2RlcycpXG4gICwgQnVmZmVyUG9vbCA9IHJlcXVpcmUoJy4vQnVmZmVyUG9vbCcpXG4gICwgYnVmZmVyVXRpbCA9IHJlcXVpcmUoJy4vQnVmZmVyVXRpbCcpLkJ1ZmZlclV0aWxcbiAgLCBQZXJNZXNzYWdlRGVmbGF0ZSA9IHJlcXVpcmUoJy4vUGVyTWVzc2FnZURlZmxhdGUnKTtcblxuLyoqXG4gKiBIeUJpIFJlY2VpdmVyIGltcGxlbWVudGF0aW9uXG4gKi9cblxuZnVuY3Rpb24gUmVjZWl2ZXIgKGV4dGVuc2lvbnMpIHtcbiAgaWYgKHRoaXMgaW5zdGFuY2VvZiBSZWNlaXZlciA9PT0gZmFsc2UpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3NlcyBjYW4ndCBiZSBmdW5jdGlvbi1jYWxsZWRcIik7XG4gIH1cblxuICAvLyBtZW1vcnkgcG9vbCBmb3IgZnJhZ21lbnRlZCBtZXNzYWdlc1xuICB2YXIgZnJhZ21lbnRlZFBvb2xQcmV2VXNlZCA9IC0xO1xuICB0aGlzLmZyYWdtZW50ZWRCdWZmZXJQb29sID0gbmV3IEJ1ZmZlclBvb2woMTAyNCwgZnVuY3Rpb24oZGIsIGxlbmd0aCkge1xuICAgIHJldHVybiBkYi51c2VkICsgbGVuZ3RoO1xuICB9LCBmdW5jdGlvbihkYikge1xuICAgIHJldHVybiBmcmFnbWVudGVkUG9vbFByZXZVc2VkID0gZnJhZ21lbnRlZFBvb2xQcmV2VXNlZCA+PSAwID9cbiAgICAgIE1hdGguY2VpbCgoZnJhZ21lbnRlZFBvb2xQcmV2VXNlZCArIGRiLnVzZWQpIC8gMikgOlxuICAgICAgZGIudXNlZDtcbiAgfSk7XG5cbiAgLy8gbWVtb3J5IHBvb2wgZm9yIHVuZnJhZ21lbnRlZCBtZXNzYWdlc1xuICB2YXIgdW5mcmFnbWVudGVkUG9vbFByZXZVc2VkID0gLTE7XG4gIHRoaXMudW5mcmFnbWVudGVkQnVmZmVyUG9vbCA9IG5ldyBCdWZmZXJQb29sKDEwMjQsIGZ1bmN0aW9uKGRiLCBsZW5ndGgpIHtcbiAgICByZXR1cm4gZGIudXNlZCArIGxlbmd0aDtcbiAgfSwgZnVuY3Rpb24oZGIpIHtcbiAgICByZXR1cm4gdW5mcmFnbWVudGVkUG9vbFByZXZVc2VkID0gdW5mcmFnbWVudGVkUG9vbFByZXZVc2VkID49IDAgP1xuICAgICAgTWF0aC5jZWlsKCh1bmZyYWdtZW50ZWRQb29sUHJldlVzZWQgKyBkYi51c2VkKSAvIDIpIDpcbiAgICAgIGRiLnVzZWQ7XG4gIH0pO1xuXG4gIHRoaXMuZXh0ZW5zaW9ucyA9IGV4dGVuc2lvbnMgfHwge307XG4gIHRoaXMuc3RhdGUgPSB7XG4gICAgYWN0aXZlRnJhZ21lbnRlZE9wZXJhdGlvbjogbnVsbCxcbiAgICBsYXN0RnJhZ21lbnQ6IGZhbHNlLFxuICAgIG1hc2tlZDogZmFsc2UsXG4gICAgb3Bjb2RlOiAwLFxuICAgIGZyYWdtZW50ZWRPcGVyYXRpb246IGZhbHNlXG4gIH07XG4gIHRoaXMub3ZlcmZsb3cgPSBbXTtcbiAgdGhpcy5oZWFkZXJCdWZmZXIgPSBuZXcgQnVmZmVyKDEwKTtcbiAgdGhpcy5leHBlY3RPZmZzZXQgPSAwO1xuICB0aGlzLmV4cGVjdEJ1ZmZlciA9IG51bGw7XG4gIHRoaXMuZXhwZWN0SGFuZGxlciA9IG51bGw7XG4gIHRoaXMuY3VycmVudE1lc3NhZ2UgPSBbXTtcbiAgdGhpcy5tZXNzYWdlSGFuZGxlcnMgPSBbXTtcbiAgdGhpcy5leHBlY3RIZWFkZXIoMiwgdGhpcy5wcm9jZXNzUGFja2V0KTtcbiAgdGhpcy5kZWFkID0gZmFsc2U7XG4gIHRoaXMucHJvY2Vzc2luZyA9IGZhbHNlO1xuXG4gIHRoaXMub25lcnJvciA9IGZ1bmN0aW9uKCkge307XG4gIHRoaXMub250ZXh0ID0gZnVuY3Rpb24oKSB7fTtcbiAgdGhpcy5vbmJpbmFyeSA9IGZ1bmN0aW9uKCkge307XG4gIHRoaXMub25jbG9zZSA9IGZ1bmN0aW9uKCkge307XG4gIHRoaXMub25waW5nID0gZnVuY3Rpb24oKSB7fTtcbiAgdGhpcy5vbnBvbmcgPSBmdW5jdGlvbigpIHt9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFJlY2VpdmVyO1xuXG4vKipcbiAqIEFkZCBuZXcgZGF0YSB0byB0aGUgcGFyc2VyLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuUmVjZWl2ZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgdmFyIGRhdGFMZW5ndGggPSBkYXRhLmxlbmd0aDtcbiAgaWYgKGRhdGFMZW5ndGggPT0gMCkgcmV0dXJuO1xuICBpZiAodGhpcy5leHBlY3RCdWZmZXIgPT0gbnVsbCkge1xuICAgIHRoaXMub3ZlcmZsb3cucHVzaChkYXRhKTtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIHRvUmVhZCA9IE1hdGgubWluKGRhdGFMZW5ndGgsIHRoaXMuZXhwZWN0QnVmZmVyLmxlbmd0aCAtIHRoaXMuZXhwZWN0T2Zmc2V0KTtcbiAgZmFzdENvcHkodG9SZWFkLCBkYXRhLCB0aGlzLmV4cGVjdEJ1ZmZlciwgdGhpcy5leHBlY3RPZmZzZXQpO1xuICB0aGlzLmV4cGVjdE9mZnNldCArPSB0b1JlYWQ7XG4gIGlmICh0b1JlYWQgPCBkYXRhTGVuZ3RoKSB7XG4gICAgdGhpcy5vdmVyZmxvdy5wdXNoKGRhdGEuc2xpY2UodG9SZWFkKSk7XG4gIH1cbiAgd2hpbGUgKHRoaXMuZXhwZWN0QnVmZmVyICYmIHRoaXMuZXhwZWN0T2Zmc2V0ID09IHRoaXMuZXhwZWN0QnVmZmVyLmxlbmd0aCkge1xuICAgIHZhciBidWZmZXJGb3JIYW5kbGVyID0gdGhpcy5leHBlY3RCdWZmZXI7XG4gICAgdGhpcy5leHBlY3RCdWZmZXIgPSBudWxsO1xuICAgIHRoaXMuZXhwZWN0T2Zmc2V0ID0gMDtcbiAgICB0aGlzLmV4cGVjdEhhbmRsZXIuY2FsbCh0aGlzLCBidWZmZXJGb3JIYW5kbGVyKTtcbiAgfVxufTtcblxuLyoqXG4gKiBSZWxlYXNlcyBhbGwgcmVzb3VyY2VzIHVzZWQgYnkgdGhlIHJlY2VpdmVyLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuUmVjZWl2ZXIucHJvdG90eXBlLmNsZWFudXAgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5kZWFkID0gdHJ1ZTtcbiAgdGhpcy5vdmVyZmxvdyA9IG51bGw7XG4gIHRoaXMuaGVhZGVyQnVmZmVyID0gbnVsbDtcbiAgdGhpcy5leHBlY3RCdWZmZXIgPSBudWxsO1xuICB0aGlzLmV4cGVjdEhhbmRsZXIgPSBudWxsO1xuICB0aGlzLnVuZnJhZ21lbnRlZEJ1ZmZlclBvb2wgPSBudWxsO1xuICB0aGlzLmZyYWdtZW50ZWRCdWZmZXJQb29sID0gbnVsbDtcbiAgdGhpcy5zdGF0ZSA9IG51bGw7XG4gIHRoaXMuY3VycmVudE1lc3NhZ2UgPSBudWxsO1xuICB0aGlzLm9uZXJyb3IgPSBudWxsO1xuICB0aGlzLm9udGV4dCA9IG51bGw7XG4gIHRoaXMub25iaW5hcnkgPSBudWxsO1xuICB0aGlzLm9uY2xvc2UgPSBudWxsO1xuICB0aGlzLm9ucGluZyA9IG51bGw7XG4gIHRoaXMub25wb25nID0gbnVsbDtcbn07XG5cbi8qKlxuICogV2FpdHMgZm9yIGEgY2VydGFpbiBhbW91bnQgb2YgaGVhZGVyIGJ5dGVzIHRvIGJlIGF2YWlsYWJsZSwgdGhlbiBmaXJlcyBhIGNhbGxiYWNrLlxuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS5leHBlY3RIZWFkZXIgPSBmdW5jdGlvbihsZW5ndGgsIGhhbmRsZXIpIHtcbiAgaWYgKGxlbmd0aCA9PSAwKSB7XG4gICAgaGFuZGxlcihudWxsKTtcbiAgICByZXR1cm47XG4gIH1cbiAgdGhpcy5leHBlY3RCdWZmZXIgPSB0aGlzLmhlYWRlckJ1ZmZlci5zbGljZSh0aGlzLmV4cGVjdE9mZnNldCwgdGhpcy5leHBlY3RPZmZzZXQgKyBsZW5ndGgpO1xuICB0aGlzLmV4cGVjdEhhbmRsZXIgPSBoYW5kbGVyO1xuICB2YXIgdG9SZWFkID0gbGVuZ3RoO1xuICB3aGlsZSAodG9SZWFkID4gMCAmJiB0aGlzLm92ZXJmbG93Lmxlbmd0aCA+IDApIHtcbiAgICB2YXIgZnJvbU92ZXJmbG93ID0gdGhpcy5vdmVyZmxvdy5wb3AoKTtcbiAgICBpZiAodG9SZWFkIDwgZnJvbU92ZXJmbG93Lmxlbmd0aCkgdGhpcy5vdmVyZmxvdy5wdXNoKGZyb21PdmVyZmxvdy5zbGljZSh0b1JlYWQpKTtcbiAgICB2YXIgcmVhZCA9IE1hdGgubWluKGZyb21PdmVyZmxvdy5sZW5ndGgsIHRvUmVhZCk7XG4gICAgZmFzdENvcHkocmVhZCwgZnJvbU92ZXJmbG93LCB0aGlzLmV4cGVjdEJ1ZmZlciwgdGhpcy5leHBlY3RPZmZzZXQpO1xuICAgIHRoaXMuZXhwZWN0T2Zmc2V0ICs9IHJlYWQ7XG4gICAgdG9SZWFkIC09IHJlYWQ7XG4gIH1cbn07XG5cbi8qKlxuICogV2FpdHMgZm9yIGEgY2VydGFpbiBhbW91bnQgb2YgZGF0YSBieXRlcyB0byBiZSBhdmFpbGFibGUsIHRoZW4gZmlyZXMgYSBjYWxsYmFjay5cbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5SZWNlaXZlci5wcm90b3R5cGUuZXhwZWN0RGF0YSA9IGZ1bmN0aW9uKGxlbmd0aCwgaGFuZGxlcikge1xuICBpZiAobGVuZ3RoID09IDApIHtcbiAgICBoYW5kbGVyKG51bGwpO1xuICAgIHJldHVybjtcbiAgfVxuICB0aGlzLmV4cGVjdEJ1ZmZlciA9IHRoaXMuYWxsb2NhdGVGcm9tUG9vbChsZW5ndGgsIHRoaXMuc3RhdGUuZnJhZ21lbnRlZE9wZXJhdGlvbik7XG4gIHRoaXMuZXhwZWN0SGFuZGxlciA9IGhhbmRsZXI7XG4gIHZhciB0b1JlYWQgPSBsZW5ndGg7XG4gIHdoaWxlICh0b1JlYWQgPiAwICYmIHRoaXMub3ZlcmZsb3cubGVuZ3RoID4gMCkge1xuICAgIHZhciBmcm9tT3ZlcmZsb3cgPSB0aGlzLm92ZXJmbG93LnBvcCgpO1xuICAgIGlmICh0b1JlYWQgPCBmcm9tT3ZlcmZsb3cubGVuZ3RoKSB0aGlzLm92ZXJmbG93LnB1c2goZnJvbU92ZXJmbG93LnNsaWNlKHRvUmVhZCkpO1xuICAgIHZhciByZWFkID0gTWF0aC5taW4oZnJvbU92ZXJmbG93Lmxlbmd0aCwgdG9SZWFkKTtcbiAgICBmYXN0Q29weShyZWFkLCBmcm9tT3ZlcmZsb3csIHRoaXMuZXhwZWN0QnVmZmVyLCB0aGlzLmV4cGVjdE9mZnNldCk7XG4gICAgdGhpcy5leHBlY3RPZmZzZXQgKz0gcmVhZDtcbiAgICB0b1JlYWQgLT0gcmVhZDtcbiAgfVxufTtcblxuLyoqXG4gKiBBbGxvY2F0ZXMgbWVtb3J5IGZyb20gdGhlIGJ1ZmZlciBwb29sLlxuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS5hbGxvY2F0ZUZyb21Qb29sID0gZnVuY3Rpb24obGVuZ3RoLCBpc0ZyYWdtZW50ZWQpIHtcbiAgcmV0dXJuIChpc0ZyYWdtZW50ZWQgPyB0aGlzLmZyYWdtZW50ZWRCdWZmZXJQb29sIDogdGhpcy51bmZyYWdtZW50ZWRCdWZmZXJQb29sKS5nZXQobGVuZ3RoKTtcbn07XG5cbi8qKlxuICogU3RhcnQgcHJvY2Vzc2luZyBhIG5ldyBwYWNrZXQuXG4gKlxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuUmVjZWl2ZXIucHJvdG90eXBlLnByb2Nlc3NQYWNrZXQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBpZiAodGhpcy5leHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdKSB7XG4gICAgaWYgKChkYXRhWzBdICYgMHgzMCkgIT0gMCkge1xuICAgICAgdGhpcy5lcnJvcigncmVzZXJ2ZWQgZmllbGRzICgyLCAzKSBtdXN0IGJlIGVtcHR5JywgMTAwMik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmICgoZGF0YVswXSAmIDB4NzApICE9IDApIHtcbiAgICAgIHRoaXMuZXJyb3IoJ3Jlc2VydmVkIGZpZWxkcyBtdXN0IGJlIGVtcHR5JywgMTAwMik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG4gIHRoaXMuc3RhdGUubGFzdEZyYWdtZW50ID0gKGRhdGFbMF0gJiAweDgwKSA9PSAweDgwO1xuICB0aGlzLnN0YXRlLm1hc2tlZCA9IChkYXRhWzFdICYgMHg4MCkgPT0gMHg4MDtcbiAgdmFyIGNvbXByZXNzZWQgPSAoZGF0YVswXSAmIDB4NDApID09IDB4NDA7XG4gIHZhciBvcGNvZGUgPSBkYXRhWzBdICYgMHhmO1xuICBpZiAob3Bjb2RlID09PSAwKSB7XG4gICAgaWYgKGNvbXByZXNzZWQpIHtcbiAgICAgIHRoaXMuZXJyb3IoJ2NvbnRpbnVhdGlvbiBmcmFtZSBjYW5ub3QgaGF2ZSB0aGUgUGVyLW1lc3NhZ2UgQ29tcHJlc3NlZCBiaXRzJywgMTAwMik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIGNvbnRpbnVhdGlvbiBmcmFtZVxuICAgIHRoaXMuc3RhdGUuZnJhZ21lbnRlZE9wZXJhdGlvbiA9IHRydWU7XG4gICAgdGhpcy5zdGF0ZS5vcGNvZGUgPSB0aGlzLnN0YXRlLmFjdGl2ZUZyYWdtZW50ZWRPcGVyYXRpb247XG4gICAgaWYgKCEodGhpcy5zdGF0ZS5vcGNvZGUgPT0gMSB8fCB0aGlzLnN0YXRlLm9wY29kZSA9PSAyKSkge1xuICAgICAgdGhpcy5lcnJvcignY29udGludWF0aW9uIGZyYW1lIGNhbm5vdCBmb2xsb3cgY3VycmVudCBvcGNvZGUnLCAxMDAyKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cbiAgZWxzZSB7XG4gICAgaWYgKG9wY29kZSA8IDMgJiYgdGhpcy5zdGF0ZS5hY3RpdmVGcmFnbWVudGVkT3BlcmF0aW9uICE9IG51bGwpIHtcbiAgICAgIHRoaXMuZXJyb3IoJ2RhdGEgZnJhbWVzIGFmdGVyIHRoZSBpbml0aWFsIGRhdGEgZnJhbWUgbXVzdCBoYXZlIG9wY29kZSAwJywgMTAwMik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChvcGNvZGUgPj0gOCAmJiBjb21wcmVzc2VkKSB7XG4gICAgICB0aGlzLmVycm9yKCdjb250cm9sIGZyYW1lcyBjYW5ub3QgaGF2ZSB0aGUgUGVyLW1lc3NhZ2UgQ29tcHJlc3NlZCBiaXRzJywgMTAwMik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc3RhdGUuY29tcHJlc3NlZCA9IGNvbXByZXNzZWQ7XG4gICAgdGhpcy5zdGF0ZS5vcGNvZGUgPSBvcGNvZGU7XG4gICAgaWYgKHRoaXMuc3RhdGUubGFzdEZyYWdtZW50ID09PSBmYWxzZSkge1xuICAgICAgdGhpcy5zdGF0ZS5mcmFnbWVudGVkT3BlcmF0aW9uID0gdHJ1ZTtcbiAgICAgIHRoaXMuc3RhdGUuYWN0aXZlRnJhZ21lbnRlZE9wZXJhdGlvbiA9IG9wY29kZTtcbiAgICB9XG4gICAgZWxzZSB0aGlzLnN0YXRlLmZyYWdtZW50ZWRPcGVyYXRpb24gPSBmYWxzZTtcbiAgfVxuICB2YXIgaGFuZGxlciA9IG9wY29kZXNbdGhpcy5zdGF0ZS5vcGNvZGVdO1xuICBpZiAodHlwZW9mIGhhbmRsZXIgPT0gJ3VuZGVmaW5lZCcpIHRoaXMuZXJyb3IoJ25vIGhhbmRsZXIgZm9yIG9wY29kZSAnICsgdGhpcy5zdGF0ZS5vcGNvZGUsIDEwMDIpO1xuICBlbHNlIHtcbiAgICBoYW5kbGVyLnN0YXJ0LmNhbGwodGhpcywgZGF0YSk7XG4gIH1cbn07XG5cbi8qKlxuICogRW5kcHJvY2Vzc2luZyBhIHBhY2tldC5cbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5SZWNlaXZlci5wcm90b3R5cGUuZW5kUGFja2V0ID0gZnVuY3Rpb24oKSB7XG4gIGlmICghdGhpcy5zdGF0ZS5mcmFnbWVudGVkT3BlcmF0aW9uKSB0aGlzLnVuZnJhZ21lbnRlZEJ1ZmZlclBvb2wucmVzZXQodHJ1ZSk7XG4gIGVsc2UgaWYgKHRoaXMuc3RhdGUubGFzdEZyYWdtZW50KSB0aGlzLmZyYWdtZW50ZWRCdWZmZXJQb29sLnJlc2V0KHRydWUpO1xuICB0aGlzLmV4cGVjdE9mZnNldCA9IDA7XG4gIHRoaXMuZXhwZWN0QnVmZmVyID0gbnVsbDtcbiAgdGhpcy5leHBlY3RIYW5kbGVyID0gbnVsbDtcbiAgaWYgKHRoaXMuc3RhdGUubGFzdEZyYWdtZW50ICYmIHRoaXMuc3RhdGUub3Bjb2RlID09PSB0aGlzLnN0YXRlLmFjdGl2ZUZyYWdtZW50ZWRPcGVyYXRpb24pIHtcbiAgICAvLyBlbmQgY3VycmVudCBmcmFnbWVudGVkIG9wZXJhdGlvblxuICAgIHRoaXMuc3RhdGUuYWN0aXZlRnJhZ21lbnRlZE9wZXJhdGlvbiA9IG51bGw7XG4gIH1cbiAgdGhpcy5zdGF0ZS5sYXN0RnJhZ21lbnQgPSBmYWxzZTtcbiAgdGhpcy5zdGF0ZS5vcGNvZGUgPSB0aGlzLnN0YXRlLmFjdGl2ZUZyYWdtZW50ZWRPcGVyYXRpb24gIT0gbnVsbCA/IHRoaXMuc3RhdGUuYWN0aXZlRnJhZ21lbnRlZE9wZXJhdGlvbiA6IDA7XG4gIHRoaXMuc3RhdGUubWFza2VkID0gZmFsc2U7XG4gIHRoaXMuZXhwZWN0SGVhZGVyKDIsIHRoaXMucHJvY2Vzc1BhY2tldCk7XG59O1xuXG4vKipcbiAqIFJlc2V0IHRoZSBwYXJzZXIgc3RhdGUuXG4gKlxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuUmVjZWl2ZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG4gIGlmICh0aGlzLmRlYWQpIHJldHVybjtcbiAgdGhpcy5zdGF0ZSA9IHtcbiAgICBhY3RpdmVGcmFnbWVudGVkT3BlcmF0aW9uOiBudWxsLFxuICAgIGxhc3RGcmFnbWVudDogZmFsc2UsXG4gICAgbWFza2VkOiBmYWxzZSxcbiAgICBvcGNvZGU6IDAsXG4gICAgZnJhZ21lbnRlZE9wZXJhdGlvbjogZmFsc2VcbiAgfTtcbiAgdGhpcy5mcmFnbWVudGVkQnVmZmVyUG9vbC5yZXNldCh0cnVlKTtcbiAgdGhpcy51bmZyYWdtZW50ZWRCdWZmZXJQb29sLnJlc2V0KHRydWUpO1xuICB0aGlzLmV4cGVjdE9mZnNldCA9IDA7XG4gIHRoaXMuZXhwZWN0QnVmZmVyID0gbnVsbDtcbiAgdGhpcy5leHBlY3RIYW5kbGVyID0gbnVsbDtcbiAgdGhpcy5vdmVyZmxvdyA9IFtdO1xuICB0aGlzLmN1cnJlbnRNZXNzYWdlID0gW107XG4gIHRoaXMubWVzc2FnZUhhbmRsZXJzID0gW107XG59O1xuXG4vKipcbiAqIFVubWFzayByZWNlaXZlZCBkYXRhLlxuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS51bm1hc2sgPSBmdW5jdGlvbiAobWFzaywgYnVmLCBiaW5hcnkpIHtcbiAgaWYgKG1hc2sgIT0gbnVsbCAmJiBidWYgIT0gbnVsbCkgYnVmZmVyVXRpbC51bm1hc2soYnVmLCBtYXNrKTtcbiAgaWYgKGJpbmFyeSkgcmV0dXJuIGJ1ZjtcbiAgcmV0dXJuIGJ1ZiAhPSBudWxsID8gYnVmLnRvU3RyaW5nKCd1dGY4JykgOiAnJztcbn07XG5cbi8qKlxuICogQ29uY2F0ZW5hdGVzIGEgbGlzdCBvZiBidWZmZXJzLlxuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS5jb25jYXRCdWZmZXJzID0gZnVuY3Rpb24oYnVmZmVycykge1xuICB2YXIgbGVuZ3RoID0gMDtcbiAgZm9yICh2YXIgaSA9IDAsIGwgPSBidWZmZXJzLmxlbmd0aDsgaSA8IGw7ICsraSkgbGVuZ3RoICs9IGJ1ZmZlcnNbaV0ubGVuZ3RoO1xuICB2YXIgbWVyZ2VkQnVmZmVyID0gbmV3IEJ1ZmZlcihsZW5ndGgpO1xuICBidWZmZXJVdGlsLm1lcmdlKG1lcmdlZEJ1ZmZlciwgYnVmZmVycyk7XG4gIHJldHVybiBtZXJnZWRCdWZmZXI7XG59O1xuXG4vKipcbiAqIEhhbmRsZXMgYW4gZXJyb3JcbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5SZWNlaXZlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAocmVhc29uLCBwcm90b2NvbEVycm9yQ29kZSkge1xuICB0aGlzLnJlc2V0KCk7XG4gIHRoaXMub25lcnJvcihyZWFzb24sIHByb3RvY29sRXJyb3JDb2RlKTtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEV4ZWN1dGUgbWVzc2FnZSBoYW5kbGVyIGJ1ZmZlcnNcbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5SZWNlaXZlci5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMucHJvY2Vzc2luZyB8fCB0aGlzLmRlYWQpIHJldHVybjtcblxuICB2YXIgaGFuZGxlciA9IHRoaXMubWVzc2FnZUhhbmRsZXJzLnNoaWZ0KCk7XG4gIGlmICghaGFuZGxlcikgcmV0dXJuO1xuXG4gIHRoaXMucHJvY2Vzc2luZyA9IHRydWU7XG4gIHZhciBzZWxmID0gdGhpcztcblxuICBoYW5kbGVyKGZ1bmN0aW9uKCkge1xuICAgIHNlbGYucHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgIHNlbGYuZmx1c2goKTtcbiAgfSk7XG59O1xuXG4vKipcbiAqIEFwcGx5IGV4dGVuc2lvbnMgdG8gbWVzc2FnZVxuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblJlY2VpdmVyLnByb3RvdHlwZS5hcHBseUV4dGVuc2lvbnMgPSBmdW5jdGlvbihtZXNzYWdlQnVmZmVyLCBmaW4sIGNvbXByZXNzZWQsIGNhbGxiYWNrKSB7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgaWYgKGNvbXByZXNzZWQpIHtcbiAgICB0aGlzLmV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0uZGVjb21wcmVzcyhtZXNzYWdlQnVmZmVyLCBmaW4sIGZ1bmN0aW9uKGVyciwgYnVmZmVyKSB7XG4gICAgICBpZiAoc2VsZi5kZWFkKSByZXR1cm47XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcignaW52YWxpZCBjb21wcmVzc2VkIGRhdGEnKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNhbGxiYWNrKG51bGwsIGJ1ZmZlcik7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgY2FsbGJhY2sobnVsbCwgbWVzc2FnZUJ1ZmZlcik7XG4gIH1cbn07XG5cbi8qKlxuICogQnVmZmVyIHV0aWxpdGllc1xuICovXG5cbmZ1bmN0aW9uIHJlYWRVSW50MTZCRShzdGFydCkge1xuICByZXR1cm4gKHRoaXNbc3RhcnRdPDw4KSArXG4gICAgICAgICB0aGlzW3N0YXJ0KzFdO1xufVxuXG5mdW5jdGlvbiByZWFkVUludDMyQkUoc3RhcnQpIHtcbiAgcmV0dXJuICh0aGlzW3N0YXJ0XTw8MjQpICtcbiAgICAgICAgICh0aGlzW3N0YXJ0KzFdPDwxNikgK1xuICAgICAgICAgKHRoaXNbc3RhcnQrMl08PDgpICtcbiAgICAgICAgIHRoaXNbc3RhcnQrM107XG59XG5cbmZ1bmN0aW9uIGZhc3RDb3B5KGxlbmd0aCwgc3JjQnVmZmVyLCBkc3RCdWZmZXIsIGRzdE9mZnNldCkge1xuICBzd2l0Y2ggKGxlbmd0aCkge1xuICAgIGRlZmF1bHQ6IHNyY0J1ZmZlci5jb3B5KGRzdEJ1ZmZlciwgZHN0T2Zmc2V0LCAwLCBsZW5ndGgpOyBicmVhaztcbiAgICBjYXNlIDE2OiBkc3RCdWZmZXJbZHN0T2Zmc2V0KzE1XSA9IHNyY0J1ZmZlclsxNV07XG4gICAgY2FzZSAxNTogZHN0QnVmZmVyW2RzdE9mZnNldCsxNF0gPSBzcmNCdWZmZXJbMTRdO1xuICAgIGNhc2UgMTQ6IGRzdEJ1ZmZlcltkc3RPZmZzZXQrMTNdID0gc3JjQnVmZmVyWzEzXTtcbiAgICBjYXNlIDEzOiBkc3RCdWZmZXJbZHN0T2Zmc2V0KzEyXSA9IHNyY0J1ZmZlclsxMl07XG4gICAgY2FzZSAxMjogZHN0QnVmZmVyW2RzdE9mZnNldCsxMV0gPSBzcmNCdWZmZXJbMTFdO1xuICAgIGNhc2UgMTE6IGRzdEJ1ZmZlcltkc3RPZmZzZXQrMTBdID0gc3JjQnVmZmVyWzEwXTtcbiAgICBjYXNlIDEwOiBkc3RCdWZmZXJbZHN0T2Zmc2V0KzldID0gc3JjQnVmZmVyWzldO1xuICAgIGNhc2UgOTogZHN0QnVmZmVyW2RzdE9mZnNldCs4XSA9IHNyY0J1ZmZlcls4XTtcbiAgICBjYXNlIDg6IGRzdEJ1ZmZlcltkc3RPZmZzZXQrN10gPSBzcmNCdWZmZXJbN107XG4gICAgY2FzZSA3OiBkc3RCdWZmZXJbZHN0T2Zmc2V0KzZdID0gc3JjQnVmZmVyWzZdO1xuICAgIGNhc2UgNjogZHN0QnVmZmVyW2RzdE9mZnNldCs1XSA9IHNyY0J1ZmZlcls1XTtcbiAgICBjYXNlIDU6IGRzdEJ1ZmZlcltkc3RPZmZzZXQrNF0gPSBzcmNCdWZmZXJbNF07XG4gICAgY2FzZSA0OiBkc3RCdWZmZXJbZHN0T2Zmc2V0KzNdID0gc3JjQnVmZmVyWzNdO1xuICAgIGNhc2UgMzogZHN0QnVmZmVyW2RzdE9mZnNldCsyXSA9IHNyY0J1ZmZlclsyXTtcbiAgICBjYXNlIDI6IGRzdEJ1ZmZlcltkc3RPZmZzZXQrMV0gPSBzcmNCdWZmZXJbMV07XG4gICAgY2FzZSAxOiBkc3RCdWZmZXJbZHN0T2Zmc2V0XSA9IHNyY0J1ZmZlclswXTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjbG9uZShvYmopIHtcbiAgdmFyIGNsb25lZCA9IHt9O1xuICBmb3IgKHZhciBrIGluIG9iaikge1xuICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoaykpIHtcbiAgICAgIGNsb25lZFtrXSA9IG9ialtrXTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNsb25lZDtcbn1cblxuLyoqXG4gKiBPcGNvZGUgaGFuZGxlcnNcbiAqL1xuXG52YXIgb3Bjb2RlcyA9IHtcbiAgLy8gdGV4dFxuICAnMSc6IHtcbiAgICBzdGFydDogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgLy8gZGVjb2RlIGxlbmd0aFxuICAgICAgdmFyIGZpcnN0TGVuZ3RoID0gZGF0YVsxXSAmIDB4N2Y7XG4gICAgICBpZiAoZmlyc3RMZW5ndGggPCAxMjYpIHtcbiAgICAgICAgb3Bjb2Rlc1snMSddLmdldERhdGEuY2FsbChzZWxmLCBmaXJzdExlbmd0aCk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChmaXJzdExlbmd0aCA9PSAxMjYpIHtcbiAgICAgICAgc2VsZi5leHBlY3RIZWFkZXIoMiwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIG9wY29kZXNbJzEnXS5nZXREYXRhLmNhbGwoc2VsZiwgcmVhZFVJbnQxNkJFLmNhbGwoZGF0YSwgMCkpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGZpcnN0TGVuZ3RoID09IDEyNykge1xuICAgICAgICBzZWxmLmV4cGVjdEhlYWRlcig4LCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgaWYgKHJlYWRVSW50MzJCRS5jYWxsKGRhdGEsIDApICE9IDApIHtcbiAgICAgICAgICAgIHNlbGYuZXJyb3IoJ3BhY2tldHMgd2l0aCBsZW5ndGggc3Bhbm5pbmcgbW9yZSB0aGFuIDMyIGJpdCBpcyBjdXJyZW50bHkgbm90IHN1cHBvcnRlZCcsIDEwMDgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcGNvZGVzWycxJ10uZ2V0RGF0YS5jYWxsKHNlbGYsIHJlYWRVSW50MzJCRS5jYWxsKGRhdGEsIDQpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBnZXREYXRhOiBmdW5jdGlvbihsZW5ndGgpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIGlmIChzZWxmLnN0YXRlLm1hc2tlZCkge1xuICAgICAgICBzZWxmLmV4cGVjdEhlYWRlcig0LCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgdmFyIG1hc2sgPSBkYXRhO1xuICAgICAgICAgIHNlbGYuZXhwZWN0RGF0YShsZW5ndGgsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIG9wY29kZXNbJzEnXS5maW5pc2guY2FsbChzZWxmLCBtYXNrLCBkYXRhKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgc2VsZi5leHBlY3REYXRhKGxlbmd0aCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIG9wY29kZXNbJzEnXS5maW5pc2guY2FsbChzZWxmLCBudWxsLCBkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBmaW5pc2g6IGZ1bmN0aW9uKG1hc2ssIGRhdGEpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIHZhciBwYWNrZXQgPSB0aGlzLnVubWFzayhtYXNrLCBkYXRhLCB0cnVlKSB8fCBuZXcgQnVmZmVyKDApO1xuICAgICAgdmFyIHN0YXRlID0gY2xvbmUodGhpcy5zdGF0ZSk7XG4gICAgICB0aGlzLm1lc3NhZ2VIYW5kbGVycy5wdXNoKGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgIHNlbGYuYXBwbHlFeHRlbnNpb25zKHBhY2tldCwgc3RhdGUubGFzdEZyYWdtZW50LCBzdGF0ZS5jb21wcmVzc2VkLCBmdW5jdGlvbihlcnIsIGJ1ZmZlcikge1xuICAgICAgICAgIGlmIChlcnIpIHJldHVybiBzZWxmLmVycm9yKGVyci5tZXNzYWdlLCAxMDA3KTtcbiAgICAgICAgICBpZiAoYnVmZmVyICE9IG51bGwpIHNlbGYuY3VycmVudE1lc3NhZ2UucHVzaChidWZmZXIpO1xuXG4gICAgICAgICAgaWYgKHN0YXRlLmxhc3RGcmFnbWVudCkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2VCdWZmZXIgPSBzZWxmLmNvbmNhdEJ1ZmZlcnMoc2VsZi5jdXJyZW50TWVzc2FnZSk7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRNZXNzYWdlID0gW107XG4gICAgICAgICAgICBpZiAoIVZhbGlkYXRpb24uaXNWYWxpZFVURjgobWVzc2FnZUJ1ZmZlcikpIHtcbiAgICAgICAgICAgICAgc2VsZi5lcnJvcignaW52YWxpZCB1dGY4IHNlcXVlbmNlJywgMTAwNyk7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGYub250ZXh0KG1lc3NhZ2VCdWZmZXIudG9TdHJpbmcoJ3V0ZjgnKSwge21hc2tlZDogc3RhdGUubWFza2VkLCBidWZmZXI6IG1lc3NhZ2VCdWZmZXJ9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZmx1c2goKTtcbiAgICAgIHRoaXMuZW5kUGFja2V0KCk7XG4gICAgfVxuICB9LFxuICAvLyBiaW5hcnlcbiAgJzInOiB7XG4gICAgc3RhcnQ6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIC8vIGRlY29kZSBsZW5ndGhcbiAgICAgIHZhciBmaXJzdExlbmd0aCA9IGRhdGFbMV0gJiAweDdmO1xuICAgICAgaWYgKGZpcnN0TGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgIG9wY29kZXNbJzInXS5nZXREYXRhLmNhbGwoc2VsZiwgZmlyc3RMZW5ndGgpO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZmlyc3RMZW5ndGggPT0gMTI2KSB7XG4gICAgICAgIHNlbGYuZXhwZWN0SGVhZGVyKDIsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBvcGNvZGVzWycyJ10uZ2V0RGF0YS5jYWxsKHNlbGYsIHJlYWRVSW50MTZCRS5jYWxsKGRhdGEsIDApKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChmaXJzdExlbmd0aCA9PSAxMjcpIHtcbiAgICAgICAgc2VsZi5leHBlY3RIZWFkZXIoOCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIGlmIChyZWFkVUludDMyQkUuY2FsbChkYXRhLCAwKSAhPSAwKSB7XG4gICAgICAgICAgICBzZWxmLmVycm9yKCdwYWNrZXRzIHdpdGggbGVuZ3RoIHNwYW5uaW5nIG1vcmUgdGhhbiAzMiBiaXQgaXMgY3VycmVudGx5IG5vdCBzdXBwb3J0ZWQnLCAxMDA4KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgb3Bjb2Rlc1snMiddLmdldERhdGEuY2FsbChzZWxmLCByZWFkVUludDMyQkUuY2FsbChkYXRhLCA0LCB0cnVlKSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgZ2V0RGF0YTogZnVuY3Rpb24obGVuZ3RoKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBpZiAoc2VsZi5zdGF0ZS5tYXNrZWQpIHtcbiAgICAgICAgc2VsZi5leHBlY3RIZWFkZXIoNCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIHZhciBtYXNrID0gZGF0YTtcbiAgICAgICAgICBzZWxmLmV4cGVjdERhdGEobGVuZ3RoLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBvcGNvZGVzWycyJ10uZmluaXNoLmNhbGwoc2VsZiwgbWFzaywgZGF0YSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHNlbGYuZXhwZWN0RGF0YShsZW5ndGgsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBvcGNvZGVzWycyJ10uZmluaXNoLmNhbGwoc2VsZiwgbnVsbCwgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgZmluaXNoOiBmdW5jdGlvbihtYXNrLCBkYXRhKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB2YXIgcGFja2V0ID0gdGhpcy51bm1hc2sobWFzaywgZGF0YSwgdHJ1ZSkgfHwgbmV3IEJ1ZmZlcigwKTtcbiAgICAgIHZhciBzdGF0ZSA9IGNsb25lKHRoaXMuc3RhdGUpO1xuICAgICAgdGhpcy5tZXNzYWdlSGFuZGxlcnMucHVzaChmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICBzZWxmLmFwcGx5RXh0ZW5zaW9ucyhwYWNrZXQsIHN0YXRlLmxhc3RGcmFnbWVudCwgc3RhdGUuY29tcHJlc3NlZCwgZnVuY3Rpb24oZXJyLCBidWZmZXIpIHtcbiAgICAgICAgICBpZiAoZXJyKSByZXR1cm4gc2VsZi5lcnJvcihlcnIubWVzc2FnZSwgMTAwNyk7XG4gICAgICAgICAgaWYgKGJ1ZmZlciAhPSBudWxsKSBzZWxmLmN1cnJlbnRNZXNzYWdlLnB1c2goYnVmZmVyKTtcbiAgICAgICAgICBpZiAoc3RhdGUubGFzdEZyYWdtZW50KSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZUJ1ZmZlciA9IHNlbGYuY29uY2F0QnVmZmVycyhzZWxmLmN1cnJlbnRNZXNzYWdlKTtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudE1lc3NhZ2UgPSBbXTtcbiAgICAgICAgICAgIHNlbGYub25iaW5hcnkobWVzc2FnZUJ1ZmZlciwge21hc2tlZDogc3RhdGUubWFza2VkLCBidWZmZXI6IG1lc3NhZ2VCdWZmZXJ9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZmx1c2goKTtcbiAgICAgIHRoaXMuZW5kUGFja2V0KCk7XG4gICAgfVxuICB9LFxuICAvLyBjbG9zZVxuICAnOCc6IHtcbiAgICBzdGFydDogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgaWYgKHNlbGYuc3RhdGUubGFzdEZyYWdtZW50ID09IGZhbHNlKSB7XG4gICAgICAgIHNlbGYuZXJyb3IoJ2ZyYWdtZW50ZWQgY2xvc2UgaXMgbm90IHN1cHBvcnRlZCcsIDEwMDIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIGRlY29kZSBsZW5ndGhcbiAgICAgIHZhciBmaXJzdExlbmd0aCA9IGRhdGFbMV0gJiAweDdmO1xuICAgICAgaWYgKGZpcnN0TGVuZ3RoIDwgMTI2KSB7XG4gICAgICAgIG9wY29kZXNbJzgnXS5nZXREYXRhLmNhbGwoc2VsZiwgZmlyc3RMZW5ndGgpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHNlbGYuZXJyb3IoJ2NvbnRyb2wgZnJhbWVzIGNhbm5vdCBoYXZlIG1vcmUgdGhhbiAxMjUgYnl0ZXMgb2YgZGF0YScsIDEwMDIpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZ2V0RGF0YTogZnVuY3Rpb24obGVuZ3RoKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBpZiAoc2VsZi5zdGF0ZS5tYXNrZWQpIHtcbiAgICAgICAgc2VsZi5leHBlY3RIZWFkZXIoNCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIHZhciBtYXNrID0gZGF0YTtcbiAgICAgICAgICBzZWxmLmV4cGVjdERhdGEobGVuZ3RoLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBvcGNvZGVzWyc4J10uZmluaXNoLmNhbGwoc2VsZiwgbWFzaywgZGF0YSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHNlbGYuZXhwZWN0RGF0YShsZW5ndGgsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICBvcGNvZGVzWyc4J10uZmluaXNoLmNhbGwoc2VsZiwgbnVsbCwgZGF0YSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgZmluaXNoOiBmdW5jdGlvbihtYXNrLCBkYXRhKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBkYXRhID0gc2VsZi51bm1hc2sobWFzaywgZGF0YSwgdHJ1ZSk7XG5cbiAgICAgIHZhciBzdGF0ZSA9IGNsb25lKHRoaXMuc3RhdGUpO1xuICAgICAgdGhpcy5tZXNzYWdlSGFuZGxlcnMucHVzaChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGggPT0gMSkge1xuICAgICAgICAgIHNlbGYuZXJyb3IoJ2Nsb3NlIHBhY2tldHMgd2l0aCBkYXRhIG11c3QgYmUgYXQgbGVhc3QgdHdvIGJ5dGVzIGxvbmcnLCAxMDAyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvZGUgPSBkYXRhICYmIGRhdGEubGVuZ3RoID4gMSA/IHJlYWRVSW50MTZCRS5jYWxsKGRhdGEsIDApIDogMTAwMDtcbiAgICAgICAgaWYgKCFFcnJvckNvZGVzLmlzVmFsaWRFcnJvckNvZGUoY29kZSkpIHtcbiAgICAgICAgICBzZWxmLmVycm9yKCdpbnZhbGlkIGVycm9yIGNvZGUnLCAxMDAyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1lc3NhZ2UgPSAnJztcbiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgdmFyIG1lc3NhZ2VCdWZmZXIgPSBkYXRhLnNsaWNlKDIpO1xuICAgICAgICAgIGlmICghVmFsaWRhdGlvbi5pc1ZhbGlkVVRGOChtZXNzYWdlQnVmZmVyKSkge1xuICAgICAgICAgICAgc2VsZi5lcnJvcignaW52YWxpZCB1dGY4IHNlcXVlbmNlJywgMTAwNyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlQnVmZmVyLnRvU3RyaW5nKCd1dGY4Jyk7XG4gICAgICAgIH1cbiAgICAgICAgc2VsZi5vbmNsb3NlKGNvZGUsIG1lc3NhZ2UsIHttYXNrZWQ6IHN0YXRlLm1hc2tlZH0pO1xuICAgICAgICBzZWxmLnJlc2V0KCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZmx1c2goKTtcbiAgICB9LFxuICB9LFxuICAvLyBwaW5nXG4gICc5Jzoge1xuICAgIHN0YXJ0OiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBpZiAoc2VsZi5zdGF0ZS5sYXN0RnJhZ21lbnQgPT0gZmFsc2UpIHtcbiAgICAgICAgc2VsZi5lcnJvcignZnJhZ21lbnRlZCBwaW5nIGlzIG5vdCBzdXBwb3J0ZWQnLCAxMDAyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBkZWNvZGUgbGVuZ3RoXG4gICAgICB2YXIgZmlyc3RMZW5ndGggPSBkYXRhWzFdICYgMHg3ZjtcbiAgICAgIGlmIChmaXJzdExlbmd0aCA8IDEyNikge1xuICAgICAgICBvcGNvZGVzWyc5J10uZ2V0RGF0YS5jYWxsKHNlbGYsIGZpcnN0TGVuZ3RoKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBzZWxmLmVycm9yKCdjb250cm9sIGZyYW1lcyBjYW5ub3QgaGF2ZSBtb3JlIHRoYW4gMTI1IGJ5dGVzIG9mIGRhdGEnLCAxMDAyKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGdldERhdGE6IGZ1bmN0aW9uKGxlbmd0aCkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgaWYgKHNlbGYuc3RhdGUubWFza2VkKSB7XG4gICAgICAgIHNlbGYuZXhwZWN0SGVhZGVyKDQsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICB2YXIgbWFzayA9IGRhdGE7XG4gICAgICAgICAgc2VsZi5leHBlY3REYXRhKGxlbmd0aCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgb3Bjb2Rlc1snOSddLmZpbmlzaC5jYWxsKHNlbGYsIG1hc2ssIGRhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBzZWxmLmV4cGVjdERhdGEobGVuZ3RoLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgb3Bjb2Rlc1snOSddLmZpbmlzaC5jYWxsKHNlbGYsIG51bGwsIGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGZpbmlzaDogZnVuY3Rpb24obWFzaywgZGF0YSkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgZGF0YSA9IHRoaXMudW5tYXNrKG1hc2ssIGRhdGEsIHRydWUpO1xuICAgICAgdmFyIHN0YXRlID0gY2xvbmUodGhpcy5zdGF0ZSk7XG4gICAgICB0aGlzLm1lc3NhZ2VIYW5kbGVycy5wdXNoKGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgIHNlbGYub25waW5nKGRhdGEsIHttYXNrZWQ6IHN0YXRlLm1hc2tlZCwgYmluYXJ5OiB0cnVlfSk7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZmx1c2goKTtcbiAgICAgIHRoaXMuZW5kUGFja2V0KCk7XG4gICAgfVxuICB9LFxuICAvLyBwb25nXG4gICcxMCc6IHtcbiAgICBzdGFydDogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgaWYgKHNlbGYuc3RhdGUubGFzdEZyYWdtZW50ID09IGZhbHNlKSB7XG4gICAgICAgIHNlbGYuZXJyb3IoJ2ZyYWdtZW50ZWQgcG9uZyBpcyBub3Qgc3VwcG9ydGVkJywgMTAwMik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gZGVjb2RlIGxlbmd0aFxuICAgICAgdmFyIGZpcnN0TGVuZ3RoID0gZGF0YVsxXSAmIDB4N2Y7XG4gICAgICBpZiAoZmlyc3RMZW5ndGggPCAxMjYpIHtcbiAgICAgICAgb3Bjb2Rlc1snMTAnXS5nZXREYXRhLmNhbGwoc2VsZiwgZmlyc3RMZW5ndGgpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHNlbGYuZXJyb3IoJ2NvbnRyb2wgZnJhbWVzIGNhbm5vdCBoYXZlIG1vcmUgdGhhbiAxMjUgYnl0ZXMgb2YgZGF0YScsIDEwMDIpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZ2V0RGF0YTogZnVuY3Rpb24obGVuZ3RoKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICBpZiAodGhpcy5zdGF0ZS5tYXNrZWQpIHtcbiAgICAgICAgdGhpcy5leHBlY3RIZWFkZXIoNCwgZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgIHZhciBtYXNrID0gZGF0YTtcbiAgICAgICAgICBzZWxmLmV4cGVjdERhdGEobGVuZ3RoLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBvcGNvZGVzWycxMCddLmZpbmlzaC5jYWxsKHNlbGYsIG1hc2ssIGRhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB0aGlzLmV4cGVjdERhdGEobGVuZ3RoLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgb3Bjb2Rlc1snMTAnXS5maW5pc2guY2FsbChzZWxmLCBudWxsLCBkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSxcbiAgICBmaW5pc2g6IGZ1bmN0aW9uKG1hc2ssIGRhdGEpIHtcbiAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgIGRhdGEgPSBzZWxmLnVubWFzayhtYXNrLCBkYXRhLCB0cnVlKTtcbiAgICAgIHZhciBzdGF0ZSA9IGNsb25lKHRoaXMuc3RhdGUpO1xuICAgICAgdGhpcy5tZXNzYWdlSGFuZGxlcnMucHVzaChmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICBzZWxmLm9ucG9uZyhkYXRhLCB7bWFza2VkOiBzdGF0ZS5tYXNrZWQsIGJpbmFyeTogdHJ1ZX0pO1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmZsdXNoKCk7XG4gICAgICB0aGlzLmVuZFBhY2tldCgpO1xuICAgIH1cbiAgfVxufVxuIiwiLyohXG4gKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnRcbiAqIENvcHlyaWdodChjKSAyMDExIEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPlxuICogTUlUIExpY2Vuc2VkXG4gKi9cblxudmFyIGV2ZW50cyA9IHJlcXVpcmUoJ2V2ZW50cycpXG4gICwgdXRpbCA9IHJlcXVpcmUoJ3V0aWwnKVxuICAsIEV2ZW50RW1pdHRlciA9IGV2ZW50cy5FdmVudEVtaXR0ZXI7XG5cbi8qKlxuICogSGl4aWUgU2VuZGVyIGltcGxlbWVudGF0aW9uXG4gKi9cblxuZnVuY3Rpb24gU2VuZGVyKHNvY2tldCkge1xuICBpZiAodGhpcyBpbnN0YW5jZW9mIFNlbmRlciA9PT0gZmFsc2UpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3NlcyBjYW4ndCBiZSBmdW5jdGlvbi1jYWxsZWRcIik7XG4gIH1cblxuICBldmVudHMuRXZlbnRFbWl0dGVyLmNhbGwodGhpcyk7XG5cbiAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG4gIHRoaXMuY29udGludWF0aW9uRnJhbWUgPSBmYWxzZTtcbiAgdGhpcy5pc0Nsb3NlZCA9IGZhbHNlO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNlbmRlcjtcblxuLyoqXG4gKiBJbmhlcml0cyBmcm9tIEV2ZW50RW1pdHRlci5cbiAqL1xuXG51dGlsLmluaGVyaXRzKFNlbmRlciwgZXZlbnRzLkV2ZW50RW1pdHRlcik7XG5cbi8qKlxuICogRnJhbWVzIGFuZCB3cml0ZXMgZGF0YS5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblNlbmRlci5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKGRhdGEsIG9wdGlvbnMsIGNiKSB7XG4gIGlmICh0aGlzLmlzQ2xvc2VkKSByZXR1cm47XG5cbiAgdmFyIGlzU3RyaW5nID0gdHlwZW9mIGRhdGEgPT0gJ3N0cmluZydcbiAgICAsIGxlbmd0aCA9IGlzU3RyaW5nID8gQnVmZmVyLmJ5dGVMZW5ndGgoZGF0YSkgOiBkYXRhLmxlbmd0aFxuICAgICwgbGVuZ3RoYnl0ZXMgPSAobGVuZ3RoID4gMTI3KSA/IDIgOiAxIC8vIGFzc3VtZSBsZXNzIHRoYW4gMioqMTQgYnl0ZXNcbiAgICAsIHdyaXRlU3RhcnRNYXJrZXIgPSB0aGlzLmNvbnRpbnVhdGlvbkZyYW1lID09IGZhbHNlXG4gICAgLCB3cml0ZUVuZE1hcmtlciA9ICFvcHRpb25zIHx8ICEodHlwZW9mIG9wdGlvbnMuZmluICE9ICd1bmRlZmluZWQnICYmICFvcHRpb25zLmZpbilcbiAgICAsIGJ1ZmZlciA9IG5ldyBCdWZmZXIoKHdyaXRlU3RhcnRNYXJrZXIgPyAoKG9wdGlvbnMgJiYgb3B0aW9ucy5iaW5hcnkpID8gKDEgKyBsZW5ndGhieXRlcykgOiAxKSA6IDApICsgbGVuZ3RoICsgKCh3cml0ZUVuZE1hcmtlciAmJiAhKG9wdGlvbnMgJiYgb3B0aW9ucy5iaW5hcnkpKSA/IDEgOiAwKSlcbiAgICAsIG9mZnNldCA9IHdyaXRlU3RhcnRNYXJrZXIgPyAxIDogMDtcblxuICBpZiAod3JpdGVTdGFydE1hcmtlcikge1xuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuYmluYXJ5KSB7XG4gICAgICBidWZmZXIud3JpdGUoJ1xceDgwJywgJ2JpbmFyeScpO1xuICAgICAgLy8gYXNzdW1lIGxlbmd0aCBsZXNzIHRoYW4gMioqMTQgYnl0ZXNcbiAgICAgIGlmIChsZW5ndGhieXRlcyA+IDEpXG4gICAgICAgIGJ1ZmZlci53cml0ZShTdHJpbmcuZnJvbUNoYXJDb2RlKDEyOCtsZW5ndGgvMTI4KSwgb2Zmc2V0KyssICdiaW5hcnknKTtcbiAgICAgIGJ1ZmZlci53cml0ZShTdHJpbmcuZnJvbUNoYXJDb2RlKGxlbmd0aCYweDdmKSwgb2Zmc2V0KyssICdiaW5hcnknKTtcbiAgICB9IGVsc2VcbiAgICAgIGJ1ZmZlci53cml0ZSgnXFx4MDAnLCAnYmluYXJ5Jyk7XG4gIH1cblxuICBpZiAoaXNTdHJpbmcpIGJ1ZmZlci53cml0ZShkYXRhLCBvZmZzZXQsICd1dGY4Jyk7XG4gIGVsc2UgZGF0YS5jb3B5KGJ1ZmZlciwgb2Zmc2V0LCAwKTtcblxuICBpZiAod3JpdGVFbmRNYXJrZXIpIHtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmJpbmFyeSkge1xuICAgICAgLy8gc2VuZGluZyBiaW5hcnksIG5vdCB3cml0aW5nIGVuZCBtYXJrZXJcbiAgICB9IGVsc2VcbiAgICAgIGJ1ZmZlci53cml0ZSgnXFx4ZmYnLCBvZmZzZXQgKyBsZW5ndGgsICdiaW5hcnknKTtcbiAgICB0aGlzLmNvbnRpbnVhdGlvbkZyYW1lID0gZmFsc2U7XG4gIH1cbiAgZWxzZSB0aGlzLmNvbnRpbnVhdGlvbkZyYW1lID0gdHJ1ZTtcblxuICB0cnkge1xuICAgIHRoaXMuc29ja2V0LndyaXRlKGJ1ZmZlciwgJ2JpbmFyeScsIGNiKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRoaXMuZXJyb3IoZS50b1N0cmluZygpKTtcbiAgfVxufTtcblxuLyoqXG4gKiBTZW5kcyBhIGNsb3NlIGluc3RydWN0aW9uIHRvIHRoZSByZW1vdGUgcGFydHkuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5TZW5kZXIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24oY29kZSwgZGF0YSwgbWFzaywgY2IpIHtcbiAgaWYgKHRoaXMuaXNDbG9zZWQpIHJldHVybjtcbiAgdGhpcy5pc0Nsb3NlZCA9IHRydWU7XG4gIHRyeSB7XG4gICAgaWYgKHRoaXMuY29udGludWF0aW9uRnJhbWUpIHRoaXMuc29ja2V0LndyaXRlKG5ldyBCdWZmZXIoWzB4ZmZdLCAnYmluYXJ5JykpO1xuICAgIHRoaXMuc29ja2V0LndyaXRlKG5ldyBCdWZmZXIoWzB4ZmYsIDB4MDBdKSwgJ2JpbmFyeScsIGNiKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHRoaXMuZXJyb3IoZS50b1N0cmluZygpKTtcbiAgfVxufTtcblxuLyoqXG4gKiBTZW5kcyBhIHBpbmcgbWVzc2FnZSB0byB0aGUgcmVtb3RlIHBhcnR5LiBOb3QgYXZhaWxhYmxlIGZvciBoaXhpZS5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblNlbmRlci5wcm90b3R5cGUucGluZyA9IGZ1bmN0aW9uKGRhdGEsIG9wdGlvbnMpIHt9O1xuXG4vKipcbiAqIFNlbmRzIGEgcG9uZyBtZXNzYWdlIHRvIHRoZSByZW1vdGUgcGFydHkuIE5vdCBhdmFpbGFibGUgZm9yIGhpeGllLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuU2VuZGVyLnByb3RvdHlwZS5wb25nID0gZnVuY3Rpb24oZGF0YSwgb3B0aW9ucykge307XG5cbi8qKlxuICogSGFuZGxlcyBhbiBlcnJvclxuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblNlbmRlci5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAocmVhc29uKSB7XG4gIHRoaXMuZW1pdCgnZXJyb3InLCByZWFzb24pO1xuICByZXR1cm4gdGhpcztcbn07XG4iLCIvKiFcbiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudFxuICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+XG4gKiBNSVQgTGljZW5zZWRcbiAqL1xuXG52YXIgZXZlbnRzID0gcmVxdWlyZSgnZXZlbnRzJylcbiAgLCB1dGlsID0gcmVxdWlyZSgndXRpbCcpXG4gICwgRXZlbnRFbWl0dGVyID0gZXZlbnRzLkV2ZW50RW1pdHRlclxuICAsIEVycm9yQ29kZXMgPSByZXF1aXJlKCcuL0Vycm9yQ29kZXMnKVxuICAsIGJ1ZmZlclV0aWwgPSByZXF1aXJlKCcuL0J1ZmZlclV0aWwnKS5CdWZmZXJVdGlsXG4gICwgUGVyTWVzc2FnZURlZmxhdGUgPSByZXF1aXJlKCcuL1Blck1lc3NhZ2VEZWZsYXRlJyk7XG5cbi8qKlxuICogSHlCaSBTZW5kZXIgaW1wbGVtZW50YXRpb25cbiAqL1xuXG5mdW5jdGlvbiBTZW5kZXIoc29ja2V0LCBleHRlbnNpb25zKSB7XG4gIGlmICh0aGlzIGluc3RhbmNlb2YgU2VuZGVyID09PSBmYWxzZSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzc2VzIGNhbid0IGJlIGZ1bmN0aW9uLWNhbGxlZFwiKTtcbiAgfVxuXG4gIGV2ZW50cy5FdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTtcblxuICB0aGlzLl9zb2NrZXQgPSBzb2NrZXQ7XG4gIHRoaXMuZXh0ZW5zaW9ucyA9IGV4dGVuc2lvbnMgfHwge307XG4gIHRoaXMuZmlyc3RGcmFnbWVudCA9IHRydWU7XG4gIHRoaXMuY29tcHJlc3MgPSBmYWxzZTtcbiAgdGhpcy5tZXNzYWdlSGFuZGxlcnMgPSBbXTtcbiAgdGhpcy5wcm9jZXNzaW5nID0gZmFsc2U7XG59XG5cbi8qKlxuICogSW5oZXJpdHMgZnJvbSBFdmVudEVtaXR0ZXIuXG4gKi9cblxudXRpbC5pbmhlcml0cyhTZW5kZXIsIGV2ZW50cy5FdmVudEVtaXR0ZXIpO1xuXG4vKipcbiAqIFNlbmRzIGEgY2xvc2UgaW5zdHJ1Y3Rpb24gdG8gdGhlIHJlbW90ZSBwYXJ0eS5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cblNlbmRlci5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbihjb2RlLCBkYXRhLCBtYXNrLCBjYikge1xuICBpZiAodHlwZW9mIGNvZGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgaWYgKHR5cGVvZiBjb2RlICE9PSAnbnVtYmVyJyB8fFxuICAgICAgIUVycm9yQ29kZXMuaXNWYWxpZEVycm9yQ29kZShjb2RlKSkgdGhyb3cgbmV3IEVycm9yKCdmaXJzdCBhcmd1bWVudCBtdXN0IGJlIGEgdmFsaWQgZXJyb3IgY29kZSBudW1iZXInKTtcbiAgfVxuICBjb2RlID0gY29kZSB8fCAxMDAwO1xuICB2YXIgZGF0YUJ1ZmZlciA9IG5ldyBCdWZmZXIoMiArIChkYXRhID8gQnVmZmVyLmJ5dGVMZW5ndGgoZGF0YSkgOiAwKSk7XG4gIHdyaXRlVUludDE2QkUuY2FsbChkYXRhQnVmZmVyLCBjb2RlLCAwKTtcbiAgaWYgKGRhdGFCdWZmZXIubGVuZ3RoID4gMikgZGF0YUJ1ZmZlci53cml0ZShkYXRhLCAyKTtcblxuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMubWVzc2FnZUhhbmRsZXJzLnB1c2goZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICBzZWxmLmZyYW1lQW5kU2VuZCgweDgsIGRhdGFCdWZmZXIsIHRydWUsIG1hc2spO1xuICAgIGNhbGxiYWNrKCk7XG4gICAgaWYgKHR5cGVvZiBjYiA9PSAnZnVuY3Rpb24nKSBjYigpO1xuICB9KTtcbiAgdGhpcy5mbHVzaCgpO1xufTtcblxuLyoqXG4gKiBTZW5kcyBhIHBpbmcgbWVzc2FnZSB0byB0aGUgcmVtb3RlIHBhcnR5LlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuU2VuZGVyLnByb3RvdHlwZS5waW5nID0gZnVuY3Rpb24oZGF0YSwgb3B0aW9ucykge1xuICB2YXIgbWFzayA9IG9wdGlvbnMgJiYgb3B0aW9ucy5tYXNrO1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMubWVzc2FnZUhhbmRsZXJzLnB1c2goZnVuY3Rpb24oY2FsbGJhY2spIHtcbiAgICBzZWxmLmZyYW1lQW5kU2VuZCgweDksIGRhdGEgfHwgJycsIHRydWUsIG1hc2spO1xuICAgIGNhbGxiYWNrKCk7XG4gIH0pO1xuICB0aGlzLmZsdXNoKCk7XG59O1xuXG4vKipcbiAqIFNlbmRzIGEgcG9uZyBtZXNzYWdlIHRvIHRoZSByZW1vdGUgcGFydHkuXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuXG5TZW5kZXIucHJvdG90eXBlLnBvbmcgPSBmdW5jdGlvbihkYXRhLCBvcHRpb25zKSB7XG4gIHZhciBtYXNrID0gb3B0aW9ucyAmJiBvcHRpb25zLm1hc2s7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy5tZXNzYWdlSGFuZGxlcnMucHVzaChmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIHNlbGYuZnJhbWVBbmRTZW5kKDB4YSwgZGF0YSB8fCAnJywgdHJ1ZSwgbWFzayk7XG4gICAgY2FsbGJhY2soKTtcbiAgfSk7XG4gIHRoaXMuZmx1c2goKTtcbn07XG5cbi8qKlxuICogU2VuZHMgdGV4dCBvciBiaW5hcnkgZGF0YSB0byB0aGUgcmVtb3RlIHBhcnR5LlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuU2VuZGVyLnByb3RvdHlwZS5zZW5kID0gZnVuY3Rpb24oZGF0YSwgb3B0aW9ucywgY2IpIHtcbiAgdmFyIGZpbmFsRnJhZ21lbnQgPSBvcHRpb25zICYmIG9wdGlvbnMuZmluID09PSBmYWxzZSA/IGZhbHNlIDogdHJ1ZTtcbiAgdmFyIG1hc2sgPSBvcHRpb25zICYmIG9wdGlvbnMubWFzaztcbiAgdmFyIGNvbXByZXNzID0gb3B0aW9ucyAmJiBvcHRpb25zLmNvbXByZXNzO1xuICB2YXIgb3Bjb2RlID0gb3B0aW9ucyAmJiBvcHRpb25zLmJpbmFyeSA/IDIgOiAxO1xuICBpZiAodGhpcy5maXJzdEZyYWdtZW50ID09PSBmYWxzZSkge1xuICAgIG9wY29kZSA9IDA7XG4gICAgY29tcHJlc3MgPSBmYWxzZTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmZpcnN0RnJhZ21lbnQgPSBmYWxzZTtcbiAgICB0aGlzLmNvbXByZXNzID0gY29tcHJlc3M7XG4gIH1cbiAgaWYgKGZpbmFsRnJhZ21lbnQpIHRoaXMuZmlyc3RGcmFnbWVudCA9IHRydWVcblxuICB2YXIgY29tcHJlc3NGcmFnbWVudCA9IHRoaXMuY29tcHJlc3M7XG5cbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLm1lc3NhZ2VIYW5kbGVycy5wdXNoKGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgc2VsZi5hcHBseUV4dGVuc2lvbnMoZGF0YSwgZmluYWxGcmFnbWVudCwgY29tcHJlc3NGcmFnbWVudCwgZnVuY3Rpb24oZXJyLCBkYXRhKSB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2IgPT0gJ2Z1bmN0aW9uJykgY2IoZXJyKTtcbiAgICAgICAgZWxzZSBzZWxmLmVtaXQoJ2Vycm9yJywgZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VsZi5mcmFtZUFuZFNlbmQob3Bjb2RlLCBkYXRhLCBmaW5hbEZyYWdtZW50LCBtYXNrLCBjb21wcmVzcywgY2IpO1xuICAgICAgY2FsbGJhY2soKTtcbiAgICB9KTtcbiAgfSk7XG4gIHRoaXMuZmx1c2goKTtcbn07XG5cbi8qKlxuICogRnJhbWVzIGFuZCBzZW5kcyBhIHBpZWNlIG9mIGRhdGEgYWNjb3JkaW5nIHRvIHRoZSBIeUJpIFdlYlNvY2tldCBwcm90b2NvbC5cbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5TZW5kZXIucHJvdG90eXBlLmZyYW1lQW5kU2VuZCA9IGZ1bmN0aW9uKG9wY29kZSwgZGF0YSwgZmluYWxGcmFnbWVudCwgbWFza0RhdGEsIGNvbXByZXNzZWQsIGNiKSB7XG4gIHZhciBjYW5Nb2RpZnlEYXRhID0gZmFsc2U7XG5cbiAgaWYgKCFkYXRhKSB7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuX3NvY2tldC53cml0ZShuZXcgQnVmZmVyKFtvcGNvZGUgfCAoZmluYWxGcmFnbWVudCA/IDB4ODAgOiAwKSwgMCB8IChtYXNrRGF0YSA/IDB4ODAgOiAwKV0uY29uY2F0KG1hc2tEYXRhID8gWzAsIDAsIDAsIDBdIDogW10pKSwgJ2JpbmFyeScsIGNiKTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgIGlmICh0eXBlb2YgY2IgPT0gJ2Z1bmN0aW9uJykgY2IoZSk7XG4gICAgICBlbHNlIHRoaXMuZW1pdCgnZXJyb3InLCBlKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFCdWZmZXIuaXNCdWZmZXIoZGF0YSkpIHtcbiAgICBjYW5Nb2RpZnlEYXRhID0gdHJ1ZTtcbiAgICBpZiAoZGF0YSAmJiAodHlwZW9mIGRhdGEuYnl0ZUxlbmd0aCAhPT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIGRhdGEuYnVmZmVyICE9PSAndW5kZWZpbmVkJykpIHtcbiAgICAgIGRhdGEgPSBnZXRBcnJheUJ1ZmZlcihkYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy9cbiAgICAgIC8vIElmIHBlb3BsZSB3YW50IHRvIHNlbmQgYSBudW1iZXIsIHRoaXMgd291bGQgYWxsb2NhdGUgdGhlIG51bWJlciBpblxuICAgICAgLy8gYnl0ZXMgYXMgbWVtb3J5IHNpemUgaW5zdGVhZCBvZiBzdG9yaW5nIHRoZSBudW1iZXIgYXMgYnVmZmVyIHZhbHVlLiBTb1xuICAgICAgLy8gd2UgbmVlZCB0byB0cmFuc2Zvcm0gaXQgdG8gc3RyaW5nIGluIG9yZGVyIHRvIHByZXZlbnQgcG9zc2libGVcbiAgICAgIC8vIHZ1bG5lcmFiaWxpdGllcyAvIG1lbW9yeSBhdHRhY2tzLlxuICAgICAgLy9cbiAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ251bWJlcicpIGRhdGEgPSBkYXRhLnRvU3RyaW5nKCk7XG5cbiAgICAgIGRhdGEgPSBuZXcgQnVmZmVyKGRhdGEpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBkYXRhTGVuZ3RoID0gZGF0YS5sZW5ndGhcbiAgICAsIGRhdGFPZmZzZXQgPSBtYXNrRGF0YSA/IDYgOiAyXG4gICAgLCBzZWNvbmRCeXRlID0gZGF0YUxlbmd0aDtcblxuICBpZiAoZGF0YUxlbmd0aCA+PSA2NTUzNikge1xuICAgIGRhdGFPZmZzZXQgKz0gODtcbiAgICBzZWNvbmRCeXRlID0gMTI3O1xuICB9XG4gIGVsc2UgaWYgKGRhdGFMZW5ndGggPiAxMjUpIHtcbiAgICBkYXRhT2Zmc2V0ICs9IDI7XG4gICAgc2Vjb25kQnl0ZSA9IDEyNjtcbiAgfVxuXG4gIHZhciBtZXJnZUJ1ZmZlcnMgPSBkYXRhTGVuZ3RoIDwgMzI3NjggfHwgKG1hc2tEYXRhICYmICFjYW5Nb2RpZnlEYXRhKTtcbiAgdmFyIHRvdGFsTGVuZ3RoID0gbWVyZ2VCdWZmZXJzID8gZGF0YUxlbmd0aCArIGRhdGFPZmZzZXQgOiBkYXRhT2Zmc2V0O1xuICB2YXIgb3V0cHV0QnVmZmVyID0gbmV3IEJ1ZmZlcih0b3RhbExlbmd0aCk7XG4gIG91dHB1dEJ1ZmZlclswXSA9IGZpbmFsRnJhZ21lbnQgPyBvcGNvZGUgfCAweDgwIDogb3Bjb2RlO1xuICBpZiAoY29tcHJlc3NlZCkgb3V0cHV0QnVmZmVyWzBdIHw9IDB4NDA7XG5cbiAgc3dpdGNoIChzZWNvbmRCeXRlKSB7XG4gICAgY2FzZSAxMjY6XG4gICAgICB3cml0ZVVJbnQxNkJFLmNhbGwob3V0cHV0QnVmZmVyLCBkYXRhTGVuZ3RoLCAyKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgMTI3OlxuICAgICAgd3JpdGVVSW50MzJCRS5jYWxsKG91dHB1dEJ1ZmZlciwgMCwgMik7XG4gICAgICB3cml0ZVVJbnQzMkJFLmNhbGwob3V0cHV0QnVmZmVyLCBkYXRhTGVuZ3RoLCA2KTtcbiAgfVxuXG4gIGlmIChtYXNrRGF0YSkge1xuICAgIG91dHB1dEJ1ZmZlclsxXSA9IHNlY29uZEJ5dGUgfCAweDgwO1xuICAgIHZhciBtYXNrID0gdGhpcy5fcmFuZG9tTWFzayB8fCAodGhpcy5fcmFuZG9tTWFzayA9IGdldFJhbmRvbU1hc2soKSk7XG4gICAgb3V0cHV0QnVmZmVyW2RhdGFPZmZzZXQgLSA0XSA9IG1hc2tbMF07XG4gICAgb3V0cHV0QnVmZmVyW2RhdGFPZmZzZXQgLSAzXSA9IG1hc2tbMV07XG4gICAgb3V0cHV0QnVmZmVyW2RhdGFPZmZzZXQgLSAyXSA9IG1hc2tbMl07XG4gICAgb3V0cHV0QnVmZmVyW2RhdGFPZmZzZXQgLSAxXSA9IG1hc2tbM107XG4gICAgaWYgKG1lcmdlQnVmZmVycykge1xuICAgICAgYnVmZmVyVXRpbC5tYXNrKGRhdGEsIG1hc2ssIG91dHB1dEJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YUxlbmd0aCk7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLl9zb2NrZXQud3JpdGUob3V0cHV0QnVmZmVyLCAnYmluYXJ5JywgY2IpO1xuICAgICAgfVxuICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjYiA9PSAnZnVuY3Rpb24nKSBjYihlKTtcbiAgICAgICAgZWxzZSB0aGlzLmVtaXQoJ2Vycm9yJywgZSk7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgYnVmZmVyVXRpbC5tYXNrKGRhdGEsIG1hc2ssIGRhdGEsIDAsIGRhdGFMZW5ndGgpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5fc29ja2V0LndyaXRlKG91dHB1dEJ1ZmZlciwgJ2JpbmFyeScpO1xuICAgICAgICB0aGlzLl9zb2NrZXQud3JpdGUoZGF0YSwgJ2JpbmFyeScsIGNiKTtcbiAgICAgIH1cbiAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2IgPT0gJ2Z1bmN0aW9uJykgY2IoZSk7XG4gICAgICAgIGVsc2UgdGhpcy5lbWl0KCdlcnJvcicsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICBvdXRwdXRCdWZmZXJbMV0gPSBzZWNvbmRCeXRlO1xuICAgIGlmIChtZXJnZUJ1ZmZlcnMpIHtcbiAgICAgIGRhdGEuY29weShvdXRwdXRCdWZmZXIsIGRhdGFPZmZzZXQpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgdGhpcy5fc29ja2V0LndyaXRlKG91dHB1dEJ1ZmZlciwgJ2JpbmFyeScsIGNiKTtcbiAgICAgIH1cbiAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2IgPT0gJ2Z1bmN0aW9uJykgY2IoZSk7XG4gICAgICAgIGVsc2UgdGhpcy5lbWl0KCdlcnJvcicsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuX3NvY2tldC53cml0ZShvdXRwdXRCdWZmZXIsICdiaW5hcnknKTtcbiAgICAgICAgdGhpcy5fc29ja2V0LndyaXRlKGRhdGEsICdiaW5hcnknLCBjYik7XG4gICAgICB9XG4gICAgICBjYXRjaCAoZSkge1xuICAgICAgICBpZiAodHlwZW9mIGNiID09ICdmdW5jdGlvbicpIGNiKGUpO1xuICAgICAgICBlbHNlIHRoaXMuZW1pdCgnZXJyb3InLCBlKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogRXhlY3V0ZSBtZXNzYWdlIGhhbmRsZXIgYnVmZmVyc1xuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cblNlbmRlci5wcm90b3R5cGUuZmx1c2ggPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMucHJvY2Vzc2luZykgcmV0dXJuO1xuXG4gIHZhciBoYW5kbGVyID0gdGhpcy5tZXNzYWdlSGFuZGxlcnMuc2hpZnQoKTtcbiAgaWYgKCFoYW5kbGVyKSByZXR1cm47XG5cbiAgdGhpcy5wcm9jZXNzaW5nID0gdHJ1ZTtcblxuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgaGFuZGxlcihmdW5jdGlvbigpIHtcbiAgICBzZWxmLnByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgICBzZWxmLmZsdXNoKCk7XG4gIH0pO1xufTtcblxuLyoqXG4gKiBBcHBseSBleHRlbnNpb25zIHRvIG1lc3NhZ2VcbiAqXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5TZW5kZXIucHJvdG90eXBlLmFwcGx5RXh0ZW5zaW9ucyA9IGZ1bmN0aW9uKGRhdGEsIGZpbiwgY29tcHJlc3MsIGNhbGxiYWNrKSB7XG4gIGlmIChjb21wcmVzcyAmJiBkYXRhKSB7XG4gICAgaWYgKChkYXRhLmJ1ZmZlciB8fCBkYXRhKSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICBkYXRhID0gZ2V0QXJyYXlCdWZmZXIoZGF0YSk7XG4gICAgfVxuICAgIHRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXS5jb21wcmVzcyhkYXRhLCBmaW4sIGNhbGxiYWNrKTtcbiAgfSBlbHNlIHtcbiAgICBjYWxsYmFjayhudWxsLCBkYXRhKTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTZW5kZXI7XG5cbmZ1bmN0aW9uIHdyaXRlVUludDE2QkUodmFsdWUsIG9mZnNldCkge1xuICB0aGlzW29mZnNldF0gPSAodmFsdWUgJiAweGZmMDApPj44O1xuICB0aGlzW29mZnNldCsxXSA9IHZhbHVlICYgMHhmZjtcbn1cblxuZnVuY3Rpb24gd3JpdGVVSW50MzJCRSh2YWx1ZSwgb2Zmc2V0KSB7XG4gIHRoaXNbb2Zmc2V0XSA9ICh2YWx1ZSAmIDB4ZmYwMDAwMDApPj4yNDtcbiAgdGhpc1tvZmZzZXQrMV0gPSAodmFsdWUgJiAweGZmMDAwMCk+PjE2O1xuICB0aGlzW29mZnNldCsyXSA9ICh2YWx1ZSAmIDB4ZmYwMCk+Pjg7XG4gIHRoaXNbb2Zmc2V0KzNdID0gdmFsdWUgJiAweGZmO1xufVxuXG5mdW5jdGlvbiBnZXRBcnJheUJ1ZmZlcihkYXRhKSB7XG4gIC8vIGRhdGEgaXMgZWl0aGVyIGFuIEFycmF5QnVmZmVyIG9yIEFycmF5QnVmZmVyVmlldy5cbiAgdmFyIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YS5idWZmZXIgfHwgZGF0YSlcbiAgICAsIGwgPSBkYXRhLmJ5dGVMZW5ndGggfHwgZGF0YS5sZW5ndGhcbiAgICAsIG8gPSBkYXRhLmJ5dGVPZmZzZXQgfHwgMFxuICAgICwgYnVmZmVyID0gbmV3IEJ1ZmZlcihsKTtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyArK2kpIHtcbiAgICBidWZmZXJbaV0gPSBhcnJheVtvK2ldO1xuICB9XG4gIHJldHVybiBidWZmZXI7XG59XG5cbmZ1bmN0aW9uIGdldFJhbmRvbU1hc2soKSB7XG4gIHJldHVybiBuZXcgQnVmZmVyKFtcbiAgICB+fihNYXRoLnJhbmRvbSgpICogMjU1KSxcbiAgICB+fihNYXRoLnJhbmRvbSgpICogMjU1KSxcbiAgICB+fihNYXRoLnJhbmRvbSgpICogMjU1KSxcbiAgICB+fihNYXRoLnJhbmRvbSgpICogMjU1KVxuICBdKTtcbn1cbiIsIi8qIVxuICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50XG4gKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT5cbiAqIE1JVCBMaWNlbnNlZFxuICovXG4gXG5tb2R1bGUuZXhwb3J0cy5WYWxpZGF0aW9uID0ge1xuICBpc1ZhbGlkVVRGODogZnVuY3Rpb24oYnVmZmVyKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn07XG5cbiIsIid1c2Ugc3RyaWN0JztcblxuLyohXG4gKiB3czogYSBub2RlLmpzIHdlYnNvY2tldCBjbGllbnRcbiAqIENvcHlyaWdodChjKSAyMDExIEVpbmFyIE90dG8gU3Rhbmd2aWsgPGVpbmFyb3NAZ21haWwuY29tPlxuICogTUlUIExpY2Vuc2VkXG4gKi9cblxudHJ5IHtcbiAgbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCd1dGYtOC12YWxpZGF0ZScpO1xufSBjYXRjaCAoZSkge1xuICBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vVmFsaWRhdGlvbi5mYWxsYmFjaycpO1xufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKiFcbiAqIHdzOiBhIG5vZGUuanMgd2Vic29ja2V0IGNsaWVudFxuICogQ29weXJpZ2h0KGMpIDIwMTEgRWluYXIgT3R0byBTdGFuZ3ZpayA8ZWluYXJvc0BnbWFpbC5jb20+XG4gKiBNSVQgTGljZW5zZWRcbiAqL1xuXG52YXIgdXJsID0gcmVxdWlyZSgndXJsJylcbiAgLCB1dGlsID0gcmVxdWlyZSgndXRpbCcpXG4gICwgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKVxuICAsIGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKVxuICAsIGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpXG4gICwgc3RyZWFtID0gcmVxdWlyZSgnc3RyZWFtJylcbiAgLCBVbHRyb24gPSByZXF1aXJlKCd1bHRyb24nKVxuICAsIE9wdGlvbnMgPSByZXF1aXJlKCdvcHRpb25zJylcbiAgLCBTZW5kZXIgPSByZXF1aXJlKCcuL1NlbmRlcicpXG4gICwgUmVjZWl2ZXIgPSByZXF1aXJlKCcuL1JlY2VpdmVyJylcbiAgLCBTZW5kZXJIaXhpZSA9IHJlcXVpcmUoJy4vU2VuZGVyLmhpeGllJylcbiAgLCBSZWNlaXZlckhpeGllID0gcmVxdWlyZSgnLi9SZWNlaXZlci5oaXhpZScpXG4gICwgRXh0ZW5zaW9ucyA9IHJlcXVpcmUoJy4vRXh0ZW5zaW9ucycpXG4gICwgUGVyTWVzc2FnZURlZmxhdGUgPSByZXF1aXJlKCcuL1Blck1lc3NhZ2VEZWZsYXRlJylcbiAgLCBFdmVudEVtaXR0ZXIgPSByZXF1aXJlKCdldmVudHMnKS5FdmVudEVtaXR0ZXI7XG5cbi8qKlxuICogQ29uc3RhbnRzXG4gKi9cblxuLy8gRGVmYXVsdCBwcm90b2NvbCB2ZXJzaW9uXG5cbnZhciBwcm90b2NvbFZlcnNpb24gPSAxMztcblxuLy8gQ2xvc2UgdGltZW91dFxuXG52YXIgY2xvc2VUaW1lb3V0ID0gMzAgKiAxMDAwOyAvLyBBbGxvdyAzMCBzZWNvbmRzIHRvIHRlcm1pbmF0ZSB0aGUgY29ubmVjdGlvbiBjbGVhbmx5XG5cbi8qKlxuICogV2ViU29ja2V0IGltcGxlbWVudGF0aW9uXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge1N0cmluZ30gYWRkcmVzcyBDb25uZWN0aW9uIGFkZHJlc3MuXG4gKiBAcGFyYW0ge1N0cmluZ3xBcnJheX0gcHJvdG9jb2xzIFdlYlNvY2tldCBwcm90b2NvbHMuXG4gKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBBZGRpdGlvbmFsIGNvbm5lY3Rpb24gb3B0aW9ucy5cbiAqIEBhcGkgcHVibGljXG4gKi9cbmZ1bmN0aW9uIFdlYlNvY2tldChhZGRyZXNzLCBwcm90b2NvbHMsIG9wdGlvbnMpIHtcbiAgaWYgKHRoaXMgaW5zdGFuY2VvZiBXZWJTb2NrZXQgPT09IGZhbHNlKSB7XG4gICAgcmV0dXJuIG5ldyBXZWJTb2NrZXQoYWRkcmVzcywgcHJvdG9jb2xzLCBvcHRpb25zKTtcbiAgfVxuXG4gIEV2ZW50RW1pdHRlci5jYWxsKHRoaXMpO1xuXG4gIGlmIChwcm90b2NvbHMgJiYgIUFycmF5LmlzQXJyYXkocHJvdG9jb2xzKSAmJiAnb2JqZWN0JyA9PT0gdHlwZW9mIHByb3RvY29scykge1xuICAgIC8vIGFjY2VwdCB0aGUgXCJvcHRpb25zXCIgT2JqZWN0IGFzIHRoZSAybmQgYXJndW1lbnRcbiAgICBvcHRpb25zID0gcHJvdG9jb2xzO1xuICAgIHByb3RvY29scyA9IG51bGw7XG4gIH1cblxuICBpZiAoJ3N0cmluZycgPT09IHR5cGVvZiBwcm90b2NvbHMpIHtcbiAgICBwcm90b2NvbHMgPSBbIHByb3RvY29scyBdO1xuICB9XG5cbiAgaWYgKCFBcnJheS5pc0FycmF5KHByb3RvY29scykpIHtcbiAgICBwcm90b2NvbHMgPSBbXTtcbiAgfVxuXG4gIHRoaXMuX3NvY2tldCA9IG51bGw7XG4gIHRoaXMuX3VsdHJvbiA9IG51bGw7XG4gIHRoaXMuX2Nsb3NlUmVjZWl2ZWQgPSBmYWxzZTtcbiAgdGhpcy5ieXRlc1JlY2VpdmVkID0gMDtcbiAgdGhpcy5yZWFkeVN0YXRlID0gbnVsbDtcbiAgdGhpcy5zdXBwb3J0cyA9IHt9O1xuICB0aGlzLmV4dGVuc2lvbnMgPSB7fTtcblxuICBpZiAoQXJyYXkuaXNBcnJheShhZGRyZXNzKSkge1xuICAgIGluaXRBc1NlcnZlckNsaWVudC5hcHBseSh0aGlzLCBhZGRyZXNzLmNvbmNhdChvcHRpb25zKSk7XG4gIH0gZWxzZSB7XG4gICAgaW5pdEFzQ2xpZW50LmFwcGx5KHRoaXMsIFthZGRyZXNzLCBwcm90b2NvbHMsIG9wdGlvbnNdKTtcbiAgfVxufVxuXG4vKipcbiAqIEluaGVyaXRzIGZyb20gRXZlbnRFbWl0dGVyLlxuICovXG51dGlsLmluaGVyaXRzKFdlYlNvY2tldCwgRXZlbnRFbWl0dGVyKTtcblxuLyoqXG4gKiBSZWFkeSBTdGF0ZXNcbiAqL1xuW1wiQ09OTkVDVElOR1wiLCBcIk9QRU5cIiwgXCJDTE9TSU5HXCIsIFwiQ0xPU0VEXCJdLmZvckVhY2goZnVuY3Rpb24gZWFjaChzdGF0ZSwgaW5kZXgpIHtcbiAgICBXZWJTb2NrZXQucHJvdG90eXBlW3N0YXRlXSA9IFdlYlNvY2tldFtzdGF0ZV0gPSBpbmRleDtcbn0pO1xuXG4vKipcbiAqIEdyYWNlZnVsbHkgY2xvc2VzIHRoZSBjb25uZWN0aW9uLCBhZnRlciBzZW5kaW5nIGEgZGVzY3JpcHRpb24gbWVzc2FnZSB0byB0aGUgc2VydmVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRhdGEgdG8gYmUgc2VudCB0byB0aGUgc2VydmVyXG4gKiBAYXBpIHB1YmxpY1xuICovXG5XZWJTb2NrZXQucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gY2xvc2UoY29kZSwgZGF0YSkge1xuICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ0xPU0VEKSByZXR1cm47XG5cbiAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNPTk5FQ1RJTkcpIHtcbiAgICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuQ0xPU0VEO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DTE9TSU5HKSB7XG4gICAgaWYgKHRoaXMuX2Nsb3NlUmVjZWl2ZWQgJiYgdGhpcy5faXNTZXJ2ZXIpIHtcbiAgICAgIHRoaXMudGVybWluYXRlKCk7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBzZWxmID0gdGhpcztcbiAgdHJ5IHtcbiAgICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuQ0xPU0lORztcbiAgICB0aGlzLl9jbG9zZUNvZGUgPSBjb2RlO1xuICAgIHRoaXMuX2Nsb3NlTWVzc2FnZSA9IGRhdGE7XG4gICAgdmFyIG1hc2sgPSAhdGhpcy5faXNTZXJ2ZXI7XG4gICAgdGhpcy5fc2VuZGVyLmNsb3NlKGNvZGUsIGRhdGEsIG1hc2ssIGZ1bmN0aW9uKGVycikge1xuICAgICAgaWYgKGVycikgc2VsZi5lbWl0KCdlcnJvcicsIGVycik7XG5cbiAgICAgIGlmIChzZWxmLl9jbG9zZVJlY2VpdmVkICYmIHNlbGYuX2lzU2VydmVyKSB7XG4gICAgICAgIHNlbGYudGVybWluYXRlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBlbnN1cmUgdGhhdCB0aGUgY29ubmVjdGlvbiBpcyBjbGVhbmVkIHVwIGV2ZW4gd2hlbiBubyByZXNwb25zZSBvZiBjbG9zaW5nIGhhbmRzaGFrZS5cbiAgICAgICAgY2xlYXJUaW1lb3V0KHNlbGYuX2Nsb3NlVGltZXIpO1xuICAgICAgICBzZWxmLl9jbG9zZVRpbWVyID0gc2V0VGltZW91dChjbGVhbnVwV2Vic29ja2V0UmVzb3VyY2VzLmJpbmQoc2VsZiwgdHJ1ZSksIGNsb3NlVGltZW91dCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZSk7XG4gIH1cbn07XG5cbi8qKlxuICogUGF1c2UgdGhlIGNsaWVudCBzdHJlYW1cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5XZWJTb2NrZXQucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gcGF1c2VyKCkge1xuICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuT1BFTikgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7XG5cbiAgcmV0dXJuIHRoaXMuX3NvY2tldC5wYXVzZSgpO1xufTtcblxuLyoqXG4gKiBTZW5kcyBhIHBpbmdcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSB0byBiZSBzZW50IHRvIHRoZSBzZXJ2ZXJcbiAqIEBwYXJhbSB7T2JqZWN0fSBNZW1iZXJzIC0gbWFzazogYm9vbGVhbiwgYmluYXJ5OiBib29sZWFuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGRvbnRGYWlsV2hlbkNsb3NlZCBpbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdG8gdGhyb3cgaWYgdGhlIGNvbm5lY3Rpb24gaXNudCBvcGVuXG4gKiBAYXBpIHB1YmxpY1xuICovXG5XZWJTb2NrZXQucHJvdG90eXBlLnBpbmcgPSBmdW5jdGlvbiBwaW5nKGRhdGEsIG9wdGlvbnMsIGRvbnRGYWlsV2hlbkNsb3NlZCkge1xuICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuT1BFTikge1xuICAgIGlmIChkb250RmFpbFdoZW5DbG9zZWQgPT09IHRydWUpIHJldHVybjtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5tYXNrID09PSAndW5kZWZpbmVkJykgb3B0aW9ucy5tYXNrID0gIXRoaXMuX2lzU2VydmVyO1xuXG4gIHRoaXMuX3NlbmRlci5waW5nKGRhdGEsIG9wdGlvbnMpO1xufTtcblxuLyoqXG4gKiBTZW5kcyBhIHBvbmdcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSB0byBiZSBzZW50IHRvIHRoZSBzZXJ2ZXJcbiAqIEBwYXJhbSB7T2JqZWN0fSBNZW1iZXJzIC0gbWFzazogYm9vbGVhbiwgYmluYXJ5OiBib29sZWFuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGRvbnRGYWlsV2hlbkNsb3NlZCBpbmRpY2F0ZXMgd2hldGhlciBvciBub3QgdG8gdGhyb3cgaWYgdGhlIGNvbm5lY3Rpb24gaXNudCBvcGVuXG4gKiBAYXBpIHB1YmxpY1xuICovXG5XZWJTb2NrZXQucHJvdG90eXBlLnBvbmcgPSBmdW5jdGlvbihkYXRhLCBvcHRpb25zLCBkb250RmFpbFdoZW5DbG9zZWQpIHtcbiAgaWYgKHRoaXMucmVhZHlTdGF0ZSAhPT0gV2ViU29ja2V0Lk9QRU4pIHtcbiAgICBpZiAoZG9udEZhaWxXaGVuQ2xvc2VkID09PSB0cnVlKSByZXR1cm47XG4gICAgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7XG4gIH1cblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICBpZiAodHlwZW9mIG9wdGlvbnMubWFzayA9PT0gJ3VuZGVmaW5lZCcpIG9wdGlvbnMubWFzayA9ICF0aGlzLl9pc1NlcnZlcjtcblxuICB0aGlzLl9zZW5kZXIucG9uZyhkYXRhLCBvcHRpb25zKTtcbn07XG5cbi8qKlxuICogUmVzdW1lIHRoZSBjbGllbnQgc3RyZWFtXG4gKlxuICogQGFwaSBwdWJsaWNcbiAqL1xuV2ViU29ja2V0LnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiByZXN1bWUoKSB7XG4gIGlmICh0aGlzLnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5PUEVOKSB0aHJvdyBuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKTtcblxuICByZXR1cm4gdGhpcy5fc29ja2V0LnJlc3VtZSgpO1xufTtcblxuLyoqXG4gKiBTZW5kcyBhIHBpZWNlIG9mIGRhdGFcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSB0byBiZSBzZW50IHRvIHRoZSBzZXJ2ZXJcbiAqIEBwYXJhbSB7T2JqZWN0fSBNZW1iZXJzIC0gbWFzazogYm9vbGVhbiwgYmluYXJ5OiBib29sZWFuLCBjb21wcmVzczogYm9vbGVhblxuICogQHBhcmFtIHtmdW5jdGlvbn0gT3B0aW9uYWwgY2FsbGJhY2sgd2hpY2ggaXMgZXhlY3V0ZWQgYWZ0ZXIgdGhlIHNlbmQgY29tcGxldGVzXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbldlYlNvY2tldC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIHNlbmQoZGF0YSwgb3B0aW9ucywgY2IpIHtcbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY2IgPSBvcHRpb25zO1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfVxuXG4gIGlmICh0aGlzLnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5PUEVOKSB7XG4gICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykgY2IobmV3IEVycm9yKCdub3Qgb3BlbmVkJykpO1xuICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yKCdub3Qgb3BlbmVkJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKCFkYXRhKSBkYXRhID0gJyc7XG4gIGlmICh0aGlzLl9xdWV1ZSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLl9xdWV1ZS5wdXNoKGZ1bmN0aW9uKCkgeyBzZWxmLnNlbmQoZGF0YSwgb3B0aW9ucywgY2IpOyB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgb3B0aW9ucy5maW4gPSB0cnVlO1xuXG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5iaW5hcnkgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgb3B0aW9ucy5iaW5hcnkgPSAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyIHx8IGRhdGEgaW5zdGFuY2VvZiBCdWZmZXIgfHxcbiAgICAgIGRhdGEgaW5zdGFuY2VvZiBVaW50OEFycmF5IHx8XG4gICAgICBkYXRhIGluc3RhbmNlb2YgVWludDE2QXJyYXkgfHxcbiAgICAgIGRhdGEgaW5zdGFuY2VvZiBVaW50MzJBcnJheSB8fFxuICAgICAgZGF0YSBpbnN0YW5jZW9mIEludDhBcnJheSB8fFxuICAgICAgZGF0YSBpbnN0YW5jZW9mIEludDE2QXJyYXkgfHxcbiAgICAgIGRhdGEgaW5zdGFuY2VvZiBJbnQzMkFycmF5IHx8XG4gICAgICBkYXRhIGluc3RhbmNlb2YgRmxvYXQzMkFycmF5IHx8XG4gICAgICBkYXRhIGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KTtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5tYXNrID09PSAndW5kZWZpbmVkJykgb3B0aW9ucy5tYXNrID0gIXRoaXMuX2lzU2VydmVyO1xuICBpZiAodHlwZW9mIG9wdGlvbnMuY29tcHJlc3MgPT09ICd1bmRlZmluZWQnKSBvcHRpb25zLmNvbXByZXNzID0gdHJ1ZTtcbiAgaWYgKCF0aGlzLmV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0pIHtcbiAgICBvcHRpb25zLmNvbXByZXNzID0gZmFsc2U7XG4gIH1cblxuICB2YXIgcmVhZGFibGUgPSB0eXBlb2Ygc3RyZWFtLlJlYWRhYmxlID09PSAnZnVuY3Rpb24nXG4gICAgPyBzdHJlYW0uUmVhZGFibGVcbiAgICA6IHN0cmVhbS5TdHJlYW07XG5cbiAgaWYgKGRhdGEgaW5zdGFuY2VvZiByZWFkYWJsZSkge1xuICAgIHN0YXJ0UXVldWUodGhpcyk7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgc2VuZFN0cmVhbSh0aGlzLCBkYXRhLCBvcHRpb25zLCBmdW5jdGlvbiBzZW5kKGVycm9yKSB7XG4gICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uIHRvY2soKSB7XG4gICAgICAgIGV4ZWN1dGVRdWV1ZVNlbmRzKHNlbGYpO1xuICAgICAgfSk7XG5cbiAgICAgIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIGNiKGVycm9yKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLl9zZW5kZXIuc2VuZChkYXRhLCBvcHRpb25zLCBjYik7XG4gIH1cbn07XG5cbi8qKlxuICogU3RyZWFtcyBkYXRhIHRocm91Z2ggY2FsbHMgdG8gYSB1c2VyIHN1cHBsaWVkIGZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IE1lbWJlcnMgLSBtYXNrOiBib29sZWFuLCBiaW5hcnk6IGJvb2xlYW4sIGNvbXByZXNzOiBib29sZWFuXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSAnZnVuY3Rpb24gKGVycm9yLCBzZW5kKScgd2hpY2ggaXMgZXhlY3V0ZWQgb24gc3VjY2Vzc2l2ZSB0aWNrcyBvZiB3aGljaCBzZW5kIGlzICdmdW5jdGlvbiAoZGF0YSwgZmluYWwpJy5cbiAqIEBhcGkgcHVibGljXG4gKi9cbldlYlNvY2tldC5wcm90b3R5cGUuc3RyZWFtID0gZnVuY3Rpb24gc3RyZWFtKG9wdGlvbnMsIGNiKSB7XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNiID0gb3B0aW9ucztcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykgdGhyb3cgbmV3IEVycm9yKCdjYWxsYmFjayBtdXN0IGJlIHByb3ZpZGVkJyk7XG5cbiAgaWYgKHRoaXMucmVhZHlTdGF0ZSAhPT0gV2ViU29ja2V0Lk9QRU4pIHtcbiAgICBpZiAodHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSBjYihuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKSk7XG4gICAgZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodGhpcy5fcXVldWUpIHtcbiAgICB0aGlzLl9xdWV1ZS5wdXNoKGZ1bmN0aW9uICgpIHsgc2VsZi5zdHJlYW0ob3B0aW9ucywgY2IpOyB9KTtcbiAgICByZXR1cm47XG4gIH1cblxuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICBpZiAodHlwZW9mIG9wdGlvbnMubWFzayA9PT0gJ3VuZGVmaW5lZCcpIG9wdGlvbnMubWFzayA9ICF0aGlzLl9pc1NlcnZlcjtcbiAgaWYgKHR5cGVvZiBvcHRpb25zLmNvbXByZXNzID09PSAndW5kZWZpbmVkJykgb3B0aW9ucy5jb21wcmVzcyA9IHRydWU7XG4gIGlmICghdGhpcy5leHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdKSB7XG4gICAgb3B0aW9ucy5jb21wcmVzcyA9IGZhbHNlO1xuICB9XG5cbiAgc3RhcnRRdWV1ZSh0aGlzKTtcblxuICBmdW5jdGlvbiBzZW5kKGRhdGEsIGZpbmFsKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChzZWxmLnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5PUEVOKSB0aHJvdyBuZXcgRXJyb3IoJ25vdCBvcGVuZWQnKTtcbiAgICAgIG9wdGlvbnMuZmluID0gZmluYWwgPT09IHRydWU7XG4gICAgICBzZWxmLl9zZW5kZXIuc2VuZChkYXRhLCBvcHRpb25zKTtcbiAgICAgIGlmICghZmluYWwpIHByb2Nlc3MubmV4dFRpY2soY2IuYmluZChudWxsLCBudWxsLCBzZW5kKSk7XG4gICAgICBlbHNlIGV4ZWN1dGVRdWV1ZVNlbmRzKHNlbGYpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIGNiKGUpO1xuICAgICAgZWxzZSB7XG4gICAgICAgIGRlbGV0ZSBzZWxmLl9xdWV1ZTtcbiAgICAgICAgc2VsZi5lbWl0KCdlcnJvcicsIGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByb2Nlc3MubmV4dFRpY2soY2IuYmluZChudWxsLCBudWxsLCBzZW5kKSk7XG59O1xuXG4vKipcbiAqIEltbWVkaWF0ZWx5IHNodXRzIGRvd24gdGhlIGNvbm5lY3Rpb25cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5XZWJTb2NrZXQucHJvdG90eXBlLnRlcm1pbmF0ZSA9IGZ1bmN0aW9uIHRlcm1pbmF0ZSgpIHtcbiAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNMT1NFRCkgcmV0dXJuO1xuXG4gIGlmICh0aGlzLl9zb2NrZXQpIHtcbiAgICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuQ0xPU0lORztcblxuICAgIC8vIEVuZCB0aGUgY29ubmVjdGlvblxuICAgIHRyeSB7IHRoaXMuX3NvY2tldC5lbmQoKTsgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAvLyBTb2NrZXQgZXJyb3IgZHVyaW5nIGVuZCgpIGNhbGwsIHNvIGp1c3QgZGVzdHJveSBpdCByaWdodCBub3dcbiAgICAgIGNsZWFudXBXZWJzb2NrZXRSZXNvdXJjZXMuY2FsbCh0aGlzLCB0cnVlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBBZGQgYSB0aW1lb3V0IHRvIGVuc3VyZSB0aGF0IHRoZSBjb25uZWN0aW9uIGlzIGNvbXBsZXRlbHlcbiAgICAvLyBjbGVhbmVkIHVwIHdpdGhpbiAzMCBzZWNvbmRzLCBldmVuIGlmIHRoZSBjbGVhbiBjbG9zZSBwcm9jZWR1cmVcbiAgICAvLyBmYWlscyBmb3Igd2hhdGV2ZXIgcmVhc29uXG4gICAgLy8gRmlyc3QgY2xlYW51cCBhbnkgcHJlLWV4aXN0aW5nIHRpbWVvdXQgZnJvbSBhbiBlYXJsaWVyIFwidGVybWluYXRlXCIgY2FsbCxcbiAgICAvLyBpZiBvbmUgZXhpc3RzLiAgT3RoZXJ3aXNlIHRlcm1pbmF0ZSBjYWxscyBpbiBxdWljayBzdWNjZXNzaW9uIHdpbGwgbGVhayB0aW1lb3V0c1xuICAgIC8vIGFuZCBob2xkIHRoZSBwcm9ncmFtIG9wZW4gZm9yIGBjbG9zZVRpbW91dGAgdGltZS5cbiAgICBpZiAodGhpcy5fY2xvc2VUaW1lcikgeyBjbGVhclRpbWVvdXQodGhpcy5fY2xvc2VUaW1lcik7IH1cbiAgICB0aGlzLl9jbG9zZVRpbWVyID0gc2V0VGltZW91dChjbGVhbnVwV2Vic29ja2V0UmVzb3VyY2VzLmJpbmQodGhpcywgdHJ1ZSksIGNsb3NlVGltZW91dCk7XG4gIH0gZWxzZSBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ09OTkVDVElORykge1xuICAgIGNsZWFudXBXZWJzb2NrZXRSZXNvdXJjZXMuY2FsbCh0aGlzLCB0cnVlKTtcbiAgfVxufTtcblxuLyoqXG4gKiBFeHBvc2UgYnVmZmVyZWRBbW91bnRcbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoV2ViU29ja2V0LnByb3RvdHlwZSwgJ2J1ZmZlcmVkQW1vdW50Jywge1xuICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICB2YXIgYW1vdW50ID0gMDtcbiAgICBpZiAodGhpcy5fc29ja2V0KSB7XG4gICAgICBhbW91bnQgPSB0aGlzLl9zb2NrZXQuYnVmZmVyU2l6ZSB8fCAwO1xuICAgIH1cbiAgICByZXR1cm4gYW1vdW50O1xuICB9XG59KTtcblxuLyoqXG4gKiBFbXVsYXRlcyB0aGUgVzNDIEJyb3dzZXIgYmFzZWQgV2ViU29ja2V0IGludGVyZmFjZSB1c2luZyBmdW5jdGlvbiBtZW1iZXJzLlxuICpcbiAqIEBzZWUgaHR0cDovL2Rldi53My5vcmcvaHRtbDUvd2Vic29ja2V0cy8jdGhlLXdlYnNvY2tldC1pbnRlcmZhY2VcbiAqIEBhcGkgcHVibGljXG4gKi9cblsnb3BlbicsICdlcnJvcicsICdjbG9zZScsICdtZXNzYWdlJ10uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHtcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFdlYlNvY2tldC5wcm90b3R5cGUsICdvbicgKyBtZXRob2QsIHtcbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IGxpc3RlbmVyXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB7TWl4ZWR9IHRoZSBzZXQgZnVuY3Rpb24gb3IgdW5kZWZpbmVkXG4gICAgICogQGFwaSBwdWJsaWNcbiAgICAgKi9cbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgIHZhciBsaXN0ZW5lciA9IHRoaXMubGlzdGVuZXJzKG1ldGhvZClbMF07XG4gICAgICByZXR1cm4gbGlzdGVuZXIgPyAobGlzdGVuZXIuX2xpc3RlbmVyID8gbGlzdGVuZXIuX2xpc3RlbmVyIDogbGlzdGVuZXIpIDogdW5kZWZpbmVkO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBsaXN0ZW5pbmcgZm9yIGV2ZW50c1xuICAgICAqXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgdGhlIGxpc3RlbmVyXG4gICAgICogQHJldHVybnMge01peGVkfSB0aGUgc2V0IGZ1bmN0aW9uIG9yIHVuZGVmaW5lZFxuICAgICAqIEBhcGkgcHVibGljXG4gICAgICovXG4gICAgc2V0OiBmdW5jdGlvbiBzZXQobGlzdGVuZXIpIHtcbiAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKG1ldGhvZCk7XG4gICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIobWV0aG9kLCBsaXN0ZW5lcik7XG4gICAgfVxuICB9KTtcbn0pO1xuXG4vKipcbiAqIEVtdWxhdGVzIHRoZSBXM0MgQnJvd3NlciBiYXNlZCBXZWJTb2NrZXQgaW50ZXJmYWNlIHVzaW5nIGFkZEV2ZW50TGlzdGVuZXIuXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9ET00vZWxlbWVudC5hZGRFdmVudExpc3RlbmVyXG4gKiBAc2VlIGh0dHA6Ly9kZXYudzMub3JnL2h0bWw1L3dlYnNvY2tldHMvI3RoZS13ZWJzb2NrZXQtaW50ZXJmYWNlXG4gKiBAYXBpIHB1YmxpY1xuICovXG5XZWJTb2NrZXQucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihtZXRob2QsIGxpc3RlbmVyKSB7XG4gIHZhciB0YXJnZXQgPSB0aGlzO1xuXG4gIGZ1bmN0aW9uIG9uTWVzc2FnZSAoZGF0YSwgZmxhZ3MpIHtcbiAgICBsaXN0ZW5lci5jYWxsKHRhcmdldCwgbmV3IE1lc3NhZ2VFdmVudChkYXRhLCAhIWZsYWdzLmJpbmFyeSwgdGFyZ2V0KSk7XG4gIH1cblxuICBmdW5jdGlvbiBvbkNsb3NlIChjb2RlLCBtZXNzYWdlKSB7XG4gICAgbGlzdGVuZXIuY2FsbCh0YXJnZXQsIG5ldyBDbG9zZUV2ZW50KGNvZGUsIG1lc3NhZ2UsIHRhcmdldCkpO1xuICB9XG5cbiAgZnVuY3Rpb24gb25FcnJvciAoZXZlbnQpIHtcbiAgICBldmVudC50eXBlID0gJ2Vycm9yJztcbiAgICBldmVudC50YXJnZXQgPSB0YXJnZXQ7XG4gICAgbGlzdGVuZXIuY2FsbCh0YXJnZXQsIGV2ZW50KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uT3BlbiAoKSB7XG4gICAgbGlzdGVuZXIuY2FsbCh0YXJnZXQsIG5ldyBPcGVuRXZlbnQodGFyZ2V0KSk7XG4gIH1cblxuICBpZiAodHlwZW9mIGxpc3RlbmVyID09PSAnZnVuY3Rpb24nKSB7XG4gICAgaWYgKG1ldGhvZCA9PT0gJ21lc3NhZ2UnKSB7XG4gICAgICAvLyBzdG9yZSBhIHJlZmVyZW5jZSBzbyB3ZSBjYW4gcmV0dXJuIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiBmcm9tIHRoZVxuICAgICAgLy8gYWRkRXZlbnRMaXN0ZW5lciBob29rXG4gICAgICBvbk1lc3NhZ2UuX2xpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgICB0aGlzLm9uKG1ldGhvZCwgb25NZXNzYWdlKTtcbiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ2Nsb3NlJykge1xuICAgICAgLy8gc3RvcmUgYSByZWZlcmVuY2Ugc28gd2UgY2FuIHJldHVybiB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gZnJvbSB0aGVcbiAgICAgIC8vIGFkZEV2ZW50TGlzdGVuZXIgaG9va1xuICAgICAgb25DbG9zZS5fbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICAgIHRoaXMub24obWV0aG9kLCBvbkNsb3NlKTtcbiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ2Vycm9yJykge1xuICAgICAgLy8gc3RvcmUgYSByZWZlcmVuY2Ugc28gd2UgY2FuIHJldHVybiB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gZnJvbSB0aGVcbiAgICAgIC8vIGFkZEV2ZW50TGlzdGVuZXIgaG9va1xuICAgICAgb25FcnJvci5fbGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgICAgIHRoaXMub24obWV0aG9kLCBvbkVycm9yKTtcbiAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gJ29wZW4nKSB7XG4gICAgICAvLyBzdG9yZSBhIHJlZmVyZW5jZSBzbyB3ZSBjYW4gcmV0dXJuIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiBmcm9tIHRoZVxuICAgICAgLy8gYWRkRXZlbnRMaXN0ZW5lciBob29rXG4gICAgICBvbk9wZW4uX2xpc3RlbmVyID0gbGlzdGVuZXI7XG4gICAgICB0aGlzLm9uKG1ldGhvZCwgb25PcGVuKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vbihtZXRob2QsIGxpc3RlbmVyKTtcbiAgICB9XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gV2ViU29ja2V0O1xubW9kdWxlLmV4cG9ydHMuYnVpbGRIb3N0SGVhZGVyID0gYnVpbGRIb3N0SGVhZGVyXG5cbi8qKlxuICogVzNDIE1lc3NhZ2VFdmVudFxuICpcbiAqIEBzZWUgaHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDUvY29tbXMuaHRtbFxuICogQGNvbnN0cnVjdG9yXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gTWVzc2FnZUV2ZW50KGRhdGFBcmcsIGlzQmluYXJ5LCB0YXJnZXQpIHtcbiAgdGhpcy50eXBlID0gJ21lc3NhZ2UnO1xuICB0aGlzLmRhdGEgPSBkYXRhQXJnO1xuICB0aGlzLnRhcmdldCA9IHRhcmdldDtcbiAgdGhpcy5iaW5hcnkgPSBpc0JpbmFyeTsgLy8gbm9uLXN0YW5kYXJkLlxufVxuXG4vKipcbiAqIFczQyBDbG9zZUV2ZW50XG4gKlxuICogQHNlZSBodHRwOi8vd3d3LnczLm9yZy9UUi9odG1sNS9jb21tcy5odG1sXG4gKiBAY29uc3RydWN0b3JcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5mdW5jdGlvbiBDbG9zZUV2ZW50KGNvZGUsIHJlYXNvbiwgdGFyZ2V0KSB7XG4gIHRoaXMudHlwZSA9ICdjbG9zZSc7XG4gIHRoaXMud2FzQ2xlYW4gPSAodHlwZW9mIGNvZGUgPT09ICd1bmRlZmluZWQnIHx8IGNvZGUgPT09IDEwMDApO1xuICB0aGlzLmNvZGUgPSBjb2RlO1xuICB0aGlzLnJlYXNvbiA9IHJlYXNvbjtcbiAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG59XG5cbi8qKlxuICogVzNDIE9wZW5FdmVudFxuICpcbiAqIEBzZWUgaHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDUvY29tbXMuaHRtbFxuICogQGNvbnN0cnVjdG9yXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuZnVuY3Rpb24gT3BlbkV2ZW50KHRhcmdldCkge1xuICB0aGlzLnR5cGUgPSAnb3Blbic7XG4gIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xufVxuXG4vLyBBcHBlbmQgcG9ydCBudW1iZXIgdG8gSG9zdCBoZWFkZXIsIG9ubHkgaWYgc3BlY2lmaWVkIGluIHRoZSB1cmxcbi8vIGFuZCBub24tZGVmYXVsdFxuZnVuY3Rpb24gYnVpbGRIb3N0SGVhZGVyKGlzU2VjdXJlLCBob3N0bmFtZSwgcG9ydCkge1xuICB2YXIgaGVhZGVySG9zdCA9IGhvc3RuYW1lO1xuICBpZiAoaG9zdG5hbWUpIHtcbiAgICBpZiAoKGlzU2VjdXJlICYmIChwb3J0ICE9IDQ0MykpIHx8ICghaXNTZWN1cmUgJiYgKHBvcnQgIT0gODApKSl7XG4gICAgICBoZWFkZXJIb3N0ID0gaGVhZGVySG9zdCArICc6JyArIHBvcnQ7XG4gICAgfVxuICB9XG4gIHJldHVybiBoZWFkZXJIb3N0O1xufVxuXG4vKipcbiAqIEVudGlyZWx5IHByaXZhdGUgYXBpcyxcbiAqIHdoaWNoIG1heSBvciBtYXkgbm90IGJlIGJvdW5kIHRvIGEgc2VwY2lmaWMgV2ViU29ja2V0IGluc3RhbmNlLlxuICovXG5mdW5jdGlvbiBpbml0QXNTZXJ2ZXJDbGllbnQocmVxLCBzb2NrZXQsIHVwZ3JhZGVIZWFkLCBvcHRpb25zKSB7XG4gIG9wdGlvbnMgPSBuZXcgT3B0aW9ucyh7XG4gICAgcHJvdG9jb2xWZXJzaW9uOiBwcm90b2NvbFZlcnNpb24sXG4gICAgcHJvdG9jb2w6IG51bGwsXG4gICAgZXh0ZW5zaW9uczoge31cbiAgfSkubWVyZ2Uob3B0aW9ucyk7XG5cbiAgLy8gZXhwb3NlIHN0YXRlIHByb3BlcnRpZXNcbiAgdGhpcy5wcm90b2NvbCA9IG9wdGlvbnMudmFsdWUucHJvdG9jb2w7XG4gIHRoaXMucHJvdG9jb2xWZXJzaW9uID0gb3B0aW9ucy52YWx1ZS5wcm90b2NvbFZlcnNpb247XG4gIHRoaXMuZXh0ZW5zaW9ucyA9IG9wdGlvbnMudmFsdWUuZXh0ZW5zaW9ucztcbiAgdGhpcy5zdXBwb3J0cy5iaW5hcnkgPSAodGhpcy5wcm90b2NvbFZlcnNpb24gIT09ICdoaXhpZS03NicpO1xuICB0aGlzLnVwZ3JhZGVSZXEgPSByZXE7XG4gIHRoaXMucmVhZHlTdGF0ZSA9IFdlYlNvY2tldC5DT05ORUNUSU5HO1xuICB0aGlzLl9pc1NlcnZlciA9IHRydWU7XG5cbiAgLy8gZXN0YWJsaXNoIGNvbm5lY3Rpb25cbiAgaWYgKG9wdGlvbnMudmFsdWUucHJvdG9jb2xWZXJzaW9uID09PSAnaGl4aWUtNzYnKSB7XG4gICAgZXN0YWJsaXNoQ29ubmVjdGlvbi5jYWxsKHRoaXMsIFJlY2VpdmVySGl4aWUsIFNlbmRlckhpeGllLCBzb2NrZXQsIHVwZ3JhZGVIZWFkKTtcbiAgfSBlbHNlIHtcbiAgICBlc3RhYmxpc2hDb25uZWN0aW9uLmNhbGwodGhpcywgUmVjZWl2ZXIsIFNlbmRlciwgc29ja2V0LCB1cGdyYWRlSGVhZCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdEFzQ2xpZW50KGFkZHJlc3MsIHByb3RvY29scywgb3B0aW9ucykge1xuICBvcHRpb25zID0gbmV3IE9wdGlvbnMoe1xuICAgIG9yaWdpbjogbnVsbCxcbiAgICBwcm90b2NvbFZlcnNpb246IHByb3RvY29sVmVyc2lvbixcbiAgICBob3N0OiBudWxsLFxuICAgIGhlYWRlcnM6IG51bGwsXG4gICAgcHJvdG9jb2w6IHByb3RvY29scy5qb2luKCcsJyksXG4gICAgYWdlbnQ6IG51bGwsXG5cbiAgICAvLyBzc2wtcmVsYXRlZCBvcHRpb25zXG4gICAgcGZ4OiBudWxsLFxuICAgIGtleTogbnVsbCxcbiAgICBwYXNzcGhyYXNlOiBudWxsLFxuICAgIGNlcnQ6IG51bGwsXG4gICAgY2E6IG51bGwsXG4gICAgY2lwaGVyczogbnVsbCxcbiAgICByZWplY3RVbmF1dGhvcml6ZWQ6IG51bGwsXG4gICAgcGVyTWVzc2FnZURlZmxhdGU6IHRydWUsXG4gICAgbG9jYWxBZGRyZXNzOiBudWxsXG4gIH0pLm1lcmdlKG9wdGlvbnMpO1xuXG4gIGlmIChvcHRpb25zLnZhbHVlLnByb3RvY29sVmVyc2lvbiAhPT0gOCAmJiBvcHRpb25zLnZhbHVlLnByb3RvY29sVmVyc2lvbiAhPT0gMTMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Vuc3VwcG9ydGVkIHByb3RvY29sIHZlcnNpb24nKTtcbiAgfVxuXG4gIC8vIHZlcmlmeSBVUkwgYW5kIGVzdGFibGlzaCBodHRwIGNsYXNzXG4gIHZhciBzZXJ2ZXJVcmwgPSB1cmwucGFyc2UoYWRkcmVzcyk7XG4gIHZhciBpc1VuaXhTb2NrZXQgPSBzZXJ2ZXJVcmwucHJvdG9jb2wgPT09ICd3cyt1bml4Oic7XG4gIGlmICghc2VydmVyVXJsLmhvc3QgJiYgIWlzVW5peFNvY2tldCkgdGhyb3cgbmV3IEVycm9yKCdpbnZhbGlkIHVybCcpO1xuICB2YXIgaXNTZWN1cmUgPSBzZXJ2ZXJVcmwucHJvdG9jb2wgPT09ICd3c3M6JyB8fCBzZXJ2ZXJVcmwucHJvdG9jb2wgPT09ICdodHRwczonO1xuICB2YXIgaHR0cE9iaiA9IGlzU2VjdXJlID8gaHR0cHMgOiBodHRwO1xuICB2YXIgcG9ydCA9IHNlcnZlclVybC5wb3J0IHx8IChpc1NlY3VyZSA/IDQ0MyA6IDgwKTtcbiAgdmFyIGF1dGggPSBzZXJ2ZXJVcmwuYXV0aDtcblxuICAvLyBwcmVwYXJlIGV4dGVuc2lvbnNcbiAgdmFyIGV4dGVuc2lvbnNPZmZlciA9IHt9O1xuICB2YXIgcGVyTWVzc2FnZURlZmxhdGU7XG4gIGlmIChvcHRpb25zLnZhbHVlLnBlck1lc3NhZ2VEZWZsYXRlKSB7XG4gICAgcGVyTWVzc2FnZURlZmxhdGUgPSBuZXcgUGVyTWVzc2FnZURlZmxhdGUodHlwZW9mIG9wdGlvbnMudmFsdWUucGVyTWVzc2FnZURlZmxhdGUgIT09IHRydWUgPyBvcHRpb25zLnZhbHVlLnBlck1lc3NhZ2VEZWZsYXRlIDoge30sIGZhbHNlKTtcbiAgICBleHRlbnNpb25zT2ZmZXJbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0gPSBwZXJNZXNzYWdlRGVmbGF0ZS5vZmZlcigpO1xuICB9XG5cbiAgLy8gZXhwb3NlIHN0YXRlIHByb3BlcnRpZXNcbiAgdGhpcy5faXNTZXJ2ZXIgPSBmYWxzZTtcbiAgdGhpcy51cmwgPSBhZGRyZXNzO1xuICB0aGlzLnByb3RvY29sVmVyc2lvbiA9IG9wdGlvbnMudmFsdWUucHJvdG9jb2xWZXJzaW9uO1xuICB0aGlzLnN1cHBvcnRzLmJpbmFyeSA9ICh0aGlzLnByb3RvY29sVmVyc2lvbiAhPT0gJ2hpeGllLTc2Jyk7XG5cbiAgLy8gYmVnaW4gaGFuZHNoYWtlXG4gIHZhciBrZXkgPSBuZXcgQnVmZmVyKG9wdGlvbnMudmFsdWUucHJvdG9jb2xWZXJzaW9uICsgJy0nICsgRGF0ZS5ub3coKSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICB2YXIgc2hhc3VtID0gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTEnKTtcbiAgc2hhc3VtLnVwZGF0ZShrZXkgKyAnMjU4RUFGQTUtRTkxNC00N0RBLTk1Q0EtQzVBQjBEQzg1QjExJyk7XG4gIHZhciBleHBlY3RlZFNlcnZlcktleSA9IHNoYXN1bS5kaWdlc3QoJ2Jhc2U2NCcpO1xuXG4gIHZhciBhZ2VudCA9IG9wdGlvbnMudmFsdWUuYWdlbnQ7XG5cbiAgdmFyIGhlYWRlckhvc3QgPSBidWlsZEhvc3RIZWFkZXIoaXNTZWN1cmUsIHNlcnZlclVybC5ob3N0bmFtZSwgcG9ydClcblxuICB2YXIgcmVxdWVzdE9wdGlvbnMgPSB7XG4gICAgcG9ydDogcG9ydCxcbiAgICBob3N0OiBzZXJ2ZXJVcmwuaG9zdG5hbWUsXG4gICAgaGVhZGVyczoge1xuICAgICAgJ0Nvbm5lY3Rpb24nOiAnVXBncmFkZScsXG4gICAgICAnVXBncmFkZSc6ICd3ZWJzb2NrZXQnLFxuICAgICAgJ0hvc3QnOiBoZWFkZXJIb3N0LFxuICAgICAgJ1NlYy1XZWJTb2NrZXQtVmVyc2lvbic6IG9wdGlvbnMudmFsdWUucHJvdG9jb2xWZXJzaW9uLFxuICAgICAgJ1NlYy1XZWJTb2NrZXQtS2V5Jzoga2V5XG4gICAgfVxuICB9O1xuXG4gIC8vIElmIHdlIGhhdmUgYmFzaWMgYXV0aC5cbiAgaWYgKGF1dGgpIHtcbiAgICByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSAnQmFzaWMgJyArIG5ldyBCdWZmZXIoYXV0aCkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICB9XG5cbiAgaWYgKG9wdGlvbnMudmFsdWUucHJvdG9jb2wpIHtcbiAgICByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzWydTZWMtV2ViU29ja2V0LVByb3RvY29sJ10gPSBvcHRpb25zLnZhbHVlLnByb3RvY29sO1xuICB9XG5cbiAgaWYgKG9wdGlvbnMudmFsdWUuaG9zdCkge1xuICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMuSG9zdCA9IG9wdGlvbnMudmFsdWUuaG9zdDtcbiAgfVxuXG4gIGlmIChvcHRpb25zLnZhbHVlLmhlYWRlcnMpIHtcbiAgICBmb3IgKHZhciBoZWFkZXIgaW4gb3B0aW9ucy52YWx1ZS5oZWFkZXJzKSB7XG4gICAgICAgaWYgKG9wdGlvbnMudmFsdWUuaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShoZWFkZXIpKSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNbaGVhZGVyXSA9IG9wdGlvbnMudmFsdWUuaGVhZGVyc1toZWFkZXJdO1xuICAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoT2JqZWN0LmtleXMoZXh0ZW5zaW9uc09mZmVyKS5sZW5ndGgpIHtcbiAgICByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzWydTZWMtV2ViU29ja2V0LUV4dGVuc2lvbnMnXSA9IEV4dGVuc2lvbnMuZm9ybWF0KGV4dGVuc2lvbnNPZmZlcik7XG4gIH1cblxuICBpZiAob3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdwZngnKVxuICAgfHwgb3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdrZXknKVxuICAgfHwgb3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdwYXNzcGhyYXNlJylcbiAgIHx8IG9wdGlvbnMuaXNEZWZpbmVkQW5kTm9uTnVsbCgnY2VydCcpXG4gICB8fCBvcHRpb25zLmlzRGVmaW5lZEFuZE5vbk51bGwoJ2NhJylcbiAgIHx8IG9wdGlvbnMuaXNEZWZpbmVkQW5kTm9uTnVsbCgnY2lwaGVycycpXG4gICB8fCBvcHRpb25zLmlzRGVmaW5lZEFuZE5vbk51bGwoJ3JlamVjdFVuYXV0aG9yaXplZCcpKSB7XG5cbiAgICBpZiAob3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdwZngnKSkgcmVxdWVzdE9wdGlvbnMucGZ4ID0gb3B0aW9ucy52YWx1ZS5wZng7XG4gICAgaWYgKG9wdGlvbnMuaXNEZWZpbmVkQW5kTm9uTnVsbCgna2V5JykpIHJlcXVlc3RPcHRpb25zLmtleSA9IG9wdGlvbnMudmFsdWUua2V5O1xuICAgIGlmIChvcHRpb25zLmlzRGVmaW5lZEFuZE5vbk51bGwoJ3Bhc3NwaHJhc2UnKSkgcmVxdWVzdE9wdGlvbnMucGFzc3BocmFzZSA9IG9wdGlvbnMudmFsdWUucGFzc3BocmFzZTtcbiAgICBpZiAob3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdjZXJ0JykpIHJlcXVlc3RPcHRpb25zLmNlcnQgPSBvcHRpb25zLnZhbHVlLmNlcnQ7XG4gICAgaWYgKG9wdGlvbnMuaXNEZWZpbmVkQW5kTm9uTnVsbCgnY2EnKSkgcmVxdWVzdE9wdGlvbnMuY2EgPSBvcHRpb25zLnZhbHVlLmNhO1xuICAgIGlmIChvcHRpb25zLmlzRGVmaW5lZEFuZE5vbk51bGwoJ2NpcGhlcnMnKSkgcmVxdWVzdE9wdGlvbnMuY2lwaGVycyA9IG9wdGlvbnMudmFsdWUuY2lwaGVycztcbiAgICBpZiAob3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdyZWplY3RVbmF1dGhvcml6ZWQnKSkgcmVxdWVzdE9wdGlvbnMucmVqZWN0VW5hdXRob3JpemVkID0gb3B0aW9ucy52YWx1ZS5yZWplY3RVbmF1dGhvcml6ZWQ7XG5cbiAgICBpZiAoIWFnZW50KSB7XG4gICAgICAgIC8vIGdsb2JhbCBhZ2VudCBpZ25vcmVzIGNsaWVudCBzaWRlIGNlcnRpZmljYXRlc1xuICAgICAgICBhZ2VudCA9IG5ldyBodHRwT2JqLkFnZW50KHJlcXVlc3RPcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICByZXF1ZXN0T3B0aW9ucy5wYXRoID0gc2VydmVyVXJsLnBhdGggfHwgJy8nO1xuXG4gIGlmIChhZ2VudCkge1xuICAgIHJlcXVlc3RPcHRpb25zLmFnZW50ID0gYWdlbnQ7XG4gIH1cblxuICBpZiAoaXNVbml4U29ja2V0KSB7XG4gICAgcmVxdWVzdE9wdGlvbnMuc29ja2V0UGF0aCA9IHNlcnZlclVybC5wYXRobmFtZTtcbiAgfVxuXG4gIGlmIChvcHRpb25zLnZhbHVlLmxvY2FsQWRkcmVzcykge1xuICAgIHJlcXVlc3RPcHRpb25zLmxvY2FsQWRkcmVzcyA9IG9wdGlvbnMudmFsdWUubG9jYWxBZGRyZXNzO1xuICB9XG5cbiAgaWYgKG9wdGlvbnMudmFsdWUub3JpZ2luKSB7XG4gICAgaWYgKG9wdGlvbnMudmFsdWUucHJvdG9jb2xWZXJzaW9uIDwgMTMpIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNbJ1NlYy1XZWJTb2NrZXQtT3JpZ2luJ10gPSBvcHRpb25zLnZhbHVlLm9yaWdpbjtcbiAgICBlbHNlIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMuT3JpZ2luID0gb3B0aW9ucy52YWx1ZS5vcmlnaW47XG4gIH1cblxuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciByZXEgPSBodHRwT2JqLnJlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gIHJlcS5vbignZXJyb3InLCBmdW5jdGlvbiBvbmVycm9yKGVycm9yKSB7XG4gICAgc2VsZi5lbWl0KCdlcnJvcicsIGVycm9yKTtcbiAgICBjbGVhbnVwV2Vic29ja2V0UmVzb3VyY2VzLmNhbGwoc2VsZiwgZXJyb3IpO1xuICB9KTtcblxuICByZXEub25jZSgncmVzcG9uc2UnLCBmdW5jdGlvbiByZXNwb25zZShyZXMpIHtcbiAgICB2YXIgZXJyb3I7XG5cbiAgICBpZiAoIXNlbGYuZW1pdCgndW5leHBlY3RlZC1yZXNwb25zZScsIHJlcSwgcmVzKSkge1xuICAgICAgZXJyb3IgPSBuZXcgRXJyb3IoJ3VuZXhwZWN0ZWQgc2VydmVyIHJlc3BvbnNlICgnICsgcmVzLnN0YXR1c0NvZGUgKyAnKScpO1xuICAgICAgcmVxLmFib3J0KCk7XG4gICAgICBzZWxmLmVtaXQoJ2Vycm9yJywgZXJyb3IpO1xuICAgIH1cblxuICAgIGNsZWFudXBXZWJzb2NrZXRSZXNvdXJjZXMuY2FsbChzZWxmLCBlcnJvcik7XG4gIH0pO1xuXG4gIHJlcS5vbmNlKCd1cGdyYWRlJywgZnVuY3Rpb24gdXBncmFkZShyZXMsIHNvY2tldCwgdXBncmFkZUhlYWQpIHtcbiAgICBpZiAoc2VsZi5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ0xPU0VEKSB7XG4gICAgICAvLyBjbGllbnQgY2xvc2VkIGJlZm9yZSBzZXJ2ZXIgYWNjZXB0ZWQgY29ubmVjdGlvblxuICAgICAgc2VsZi5lbWl0KCdjbG9zZScpO1xuICAgICAgc2VsZi5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgIHNvY2tldC5lbmQoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgc2VydmVyS2V5ID0gcmVzLmhlYWRlcnNbJ3NlYy13ZWJzb2NrZXQtYWNjZXB0J107XG4gICAgaWYgKHR5cGVvZiBzZXJ2ZXJLZXkgPT09ICd1bmRlZmluZWQnIHx8IHNlcnZlcktleSAhPT0gZXhwZWN0ZWRTZXJ2ZXJLZXkpIHtcbiAgICAgIHNlbGYuZW1pdCgnZXJyb3InLCAnaW52YWxpZCBzZXJ2ZXIga2V5Jyk7XG4gICAgICBzZWxmLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgc29ja2V0LmVuZCgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBzZXJ2ZXJQcm90ID0gcmVzLmhlYWRlcnNbJ3NlYy13ZWJzb2NrZXQtcHJvdG9jb2wnXTtcbiAgICB2YXIgcHJvdExpc3QgPSAob3B0aW9ucy52YWx1ZS5wcm90b2NvbCB8fCBcIlwiKS5zcGxpdCgvLCAqLyk7XG4gICAgdmFyIHByb3RFcnJvciA9IG51bGw7XG5cbiAgICBpZiAoIW9wdGlvbnMudmFsdWUucHJvdG9jb2wgJiYgc2VydmVyUHJvdCkge1xuICAgICAgcHJvdEVycm9yID0gJ3NlcnZlciBzZW50IGEgc3VicHJvdG9jb2wgZXZlbiB0aG91Z2ggbm9uZSByZXF1ZXN0ZWQnO1xuICAgIH0gZWxzZSBpZiAob3B0aW9ucy52YWx1ZS5wcm90b2NvbCAmJiAhc2VydmVyUHJvdCkge1xuICAgICAgcHJvdEVycm9yID0gJ3NlcnZlciBzZW50IG5vIHN1YnByb3RvY29sIGV2ZW4gdGhvdWdoIHJlcXVlc3RlZCc7XG4gICAgfSBlbHNlIGlmIChzZXJ2ZXJQcm90ICYmIHByb3RMaXN0LmluZGV4T2Yoc2VydmVyUHJvdCkgPT09IC0xKSB7XG4gICAgICBwcm90RXJyb3IgPSAnc2VydmVyIHJlc3BvbmRlZCB3aXRoIGFuIGludmFsaWQgcHJvdG9jb2wnO1xuICAgIH1cblxuICAgIGlmIChwcm90RXJyb3IpIHtcbiAgICAgIHNlbGYuZW1pdCgnZXJyb3InLCBwcm90RXJyb3IpO1xuICAgICAgc2VsZi5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgIHNvY2tldC5lbmQoKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKHNlcnZlclByb3QpIHtcbiAgICAgIHNlbGYucHJvdG9jb2wgPSBzZXJ2ZXJQcm90O1xuICAgIH1cblxuICAgIHZhciBzZXJ2ZXJFeHRlbnNpb25zID0gRXh0ZW5zaW9ucy5wYXJzZShyZXMuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1leHRlbnNpb25zJ10pO1xuICAgIGlmIChwZXJNZXNzYWdlRGVmbGF0ZSAmJiBzZXJ2ZXJFeHRlbnNpb25zW1Blck1lc3NhZ2VEZWZsYXRlLmV4dGVuc2lvbk5hbWVdKSB7XG4gICAgICB0cnkge1xuICAgICAgICBwZXJNZXNzYWdlRGVmbGF0ZS5hY2NlcHQoc2VydmVyRXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgc2VsZi5lbWl0KCdlcnJvcicsICdpbnZhbGlkIGV4dGVuc2lvbiBwYXJhbWV0ZXInKTtcbiAgICAgICAgc2VsZi5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgc29ja2V0LmVuZCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZWxmLmV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0gPSBwZXJNZXNzYWdlRGVmbGF0ZTtcbiAgICB9XG5cbiAgICBlc3RhYmxpc2hDb25uZWN0aW9uLmNhbGwoc2VsZiwgUmVjZWl2ZXIsIFNlbmRlciwgc29ja2V0LCB1cGdyYWRlSGVhZCk7XG5cbiAgICAvLyBwZXJmb3JtIGNsZWFudXAgb24gaHR0cCByZXNvdXJjZXNcbiAgICByZXEucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgcmVxID0gbnVsbDtcbiAgICBhZ2VudCA9IG51bGw7XG4gIH0pO1xuXG4gIHJlcS5lbmQoKTtcbiAgdGhpcy5yZWFkeVN0YXRlID0gV2ViU29ja2V0LkNPTk5FQ1RJTkc7XG59XG5cbmZ1bmN0aW9uIGVzdGFibGlzaENvbm5lY3Rpb24oUmVjZWl2ZXJDbGFzcywgU2VuZGVyQ2xhc3MsIHNvY2tldCwgdXBncmFkZUhlYWQpIHtcbiAgdmFyIHVsdHJvbiA9IHRoaXMuX3VsdHJvbiA9IG5ldyBVbHRyb24oc29ja2V0KVxuICAgICwgY2FsbGVkID0gZmFsc2VcbiAgICAsIHNlbGYgPSB0aGlzO1xuXG4gIHNvY2tldC5zZXRUaW1lb3V0KDApO1xuICBzb2NrZXQuc2V0Tm9EZWxheSh0cnVlKTtcblxuICB0aGlzLl9yZWNlaXZlciA9IG5ldyBSZWNlaXZlckNsYXNzKHRoaXMuZXh0ZW5zaW9ucyk7XG4gIHRoaXMuX3NvY2tldCA9IHNvY2tldDtcblxuICAvLyBzb2NrZXQgY2xlYW51cCBoYW5kbGVyc1xuICB1bHRyb24ub24oJ2VuZCcsIGNsZWFudXBXZWJzb2NrZXRSZXNvdXJjZXMuYmluZCh0aGlzKSk7XG4gIHVsdHJvbi5vbignY2xvc2UnLCBjbGVhbnVwV2Vic29ja2V0UmVzb3VyY2VzLmJpbmQodGhpcykpO1xuICB1bHRyb24ub24oJ2Vycm9yJywgY2xlYW51cFdlYnNvY2tldFJlc291cmNlcy5iaW5kKHRoaXMpKTtcblxuICAvLyBlbnN1cmUgdGhhdCB0aGUgdXBncmFkZUhlYWQgaXMgYWRkZWQgdG8gdGhlIHJlY2VpdmVyXG4gIGZ1bmN0aW9uIGZpcnN0SGFuZGxlcihkYXRhKSB7XG4gICAgaWYgKGNhbGxlZCB8fCBzZWxmLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DTE9TRUQpIHJldHVybjtcblxuICAgIGNhbGxlZCA9IHRydWU7XG4gICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdkYXRhJywgZmlyc3RIYW5kbGVyKTtcbiAgICB1bHRyb24ub24oJ2RhdGEnLCByZWFsSGFuZGxlcik7XG5cbiAgICBpZiAodXBncmFkZUhlYWQgJiYgdXBncmFkZUhlYWQubGVuZ3RoID4gMCkge1xuICAgICAgcmVhbEhhbmRsZXIodXBncmFkZUhlYWQpO1xuICAgICAgdXBncmFkZUhlYWQgPSBudWxsO1xuICAgIH1cblxuICAgIGlmIChkYXRhKSByZWFsSGFuZGxlcihkYXRhKTtcbiAgfVxuXG4gIC8vIHN1YnNlcXVlbnQgcGFja2V0cyBhcmUgcHVzaGVkIHN0cmFpZ2h0IHRvIHRoZSByZWNlaXZlclxuICBmdW5jdGlvbiByZWFsSGFuZGxlcihkYXRhKSB7XG4gICAgc2VsZi5ieXRlc1JlY2VpdmVkICs9IGRhdGEubGVuZ3RoO1xuICAgIHNlbGYuX3JlY2VpdmVyLmFkZChkYXRhKTtcbiAgfVxuXG4gIHVsdHJvbi5vbignZGF0YScsIGZpcnN0SGFuZGxlcik7XG5cbiAgLy8gaWYgZGF0YSB3YXMgcGFzc2VkIGFsb25nIHdpdGggdGhlIGh0dHAgdXBncmFkZSxcbiAgLy8gdGhpcyB3aWxsIHNjaGVkdWxlIGEgcHVzaCBvZiB0aGF0IG9uIHRvIHRoZSByZWNlaXZlci5cbiAgLy8gdGhpcyBoYXMgdG8gYmUgZG9uZSBvbiBuZXh0IHRpY2ssIHNpbmNlIHRoZSBjYWxsZXJcbiAgLy8gaGFzbid0IGhhZCBhIGNoYW5jZSB0byBzZXQgZXZlbnQgaGFuZGxlcnMgb24gdGhpcyBjbGllbnRcbiAgLy8gb2JqZWN0IHlldC5cbiAgcHJvY2Vzcy5uZXh0VGljayhmaXJzdEhhbmRsZXIpO1xuXG4gIC8vIHJlY2VpdmVyIGV2ZW50IGhhbmRsZXJzXG4gIHNlbGYuX3JlY2VpdmVyLm9udGV4dCA9IGZ1bmN0aW9uIG9udGV4dChkYXRhLCBmbGFncykge1xuICAgIGZsYWdzID0gZmxhZ3MgfHwge307XG5cbiAgICBzZWxmLmVtaXQoJ21lc3NhZ2UnLCBkYXRhLCBmbGFncyk7XG4gIH07XG5cbiAgc2VsZi5fcmVjZWl2ZXIub25iaW5hcnkgPSBmdW5jdGlvbiBvbmJpbmFyeShkYXRhLCBmbGFncykge1xuICAgIGZsYWdzID0gZmxhZ3MgfHwge307XG5cbiAgICBmbGFncy5iaW5hcnkgPSB0cnVlO1xuICAgIHNlbGYuZW1pdCgnbWVzc2FnZScsIGRhdGEsIGZsYWdzKTtcbiAgfTtcblxuICBzZWxmLl9yZWNlaXZlci5vbnBpbmcgPSBmdW5jdGlvbiBvbnBpbmcoZGF0YSwgZmxhZ3MpIHtcbiAgICBmbGFncyA9IGZsYWdzIHx8IHt9O1xuXG4gICAgc2VsZi5wb25nKGRhdGEsIHtcbiAgICAgIG1hc2s6ICFzZWxmLl9pc1NlcnZlcixcbiAgICAgIGJpbmFyeTogZmxhZ3MuYmluYXJ5ID09PSB0cnVlXG4gICAgfSwgdHJ1ZSk7XG5cbiAgICBzZWxmLmVtaXQoJ3BpbmcnLCBkYXRhLCBmbGFncyk7XG4gIH07XG5cbiAgc2VsZi5fcmVjZWl2ZXIub25wb25nID0gZnVuY3Rpb24gb25wb25nKGRhdGEsIGZsYWdzKSB7XG4gICAgc2VsZi5lbWl0KCdwb25nJywgZGF0YSwgZmxhZ3MgfHwge30pO1xuICB9O1xuXG4gIHNlbGYuX3JlY2VpdmVyLm9uY2xvc2UgPSBmdW5jdGlvbiBvbmNsb3NlKGNvZGUsIGRhdGEsIGZsYWdzKSB7XG4gICAgZmxhZ3MgPSBmbGFncyB8fCB7fTtcblxuICAgIHNlbGYuX2Nsb3NlUmVjZWl2ZWQgPSB0cnVlO1xuICAgIHNlbGYuY2xvc2UoY29kZSwgZGF0YSk7XG4gIH07XG5cbiAgc2VsZi5fcmVjZWl2ZXIub25lcnJvciA9IGZ1bmN0aW9uIG9uZXJyb3IocmVhc29uLCBlcnJvckNvZGUpIHtcbiAgICAvLyBjbG9zZSB0aGUgY29ubmVjdGlvbiB3aGVuIHRoZSByZWNlaXZlciByZXBvcnRzIGEgSHlCaSBlcnJvciBjb2RlXG4gICAgc2VsZi5jbG9zZSh0eXBlb2YgZXJyb3JDb2RlICE9PSAndW5kZWZpbmVkJyA/IGVycm9yQ29kZSA6IDEwMDIsICcnKTtcbiAgICBzZWxmLmVtaXQoJ2Vycm9yJywgcmVhc29uLCBlcnJvckNvZGUpO1xuICB9O1xuXG4gIC8vIGZpbmFsaXplIHRoZSBjbGllbnRcbiAgdGhpcy5fc2VuZGVyID0gbmV3IFNlbmRlckNsYXNzKHNvY2tldCwgdGhpcy5leHRlbnNpb25zKTtcbiAgdGhpcy5fc2VuZGVyLm9uKCdlcnJvcicsIGZ1bmN0aW9uIG9uZXJyb3IoZXJyb3IpIHtcbiAgICBzZWxmLmNsb3NlKDEwMDIsICcnKTtcbiAgICBzZWxmLmVtaXQoJ2Vycm9yJywgZXJyb3IpO1xuICB9KTtcblxuICB0aGlzLnJlYWR5U3RhdGUgPSBXZWJTb2NrZXQuT1BFTjtcbiAgdGhpcy5lbWl0KCdvcGVuJyk7XG59XG5cbmZ1bmN0aW9uIHN0YXJ0UXVldWUoaW5zdGFuY2UpIHtcbiAgaW5zdGFuY2UuX3F1ZXVlID0gaW5zdGFuY2UuX3F1ZXVlIHx8IFtdO1xufVxuXG5mdW5jdGlvbiBleGVjdXRlUXVldWVTZW5kcyhpbnN0YW5jZSkge1xuICB2YXIgcXVldWUgPSBpbnN0YW5jZS5fcXVldWU7XG4gIGlmICh0eXBlb2YgcXVldWUgPT09ICd1bmRlZmluZWQnKSByZXR1cm47XG5cbiAgZGVsZXRlIGluc3RhbmNlLl9xdWV1ZTtcbiAgZm9yICh2YXIgaSA9IDAsIGwgPSBxdWV1ZS5sZW5ndGg7IGkgPCBsOyArK2kpIHtcbiAgICBxdWV1ZVtpXSgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNlbmRTdHJlYW0oaW5zdGFuY2UsIHN0cmVhbSwgb3B0aW9ucywgY2IpIHtcbiAgc3RyZWFtLm9uKCdkYXRhJywgZnVuY3Rpb24gaW5jb21pbmcoZGF0YSkge1xuICAgIGlmIChpbnN0YW5jZS5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuT1BFTikge1xuICAgICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykgY2IobmV3IEVycm9yKCdub3Qgb3BlbmVkJykpO1xuICAgICAgZWxzZSB7XG4gICAgICAgIGRlbGV0ZSBpbnN0YW5jZS5fcXVldWU7XG4gICAgICAgIGluc3RhbmNlLmVtaXQoJ2Vycm9yJywgbmV3IEVycm9yKCdub3Qgb3BlbmVkJykpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIG9wdGlvbnMuZmluID0gZmFsc2U7XG4gICAgaW5zdGFuY2UuX3NlbmRlci5zZW5kKGRhdGEsIG9wdGlvbnMpO1xuICB9KTtcblxuICBzdHJlYW0ub24oJ2VuZCcsIGZ1bmN0aW9uIGVuZCgpIHtcbiAgICBpZiAoaW5zdGFuY2UucmVhZHlTdGF0ZSAhPT0gV2ViU29ja2V0Lk9QRU4pIHtcbiAgICAgIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIGNiKG5ldyBFcnJvcignbm90IG9wZW5lZCcpKTtcbiAgICAgIGVsc2Uge1xuICAgICAgICBkZWxldGUgaW5zdGFuY2UuX3F1ZXVlO1xuICAgICAgICBpbnN0YW5jZS5lbWl0KCdlcnJvcicsIG5ldyBFcnJvcignbm90IG9wZW5lZCcpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBvcHRpb25zLmZpbiA9IHRydWU7XG4gICAgaW5zdGFuY2UuX3NlbmRlci5zZW5kKG51bGwsIG9wdGlvbnMpO1xuXG4gICAgaWYgKHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJykgY2IobnVsbCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjbGVhbnVwV2Vic29ja2V0UmVzb3VyY2VzKGVycm9yKSB7XG4gIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DTE9TRUQpIHJldHVybjtcblxuICB2YXIgZW1pdENsb3NlID0gdGhpcy5yZWFkeVN0YXRlICE9PSBXZWJTb2NrZXQuQ09OTkVDVElORztcbiAgdGhpcy5yZWFkeVN0YXRlID0gV2ViU29ja2V0LkNMT1NFRDtcblxuICBjbGVhclRpbWVvdXQodGhpcy5fY2xvc2VUaW1lcik7XG4gIHRoaXMuX2Nsb3NlVGltZXIgPSBudWxsO1xuXG4gIGlmIChlbWl0Q2xvc2UpIHtcbiAgICAvLyBJZiB0aGUgY29ubmVjdGlvbiB3YXMgY2xvc2VkIGFibm9ybWFsbHkgKHdpdGggYW4gZXJyb3IpLCBvciBpZlxuICAgIC8vIHRoZSBjbG9zZSBjb250cm9sIGZyYW1lIHdhcyBub3QgcmVjZWl2ZWQgdGhlbiB0aGUgY2xvc2UgY29kZVxuICAgIC8vIG11c3QgZGVmYXVsdCB0byAxMDA2LlxuICAgIGlmIChlcnJvciB8fCAhdGhpcy5fY2xvc2VSZWNlaXZlZCkge1xuICAgICAgdGhpcy5fY2xvc2VDb2RlID0gMTAwNjtcbiAgICB9XG4gICAgdGhpcy5lbWl0KCdjbG9zZScsIHRoaXMuX2Nsb3NlQ29kZSB8fCAxMDAwLCB0aGlzLl9jbG9zZU1lc3NhZ2UgfHwgJycpO1xuICB9XG5cbiAgaWYgKHRoaXMuX3NvY2tldCkge1xuICAgIGlmICh0aGlzLl91bHRyb24pIHRoaXMuX3VsdHJvbi5kZXN0cm95KCk7XG4gICAgdGhpcy5fc29ja2V0Lm9uKCdlcnJvcicsIGZ1bmN0aW9uIG9uZXJyb3IoKSB7XG4gICAgICB0cnkgeyB0aGlzLmRlc3Ryb3koKTsgfVxuICAgICAgY2F0Y2ggKGUpIHt9XG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgaWYgKCFlcnJvcikgdGhpcy5fc29ja2V0LmVuZCgpO1xuICAgICAgZWxzZSB0aGlzLl9zb2NrZXQuZGVzdHJveSgpO1xuICAgIH0gY2F0Y2ggKGUpIHsgLyogSWdub3JlIHRlcm1pbmF0aW9uIGVycm9ycyAqLyB9XG5cbiAgICB0aGlzLl9zb2NrZXQgPSBudWxsO1xuICAgIHRoaXMuX3VsdHJvbiA9IG51bGw7XG4gIH1cblxuICBpZiAodGhpcy5fc2VuZGVyKSB7XG4gICAgdGhpcy5fc2VuZGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgIHRoaXMuX3NlbmRlciA9IG51bGw7XG4gIH1cblxuICBpZiAodGhpcy5fcmVjZWl2ZXIpIHtcbiAgICB0aGlzLl9yZWNlaXZlci5jbGVhbnVwKCk7XG4gICAgdGhpcy5fcmVjZWl2ZXIgPSBudWxsO1xuICB9XG5cbiAgaWYgKHRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkge1xuICAgIHRoaXMuZXh0ZW5zaW9uc1tQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXS5jbGVhbnVwKCk7XG4gIH1cblxuICB0aGlzLmV4dGVuc2lvbnMgPSBudWxsO1xuXG4gIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gIHRoaXMub24oJ2Vycm9yJywgZnVuY3Rpb24gb25lcnJvcigpIHt9KTsgLy8gY2F0Y2ggYWxsIGVycm9ycyBhZnRlciB0aGlzXG4gIGRlbGV0ZSB0aGlzLl9xdWV1ZTtcbn1cbiIsIi8qIVxuICogd3M6IGEgbm9kZS5qcyB3ZWJzb2NrZXQgY2xpZW50XG4gKiBDb3B5cmlnaHQoYykgMjAxMSBFaW5hciBPdHRvIFN0YW5ndmlrIDxlaW5hcm9zQGdtYWlsLmNvbT5cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbCcpXG4gICwgZXZlbnRzID0gcmVxdWlyZSgnZXZlbnRzJylcbiAgLCBodHRwID0gcmVxdWlyZSgnaHR0cCcpXG4gICwgY3J5cHRvID0gcmVxdWlyZSgnY3J5cHRvJylcbiAgLCBPcHRpb25zID0gcmVxdWlyZSgnb3B0aW9ucycpXG4gICwgV2ViU29ja2V0ID0gcmVxdWlyZSgnLi9XZWJTb2NrZXQnKVxuICAsIEV4dGVuc2lvbnMgPSByZXF1aXJlKCcuL0V4dGVuc2lvbnMnKVxuICAsIFBlck1lc3NhZ2VEZWZsYXRlID0gcmVxdWlyZSgnLi9QZXJNZXNzYWdlRGVmbGF0ZScpXG4gICwgdGxzID0gcmVxdWlyZSgndGxzJylcbiAgLCB1cmwgPSByZXF1aXJlKCd1cmwnKTtcblxuLyoqXG4gKiBXZWJTb2NrZXQgU2VydmVyIGltcGxlbWVudGF0aW9uXG4gKi9cblxuZnVuY3Rpb24gV2ViU29ja2V0U2VydmVyKG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gIGlmICh0aGlzIGluc3RhbmNlb2YgV2ViU29ja2V0U2VydmVyID09PSBmYWxzZSkge1xuICAgIHJldHVybiBuZXcgV2ViU29ja2V0U2VydmVyKG9wdGlvbnMsIGNhbGxiYWNrKTtcbiAgfVxuXG4gIGV2ZW50cy5FdmVudEVtaXR0ZXIuY2FsbCh0aGlzKTtcblxuICBvcHRpb25zID0gbmV3IE9wdGlvbnMoe1xuICAgIGhvc3Q6ICcwLjAuMC4wJyxcbiAgICBwb3J0OiBudWxsLFxuICAgIHNlcnZlcjogbnVsbCxcbiAgICB2ZXJpZnlDbGllbnQ6IG51bGwsXG4gICAgaGFuZGxlUHJvdG9jb2xzOiBudWxsLFxuICAgIHBhdGg6IG51bGwsXG4gICAgbm9TZXJ2ZXI6IGZhbHNlLFxuICAgIGRpc2FibGVIaXhpZTogZmFsc2UsXG4gICAgY2xpZW50VHJhY2tpbmc6IHRydWUsXG4gICAgcGVyTWVzc2FnZURlZmxhdGU6IHRydWVcbiAgfSkubWVyZ2Uob3B0aW9ucyk7XG5cbiAgaWYgKCFvcHRpb25zLmlzRGVmaW5lZEFuZE5vbk51bGwoJ3BvcnQnKSAmJiAhb3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdzZXJ2ZXInKSAmJiAhb3B0aW9ucy52YWx1ZS5ub1NlcnZlcikge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ2Bwb3J0YCBvciBhIGBzZXJ2ZXJgIG11c3QgYmUgcHJvdmlkZWQnKTtcbiAgfVxuXG4gIHZhciBzZWxmID0gdGhpcztcblxuICBpZiAob3B0aW9ucy5pc0RlZmluZWRBbmROb25OdWxsKCdwb3J0JykpIHtcbiAgICB0aGlzLl9zZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcihmdW5jdGlvbiAocmVxLCByZXMpIHtcbiAgICAgIHZhciBib2R5ID0gaHR0cC5TVEFUVVNfQ09ERVNbNDI2XTtcbiAgICAgIHJlcy53cml0ZUhlYWQoNDI2LCB7XG4gICAgICAgICdDb250ZW50LUxlbmd0aCc6IGJvZHkubGVuZ3RoLFxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nXG4gICAgICB9KTtcbiAgICAgIHJlcy5lbmQoYm9keSk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2VydmVyLmFsbG93SGFsZk9wZW4gPSBmYWxzZTtcbiAgICB0aGlzLl9zZXJ2ZXIubGlzdGVuKG9wdGlvbnMudmFsdWUucG9ydCwgb3B0aW9ucy52YWx1ZS5ob3N0LCBjYWxsYmFjayk7XG4gICAgdGhpcy5fY2xvc2VTZXJ2ZXIgPSBmdW5jdGlvbigpIHsgaWYgKHNlbGYuX3NlcnZlcikgc2VsZi5fc2VydmVyLmNsb3NlKCk7IH07XG4gIH1cbiAgZWxzZSBpZiAob3B0aW9ucy52YWx1ZS5zZXJ2ZXIpIHtcbiAgICB0aGlzLl9zZXJ2ZXIgPSBvcHRpb25zLnZhbHVlLnNlcnZlcjtcbiAgICBpZiAob3B0aW9ucy52YWx1ZS5wYXRoKSB7XG4gICAgICAvLyB0YWtlIG5vdGUgb2YgdGhlIHBhdGgsIHRvIGF2b2lkIGNvbGxpc2lvbnMgd2hlbiBtdWx0aXBsZSB3ZWJzb2NrZXQgc2VydmVycyBhcmVcbiAgICAgIC8vIGxpc3RlbmluZyBvbiB0aGUgc2FtZSBodHRwIHNlcnZlclxuICAgICAgaWYgKHRoaXMuX3NlcnZlci5fd2ViU29ja2V0UGF0aHMgJiYgb3B0aW9ucy52YWx1ZS5zZXJ2ZXIuX3dlYlNvY2tldFBhdGhzW29wdGlvbnMudmFsdWUucGF0aF0pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd0d28gaW5zdGFuY2VzIG9mIFdlYlNvY2tldFNlcnZlciBjYW5ub3QgbGlzdGVuIG9uIHRoZSBzYW1lIGh0dHAgc2VydmVyIHBhdGgnKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdGhpcy5fc2VydmVyLl93ZWJTb2NrZXRQYXRocyAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgdGhpcy5fc2VydmVyLl93ZWJTb2NrZXRQYXRocyA9IHt9O1xuICAgICAgfVxuICAgICAgdGhpcy5fc2VydmVyLl93ZWJTb2NrZXRQYXRoc1tvcHRpb25zLnZhbHVlLnBhdGhdID0gMTtcbiAgICB9XG4gIH1cbiAgaWYgKHRoaXMuX3NlcnZlcikgdGhpcy5fc2VydmVyLm9uY2UoJ2xpc3RlbmluZycsIGZ1bmN0aW9uKCkgeyBzZWxmLmVtaXQoJ2xpc3RlbmluZycpOyB9KTtcblxuICBpZiAodHlwZW9mIHRoaXMuX3NlcnZlciAhPSAndW5kZWZpbmVkJykge1xuICAgIHRoaXMuX3NlcnZlci5vbignZXJyb3InLCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgc2VsZi5lbWl0KCdlcnJvcicsIGVycm9yKVxuICAgIH0pO1xuICAgIHRoaXMuX3NlcnZlci5vbigndXBncmFkZScsIGZ1bmN0aW9uKHJlcSwgc29ja2V0LCB1cGdyYWRlSGVhZCkge1xuICAgICAgLy9jb3B5IHVwZ3JhZGVIZWFkIHRvIGF2b2lkIHJldGVudGlvbiBvZiBsYXJnZSBzbGFiIGJ1ZmZlcnMgdXNlZCBpbiBub2RlIGNvcmVcbiAgICAgIHZhciBoZWFkID0gbmV3IEJ1ZmZlcih1cGdyYWRlSGVhZC5sZW5ndGgpO1xuICAgICAgdXBncmFkZUhlYWQuY29weShoZWFkKTtcblxuICAgICAgc2VsZi5oYW5kbGVVcGdyYWRlKHJlcSwgc29ja2V0LCBoZWFkLCBmdW5jdGlvbihjbGllbnQpIHtcbiAgICAgICAgc2VsZi5lbWl0KCdjb25uZWN0aW9uJytyZXEudXJsLCBjbGllbnQpO1xuICAgICAgICBzZWxmLmVtaXQoJ2Nvbm5lY3Rpb24nLCBjbGllbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zLnZhbHVlO1xuICB0aGlzLnBhdGggPSBvcHRpb25zLnZhbHVlLnBhdGg7XG4gIHRoaXMuY2xpZW50cyA9IFtdO1xufVxuXG4vKipcbiAqIEluaGVyaXRzIGZyb20gRXZlbnRFbWl0dGVyLlxuICovXG5cbnV0aWwuaW5oZXJpdHMoV2ViU29ja2V0U2VydmVyLCBldmVudHMuRXZlbnRFbWl0dGVyKTtcblxuLyoqXG4gKiBJbW1lZGlhdGVseSBzaHV0cyBkb3duIHRoZSBjb25uZWN0aW9uLlxuICpcbiAqIEBhcGkgcHVibGljXG4gKi9cblxuV2ViU29ja2V0U2VydmVyLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gIC8vIHRlcm1pbmF0ZSBhbGwgYXNzb2NpYXRlZCBjbGllbnRzXG4gIHZhciBlcnJvciA9IG51bGw7XG4gIHRyeSB7XG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmNsaWVudHMubGVuZ3RoOyBpIDwgbDsgKytpKSB7XG4gICAgICB0aGlzLmNsaWVudHNbaV0udGVybWluYXRlKCk7XG4gICAgfVxuICB9XG4gIGNhdGNoIChlKSB7XG4gICAgZXJyb3IgPSBlO1xuICB9XG5cbiAgLy8gcmVtb3ZlIHBhdGggZGVzY3JpcHRvciwgaWYgYW55XG4gIGlmICh0aGlzLnBhdGggJiYgdGhpcy5fc2VydmVyLl93ZWJTb2NrZXRQYXRocykge1xuICAgIGRlbGV0ZSB0aGlzLl9zZXJ2ZXIuX3dlYlNvY2tldFBhdGhzW3RoaXMucGF0aF07XG4gICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuX3NlcnZlci5fd2ViU29ja2V0UGF0aHMpLmxlbmd0aCA9PSAwKSB7XG4gICAgICBkZWxldGUgdGhpcy5fc2VydmVyLl93ZWJTb2NrZXRQYXRocztcbiAgICB9XG4gIH1cblxuICAvLyBjbG9zZSB0aGUgaHR0cCBzZXJ2ZXIgaWYgaXQgd2FzIGludGVybmFsbHkgY3JlYXRlZFxuICB0cnkge1xuICAgIGlmICh0eXBlb2YgdGhpcy5fY2xvc2VTZXJ2ZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB0aGlzLl9jbG9zZVNlcnZlcigpO1xuICAgIH1cbiAgfVxuICBmaW5hbGx5IHtcbiAgICBkZWxldGUgdGhpcy5fc2VydmVyO1xuICB9XG4gIGlmKGNhbGxiYWNrKVxuICAgIGNhbGxiYWNrKGVycm9yKTtcbiAgZWxzZSBpZihlcnJvcilcbiAgICB0aHJvdyBlcnJvcjtcbn1cblxuLyoqXG4gKiBIYW5kbGUgYSBIVFRQIFVwZ3JhZGUgcmVxdWVzdC5cbiAqXG4gKiBAYXBpIHB1YmxpY1xuICovXG5cbldlYlNvY2tldFNlcnZlci5wcm90b3R5cGUuaGFuZGxlVXBncmFkZSA9IGZ1bmN0aW9uKHJlcSwgc29ja2V0LCB1cGdyYWRlSGVhZCwgY2IpIHtcbiAgLy8gY2hlY2sgZm9yIHdyb25nIHBhdGhcbiAgaWYgKHRoaXMub3B0aW9ucy5wYXRoKSB7XG4gICAgdmFyIHUgPSB1cmwucGFyc2UocmVxLnVybCk7XG4gICAgaWYgKHUgJiYgdS5wYXRobmFtZSAhPT0gdGhpcy5vcHRpb25zLnBhdGgpIHJldHVybjtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcmVxLmhlYWRlcnMudXBncmFkZSA9PT0gJ3VuZGVmaW5lZCcgfHwgcmVxLmhlYWRlcnMudXBncmFkZS50b0xvd2VyQ2FzZSgpICE9PSAnd2Vic29ja2V0Jykge1xuICAgIGFib3J0Q29ubmVjdGlvbihzb2NrZXQsIDQwMCwgJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWtleTEnXSkgaGFuZGxlSGl4aWVVcGdyYWRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIGVsc2UgaGFuZGxlSHliaVVwZ3JhZGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBXZWJTb2NrZXRTZXJ2ZXI7XG5cbi8qKlxuICogRW50aXJlbHkgcHJpdmF0ZSBhcGlzLFxuICogd2hpY2ggbWF5IG9yIG1heSBub3QgYmUgYm91bmQgdG8gYSBzZXBjaWZpYyBXZWJTb2NrZXQgaW5zdGFuY2UuXG4gKi9cblxuZnVuY3Rpb24gaGFuZGxlSHliaVVwZ3JhZGUocmVxLCBzb2NrZXQsIHVwZ3JhZGVIZWFkLCBjYikge1xuICAvLyBoYW5kbGUgcHJlbWF0dXJlIHNvY2tldCBlcnJvcnNcbiAgdmFyIGVycm9ySGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRyeSB7IHNvY2tldC5kZXN0cm95KCk7IH0gY2F0Y2ggKGUpIHt9XG4gIH1cbiAgc29ja2V0Lm9uKCdlcnJvcicsIGVycm9ySGFuZGxlcik7XG5cbiAgLy8gdmVyaWZ5IGtleSBwcmVzZW5jZVxuICBpZiAoIXJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWtleSddKSB7XG4gICAgYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNDAwLCAnQmFkIFJlcXVlc3QnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyB2ZXJpZnkgdmVyc2lvblxuICB2YXIgdmVyc2lvbiA9IHBhcnNlSW50KHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LXZlcnNpb24nXSk7XG4gIGlmIChbOCwgMTNdLmluZGV4T2YodmVyc2lvbikgPT09IC0xKSB7XG4gICAgYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNDAwLCAnQmFkIFJlcXVlc3QnKTtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyB2ZXJpZnkgcHJvdG9jb2xcbiAgdmFyIHByb3RvY29scyA9IHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LXByb3RvY29sJ107XG5cbiAgLy8gdmVyaWZ5IGNsaWVudFxuICB2YXIgb3JpZ2luID0gdmVyc2lvbiA8IDEzID9cbiAgICByZXEuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1vcmlnaW4nXSA6XG4gICAgcmVxLmhlYWRlcnNbJ29yaWdpbiddO1xuXG4gIC8vIGhhbmRsZSBleHRlbnNpb25zIG9mZmVyXG4gIHZhciBleHRlbnNpb25zT2ZmZXIgPSBFeHRlbnNpb25zLnBhcnNlKHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWV4dGVuc2lvbnMnXSk7XG5cbiAgLy8gaGFuZGxlciB0byBjYWxsIHdoZW4gdGhlIGNvbm5lY3Rpb24gc2VxdWVuY2UgY29tcGxldGVzXG4gIHZhciBzZWxmID0gdGhpcztcbiAgdmFyIGNvbXBsZXRlSHliaVVwZ3JhZGUyID0gZnVuY3Rpb24ocHJvdG9jb2wpIHtcblxuICAgIC8vIGNhbGMga2V5XG4gICAgdmFyIGtleSA9IHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWtleSddO1xuICAgIHZhciBzaGFzdW0gPSBjcnlwdG8uY3JlYXRlSGFzaCgnc2hhMScpO1xuICAgIHNoYXN1bS51cGRhdGUoa2V5ICsgXCIyNThFQUZBNS1FOTE0LTQ3REEtOTVDQS1DNUFCMERDODVCMTFcIik7XG4gICAga2V5ID0gc2hhc3VtLmRpZ2VzdCgnYmFzZTY0Jyk7XG5cbiAgICB2YXIgaGVhZGVycyA9IFtcbiAgICAgICAgJ0hUVFAvMS4xIDEwMSBTd2l0Y2hpbmcgUHJvdG9jb2xzJ1xuICAgICAgLCAnVXBncmFkZTogd2Vic29ja2V0J1xuICAgICAgLCAnQ29ubmVjdGlvbjogVXBncmFkZSdcbiAgICAgICwgJ1NlYy1XZWJTb2NrZXQtQWNjZXB0OiAnICsga2V5XG4gICAgXTtcblxuICAgIGlmICh0eXBlb2YgcHJvdG9jb2wgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGhlYWRlcnMucHVzaCgnU2VjLVdlYlNvY2tldC1Qcm90b2NvbDogJyArIHByb3RvY29sKTtcbiAgICB9XG5cbiAgICB2YXIgZXh0ZW5zaW9ucyA9IHt9O1xuICAgIHRyeSB7XG4gICAgICBleHRlbnNpb25zID0gYWNjZXB0RXh0ZW5zaW9ucy5jYWxsKHNlbGYsIGV4dGVuc2lvbnNPZmZlcik7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCA0MDAsICdCYWQgUmVxdWVzdCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChPYmplY3Qua2V5cyhleHRlbnNpb25zKS5sZW5ndGgpIHtcbiAgICAgIHZhciBzZXJ2ZXJFeHRlbnNpb25zID0ge307XG4gICAgICBPYmplY3Qua2V5cyhleHRlbnNpb25zKS5mb3JFYWNoKGZ1bmN0aW9uKHRva2VuKSB7XG4gICAgICAgIHNlcnZlckV4dGVuc2lvbnNbdG9rZW5dID0gW2V4dGVuc2lvbnNbdG9rZW5dLnBhcmFtc11cbiAgICAgIH0pO1xuICAgICAgaGVhZGVycy5wdXNoKCdTZWMtV2ViU29ja2V0LUV4dGVuc2lvbnM6ICcgKyBFeHRlbnNpb25zLmZvcm1hdChzZXJ2ZXJFeHRlbnNpb25zKSk7XG4gICAgfVxuXG4gICAgLy8gYWxsb3dzIGV4dGVybmFsIG1vZGlmaWNhdGlvbi9pbnNwZWN0aW9uIG9mIGhhbmRzaGFrZSBoZWFkZXJzXG4gICAgc2VsZi5lbWl0KCdoZWFkZXJzJywgaGVhZGVycyk7XG5cbiAgICBzb2NrZXQuc2V0VGltZW91dCgwKTtcbiAgICBzb2NrZXQuc2V0Tm9EZWxheSh0cnVlKTtcbiAgICB0cnkge1xuICAgICAgc29ja2V0LndyaXRlKGhlYWRlcnMuY29uY2F0KCcnLCAnJykuam9pbignXFxyXFxuJykpO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgLy8gaWYgdGhlIHVwZ3JhZGUgd3JpdGUgZmFpbHMsIHNodXQgdGhlIGNvbm5lY3Rpb24gZG93biBoYXJkXG4gICAgICB0cnkgeyBzb2NrZXQuZGVzdHJveSgpOyB9IGNhdGNoIChlKSB7fVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBjbGllbnQgPSBuZXcgV2ViU29ja2V0KFtyZXEsIHNvY2tldCwgdXBncmFkZUhlYWRdLCB7XG4gICAgICBwcm90b2NvbFZlcnNpb246IHZlcnNpb24sXG4gICAgICBwcm90b2NvbDogcHJvdG9jb2wsXG4gICAgICBleHRlbnNpb25zOiBleHRlbnNpb25zXG4gICAgfSk7XG5cbiAgICBpZiAoc2VsZi5vcHRpb25zLmNsaWVudFRyYWNraW5nKSB7XG4gICAgICBzZWxmLmNsaWVudHMucHVzaChjbGllbnQpO1xuICAgICAgY2xpZW50Lm9uKCdjbG9zZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgaW5kZXggPSBzZWxmLmNsaWVudHMuaW5kZXhPZihjbGllbnQpO1xuICAgICAgICBpZiAoaW5kZXggIT0gLTEpIHtcbiAgICAgICAgICBzZWxmLmNsaWVudHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gc2lnbmFsIHVwZ3JhZGUgY29tcGxldGVcbiAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgZXJyb3JIYW5kbGVyKTtcbiAgICBjYihjbGllbnQpO1xuICB9XG5cbiAgLy8gb3B0aW9uYWxseSBjYWxsIGV4dGVybmFsIHByb3RvY29sIHNlbGVjdGlvbiBoYW5kbGVyIGJlZm9yZVxuICAvLyBjYWxsaW5nIGNvbXBsZXRlSHliaVVwZ3JhZGUyXG4gIHZhciBjb21wbGV0ZUh5YmlVcGdyYWRlMSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIGNob29zZSBmcm9tIHRoZSBzdWItcHJvdG9jb2xzXG4gICAgaWYgKHR5cGVvZiBzZWxmLm9wdGlvbnMuaGFuZGxlUHJvdG9jb2xzID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdmFyIHByb3RMaXN0ID0gKHByb3RvY29scyB8fCBcIlwiKS5zcGxpdCgvLCAqLyk7XG4gICAgICAgIHZhciBjYWxsYmFja0NhbGxlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgcmVzID0gc2VsZi5vcHRpb25zLmhhbmRsZVByb3RvY29scyhwcm90TGlzdCwgZnVuY3Rpb24ocmVzdWx0LCBwcm90b2NvbCkge1xuICAgICAgICAgIGNhbGxiYWNrQ2FsbGVkID0gdHJ1ZTtcbiAgICAgICAgICBpZiAoIXJlc3VsdCkgYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNDAxLCAnVW5hdXRob3JpemVkJyk7XG4gICAgICAgICAgZWxzZSBjb21wbGV0ZUh5YmlVcGdyYWRlMihwcm90b2NvbCk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIWNhbGxiYWNrQ2FsbGVkKSB7XG4gICAgICAgICAgICAvLyB0aGUgaGFuZGxlUHJvdG9jb2xzIGhhbmRsZXIgbmV2ZXIgY2FsbGVkIG91ciBjYWxsYmFja1xuICAgICAgICAgICAgYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgNTAxLCAnQ291bGQgbm90IHByb2Nlc3MgcHJvdG9jb2xzJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0eXBlb2YgcHJvdG9jb2xzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgY29tcGxldGVIeWJpVXBncmFkZTIocHJvdG9jb2xzLnNwbGl0KC8sICovKVswXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb21wbGV0ZUh5YmlVcGdyYWRlMigpO1xuICAgICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gb3B0aW9uYWxseSBjYWxsIGV4dGVybmFsIGNsaWVudCB2ZXJpZmljYXRpb24gaGFuZGxlclxuICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy52ZXJpZnlDbGllbnQgPT0gJ2Z1bmN0aW9uJykge1xuICAgIHZhciBpbmZvID0ge1xuICAgICAgb3JpZ2luOiBvcmlnaW4sXG4gICAgICBzZWN1cmU6IHR5cGVvZiByZXEuY29ubmVjdGlvbi5hdXRob3JpemVkICE9PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgcmVxLmNvbm5lY3Rpb24uZW5jcnlwdGVkICE9PSAndW5kZWZpbmVkJyxcbiAgICAgIHJlcTogcmVxXG4gICAgfTtcbiAgICBpZiAodGhpcy5vcHRpb25zLnZlcmlmeUNsaWVudC5sZW5ndGggPT0gMikge1xuICAgICAgdGhpcy5vcHRpb25zLnZlcmlmeUNsaWVudChpbmZvLCBmdW5jdGlvbihyZXN1bHQsIGNvZGUsIG5hbWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjb2RlID09PSAndW5kZWZpbmVkJykgY29kZSA9IDQwMTtcbiAgICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAndW5kZWZpbmVkJykgbmFtZSA9IGh0dHAuU1RBVFVTX0NPREVTW2NvZGVdO1xuXG4gICAgICAgIGlmICghcmVzdWx0KSBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCBjb2RlLCBuYW1lKTtcbiAgICAgICAgZWxzZSBjb21wbGV0ZUh5YmlVcGdyYWRlMSgpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsc2UgaWYgKCF0aGlzLm9wdGlvbnMudmVyaWZ5Q2xpZW50KGluZm8pKSB7XG4gICAgICBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCA0MDEsICdVbmF1dGhvcml6ZWQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBjb21wbGV0ZUh5YmlVcGdyYWRlMSgpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVIaXhpZVVwZ3JhZGUocmVxLCBzb2NrZXQsIHVwZ3JhZGVIZWFkLCBjYikge1xuICAvLyBoYW5kbGUgcHJlbWF0dXJlIHNvY2tldCBlcnJvcnNcbiAgdmFyIGVycm9ySGFuZGxlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRyeSB7IHNvY2tldC5kZXN0cm95KCk7IH0gY2F0Y2ggKGUpIHt9XG4gIH1cbiAgc29ja2V0Lm9uKCdlcnJvcicsIGVycm9ySGFuZGxlcik7XG5cbiAgLy8gYmFpbCBpZiBvcHRpb25zIHByZXZlbnQgaGl4aWVcbiAgaWYgKHRoaXMub3B0aW9ucy5kaXNhYmxlSGl4aWUpIHtcbiAgICBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCA0MDEsICdIaXhpZSBzdXBwb3J0IGRpc2FibGVkJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gdmVyaWZ5IGtleSBwcmVzZW5jZVxuICBpZiAoIXJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LWtleTInXSkge1xuICAgIGFib3J0Q29ubmVjdGlvbihzb2NrZXQsIDQwMCwgJ0JhZCBSZXF1ZXN0Jyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG9yaWdpbiA9IHJlcS5oZWFkZXJzWydvcmlnaW4nXVxuICAgICwgc2VsZiA9IHRoaXM7XG5cbiAgLy8gc2V0dXAgaGFuZHNoYWtlIGNvbXBsZXRpb24gdG8gcnVuIGFmdGVyIGNsaWVudCBoYXMgYmVlbiB2ZXJpZmllZFxuICB2YXIgb25DbGllbnRWZXJpZmllZCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciB3c2hvc3Q7XG4gICAgaWYgKCFyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtaG9zdCddKVxuICAgICAgICB3c2hvc3QgPSByZXEuaGVhZGVycy5ob3N0O1xuICAgIGVsc2VcbiAgICAgICAgd3Nob3N0ID0gcmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWhvc3QnXTtcbiAgICB2YXIgbG9jYXRpb24gPSAoKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1wcm90byddID09PSAnaHR0cHMnIHx8IHNvY2tldC5lbmNyeXB0ZWQpID8gJ3dzcycgOiAnd3MnKSArICc6Ly8nICsgd3Nob3N0ICsgcmVxLnVybFxuICAgICAgLCBwcm90b2NvbCA9IHJlcS5oZWFkZXJzWydzZWMtd2Vic29ja2V0LXByb3RvY29sJ107XG5cbiAgICAvLyBoYW5kc2hha2UgY29tcGxldGlvbiBjb2RlIHRvIHJ1biBvbmNlIG5vbmNlIGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSByZXRyaWV2ZWRcbiAgICB2YXIgY29tcGxldGVIYW5kc2hha2UgPSBmdW5jdGlvbihub25jZSwgcmVzdCkge1xuICAgICAgLy8gY2FsY3VsYXRlIGtleVxuICAgICAgdmFyIGsxID0gcmVxLmhlYWRlcnNbJ3NlYy13ZWJzb2NrZXQta2V5MSddXG4gICAgICAgICwgazIgPSByZXEuaGVhZGVyc1snc2VjLXdlYnNvY2tldC1rZXkyJ11cbiAgICAgICAgLCBtZDUgPSBjcnlwdG8uY3JlYXRlSGFzaCgnbWQ1Jyk7XG5cbiAgICAgIFtrMSwgazJdLmZvckVhY2goZnVuY3Rpb24gKGspIHtcbiAgICAgICAgdmFyIG4gPSBwYXJzZUludChrLnJlcGxhY2UoL1teXFxkXS9nLCAnJykpXG4gICAgICAgICAgLCBzcGFjZXMgPSBrLnJlcGxhY2UoL1teIF0vZywgJycpLmxlbmd0aDtcbiAgICAgICAgaWYgKHNwYWNlcyA9PT0gMCB8fCBuICUgc3BhY2VzICE9PSAwKXtcbiAgICAgICAgICBhYm9ydENvbm5lY3Rpb24oc29ja2V0LCA0MDAsICdCYWQgUmVxdWVzdCcpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBuIC89IHNwYWNlcztcbiAgICAgICAgbWQ1LnVwZGF0ZShTdHJpbmcuZnJvbUNoYXJDb2RlKFxuICAgICAgICAgIG4gPj4gMjQgJiAweEZGLFxuICAgICAgICAgIG4gPj4gMTYgJiAweEZGLFxuICAgICAgICAgIG4gPj4gOCAgJiAweEZGLFxuICAgICAgICAgIG4gICAgICAgJiAweEZGKSk7XG4gICAgICB9KTtcbiAgICAgIG1kNS51cGRhdGUobm9uY2UudG9TdHJpbmcoJ2JpbmFyeScpKTtcblxuICAgICAgdmFyIGhlYWRlcnMgPSBbXG4gICAgICAgICAgJ0hUVFAvMS4xIDEwMSBTd2l0Y2hpbmcgUHJvdG9jb2xzJ1xuICAgICAgICAsICdVcGdyYWRlOiBXZWJTb2NrZXQnXG4gICAgICAgICwgJ0Nvbm5lY3Rpb246IFVwZ3JhZGUnXG4gICAgICAgICwgJ1NlYy1XZWJTb2NrZXQtTG9jYXRpb246ICcgKyBsb2NhdGlvblxuICAgICAgXTtcbiAgICAgIGlmICh0eXBlb2YgcHJvdG9jb2wgIT0gJ3VuZGVmaW5lZCcpIGhlYWRlcnMucHVzaCgnU2VjLVdlYlNvY2tldC1Qcm90b2NvbDogJyArIHByb3RvY29sKTtcbiAgICAgIGlmICh0eXBlb2Ygb3JpZ2luICE9ICd1bmRlZmluZWQnKSBoZWFkZXJzLnB1c2goJ1NlYy1XZWJTb2NrZXQtT3JpZ2luOiAnICsgb3JpZ2luKTtcblxuICAgICAgc29ja2V0LnNldFRpbWVvdXQoMCk7XG4gICAgICBzb2NrZXQuc2V0Tm9EZWxheSh0cnVlKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIG1lcmdlIGhlYWRlciBhbmQgaGFzaCBidWZmZXJcbiAgICAgICAgdmFyIGhlYWRlckJ1ZmZlciA9IG5ldyBCdWZmZXIoaGVhZGVycy5jb25jYXQoJycsICcnKS5qb2luKCdcXHJcXG4nKSk7XG4gICAgICAgIHZhciBoYXNoQnVmZmVyID0gbmV3IEJ1ZmZlcihtZDUuZGlnZXN0KCdiaW5hcnknKSwgJ2JpbmFyeScpO1xuICAgICAgICB2YXIgaGFuZHNoYWtlQnVmZmVyID0gbmV3IEJ1ZmZlcihoZWFkZXJCdWZmZXIubGVuZ3RoICsgaGFzaEJ1ZmZlci5sZW5ndGgpO1xuICAgICAgICBoZWFkZXJCdWZmZXIuY29weShoYW5kc2hha2VCdWZmZXIsIDApO1xuICAgICAgICBoYXNoQnVmZmVyLmNvcHkoaGFuZHNoYWtlQnVmZmVyLCBoZWFkZXJCdWZmZXIubGVuZ3RoKTtcblxuICAgICAgICAvLyBkbyBhIHNpbmdsZSB3cml0ZSwgd2hpY2ggLSB1cG9uIHN1Y2Nlc3MgLSBjYXVzZXMgYSBuZXcgY2xpZW50IHdlYnNvY2tldCB0byBiZSBzZXR1cFxuICAgICAgICBzb2NrZXQud3JpdGUoaGFuZHNoYWtlQnVmZmVyLCAnYmluYXJ5JywgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgaWYgKGVycikgcmV0dXJuOyAvLyBkbyBub3QgY3JlYXRlIGNsaWVudCBpZiBhbiBlcnJvciBoYXBwZW5zXG4gICAgICAgICAgdmFyIGNsaWVudCA9IG5ldyBXZWJTb2NrZXQoW3JlcSwgc29ja2V0LCByZXN0XSwge1xuICAgICAgICAgICAgcHJvdG9jb2xWZXJzaW9uOiAnaGl4aWUtNzYnLFxuICAgICAgICAgICAgcHJvdG9jb2w6IHByb3RvY29sXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5jbGllbnRUcmFja2luZykge1xuICAgICAgICAgICAgc2VsZi5jbGllbnRzLnB1c2goY2xpZW50KTtcbiAgICAgICAgICAgIGNsaWVudC5vbignY2xvc2UnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgdmFyIGluZGV4ID0gc2VsZi5jbGllbnRzLmluZGV4T2YoY2xpZW50KTtcbiAgICAgICAgICAgICAgaWYgKGluZGV4ICE9IC0xKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGllbnRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIHNpZ25hbCB1cGdyYWRlIGNvbXBsZXRlXG4gICAgICAgICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIGVycm9ySGFuZGxlcik7XG4gICAgICAgICAgY2IoY2xpZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjYXRjaCAoZSkge1xuICAgICAgICB0cnkgeyBzb2NrZXQuZGVzdHJveSgpOyB9IGNhdGNoIChlKSB7fVxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gcmV0cmlldmUgbm9uY2VcbiAgICB2YXIgbm9uY2VMZW5ndGggPSA4O1xuICAgIGlmICh1cGdyYWRlSGVhZCAmJiB1cGdyYWRlSGVhZC5sZW5ndGggPj0gbm9uY2VMZW5ndGgpIHtcbiAgICAgIHZhciBub25jZSA9IHVwZ3JhZGVIZWFkLnNsaWNlKDAsIG5vbmNlTGVuZ3RoKTtcbiAgICAgIHZhciByZXN0ID0gdXBncmFkZUhlYWQubGVuZ3RoID4gbm9uY2VMZW5ndGggPyB1cGdyYWRlSGVhZC5zbGljZShub25jZUxlbmd0aCkgOiBudWxsO1xuICAgICAgY29tcGxldGVIYW5kc2hha2UuY2FsbChzZWxmLCBub25jZSwgcmVzdCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gbm9uY2Ugbm90IHByZXNlbnQgaW4gdXBncmFkZUhlYWQsIHNvIHdlIG11c3Qgd2FpdCBmb3IgZW5vdWdoIGRhdGFcbiAgICAgIC8vIGRhdGEgdG8gYXJyaXZlIGJlZm9yZSBjb250aW51aW5nXG4gICAgICB2YXIgbm9uY2UgPSBuZXcgQnVmZmVyKG5vbmNlTGVuZ3RoKTtcbiAgICAgIHVwZ3JhZGVIZWFkLmNvcHkobm9uY2UsIDApO1xuICAgICAgdmFyIHJlY2VpdmVkID0gdXBncmFkZUhlYWQubGVuZ3RoO1xuICAgICAgdmFyIHJlc3QgPSBudWxsO1xuICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgdG9SZWFkID0gTWF0aC5taW4oZGF0YS5sZW5ndGgsIG5vbmNlTGVuZ3RoIC0gcmVjZWl2ZWQpO1xuICAgICAgICBpZiAodG9SZWFkID09PSAwKSByZXR1cm47XG4gICAgICAgIGRhdGEuY29weShub25jZSwgcmVjZWl2ZWQsIDAsIHRvUmVhZCk7XG4gICAgICAgIHJlY2VpdmVkICs9IHRvUmVhZDtcbiAgICAgICAgaWYgKHJlY2VpdmVkID09IG5vbmNlTGVuZ3RoKSB7XG4gICAgICAgICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdkYXRhJywgaGFuZGxlcik7XG4gICAgICAgICAgaWYgKHRvUmVhZCA8IGRhdGEubGVuZ3RoKSByZXN0ID0gZGF0YS5zbGljZSh0b1JlYWQpO1xuICAgICAgICAgIGNvbXBsZXRlSGFuZHNoYWtlLmNhbGwoc2VsZiwgbm9uY2UsIHJlc3QpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzb2NrZXQub24oJ2RhdGEnLCBoYW5kbGVyKTtcbiAgICB9XG4gIH1cblxuICAvLyB2ZXJpZnkgY2xpZW50XG4gIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLnZlcmlmeUNsaWVudCA9PSAnZnVuY3Rpb24nKSB7XG4gICAgdmFyIGluZm8gPSB7XG4gICAgICBvcmlnaW46IG9yaWdpbixcbiAgICAgIHNlY3VyZTogdHlwZW9mIHJlcS5jb25uZWN0aW9uLmF1dGhvcml6ZWQgIT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiByZXEuY29ubmVjdGlvbi5lbmNyeXB0ZWQgIT09ICd1bmRlZmluZWQnLFxuICAgICAgcmVxOiByZXFcbiAgICB9O1xuICAgIGlmICh0aGlzLm9wdGlvbnMudmVyaWZ5Q2xpZW50Lmxlbmd0aCA9PSAyKSB7XG4gICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICB0aGlzLm9wdGlvbnMudmVyaWZ5Q2xpZW50KGluZm8sIGZ1bmN0aW9uKHJlc3VsdCwgY29kZSwgbmFtZSkge1xuICAgICAgICBpZiAodHlwZW9mIGNvZGUgPT09ICd1bmRlZmluZWQnKSBjb2RlID0gNDAxO1xuICAgICAgICBpZiAodHlwZW9mIG5hbWUgPT09ICd1bmRlZmluZWQnKSBuYW1lID0gaHR0cC5TVEFUVVNfQ09ERVNbY29kZV07XG5cbiAgICAgICAgaWYgKCFyZXN1bHQpIGFib3J0Q29ubmVjdGlvbihzb2NrZXQsIGNvZGUsIG5hbWUpO1xuICAgICAgICBlbHNlIG9uQ2xpZW50VmVyaWZpZWQuYXBwbHkoc2VsZik7XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZWxzZSBpZiAoIXRoaXMub3B0aW9ucy52ZXJpZnlDbGllbnQoaW5mbykpIHtcbiAgICAgIGFib3J0Q29ubmVjdGlvbihzb2NrZXQsIDQwMSwgJ1VuYXV0aG9yaXplZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIC8vIG5vIGNsaWVudCB2ZXJpZmljYXRpb24gcmVxdWlyZWRcbiAgb25DbGllbnRWZXJpZmllZCgpO1xufVxuXG5mdW5jdGlvbiBhY2NlcHRFeHRlbnNpb25zKG9mZmVyKSB7XG4gIHZhciBleHRlbnNpb25zID0ge307XG4gIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLnBlck1lc3NhZ2VEZWZsYXRlO1xuICBpZiAob3B0aW9ucyAmJiBvZmZlcltQZXJNZXNzYWdlRGVmbGF0ZS5leHRlbnNpb25OYW1lXSkge1xuICAgIHZhciBwZXJNZXNzYWdlRGVmbGF0ZSA9IG5ldyBQZXJNZXNzYWdlRGVmbGF0ZShvcHRpb25zICE9PSB0cnVlID8gb3B0aW9ucyA6IHt9LCB0cnVlKTtcbiAgICBwZXJNZXNzYWdlRGVmbGF0ZS5hY2NlcHQob2ZmZXJbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0pO1xuICAgIGV4dGVuc2lvbnNbUGVyTWVzc2FnZURlZmxhdGUuZXh0ZW5zaW9uTmFtZV0gPSBwZXJNZXNzYWdlRGVmbGF0ZTtcbiAgfVxuICByZXR1cm4gZXh0ZW5zaW9ucztcbn1cblxuZnVuY3Rpb24gYWJvcnRDb25uZWN0aW9uKHNvY2tldCwgY29kZSwgbmFtZSkge1xuICB0cnkge1xuICAgIHZhciByZXNwb25zZSA9IFtcbiAgICAgICdIVFRQLzEuMSAnICsgY29kZSArICcgJyArIG5hbWUsXG4gICAgICAnQ29udGVudC10eXBlOiB0ZXh0L2h0bWwnXG4gICAgXTtcbiAgICBzb2NrZXQud3JpdGUocmVzcG9uc2UuY29uY2F0KCcnLCAnJykuam9pbignXFxyXFxuJykpO1xuICB9XG4gIGNhdGNoIChlKSB7IC8qIGlnbm9yZSBlcnJvcnMgLSB3ZSd2ZSBhYm9ydGVkIHRoaXMgY29ubmVjdGlvbiAqLyB9XG4gIGZpbmFsbHkge1xuICAgIC8vIGVuc3VyZSB0aGF0IGFuIGVhcmx5IGFib3J0ZWQgY29ubmVjdGlvbiBpcyBzaHV0IGRvd24gY29tcGxldGVseVxuICAgIHRyeSB7IHNvY2tldC5kZXN0cm95KCk7IH0gY2F0Y2ggKGUpIHt9XG4gIH1cbn1cbiIsIi8qKlxyXG4gKiBAYXV0aG9yIHFpYW8gLyBodHRwczovL2dpdGh1Yi5jb20vcWlhb1xyXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tXHJcbiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vXHJcbiAqIEBhdXRob3IgV2VzdExhbmdsZXkgLyBodHRwOi8vZ2l0aHViLmNvbS9XZXN0TGFuZ2xleVxyXG4gKiBAY29udHJpYnV0b3IgZDN4MHIgLyBodHRwOi8vZ2l0aHViLmNvbS9kM3gwciAgLSBhZGQgZW5hYmxlL2Rpc2FibGUgdG8gYWxsb3cgZGlzY29ubmVjdGluZyB0aGVzZSBldmVudHNcclxuICovXHJcblxyXG5USFJFRS5PcmJpdENvbnRyb2xzID0gZnVuY3Rpb24gKCBvYmplY3QsIGNsdXN0ZXJMb29rQXQsIGRvbUVsZW1lbnQgKSB7XHJcblx0Ly8gbW9kZSAxLCBpcyBsaW1pdGVkXHJcblx0dGhpcy5tb2RlID0gMjtcclxuXHR0aGlzLm9iamVjdCA9IG9iamVjdDtcclxuXHR0aGlzLmNsdXN0ZXIgPSBjbHVzdGVyTG9va0F0O1xyXG5cdHRoaXMuZG9tRWxlbWVudCA9ICggZG9tRWxlbWVudCAhPT0gdW5kZWZpbmVkICkgPyBkb21FbGVtZW50IDogZG9jdW1lbnQ7XHJcblxyXG5cdC8vIEFQSVxyXG5cclxuXHR0aGlzLmVuYWJsZWQgPSB0cnVlO1xyXG5cclxuXHR0aGlzLmNlbnRlciA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XHJcblxyXG5cdHRoaXMudXNlclpvb20gPSB0cnVlO1xyXG5cdHRoaXMudXNlclpvb21TcGVlZCA9IDAuMTA7XHJcblxyXG5cdHRoaXMudXNlclJvdGF0ZSA9IHRydWU7XHJcblx0dGhpcy51c2VyUm90YXRlU3BlZWQgPSAxLjA7XHJcblxyXG5cdHRoaXMudXNlclBhbiA9IHRydWU7XHJcblx0dGhpcy51c2VyUGFuU3BlZWQgPSAyLjA7XHJcblxyXG5cdHRoaXMuYXV0b1JvdGF0ZSA9IGZhbHNlO1xyXG5cdHRoaXMuYXV0b1JvdGF0ZVNwZWVkID0gMi4wOyAvLyAzMCBzZWNvbmRzIHBlciByb3VuZCB3aGVuIGZwcyBpcyA2MFxyXG5cclxuXHR0aGlzLm1pblBvbGFyQW5nbGUgPSAwOyAvLyByYWRpYW5zXHJcblx0dGhpcy5tYXhQb2xhckFuZ2xlID0gTWF0aC5QSTsgLy8gcmFkaWFuc1xyXG5cclxuXHR0aGlzLm1pbkRpc3RhbmNlID0gMDtcclxuXHR0aGlzLm1heERpc3RhbmNlID0gSW5maW5pdHk7XHJcblxyXG5cdC8vIDY1IC8qQSovLCA4MyAvKlMqLywgNjggLypEKi9cclxuXHR0aGlzLmtleXMgPSB7IExFRlQ6IDM3LCBVUDogMzgsIFJJR0hUOiAzOSwgQk9UVE9NOiA0MCwgUk9UQVRFOiA2NSwgWk9PTTogODMsIFBBTjogNjggfTtcclxuXHJcblx0Ly8gaW50ZXJuYWxzXHJcblxyXG5cdHZhciBzY29wZSA9IHRoaXM7XHJcblxyXG5cdHZhciBFUFMgPSAwLjAwMDAwMTtcclxuXHR2YXIgUElYRUxTX1BFUl9ST1VORCA9IDE4MDA7XHJcblxyXG5cdHZhciByb3RhdGVTdGFydCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XHJcblx0dmFyIHJvdGF0ZUVuZCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XHJcblx0dmFyIHJvdGF0ZURlbHRhID0gbmV3IFRIUkVFLlZlY3RvcjIoKTtcclxuXHJcblx0dmFyIHpvb21TdGFydCA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XHJcblx0dmFyIHpvb21FbmQgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xyXG5cdHZhciB6b29tRGVsdGEgPSBuZXcgVEhSRUUuVmVjdG9yMigpO1xyXG5cclxuXHR2YXIgcGhpRGVsdGEgPSAwO1xyXG5cdHZhciB0aGV0YURlbHRhID0gMDtcclxuXHR2YXIgc2NhbGUgPSAxO1xyXG5cclxuXHR2YXIgbGFzdFBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcclxuXHJcblx0dmFyIFNUQVRFID0geyBOT05FOiAtMSwgUk9UQVRFOiAwLCBaT09NOiAxLCBQQU46IDIgfTtcclxuXHR2YXIgc3RhdGUgPSBTVEFURS5OT05FO1xyXG5cclxuXHQvLyBldmVudHNcclxuXHJcblx0dmFyIGNoYW5nZUV2ZW50ID0geyB0eXBlOiAnY2hhbmdlJyB9O1xyXG5cclxuXHJcblx0dGhpcy5yb3RhdGVMZWZ0ID0gZnVuY3Rpb24gKCBhbmdsZSApIHtcclxuXHJcblx0XHRpZiAoIGFuZ2xlID09PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0XHRhbmdsZSA9IGdldEF1dG9Sb3RhdGlvbkFuZ2xlKCk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHRoZXRhRGVsdGEgLT0gYW5nbGU7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMucm90YXRlUmlnaHQgPSBmdW5jdGlvbiAoIGFuZ2xlICkge1xyXG5cclxuXHRcdGlmICggYW5nbGUgPT09IHVuZGVmaW5lZCApIHtcclxuXHJcblx0XHRcdGFuZ2xlID0gZ2V0QXV0b1JvdGF0aW9uQW5nbGUoKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0dGhldGFEZWx0YSArPSBhbmdsZTtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5yb3RhdGVVcCA9IGZ1bmN0aW9uICggYW5nbGUgKSB7XHJcblxyXG5cdFx0aWYgKCBhbmdsZSA9PT0gdW5kZWZpbmVkICkge1xyXG5cclxuXHRcdFx0YW5nbGUgPSBnZXRBdXRvUm90YXRpb25BbmdsZSgpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHRwaGlEZWx0YSAtPSBhbmdsZTtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5yb3RhdGVEb3duID0gZnVuY3Rpb24gKCBhbmdsZSApIHtcclxuXHJcblx0XHRpZiAoIGFuZ2xlID09PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0XHRhbmdsZSA9IGdldEF1dG9Sb3RhdGlvbkFuZ2xlKCk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHBoaURlbHRhICs9IGFuZ2xlO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLnpvb21JbiA9IGZ1bmN0aW9uICggem9vbVNjYWxlICkge1xyXG5cclxuXHRcdGlmICggem9vbVNjYWxlID09PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0XHR6b29tU2NhbGUgPSBnZXRab29tU2NhbGUoKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0c2NhbGUgLz0gem9vbVNjYWxlO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLnpvb21PdXQgPSBmdW5jdGlvbiAoIHpvb21TY2FsZSApIHtcclxuXHJcblx0XHRpZiAoIHpvb21TY2FsZSA9PT0gdW5kZWZpbmVkICkge1xyXG5cclxuXHRcdFx0em9vbVNjYWxlID0gZ2V0Wm9vbVNjYWxlKCk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHNjYWxlICo9IHpvb21TY2FsZTtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5wYW4gPSBmdW5jdGlvbiAoIGRpc3RhbmNlICkge1xyXG5cclxuXHRcdGRpc3RhbmNlLnRyYW5zZm9ybURpcmVjdGlvbiggdGhpcy5vYmplY3QubWF0cml4ICk7XHJcblx0XHRkaXN0YW5jZS5tdWx0aXBseVNjYWxhciggc2NvcGUudXNlclBhblNwZWVkICk7XHJcblxyXG5cdFx0dGhpcy5vYmplY3QucG9zaXRpb24uYWRkKCBkaXN0YW5jZSApO1xyXG5cdFx0dGhpcy5jZW50ZXIuYWRkKCBkaXN0YW5jZSApO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHR2YXIgcG9zaXRpb24gPSB0aGlzLm9iamVjdC5wb3NpdGlvbjtcclxuXHRcdHZhciBvZmZzZXQgPSBwb3NpdGlvbi5jbG9uZSgpLnN1YiggdGhpcy5jZW50ZXIgKTtcclxuXHJcblx0XHQvLyBhbmdsZSBmcm9tIHotYXhpcyBhcm91bmQgeS1heGlzXHJcblxyXG5cdFx0dmFyIHRoZXRhID0gTWF0aC5hdGFuMiggb2Zmc2V0LngsIG9mZnNldC56ICk7XHJcblxyXG5cdFx0Ly8gYW5nbGUgZnJvbSB5LWF4aXNcclxuXHJcblx0XHR2YXIgcGhpID0gTWF0aC5hdGFuMiggTWF0aC5zcXJ0KCBvZmZzZXQueCAqIG9mZnNldC54ICsgb2Zmc2V0LnogKiBvZmZzZXQueiApLCBvZmZzZXQueSApO1xyXG5cclxuXHRcdGlmICggdGhpcy5hdXRvUm90YXRlICkge1xyXG5cclxuXHRcdFx0dGhpcy5yb3RhdGVMZWZ0KCBnZXRBdXRvUm90YXRpb25BbmdsZSgpICk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdGlmKCB0aGlzLm1vZGUgPT0gMiApIHtcclxuXHRcdFx0aWYoIHBoaURlbHRhIHx8IHRoZXRhRGVsdGEgKSB7XHJcblx0XHRcdFx0dGhpcy5vYmplY3QubWF0cml4LnJvdGF0ZVJlbGF0aXZlKCAtcGhpRGVsdGEsIHRoZXRhRGVsdGEsIDAgKTtcclxuXHRcdFx0XHR0aGlzLm9iamVjdC5tYXRyaXgucm90YXRlUmVsYXRpdmUoIDAsIDAsIC10aGlzLm9iamVjdC5tYXRyaXgucm9sbCApXHJcblx0XHRcdFx0dmFyIHRtcCA9IHRoaXMuY2VudGVyLmNsb25lKCkuYWRkU2NhbGVkVmVjdG9yKCB0aGlzLm9iamVjdC5tYXRyaXguYmFja3dhcmQsIG9mZnNldC5sZW5ndGgoKSAqKHNjYWxlKSApO1xyXG5cdFx0XHRcdHRoaXMub2JqZWN0Lm1hdHJpeC5vcmlnaW4uY29weSggdG1wICk7XHJcblx0XHRcdFx0dGhpcy5vYmplY3QubWF0cml4V29ybGROZWVkc1VwZGF0ZSA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoZXRhICs9IHRoZXRhRGVsdGE7XHJcblx0XHRcdHBoaSArPSBwaGlEZWx0YTtcclxuXHJcblx0XHRcdC8vIHJlc3RyaWN0IHBoaSB0byBiZSBiZXR3ZWVuIGRlc2lyZWQgbGltaXRzXHJcblx0XHRcdHBoaSA9IE1hdGgubWF4KCB0aGlzLm1pblBvbGFyQW5nbGUsIE1hdGgubWluKCB0aGlzLm1heFBvbGFyQW5nbGUsIHBoaSApICk7XHJcblxyXG5cdFx0XHQvLyByZXN0cmljdCBwaGkgdG8gYmUgYmV0d2VlIEVQUyBhbmQgUEktRVBTXHJcblx0XHRcdHBoaSA9IE1hdGgubWF4KCBFUFMsIE1hdGgubWluKCBNYXRoLlBJIC0gRVBTLCBwaGkgKSApO1xyXG5cclxuXHRcdFx0dmFyIHJhZGl1cyA9IG9mZnNldC5sZW5ndGgoKSAqIHNjYWxlO1xyXG5cclxuXHRcdFx0Ly8gcmVzdHJpY3QgcmFkaXVzIHRvIGJlIGJldHdlZW4gZGVzaXJlZCBsaW1pdHNcclxuXHRcdFx0cmFkaXVzID0gTWF0aC5tYXgoIHRoaXMubWluRGlzdGFuY2UsIE1hdGgubWluKCB0aGlzLm1heERpc3RhbmNlLCByYWRpdXMgKSApO1xyXG5cclxuXHRcdFx0b2Zmc2V0LnggPSByYWRpdXMgKiBNYXRoLnNpbiggcGhpICkgKiBNYXRoLnNpbiggdGhldGEgKTtcclxuXHRcdFx0b2Zmc2V0LnkgPSByYWRpdXMgKiBNYXRoLmNvcyggcGhpICk7XHJcblx0XHRcdG9mZnNldC56ID0gcmFkaXVzICogTWF0aC5zaW4oIHBoaSApICogTWF0aC5jb3MoIHRoZXRhICk7XHJcblxyXG5cdFx0XHRwb3NpdGlvbi5jb3B5KCB0aGlzLmNlbnRlciApLmFkZCggb2Zmc2V0ICk7XHJcblxyXG5cdCAgICAgICAgLy9jb25zb2xlLmxvZyggXCJ1cGRhdGUgbG9va0F0P1wiLCB0aGV0YURlbHRhLCBwaGlEZWx0YSlcclxuXHJcblx0XHRcdHRoaXMub2JqZWN0Lmxvb2tBdCggdGhpcy5jZW50ZXIgKTtcclxuXHJcblx0ICAgICAgICB0aGlzLm9iamVjdC5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdHRoZXRhRGVsdGEgPSAwO1xyXG5cdFx0cGhpRGVsdGEgPSAwO1xyXG5cdFx0c2NhbGUgPSAxO1xyXG5cclxuXHRcdGlmICggbGFzdFBvc2l0aW9uLmRpc3RhbmNlVG8oIHRoaXMub2JqZWN0LnBvc2l0aW9uICkgPiAwICkge1xyXG5cclxuXHRcdFx0dGhpcy5kaXNwYXRjaEV2ZW50KCBjaGFuZ2VFdmVudCApO1xyXG5cclxuXHRcdFx0bGFzdFBvc2l0aW9uLmNvcHkoIHRoaXMub2JqZWN0LnBvc2l0aW9uICk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9O1xyXG5cclxuXHJcblx0ZnVuY3Rpb24gZ2V0QXV0b1JvdGF0aW9uQW5nbGUoKSB7XHJcblxyXG5cdFx0cmV0dXJuIDIgKiBNYXRoLlBJIC8gNjAgLyA2MCAqIHNjb3BlLmF1dG9Sb3RhdGVTcGVlZDtcclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBnZXRab29tU2NhbGUoKSB7XHJcblxyXG5cdFx0cmV0dXJuIE1hdGgucG93KCAwLjk1LCBzY29wZS51c2VyWm9vbVNwZWVkICk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Nb3VzZURvd24oIGV2ZW50ICkge1xyXG5cclxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcblx0XHRpZiAoIHNjb3BlLnVzZXJSb3RhdGUgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cclxuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdFx0aWYgKCBzdGF0ZSA9PT0gU1RBVEUuTk9ORSApXHJcblx0XHR7XHJcblx0XHRcdGlmICggZXZlbnQuYnV0dG9uID09PSAwIClcclxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLlJPVEFURTtcclxuXHRcdFx0aWYgKCBldmVudC5idXR0b24gPT09IDEgKVxyXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuWk9PTTtcclxuXHRcdFx0aWYgKCBldmVudC5idXR0b24gPT09IDIgKVxyXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuUEFOO1xyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRpZiAoIHN0YXRlID09PSBTVEFURS5ST1RBVEUgKSB7XHJcblxyXG5cdFx0XHQvL3N0YXRlID0gU1RBVEUuUk9UQVRFO1xyXG5cclxuXHRcdFx0cm90YXRlU3RhcnQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XHJcblxyXG5cdFx0fSBlbHNlIGlmICggc3RhdGUgPT09IFNUQVRFLlpPT00gKSB7XHJcblxyXG5cdFx0XHQvL3N0YXRlID0gU1RBVEUuWk9PTTtcclxuXHJcblx0XHRcdHpvb21TdGFydC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcclxuXHJcblx0XHR9IGVsc2UgaWYgKCBzdGF0ZSA9PT0gU1RBVEUuUEFOICkge1xyXG5cclxuXHRcdFx0Ly9zdGF0ZSA9IFNUQVRFLlBBTjtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlLCBmYWxzZSApO1xyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbk1vdXNlVXAsIGZhbHNlICk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Nb3VzZU1vdmUoIGV2ZW50ICkge1xyXG5cclxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcblxyXG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcblxyXG5cclxuXHRcdGlmICggc3RhdGUgPT09IFNUQVRFLlJPVEFURSApIHtcclxuXHJcblx0XHRcdHJvdGF0ZUVuZC5zZXQoIGV2ZW50LmNsaWVudFgsIGV2ZW50LmNsaWVudFkgKTtcclxuXHRcdFx0cm90YXRlRGVsdGEuc3ViVmVjdG9ycyggcm90YXRlRW5kLCByb3RhdGVTdGFydCApO1xyXG5cclxuXHRcdFx0c2NvcGUucm90YXRlTGVmdCggMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS54IC8gUElYRUxTX1BFUl9ST1VORCAqIHNjb3BlLnVzZXJSb3RhdGVTcGVlZCApO1xyXG5cdFx0XHRzY29wZS5yb3RhdGVVcCggMiAqIE1hdGguUEkgKiByb3RhdGVEZWx0YS55IC8gUElYRUxTX1BFUl9ST1VORCAqIHNjb3BlLnVzZXJSb3RhdGVTcGVlZCApO1xyXG5cclxuXHRcdFx0cm90YXRlU3RhcnQuY29weSggcm90YXRlRW5kICk7XHJcblxyXG5cdFx0fSBlbHNlIGlmICggc3RhdGUgPT09IFNUQVRFLlpPT00gKSB7XHJcblxyXG5cdFx0XHR6b29tRW5kLnNldCggZXZlbnQuY2xpZW50WCwgZXZlbnQuY2xpZW50WSApO1xyXG5cdFx0XHR6b29tRGVsdGEuc3ViVmVjdG9ycyggem9vbUVuZCwgem9vbVN0YXJ0ICk7XHJcblxyXG5cdFx0XHRpZiAoIHpvb21EZWx0YS55ID4gMCApIHtcclxuXHJcblx0XHRcdFx0c2NvcGUuem9vbUluKCk7XHJcblxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0XHRzY29wZS56b29tT3V0KCk7XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR6b29tU3RhcnQuY29weSggem9vbUVuZCApO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAoIHN0YXRlID09PSBTVEFURS5QQU4gKSB7XHJcblxyXG5cdFx0XHR2YXIgbW92ZW1lbnRYID0gZXZlbnQubW92ZW1lbnRYIHx8IGV2ZW50Lm1vek1vdmVtZW50WCB8fCBldmVudC53ZWJraXRNb3ZlbWVudFggfHwgMDtcclxuXHRcdFx0dmFyIG1vdmVtZW50WSA9IGV2ZW50Lm1vdmVtZW50WSB8fCBldmVudC5tb3pNb3ZlbWVudFkgfHwgZXZlbnQud2Via2l0TW92ZW1lbnRZIHx8IDA7XHJcblxyXG5cdFx0XHRzY29wZS5wYW4oIG5ldyBUSFJFRS5WZWN0b3IzKCAtIG1vdmVtZW50WCwgbW92ZW1lbnRZLCAwICkgKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Nb3VzZVVwKCBldmVudCApIHtcclxuXHJcblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cdFx0aWYgKCBzY29wZS51c2VyUm90YXRlID09PSBmYWxzZSApIHJldHVybjtcclxuXHJcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XHJcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V1cCcsIG9uTW91c2VVcCwgZmFsc2UgKTtcclxuXHJcblx0XHRzdGF0ZSA9IFNUQVRFLk5PTkU7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Nb3VzZVdoZWVsKCBldmVudCApIHtcclxuXHJcblx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cdFx0aWYgKCBzY29wZS51c2VyWm9vbSA9PT0gZmFsc2UgKSByZXR1cm47XHJcblxyXG5cdFx0dmFyIGRlbHRhID0gMDtcclxuXHJcblx0XHRpZiAoIGV2ZW50LndoZWVsRGVsdGEgKSB7IC8vIFdlYktpdCAvIE9wZXJhIC8gRXhwbG9yZXIgOVxyXG5cclxuXHRcdFx0ZGVsdGEgPSBldmVudC53aGVlbERlbHRhO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAoIGV2ZW50LmRldGFpbCApIHsgLy8gRmlyZWZveFxyXG5cclxuXHRcdFx0ZGVsdGEgPSAtIGV2ZW50LmRldGFpbDtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCBkZWx0YSA+IDAgKSB7XHJcblxyXG5cdFx0XHRzY29wZS56b29tT3V0KCk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdHNjb3BlLnpvb21JbigpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBvbktleURvd24oIGV2ZW50ICkge1xyXG5cclxuXHRcdGlmICggc2NvcGUuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcblx0XHRpZiAoIHNjb3BlLnVzZXJQYW4gPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cclxuXHRcdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XHJcblxyXG5cdFx0XHQvKmNhc2Ugc2NvcGUua2V5cy5VUDpcclxuXHRcdFx0XHRzY29wZS5wYW4oIG5ldyBUSFJFRS5WZWN0b3IzKCAwLCAxLCAwICkgKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLkJPVFRPTTpcclxuXHRcdFx0XHRzY29wZS5wYW4oIG5ldyBUSFJFRS5WZWN0b3IzKCAwLCAtIDEsIDAgKSApO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuTEVGVDpcclxuXHRcdFx0XHRzY29wZS5wYW4oIG5ldyBUSFJFRS5WZWN0b3IzKCAtIDEsIDAsIDAgKSApO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuUklHSFQ6XHJcblx0XHRcdFx0c2NvcGUucGFuKCBuZXcgVEhSRUUuVmVjdG9yMyggMSwgMCwgMCApICk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdCovXHJcblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5ST1RBVEU6XHJcblx0XHRcdFx0c3RhdGUgPSBTVEFURS5ST1RBVEU7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5aT09NOlxyXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuWk9PTTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSBzY29wZS5rZXlzLlBBTjpcclxuXHRcdFx0XHRzdGF0ZSA9IFNUQVRFLlBBTjtcclxuXHRcdFx0XHRicmVhaztcclxuXHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25LZXlVcCggZXZlbnQgKSB7XHJcblxyXG5cdFx0c3dpdGNoICggZXZlbnQua2V5Q29kZSApIHtcclxuXHJcblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5ST1RBVEU6XHJcblx0XHRcdGNhc2Ugc2NvcGUua2V5cy5aT09NOlxyXG5cdFx0XHRjYXNlIHNjb3BlLmtleXMuUEFOOlxyXG5cdFx0XHRcdHN0YXRlID0gU1RBVEUuTk9ORTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHR2YXIgb25nb2luZ1RvdWNoZXMgPSBbXTtcclxuXHJcblx0ZnVuY3Rpb24gY29weVRvdWNoKHRvdWNoKSB7XHJcblx0ICByZXR1cm4geyBpZGVudGlmaWVyOiB0b3VjaC5pZGVudGlmaWVyLCBwYWdlWDogdG91Y2gucGFnZVgsIHBhZ2VZOiB0b3VjaC5wYWdlWSB9O1xyXG5cdH1cclxuXHRmdW5jdGlvbiBvbmdvaW5nVG91Y2hJbmRleEJ5SWQoaWRUb0ZpbmQpIHtcclxuXHQgIGZvciAodmFyIGkgPSAwOyBpIDwgb25nb2luZ1RvdWNoZXMubGVuZ3RoOyBpKyspIHtcclxuXHQgICAgdmFyIGlkID0gb25nb2luZ1RvdWNoZXNbaV0uaWRlbnRpZmllcjtcclxuXHJcblx0ICAgIGlmIChpZCA9PSBpZFRvRmluZCkge1xyXG5cdCAgICAgIHJldHVybiBpO1xyXG5cdCAgICB9XHJcblx0ICB9XHJcblx0ICByZXR1cm4gLTE7ICAgIC8vIG5vdCBmb3VuZFxyXG5cdH1cclxuXHRmdW5jdGlvbiBvblRvdWNoRG93bihldmVudCkge1xyXG5cdCAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHQgIHZhciB0b3VjaGVzID0gZXZlbnQuY2hhbmdlZFRvdWNoZXM7XHJcblx0ICBmb3IoIHZhciBpID0gMDsgaSA8IHRvdWNoZXMubGVuZ3RoOyBpKysgKSB7XHJcblxyXG5cdFx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cdFx0XHRpZiAoIHNjb3BlLnVzZXJSb3RhdGUgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cclxuXHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcblx0XHRcdGlmICggc3RhdGUgPT09IFNUQVRFLk5PTkUgKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0aWYgKCBldmVudC5idXR0b24gPT09IDAgKVxyXG5cdFx0XHRcdFx0c3RhdGUgPSBTVEFURS5ST1RBVEU7XHJcblx0XHRcdFx0aWYgKCBldmVudC5idXR0b24gPT09IDEgKVxyXG5cdFx0XHRcdFx0c3RhdGUgPSBTVEFURS5aT09NO1xyXG5cdFx0XHRcdGlmICggZXZlbnQuYnV0dG9uID09PSAyIClcclxuXHRcdFx0XHRcdHN0YXRlID0gU1RBVEUuUEFOO1xyXG5cdFx0XHR9XHJcblxyXG5cclxuXHRcdFx0aWYgKCBzdGF0ZSA9PT0gU1RBVEUuUk9UQVRFICkge1xyXG5cdFx0XHRcdHJvdGF0ZVN0YXJ0LnNldCggdG91Y2hlc1swXS5wYWdlWCwgdG91Y2hlc1swXS5wYWdlWSApO1xyXG5cdFx0XHR9IGVsc2UgaWYgKCBzdGF0ZSA9PT0gU1RBVEUuWk9PTSApIHtcclxuXHRcdFx0XHQvL3N0YXRlID0gU1RBVEUuWk9PTTtcclxuXHRcdFx0XHR6b29tU3RhcnQuc2V0KCB0b3VjaGVzWzBdLnBhZ2VYLCB0b3VjaGVzWzBdLnBhZ2VZICk7XHJcblx0XHRcdH0gZWxzZSBpZiAoIHN0YXRlID09PSBTVEFURS5QQU4gKSB7XHJcblx0XHRcdFx0Ly9zdGF0ZSA9IFNUQVRFLlBBTjtcclxuXHRcdFx0fVxyXG5cclxuXHJcblx0ICAgIGNvbnNvbGUubG9nKCBgdG91Y2ggJHtpfT0ke3RvdWNoZXNbaV19YCk7XHJcblx0ICAgIG9uZ29pbmdUb3VjaGVzLnB1c2goIGNvcHlUb3VjaCggdG91Y2hlc1tpXSApICk7XHJcblxyXG5cdCAgfVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Ub3VjaFVwKGV2ZW50KSB7XHJcblx0ICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0dmFyIHRvdWNoZXMgPSBldmVudC5jaGFuZ2VkVG91Y2hlcztcclxuXHQgIGZvciggdmFyIGkgPSAwOyBpIDwgdG91Y2hlcy5sZW5ndGg7IGkrKyApIHtcclxuXHQgICAgdmFyIGlkeCA9IG9uZ29pbmdUb3VjaEluZGV4QnlJZCh0b3VjaGVzW2ldLmlkZW50aWZpZXIpO1xyXG5cdCAgICBpZiggaWR4ID49IDAgKSB7XHJcblx0XHRcdFx0b25nb2luZ1RvdWNoZXMuc3BsaWNlKGlkeCwgMSk7ICAvLyByZW1vdmUgaXQ7IHdlJ3JlIGRvbmVcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gb25Ub3VjaE1vdmUoZXZlbnQpIHtcclxuXHQgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblx0ICB2YXIgdG91Y2hlcyA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzO1xyXG5cdCAgZm9yKCB2YXIgaSA9IDA7IGkgPCB0b3VjaGVzLmxlbmd0aDsgaSsrICkge1xyXG5cdCAgICB2YXIgaWR4ID0gb25nb2luZ1RvdWNoSW5kZXhCeUlkKHRvdWNoZXNbaV0uaWRlbnRpZmllcik7XHJcblx0XHRcdGNvbnNvbGUubG9nKCBgZ290IHRvdWNoICR7aWR4fWAgKTtcclxuXHQgICAgaWYoIGlkeCA+PSAwICkge1xyXG5cclxuXHRcdFx0XHRpZiAoIHNjb3BlLmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG5cclxuXHRcdFx0XHRpZiAoIHN0YXRlID09PSBTVEFURS5ST1RBVEUgKSB7XHJcblxyXG5cdFx0XHRcdFx0cm90YXRlRW5kLnNldCggdG91Y2hlc1tpXS5wYWdlWCwgdG91Y2hlc1tpXS5wYWdlWSApO1xyXG5cdFx0XHRcdFx0cm90YXRlRGVsdGEuc3ViVmVjdG9ycyggcm90YXRlRW5kLCByb3RhdGVTdGFydCApO1xyXG5cclxuXHRcdFx0XHRcdHNjb3BlLnJvdGF0ZUxlZnQoIDIgKiBNYXRoLlBJICogcm90YXRlRGVsdGEueCAvIFBJWEVMU19QRVJfUk9VTkQgKiBzY29wZS51c2VyUm90YXRlU3BlZWQgKTtcclxuXHRcdFx0XHRcdHNjb3BlLnJvdGF0ZVVwKCAyICogTWF0aC5QSSAqIHJvdGF0ZURlbHRhLnkgLyBQSVhFTFNfUEVSX1JPVU5EICogc2NvcGUudXNlclJvdGF0ZVNwZWVkICk7XHJcblxyXG5cdFx0XHRcdFx0cm90YXRlU3RhcnQuY29weSggcm90YXRlRW5kICk7XHJcblxyXG5cdFx0XHRcdH0gZWxzZSBpZiAoIHN0YXRlID09PSBTVEFURS5aT09NICkge1xyXG5cclxuXHRcdFx0XHRcdHpvb21FbmQuc2V0KCBldmVudC5jbGllbnRYLCBldmVudC5jbGllbnRZICk7XHJcblx0XHRcdFx0XHR6b29tRGVsdGEuc3ViVmVjdG9ycyggem9vbUVuZCwgem9vbVN0YXJ0ICk7XHJcblxyXG5cdFx0XHRcdFx0aWYgKCB6b29tRGVsdGEueSA+IDAgKSB7XHJcblxyXG5cdFx0XHRcdFx0XHRzY29wZS56b29tSW4oKTtcclxuXHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0XHRcdFx0c2NvcGUuem9vbU91dCgpO1xyXG5cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHR6b29tU3RhcnQuY29weSggem9vbUVuZCApO1xyXG5cclxuXHRcdFx0XHR9IGVsc2UgaWYgKCBzdGF0ZSA9PT0gU1RBVEUuUEFOICkge1xyXG5cclxuXHRcdFx0XHRcdHZhciBtb3ZlbWVudFggPSBldmVudC5tb3ZlbWVudFggfHwgZXZlbnQubW96TW92ZW1lbnRYIHx8IGV2ZW50LndlYmtpdE1vdmVtZW50WCB8fCAwO1xyXG5cdFx0XHRcdFx0dmFyIG1vdmVtZW50WSA9IGV2ZW50Lm1vdmVtZW50WSB8fCBldmVudC5tb3pNb3ZlbWVudFkgfHwgZXZlbnQud2Via2l0TW92ZW1lbnRZIHx8IDA7XHJcblxyXG5cdFx0XHRcdFx0c2NvcGUucGFuKCBuZXcgVEhSRUUuVmVjdG9yMyggLSBtb3ZlbWVudFgsIG1vdmVtZW50WSwgMCApICk7XHJcblxyXG5cdFx0XHRcdH1cclxuXHJcblxyXG5cclxuXHRcdFx0XHRvbmdvaW5nVG91Y2hlc1tpZHhdLnBhZ2VYID0gdG91Y2hlc1tpXS5wYWdlWDtcclxuXHRcdFx0XHRvbmdvaW5nVG91Y2hlc1tpZHhdLnBhZ2VZID0gdG91Y2hlc1tpXS5wYWdlWTtcclxuXHQgICAgICAvL29uZ29pbmdUb3VjaGVzLnNwbGljZSggaWR4LCAxLCBjb3B5VG91Y2goIHRvdWNoZXNbaV0gKSApO1xyXG5cdCAgICB9XHJcblx0ICB9XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBvblRvdWNoQ2FuY2VsKGV2ZW50KSB7XHJcblx0ICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0ICBjb25zb2xlLmxvZyhcInRvdWNoY2FuY2VsLlwiKTtcclxuXHRcdCAgdmFyIHRvdWNoZXMgPSBldmVudC5jaGFuZ2VkVG91Y2hlcztcclxuXHJcblx0XHQgIGZvciAodmFyIGkgPSAwOyBpIDwgdG91Y2hlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciBpZHggPSBvbmdvaW5nVG91Y2hJbmRleEJ5SWQodG91Y2hlc1tpXS5pZGVudGlmaWVyKTtcclxuXHRcdCAgICBpZiggaWR4ID49IDAgKSB7XHJcblx0XHQgICAgXHRvbmdvaW5nVG91Y2hlcy5zcGxpY2UoaSwgMSk7ICAvLyByZW1vdmUgaXQ7IHdlJ3JlIGRvbmVcclxuXHRcdFx0XHR9XHJcblx0XHQgIH1cclxuXHRcdH1cclxuXHJcblxyXG5cclxuXHJcbiAgICBmdW5jdGlvbiBpZ25vcmUoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5kaXNhYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICBcdHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2NvbnRleHRtZW51JywgaWdub3JlLCBmYWxzZSApO1xyXG5cdFx0XHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaHN0YXJ0Jywgb25Ub3VjaERvd24sIGZhbHNlICk7XHJcblx0ICAgIHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNoZW5kJywgb25Ub3VjaFVwLCBmYWxzZSApO1xyXG5cdCAgICBzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd0b3VjaGNhbmNlbCcsIG9uVG91Y2hDYW5jZWwsIGZhbHNlICk7XHJcblx0ICAgIHNjb3BlLmRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ3RvdWNobW92ZScsIG9uVG91Y2hNb3ZlLCBmYWxzZSApO1xyXG4gICAgXHRzY29wZS5kb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdtb3VzZWRvd24nLCBvbk1vdXNlRG93biwgZmFsc2UgKTtcclxuICAgIFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2V3aGVlbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTtcclxuICAgIFx0c2NvcGUuZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnRE9NTW91c2VTY3JvbGwnLCBvbk1vdXNlV2hlZWwsIGZhbHNlICk7IC8vIGZpcmVmb3hcclxuICAgIFx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdrZXlkb3duJywgb25LZXlEb3duLCBmYWxzZSApO1xyXG4gICAgXHR3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2tleXVwJywgb25LZXlVcCwgZmFsc2UgKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmVuYWJsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgXHRzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIGlnbm9yZSwgZmFsc2UgKTtcclxuXHRcdFx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2hzdGFydCcsIG9uVG91Y2hEb3duLCBmYWxzZSApO1xyXG5cdCAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaGVuZCcsIG9uVG91Y2hVcCwgZmFsc2UgKTtcclxuXHQgICAgc2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAndG91Y2hjYW5jZWwnLCBvblRvdWNoQ2FuY2VsLCBmYWxzZSApO1xyXG5cdCAgICBzY29wZS5kb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICd0b3VjaG1vdmUnLCBvblRvdWNoTW92ZSwgZmFsc2UgKTtcclxuICAgIFx0c2NvcGUuZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgb25Nb3VzZURvd24sIGZhbHNlICk7XHJcbiAgICBcdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNld2hlZWwnLCBvbk1vdXNlV2hlZWwsIGZhbHNlICk7XHJcbiAgICBcdHNjb3BlLmRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ0RPTU1vdXNlU2Nyb2xsJywgb25Nb3VzZVdoZWVsLCBmYWxzZSApOyAvLyBmaXJlZm94XHJcbiAgICBcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIG9uS2V5RG93biwgZmFsc2UgKTtcclxuICAgIFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdrZXl1cCcsIG9uS2V5VXAsIGZhbHNlICk7XHJcblx0XHRcdFZveGVsYXJpdW0uY2FtZXJhLm1hdHJpeEF1dG9VcGRhdGUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIHRoaXMuZW5hYmxlKCk7XHJcblxyXG59O1xyXG5cclxuVEhSRUUuT3JiaXRDb250cm9scy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBUSFJFRS5FdmVudERpc3BhdGNoZXIucHJvdG90eXBlICk7XHJcbiIsIlxyXG5cclxudmFyIGJpdF9tYXNrcyA9IFtdO1xyXG5mb3IoIHZhciBtYXNrID0gMCwgbiA9IDA7IG4gPD0gMzI7IG4rKyApXHJcbntcclxuICAgIGJpdF9tYXNrc1tuXSA9IG1hc2s7XHJcbiAgICBtYXNrID0gKCBtYXNrIDw8IDEgKSB8IDE7XHJcbn1cclxuXHJcblxyXG5Wb3hlbGFyaXVtLkJpdFN0cmVhbSA9IGZ1bmN0aW9uKCBiYXNlX2J1ZmZlciApXHJcbntcclxuICAgIHZhciBzdHJlYW0gPVxyXG5cdHtcclxuXHRcdHN0b3JhZ2UgOiBiYXNlX2J1ZmZlciB8fCBuZXcgQXJyYXlCdWZmZXIoNTEyIC8qYXZhaWxhYmxlKi8pLFxyXG5cdFx0YXZhaWxhYmxlIDogKCBiYXNlX2J1ZmZlciAmJiBiYXNlX2J1ZmZlci5ieXRlTGVuZ3RoICkgfHwgNTEyLFxyXG4gICAgICAgIHVzZWQgOiAwLFxyXG5cdFx0dXNlZF9iaXRzIDogMCxcclxuXHJcblx0XHRnZXRCeXRlcyA6IGZ1bmN0aW9uKCAgKSB7XHJcblx0XHRcdHJldHVybiB7IGRhdGEgOiBzdHJlYW0uc3RvcmFnZSwgYnl0ZXNfdXNlZCA6IHN0cmVhbS51c2VkICsgMSB9O1xyXG5cdFx0fSxcclxuXHJcblx0XHRleHBhbmQgOiBmdW5jdGlvbigpXHJcblx0XHR7XHJcblx0XHRcdHZhciBuZXdfc2l6ZSA9IHN0cmVhbS5hdmFpbGFibGUgKiAyO1xyXG5cdFx0XHR2YXIgbmV3X3N0b3JhZ2UgPSBuZXcgQXJyYXlCdWZmZXIobmV3X3NpemUpO1xyXG4gICAgICAgICAgICBmb3IoIHZhciBuID0gMDsgbiA8IHN0cmVhbS5hdmFpbGFibGU7IG4rKyApXHJcbiAgICAgICAgICAgICAgICBuZXdfc3RvcmFnZVtuXSA9IHN0cmVhbS5zdG9yYWdlW25dO1xyXG5cdFx0XHRzdHJlYW0uc3RvcmFnZSA9IG5ld19zdG9yYWdlO1xyXG5cdFx0XHRzdHJlYW0uYXZhaWxhYmxlID0gbmV3X3NpemU7XHJcblxyXG5cdFx0fSxcclxuXHJcblx0XHRzZWVrIDogZnVuY3Rpb24oIHBvc2l0aW9uIClcclxuXHRcdHtcclxuXHRcdFx0aWYoIChwb3NpdGlvbiA+PiAzKSA+PSBzdHJlYW0uYXZhaWxhYmxlIClcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiYXR0ZW1wdCB0byBzZWVrIGJleW9uZCBlbmQgb2YgZGF0YVwiICk7XHJcblxyXG5cdFx0XHRzdHJlYW0udXNlZCA9IHBvc2l0aW9uID4+IDM7XHJcblx0XHRcdHN0cmVhbS51c2VkX2JpdHMgPSBwb3NpdGlvbiAmIDB4NztcclxuXHRcdH0sXHJcblxyXG5cdFx0d3JpdGUgOiBmdW5jdGlvbiggdmFsdWUsIGJpdHMgKVxyXG5cdFx0e1xyXG5cdFx0XHRpZiggYml0cyA+IDY0IClcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiQXR0ZW1wdCB0byB3cml0ZSBtb3JlIGJpdHMgdGhhbiBkYXRhIHBhc3NlZFwiICk7XHJcblx0XHRcdHZhciB0bXA7XHJcblx0XHRcdGlmKCBzdHJlYW0udXNlZCA9PSBzdHJlYW0uYXZhaWxhYmxlICkgRXhwYW5kKCk7XHJcblx0XHRcdHRtcCA9IHN0cmVhbS5zdG9yYWdlW3N0cmVhbS51c2VkXSB8fCAwO1xyXG5cdFx0XHR0bXAgfD0gKHZhbHVlIDw8IHN0cmVhbS51c2VkX2JpdHMpJjB4RkY7XHJcblx0XHRcdHN0cmVhbS5zdG9yYWdlW3N0cmVhbS51c2VkXSA9IHRtcDtcclxuXHRcdFx0dmFyIGJpdF9jb3VudGVyID0gOCAtIHN0cmVhbS51c2VkX2JpdHM7XHJcblx0XHRcdHN0cmVhbS51c2VkX2JpdHMgKz0gYml0cztcclxuXHRcdFx0d2hpbGUoIHN0cmVhbS51c2VkX2JpdHMgPj0gOCApXHJcblx0XHRcdHtcclxuXHRcdFx0XHRzdHJlYW0udXNlZF9iaXRzIC09IDg7XHJcblx0XHRcdFx0c3RyZWFtLnVzZWQrKztcclxuXHRcdFx0XHRpZiggc3RyZWFtLnVzZWQgPT0gc3RyZWFtLmF2YWlsYWJsZSApIHN0cmVhbS5leHBhbmQoKTtcclxuXHRcdFx0XHRpZiggc3RyZWFtLnVzZWRfYml0cyA+IDAgKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHRtcCA9IDA7XHJcblx0XHRcdFx0XHRzdHJlYW0uc3RvcmFnZVtzdHJlYW0udXNlZF0gPSAoIHZhbHVlID4+ICggYml0X2NvdW50ZXIgKSApICYgMHhGRjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblxyXG5cclxuXHRcdHJlYWQgOiBmdW5jdGlvbiggYml0cyApXHJcblx0XHR7XHJcblx0XHRcdGlmKCBiaXRzID4gNjQgKVxyXG5cdFx0XHRcdHRocm93IG5ldyBlcnJvciggXCJBdHRlbXB0IHRvIHJlYWQgbW9yZSBiaXRzIHRoYW4gZGF0YSBwYXNzZWRcIiApO1xyXG5cdFx0XHR2YXIgdG1wO1xyXG5cdFx0XHQvL2lmKCBzdHJlYW0udXNlZCA9PSBzdHJlYW0uYXZhaWxhYmxlIClcclxuXHRcdFx0Ly9cdHRocm93IG5ldyBFcnJvciggXCJObyBtb3JlIGRhdGFcIiApO1xyXG5cdFx0XHR0bXAgPSBzdHJlYW0uc3RvcmFnZVtzdHJlYW0udXNlZF07XHJcblx0XHRcdHZhciByZXN1bHQgPSAoIHRtcCA+PiBzdHJlYW0udXNlZF9iaXRzICk7XHJcblx0XHRcdHZhciBiaXRfY291bnRlciA9IDggLSBzdHJlYW0udXNlZF9iaXRzO1xyXG5cdFx0XHRzdHJlYW0udXNlZF9iaXRzICs9IGJpdHM7XHJcblx0XHRcdHdoaWxlKCBzdHJlYW0udXNlZF9iaXRzID49IDggKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0c3RyZWFtLnVzZWRfYml0cyAtPSA4O1xyXG5cdFx0XHRcdHN0cmVhbS51c2VkKys7XHJcblx0XHRcdFx0aWYoIHN0cmVhbS51c2VkX2JpdHMgPiAwIClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR0bXAgPSBzdHJlYW0uc3RvcmFnZVtzdHJlYW0udXNlZF07XHJcblx0XHRcdFx0XHRyZXN1bHQgfD0gKCB0bXAgPDwgKCBiaXRfY291bnRlciApICkgJiAweEZGO1xyXG5cdFx0XHRcdFx0c3RyZWFtLmJpdF9jb3VudGVyICs9IDg7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHJlc3VsdCAmPSBiaXRfbWFza3NbYml0c107XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcblx0XHR9XHJcblx0fVxyXG4gICAgcmV0dXJuIHN0cmVhbTtcclxufVxyXG5cclxuXHJcblxyXG5Wb3hlbGFyaXVtLkJpdFN0cmVhbS5HZXRNaW5CaXRzTmVlZGVkRm9yVmFsdWUgPSBmdW5jdGlvbiggdmFsdWUgKVxyXG57XHJcbiAgICB2YXIgbjtcclxuICAgZm9yKCBuID0gMTsgbiA8PSAzMjsgbisrICkge1xyXG4gICAgICAgaWYoICggKCB2YWx1ZSAmIGJpdF9tYXNrc1tuXSApIF4gdmFsdWUgKSA9PSAwIClcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgIH1cclxuICAgcmV0dXJuIG47XHJcbn1cclxuIiwiXHJcbnJlcXVpcmUoIFwiLi9jb25zdGFudHMuanNcIik7XHJcbnJlcXVpcmUoIFwiLi9yZWFjdG9yLmpzXCIgKTtcclxuXHJcblZveGVsYXJpdW0uQ2x1c3RlciA9IGZ1bmN0aW9uKCB4LCB5LCB6LCBwcm9wcyApIHtcclxuICAgIHZhciBjbHVzdGVyID0ge1xyXG4gICAgICAgIG1lc2hlciA6IG51bGwsXHJcbiAgICAgICAgV29ya2luZ0Z1bGxTZWN0b3IgOiBudWxsLFxyXG4gICAgICAgIFdvcmtpbmdFbXB0eVNlY3RvcjogbnVsbCxcclxuXHJcbiAgICAgICAgU2VjdG9yTGlzdCA6IFtdLFxyXG5cclxuICAgICAgICBzZWN0b3JTaXplWCA6IHggfHwgMzIsXHJcbiAgICAgICAgc2VjdG9yU2l6ZVkgOiB5IHx8IDMyLFxyXG4gICAgICAgIHNlY3RvclNpemVaIDogeiB8fCAzMixcclxuICAgICAgICBzZWN0b3JTaXplIDogMCwgLy8gZmlsbGVkIGluIGxhdGVyXHJcblxyXG4gICAgICAgIHZveGVsVW5pdFNpemUgOiBwcm9wcyAmJiBwcm9wcy51bml0U2l6ZSB8fCAyMCxcclxuXHJcbiAgICAgICAgc2VjdG9ySGFzaFNpemVfeCA6IDgsXHJcbiAgICAgICAgc2VjdG9ySGFzaFNpemVfeSA6IDgsXHJcbiAgICAgICAgc2VjdG9ySGFzaFNpemVfeiA6IDgsXHJcbiAgICAgICAgVGFibGVTaXplIDogMCwvL1NlY3Rvckhhc2hTaXplX3ggKiBTZWN0b3JIYXNoU2l6ZV95ICogU2VjdG9ySGFzaFNpemVfeixcclxuICAgICAgICBTZWN0b3JUYWJsZSA6IG5ldyBBcnJheSggOCo4KjggKSxcclxuXHJcbiAgICAgICAgcGl2b3QgOiBuZXcgVEhSRUUuVmVjdG9yMygpLFxyXG4gICAgICAgIGxvY2F0aW9uIDogbmV3IFRIUkVFLk1hdHJpeDQoKSxcclxuICAgICAgICBVbml2ZXJzZU51bSA6IDAsXHJcbiAgICAgICAgbG9va3VwVGFibGVzIDogbnVsbFxyXG4gICAgICAgICxjcmVhdGVTZWN0b3IgOiBmdW5jdGlvbiggeCwgeSwgeiApIHtcclxuICAgICAgICAgICAgdmFyIHNlY3RvciA9IFZveGVsYXJpdW0uU2VjdG9yKCB0aGlzLCB4LCB5LCB6ICk7XHJcbiAgICAgICAgICAgIHRoaXMuU2VjdG9yTGlzdC5wdXNoKCBzZWN0b3IgKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBoYXNoT2ZzO1xyXG4gICAgICAgICAgICBzZWN0b3IubmV4dCA9IHRoaXMuU2VjdG9yVGFibGVbIGhhc2hPZnMgPSAoIHggJSB0aGlzLnNlY3Rvckhhc2hTaXplX3hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICggeSAlIHRoaXMuc2VjdG9ySGFzaFNpemVfeSApICogKCB0aGlzLnNlY3Rvckhhc2hTaXplX3ggKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKCB6ICUgdGhpcy5zZWN0b3JIYXNoU2l6ZV96ICkgKiAodGhpcy5zZWN0b3JIYXNoU2l6ZV95KnRoaXMuc2VjdG9ySGFzaFNpemVfeCkgKSBdO1xyXG4gICAgICAgICAgICBpZiggc2VjdG9yLm5leHQgKVxyXG4gICAgICAgICAgICAgICAgc2VjdG9yLm5leHQucHJlZCA9IHNlY3RvcjtcclxuICAgICAgICAgICAgdGhpcy5TZWN0b3JUYWJsZVtoYXNoT2ZzXSA9IHNlY3RvcjtcclxuXHJcblx0XHRcdHZhciBuO1xyXG5cdFx0XHRmb3IoIG4gPSAwOyBuIDwgNjsgbisrIClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBuZWFyX3NlYyA9IHRoaXMuZ2V0U2VjdG9yKCB4ICsgVm94ZWxhcml1bS5Ob3JtYWxCYXNlUG9zaXRpb25bbl0ueFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICwgeSArIFZveGVsYXJpdW0uTm9ybWFsQmFzZVBvc2l0aW9uW25dLnlcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ICAsIHogKyBWb3hlbGFyaXVtLk5vcm1hbEJhc2VQb3NpdGlvbltuXS56XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCB0cnVlICk7XHJcblx0XHRcdFx0aWYoIG5lYXJfc2VjICE9IG51bGwgKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHNlY3Rvci5uZWFyX3NlY3RvcnNbbl0gPSBuZWFyX3NlYztcclxuXHRcdFx0XHRcdG5lYXJfc2VjLm5lYXJfc2VjdG9yc1tuIF4gMV0gPSBzZWN0b3I7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcbiAgICAgICAgICAgIHJldHVybiBzZWN0b3I7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAsZ2V0Vm94ZWxSZWYgOiBmdW5jdGlvbiggaXMzZFNwYWNlQ29vcmRzLCB4LCB5LCB6ICkge1xyXG4gICAgICAgICAgICBpZiggaXMzZFNwYWNlQ29vcmRzICkge1xyXG4gICAgICAgICAgICAgIHggPSBNYXRoLmZsb29yKCB4IC8gdGhpcy52b3hlbFVuaXRTaXplICk7XHJcbiAgICAgICAgICAgICAgeSA9IE1hdGguZmxvb3IoIHkgLyB0aGlzLnZveGVsVW5pdFNpemUgKTtcclxuICAgICAgICAgICAgICB6ID0gTWF0aC5mbG9vciggeiAvIHRoaXMudm94ZWxVbml0U2l6ZSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBzeCA9IE1hdGguZmxvb3IoIHggLyB0aGlzLnNlY3RvclNpemVYICk7XHJcbiAgICAgICAgICAgIHZhciBzeSA9IE1hdGguZmxvb3IoIHkgLyB0aGlzLnNlY3RvclNpemVZICk7XHJcbiAgICAgICAgICAgIHZhciBzeiA9IE1hdGguZmxvb3IoIHogLyB0aGlzLnNlY3RvclNpemVaICk7XHJcbiAgICAgICAgICAgIC8vaWYoICFpczNkU3BhY2VDb29yZHMpIHtcclxuICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCBgR2V0ICR7c3h9ICR7c3l9ICR7c3p9YClcclxuICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgIHZhciBzZWN0b3IgPSBjbHVzdGVyLmdldFNlY3Rvciggc3gsIHN5LCBzeiwgdHJ1ZSApO1xyXG4gICAgICAgICAgICBpZiggc2VjdG9yICkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlY3Rvci5nZXRWb3hlbFJlZiggeCAlIHRoaXMuc2VjdG9yU2l6ZVgsIHkgJSB0aGlzLnNlY3RvclNpemVZLCB6ICUgdGhpcy5zZWN0b3JTaXplWik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBwYXNzIHdvcmxkIGNvb3JkaW5hdGVzLCBzaW5jZSB0aGVyZSdzIG5vIHNlY3RvciB0byBnaXZlIGEgYmFzZSBwb3NpdGlvblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFZveGVsYXJpdW0uVm94ZWxSZWYoIGNsdXN0ZXIsIG51bGwsIHgsIHksIHogKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLCBzZXRDdWJlIDogZnVuY3Rpb24oIHgsIHksIHosIGN1YmUgKXtcclxuICAgICAgICAgICAgdmFyIHN4ID0geCAvIHRoaXMuc2VjdG9yU2l6ZVg7XHJcbiAgICAgICAgICAgIHZhciBzeSA9IHkgLyB0aGlzLnNlY3RvclNpemVZO1xyXG4gICAgICAgICAgICB2YXIgc3ogPSB6IC8gdGhpcy5zZWN0b3JTaXplWjtcclxuICAgICAgICAgICAgdmFyIHN1YnggPSAoIHN4ICUgMSApICogdGhpcy5zZWN0b3JTaXplWDtcclxuICAgICAgICAgICAgdmFyIHN1YnkgPSAoIHN5ICUgMSApICogdGhpcy5zZWN0b3JTaXplWTtcclxuICAgICAgICAgICAgdmFyIHN1YnogPSAoIHN6ICUgMSApICogdGhpcy5zZWN0b3JTaXplWjtcclxuICAgICAgICAgICAgdmFyIHd4ID0gTWF0aC5mbG9vciggc3ggKTtcclxuICAgICAgICAgICAgdmFyIHd5ID0gTWF0aC5mbG9vciggc3kgKTtcclxuICAgICAgICAgICAgdmFyIHd6ID0gTWF0aC5mbG9vciggc3ogKTtcclxuICAgICAgICAgICAgdmFyIHNlY3RvciA9IHRoaXMuZ2V0U2VjdG9yKCB3eCwgd3ksIHd6ICk7XHJcblxyXG4gICAgICAgICAgICBzZWN0b3Iuc2V0Q3ViZSggc3VieCwgc3VieSwgc3VieiwgY3ViZSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICAsIGdldFNlY3RvciA6IGZ1bmN0aW9uKCB4LCB5LCB6LCBkb19ub3RfY3JlYXRlICkge1xyXG4gICAgICAgICAgICB2YXIgYmFzZTtcclxuICAgICAgICAgICAgYmFzZSA9IHRoaXMuU2VjdG9yVGFibGVbIHggJSB0aGlzLnNlY3Rvckhhc2hTaXplX3hcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArICggeSAlIHRoaXMuc2VjdG9ySGFzaFNpemVfeSApICogKCB0aGlzLnNlY3Rvckhhc2hTaXplX3ggKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgKCB6ICUgdGhpcy5zZWN0b3JIYXNoU2l6ZV96ICkgKiAoIHRoaXMuc2VjdG9ySGFzaFNpemVfeSp0aGlzLnNlY3Rvckhhc2hTaXplX3gpIF07XHJcbiAgICAgICAgICAgIHdoaWxlKCBiYXNlXHJcbiAgICAgICAgICAgICAgICAmJiAoICggYmFzZS5wb3MueCAhPT0geCApXHJcbiAgICAgICAgICAgICAgICAgICAgfHwgKCBiYXNlLnBvcy55ICE9PSB5IClcclxuICAgICAgICAgICAgICAgICAgICB8fCAoIGJhc2UucG9zLnogIT09IHogKSApIClcclxuICAgICAgICAgICAgICAgIGJhc2UgPSBiYXNlLm5leHQ7XHJcbiAgICAgICAgICAgIGlmKCAhZG9fbm90X2NyZWF0ZSApXHJcbiAgICAgICAgICAgICAgICBpZiggIWJhc2UgKVxyXG4gICAgICAgICAgICAgICAgICAgIGJhc2UgPSB0aGlzLmNyZWF0ZVNlY3RvciggeCwgeSwgeiApXHJcbiAgICAgICAgICAgIHJldHVybiBiYXNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICAsIGdldEdlb21ldHJ5QnVmZmVyIDogbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIGNsdXN0ZXIuVGFibGVTaXplID0gY2x1c3Rlci5zZWN0b3JIYXNoU2l6ZV94ICogY2x1c3Rlci5zZWN0b3JIYXNoU2l6ZV95ICogY2x1c3Rlci5zZWN0b3JIYXNoU2l6ZV96O1xyXG4gICAgY2x1c3Rlci5zZWN0b3JTaXplID0gY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKiBjbHVzdGVyLnNlY3RvclNpemVaO1xyXG4gICAgY2x1c3Rlci5sb29rdXBUYWJsZXMgPSBJbml0U3RhdGljcyggY2x1c3Rlci5zZWN0b3JTaXplWCwgY2x1c3Rlci5zZWN0b3JTaXplWSwgY2x1c3Rlci5zZWN0b3JTaXplWiApXHJcblxyXG4gICAgY2x1c3Rlci5TZWN0b3JUYWJsZSA9IG5ldyBBcnJheSggY2x1c3Rlci5UYWJsZVNpemUgKTtcclxuICAgIC8vIG1heWJlIHJlYWN0b3IgaXMgdW5pdmVyc2FsP1xyXG4gICAgY2x1c3Rlci5yZWFjdG9yID0gVm94ZWxhcml1bS5SZWFjdG9yKCBjbHVzdGVyICk7XHJcblxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoIGNsdXN0ZXJcclxuICAgICAgICAsIHsgJ3NlY3RvclNpemVYJyA6IHt3cml0ZWFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICwgJ3NlY3RvclNpemVZJyA6IHt3cml0ZWFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICwgJ3NlY3RvclNpemVaJyA6IHt3cml0ZWFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICwgJ3NlY3RvclNpemUnIDoge3dyaXRlYWJsZTpmYWxzZX1cclxuICAgICAgICAgICAgLCAnc2VjdG9ySGFzaFNpemVfeCcgOiB7d3JpdGVhYmxlOmZhbHNlfVxyXG4gICAgICAgICAgICAsICdzZWN0b3JIYXNoU2l6ZV95JyA6IHt3cml0ZWFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICwgJ3NlY3Rvckhhc2hTaXplX3onIDoge3dyaXRlYWJsZTpmYWxzZX1cclxuICAgICAgICAgICAgLCAnVGFibGVTaXplJyA6IHt3cml0ZWFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICwgJ3ZveGVsVW5pdFNpemUnIDoge3dyaXRlYWJsZTpmYWxzZX1cclxuICAgICAgICAgICAgLCAnbG9va3VwVGFibGVzJyA6IHt3cml0ZWFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICwgJ1NlY3RvclRhYmxlJyA6IHt3cml0ZWFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICwgJ3JlYWN0b3InIDoge3dyaXRlYWJsZTpmYWxzZX1cclxuICAgICAgICB9IClcclxuXHJcblxyXG4gICAgY2x1c3Rlci5Xb3JraW5nRnVsbFNlY3RvciA9IFZveGVsYXJpdW0uU2VjdG9yKCBjbHVzdGVyICk7XHJcbiAgICBjbHVzdGVyLldvcmtpbmdGdWxsU2VjdG9yLlBvc195ID0gLTE7XHJcbiAgICBjbHVzdGVyLldvcmtpbmdGdWxsU2VjdG9yLk1ha2VTZWN0b3IoIFZveGVsYXJpdW0uVm94ZWxzLnR5cGVzWzFdICk7XHJcbiAgICBjbHVzdGVyLldvcmtpbmdFbXB0eVNlY3Rvcj0gVm94ZWxhcml1bS5TZWN0b3IoIGNsdXN0ZXIgKTtcclxuICAgIGNsdXN0ZXIuV29ya2luZ0VtcHR5U2VjdG9yLlBvc195ID0gMDtcclxuICAgIGNsdXN0ZXIuV29ya2luZ0VtcHR5U2VjdG9yLk1ha2VTZWN0b3IoIFZveGVsYXJpdW0uVm94ZWxzLnR5cGVzWzBdICk7XHJcblxyXG5cclxuICAgIHJldHVybiBjbHVzdGVyO1xyXG59XHJcblxyXG52YXIgU2VjdG9yVGFibGVzID0gW107IC8vIGNhY2hlIG9mIGxvb2t1cCB0YWJsZXNcclxuZnVuY3Rpb24gSW5pdFN0YXRpY3MoIHgseSx6KVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgdGFibGVzID0gU2VjdG9yVGFibGVzLmZpbmQoICh0YWIpPT57IHJldHVybiggdGFiLng9PXggJiYgdGFiLnk9PXkgJiYgdGFiLnogPT0geiApIH0pO1xyXG5cdFx0XHRpZiggIXRhYmxlcyApXHJcblx0XHRcdHtcclxuXHRcdFx0XHR0YWJsZXMgPSB7XHJcblx0XHRcdFx0XHR4OiB4LFxyXG5cdFx0XHRcdFx0eTogeSxcclxuXHRcdFx0XHRcdHo6IHosXHJcblx0XHRcdFx0XHR0YWJsZVggOiBuZXcgQXJyYXkoIHgrMiApLFxyXG5cdFx0XHRcdFx0dGFibGVZIDogbmV3IEFycmF5KCB5KzIgKSxcclxuXHRcdFx0XHRcdHRhYmxlWiA6IG5ldyBBcnJheSggeisyICksXHJcblx0XHRcdFx0XHRvZlRhYmxlWCA6IG5ldyBBcnJheSggeCsyICksXHJcblx0XHRcdFx0XHRvZlRhYmxlWSA6IG5ldyBBcnJheSggeSsyICksXHJcblx0XHRcdFx0XHRvZlRhYmxlWiA6IG5ldyBBcnJheSggeisyIClcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly90YWJsZXMudGFibGVYLmZvckVhY2goIChlbGVtKT0+e2VsZW09MH0pXHJcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyggXCJ0YWJsZVggaW5pdCBpcyBcIiwgdGFibGVzLnRhYmxlWClcclxuXHRcdFx0XHR0YWJsZXMudGFibGVYWzBdID0gMTtcclxuXHRcdFx0XHR0YWJsZXMudGFibGVYW3ggKyAxXSA9IDI7XHJcblx0XHRcdFx0dGFibGVzLnRhYmxlWlswXSA9IDM7XHJcblx0XHRcdFx0dGFibGVzLnRhYmxlWlt5ICsgMV0gPSA2O1xyXG5cdFx0XHRcdHRhYmxlcy50YWJsZVlbMF0gPSA5O1xyXG5cdFx0XHRcdHRhYmxlcy50YWJsZVlbeiArIDFdID0gMTg7XHJcbiAgICAgICAgICAgICAgICBuID0gMDtcclxuICAgICAgICAgICAgICAgIHRhYmxlcy5vZlRhYmxlWFtuXSA9ICggKCAoIG4gPT0gMCApID8gKCB4IC0gMSApIDogKCBuID09ICggeCArIDEgKSApID8gMCA6ICggbiAtIDEgKSApICogeSApO1xyXG4gICAgICAgICAgICAgICAgdGFibGVzLm9mVGFibGVZW25dID0gKCAoICggbiA9PSAwICkgPyAoIHkgLSAxICkgOiAoIG4gPT0gKCB5ICsgMSApICkgPyAwIDogKCBuIC0gMSApICkgKTtcclxuICAgICAgICAgICAgICAgIHRhYmxlcy5vZlRhYmxlWltuXSA9ICggKCAoIG4gPT0gMCApID8gKCB6IC0gMSApIDogKCBuID09ICggeiArIDEgKSApID8gMCA6ICggbiAtIDEgKSApICogeSAqIHogKTtcclxuICAgICAgICAgICAgICAgIG4gPSB4KzE7XHJcbiAgICAgICAgICAgICAgICB0YWJsZXMub2ZUYWJsZVhbbl0gPSAoICggKCBuID09IDAgKSA/ICggeCAtIDEgKSA6ICggbiA9PSAoIHggKyAxICkgKSA/IDAgOiAoIG4gLSAxICkgKSAqIHkgKTtcclxuICAgICAgICAgICAgICAgIHRhYmxlcy5vZlRhYmxlWVtuXSA9ICggKCAoIG4gPT0gMCApID8gKCB5IC0gMSApIDogKCBuID09ICggeSArIDEgKSApID8gMCA6ICggbiAtIDEgKSApICk7XHJcbiAgICAgICAgICAgICAgICB0YWJsZXMub2ZUYWJsZVpbbl0gPSAoICggKCBuID09IDAgKSA/ICggeiAtIDEgKSA6ICggbiA9PSAoIHogKyAxICkgKSA/IDAgOiAoIG4gLSAxICkgKSAqIHkgKiB6ICk7XHJcbiAgICAgICAgZm9yKCAgbiA9IDE7IG4gPCB4ICsgMTsgbisrICkge1xyXG5cdFx0XHRcdFx0dGFibGVzLm9mVGFibGVYW25dID0gKCAoICggbiA9PSAwICkgPyAoIHggLSAxICkgOiAoIG4gPT0gKCB4ICsgMSApICkgPyAwIDogKCBuIC0gMSApICkgKiB5ICk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFibGVzLnRhYmxlWFtuXSA9IDA7XHJcbiAgICAgICAgfVxyXG5cdFx0XHRcdGZvciggdmFyIG4gPSAxOyBuIDwgeSArIDE7IG4rKyApe1xyXG5cdFx0XHRcdFx0dGFibGVzLm9mVGFibGVZW25dID0gKCAoICggbiA9PSAwICkgPyAoIHkgLSAxICkgOiAoIG4gPT0gKCB5ICsgMSApICkgPyAwIDogKCBuIC0gMSApICkgKTtcclxuICAgICAgICAgICAgICAgICAgICB0YWJsZXMudGFibGVZW25dID0gMDtcclxuICAgICAgICB9XHJcblx0XHRcdFx0Zm9yKCAgbiA9IDE7IG4gPCB6ICsgMTsgbisrICkge1xyXG5cdFx0XHRcdFx0dGFibGVzLm9mVGFibGVaW25dID0gKCAoICggbiA9PSAwICkgPyAoIHogLSAxICkgOiAoIG4gPT0gKCB6ICsgMSApICkgPyAwIDogKCBuIC0gMSApICkgKiB5ICogeiApO1xyXG4gICAgICAgICAgdGFibGVzLnRhYmxlWltuXSA9IDA7XHJcbiAgICAgICAgfVxyXG5cdFx0XHRcdFNlY3RvclRhYmxlcy5wdXNoKCB0YWJsZXMgKTtcclxuXHRcdFx0fVxyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyggdGFibGVzXHJcbiAgICAgICAgICAgICAgICAsIHsgXCJ4XCIgOiB7IHdyaXRhYmxlOmZhbHNlfVxyXG4gICAgICAgICAgICAgICAgLCAgXCJ5XCIgOiB7IHdyaXRhYmxlOmZhbHNlfVxyXG4gICAgICAgICAgICAgICAgLCAgXCJ6XCIgOiB7IHdyaXRhYmxlOmZhbHNlfVxyXG4gICAgICAgICAgICAgICAgLCAgXCJ0YWJsZVhcIiA6IHsgd3JpdGFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICAgICAsICBcInRhYmxlWVwiIDogeyB3cml0YWJsZTpmYWxzZX1cclxuICAgICAgICAgICAgICAgICwgIFwidGFibGVaXCIgOiB7IHdyaXRhYmxlOmZhbHNlfVxyXG4gICAgICAgICAgICAgICAgLCAgXCJvZlRhYmxlWFwiIDogeyB3cml0YWJsZTpmYWxzZX1cclxuICAgICAgICAgICAgICAgICwgIFwib2ZUYWJsZVlcIiA6IHsgd3JpdGFibGU6ZmFsc2V9XHJcbiAgICAgICAgICAgICAgICAsICBcIm9mVGFibGVaXCIgOiB7IHdyaXRhYmxlOmZhbHNlfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgT2JqZWN0LmZyZWV6ZSggdGFibGVzLnRhYmxlWCApO1xyXG4gICAgICAgICAgICBPYmplY3QuZnJlZXplKCB0YWJsZXMudGFibGVZICk7XHJcbiAgICAgICAgICAgIE9iamVjdC5mcmVlemUoIHRhYmxlcy50YWJsZVogKTtcclxuICAgICAgICAgICAgT2JqZWN0LmZyZWV6ZSggdGFibGVzLm9mVGFibGVYICk7XHJcbiAgICAgICAgICAgIE9iamVjdC5mcmVlemUoIHRhYmxlcy5vZlRhYmxlWSApO1xyXG4gICAgICAgICAgICBPYmplY3QuZnJlZXplKCB0YWJsZXMub2ZUYWJsZVogKTtcclxuXHRcdFx0cmV0dXJuIHRhYmxlcztcclxuXHRcdH1cclxuIiwiXHJcblZveGVsYXJpdW0uRCA9IGZ1bmN0aW9uKCB2YWxuYW1lLCB2YWx1ZSApIHtcclxuICAgIGlmKCB0eXBlb2YgdmFsbmFtZSA9PSBcIm9iamVjdFwiICkge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHZhbG5hbWUpLmZvckVhY2goIChrZXkpPT57XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWb3hlbGFyaXVtLCBrZXksIHsgdmFsdWU6dmFsbmFtZVtrZXldLCB3cml0YWJsZTogZmFsc2UgfSlcclxuICAgICAgICB9KVxyXG4gICAgfSBlbHNlXHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZveGVsYXJpdW0sIHZhbG5hbWUsIHsgd3JpdGFibGU6IGZhbHNlIH0pXHJcbn1cclxuVm94ZWxhcml1bS5FbnVtID0gZnVuY3Rpb24oIHZhbG5hbWUsIHZhbHVlICkge1xyXG4gICAgaWYoIHR5cGVvZiB2YWxuYW1lID09IFwib2JqZWN0XCIgKSB7XHJcbiAgICAgICAgT2JqZWN0LmtleXModmFsbmFtZSkuZm9yRWFjaCggKGtleSk9PntcclxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZveGVsYXJpdW0sIGtleSwgeyB2YWx1ZTp2YWxuYW1lW2tleV0sIHdyaXRhYmxlOiBmYWxzZSB9KVxyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyh2YWxuYW1lW2tleV0pLmZvckVhY2goIChldmFsdWUpPT57XHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVm94ZWxhcml1bVtrZXldLCBldmFsdWUsIHsgdmFsdWU6dmFsbmFtZVtrZXldW2V2YWx1ZV0sIHdyaXRhYmxlOiBmYWxzZSB9KVxyXG5cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfSBlbHNlXHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZveGVsYXJpdW0sIHZhbG5hbWUsIHsgd3JpdGFibGU6IGZhbHNlIH0pXHJcbn1cclxuXHJcblxyXG5Wb3hlbGFyaXVtLkQoIHtcclxuICAgICAgICBaVk9YRUxfRFJBV0lORk9fVk9JRCA6IDAsXHJcbi8vcHVibGljIGNvbnN0IGludCBaVk9YRUxfRFJBV0lORk9fTk9UVk9JRCA9IDE7XHJcbiAgICBaVk9YRUxfRFJBV0lORk9fRFJBV0ZVTExWT1hFTE9QQUNJVFkgOiAxLFxyXG4gIFpWT1hFTF9EUkFXSU5GT19EUkFXVFJBTlNQQVJFTlRSRU5ERVJJTkcgOiAyLFxyXG4gIFpWT1hFTF9EUkFXSU5GT19TUEVDSUFMUkVOREVSSU5HIDogOCxcclxuICBaVk9YRUxfRFJBV0lORk9fU0hBREVSIDogMTYsXHJcbiAgWlZPWEVMX0RSQVdJTkZPX0RFQ0FMIDogMzIsICAvLyBpbWFnZSBpcyB1c2VkIG92ZXIgc2hhZGVyIG91dHB1dFxyXG59KVxyXG5Wb3hlbGFyaXVtLkQoIHtcclxuICAgIFpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUUyA6ICggLypaVk9YRUxfRFJBV0lORk9fTk9UVk9JRCB8Ki8gVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fRFJBV0ZVTExWT1hFTE9QQUNJVFkgfCBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19EUkFXVFJBTlNQQVJFTlRSRU5ERVJJTkcgKVxyXG59KTtcclxuXHJcblxyXG5Wb3hlbGFyaXVtLkVudW0oIHtcclxuICAgIEZBQ0VEUkFXX09wZXJhdGlvbnMgOiB7XHJcblx0XHRcdExFRlQgOiAweDAwMDAxXHJcblx0XHQsIFJJR0hUIDogMHgwMDAwMlxyXG5cdFx0LCBBSEVBRCA6IDB4MDAwMDRcclxuXHRcdCwgQkVISU5EIDogMHgwMDAwOFxyXG5cdFx0LCBBQk9WRSA6IDB4MDAwMTBcclxuXHRcdCwgQkVMT1cgOiAweDAwMDIwXHJcblx0XHQsIExFRlRfSEFTX0FCT1ZFIDogMHgwMDAwMDQwMFxyXG5cdFx0LCBMRUZUX0hBU19CRUxPVyA6IDB4MDAwMDA4MDBcclxuXHRcdCwgTEVGVF9IQVNfQUhFQUQgOiAweDAwMDAxMDAwXHJcblx0XHQsIExFRlRfSEFTX0JFSElORCA6IDB4MDAwMDIwMDBcclxuXHRcdCwgUklHSFRfSEFTX0FCT1ZFIDogMHgwMDAwNDAwMFxyXG5cdFx0LCBSSUdIVF9IQVNfQkVMT1cgOiAweDAwMDA4MDAwXHJcblx0XHQsIFJJR0hUX0hBU19BSEVBRCA6IDB4MDAwMTAwMDBcclxuXHRcdCwgUklHSFRfSEFTX0JFSElORCA6IDB4MDAwMjAwMDBcclxuXHRcdCwgQUJPVkVfSEFTX0xFRlQgOiAweDAwMDAwNDAwLy9MRUZUX0hBU19BQk9WRVxyXG5cdFx0LCBBQk9WRV9IQVNfUklHSFQgOiAweDAwMDA0MDAwLy9SSUdIVF9IQVNfQUJPVkVcclxuXHRcdCwgQUJPVkVfSEFTX0FIRUFEIDogMHgwMDA0MDAwMFxyXG5cdFx0LCBBQk9WRV9IQVNfQkVISU5EIDogMHgwMDA4MDAwMFxyXG5cdFx0LCBCRUxPV19IQVNfTEVGVCA6IDB4MDAwMDA4MDAvL0xFRlRfSEFTX0JFTE9XXHJcblx0XHQsIEJFTE9XX0hBU19SSUdIVCA6IDB4MDAwMDgwMDAvL1JJR0hUX0hBU19CRUxPV1xyXG5cdFx0LCBCRUxPV19IQVNfQUhFQUQgOiAweDAwMTAwMDAwXHJcblx0XHQsIEJFTE9XX0hBU19CRUhJTkQgOiAweDAwMjAwMDAwXHJcblx0XHQsIEFIRUFEX0hBU19MRUZUIDogMHgwMDAwMTAwMC8vTEVGVF9IQVNfQUhFQURcclxuXHRcdCwgQUhFQURfSEFTX1JJR0hUIDogMHgwMDEwMDAwMC8vUklHSFRfSEFTX0FIRUFEXHJcblx0XHQsIEFIRUFEX0hBU19BQk9WRSA6IDB4MDAwNDAwMDAvL0FCT1ZFX0hBU19BSEVBRFxyXG5cdFx0LCBBSEVBRF9IQVNfQkVMT1cgOiAweDAwMTAwMDAwLy9CRUxPV19IQVNfQUhFQURcclxuXHRcdCwgQkVISU5EX0hBU19MRUZUIDogMHgwMDAwMjAwMC8vTEVGVF9IQVNfQkVISU5EXHJcblx0XHQsIEJFSElORF9IQVNfUklHSFQgOiAweDAwMDIwMDAwLy9SSUdIVF9IQVNfQkVISU5EXHJcblx0XHQsIEJFSElORF9IQVNfQUJPVkUgOiAweDAwMDgwMDAwLy9BQk9WRV9IQVNfQkVISU5EXHJcblx0XHQsIEJFSElORF9IQVNfQkVMT1cgOiAweDAwMjAwMDAwLy9CRUxPV19IQVNfQkVISU5EXHJcblx0XHQsIEFMTCA6ICggMXwyfDR8OHwxNnwzMiAvKiBMRUZUIHwgUklHSFQgfCBBSEVBRCB8IEJFSElORCB8IEFCT1ZFIHwgQkVMT1cgKi8gKVxyXG5cdFx0LCBOT05FIDogMHgwMDAwMFxyXG5cdFx0LCBGTEFOSyA6ICggMXwyfDR8OCAvKiBMRUZUIHwgUklHSFQgfCBBSEVBRCB8IEJFSElORCAqLyApXHJcblx0XHQsIFVEIDogKCAxNnwzMiAvKkFCT1ZFIHwgQkVMT1cqLyApXHJcblx0XHQsIEFMTF9CSVRTIDogMHgzRkZGRkZcclxuICAgIH19KTtcclxuXHJcblxyXG5Wb3hlbGFyaXVtLkVudW0oIHsgUmVsYXRpdmVWb3hlbE9yZHMgOiB7XHJcblx0SU5DRU5URVIgOjBcclxuICAgLCBMRUZUICAgICA6MVxyXG4gICAsIFJJR0hUIDoyXHJcbiAgICwgSU5GUk9OVCA6M1xyXG4gICAsIEFIRUFEIDogMyAvL1JlbGF0aXZlVm94ZWxPcmRzLklORlJPTlRcclxuICAgLCBCRUhJTkQgIDo0XHJcbiAgICwgQUJPVkUgICA6NVxyXG4gICAsIEJFTE9XICAgOjZcclxuXHJcbiAgICwgTEVGVF9BQk9WRSA6N1xyXG4gICAsIEFCT1ZFX0xFRlQgOiA3Ly9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXHJcbiAgICwgUklHSFRfQUJPVkUgOjhcclxuICAgLCBBQk9WRV9SSUdIVCA6IDgvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXHJcblxyXG4gICAsIElORlJPTlRfQUJPVkUgOjlcclxuICAgLCBBSEVBRF9BQk9WRSA6IDkvLyBSZWxhdGl2ZVZveGVsT3Jkcy5JTkZST05UX0FCT1ZFXHJcbiAgICwgQUJPVkVfQUhFQUQgOiA5Ly9SZWxhdGl2ZVZveGVsT3Jkcy5JTkZST05UX0FCT1ZFXHJcblxyXG4gICAsIEJFSElORF9BQk9WRSAgOjEwXHJcbiAgICwgQUJPVkVfQkVISU5EIDogMTAvL1JlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9BQk9WRVxyXG5cclxuICAgLCBMRUZUX0FIRUFEICAgOjExXHJcbiAgICwgQUhFQURfTEVGVCA6IDExLy9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEXHJcblxyXG4gICAsIFJJR0hUX0FIRUFEICAgOjEyXHJcbiAgICwgQUhFQURfUklHSFQgOiAxMi8vUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUhFQURcclxuXHJcbiAgICwgTEVGVF9CRUxPVyA6MTNcclxuICAgLCBCRUxPV19MRUZUIDogMTMvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dcclxuICAgLCBSSUdIVF9CRUxPVyA6MTRcclxuICAgLCBCRUxPV19SSUdIVCA6IDE0Ly9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV1xyXG4gICAsIElORlJPTlRfQkVMT1cgOjE1XHJcbiAgICwgQUhFQURfQkVMT1cgOiAxNS8vUmVsYXRpdmVWb3hlbE9yZHMuSU5GUk9OVF9CRUxPV1xyXG4gICAsIEJFTE9XX0FIRUFEIDogMTUvL1JlbGF0aXZlVm94ZWxPcmRzLklORlJPTlRfQkVMT1dcclxuICAgLCBCRUhJTkRfQkVMT1cgIDoxNlxyXG4gICAsIEJFTE9XX0JFSElORCA6IDE2Ly9SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfQkVMT1dcclxuXHJcbiAgICwgTEVGVF9CRUhJTkQgICA6MTdcclxuICAgLCBCRUhJTkRfTEVGVCA6IDE3Ly9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFSElORFxyXG4gICAsIEJFSElORF9SSUdIVCAgIDoxOFxyXG4gICAsIFJJR0hUX0JFSElORCA6IDE4Ly9SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRcclxuXHJcblxyXG4gICAsIExFRlRfQUhFQURfQUJPVkUgICA6IDE5XHJcbiAgICwgUklHSFRfQUhFQURfQUJPVkUgIDogMjBcclxuICAgLCBMRUZUX0FIRUFEX0JFTE9XICAgOiAyMVxyXG4gICAsIFJJR0hUX0FIRUFEX0JFTE9XICA6IDIyXHJcbiAgICwgTEVGVF9CRUhJTkRfQUJPVkUgIDogMjNcclxuICAgLCBSSUdIVF9CRUhJTkRfQUJPVkUgOiAyNFxyXG4gICAsIExFRlRfQkVISU5EX0JFTE9XICA6IDI1XHJcbiAgICwgUklHSFRfQkVISU5EX0JFTE9XIDogMjZcclxuXHJcbiAgICwgTEVGVF9BQk9WRV9BSEVBRCA6IDE5Ly9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEX0FCT1ZFICAgLy86IDE5XHJcbiAgICwgUklHSFRfQUJPVkVfQUhFQUQgOiAyMC8vUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUhFQURfQUJPVkUgIC8vIDogMjBcclxuICAgLCBMRUZUX0JFTE9XX0FIRUFEIDogMjEvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUhFQURfQkVMT1cgICAgIC8vOiAyMVxyXG4gICAsIFJJR0hUX0JFTE9XX0FIRUFEIDogMjIvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0JFTE9XICAgLy86IDIyXHJcbiAgICwgTEVGVF9BQk9WRV9CRUhJTkQgOiAyMy8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQUJPVkUgIC8vOiAyM1xyXG4gICAsIFJJR0hUX0FCT1ZFX0JFSElORCA6IDI0Ly9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkRfQUJPVkUvLyA6IDI0XHJcbiAgICwgTEVGVF9CRUxPV19CRUhJTkQgOiAyNS8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQkVMT1cgIC8vOiAyNVxyXG4gICAsIFJJR0hUX0JFTE9XX0JFSElORCA6IDI2Ly9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkRfQkVMT1cvLyA6IDI2XHJcblxyXG4gICAsIEFCT1ZFX0FIRUFEX0xFRlQgOiAxOS8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRF9BQk9WRSAgIC8vOiAxOVxyXG4gICAsIEFCT1ZFX0FIRUFEX1JJR0hUIDogMjAvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0FCT1ZFICAvLyA6IDIwXHJcbiAgICwgQkVMT1dfQUhFQURfTEVGVCA6IDIxLy9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEX0JFTE9XICAgIC8vIDogMjFcclxuICAgLCBCRUxPV19BSEVBRF9SSUdIVCA6IDIyLy9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BSEVBRF9CRUxPVyAgLy8gOiAyMlxyXG4gICAsIEFCT1ZFX0JFSElORF9MRUZUIDogMjMvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVISU5EX0FCT1ZFICAvLzogMjNcclxuICAgLCBBQk9WRV9CRUhJTkRfUklHSFQgOiAyNC8vUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVISU5EX0FCT1ZFIC8vOiAyNFxyXG4gICAsIEJFTE9XX0JFSElORF9MRUZUIDogMjUvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVISU5EX0JFTE9XICAvLzogMjVcclxuICAgLCBCRUxPV19CRUhJTkRfUklHSFQgOiAyNi8vUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVISU5EX0JFTE9XLy8gOiAyNlxyXG5cclxuICAgLCBBSEVBRF9BQk9WRV9MRUZUIDogMTkvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUhFQURfQUJPVkUgICAvLzogMTlcclxuICAgLCBBSEVBRF9BQk9WRV9SSUdIVCA6IDIwLy9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BSEVBRF9BQk9WRSAvLyAgOiAyMFxyXG4gICAsIEFIRUFEX0JFTE9XX0xFRlQgOiAyMS8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRF9CRUxPVyAgIC8vICA6IDIxXHJcbiAgICwgQkVISU5EX0FCT1ZFX0xFRlQgOiAyMi8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQUJPVkUgLy8gOiAyM1xyXG4gICAsIEFIRUFEX0JFTE9XX1JJR0hUIDogMjMvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0JFTE9XIC8vICA6IDIyXHJcbiAgICwgQkVISU5EX0FCT1ZFX1JJR0hUIDogMjQvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFSElORF9BQk9WRSAvLzogMjRcclxuICAgLCBCRUhJTkRfQkVMT1dfTEVGVCA6IDI1Ly9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFSElORF9CRUxPVyAgLy86IDI1XHJcbiAgICwgQkVISU5EX0JFTE9XX1JJR0hUIDogMjYvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFSElORF9CRUxPVyAvLzogMjZcclxuXHJcbiAgICwgQUJPVkVfTEVGVF9BSEVBRCA6IDE5Ly9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEX0FCT1ZFICAvLyA6IDE5XHJcbiAgICwgQUJPVkVfUklHSFRfQUhFQUQgOiAyMC8vUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUhFQURfQUJPVkUgLy8gIDogMjBcclxuICAgLCBCRUxPV19MRUZUX0FIRUFEIDogMjEvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUhFQURfQkVMT1cgICAgLy8gOiAyMVxyXG4gICAsIEJFTE9XX1JJR0hUX0FIRUFEIDogMjIvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0JFTE9XICAvLyA6IDIyXHJcbiAgICwgQUJPVkVfTEVGVF9CRUhJTkQgOiAyMy8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQUJPVkUgIC8vOiAyM1xyXG4gICAsIEFCT1ZFX1JJR0hUX0JFSElORCA6IDI0Ly9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkRfQUJPVkUgLy86IDI0XHJcbiAgICwgQkVMT1dfTEVGVF9CRUhJTkQgOiAyNS8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQkVMT1cgIC8vOiAyNVxyXG4gICAsIEJFTE9XX1JJR0hUX0JFSElORCA6IDI2Ly9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkRfQkVMT1cgLy86IDI2XHJcblxyXG4gICAsIEFIRUFEX0xFRlRfQUJPVkUgOiAxOS8vUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRF9BQk9WRSAgLy8gOiAxOVxyXG4gICAsIEFIRUFEX1JJR0hUX0FCT1ZFIDogMjAvL1JlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0FCT1ZFIC8vICA6IDIwXHJcbiAgICwgQUhFQURfTEVGVF9CRUxPVyA6IDIxLy9SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEX0JFTE9XICAgLy8gIDogMjFcclxuICAgLCBBSEVBRF9SSUdIVF9CRUxPVyA6IDIyLy9SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BSEVBRF9CRUxPVyAvLyAgOiAyMlxyXG4gICAsIEJFSElORF9MRUZUX0FCT1ZFIDogMjMvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVISU5EX0FCT1ZFIC8vIDogMjNcclxuICAgLCBCRUhJTkRfUklHSFRfQUJPVkUgOiAyNC8vUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVISU5EX0FCT1ZFIC8vOiAyNFxyXG4gICAsIEJFSElORF9MRUZUX0JFTE9XIDogMjUvL1JlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVISU5EX0JFTE9XICAvLzogMjVcclxuICAgLCBCRUhJTkRfUklHSFRfQkVMT1cgOiAyNi8vUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVISU5EX0JFTE9XIC8vOiAyNlxyXG59fSlcclxuXHJcblxyXG5jb25zdCBJbnRGYWNlU3RhdGVUYWJsZSA9IFtcclxuICAgICAgICAgIFsgLy8gU3RhdGUgMDogQ2xlYXIgPSBubyBGdWxsT3BhcXVlID0gbm8gVHJhbnNwUmVuZCA9IG5vXHJcbiAgICAgICAgICAgIDAgLCAvLyBDbGVhciA9IDEgRnVsbE9wYXF1ZSA9IDAgVHJhbnNwUmVuZCA9IDBcclxuICAgICAgICAgICAgMCAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICAwICwgLy8gQ2xlYXIgPSAwIEZ1bGxPcGFxdWUgPSAwIFRyYW5zcFJlbmQgPSAxXHJcbiAgICAgICAgICAgIDAgLCAvLyBDbGVhciA9IDAgRnVsbE9wYXF1ZSA9IDEgVHJhbnNwUmVuZCA9IDFcclxuICAgICAgICAgIF0gLFxyXG4gICAgICAgICAgWyAvLyBTdGF0ZSAyOiBDbGVhciA9IG5vIEZ1bGxPcGFxdWUgPSB5ZXMgVHJhbnNwUmVuZCA9IG5vXHJcbiAgICAgICAgICAgIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTExfQklUUyAsIC8vIENsZWFyID0gMSBGdWxsT3BhcXVlID0gMCBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICAwICwgLy8gQ2xlYXIgPSAwIEZ1bGxPcGFxdWUgPSAxIFRyYW5zcFJlbmQgPSAwXHJcbiAgICAgICAgICAgIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTExfQklUUyAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMCBUcmFuc3BSZW5kID0gMVxyXG4gICAgICAgICAgICAwICwgLy8gQ2xlYXIgPSAwIEZ1bGxPcGFxdWUgPSAxIFRyYW5zcFJlbmQgPSAxXHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICBbIC8vIFN0YXRlIDQgOiBDbGVhciA9IG5vIEZ1bGxPcGFxdWUgPSBubyBUcmFuc3BSZW5kID0geWVzXHJcbiAgICAgICAgICAgIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTExfQklUUyAsIC8vIENsZWFyID0gMSBGdWxsT3BhcXVlID0gMCBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICAwICAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICAwICwgLy8gQ2xlYXIgPSAwIEZ1bGxPcGFxdWUgPSAwIFRyYW5zcFJlbmQgPSAxXHJcbiAgICAgICAgICAgIDAgLCAvLyBDbGVhciA9IDAgRnVsbE9wYXF1ZSA9IDEgVHJhbnNwUmVuZCA9IDFcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgICBudWxsLypuZXcgVm94ZWxTZWN0b3IuRkFDRURSQVdfT3BlcmF0aW9uc1tdeyAvLyBTdGF0ZSA1OiBDbGVhciA9IHllcyBGdWxsT3BhcXVlID0geWVzIFRyYW5zcFJlbmQgPSB5ZXNcclxuICAgICAgICAgICAgVm94ZWxTZWN0b3IuRkFDRURSQVdfT3BlcmF0aW9ucy5BTExfQklUUyAsIC8vIENsZWFyID0gMSBGdWxsT3BhcXVlID0gMCBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICBWb3hlbFNlY3Rvci5GQUNFRFJBV19PcGVyYXRpb25zLkFMTF9CSVRTICwgLy8gQ2xlYXIgPSAwIEZ1bGxPcGFxdWUgPSAxIFRyYW5zcFJlbmQgPSAwXHJcbiAgICAgICAgICAgIFZveGVsU2VjdG9yLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMX0JJVFMgLCAvLyBDbGVhciA9IDAgRnVsbE9wYXF1ZSA9IDAgVHJhbnNwUmVuZCA9IDFcclxuICAgICAgICAgICAgVm94ZWxTZWN0b3IuRkFDRURSQVdfT3BlcmF0aW9ucy5BTExfQklUUyAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMVxyXG4gICAgICAgICAgfSovLFxyXG4gICAgICBdO1xyXG5cclxuICAgICAgVm94ZWxhcml1bS5JbnRGYWNlU3RhdGVUYWJsZSA9IEludEZhY2VTdGF0ZVRhYmxlO1xyXG5cclxuY29uc3QgRXh0RmFjZVN0YXRlVGFibGUgPSBbXHJcbiAgICAgICAgICBbIC8vIFN0YXRlIDA6IENsZWFyID0gbm8gRnVsbE9wYXF1ZSA9IG5vIFRyYW5zcFJlbmQgPSBub1xyXG4gICAgICAgICAgICAwICwgLy8gQ2xlYXIgPSAxIEZ1bGxPcGFxdWUgPSAwIFRyYW5zcFJlbmQgPSAwXHJcbiAgICAgICAgICAgIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTExfQklUUyAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMX0JJVFMgLCAvLyBDbGVhciA9IDAgRnVsbE9wYXF1ZSA9IDAgVHJhbnNwUmVuZCA9IDFcclxuICAgICAgICAgICAgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTF9CSVRTICwgLy8gQ2xlYXIgPSAwIEZ1bGxPcGFxdWUgPSAxIFRyYW5zcFJlbmQgPSAxXHJcbiAgICAgICAgXSxcclxuICAgICAgICAgIFsgLy8gU3RhdGUgMjogQ2xlYXIgPSBubyBGdWxsT3BhcXVlID0geWVzIFRyYW5zcFJlbmQgPSBub1xyXG4gICAgICAgICAgICAwICAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMCBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICAwICAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICAwICAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMCBUcmFuc3BSZW5kID0gMVxyXG4gICAgICAgICAgICAwICAsIC8vIENsZWFyID0gMSBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMVxyXG4gICAgICAgIF0sXHJcbiAgICAgICAgICBbIC8vIFN0YXRlIDQgOiBDbGVhciA9IG5vIEZ1bGxPcGFxdWUgPSBubyBUcmFuc3BSZW5kID0geWVzXHJcbiAgICAgICAgICAgIDAgLCAvLyBDbGVhciA9IDFcclxuICAgICAgICAgICAgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTF9CSVRTICAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICAwICAsIC8vIEZ1bGxPcGFxdWUgPSAwIFRyYW5zcFJlbmQgPSAxXHJcbiAgICAgICAgICAgIDAgICwgLy8gRnVsbE9wYXF1ZSA9IDEgVHJhbnNwUmVuZCA9IDFcclxuICAgICAgICAgIF0sXHJcbiAgICAgICAgIG51bGwvKiBuZXcgVm94ZWxTZWN0b3IuRkFDRURSQVdfT3BlcmF0aW9uc1s4XXsgLy8gU3RhdGUgNzogQ2xlYXIgPSB5ZXMgRnVsbE9wYXF1ZSA9IHllcyBUcmFuc3BSZW5kID0geWVzXHJcbiAgICAgICAgICAgIDAgICAsIC8vIENsZWFyID0gMSBGdWxsT3BhcXVlID0gMCBUcmFuc3BSZW5kID0gMFxyXG4gICAgICAgICAgICBWb3hlbFNlY3Rvci5GQUNFRFJBV19PcGVyYXRpb25zLkFMTF9CSVRTICwgLy8gQ2xlYXIgPSAwIEZ1bGxPcGFxdWUgPSAxIFRyYW5zcFJlbmQgPSAwXHJcbiAgICAgICAgICAgIFZveGVsU2VjdG9yLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMX0JJVFMgLCAvLyBDbGVhciA9IDAgRnVsbE9wYXF1ZSA9IDAgVHJhbnNwUmVuZCA9IDFcclxuICAgICAgICAgICAgVm94ZWxTZWN0b3IuRkFDRURSQVdfT3BlcmF0aW9ucy5BTExfQklUUyAsIC8vIENsZWFyID0gMCBGdWxsT3BhcXVlID0gMSBUcmFuc3BSZW5kID0gMVxyXG4gICAgICAgICAgfSovXHJcbiAgICAgIF07XHJcbiAgICAgIFZveGVsYXJpdW0uRXh0RmFjZVN0YXRlVGFibGUgPSBFeHRGYWNlU3RhdGVUYWJsZTtcclxuXHJcbmZ1bmN0aW9uIFpCbG9jUG9zTiggeCwgeSwgeiApIHtcclxuICAgIHRoaXMueCA9IHg7XHJcbiAgICB0aGlzLnkgPSB5O1xyXG4gICAgdGhpcy56ID0gejtcclxufVxyXG5cclxuICAgIGNvbnN0IE5vcm1hbEJhc2VQb3NpdGlvbiA9IFZveGVsYXJpdW0uTm9ybWFsQmFzZVBvc2l0aW9uID0gW1xyXG4gICAgICAgICAgbmV3IFpCbG9jUG9zTiAoIC0xLCAwLCAwIClcclxuICAgICAgICAgICwgbmV3IFpCbG9jUG9zTiAoIDEsIDAsIDAgKVxyXG4gICAgICAgICAgLCBuZXcgWkJsb2NQb3NOKCAwLCAwLCAxIClcclxuICAgICAgICAgICwgbmV3IFpCbG9jUG9zTiggMCwgMCwgLTEgKVxyXG4gICAgICAgICAgLCBuZXcgWkJsb2NQb3NOKCAwLCAxLCAwIClcclxuICAgICAgICAgICwgbmV3IFpCbG9jUG9zTiggMCwgLTEsIDAgKSBdO1xyXG5cclxuIiwidmFyIGZvbnQgPSB7XHJcbmhlaWdodDo4LCBiYXNlbGluZTowLCBjaGFyczo2NTUzNiwgZmxhZ3M6NjQsIG5hbWU6XCJUSTk5LmpzXCIsIGNoYXJhY3RlcnM6W251bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLG51bGxcclxuLHtzejowLHc6NyxvZnM6MCxhc2M6MCxkc2M6MH1cclxuLHtzejoxLHc6NyxvZnM6Mixhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxLDEsMSwxLDEsMCwxXSkgfVxyXG4se3N6OjMsdzo3LG9mczoxLGFzYzo3LGRzYzo1LGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzUsNSw1XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzEwLDEwLDMxLDEwLDMxLDEwLDEwXSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE0LDIxLDUsMTQsMjAsMjEsMTRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMywxOSw4LDQsMiwyNSwyNF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsyLDUsNSwyLDIxLDksMjJdKSB9XHJcbix7c3o6Mix3Ojcsb2ZzOjIsYXNjOjcsZHNjOjUsZGF0YTpuZXcgVWludDhBcnJheShbMiwyLDFdKSB9XHJcbix7c3o6Myx3Ojcsb2ZzOjEsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbNCwyLDEsMSwxLDIsNF0pIH1cclxuLHtzejozLHc6NyxvZnM6MSxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxLDIsNCw0LDQsMiwxXSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo2LGRzYzoyLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzEwLDQsMzEsNCwxMF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nixkc2M6MixkYXRhOm5ldyBVaW50OEFycmF5KFs0LDQsMzEsNCw0XSkgfVxyXG4se3N6OjIsdzo3LG9mczoxLGFzYzozLGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMsMiwxXSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo0LGRzYzo0LGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxXSkgfVxyXG4se3N6OjIsdzo3LG9mczoxLGFzYzoyLGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMsM10pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nixkc2M6MixkYXRhOm5ldyBVaW50OEFycmF5KFsxNiw4LDQsMiwxXSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE0LDE3LDE3LDE3LDE3LDE3LDE0XSkgfVxyXG4se3N6OjMsdzo3LG9mczoxLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzIsMywyLDIsMiwyLDddKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTQsMTcsMTYsOCw0LDIsMzFdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTQsMTcsMTYsMTIsMTYsMTcsMTRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbOCwxMiwxMCw5LDMxLDgsOF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszMSwxLDE1LDE2LDE2LDE3LDE0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzEyLDIsMSwxNSwxNywxNywxNF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszMSwxNiw4LDQsMiwyLDJdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTQsMTcsMTcsMTQsMTcsMTcsMTRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTQsMTcsMTcsMzAsMTYsOCw2XSkgfVxyXG4se3N6OjIsdzo3LG9mczoxLGFzYzo2LGRzYzoyLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMsMywwLDMsM10pIH1cclxuLHtzejoyLHc6NyxvZnM6MSxhc2M6Nixkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszLDMsMCwzLDIsMV0pIH1cclxuLHtzejo0LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFs4LDQsMiwxLDIsNCw4XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzozLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxLDAsMzFdKSB9XHJcbix7c3o6NCx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMSwyLDQsOCw0LDIsMV0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNCwxNywxNiw4LDQsMCw0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE0LDE3LDI5LDIxLDI5LDEsMTRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTQsMTcsMTcsMzEsMTcsMTcsMTddKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTUsMTgsMTgsMTQsMTgsMTgsMTVdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTQsMTcsMSwxLDEsMTcsMTRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTUsMTgsMTgsMTgsMTgsMTgsMTVdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMzEsMSwxLDE1LDEsMSwzMV0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszMSwxLDEsMTUsMSwxLDFdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTQsMTcsMSwyOSwxNywxNywxNF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNywxNywxNywzMSwxNywxNywxN10pIH1cclxuLHtzejozLHc6NyxvZnM6MSxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFs3LDIsMiwyLDIsMiw3XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE2LDE2LDE2LDE2LDE2LDE3LDE0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE3LDksNSwzLDUsOSwxN10pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxLDEsMSwxLDEsMSwzMV0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNywyNywyMSwyMSwxNywxNywxN10pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNywxOSwxOSwyMSwyNSwyNSwxN10pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszMSwxNywxNywxNywxNywxNywzMV0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNSwxNywxNywxNSwxLDEsMV0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNCwxNywxNywxNywyMSw5LDIyXSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE1LDE3LDE3LDE1LDUsOSwxN10pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNCwxNywxLDE0LDE2LDE3LDE0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxLDQsNCw0LDQsNCw0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE3LDE3LDE3LDE3LDE3LDE3LDE0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE3LDE3LDE3LDEwLDEwLDQsNF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNywxNywxNywyMSwyMSwyMSwxMF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNywxNywxMCw0LDEwLDE3LDE3XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE3LDE3LDEwLDQsNCw0LDRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMzEsMTYsOCw0LDIsMSwzMV0pIH1cclxuLHtzejozLHc6NyxvZnM6MSxhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFs3LDEsMSwxLDEsMSw3XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo2LGRzYzoyLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzEsMiw0LDgsMTZdKSB9XHJcbix7c3o6Myx3Ojcsb2ZzOjEsYXNjOjcsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbNyw0LDQsNCw0LDQsN10pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6Nixkc2M6NCxkYXRhOm5ldyBVaW50OEFycmF5KFs0LDEwLDE3XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzoxLGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxXSkgfVxyXG4se3N6OjMsdzo3LG9mczoxLGFzYzo2LGRzYzo0LGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzEsMiw0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE0LDE3LDMxLDE3LDE3XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE1LDE4LDE0LDE4LDE1XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMwLDEsMSwxLDMwXSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE1LDE4LDE4LDE4LDE1XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxLDEsMTUsMSwzMV0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6NSxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszMSwxLDE1LDEsMV0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6NSxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszMCwxLDI5LDE3LDE0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE3LDE3LDMxLDE3LDE3XSkgfVxyXG4se3N6OjMsdzo3LG9mczoxLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzcsMiwyLDIsN10pIH1cclxuLHtzejo0LHc6NyxvZnM6MCxhc2M6NSxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFs4LDgsOCw5LDZdKSB9XHJcbix7c3o6NCx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbOSw1LDMsNSw5XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzEsMSwxLDEsMzFdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTcsMjcsMjEsMTcsMTddKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTcsMTksMjEsMjUsMTddKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMzEsMTcsMTcsMTcsMzFdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTUsMTcsMTUsMSwxXSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE0LDE3LDIxLDksMjJdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTUsMTcsMTUsOSwxN10pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6NSxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFszMCwxLDE0LDE2LDE1XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxLDQsNCw0LDRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTcsMTcsMTcsMTcsMTRdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjUsZHNjOjEsZGF0YTpuZXcgVWludDhBcnJheShbMTcsMTcsMTAsMTAsNF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6NSxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNywxNywyMSwyMSwxMF0pIH1cclxuLHtzejo1LHc6NyxvZnM6MCxhc2M6NSxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxNywxMCw0LDEwLDE3XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzE3LDEwLDQsNCw0XSkgfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo1LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxLDgsNCwyLDMxXSkgfVxyXG4se3N6OjQsdzo3LG9mczowLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzEyLDIsMiwxLDIsMiwxMl0pIH1cclxuLHtzejoxLHc6NyxvZnM6Mixhc2M6Nyxkc2M6MSxkYXRhOm5ldyBVaW50OEFycmF5KFsxLDEsMSwwLDEsMSwxXSkgfVxyXG4se3N6OjQsdzo3LG9mczoxLGFzYzo3LGRzYzoxLGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMsNCw0LDgsNCw0LDNdKSB9XHJcbix7c3o6NSx3Ojcsb2ZzOjAsYXNjOjYsZHNjOjQsZGF0YTpuZXcgVWludDhBcnJheShbMiwyMSw4XSkgfVxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4sbnVsbFxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjAsdzo3LG9mczowLGFzYzowLGRzYzowfVxyXG4se3N6OjUsdzo3LG9mczowLGFzYzo0LGRzYzo0LGRhdGE6bmV3IFVpbnQ4QXJyYXkoWzMxXSkgfVxyXG5dIH07XHJcblxyXG5Wb3hlbGFyaXVtLkZvbnRzLlRJOTkgPSBmb250O1xyXG4iLCJcclxuaWYoIE51bWJlcihUSFJFRS5SRVZJU0lPTikgPj0gNzYgKSB7XHJcblx0dmFyIGNvdW50X2lzX2dldHRlciA9IGZhbHNlO1xyXG4gIE9iamVjdC5mcmVlemUoIGNvdW50X2lzX2dldHRlciApO1xyXG59XHJcbmVsc2Uge1xyXG5cdHZhciBjb3VudF9pc19nZXR0ZXIgPSB0cnVlO1xyXG4gIE9iamVjdC5mcmVlemUoIGNvdW50X2lzX2dldHRlciApO1xyXG59XHJcblxyXG5jb25zdCBhdHRyaWJzID0gWyB7IG5hbWU6XCJwb3NpdGlvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJ5dGVzOjQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTozLFxyXG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZTpmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBidWZ0eXBlOkZsb2F0MzJBcnJheSB9LFxyXG4gICAgICAgICAgICAgICAgICB7IG5hbWU6XCJ1dlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJ5dGVzOjQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZToyLFxyXG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZTpmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBidWZ0eXBlOkZsb2F0MzJBcnJheSB9LFxyXG4gICAgICAgICAgICAgICAgICB7IG5hbWU6XCJjb2xvclwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJ5dGVzOjQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTo0LFxyXG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZTpmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBidWZ0eXBlOkZsb2F0MzJBcnJheSB9LFxyXG4gICAgICAgICAgICAgICAgICB7IG5hbWU6XCJub3JtYWxcIixcclxuICAgICAgICAgICAgICAgICAgICBieXRlczo0LFxyXG4gICAgICAgICAgICAgICAgICAgIHNpemU6MyxcclxuICAgICAgICAgICAgICAgICAgICBub3JtYWxpemU6ZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgYnVmdHlwZTpGbG9hdDMyQXJyYXkgfSxcclxuXHJcbi8vLCBcImluX0ZhY2VDb2xvclwiLCBcImluX01vZHVsb3VzXCJcclxuLy8sIFwiaW5fUG93XCJcclxuLy8sIFwiaW5fZmxhdF9jb2xvclwiLCBcImluX3VzZV90ZXh0dXJlXCIsIFwiaW5fZGVjYWxfdGV4dHVyZVwiXHJcbl07XHJcblxyXG5cclxuVm94ZWxhcml1bS5HZW9tZXRyeUJhc2ljQnVmZmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGJ1ZmZlciA9IHt9O1xyXG4gICAgIGJ1ZmZlci5nZW9tZXRyeSA9IG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpO1xyXG5cclxuICAgICBidWZmZXIuZ2VvbWV0cnkudW5pZm9ybXMgPSB7XHJcbiAgICAgICAgICAgICBlZGdlX29ubHkgOiBmYWxzZSxcclxuICAgICBcdH07XHJcblxyXG4gICAgLy8gY3JlYXRlIGEgc2ltcGxlIHNxdWFyZSBzaGFwZS4gV2UgZHVwbGljYXRlIHRoZSB0b3AgbGVmdCBhbmQgYm90dG9tIHJpZ2h0XHJcbiAgICAvLyB2ZXJ0aWNlcyBiZWNhdXNlIGVhY2ggdmVydGV4IG5lZWRzIHRvIGFwcGVhciBvbmNlIHBlciB0cmlhbmdsZS5cclxuICAgIGJ1ZmZlci5wb3NpdGlvbiA9IG5ldyBGbG9hdDMyQXJyYXkoIFtdICk7XHJcbiAgICBidWZmZXIudXYgPSBuZXcgRmxvYXQzMkFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmNvbG9yID0gbmV3IEZsb2F0MzJBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5ub3JtYWwgPSBuZXcgRmxvYXQzMkFycmF5KCBbXSApO1xyXG4gICAgLypcclxuICAgIGJ1ZmZlci5pbl9GYWNlQ29sb3IgPSBuZXcgVWludDhBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl9Qb3cgPSBuZXcgVWludDhBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl91c2VfdGV4dHVyZSA9IG5ldyBVaW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmluX2ZsYXRfY29sb3IgPSBuZXcgVWludDhBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl9kZWNhbF90ZXh0dXJlID0gbmV3IFVpbnQ4QXJyYXkoIFtdICk7XHJcbiAgICBidWZmZXIuaW5fTW9kdWxvdXMgPSBuZXcgSW50OEFycmF5KCBbXSApO1xyXG4gICAgKi9cclxuICAgIGJ1ZmZlci5hdmFpbGFibGUgPSAwO1xyXG4gICAgYnVmZmVyLnVzZWQgPSAwO1xyXG5cclxuICAgIGJ1ZmZlci5jbGVhciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMudXNlZCA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgYXR0cmlicy5mb3JFYWNoKCAoYXR0KT0+e1xyXG4gICAgICBidWZmZXIuZ2VvbWV0cnkuYWRkQXR0cmlidXRlKCBhdHQubmFtZSwgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYnVmZmVyW2F0dC5uYW1lXSwgYXR0LnNpemUsIGF0dC5ub3JtYWxpemUgKSlcclxuICAgIH0pXHJcblxyXG5cclxuICAgICBidWZmZXIuZXhwYW5kID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgIHZhciBuZXdidWY7XHJcbiAgICAgICAgIHRoaXMuYXZhaWxhYmxlID0gKCB0aGlzLmF2YWlsYWJsZSArIDEgKSAqIDI7XHJcblxyXG4gICAgICAgICAgYXR0cmlicy5mb3JFYWNoKCAoYXR0cmliKT0+e1xyXG4gICAgICAgICAgICBuZXdidWYgPSAgIG5ldyBhdHRyaWIuYnVmdHlwZSggbmV3IEFycmF5QnVmZmVyKCB0aGlzLmF2YWlsYWJsZSAqICggYXR0cmliLmJ5dGVzICogYXR0cmliLnNpemUgKSApICk7XHJcbiAgICAgICAgICAgIG5ld2J1Zi5zZXQoIGJ1ZmZlclthdHRyaWIubmFtZV0gKTtcclxuICAgICAgICAgICAgYnVmZmVyW2F0dHJpYi5uYW1lXSA9IG5ld2J1ZjtcclxuICAgICAgICAgIH0pXHJcbiAgICAgfTtcclxuXHJcbiAgICAgYnVmZmVyLm1hcmtEaXJ0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLmdlb21ldHJ5LmRyYXdSYW5nZS5jb3VudCA9IHRoaXMudXNlZDtcclxuICAgICAgICAgYXR0cmlicy5mb3JFYWNoKCAoYXR0cmliKT0+e1xyXG4gICAgICAgICAgICAgdmFyIGF0dHJpYnUgPSB0aGlzLmdlb21ldHJ5LmdldEF0dHJpYnV0ZShhdHRyaWIubmFtZSk7XHJcbiAgICAgICAgICAgICBhdHRyaWJ1Lm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgIGF0dHJpYnUuYXJyYXkgPSBidWZmZXJbYXR0cmliLm5hbWVdO1xyXG4gICAgICAgICAgICAgaWYoICFjb3VudF9pc19nZXR0ZXIgKVxyXG4gICAgICAgICAgICAgICAgYXR0cmlidS5jb3VudCA9IHRoaXMudXNlZDtcclxuICAgICAgICAgfSlcclxuICAgICAgICAgLy9jb25zb2xlLmxvZyggXCJkaXJ0eVwiLCB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMgKTtcclxuICAgICB9XHJcblxyXG4gICAgIGJ1ZmZlci5hZGRQb2ludCA9IGZ1bmN0aW9uKCB2LCB0LCB0QmFzZSwgYywgZmMsIG4sIHAsIHV0LCBmbGF0LCBkdCwgbW9kICkge1xyXG4gICAgICAgICBpZiggdGhpcy51c2VkID49IHRoaXMuYXZhaWxhYmxlIClcclxuICAgICAgICAgICAgdGhpcy5leHBhbmQoKTtcclxuICAgICAgICAgICAgY29uc3QgdTIgPSB0aGlzLnVzZWQgKiAyO1xyXG4gICAgICAgICAgICBjb25zdCB1MyA9IHRoaXMudXNlZCAqIDM7XHJcbiAgICAgICAgICAgIGNvbnN0IHU0ID0gdGhpcy51c2VkICogNDtcclxuICAgICAgICBpZiggdCApIHtcclxuICAgICAgICAgICAgdGhpcy51dlt1MiswXSA9IHRbdEJhc2UrMF07XHJcbiAgICAgICAgICAgIHRoaXMudXZbdTIrMV0gPSB0W3RCYXNlKzFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy51dlt1MiswXSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMudXZbdTIrMV0gPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBvc2l0aW9uW3UzICsgMCBdID0gdi54O1xyXG4gICAgICAgIHRoaXMucG9zaXRpb25bdTMgKyAxIF0gPSB2Lnk7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvblt1MyArIDIgXSA9IHYuejtcclxuXHJcbiAgICAgICAgICB0aGlzLmNvbG9yW3U0ICsgMCBdID0gMTtcclxuICAgICAgICAgIHRoaXMuY29sb3JbdTQgKyAxIF0gPSAxO1xyXG4gICAgICAgICAgdGhpcy5jb2xvclt1NCArIDIgXSA9IDE7XHJcbiAgICAgICAgICB0aGlzLmNvbG9yW3U0ICsgMyBdID0gMTtcclxuXHJcbiAgICAgICAgdGhpcy5ub3JtYWxbdTMgKyAwXSA9IG4/bi54OjA7XHJcbiAgICAgICAgdGhpcy5ub3JtYWxbdTMgKyAxXSA9IG4/bi55OjA7XHJcbiAgICAgICAgdGhpcy5ub3JtYWxbdTMgKyAyXSA9IG4/bi56OjE7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgaWYoIGZjICkge1xyXG4gICAgICAgIHRoaXMuaW5fRmFjZUNvbG9yW3U0ICsgMCBdID0gZmMueCoyNTU7XHJcbiAgICAgICAgdGhpcy5pbl9GYWNlQ29sb3JbdTQgKyAxIF0gPSBmYy55KjI1NTtcclxuICAgICAgICB0aGlzLmluX0ZhY2VDb2xvclt1NCArIDIgXSA9IGZjLnoqMjU1O1xyXG4gICAgICAgIHRoaXMuaW5fRmFjZUNvbG9yW3U0ICsgMyBdID0gZmMudyoyNTU7IH1cclxuXHJcbiAgICAgICAgdGhpcy5pbl9Qb3dbIHRoaXMudXNlZCBdID0gcDtcclxuICAgICAgICB0aGlzLmluX3VzZV90ZXh0dXJlWyB0aGlzLnVzZWQgXSA9IHV0O1xyXG4gICAgICAgIHRoaXMuaW5fZmxhdF9jb2xvclt0aGlzLnVzZWRdID0gZmxhdDtcclxuICAgICAgICB0aGlzLmluX2RlY2FsX3RleHR1cmVbdGhpcy51c2VkXSA9IGR0O1xyXG4gICAgICAgIHRoaXMuaW5fTW9kdWxvdXNbdGhpcy51c2VkICogMiArIDBdID0gbW9kWzBdO1xyXG4gICAgICAgIHRoaXMuaW5fTW9kdWxvdXNbdGhpcy51c2VkICogMiArIDFdID0gbW9kWzFdO1xyXG4qL1xyXG4gICAgICAgIHRoaXMudXNlZCsrO1xyXG4gICAgfTtcclxuXHJcbiAgICAgLy9idWZmZXIuXHJcblxyXG4gICAgIGJ1ZmZlci5BZGRRdWFkID0gZnVuY3Rpb24oIG5vcm0sIFAxLFAyLFAzLFA0LGZhY2VDb2xvcixjb2xvcixwb3cgKSB7XHJcblxyXG4gICAgICAgICBjb25zdCBtaW4gPSAwO1xyXG4gICAgICAgICBjb25zdCBtYXggPSAxO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBQMSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21pbixtaW5dICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFAyLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttaW4sbWF4XSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBQMiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21heCxtaW5dICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFA0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttaW4sbWF4XSApO1xyXG4gICAgIH1cclxuICAgICBidWZmZXIuQWRkUXVhZFRleHR1cmUgPSBmdW5jdGlvbiggbm9ybSwgUDEsUDIsUDMsUDQsdGV4dHVyZUNvb3JkcyApIHtcclxuICAgICAgICAgY29uc3QgbWluID0gMDtcclxuICAgICAgICAgY29uc3QgbWF4ID0gMTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDEsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDAsIHdoaXRlLCB1bmRlZmluZWQsIG5vcm0sIHVuZGVmaW5lZCwgMjU1LCBmYWxzZSwgZmFsc2UsIFttaW4sbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBQMiwgdGV4dHVyZUNvb3Jkcy51dl9hcnJheSwgMiwgd2hpdGUsIHVuZGVmaW5lZCwgbm9ybSwgdW5kZWZpbmVkLCAyNTUsIGZhbHNlLCBmYWxzZSwgW21heCxtaW5dICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFAzLCB0ZXh0dXJlQ29vcmRzLnV2X2FycmF5LCA0LCB3aGl0ZSwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDIsIHdoaXRlLCB1bmRlZmluZWQsIG5vcm0sIHVuZGVmaW5lZCwgMjU1LCBmYWxzZSwgZmFsc2UsIFttYXgsbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBQNCwgdGV4dHVyZUNvb3Jkcy51dl9hcnJheSwgNiwgd2hpdGUsIHVuZGVmaW5lZCwgbm9ybSwgdW5kZWZpbmVkLCAyNTUsIGZhbHNlLCBmYWxzZSwgW21heCxtYXhdICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFAzLCB0ZXh0dXJlQ29vcmRzLnV2X2FycmF5LCA0LCB3aGl0ZSwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICB9XHJcbiAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQgPSBmdW5jdGlvbiggcXVhZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93ICkge1xyXG4gICAgICAgICB2YXIgbWluID0gMDtcclxuICAgICAgICAgdmFyIG1heCA9IDE7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMF0sIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttaW4sbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzFdLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsyXSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21pbixtYXhdICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMV0sIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttYXgsbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzNdLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsyXSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21pbixtYXhdICk7XHJcbiAgICAgfVxyXG4gICAgIGNvbnN0IHdoaXRlID0gbmV3IFRIUkVFLlZlY3RvcjQoIDAuNSwgMC41LCAwLjUsIDEgKTtcclxuICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZFRleCA9IGZ1bmN0aW9uKCBxdWFkLCB1dnMsIG5vcm0sIHBvdyApIHtcclxuICAgICAgICAgdmFyIG1pbiA9IDA7XHJcbiAgICAgICAgIHZhciBtYXggPSAxLjA7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMF0sIHV2cywgMCwgd2hpdGUsIHdoaXRlLCBub3JtLCBwb3csIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsxXSwgdXZzLCAyLCB3aGl0ZSwgd2hpdGUsIG5vcm0sIHBvdywgMjU1LCBmYWxzZSwgZmFsc2UsIFttYXgsbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzJdLCB1dnMsIDQsIHdoaXRlLCB3aGl0ZSwgbm9ybSwgcG93LCAyNTUsIGZhbHNlLCBmYWxzZSwgW21pbixtYXhdICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMV0sIHV2cywgMiwgd2hpdGUsIHdoaXRlLCBub3JtLCBwb3csIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFszXSwgdXZzLCA2LCB3aGl0ZSwgd2hpdGUsIG5vcm0sIHBvdywgMjU1LCBmYWxzZSwgZmFsc2UsIFttYXgsbWF4XSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzJdLCB1dnMsIDQsIHdoaXRlLCB3aGl0ZSwgbm9ybSwgcG93LCAyNTUsIGZhbHNlLCBmYWxzZSwgW21pbixtYXhdICk7XHJcbiAgICAgfVxyXG5cclxuICAgICBidWZmZXIubWFrZVZveEN1YmUgPSBmdW5jdGlvbiggc2l6ZSwgdm94ZWxUeXBlICkge1xyXG4gICAgICAgIHZhciB2MSA9IG5ldyBUSFJFRS5WZWN0b3IzKDEsMSwxKTtcclxuICAgICAgICB2YXIgdjIgPSBuZXcgVEhSRUUuVmVjdG9yMygtMSwxLDEpO1xyXG4gICAgICAgIHZhciB2MyA9IG5ldyBUSFJFRS5WZWN0b3IzKDEsLTEsMSk7XHJcbiAgICAgICAgdmFyIHY0ID0gbmV3IFRIUkVFLlZlY3RvcjMoLTEsLTEsMSk7XHJcbiAgICAgICAgdmFyIHY1ID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwxLC0xKTtcclxuICAgICAgICB2YXIgdjYgPSBuZXcgVEhSRUUuVmVjdG9yMygtMSwxLC0xKTtcclxuICAgICAgICB2YXIgdjcgPSBuZXcgVEhSRUUuVmVjdG9yMygxLC0xLC0xKTtcclxuICAgICAgICB2YXIgdjggPSBuZXcgVEhSRUUuVmVjdG9yMygtMSwtMSwtMSk7XHJcbiAgICAgICAgdmFyIHF1YWQ7XHJcbiAgICAgICAgaWYoIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUuaW1hZ2UgKSB7XHJcbiAgICAgICAgICAgIHZhciBpbl91dnMgPSB2b3hlbFR5cGUudGV4dHVyZUNvb3Jkcy51dnM7XHJcbiAgICAgICAgICAgIHZhciB1dnMgPSB2b3hlbFR5cGUudGV4dHVyZUNvb3Jkcy51dl9hcnJheTtcclxuICAgICAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWRUZXgoIHF1YWQ9W3YxLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjIuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAsIHV2c1xyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzRm9yd2FyZFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgLy9xdWFkWzBdLmRlbGV0ZSgpOyBxdWFkWzFdLmRlbGV0ZSgpOyBxdWFkWzJdLmRlbGV0ZSgpOyBxdWFkWzNdLmRlbGV0ZSgpO1xyXG5cclxuICAgICAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWRUZXgoIHF1YWQgPSBbdjYuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2NS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY4LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlLnRleHR1cmVDb29yZHMudXZzXHJcbiAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNCYWNrd2FyZFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgLy9xdWFkWzBdLmRlbGV0ZSgpOyBxdWFkWzFdLmRlbGV0ZSgpOyBxdWFkWzJdLmRlbGV0ZSgpOyBxdWFkWzNdLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZFRleCggcXVhZCA9IFt2NS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY2LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjEuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Mi5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlLnRleHR1cmVDb29yZHMudXZzXHJcbiAgICAgICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzVXBcclxuICAgICAgICAgICAgICAgICAgICAsIDIwMCApXHJcbiAgICAgICAgICAgICAgICAgIC8vICBxdWFkWzBdLmRlbGV0ZSgpOyBxdWFkWzFdLmRlbGV0ZSgpOyBxdWFkWzJdLmRlbGV0ZSgpOyBxdWFkWzNdLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZFRleCggcXVhZCA9IFt2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2OC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlLnRleHR1cmVDb29yZHMudXZzXHJcbiAgICAgICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzRG93blxyXG4gICAgICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgICAgICAgICAgICAvL3F1YWRbMF0uZGVsZXRlKCk7IHF1YWRbMV0uZGVsZXRlKCk7IHF1YWRbMl0uZGVsZXRlKCk7IHF1YWRbM10uZGVsZXRlKCk7XHJcbiAgICAgICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkVGV4KCBxdWFkID0gW3Y1LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjEuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ny5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYzLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUudGV4dHVyZUNvb3Jkcy51dnNcclxuICAgICAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNSaWdodFxyXG4gICAgICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgICAgICAgICAgICAvL3F1YWRbMF0uZGVsZXRlKCk7IHF1YWRbMV0uZGVsZXRlKCk7IHF1YWRbMl0uZGVsZXRlKCk7IHF1YWRbM10uZGVsZXRlKCk7XHJcbiAgICAgICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkVGV4KCBxdWFkID0gW3YyLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjYuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2NC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY4LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUudGV4dHVyZUNvb3Jkcy51dnNcclxuICAgICAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNMZWZ0XHJcbiAgICAgICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgICAgIC8vcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuXHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkKCBxdWFkPVt2MS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYyLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjMuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2NC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5FZGdlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDAuMiwgMC4wLCAxLCAxLjAgKVxyXG4gICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5GYWNlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDAuNSApXHJcbiAgICAgICAgICAgICwgVEhSRUUuVmVjdG9yM0ZvcndhcmRcclxuICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAvL3F1YWRbMF0uZGVsZXRlKCk7IHF1YWRbMV0uZGVsZXRlKCk7IHF1YWRbMl0uZGVsZXRlKCk7IHF1YWRbM10uZGVsZXRlKCk7XHJcbiAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQoIHF1YWQgPSBbdjYuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2NS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY4LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRWRnZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAwLjIsIDEsIDAsIDEuMCApXHJcbiAgICAgICAgICAgICwgdm94ZWxUeXBlICYmIHZveGVsVHlwZS5wcm9wZXJ0aWVzLkZhY2VDb2xvciB8fCBuZXcgVEhSRUUuVmVjdG9yNCggMCwgMCwgMCwgMC41IClcclxuICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzQmFja3dhcmRcclxuICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAvL3F1YWRbMF0uZGVsZXRlKCk7IHF1YWRbMV0uZGVsZXRlKCk7IHF1YWRbMl0uZGVsZXRlKCk7IHF1YWRbM10uZGVsZXRlKCk7XHJcbiAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQoIHF1YWQgPSBbdjUuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ni5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYxLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjIuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlICYmIHZveGVsVHlwZS5wcm9wZXJ0aWVzLkVkZ2VDb2xvciB8fCBuZXcgVEhSRUUuVmVjdG9yNCggMSwgMC4wLCAwLCAxLjAgKVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRmFjZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAwLCAwLCAwLjUgKVxyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzVXBcclxuICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgIC8vICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZCggcXVhZCA9IFt2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2OC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRWRnZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAxLCAxLCAxLjAgKVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRmFjZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAwLCAwLCAwLjUgKVxyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzRG93blxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAvLyAgICBxdWFkWzBdLmRlbGV0ZSgpOyBxdWFkWzFdLmRlbGV0ZSgpOyBxdWFkWzJdLmRlbGV0ZSgpOyBxdWFkWzNdLmRlbGV0ZSgpO1xyXG4gICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkKCBxdWFkID0gW3Y1LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjEuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ny5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYzLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5FZGdlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDEsIDAuMCwgMSwgMS4wIClcclxuICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlICYmIHZveGVsVHlwZS5wcm9wZXJ0aWVzLkZhY2VDb2xvciB8fCBuZXcgVEhSRUUuVmVjdG9yNCggMCwgMCwgMCwgMC41IClcclxuICAgICAgICAgICAgICAgICwgVEhSRUUuVmVjdG9yM1JpZ2h0XHJcbiAgICAgICAgICAgICAgICAsIDIwMCApXHJcbiAgICAgICAgICAgIC8vICAgIHF1YWRbMF0uZGVsZXRlKCk7IHF1YWRbMV0uZGVsZXRlKCk7IHF1YWRbMl0uZGVsZXRlKCk7IHF1YWRbM10uZGVsZXRlKCk7XHJcbiAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQoIHF1YWQgPSBbdjIuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ni5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjguY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlICYmIHZveGVsVHlwZS5wcm9wZXJ0aWVzLkVkZ2VDb2xvciB8fCBuZXcgVEhSRUUuVmVjdG9yNCggMSwgMSwgMCwgMS4wIClcclxuICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlICYmIHZveGVsVHlwZS5wcm9wZXJ0aWVzLkZhY2VDb2xvciB8fCBuZXcgVEhSRUUuVmVjdG9yNCggMCwgMCwgMCwgMC41IClcclxuICAgICAgICAgICAgICAgICwgVEhSRUUuVmVjdG9yM0xlZnRcclxuICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgIC8vICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tYXJrRGlydHkoICApO1xyXG4gICAgIH1cclxuXHJcbiAgICAgLy92YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHsgY29sb3I6IDB4ZmYwMDAwIH0gKTtcclxuICAgICAvL3ZhciBtZXNoID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXRlcmlhbCApO1xyXG4gICAgIHJldHVybiBidWZmZXI7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uKCkge1xyXG4gICAgYnVmZmVyLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG59XHJcbiIsIlxyXG5jb25zdCBhdHRyaWJzID0gW1wicG9zaXRpb25cIixcInV2XCJcclxuLFwiaW5fQ29sb3JcIiwgXCJpbl9GYWNlQ29sb3JcIiwgXCJpbl9Nb2R1bG91c1wiXHJcbixcIm5vcm1hbFwiLCBcImluX1Bvd1wiLCBcImluX2ZsYXRfY29sb3JcIiwgXCJpbl91c2VfdGV4dHVyZVwiLCBcImluX2RlY2FsX3RleHR1cmVcIlxyXG5dO1xyXG5jb25zdCBhdHRyaWJfYnl0ZXMgPSAgICAgWzQsNCwxLDEsMSw0LDQsMSwxLDFdXHJcbmNvbnN0IGF0dHJpYl9zaXplcyA9ICAgICBbMywyLDQsNCwyLDMsMSwxLDEsMV1cclxuY29uc3QgYXR0cmliX25vcm1hbGl6ZSA9IFtmYWxzZSxmYWxzZSx0cnVlLHRydWUsMCwwLDAsMCwxLDBdXHJcbmNvbnN0IGF0dHJpYl9idWZ0eXBlID0gW0Zsb2F0MzJBcnJheSxGbG9hdDMyQXJyYXlcclxuICAgICxVaW50OEFycmF5LFVpbnQ4QXJyYXksVWludDhBcnJheVxyXG4gICAgLEZsb2F0MzJBcnJheSxGbG9hdDMyQXJyYXksVWludDhBcnJheSxVaW50OEFycmF5LCBVaW50OEFycmF5XVxyXG5cclxuVm94ZWxhcml1bS5HZW9tZXRyeUJ1ZmZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBidWZmZXIgPSB7fTtcclxuICAgICBidWZmZXIuZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQnVmZmVyR2VvbWV0cnkoKTtcclxuXHJcbiAgICAgYnVmZmVyLmdlb21ldHJ5LnVuaWZvcm1zID0ge1xyXG4gICAgICAgICAgICAgZWRnZV9vbmx5IDogZmFsc2UsXHJcbiAgICAgXHR9O1xyXG5cclxuICAgIC8vIGNyZWF0ZSBhIHNpbXBsZSBzcXVhcmUgc2hhcGUuIFdlIGR1cGxpY2F0ZSB0aGUgdG9wIGxlZnQgYW5kIGJvdHRvbSByaWdodFxyXG4gICAgLy8gdmVydGljZXMgYmVjYXVzZSBlYWNoIHZlcnRleCBuZWVkcyB0byBhcHBlYXIgb25jZSBwZXIgdHJpYW5nbGUuXHJcbiAgICBidWZmZXIucG9zaXRpb24gPSBuZXcgRmxvYXQzMkFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLnV2ID0gbmV3IEZsb2F0MzJBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl9Db2xvciA9IG5ldyBVaW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmluX0ZhY2VDb2xvciA9IG5ldyBVaW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLm5vcm1hbCA9IG5ldyBGbG9hdDMyQXJyYXkoIFtdICk7XHJcbiAgICBidWZmZXIuaW5fUG93ID0gbmV3IEZsb2F0MzJBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl91c2VfdGV4dHVyZSA9IG5ldyBVaW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmluX2ZsYXRfY29sb3IgPSBuZXcgVWludDhBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl9kZWNhbF90ZXh0dXJlID0gbmV3IFVpbnQ4QXJyYXkoIFtdICk7XHJcbiAgICBidWZmZXIuaW5fTW9kdWxvdXMgPSBuZXcgSW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmF2YWlsYWJsZSA9IDA7XHJcbiAgICBidWZmZXIudXNlZCA9IDA7XHJcblxyXG4gICAgYnVmZmVyLmNsZWFyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy51c2VkID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBhdHRyaWJzLmZvckVhY2goIChhdHQsaW5kZXgpPT57XHJcbiAgICAgIGJ1ZmZlci5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoIGF0dCwgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYnVmZmVyW2F0dF0sIGF0dHJpYl9zaXplc1tpbmRleF0sIGF0dHJpYl9ub3JtYWxpemVbaW5kZXhdICkpXHJcbiAgICB9KVxyXG5cclxuXHJcbiAgICAgYnVmZmVyLmV4cGFuZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICB2YXIgbmV3YnVmO1xyXG4gICAgICAgICB0aGlzLmF2YWlsYWJsZSA9ICggdGhpcy5hdmFpbGFibGUgKyAxICkgKiAyO1xyXG5cclxuICAgICAgICAgIGF0dHJpYnMuZm9yRWFjaCggKGF0dCxpbmRleCk9PntcclxuICAgICAgICAgICAgbmV3YnVmID0gICBuZXcgYXR0cmliX2J1ZnR5cGVbaW5kZXhdKCBuZXcgQXJyYXlCdWZmZXIoIHRoaXMuYXZhaWxhYmxlICogKCBhdHRyaWJfYnl0ZXNbaW5kZXhdICogYXR0cmliX3NpemVzW2luZGV4XSApICkgKTtcclxuICAgICAgICAgICAgbmV3YnVmLnNldCggYnVmZmVyW2F0dF0gKTtcclxuICAgICAgICAgICAgYnVmZmVyW2F0dF0gPSBuZXdidWY7XHJcbiAgICAgICAgICB9KVxyXG4gICAgIH07XHJcblxyXG4gICAgIGJ1ZmZlci5tYXJrRGlydHkgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgICBhdHRyaWJzLmZvckVhY2goIChhdHQpPT57XHJcbiAgICAgICAgICAgICB2YXIgYXR0cmliID0gdGhpcy5nZW9tZXRyeS5nZXRBdHRyaWJ1dGUoYXR0KTtcclxuICAgICAgICAgICAgIGF0dHJpYi5uZWVkc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICBhdHRyaWIuYXJyYXkgPSBidWZmZXJbYXR0XTtcclxuICAgICAgICAgICAgIGF0dHJpYi5jb3VudCA9IGJ1ZmZlci51c2VkO1xyXG4gICAgICAgICB9KVxyXG4gICAgICAgICAvL2NvbnNvbGUubG9nKCBcImRpcnR5XCIsIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcyApO1xyXG4gICAgIH1cclxuXHJcbiAgICAgYnVmZmVyLmFkZFBvaW50ID0gZnVuY3Rpb24oIHYsIHQsIHRCYXNlLCBjLCBmYywgbiwgcCwgdXQsIGZsYXQsIGR0LCBtb2QgKSB7XHJcbiAgICAgICAgIGlmKCB0aGlzLnVzZWQgPj0gdGhpcy5hdmFpbGFibGUgKVxyXG4gICAgICAgICAgICB0aGlzLmV4cGFuZCgpO1xyXG4gICAgICAgICAgICBjb25zdCB1MiA9IHRoaXMudXNlZCAqIDI7XHJcbiAgICAgICAgICAgIGNvbnN0IHUzID0gdGhpcy51c2VkICogMztcclxuICAgICAgICAgICAgY29uc3QgdTQgPSB0aGlzLnVzZWQgKiA0O1xyXG4gICAgICAgIGlmKCB0ICkge1xyXG4gICAgICAgICAgICB0aGlzLnV2W3UyKzBdID0gdFt0QmFzZSswXTtcclxuICAgICAgICAgICAgdGhpcy51dlt1MisxXSA9IHRbdEJhc2UrMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnV2W3UyKzBdID0gMDtcclxuICAgICAgICAgICAgdGhpcy51dlt1MisxXSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucG9zaXRpb25bdTMgKyAwIF0gPSB2Lng7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvblt1MyArIDEgXSA9IHYueTtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uW3UzICsgMiBdID0gdi56O1xyXG4gICAgICAgIGlmKCBjICkge1xyXG4gICAgICAgIHRoaXMuaW5fQ29sb3JbdTQgKyAwIF0gPSBjLngqMjU1O1xyXG4gICAgICAgIHRoaXMuaW5fQ29sb3JbdTQgKyAxIF0gPSBjLnkqMjU1O1xyXG4gICAgICAgIHRoaXMuaW5fQ29sb3JbdTQgKyAyIF0gPSBjLnoqMjU1O1xyXG4gICAgICAgIHRoaXMuaW5fQ29sb3JbdTQgKyAzIF0gPSBjLncqMjU1OyB9XHJcblxyXG4gICAgICAgIGlmKCBmYyApIHtcclxuICAgICAgICB0aGlzLmluX0ZhY2VDb2xvclt1NCArIDAgXSA9IGZjLngqMjU1O1xyXG4gICAgICAgIHRoaXMuaW5fRmFjZUNvbG9yW3U0ICsgMSBdID0gZmMueSoyNTU7XHJcbiAgICAgICAgdGhpcy5pbl9GYWNlQ29sb3JbdTQgKyAyIF0gPSBmYy56KjI1NTtcclxuICAgICAgICB0aGlzLmluX0ZhY2VDb2xvclt1NCArIDMgXSA9IGZjLncqMjU1OyB9XHJcblxyXG4gICAgICAgIHRoaXMubm9ybWFsW3UzICsgMF0gPSBuP24ueDowO1xyXG4gICAgICAgIHRoaXMubm9ybWFsW3UzICsgMV0gPSBuP24ueTowO1xyXG4gICAgICAgIHRoaXMubm9ybWFsW3UzICsgMl0gPSBuP24uejoxO1xyXG5cclxuICAgICAgICB0aGlzLmluX1Bvd1sgdGhpcy51c2VkIF0gPSBwO1xyXG4gICAgICAgIHRoaXMuaW5fdXNlX3RleHR1cmVbIHRoaXMudXNlZCBdID0gdXQ7XHJcbiAgICAgICAgdGhpcy5pbl9mbGF0X2NvbG9yW3RoaXMudXNlZF0gPSBmbGF0O1xyXG4gICAgICAgIHRoaXMuaW5fZGVjYWxfdGV4dHVyZVt0aGlzLnVzZWRdID0gZHQ7XHJcbiAgICAgICAgdGhpcy5pbl9Nb2R1bG91c1t0aGlzLnVzZWQgKiAyICsgMF0gPSBtb2RbMF07XHJcbiAgICAgICAgdGhpcy5pbl9Nb2R1bG91c1t0aGlzLnVzZWQgKiAyICsgMV0gPSBtb2RbMV07XHJcblxyXG4gICAgICAgIHRoaXMudXNlZCsrO1xyXG4gICAgfTtcclxuXHJcbiAgICAgLy9idWZmZXIuXHJcblxyXG4gICAgIGJ1ZmZlci5BZGRRdWFkID0gZnVuY3Rpb24oIG5vcm0sIFAxLFAyLFAzLFA0LGZhY2VDb2xvcixjb2xvcixwb3cgKSB7XHJcblxyXG4gICAgICAgICBjb25zdCBtaW4gPSAwO1xyXG4gICAgICAgICBjb25zdCBtYXggPSAxO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBQMSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21pbixtaW5dICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFAyLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttaW4sbWF4XSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBQMiwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21heCxtaW5dICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFA0LCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttaW4sbWF4XSApO1xyXG4gICAgIH1cclxuICAgICBidWZmZXIuQWRkUXVhZFRleHR1cmUgPSBmdW5jdGlvbiggbm9ybSwgUDEsUDIsUDMsUDQsdGV4dHVyZUNvb3JkcyApIHtcclxuICAgICAgICAgY29uc3QgbWluID0gMDtcclxuICAgICAgICAgY29uc3QgbWF4ID0gMTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDEsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDAsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDQsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDYsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsIHRleHR1cmVDb29yZHMudXZfYXJyYXksIDQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBub3JtLCB1bmRlZmluZWQsIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICB9XHJcbiAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQgPSBmdW5jdGlvbiggcXVhZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93ICkge1xyXG4gICAgICAgICB2YXIgbWluID0gMDtcclxuICAgICAgICAgdmFyIG1heCA9IDE7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMF0sIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttaW4sbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzFdLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsyXSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21pbixtYXhdICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMV0sIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBjb2xvciwgZmFjZUNvbG9yLCBub3JtLCBwb3csIGZhbHNlLCBmYWxzZSwgZmFsc2UsIFttYXgsbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzNdLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29sb3IsIGZhY2VDb2xvciwgbm9ybSwgcG93LCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsyXSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNvbG9yLCBmYWNlQ29sb3IsIG5vcm0sIHBvdywgZmFsc2UsIGZhbHNlLCBmYWxzZSwgW21pbixtYXhdICk7XHJcbiAgICAgfVxyXG4gICAgIGNvbnN0IHdoaXRlID0gbmV3IFRIUkVFLlZlY3RvcjQoIDAuNSwgMCwgMCwgMSApO1xyXG4gICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkVGV4ID0gZnVuY3Rpb24oIHF1YWQsIHV2cywgbm9ybSwgcG93ICkge1xyXG4gICAgICAgICB2YXIgbWluID0gMDtcclxuICAgICAgICAgdmFyIG1heCA9IDEuMDtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFswXSwgdXZzLCAwLCB3aGl0ZSwgd2hpdGUsIG5vcm0sIHBvdywgMjU1LCBmYWxzZSwgZmFsc2UsIFttaW4sbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzFdLCB1dnMsIDIsIHdoaXRlLCB3aGl0ZSwgbm9ybSwgcG93LCAyNTUsIGZhbHNlLCBmYWxzZSwgW21heCxtaW5dICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMl0sIHV2cywgNCwgd2hpdGUsIHdoaXRlLCBub3JtLCBwb3csIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsxXSwgdXZzLCAyLCB3aGl0ZSwgd2hpdGUsIG5vcm0sIHBvdywgMjU1LCBmYWxzZSwgZmFsc2UsIFttYXgsbWluXSApO1xyXG4gICAgICAgICB0aGlzLmFkZFBvaW50KCBxdWFkWzNdLCB1dnMsIDYsIHdoaXRlLCB3aGl0ZSwgbm9ybSwgcG93LCAyNTUsIGZhbHNlLCBmYWxzZSwgW21heCxtYXhdICk7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIHF1YWRbMl0sIHV2cywgNCwgd2hpdGUsIHdoaXRlLCBub3JtLCBwb3csIDI1NSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICB9XHJcblxyXG4gICAgIGJ1ZmZlci5tYWtlVm94Q3ViZSA9IGZ1bmN0aW9uKCBzaXplLCB2b3hlbFR5cGUgKSB7XHJcbiAgICAgICAgdmFyIHYxID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwxLDEpO1xyXG4gICAgICAgIHZhciB2MiA9IG5ldyBUSFJFRS5WZWN0b3IzKC0xLDEsMSk7XHJcbiAgICAgICAgdmFyIHYzID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwtMSwxKTtcclxuICAgICAgICB2YXIgdjQgPSBuZXcgVEhSRUUuVmVjdG9yMygtMSwtMSwxKTtcclxuICAgICAgICB2YXIgdjUgPSBuZXcgVEhSRUUuVmVjdG9yMygxLDEsLTEpO1xyXG4gICAgICAgIHZhciB2NiA9IG5ldyBUSFJFRS5WZWN0b3IzKC0xLDEsLTEpO1xyXG4gICAgICAgIHZhciB2NyA9IG5ldyBUSFJFRS5WZWN0b3IzKDEsLTEsLTEpO1xyXG4gICAgICAgIHZhciB2OCA9IG5ldyBUSFJFRS5WZWN0b3IzKC0xLC0xLC0xKTtcclxuICAgICAgICB2YXIgcXVhZDtcclxuICAgICAgICBpZiggdm94ZWxUeXBlICYmIHZveGVsVHlwZS5pbWFnZVxyXG5cdFx0XHRcdCAgICYmICgoIHZveGVsVHlwZS5wcm9wZXJ0aWVzLkRyYXdJbmZvICYgVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fU0hBREVSICkgPT0gMCApXHJcbiAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHZhciBpbl91dnMgPSB2b3hlbFR5cGUudGV4dHVyZUNvb3Jkcy51dnM7XHJcbiAgICAgICAgICAgIHZhciB1dnMgPSB2b3hlbFR5cGUudGV4dHVyZUNvb3Jkcy51dl9hcnJheTtcclxuICAgICAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWRUZXgoIHF1YWQ9W3YxLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjIuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAsIHV2c1xyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzRm9yd2FyZFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuXHJcbiAgICAgICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkVGV4KCBxdWFkID0gW3Y2LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjUuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2OC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY3LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAsIHZveGVsVHlwZS50ZXh0dXJlQ29vcmRzLnV2c1xyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzQmFja3dhcmRcclxuICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgICAgICAgIHF1YWRbMF0uZGVsZXRlKCk7IHF1YWRbMV0uZGVsZXRlKCk7IHF1YWRbMl0uZGVsZXRlKCk7IHF1YWRbM10uZGVsZXRlKCk7XHJcbiAgICAgICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkVGV4KCBxdWFkID0gW3Y1LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjYuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2MS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYyLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUudGV4dHVyZUNvb3Jkcy51dnNcclxuICAgICAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNVcFxyXG4gICAgICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgICAgICAgICAgICBxdWFkWzBdLmRlbGV0ZSgpOyBxdWFkWzFdLmRlbGV0ZSgpOyBxdWFkWzJdLmRlbGV0ZSgpOyBxdWFkWzNdLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZFRleCggcXVhZCA9IFt2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2OC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlLnRleHR1cmVDb29yZHMudXZzXHJcbiAgICAgICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzRG93blxyXG4gICAgICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgICAgICAgICAgICBxdWFkWzBdLmRlbGV0ZSgpOyBxdWFkWzFdLmRlbGV0ZSgpOyBxdWFkWzJdLmRlbGV0ZSgpOyBxdWFkWzNdLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZFRleCggcXVhZCA9IFt2NS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYxLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgICAgICwgdm94ZWxUeXBlLnRleHR1cmVDb29yZHMudXZzXHJcbiAgICAgICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzUmlnaHRcclxuICAgICAgICAgICAgICAgICAgICAsIDIwMCApXHJcbiAgICAgICAgICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWRUZXgoIHF1YWQgPSBbdjIuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ni5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjguY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgICAgICAgICAsIHZveGVsVHlwZS50ZXh0dXJlQ29vcmRzLnV2c1xyXG4gICAgICAgICAgICAgICAgICAgICwgVEhSRUUuVmVjdG9yM0xlZnRcclxuICAgICAgICAgICAgICAgICAgICAsIDIwMCApXHJcbiAgICAgICAgICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuXHJcbiAgICAgICAgfWVsc2Uge1xyXG4gICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkKCBxdWFkPVt2MS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYyLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjMuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2NC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5FZGdlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDAuMiwgMC4wLCAxLCAxLjAgKVxyXG4gICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5GYWNlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDAuNSApXHJcbiAgICAgICAgICAgICwgVEhSRUUuVmVjdG9yM0ZvcndhcmRcclxuICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICBxdWFkWzBdLmRlbGV0ZSgpOyBxdWFkWzFdLmRlbGV0ZSgpOyBxdWFkWzJdLmRlbGV0ZSgpOyBxdWFkWzNdLmRlbGV0ZSgpO1xyXG4gICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkKCBxdWFkID0gW3Y2LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjUuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2OC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY3LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICwgdm94ZWxUeXBlICYmIHZveGVsVHlwZS5wcm9wZXJ0aWVzLkVkZ2VDb2xvciB8fCBuZXcgVEhSRUUuVmVjdG9yNCggMC4yLCAxLCAwLCAxLjAgKVxyXG4gICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5GYWNlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDAuNSApXHJcbiAgICAgICAgICAgICwgVEhSRUUuVmVjdG9yM0JhY2t3YXJkXHJcbiAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZCggcXVhZCA9IFt2NS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY2LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjEuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Mi5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRWRnZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAxLCAwLjAsIDAsIDEuMCApXHJcbiAgICAgICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5GYWNlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDAuNSApXHJcbiAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNVcFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZCggcXVhZCA9IFt2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2OC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRWRnZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAxLCAxLCAxLjAgKVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRmFjZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAwLCAwLCAwLjUgKVxyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzRG93blxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZCggcXVhZCA9IFt2NS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYxLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRWRnZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAxLCAwLjAsIDEsIDEuMCApXHJcbiAgICAgICAgICAgICAgICAsIHZveGVsVHlwZSAmJiB2b3hlbFR5cGUucHJvcGVydGllcy5GYWNlQ29sb3IgfHwgbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDAuNSApXHJcbiAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNSaWdodFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZCggcXVhZCA9IFt2Mi5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY2LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjQuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2OC5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRWRnZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAxLCAxLCAwLCAxLjAgKVxyXG4gICAgICAgICAgICAgICAgLCB2b3hlbFR5cGUgJiYgdm94ZWxUeXBlLnByb3BlcnRpZXMuRmFjZUNvbG9yIHx8IG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAwLCAwLCAwLjUgKVxyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzTGVmdFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgICAgICAgICAgcXVhZFswXS5kZWxldGUoKTsgcXVhZFsxXS5kZWxldGUoKTsgcXVhZFsyXS5kZWxldGUoKTsgcXVhZFszXS5kZWxldGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tYXJrRGlydHkoICApO1xyXG4gICAgIH1cclxuXHJcbiAgICAgLy92YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoIHsgY29sb3I6IDB4ZmYwMDAwIH0gKTtcclxuICAgICAvL3ZhciBtZXNoID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXRlcmlhbCApO1xyXG4gICAgIHJldHVybiBidWZmZXI7XHJcbn1cclxuXHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uKCkge1xyXG4gICAgYnVmZmVyLmdlb21ldHJ5LmF0dHJpYnV0ZXMucG9zaXRpb24ubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG59XHJcbiIsIlxyXG5cclxuVm94ZWxhcml1bS5HZW9tZXRyeUJ1ZmZlck1vbm8gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYnVmZmVyID0ge307XHJcbiAgICAgYnVmZmVyLmdlb21ldHJ5ID0gbmV3IFRIUkVFLkJ1ZmZlckdlb21ldHJ5KCk7XHJcbiAgICAgYnVmZmVyLmdlb21ldHJ5LnVuaWZvcm1zID0ge1xyXG4gICAgICAgICAgICAgaW5fQ29sb3IgOiBuZXcgVEhSRUUuVmVjdG9yNCgxLDAsMCwxKSxcclxuICAgICAgICAgICAgIGluX0ZhY2VDb2xvciA6IG5ldyBUSFJFRS5WZWN0b3I0KDAsMSwwLDEpLFxyXG4gICAgICAgICAgICAgaW5fUG93IDogMjAuMCAsXHJcbiAgICAgICAgICAgICBlZGdlX29ubHkgOiB0cnVlLFxyXG4gICAgIFx0fTtcclxuICAgIC8vIGNyZWF0ZSBhIHNpbXBsZSBzcXVhcmUgc2hhcGUuIFdlIGR1cGxpY2F0ZSB0aGUgdG9wIGxlZnQgYW5kIGJvdHRvbSByaWdodFxyXG4gICAgLy8gdmVydGljZXMgYmVjYXVzZSBlYWNoIHZlcnRleCBuZWVkcyB0byBhcHBlYXIgb25jZSBwZXIgdHJpYW5nbGUuXHJcbiAgICBidWZmZXIucG9zaXRpb24gPSBuZXcgRmxvYXQzMkFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmluX1RleHR1cmUgPSBuZXcgRmxvYXQzMkFycmF5KCBbXSApO1xyXG4gICAgLy9idWZmZXIuaW5fQ29sb3IgPSBuZXcgVWludDhBcnJheSggW10gKTtcclxuICAgIC8vYnVmZmVyLmluX0ZhY2VDb2xvciA9IG5ldyBVaW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmluX05vcm1hbCA9IG5ldyBGbG9hdDMyQXJyYXkoIFtdICk7XHJcbiAgICAvL2J1ZmZlci5pbl9Qb3cgPSBuZXcgVWludDhBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl91c2VfdGV4dHVyZSA9IG5ldyBVaW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmluX2ZsYXRfY29sb3IgPSBuZXcgVWludDhBcnJheSggW10gKTtcclxuICAgIGJ1ZmZlci5pbl9kZWNhbF90ZXh0dXJlID0gbmV3IFVpbnQ4QXJyYXkoIFtdICk7XHJcbiAgICBidWZmZXIuaW5fTW9kdWxvdXMgPSBuZXcgSW50OEFycmF5KCBbXSApO1xyXG4gICAgYnVmZmVyLmF2YWlsYWJsZSA9IDA7XHJcbiAgICBidWZmZXIudXNlZCA9IDA7XHJcblxyXG4gICAgYnVmZmVyLmNsZWFyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy51c2VkID0gMDtcclxuICAgIH1cclxuLypcclxuICAgIGF0dHJpYnV0ZSB2ZWM0IHZQb3NpdGlvbjtcclxuICAgIGF0dHJpYnV0ZSB2ZWMyIGluX1RleHR1cmU7XHJcbiAgICBhdHRyaWJ1dGUgIHZlYzQgaW5fQ29sb3I7XHJcbiAgICBhdHRyaWJ1dGUgIHZlYzQgaW5fRmFjZUNvbG9yO1xyXG4gICAgYXR0cmlidXRlIHZlYzMgaW5fTm9ybWFsO1xyXG4gICAgYXR0cmlidXRlICBmbG9hdCBpbl9Qb3c7XHJcblxyXG4gICAgYXR0cmlidXRlICBmbG9hdCBpbl91c2VfdGV4dHVyZTtcclxuICAgIGF0dHJpYnV0ZSAgZmxvYXQgaW5fZmxhdF9jb2xvcjtcclxuICAgIGF0dHJpYnV0ZSAgZmxvYXQgaW5fZGVjYWxfdGV4dHVyZTtcclxuXHJcbiAgICBhdHRyaWJ1dGUgIHZlYzIgaW5fTW9kdWxvdXM7XHJcbiovXHJcbi8vYnVmZmVyLmdlb21ldHJ5XHJcbiAgICBidWZmZXIuZ2VvbWV0cnkuYWRkQXR0cmlidXRlKCAncG9zaXRpb24nLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBidWZmZXIucG9zaXRpb24sIDMgKSApO1xyXG4gICAgIGJ1ZmZlci5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdpbl9UZXh0dXJlJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYnVmZmVyLmluX1RleHR1cmUsIDIgKSApO1xyXG4gICAgIC8vYnVmZmVyLmdlb21ldHJ5LmFkZEF0dHJpYnV0ZSggJ2luX0NvbG9yJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYnVmZmVyLmluX0NvbG9yLCA0LHRydWUgKSApO1xyXG4gICAgIC8vYnVmZmVyLmdlb21ldHJ5LmFkZEF0dHJpYnV0ZSggJ2luX0ZhY2VDb2xvcicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoIGJ1ZmZlci5pbl9GYWNlQ29sb3IsIDQsIHRydWUgKSApO1xyXG4gICAgIGJ1ZmZlci5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdpbl9Ob3JtYWwnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBidWZmZXIuaW5fTm9ybWFsLCAzICkgKTtcclxuICAgICAvL2J1ZmZlci5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdpbl9Qb3cnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBidWZmZXIuaW5fUG93LCAxICkgKTtcclxuICAgICBidWZmZXIuZ2VvbWV0cnkuYWRkQXR0cmlidXRlKCAnaW5fdXNlX3RleHR1cmUnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBidWZmZXIuaW5fdXNlX3RleHR1cmUsIDEgKSApO1xyXG4gICAgIGJ1ZmZlci5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdpbl9mbGF0X2NvbG9yJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYnVmZmVyLmluX2ZsYXRfY29sb3IsIDEgKSApO1xyXG4gICAgIGJ1ZmZlci5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdpbl9kZWNhbF90ZXh0dXJlJywgbmV3IFRIUkVFLkJ1ZmZlckF0dHJpYnV0ZSggYnVmZmVyLmluX2RlY2FsX3RleHR1cmUsIDEgKSApO1xyXG4gICAgIGJ1ZmZlci5nZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdpbl9Nb2R1bG91cycsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoIGJ1ZmZlci5pbl9Nb2R1bG91cywgMiwgZmFsc2UgKSApO1xyXG5cclxuXHJcblxyXG4gICAgIGJ1ZmZlci5leHBhbmQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgdmFyIG5ld2J1ZjtcclxuICAgICAgICAgdGhpcy5hdmFpbGFibGUgPSAoIHRoaXMuYXZhaWxhYmxlICsgMSApICogMjtcclxuXHJcbiAgICAgICAgIG5ld2J1ZiA9ICAgbmV3IEZsb2F0MzJBcnJheSggbmV3IEFycmF5QnVmZmVyKCB0aGlzLmF2YWlsYWJsZSAqICggNCAqIDMgKSApICk7XHJcbiAgICAgICAgIG5ld2J1Zi5zZXQoIGJ1ZmZlci5wb3NpdGlvbiApO1xyXG4gICAgICAgICBidWZmZXIucG9zaXRpb24gPSBuZXdidWY7XHJcblxyXG4gICAgICAgICBuZXdidWYgPSAgIG5ldyBGbG9hdDMyQXJyYXkoIG5ldyBBcnJheUJ1ZmZlciggdGhpcy5hdmFpbGFibGUgKiAoIDQgKiAyICkgKSApO1xyXG4gICAgICAgICBuZXdidWYuc2V0KCBidWZmZXIuaW5fVGV4dHVyZSApO1xyXG4gICAgICAgICBidWZmZXIuaW5fVGV4dHVyZSA9IG5ld2J1ZjtcclxuXHJcbiAgICAgICAgIG5ld2J1ZiA9ICAgbmV3IEZsb2F0MzJBcnJheSggbmV3IEFycmF5QnVmZmVyKCB0aGlzLmF2YWlsYWJsZSAqICggNCAqIDMgKSApICk7XHJcbiAgICAgICAgIG5ld2J1Zi5zZXQoIGJ1ZmZlci5pbl9Ob3JtYWwgKTtcclxuICAgICAgICAgYnVmZmVyLmluX05vcm1hbCA9IG5ld2J1ZjtcclxuXHJcbiAgICAgICAgIG5ld2J1ZiA9ICAgbmV3IFVpbnQ4QXJyYXkoIG5ldyBBcnJheUJ1ZmZlciggdGhpcy5hdmFpbGFibGUgKiAoIDEgKiAxICkgKSApO1xyXG4gICAgICAgICBuZXdidWYuc2V0KCBidWZmZXIuaW5fdXNlX3RleHR1cmUgKTtcclxuICAgICAgICAgYnVmZmVyLmluX3VzZV90ZXh0dXJlID0gbmV3YnVmO1xyXG5cclxuICAgICAgICAgbmV3YnVmID0gICBuZXcgVWludDhBcnJheSggbmV3IEFycmF5QnVmZmVyKCB0aGlzLmF2YWlsYWJsZSAqICggMSAqIDEgKSApICk7XHJcbiAgICAgICAgIG5ld2J1Zi5zZXQoIGJ1ZmZlci5pbl9mbGF0X2NvbG9yICk7XHJcbiAgICAgICAgIGJ1ZmZlci5pbl9mbGF0X2NvbG9yID0gbmV3YnVmO1xyXG5cclxuICAgICAgICAgbmV3YnVmID0gICBuZXcgVWludDhBcnJheSggbmV3IEFycmF5QnVmZmVyKCB0aGlzLmF2YWlsYWJsZSAqICggMSAqIDEgKSApICk7XHJcbiAgICAgICAgIG5ld2J1Zi5zZXQoIGJ1ZmZlci5pbl9kZWNhbF90ZXh0dXJlICk7XHJcbiAgICAgICAgIGJ1ZmZlci5pbl9kZWNhbF90ZXh0dXJlID0gbmV3YnVmO1xyXG5cclxuICAgICAgICAgbmV3YnVmID0gICBuZXcgSW50OEFycmF5KCBuZXcgQXJyYXlCdWZmZXIoIHRoaXMuYXZhaWxhYmxlICogKCA0ICogMiApICkgKTtcclxuICAgICAgICAgbmV3YnVmLnNldCggYnVmZmVyLmluX01vZHVsb3VzICk7XHJcbiAgICAgICAgIGJ1ZmZlci5pbl9Nb2R1bG91cyA9IG5ld2J1ZjtcclxuXHJcbiAgICAgfTtcclxuXHJcbiAgICAgYnVmZmVyLm1hcmtEaXJ0eSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgW1wicG9zaXRpb25cIixcImluX1RleHR1cmVcIlxyXG4gICAgICAgICAsXCJpbl9Nb2R1bG91c1wiXHJcbiAgICAgICAgICxcImluX05vcm1hbFwiLCBcImluX2ZsYXRfY29sb3JcIiwgXCJpbl91c2VfdGV4dHVyZVwiLCBcImluX2RlY2FsX3RleHR1cmVcIlxyXG4gICAgIF0uZm9yRWFjaCggKGF0dCk9PntcclxuICAgICAgICAgICAgIHZhciBhdHRyaWIgPSB0aGlzLmdlb21ldHJ5LmdldEF0dHJpYnV0ZShhdHQpO1xyXG4gICAgICAgICAgICAgYXR0cmliLm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgIGF0dHJpYi5hcnJheSA9IGJ1ZmZlclthdHRdO1xyXG4gICAgICAgICB9KVxyXG5cclxuICAgICAgICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLmluX1RleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMuaW5fTm9ybWFsLm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLmluX3VzZV90ZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICAgdGhpcy5nZW9tZXRyeS5hdHRyaWJ1dGVzLmluX2ZsYXRfY29sb3IubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICB0aGlzLmdlb21ldHJ5LmF0dHJpYnV0ZXMuaW5fZGVjYWxfdGV4dHVyZS5uZWVkc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgIHRoaXMuZ2VvbWV0cnkuYXR0cmlidXRlcy5pbl9Nb2R1bG91cy5uZWVkc1VwZGF0ZSA9IHRydWU7XHJcbiAgICAgfVxyXG5cclxuICAgICBidWZmZXIuYWRkUG9pbnQgPSBmdW5jdGlvbiggdiwgbiwgdXQsIGZsYXQsIGR0LCBtb2QgKSB7XHJcbiAgICAgICAgIGlmKCB0aGlzLnVzZWQgPj0gdGhpcy5hdmFpbGFibGUgKVxyXG4gICAgICAgICAgICB0aGlzLmV4cGFuZCgpO1xyXG4gICAgICAgICAgICBjb25zdCB1MyA9IHRoaXMudXNlZCAqIDM7XHJcbiAgICAgICAgICAgIGNvbnN0IHU0ID0gdGhpcy51c2VkICogNDtcclxuICAgICAgICB0aGlzLnBvc2l0aW9uW3UzICsgMCBdID0gdi54O1xyXG4gICAgICAgIHRoaXMucG9zaXRpb25bdTMgKyAxIF0gPSB2Lnk7XHJcbiAgICAgICAgdGhpcy5wb3NpdGlvblt1MyArIDIgXSA9IHYuejtcclxuXHJcblxyXG4gICAgICAgIHRoaXMuaW5fTm9ybWFsW3UzICsgMF0gPSBuP24ueDowO1xyXG4gICAgICAgIHRoaXMuaW5fTm9ybWFsW3UzICsgMV0gPSBuP24ueTowO1xyXG4gICAgICAgIHRoaXMuaW5fTm9ybWFsW3UzICsgMl0gPSBuP24uejoxO1xyXG5cclxuICAgICAgICB0aGlzLmluX3VzZV90ZXh0dXJlWyB0aGlzLnVzZWQgXSA9IHV0O1xyXG4gICAgICAgIHRoaXMuaW5fZmxhdF9jb2xvclt0aGlzLnVzZWRdID0gZmxhdDtcclxuICAgICAgICB0aGlzLmluX2RlY2FsX3RleHR1cmVbdGhpcy51c2VkXSA9IGR0O1xyXG4gICAgICAgIHRoaXMuaW5fTW9kdWxvdXNbdGhpcy51c2VkICogMiArIDBdID0gbW9kWzBdO1xyXG4gICAgICAgIHRoaXMuaW5fTW9kdWxvdXNbdGhpcy51c2VkICogMiArIDFdID0gbW9kWzFdO1xyXG5cclxuICAgICAgICB0aGlzLnVzZWQrKztcclxuICAgIH07XHJcblxyXG4gICAgIC8vYnVmZmVyLlxyXG5cclxuICAgICBidWZmZXIuQWRkUXVhZCA9IGZ1bmN0aW9uKCBub3JtLCBQMSxQMixQMyxQNCApIHtcclxuXHJcbiAgICAgICAgIGNvbnN0IG1pbiA9IDA7XHJcbiAgICAgICAgIGNvbnN0IG1heCA9IDE7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFAxLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDQsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICB9XHJcbiAgICAgYnVmZmVyLkFkZFF1YWRUZXh0dXJlID0gZnVuY3Rpb24oIG5vcm0sIFAxLFAyLFAzLFA0LHRleHR1cmVDb29yZHMgKSB7XHJcbiAgICAgICAgIGNvbnN0IG1pbiA9IDA7XHJcbiAgICAgICAgIGNvbnN0IG1heCA9IDE7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFAxLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDQsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICB9XHJcbiAgICAgY29uc3Qgd2hpdGUgPSBuZXcgVEhSRUUuVmVjdG9yNCggMC41LCAwLjUsIDAsIDEgKTtcclxuICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZFRleCA9IGZ1bmN0aW9uKCBxdWFkLCB1dnMsIG5vcm0sIHBvdyApIHtcclxuICAgICAgICAgdmFyIG1pbiA9IDA7XHJcbiAgICAgICAgIHZhciBtYXggPSAxLjA7XHJcbiAgICAgICAgIHRoaXMuYWRkUG9pbnQoIFAxLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDIsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDQsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggUDMsICBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICB9XHJcbiAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQgPSBmdW5jdGlvbiggcXVhZCwgbm9ybSApIHtcclxuICAgICAgICAgdmFyIG1pbiA9IC0yO1xyXG4gICAgICAgICB2YXIgbWF4ID0gMjtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFswXSwgdW5kZWZpbmVkLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsxXSwgdW5kZWZpbmVkLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsyXSwgdW5kZWZpbmVkLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsxXSwgdW5kZWZpbmVkLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1pbl0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFszXSwgdW5kZWZpbmVkLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWF4LG1heF0gKTtcclxuICAgICAgICAgdGhpcy5hZGRQb2ludCggcXVhZFsyXSwgdW5kZWZpbmVkLCBub3JtLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBbbWluLG1heF0gKTtcclxuICAgICB9XHJcblxyXG4gICAgIGJ1ZmZlci5tYWtlVm94Q3ViZSA9IGZ1bmN0aW9uKHNpemUpIHtcclxuICAgICAgICB2YXIgdjEgPSBuZXcgVEhSRUUuVmVjdG9yMygxLDEsMSk7XHJcbiAgICAgICAgdmFyIHYyID0gbmV3IFRIUkVFLlZlY3RvcjMoLTEsMSwxKTtcclxuICAgICAgICB2YXIgdjMgPSBuZXcgVEhSRUUuVmVjdG9yMygxLC0xLDEpO1xyXG4gICAgICAgIHZhciB2NCA9IG5ldyBUSFJFRS5WZWN0b3IzKC0xLC0xLDEpO1xyXG4gICAgICAgIHZhciB2NSA9IG5ldyBUSFJFRS5WZWN0b3IzKDEsMSwtMSk7XHJcbiAgICAgICAgdmFyIHY2ID0gbmV3IFRIUkVFLlZlY3RvcjMoLTEsMSwtMSk7XHJcbiAgICAgICAgdmFyIHY3ID0gbmV3IFRIUkVFLlZlY3RvcjMoMSwtMSwtMSk7XHJcbiAgICAgICAgdmFyIHY4ID0gbmV3IFRIUkVFLlZlY3RvcjMoLTEsLTEsLTEpO1xyXG4gICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkKCBbdjEuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Mi5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYzLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjQuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgLCBuZXcgVEhSRUUuVmVjdG9yNCggMC4yLCAwLjAsIDEsIDEuMCApLCBuZXcgVEhSRUUuVmVjdG9yNCggMCwgMCwgMCwgMC41IClcclxuICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzRm9yd2FyZFxyXG4gICAgICAgICAgICAsIDIwMCApXHJcbiAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQoIFt2Ni5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY1LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjguY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ny5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3I0KCAwLjIsIDEsIDAsIDEuMCApLCBuZXcgVEhSRUUuVmVjdG9yNCggMCwgMCwgMCwgMC41IClcclxuICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzQmFja3dhcmRcclxuICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkKCBbdjUuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ni5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYxLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjIuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgICAgICwgbmV3IFRIUkVFLlZlY3RvcjQoIDEsIDAuMCwgMCwgMS4wICksIG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAwLCAwLCAwLjUgKVxyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzVXBcclxuICAgICAgICAgICAgICAgICwgMjAwIClcclxuICAgICAgICBidWZmZXIuYWRkU2ltcGxlUXVhZCggW3YzLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjQuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ny5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY4LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSldXHJcbiAgICAgICAgICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAxLCAxLCAxLjAgKSwgbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDAuNSApXHJcbiAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNEb3duXHJcbiAgICAgICAgICAgICAgICAsIDIwMCApXHJcbiAgICAgICAgYnVmZmVyLmFkZFNpbXBsZVF1YWQoIFt2NS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHYxLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjcuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2My5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpXVxyXG4gICAgICAgICAgICAgICAgLCBuZXcgVEhSRUUuVmVjdG9yNCggMSwgMC4wLCAxLCAxLjAgKSwgbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDAuNSApXHJcbiAgICAgICAgICAgICAgICAsIFRIUkVFLlZlY3RvcjNSaWdodFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgIGJ1ZmZlci5hZGRTaW1wbGVRdWFkKCBbdjIuY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKSx2Ni5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKHNpemUpLHY0LmNsb25lKCkubXVsdGlwbHlTY2FsYXIoc2l6ZSksdjguY2xvbmUoKS5tdWx0aXBseVNjYWxhcihzaXplKV1cclxuICAgICAgICAgICAgICAgICwgbmV3IFRIUkVFLlZlY3RvcjQoIDEsIDEsIDAsIDEuMCApXHJcbiAgICAgICAgICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3I0KCAwLCAwLCAwLCAwLjUgKVxyXG4gICAgICAgICAgICAgICAgLCBUSFJFRS5WZWN0b3IzTGVmdFxyXG4gICAgICAgICAgICAgICAgLCAyMDAgKVxyXG4gICAgICAgIHRoaXMubWFya0RpcnR5KCAgKTtcclxuICAgICB9XHJcblxyXG4gICAgIC8vdmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCB7IGNvbG9yOiAweGZmMDAwMCB9ICk7XHJcbiAgICAgLy92YXIgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKCBnZW9tZXRyeSwgbWF0ZXJpYWwgKTtcclxuICAgICByZXR1cm4gYnVmZmVyO1xyXG59XHJcblxyXG5cclxuXHJcblxyXG5mdW5jdGlvbiB1cGRhdGVQb3NpdGlvbigpIHtcclxuICAgIGJ1ZmZlci5nZW9tZXRyeS5hdHRyaWJ1dGVzLnBvc2l0aW9uLm5lZWRzVXBkYXRlID0gdHJ1ZTtcclxufVxyXG4iLCJcclxuXHJcblZveGVsYXJpdW0uR2VvbWV0cnlTaGFkZXIgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoIHtcclxuXHJcblx0dW5pZm9ybXM6IHtcclxuICAgICAgICBlZGdlX29ubHkgOiB7IHR5cGU6IFwiZlwiLCB2YWx1ZSA6IDAgfSxcclxuICAgICAgICBtYXAgOiB7IHR5cGUgOiBcInRcIiwgdmFsdWUgOiBudWxsIH1cclxuXHR9LFxyXG4gICAgdHJhbnNwYXJlbnQgOiB0cnVlLFxyXG4gICAgIGJsZW5kaW5nOiBUSFJFRS5Ob3JtYWxCbGVuZGluZyxcclxuXHR2ZXJ0ZXhTaGFkZXI6IGBcclxuICAgICNkZWZpbmUgVVNFX01BUFxyXG5cclxuICAgICNpbmNsdWRlIDxjb21tb24+XHJcbiAgICAjaW5jbHVkZSA8dXZfcGFyc192ZXJ0ZXg+XHJcbiAgICAjaW5jbHVkZSA8dXYyX3BhcnNfdmVydGV4PlxyXG4gICAgI2luY2x1ZGUgPGVudm1hcF9wYXJzX3ZlcnRleD5cclxuICAgICNpbmNsdWRlIDxjb2xvcl9wYXJzX3ZlcnRleD5cclxuICAgICNpbmNsdWRlIDxtb3JwaHRhcmdldF9wYXJzX3ZlcnRleD5cclxuICAgICNpbmNsdWRlIDxza2lubmluZ19wYXJzX3ZlcnRleD5cclxuICAgICNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX3ZlcnRleD5cclxuICAgICNpbmNsdWRlIDxjbGlwcGluZ19wbGFuZXNfcGFyc192ZXJ0ZXg+XHJcblxyXG4gICAgYXR0cmlidXRlICB2ZWM0IGluX0NvbG9yO1xyXG4gICAgYXR0cmlidXRlICB2ZWM0IGluX0ZhY2VDb2xvcjtcclxuICAgIGF0dHJpYnV0ZSAgZmxvYXQgaW5fUG93O1xyXG5cclxuICAgIGF0dHJpYnV0ZSAgZmxvYXQgaW5fdXNlX3RleHR1cmU7XHJcbiAgICBhdHRyaWJ1dGUgIGZsb2F0IGluX2ZsYXRfY29sb3I7XHJcbiAgICBhdHRyaWJ1dGUgIGZsb2F0IGluX2RlY2FsX3RleHR1cmU7XHJcblxyXG4gICAgYXR0cmlidXRlICB2ZWMyIGluX01vZHVsb3VzO1xyXG4gICAgdmFyeWluZyB2ZWM0IGV4X0NvbG9yO1xyXG4gICAgdmFyeWluZyB2ZWMyIGV4X3RleENvb3JkO1xyXG4gICAgdmFyeWluZyBmbG9hdCBleF9Eb3Q7XHJcbiAgICB2YXJ5aW5nICBmbG9hdCBleF9Qb3c7XHJcbiAgICB2YXJ5aW5nICBmbG9hdCBleF9Qb3cyO1xyXG4gICAgdmFyeWluZyBmbG9hdCB2RGVwdGg7XHJcbiAgICB2YXJ5aW5nIGZsb2F0IGV4X3VzZV90ZXh0dXJlO1xyXG4gICAgdmFyeWluZyBmbG9hdCBleF9mbGF0X2NvbG9yO1xyXG4gICAgdmFyeWluZyBmbG9hdCBleF9kZWNhbF90ZXh0dXJlO1xyXG4gICAgdmFyeWluZyB2ZWM0IGV4X0ZhY2VDb2xvcjtcclxuICAgICNkZWZpbmUgRVBTSUxPTiAxZS02XHJcblxyXG4gICAgdmFyeWluZyAgdmVjMiBleF9Nb2R1bG91cztcclxuXHJcbiAgICB2YXJ5aW5nIHZlYzQgZmVfbm9ybWFsLCBsaWdodF9kaXIsIGV5ZV92ZWMsIGxvb2thdDtcclxuICAgIC8vY29uc3QgZmxvYXQgUEkgPSAgMy4xNDE1OTI2NTtcclxuXHJcbiAgICB2b2lkIG1haW4oKSB7XHJcblxyXG4gICAgXHQjaW5jbHVkZSA8dXZfdmVydGV4PlxyXG4gICAgXHQjaW5jbHVkZSA8dXYyX3ZlcnRleD5cclxuICAgIFx0I2luY2x1ZGUgPGNvbG9yX3ZlcnRleD5cclxuICAgIFx0I2luY2x1ZGUgPHNraW5iYXNlX3ZlcnRleD5cclxuXHJcbiAgICBcdCNpZmRlZiBVU0VfRU5WTUFQXHJcblxyXG4gICAgXHQjaW5jbHVkZSA8YmVnaW5ub3JtYWxfdmVydGV4PlxyXG4gICAgXHQjaW5jbHVkZSA8bW9ycGhub3JtYWxfdmVydGV4PlxyXG4gICAgXHQjaW5jbHVkZSA8c2tpbm5vcm1hbF92ZXJ0ZXg+XHJcbiAgICBcdCNpbmNsdWRlIDxkZWZhdWx0bm9ybWFsX3ZlcnRleD5cclxuXHJcbiAgICBcdCNlbmRpZlxyXG5cclxuICAgIFx0I2luY2x1ZGUgPGJlZ2luX3ZlcnRleD5cclxuICAgIFx0I2luY2x1ZGUgPG1vcnBodGFyZ2V0X3ZlcnRleD5cclxuICAgIFx0I2luY2x1ZGUgPHNraW5uaW5nX3ZlcnRleD5cclxuXHJcbiAgICAgICAgI2luY2x1ZGUgPHByb2plY3RfdmVydGV4PlxyXG4vKlxyXG5cclxuICAgICAgICB7XHJcbiAgICAgICAgXHR2ZWM0IGFtYmllbnQsIGRpZmZ1c2UsIHNwZWN1bGFyO1xyXG4gICAgICAgIFx0ZmxvYXQgTmRvdEwsIFJkb3RWO1xyXG5cclxuICAgICAgICBcdC8vZmVfbm9ybWFsID0gdmVjNChnbF9Ob3JtYWxNYXRyaXggKiBnbF9Ob3JtYWwsIDAuMCk7XHJcblxyXG4gICAgICAgIFx0dmVjNCB2VmVydGV4ID0gbW9kZWxWaWV3TWF0cml4ICogdmVjNCggdHJhbnNmb3JtZWQsIDEuMCApO1xyXG5cclxuICAgICAgICBcdC8vbGlnaHRfZGlyID0gZ2xfTGlnaHRTb3VyY2VbMF0ucG9zaXRpb24gLSB2VmVydGV4O1xyXG5cclxuICAgICAgICBcdGV5ZV92ZWMgPSAtdlZlcnRleDtcclxuXHJcbiAgICAgICAgXHR2ZWM0IHRlbXBfcG9zID0gcHJvamVjdGlvbk1hdHJpeCAqIHZWZXJ0ZXg7XHJcblxyXG4gICAgICAgIFx0ZmxvYXQgZGlzdCA9IGxlbmd0aChleWVfdmVjKTtcclxuICAgICAgICBcdGxvb2thdCA9IGV5ZV92ZWMgLSB0ZW1wX3BvcztcclxuICAgICAgICBcdHZlYzQgZGlyID0gdGVtcF9wb3MgLSBleWVfdmVjO1xyXG4gICAgICAgIFx0dmVjNCBjZW50ZXIgPSBub3JtYWxpemUoLWV5ZV92ZWMpO1xyXG4gICAgICAgIFx0dmVjNCBwcm9qID0gZG90KHRlbXBfcG9zLCBub3JtYWxpemUoLWxvb2thdCkpICogbm9ybWFsaXplKC1sb29rYXQpO1xyXG5cclxuICAgICAgICBcdHZlYzQgYyA9IHRlbXBfcG9zIC0gcHJvajtcclxuXHJcbiAgICAgICAgXHRmbG9hdCBtYWduaXR1ZGUgPSAxLjAtYWNvcyhkb3Qobm9ybWFsaXplKC1leWVfdmVjKSwgbm9ybWFsaXplKHRlbXBfcG9zKSkpO1xyXG5cclxuICAgICAgICBcdGMgPSBsZW5ndGgoYykgKiBtYWduaXR1ZGUgKiBub3JtYWxpemUoYyk7XHJcblxyXG4gICAgICAgIFx0dmVjNCBkaXIyID0gbm9ybWFsaXplKGMtbG9va2F0KTtcclxuXHJcbiAgICAgICAgXHRkaXIyID0gKGRpcjIgKiBkaXN0KTtcclxuXHJcbiAgICAgICAgXHRnbF9Qb3NpdGlvbi54eXogPSBkaXIyLnh5ejtcclxuICAgICAgICBcdGdsX1Bvc2l0aW9uLncgPSB0ZW1wX3Bvcy53O1xyXG5cclxuICAgICAgICB9XHJcbiovXHJcbiAgICBcdCNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl92ZXJ0ZXg+XHJcblxyXG4gICAgXHQjaW5jbHVkZSA8d29ybGRwb3NfdmVydGV4PlxyXG4gICAgXHQjaW5jbHVkZSA8Y2xpcHBpbmdfcGxhbmVzX3ZlcnRleD5cclxuICAgIFx0I2luY2x1ZGUgPGVudm1hcF92ZXJ0ZXg+XHJcblxyXG5cclxue1xyXG4gICAgICAgIGV4X3RleENvb3JkID0gdXY7XHJcbiAgICAgICAgZXhfQ29sb3IgPSBpbl9Db2xvcjtcclxuICAgICAgICBleF9GYWNlQ29sb3IgPSBpbl9GYWNlQ29sb3I7XHJcblxyXG4gICAgICAgIC8vbm9ybWFsID0gbm9ybWFsTWF0cml4ICogbm9ybWFsO1xyXG5cclxuICAgICAgICAvL2RvdHRtcCA9IGRvdCggbm9ybWFsLCB2ZWMzKCAwLjAsIDEuMCwgMC4wICkgKTtcclxuICAgICAgICAvL2RvdHRtcHJpZ2h0ID0gZG90KCBub3JtYWwsIHZlYzMoIDEuMCwgMC4wLCAwLjAgKSApO1xyXG5cclxuICAgICAgICBleF9Qb3cgPSBpbl9Qb3c7Ly8gKiAoLypzcXJ0LygxLjAtZG90dG1wcmlnaHQqZG90dG1wcmlnaHQpKTtcclxuICAgICAgICBleF9Qb3cyID0gaW5fUG93Oy8vICogKC8qc3FydC8oMS4wLWRvdHRtcCpkb3R0bXApKTtcclxuXHJcbiAgICAgICAgZXhfdXNlX3RleHR1cmUgPSBpbl91c2VfdGV4dHVyZTtcclxuICAgICAgICBleF9mbGF0X2NvbG9yID0gaW5fZmxhdF9jb2xvcjtcclxuICAgICAgICBleF9Nb2R1bG91cyA9IGluX01vZHVsb3VzO1xyXG59XHJcblxyXG4gICAgfVxyXG4gICAgYCxcclxuZnJhZ21lbnRTaGFkZXI6YFxyXG4gICAgdW5pZm9ybSB2ZWMzIGRpZmZ1c2U7XHJcbiAgICB1bmlmb3JtIGZsb2F0IG9wYWNpdHk7XHJcblxyXG4gICAgI2lmbmRlZiBGTEFUX1NIQURFRFxyXG5cclxuICAgIFx0dmFyeWluZyB2ZWMzIHZOb3JtYWw7XHJcblxyXG4gICAgI2VuZGlmXHJcbiAgICAjZGVmaW5lIFVTRV9NQVBcclxuXHJcbiAgICAjaW5jbHVkZSA8Y29tbW9uPlxyXG4gICAgI2luY2x1ZGUgPGNvbG9yX3BhcnNfZnJhZ21lbnQ+XHJcbiAgICAjaW5jbHVkZSA8dXZfcGFyc19mcmFnbWVudD5cclxuICAgICNpbmNsdWRlIDx1djJfcGFyc19mcmFnbWVudD5cclxuICAgICNpbmNsdWRlIDxtYXBfcGFyc19mcmFnbWVudD5cclxuICAgICNpbmNsdWRlIDxhbHBoYW1hcF9wYXJzX2ZyYWdtZW50PlxyXG4gICAgI2luY2x1ZGUgPGFvbWFwX3BhcnNfZnJhZ21lbnQ+XHJcbiAgICAjaW5jbHVkZSA8ZW52bWFwX3BhcnNfZnJhZ21lbnQ+XHJcbiAgICAjaW5jbHVkZSA8Zm9nX3BhcnNfZnJhZ21lbnQ+XHJcbiAgICAjaW5jbHVkZSA8c3BlY3VsYXJtYXBfcGFyc19mcmFnbWVudD5cclxuICAgICNpbmNsdWRlIDxsb2dkZXB0aGJ1Zl9wYXJzX2ZyYWdtZW50PlxyXG4gICAgI2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19wYXJzX2ZyYWdtZW50PlxyXG5cclxuICAgIHZhcnlpbmcgdmVjMiBleF90ZXhDb29yZDtcclxuICAgIHZhcnlpbmcgdmVjNCBleF9Db2xvcjtcclxuXHJcbiAgICB2YXJ5aW5nIGZsb2F0IGV4X1BvdztcclxuICAgIHZhcnlpbmcgZmxvYXQgZXhfUG93MjtcclxuICAgIHZhcnlpbmcgZmxvYXQgZXhfdXNlX3RleHR1cmU7XHJcbiAgICB2YXJ5aW5nIGZsb2F0IGV4X2ZsYXRfY29sb3I7XHJcbiAgICB2YXJ5aW5nIHZlYzIgZXhfTW9kdWxvdXM7XHJcbiAgICB2YXJ5aW5nIHZlYzQgZXhfRmFjZUNvbG9yO1xyXG4gICAgLy91bmlmb3JtIHNhbXBsZXIyRCB0ZXg7XHJcbiAgICB1bmlmb3JtIGZsb2F0IGVkZ2Vfb25seTtcclxuXHJcbiAgICB1bmlmb3JtIGZsb2F0IGxvZ0RlcHRoQnVmRkM7XHJcbiAgICB2YXJ5aW5nIGZsb2F0IHZGcmFnRGVwdGg7XHJcblxyXG4gICAgdm9pZCBtYWluKCkge1xyXG5cclxuICAgIFx0I2luY2x1ZGUgPGNsaXBwaW5nX3BsYW5lc19mcmFnbWVudD5cclxuXHJcbiAgICBcdHZlYzQgZGlmZnVzZUNvbG9yID0gdmVjNCggZGlmZnVzZSwgb3BhY2l0eSApO1xyXG5cclxuICAgIFx0I2luY2x1ZGUgPGxvZ2RlcHRoYnVmX2ZyYWdtZW50PlxyXG4gICAgXHQjaW5jbHVkZSA8bWFwX2ZyYWdtZW50PlxyXG4gICAgXHQjaW5jbHVkZSA8Y29sb3JfZnJhZ21lbnQ+XHJcbiAgICBcdCNpbmNsdWRlIDxhbHBoYW1hcF9mcmFnbWVudD5cclxuICAgIFx0I2luY2x1ZGUgPGFscGhhdGVzdF9mcmFnbWVudD5cclxuICAgIFx0I2luY2x1ZGUgPHNwZWN1bGFybWFwX2ZyYWdtZW50PlxyXG5cclxuXHJcblxyXG4gICAgICAgIC8vaWYoMi4wID4gMS4wKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmKCBleF91c2VfdGV4dHVyZSA+IDAuNSApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIGVkZ2Vfb25seSA+IDAuNSApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZ1c2VDb2xvciA9IHZlYzQoMS4wKTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZ1c2VDb2xvciA9IHZlYzQoIHRleHR1cmUyRCggbWFwLCBleF90ZXhDb29yZCApLnJnYiwgMS4wICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAvLyAgZGlmZnVzZUNvbG9yID0gdmVjNCggZXhfdGV4Q29vcmQsIHRleHR1cmUyRCggbWFwLCBleF90ZXhDb29yZCApLnIsIDEuMCApO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZGlmZnVzZUNvbG9yID12ZWM0KGV4X3RleENvb3JkLngsZXhfdGV4Q29vcmQueSwwLDEpOy8vIGV4X0NvbG9yO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiggZXhfZmxhdF9jb2xvciA+IDAuNSApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlmZnVzZUNvbG9yID12ZWM0KDEsMCwxLDEpOy8vIGV4X0NvbG9yO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGZsb2F0IGEgPSBtb2QoZXhfTW9kdWxvdXMueCArMC41LCAxLjAgKS0wLjU7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgYiA9IG1vZChleF9Nb2R1bG91cy55ICswLjUsIDEuMCApLTAuNTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgZztcclxuICAgICAgICAgICAgICAgICAgICBmbG9hdCBoO1xyXG4gICAgICAgICAgICAgICAgICAgIHZlYzMgd2hpdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgYSA9IDQuMCooMC4yNS1hKmEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGIgPSA0LjAqKDAuMjUtYipiKTtcclxuICAgICAgICAgICAgICAgICAgICBhID0gcG93KCBhYnMoYSksIGV4X1BvdyApO1xyXG4gICAgICAgICAgICAgICAgICAgIGIgPSBwb3coIGFicyhiKSwgZXhfUG93MiApO1xyXG5cclxuICAgICAgICAgICAgICAgICAvL2cgPSBwb3coICggbWF4KGEsYikpLGluX1Bvdyk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9oID0gcG93KCAoIGEqYiksaW5fUG93LzQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGcgPSBtaW4oMS4wLGIrYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaCA9IG1heCgoYithKS0xLjAsMC4wKS8zLjA7XHJcbiAgICAgICAgICAgICAgICAgICAgd2hpdGUgPSB2ZWMzKDEuMCwxLjAsMS4wKSAqIG1heChleF9Db2xvci5yLG1heChleF9Db2xvci5nLGV4X0NvbG9yLmIpKTtcclxuICAgICAgICAgICAgICAgICAgICAvL1x0ZGlmZnVzZUNvbG9yID0gdmVjNCggaCAqIHdoaXRlICsgKGcgKiBleF9Db2xvci5yZ2IpLCBleF9Db2xvci5hICkgO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICBkaWZmdXNlQ29sb3IgPSB2ZWM0KCBnICogZXhfQ29sb3IucmdiLCBleF9Db2xvci5hICkgO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBlZGdlX29ubHkgPiAwLjUgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgZGlmZnVzZUNvbG9yID0gdmVjNCggaCogKCB3aGl0ZSAtIGV4X0ZhY2VDb2xvci5yZ2IgKSsgKGcqIGV4X0NvbG9yLnJnYiksIChnICogZXhfQ29sb3IuYSkgKSA7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgZGlmZnVzZUNvbG9yID0gdmVjNCggZXhfRmFjZUNvbG9yLmEqKDEuMC1nKSpleF9GYWNlQ29sb3IucmdiICsgaCogKCB3aGl0ZSAtIGV4X0ZhY2VDb2xvci5yZ2IgKSArIChnKiBleF9Db2xvci5yZ2IpLCAoMS4wLWcpKmV4X0ZhY2VDb2xvci5hICsgKGcgKiBleF9Db2xvci5hKSApIDtcclxuICAgICAgICAgICAgICAgICAgICAvL2RpZmZ1c2VDb2xvciA9IHZlYzQoICgxLjAtZykqZXhfRmFjZUNvbG9yLnJnYiArIGgqICggd2hpdGUgLSBleF9GYWNlQ29sb3IucmdiICkrIChnKiBleF9Db2xvci5yZ2IpLCAoMS4wLWcpKmV4X0ZhY2VDb2xvci5hICsgKGcgKiBleF9Db2xvci5hKSApIDtcclxuICAgICAgICAgICAgICAgICAgICAvL2RpZmZ1c2VDb2xvciA9IHZlYzQoZyxoLDEsMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9kaWZmdXNlQ29sb3IgPSBleF9Db2xvcjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIFx0UmVmbGVjdGVkTGlnaHQgcmVmbGVjdGVkTGlnaHQ7XHJcbiAgICBcdHJlZmxlY3RlZExpZ2h0LmRpcmVjdERpZmZ1c2UgPSB2ZWMzKCAwLjAgKTtcclxuICAgIFx0cmVmbGVjdGVkTGlnaHQuZGlyZWN0U3BlY3VsYXIgPSB2ZWMzKCAwLjAgKTtcclxuICAgIFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlID0gZGlmZnVzZUNvbG9yLnJnYjtcclxuICAgIFx0cmVmbGVjdGVkTGlnaHQuaW5kaXJlY3RTcGVjdWxhciA9IHZlYzMoIDAuMCApO1xyXG5cclxuICAgIFx0I2luY2x1ZGUgPGFvbWFwX2ZyYWdtZW50PlxyXG5cclxuICAgIFx0dmVjMyBvdXRnb2luZ0xpZ2h0ID0gcmVmbGVjdGVkTGlnaHQuaW5kaXJlY3REaWZmdXNlO1xyXG5cclxuICAgIFx0I2luY2x1ZGUgPGVudm1hcF9mcmFnbWVudD5cclxuXHJcbiAgICBcdGdsX0ZyYWdDb2xvciA9IGRpZmZ1c2VDb2xvcjsvL3ZlYzQoIG91dGdvaW5nTGlnaHQsIGRpZmZ1c2VDb2xvci5hICk7XHJcblxyXG4gICAgXHQjaW5jbHVkZSA8cHJlbXVsdGlwbGllZF9hbHBoYV9mcmFnbWVudD5cclxuICAgIFx0I2luY2x1ZGUgPHRvbmVtYXBwaW5nX2ZyYWdtZW50PlxyXG4gICAgXHQjaW5jbHVkZSA8ZW5jb2RpbmdzX2ZyYWdtZW50PlxyXG4gICAgXHQjaW5jbHVkZSA8Zm9nX2ZyYWdtZW50PlxyXG5cclxuICAgIH1cclxuICAgIGBcclxufSApO1xyXG5cclxuLypcclxuI2lmICFNT1JFX1JPVU5ERURcclxuICAgICAgICAgICAgICBnID0gc3FydCgoYSphK2IqYikvMik7XHJcbiAgICAgICAgICAgICAgaCA9IHBvdyhnLDIwMC4wKSAqIDAuNTsgIC8vIHVwIHRvIDYwMCBldmVuIHdvcmtzLi4uXHJcbiAgICAgICAgICAgICAgZyA9IHBvdyggKCBtYXgoYSxiKSksNDAwKTtcclxuICAgICAgICAgICAgICBoID0gKGcraCk7XHJcbiAgICAgICAgICAgICAgZ2xfRnJhZ0NvbG9yID0gdmVjNCggaCAqIGluX0NvbG9yLnJnYiwgaW5fQ29sb3IuYSApIDtcclxuI2Vsc2VcclxuKi9cclxuXHJcbn1cclxuIiwiXHJcblxyXG5Wb3hlbGFyaXVtLkdlb21ldHJ5U2hhZGVyTW9ubyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCgge1xyXG5cclxuXHR1bmlmb3Jtczoge1xyXG4gICAgICAgIGluX0NvbG9yIDogeyB2YWx1ZSA6IG5ldyBUSFJFRS5WZWN0b3IzKCkgfSxcclxuICAgICAgICBpbl9GYWNlQ29sb3IgOiB7IHZhbHVlIDogbmV3IFRIUkVFLlZlY3RvcjMoKSB9LFxyXG4gICAgICAgIGluX1BvdyA6IHsgdmFsdWUgOiAwLjAgfSxcclxuICAgICAgICBlZGdlX29ubHkgOiB7IHZhbHVlIDogMCB9LFxyXG5cdH0sXHJcbiAgICB0cmFuc3BhcmVudCA6IHRydWUsXHJcbiAgICAgYmxlbmRpbmc6IFRIUkVFLk5vcm1hbEJsZW5kaW5nLFxyXG5cdHZlcnRleFNoYWRlcjogYFxyXG4gICAgICAgICAgICAgICAgLy9hdHRyaWJ1dGUgdmVjNCBwb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgIHVuaWZvcm0gbWF0MyByb3RhdGlvbjtcclxuICAgIFx0XHRcdGF0dHJpYnV0ZSB2ZWMyIGluX1RleHR1cmU7XHJcbiAgICBcdFx0XHR1bmlmb3JtICB2ZWM0IGluX0NvbG9yO1xyXG4gICAgXHRcdFx0dW5pZm9ybSAgdmVjNCBpbl9GYWNlQ29sb3I7XHJcbiAgICBcdFx0XHRhdHRyaWJ1dGUgdmVjMyBpbl9Ob3JtYWw7XHJcbiAgICBcdFx0XHR1bmlmb3JtICBmbG9hdCBpbl9Qb3c7XHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGUgIGZsb2F0IGluX3VzZV90ZXh0dXJlO1xyXG4gICAgXHRcdFx0YXR0cmlidXRlICBmbG9hdCBpbl9mbGF0X2NvbG9yO1xyXG4gICAgXHRcdFx0YXR0cmlidXRlICBmbG9hdCBpbl9kZWNhbF90ZXh0dXJlO1xyXG5cclxuICAgICAgICBcdFx0YXR0cmlidXRlICB2ZWMyIGluX01vZHVsb3VzO1xyXG4gICAgXHRcdFx0dmFyeWluZyB2ZWM0IGV4X0NvbG9yO1xyXG4gICAgXHRcdFx0dmFyeWluZyB2ZWMyIGV4X3RleENvb3JkO1xyXG4gICAgXHRcdFx0dmFyeWluZyBmbG9hdCBleF9Eb3Q7XHJcbiAgICBcdFx0XHR2YXJ5aW5nICBmbG9hdCBleF9Qb3c7XHJcbiAgICAgICAgICAgICAgICB2YXJ5aW5nICBmbG9hdCBleF9Qb3cyO1xyXG4gICAgXHRcdFx0ZmxvYXQgZXhfdXNlX3RleHR1cmU7XHJcbiAgICBcdFx0XHRmbG9hdCBleF9mbGF0X2NvbG9yO1xyXG4gICAgXHRcdFx0ZmxvYXQgZXhfZGVjYWxfdGV4dHVyZTtcclxuICAgIFx0XHRcdHZhcnlpbmcgdmVjNCBleF9GYWNlQ29sb3I7XHJcblxyXG4gICAgXHRcdFx0dmFyeWluZyAgdmVjMiBleF9Nb2R1bG91cztcclxuICAgIFx0XHRcdHZvaWQgbWFpbih2b2lkKSB7XHJcbiAgICBcdFx0XHRcdHZlYzMgbm9ybWFsO1xyXG4gICAgXHRcdFx0XHRmbG9hdCBkb3R0bXA7XHJcbiAgICAgICAgICAgICAgICAgICAgZmxvYXQgZG90dG1wcmlnaHQ7XHJcbiAgICBcdFx0XHQgICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1xyXG5cclxuICAgIFx0XHRcdFx0ZXhfdGV4Q29vcmQgPSBpbl9UZXh0dXJlLzMyNzY4LjA7XHJcbiAgICBcdFx0XHRcdGV4X0NvbG9yID0gaW5fQ29sb3I7XHJcbiAgICBcdFx0XHRcdGV4X0ZhY2VDb2xvciA9IGluX0ZhY2VDb2xvcjtcclxuXHJcbiAgICBcdFx0XHRcdG5vcm1hbCA9IG5vcm1hbE1hdHJpeCAqIGluX05vcm1hbDtcclxuXHJcbiAgICBcdFx0XHRcdGRvdHRtcCA9IGRvdCggbm9ybWFsLCB2ZWMzKCAwLjAsIDEuMCwgMC4wICkgKTtcclxuICAgICAgICAgICAgICAgICAgICBkb3R0bXByaWdodCA9IGRvdCggbm9ybWFsLCB2ZWMzKCAxLjAsIDAuMCwgMC4wICkgKTtcclxuXHJcbiAgICBcdFx0XHRcdGV4X1BvdyA9IGluX1BvdzsvLyAqICgvKnNxcnQqLygxLjAtZG90dG1wcmlnaHQqZG90dG1wcmlnaHQpKTtcclxuICAgICAgICAgICAgICAgICAgICBleF9Qb3cyID0gaW5fUG93Oy8vICogKC8qc3FydCovKDEuMC1kb3R0bXAqZG90dG1wKSk7XHJcblxyXG4gICAgXHRcdFx0XHRleF91c2VfdGV4dHVyZSA9IGluX3VzZV90ZXh0dXJlO1xyXG4gICAgXHRcdFx0XHRleF9mbGF0X2NvbG9yID0gaW5fZmxhdF9jb2xvcjtcclxuICAgIFx0XHRcdFx0ZXhfTW9kdWxvdXMgPSBpbl9Nb2R1bG91cztcclxuICAgIFx0XHRcdH1cclxuICAgIGAsLy8ucmVwbGFjZSgvW15cXHgwMC1cXHg3Rl0vZywgXCJcIiksXHJcblx0ZnJhZ21lbnRTaGFkZXI6YFxyXG4gICAgXHRcdFx0dmFyeWluZyB2ZWMyIGV4X3RleENvb3JkO1xyXG4gICAgXHRcdFx0dmFyeWluZyB2ZWM0IGV4X0NvbG9yO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhcnlpbmcgZmxvYXQgZXhfUG93O1xyXG4gICAgICAgICAgICAgICAgdmFyeWluZyBmbG9hdCBleF9Qb3cyO1xyXG4gICAgXHRcdFx0ZmxvYXQgZXhfdXNlX3RleHR1cmU7XHJcbiAgICBcdFx0XHRmbG9hdCBleF9mbGF0X2NvbG9yO1xyXG4gICAgXHRcdFx0dmFyeWluZyB2ZWMyIGV4X01vZHVsb3VzO1xyXG4gICAgXHRcdFx0dmFyeWluZyB2ZWM0IGV4X0ZhY2VDb2xvcjtcclxuICAgICAgICAgICAgICAgIHVuaWZvcm0gIGZsb2F0IGVkZ2Vfb25seTtcclxuICAgIFx0XHRcdHVuaWZvcm0gc2FtcGxlcjJEIHRleDtcclxuICAgIFx0XHRcdHZvaWQgbWFpbih2b2lkKSB7XHJcbiAgICBcdFx0XHQgIGlmKCBleF91c2VfdGV4dHVyZSA+IDAuNSApXHJcbiAgICBcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHRnbF9GcmFnQ29sb3IgPSBleF9Db2xvciAqIHRleHR1cmUyRCggdGV4LCBleF90ZXhDb29yZCApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBnbF9GcmFnQ29sb3IgPXZlYzQoMSwwLDAsMSk7Ly8gZXhfQ29sb3I7XHJcbiAgICBcdFx0XHRcdH1cclxuICAgIFx0XHRcdFx0ZWxzZSBpZiggZXhfZmxhdF9jb2xvciA+IDAuNSApXHJcbiAgICBcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHRnbF9GcmFnQ29sb3IgPXZlYzQoMSwwLDEsMSk7Ly8gZXhfQ29sb3I7XHJcbiAgICBcdFx0XHRcdH1cclxuICAgIFx0XHRcdFx0ZWxzZVxyXG4gICAgXHRcdFx0XHR7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0IGEgPSBtb2QoZXhfTW9kdWxvdXMueCArMC41LCAxLjAgKS0wLjU7XHJcbiAgICAgICAgXHRcdFx0XHRmbG9hdCBiID0gbW9kKGV4X01vZHVsb3VzLnkgKzAuNSwgMS4wICktMC41O1xyXG5cclxuICAgICAgICBcdFx0XHRcdGZsb2F0IGc7XHJcbiAgICAgICAgXHRcdFx0XHRmbG9hdCBoO1xyXG4gICAgICAgIFx0XHRcdFx0dmVjMyB3aGl0ZTtcclxuICAgICAgICBcdFx0XHRcdGEgPSA0LjAqKDAuMjUtYSphKTtcclxuICAgICAgICBcdFx0XHRcdGIgPSA0LjAqKDAuMjUtYipiKTtcclxuICAgICAgICBcdFx0XHRcdGEgPSBwb3coIGEsIGV4X1BvdyApO1xyXG4gICAgICAgIFx0XHRcdFx0YiA9IHBvdyggYiwgZXhfUG93MiApO1xyXG5cclxuICAgICAgICBcdFx0XHQgLy9nID0gcG93KCAoIG1heChhLGIpKSxpbl9Qb3cpO1xyXG4gICAgICAgIFx0XHRcdFx0Ly9oID0gcG93KCAoIGEqYiksaW5fUG93LzQpO1xyXG4gICAgICAgIFx0XHRcdFx0ZyA9IG1pbigxLjAsYithKTtcclxuICAgICAgICBcdFx0XHRcdGggPSBtYXgoKGIrYSktMS4wLDAuMCkvMy4wO1xyXG4gICAgICAgIFx0XHRcdFx0d2hpdGUgPSB2ZWMzKDEuMCwxLjAsMS4wKSAqIG1heChleF9Db2xvci5yLG1heChleF9Db2xvci5nLGV4X0NvbG9yLmIpKTtcclxuICAgICAgICBcdFx0XHQvL1x0Z2xfRnJhZ0NvbG9yID0gdmVjNCggaCAqIHdoaXRlICsgKGcgKiBleF9Db2xvci5yZ2IpLCBleF9Db2xvci5hICkgO1xyXG4gICAgICAgIFx0XHRcdC8vICBnbF9GcmFnQ29sb3IgPSB2ZWM0KCBnICogZXhfQ29sb3IucmdiLCBleF9Db2xvci5hICkgO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBlZGdlX29ubHkgPiAwLjUgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KCBoKiAoIHdoaXRlIC0gZXhfRmFjZUNvbG9yLnJnYiApKyAoZyogZXhfQ29sb3IucmdiKSwgKGcgKiBleF9Db2xvci5hKSApIDtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgXHRcdFx0ICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoIGV4X0ZhY2VDb2xvci5hKigxLjAtZykqZXhfRmFjZUNvbG9yLnJnYiArIGgqICggd2hpdGUgLSBleF9GYWNlQ29sb3IucmdiICkrIChnKiBleF9Db2xvci5yZ2IpLCAoMS4wLWcpKmV4X0ZhY2VDb2xvci5hICsgKGcgKiBleF9Db2xvci5hKSApIDtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBnbF9GcmFnQ29sb3IgPSB2ZWM0KCBleF9GYWNlQ29sb3IuYSooMS4wLWcpKmV4X0ZhY2VDb2xvci5yZ2IgKyAgKGcqIGV4X0NvbG9yLnJnYiksICgxLjAtZykqZXhfRmFjZUNvbG9yLmEgKyAoZyAqIGV4X0NvbG9yLmEpICkgO1xyXG4gICAgXHRcdFx0fVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGAsLy8ucmVwbGFjZSgvW15cXHgwMC1cXHg3Rl0vZywgXCJcIilcclxuXHJcbn0gKTtcclxuXHJcbi8qXHJcbiNpZiAhTU9SRV9ST1VOREVEXHJcbiAgICAgICAgICAgICAgZyA9IHNxcnQoKGEqYStiKmIpLzIpO1xyXG4gICAgICAgICAgICAgIGggPSBwb3coZywyMDAuMCkgKiAwLjU7ICAvLyB1cCB0byA2MDAgZXZlbiB3b3Jrcy4uLlxyXG4gICAgICAgICAgICAgIGcgPSBwb3coICggbWF4KGEsYikpLDQwMCk7XHJcbiAgICAgICAgICAgICAgaCA9IChnK2gpO1xyXG4gICAgICAgICAgICAgIGdsX0ZyYWdDb2xvciA9IHZlYzQoIGggKiBpbl9Db2xvci5yZ2IsIGluX0NvbG9yLmEgKSA7XHJcbiNlbHNlXHJcbiovXHJcblxyXG59XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG52YXIgdm94ZWxzID0gcmVxdWlyZSggXCIuL3ZveGVscy5qc1wiKVxyXG5cclxuXHJcblZveGVsYXJpdW0uQmFzaWNNZXNoZXIgPSBmdW5jdGlvbiggICkge1xyXG4gICAgdmFyIG1lc2hlciA9IHtcclxuXHRcdEN1bGxlciA6IGZ1bmN0aW9uKCBjbHVzdGVyICkge1xyXG4gICAgICAgICAgICB2YXIgY3VsbGVyID0ge1xyXG4gICAgICAgICAgICAgIGNsdXN0ZXIgOiBjbHVzdGVyLFxyXG4gICAgXHRcdFx0Y3VsbFNlY3RvciA6IGZ1bmN0aW9uKCBzZWN0b3IsIGludGVybmFsX2ZhY2VzLCBpbnRlcmVzdGluZ19mYWNlcyApIHtcclxuICAgIFx0XHRcdFx0aWYoIGludGVybmFsX2ZhY2VzIClcclxuICAgIFx0XHRcdFx0XHRSZW5kZXJfQmFzaWMuU2VjdG9yVXBkYXRlRmFjZUN1bGxpbmcoIHNlY3RvciwgZmFsc2UgKTtcclxuICAgIFx0XHRcdFx0ZWxzZVxyXG4gICAgXHRcdFx0XHRcdFJlbmRlcl9CYXNpYy5TZWN0b3JVcGRhdGVGYWNlQ3VsbGluZ19QYXJ0aWFsKCBzZWN0b3IsIGludGVyZXN0aW5nX2ZhY2VzLCBmYWxzZSApO1xyXG4gICAgXHRcdFx0fSxcclxuXHJcbiAgICBcdFx0XHRjdWxsU2luZ2xlVm94ZWwgOiBmdW5jdGlvbiAoIF9TZWN0b3IsIG9mZnNldCApIHtcclxuXHJcbiAgICBcdFx0XHRcdHZhciBPZmZzZXQgPSBuZXcgQXJyYXkoMTkpOy8vdWludFsxOV07XHJcbiAgICBcdFx0XHRcdHZhciBWb3hlbFN0YXRlID0gbmV3IEFycmF5KDE5KTtcclxuICAgIFx0XHRcdFx0dmFyIFZveGVsO1xyXG4gICAgXHRcdFx0XHR2YXIgc2VjdG9yID0gbmV3IEFycmF5KDE5KTtcclxuXHJcbiAgICBcdFx0XHRcdHZhciBFeHRGYWNlU3RhdGU7XHJcbiAgICBcdFx0XHRcdHZhciBJbnRGYWNlU3RhdGU7XHJcblxyXG4gICAgXHRcdFx0XHRpZiggISggc2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuSU5DRU5URVJdID0gX1NlY3RvciApICkgcmV0dXJuO1xyXG4gICAgXHRcdFx0XHRPZmZzZXRbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5JTkNFTlRFUl0gPSBvZmZzZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNsdXN0ZXIgPSBfU2VjdG9yLmNsdXN0ZXI7XHJcbiAgICBcdFx0XHRcdE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdID0gb2Zmc2V0IC0gKCAxICogY2x1c3Rlci5zZWN0b3JTaXplWSApO1xyXG4gICAgXHRcdFx0XHRPZmZzZXRbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0gPSBvZmZzZXQgKyAoIDEgKiBjbHVzdGVyLnNlY3RvclNpemVZICk7XHJcbiAgICBcdFx0XHRcdE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXSA9IG9mZnNldCArICggMSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZICk7XHJcbiAgICBcdFx0XHRcdE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0gPSBvZmZzZXQgLSAoIDEgKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWSApO1xyXG4gICAgXHRcdFx0XHRPZmZzZXRbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0gPSBvZmZzZXQgKyAoIDEgKTtcclxuICAgIFx0XHRcdFx0T2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddID0gb2Zmc2V0IC0gKCAxICk7XHJcblxyXG4gICAgXHRcdFx0XHRpZiggMCA9PSAoICggb2Zmc2V0IC8gY2x1c3Rlci5zZWN0b3JTaXplWSApICUgY2x1c3Rlci5zZWN0b3JTaXplWCApIClcclxuICAgIFx0XHRcdFx0e1xyXG4gICAgXHRcdFx0XHRcdGlmKCAhKCBzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSA9IF9TZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdICkgKVxyXG4gICAgXHRcdFx0XHRcdFx0c2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF0gPSBWb3hlbFdvcmxkLldvcmtpbmdGdWxsU2VjdG9yO1xyXG4gICAgXHRcdFx0XHRcdE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdICs9ICggY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKTtcclxuICAgIFx0XHRcdFx0fVxyXG4gICAgXHRcdFx0XHRlbHNlXHJcbiAgICBcdFx0XHRcdFx0c2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF0gPSBfU2VjdG9yO1xyXG5cclxuICAgIFx0XHRcdFx0aWYoIChjbHVzdGVyLnNlY3RvclNpemVYLTEpID09ICggKCBvZmZzZXQgLyBjbHVzdGVyLnNlY3RvclNpemVZICkgJSBjbHVzdGVyLnNlY3RvclNpemVYICkgKVxyXG4gICAgXHRcdFx0XHR7XHJcbiAgICBcdFx0XHRcdFx0aWYoIG51bGwgPT0gKCBzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0gPSBfU2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV0gKSApXHJcbiAgICBcdFx0XHRcdFx0XHRzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0gPSBWb3hlbFdvcmxkLldvcmtpbmdGdWxsU2VjdG9yO1xyXG4gICAgXHRcdFx0XHRcdE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXSAtPSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZICk7XHJcbiAgICBcdFx0XHRcdH1cclxuICAgIFx0XHRcdFx0ZWxzZVxyXG4gICAgXHRcdFx0XHRcdHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXSA9IF9TZWN0b3I7XHJcblxyXG4gICAgXHRcdFx0XHRpZiggKGNsdXN0ZXIuc2VjdG9yU2l6ZVotMSkgPT0gKCAoIG9mZnNldCAvIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSAlIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKSApXHJcbiAgICBcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHRpZiggbnVsbCA9PSAoIHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXSA9IF9TZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuSU5GUk9OVCAtIDFdICkgKVxyXG4gICAgXHRcdFx0XHRcdFx0c2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdID0gVm94ZWxXb3JsZC5Xb3JraW5nRnVsbFNlY3RvcjtcclxuICAgIFx0XHRcdFx0XHRPZmZzZXRbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0gLT0gKCBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVogKTtcclxuICAgIFx0XHRcdFx0fVxyXG4gICAgXHRcdFx0XHRlbHNlXHJcbiAgICBcdFx0XHRcdFx0c2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdID0gX1NlY3RvcjtcclxuXHJcbiAgICBcdFx0XHRcdGlmKCAwID09ICggKCBvZmZzZXQgLyAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKiBjbHVzdGVyLnNlY3RvclNpemVYICkgKSAlIGNsdXN0ZXIuc2VjdHJvU2l6ZVogKSApXHJcbiAgICBcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHRpZiggbnVsbCA9PSAoIHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0gPSBfU2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCAtIDFdICkgKVxyXG4gICAgXHRcdFx0XHRcdFx0c2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSA9IFZveGVsV29ybGQuV29ya2luZ0Z1bGxTZWN0b3I7XHJcbiAgICBcdFx0XHRcdFx0T2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSArPSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWiApO1xyXG4gICAgXHRcdFx0XHR9XHJcbiAgICBcdFx0XHRcdGVsc2VcclxuICAgIFx0XHRcdFx0XHRzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdID0gX1NlY3RvcjtcclxuXHJcbiAgICBcdFx0XHRcdGlmKCAoY2x1c3Rlci5zZWN0b3JTaXplWS0xKSA9PSAoIG9mZnNldCAlIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSApXHJcbiAgICBcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHRpZiggbnVsbCA9PSAoIHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSA9IF9TZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXSApIClcclxuICAgIFx0XHRcdFx0XHRcdHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSA9IFZveGVsV29ybGQuV29ya2luZ0Z1bGxTZWN0b3I7XHJcbiAgICBcdFx0XHRcdFx0T2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdIC09ICggY2x1c3Rlci5zZWN0b3JTaXplWSApO1xyXG4gICAgXHRcdFx0XHR9XHJcbiAgICBcdFx0XHRcdGVsc2VcclxuICAgIFx0XHRcdFx0XHRzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0gPSBfU2VjdG9yO1xyXG5cclxuICAgIFx0XHRcdFx0aWYoIDAgPT0gKCBvZmZzZXQgJSBjbHVzdGVyLnNlY3RvclNpemVZICkgKVxyXG4gICAgXHRcdFx0XHR7XHJcbiAgICBcdFx0XHRcdFx0aWYoIG51bGwgPT0gKCBzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10gPSBfU2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XIC0gMV0gKSApXHJcbiAgICBcdFx0XHRcdFx0XHRzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10gPSBWb3hlbFdvcmxkLldvcmtpbmdGdWxsU2VjdG9yO1xyXG4gICAgXHRcdFx0XHRcdE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXSArPSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKTtcclxuICAgIFx0XHRcdFx0fVxyXG4gICAgXHRcdFx0XHRlbHNlXHJcbiAgICBcdFx0XHRcdFx0c2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddID0gX1NlY3RvcjtcclxuXHJcbiAgICBcdFx0XHRcdC8vIENvbXB1dGluZyBhYnNvbHV0ZSBtZW1vcnkgcG9pbnRlciBvZiBibG9ja3NcclxuICAgIFx0XHRcdFx0Zm9yKCB2YXIgaSA9IDA7IGkgPCA3OyBpKysgKVxyXG4gICAgXHRcdFx0XHR7XHJcbiAgICBcdFx0XHRcdFx0c2VjdG9yW2ldLmRhdGEuc2xlZXBTdGF0ZS5jbGVhciggT2Zmc2V0W2ldICk7XHJcbiAgICBcdFx0XHRcdFx0c2VjdG9yW2ldLkZsYWdfSXNBY3RpdmVWb3hlbHMgPSB0cnVlO1xyXG5cclxuICAgIFx0XHRcdFx0XHQvL1ZveGVsX0FkZHJlc3NbaV0gPSBzZWN0b3JbaV0uRGF0YS5EYXRhW09mZnNldFtpXV07XHJcbiAgICBcdFx0XHRcdFx0Vm94ZWxUeXBlID0gKCBzZWN0b3JbaV0uZGF0YS5kYXRhW09mZnNldFtpXV0gKTtcclxuICAgIFx0XHRcdFx0XHRpZiggKCBWb3hlbFR5cGUucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0RSQVdGVUxMVk9YRUxPUEFDSVRZICkgIT0gMCApXHJcbiAgICBcdFx0XHRcdFx0XHRzZWN0b3JbaV0uRmxhZ19SZW5kZXJfRGlydHkgPSB0cnVlO1xyXG4gICAgXHRcdFx0XHRcdGlmKCAoIFZveGVsVHlwZS5wcm9wZXJ0aWVzLkRyYXdJbmZvICYgVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fRFJBV1RSQU5TUEFSRU5UUkVOREVSSU5HICkgIT0gMCApXHJcbiAgICBcdFx0XHRcdFx0XHRzZWN0b3JbaV0uRmxhZ19SZW5kZXJfRGlydHlfVHJhbnNwYXJlbnQgPSB0cnVlO1xyXG4gICAgXHRcdFx0XHRcdFZveGVsU3RhdGVbaV0gPSAoIFZveGVsVHlwZS5wcm9wZXJ0aWVzLkRyYXdJbmZvICYgVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fQ1VMTElOR0JJVFMgKTtcclxuICAgIFx0XHRcdFx0fVxyXG5cclxuICAgIFx0XHRcdFx0Vm94ZWxUeXBlID0gX1NlY3Rvci5kYXRhLmRhdGFbT2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuSU5DRU5URVJdXTtcclxuXHJcbiAgICBcdFx0XHRcdC8vIEdldHRpbmcgY2FzZSBzdWJ0YWJsZXMuXHJcblxyXG4gICAgXHRcdFx0XHRFeHRGYWNlU3RhdGUgPSBWb3hlbGFyaXVtLkV4dEZhY2VTdGF0ZVRhYmxlW1ZveGVsVHlwZS5wcm9wZXJ0aWVzLkRyYXdJbmZvICYgVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fQ1VMTElOR0JJVFNdO1xyXG4gICAgXHRcdFx0XHRJbnRGYWNlU3RhdGUgPSBWb3hlbGFyaXVtLkludEZhY2VTdGF0ZVRhYmxlW1ZveGVsVHlwZS5wcm9wZXJ0aWVzLkRyYXdJbmZvICYgVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fQ1VMTElOR0JJVFNdO1xyXG5cclxuICAgIFx0XHRcdFx0Ly8gQ29tcHV0aW5nIGZhY2UgY3VsbGluZyBmb3IgY2VudGVyIG1haW4gc3RvcmVkIHZveGVsLlxyXG5cclxuICAgIFx0XHRcdFx0RmFjZUN1bGxpbmdbT2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuSU5DRU5URVJdXVxyXG4gICAgXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0PSAoKCBJbnRGYWNlU3RhdGVbVm94ZWxTdGF0ZVtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdXSAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUIClcclxuICAgIFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgfCAoIEludEZhY2VTdGF0ZVtWb3hlbFN0YXRlW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdXSAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVCApXHJcbiAgICBcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgIHwgKCBJbnRGYWNlU3RhdGVbVm94ZWxTdGF0ZVtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLklORlJPTlRdXSAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCApXHJcbiAgICBcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgIHwgKCBJbnRGYWNlU3RhdGVbVm94ZWxTdGF0ZVtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF1dICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApXHJcbiAgICBcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgIHwgKCBJbnRGYWNlU3RhdGVbVm94ZWxTdGF0ZVtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXV0gJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgKVxyXG4gICAgXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICB8ICggSW50RmFjZVN0YXRlW1ZveGVsU3RhdGVbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV11dICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XICkpXHJcbiAgICBcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdCAgIDtcclxuXHJcbiAgICBcdFx0XHRcdC8vIENvbXB1dGluZyBmYWNlIGN1bGxpbmcgZm9yIG5lYXJib3Jpbmcgdm94ZWxzIGZhY2VzIHRvdWNoaW5nIGNlbnRlciB2b3hlbC5cclxuICAgIFx0XHRcdFx0e1xyXG4gICAgXHRcdFx0XHRcdHZhciBDdWxsZXI7XHJcbiAgICBcdFx0XHRcdFx0dmFyIEN1bGxpbmc7XHJcbiAgICBcdFx0XHRcdFx0aWYoICggQ3VsbGVyID0gc2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF0uQ3VsbGVyICkgIT0gbnVsbCApXHJcbiAgICBcdFx0XHRcdFx0e1xyXG4gICAgXHRcdFx0XHRcdFx0Q3VsbGluZyA9IEN1bGxlci5GYWNlQ3VsbGluZztcclxuXHJcbiAgICBcdFx0XHRcdFx0XHR2YXIgb2ZzID0gT2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XHJcbiAgICBcdFx0XHRcdFx0XHR2YXIgdmFsID0gKCAoIEN1bGxpbmdbb2ZzXSAmICggflZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVCApIClcclxuICAgIFx0XHRcdFx0XHRcdFx0fCAoIEV4dEZhY2VTdGF0ZVtWb3hlbFN0YXRlW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF1dICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUICkgKTtcclxuICAgIFx0XHRcdFx0XHRcdEN1bGxpbmdbb2ZzXSA9IHZhbDtcclxuXHJcbiAgICBcdFx0XHRcdFx0fVxyXG4gICAgXHRcdFx0XHRcdGlmKCAoIEN1bGxlciA9IHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXS5DdWxsZXIgKSAhPSBudWxsIClcclxuICAgIFx0XHRcdFx0XHR7XHJcbiAgICBcdFx0XHRcdFx0XHRDdWxsaW5nID0gQ3VsbGVyLkZhY2VDdWxsaW5nO1xyXG4gICAgXHRcdFx0XHRcdFx0dmFyIG9mcyA9IE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcclxuICAgIFx0XHRcdFx0XHRcdHZhciB2YWwgPSAoICggQ3VsbGluZ1tvZnNdICYgKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkxFRlQgKSApXHJcbiAgICBcdFx0XHRcdFx0XHRcdHwgKCBFeHRGYWNlU3RhdGVbVm94ZWxTdGF0ZVtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXV0gJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCApICk7XHJcbiAgICBcdFx0XHRcdFx0XHRDdWxsaW5nW29mc10gPSB2YWw7XHJcbiAgICBcdFx0XHRcdFx0fVxyXG4gICAgXHRcdFx0XHRcdGlmKCAoIEN1bGxlciA9IHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXS5DdWxsZXIgKSAhPSBudWxsIClcclxuICAgIFx0XHRcdFx0XHR7XHJcbiAgICBcdFx0XHRcdFx0XHRDdWxsaW5nID0gQ3VsbGVyLkZhY2VDdWxsaW5nO1xyXG4gICAgXHRcdFx0XHRcdFx0dmFyIG9mcyA9IE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcclxuICAgIFx0XHRcdFx0XHRcdHZhciB2YWwgPSAoICggQ3VsbGluZ1tvZnNdICYgKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApIClcclxuICAgIFx0XHRcdFx0XHRcdFx0fCAoIEV4dEZhY2VTdGF0ZVtWb3hlbFN0YXRlW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdXSAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQgKSApO1xyXG4gICAgXHRcdFx0XHRcdFx0Q3VsbGluZ1tvZnNdID0gdmFsO1xyXG4gICAgXHRcdFx0XHRcdH1cclxuICAgIFx0XHRcdFx0XHRpZiggKCBDdWxsZXIgPSBzZWN0b3JbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdLkN1bGxlciApICE9IG51bGwgKVxyXG4gICAgXHRcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHRcdEN1bGxpbmcgPSBDdWxsZXIuRmFjZUN1bGxpbmc7XHJcbiAgICBcdFx0XHRcdFx0XHR2YXIgb2ZzID0gT2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcclxuICAgIFx0XHRcdFx0XHRcdHZhciB2YWwgPSAoICggQ3VsbGluZ1tvZnNdICYgKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEICkgKVxyXG4gICAgXHRcdFx0XHRcdFx0XHR8ICggRXh0RmFjZVN0YXRlW1ZveGVsU3RhdGVbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdXSAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCApICk7XHJcbiAgICBcdFx0XHRcdFx0XHRDdWxsaW5nW29mc10gPSB2YWw7XHJcbiAgICBcdFx0XHRcdFx0fVxyXG4gICAgXHRcdFx0XHRcdGlmKCAoIEN1bGxlciA9IHNlY3RvcltWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXS5DdWxsZXIgKSAhPSBudWxsIClcclxuICAgIFx0XHRcdFx0XHR7XHJcbiAgICBcdFx0XHRcdFx0XHRDdWxsaW5nID0gQ3VsbGVyLkZhY2VDdWxsaW5nO1xyXG4gICAgXHRcdFx0XHRcdFx0dmFyIG9mcyA9IE9mZnNldFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcclxuICAgIFx0XHRcdFx0XHRcdHZhciB2YWwgPSAoICggQ3VsbGluZ1tvZnNdICYgKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XICkgKVxyXG4gICAgXHRcdFx0XHRcdFx0XHR8ICggRXh0RmFjZVN0YXRlW1ZveGVsU3RhdGVbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV1dICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XICkgKTtcclxuICAgIFx0XHRcdFx0XHRcdEN1bGxpbmdbb2ZzXSA9IHZhbDtcclxuICAgIFx0XHRcdFx0XHR9XHJcbiAgICBcdFx0XHRcdFx0aWYoICggQ3VsbGVyID0gc2VjdG9yW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddLkN1bGxlciApICE9IG51bGwgKVxyXG4gICAgXHRcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHRcdEN1bGxpbmcgPSBDdWxsZXIuRmFjZUN1bGxpbmc7XHJcbiAgICBcdFx0XHRcdFx0XHR2YXIgb2ZzID0gT2Zmc2V0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xyXG4gICAgXHRcdFx0XHRcdFx0dmFyIHZhbCA9ICggKCBDdWxsaW5nW29mc10gJiAoIH5Wb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgKSApXHJcbiAgICBcdFx0XHRcdFx0XHRcdHwgKCBFeHRGYWNlU3RhdGVbVm94ZWxTdGF0ZVtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXV0gJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgKSApO1xyXG4gICAgXHRcdFx0XHRcdFx0Q3VsbGluZ1tvZnNdID0gdmFsO1xyXG4gICAgXHRcdFx0XHRcdH1cclxuICAgIFx0XHRcdFx0fVxyXG4gICAgXHRcdFx0XHQvLyBwcmludGYoXCJTdGF0ZVtDZW50ZXJdOiV4IFtMZWZ0XSV4IFtSaWdodF0leCBbSU5GUk9OVF0leCBbQkVISU5EXSV4IFtBQk9WRV0leCBbQkVMT1ddJXhcXG5cIixWb3hlbFN0YXRlW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuSU5DRU5URVJdLFZveGVsU3RhdGVbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSxWb3hlbFN0YXRlW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdLFZveGVsU3RhdGVbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5JTkZST05UXSxWb3hlbFN0YXRlW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSxWb3hlbFN0YXRlW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdLFZveGVsU3RhdGVbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10pO1xyXG4gICAgXHRcdFx0fSxcclxuXHJcbiAgICBcdFx0XHRjdWxsU2luZ2xlVm94ZWwyIDogZnVuY3Rpb24oIHgsIHksIHogKSB7XHJcbiAgICBcdFx0XHRcdHZhciBzZWN0b3IgPSBjbHVzdGVyLmdldFNlY3RvciggeCAvIGNsdXN0ZXIuc2VjdG9yU2l6ZVgsIHkgLyBjbHVzdGVyLnNlY3RvclNpemVZLCB6IC8gY2x1c3Rlci5zZWN0b3JTaXplWiApO1xyXG4gICAgXHRcdFx0XHR2YXIgb2Zmc2V0ID0gKCAoICggeCAlIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKVxyXG4gICAgXHRcdFx0XHRcdFx0XHRcdCsgKCB5ICUgY2x1c3Rlci5zZWN0b3JTaXplWSApXHJcbiAgICBcdFx0XHRcdFx0XHRcdFx0KyAoICggeiAlIGNsdXN0ZXIuc2VjdG9yU2l6ZVogKSA8PCAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKyBjbHVzdGVyLnNlY3RvclNpemVYICkgKSApO1xyXG4gICAgXHRcdFx0XHRDdWxsU2luZ2xlVm94ZWwoIHNlY3Rvciwgb2Zmc2V0ICk7XHJcbiAgICBcdFx0XHR9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGN1bGxlci5GYWNlQ3VsbGluZyA9IG5ldyBBcnJheShjbHVzdGVyLnNlY3RvclNpemUpO1xyXG4gICAgICAgICAgICB2YXIgbjtcclxuICAgICAgICAgICAgZm9yKCBuID0gMDsgbiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZTsgbisrIClcclxuICAgICAgICAgICAgICAgIGN1bGxlci5GYWNlQ3VsbGluZ1tuXSA9IDB4RkY7XHJcbiAgICAgICAgICAgIHJldHVybiBjdWxsZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICwgc2VjdG9yVGFibGUgOiBuZXcgQXJyYXkoMjcpXHJcblx0XHQsIFNlY3RvckRhdGFUYWJsZSA6IG5ldyBBcnJheSgyNylcclxuXHRcdCwgQmxvY01hdHJpeCA6IFtuZXcgQXJyYXkoOSksbmV3IEFycmF5KDkpLG5ldyBBcnJheSg5KV1cclxuXHJcbiAgICAsIGluaXRDdWxsaW5nIDogZnVuY3Rpb24oIHNlY3RvciApIHtcclxuICAgICAgdmFyIHRtcCA9IHNlY3Rvci5kYXRhLkZhY2VDdWxsaW5nID0gbmV3IEFycmF5KCBzZWN0b3IuY2x1c3Rlci5zZWN0b3JTaXplICk7XHJcbiAgICAgIGZvciggdmFyIG4gPSAwOyBuIDwgdG1wLmxlbmd0aDsgbisrIClcclxuICAgICAgICB0bXBbbl0gPSAweEZGO1xyXG4gICAgfVxyXG5cdFx0LFNlY3RvclVwZGF0ZUZhY2VDdWxsaW5nIDogZnVuY3Rpb24gKCBzZWN0b3IsIGlzb2xhdGVkIClcclxuXHRcdHtcclxuXHRcdFx0dmFyIE1pc3NpbmdTZWN0b3I7XHJcbiAgICAgIHZhciBjbHVzdGVyID0gc2VjdG9yLmNsdXN0ZXI7XHJcblx0XHRcdHZhciB0bXBwO1xyXG5cdFx0XHR2YXIgaTtcclxuICAgICAgdmFyIHNlY3RvclRhYmxlID0gdGhpcy5zZWN0b3JUYWJsZTtcclxuICAgICAgdmFyIFNlY3RvckRhdGFUYWJsZSA9IHRoaXMuU2VjdG9yRGF0YVRhYmxlO1xyXG4gICAgICB2YXIgQmxvY01hdHJpeCA9IHRoaXMuQmxvY01hdHJpeDtcclxuXHJcblx0XHRcdGlmKCBpc29sYXRlZCApIE1pc3NpbmdTZWN0b3IgPSBjbHVzdGVyLldvcmtpbmdFbXB0eVNlY3RvcjtcclxuXHRcdFx0ZWxzZSBNaXNzaW5nU2VjdG9yID0gY2x1c3Rlci5Xb3JraW5nRnVsbFNlY3RvcjtcclxuXHJcblx0XHRcdC8vIChWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVMT1cgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQpO1xyXG5cdFx0XHRmb3IoIGkgPSAwOyBpIDwgMjc7IGkrKyApIHNlY3RvclRhYmxlW2ldID0gTWlzc2luZ1NlY3RvcjtcclxuXHRcdFx0c2VjdG9yVGFibGVbMF0gPSBzZWN0b3I7IGlmKCBzZWN0b3JUYWJsZVswXSA9PSBudWxsICkgeyByZXR1cm47IH1cclxuXHRcdFx0c2VjdG9yVGFibGVbMV0gPSBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdOyBpZiggc2VjdG9yVGFibGVbMV0gPT0gbnVsbCApIHsgc2VjdG9yVGFibGVbMV0gPSBNaXNzaW5nU2VjdG9yOyBzZWN0b3JUYWJsZVswXS5QYXJ0aWFsQ3VsbGluZyB8PSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVDsgfVxyXG5cdFx0XHRzZWN0b3JUYWJsZVsyXSA9IHNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdOyBpZiggc2VjdG9yVGFibGVbMl0gPT0gbnVsbCApIHsgc2VjdG9yVGFibGVbMl0gPSBNaXNzaW5nU2VjdG9yOyBzZWN0b3JUYWJsZVswXS5QYXJ0aWFsQ3VsbGluZyB8PSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuUklHSFQ7IH1cclxuXHRcdFx0c2VjdG9yVGFibGVbM10gPSBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV07IGlmKCBzZWN0b3JUYWJsZVszXSA9PSBudWxsICkgeyBzZWN0b3JUYWJsZVszXSA9IE1pc3NpbmdTZWN0b3I7IHNlY3RvclRhYmxlWzBdLlBhcnRpYWxDdWxsaW5nIHw9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQ7IH1cclxuXHRcdFx0c2VjdG9yVGFibGVbNl0gPSBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQgLSAxXTsgaWYoIHNlY3RvclRhYmxlWzZdID09IG51bGwgKSB7IHNlY3RvclRhYmxlWzZdID0gTWlzc2luZ1NlY3Rvcjsgc2VjdG9yVGFibGVbMF0uUGFydGlhbEN1bGxpbmcgfD0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEOyB9XHJcblx0XHRcdHNlY3RvclRhYmxlWzldID0gc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XIC0gMV07IGlmKCBzZWN0b3JUYWJsZVs5XSA9PSBudWxsICkgeyBzZWN0b3JUYWJsZVs5XSA9IE1pc3NpbmdTZWN0b3I7IHNlY3RvclRhYmxlWzBdLlBhcnRpYWxDdWxsaW5nIHw9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUxPVzsgfVxyXG5cdFx0XHRzZWN0b3JUYWJsZVsxOF0gPSBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXTsgaWYoIHNlY3RvclRhYmxlWzE4XSA9PSBudWxsICkgeyBzZWN0b3JUYWJsZVsxOF0gPSBNaXNzaW5nU2VjdG9yOyBzZWN0b3JUYWJsZVswXS5QYXJ0aWFsQ3VsbGluZyB8PSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkU7IH1cclxuXHRcdFx0Zm9yKCBpID0gMDsgaSA8IDI3OyBpKysgKSBTZWN0b3JEYXRhVGFibGVbaV0gPSBzZWN0b3JUYWJsZVtpXS5kYXRhLmRhdGE7XHJcblxyXG5cclxuXHRcdFx0dmFyIHhjLCB5YywgemM7XHJcblx0XHRcdHZhciB4cCwgeXAsIHpwO1xyXG5cdFx0XHR2YXIgeHBwLCB5cHAsIHpwcDtcclxuXHRcdFx0dmFyIGluZm87XHJcblxyXG4gICAgICBjb25zdCB0YWJsZXMgPSBzZWN0b3IuY2x1c3Rlci5sb29rdXBUYWJsZXM7XHJcblx0XHRcdC8vc2VjdG9yVGFibGVbMF0uRmxhZ19Wb2lkX1JlZ3VsYXIgPSB0cnVlO1xyXG5cdFx0XHQvL3NlY3RvclRhYmxlWzBdLkZsYWdfVm9pZF9UcmFuc3BhcmVudCA9IHRydWU7XHJcblxyXG5cdFx0XHRmb3IoIHhjID0gMDsgeGMgPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4YysrIClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHhwID0geGMgKyAxOyB4cHAgPSB4YyArIDI7XHJcblx0XHRcdFx0Zm9yKCB6YyA9IDA7IHpjIDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgemMrKyApXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0enAgPSB6YyArIDE7IHpwcCA9IHpjICsgMjtcclxuXHJcblx0XHRcdFx0XHQvLyBQcmVmZXRjaGluZyB0aGUgYmxvYyBtYXRyaXggKG9ubHkgMiByb3dzKVxyXG5cdFx0XHRcdFx0Ly8gICAgQmxvY01hdHJpeFsxXVswXSA9IFNlY3RvckRhdGFUYWJsZVsoVm94ZWxTZWN0b3IudGFibGVzLnRhYmxlWFt4YyBdK3RhYmxlcy50YWJsZVlbMF0rdGFibGVzLnRhYmxlWlt6YyBdKV1bdGFibGVzLm9mVGFibGVYW3hjXSt0YWJsZXMub2ZUYWJsZVlbMF0rdGFibGVzLm9mVGFibGVaW3pjXV07XHJcblx0XHRcdFx0XHRCbG9jTWF0cml4WzFdWzFdID0gU2VjdG9yRGF0YVRhYmxlWyggdGFibGVzLnRhYmxlWFt4cF0gKyB0YWJsZXMudGFibGVZWzBdICsgdGFibGVzLnRhYmxlWlt6Y10gKV1bdGFibGVzLm9mVGFibGVYW3hwXSArIHRhYmxlcy5vZlRhYmxlWVswXSArIHRhYmxlcy5vZlRhYmxlWlt6Y11dO1xyXG5cdFx0XHRcdFx0Ly8gICAgQmxvY01hdHJpeFsxXVsyXSA9IFNlY3RvckRhdGFUYWJsZVsodGFibGVzLnRhYmxlWFt4cHBdK3RhYmxlcy50YWJsZVlbMF0rdGFibGVzLnRhYmxlWlt6YyBdKV1bdGFibGVzLm9mVGFibGVYW3hwcF0rdGFibGVzLm9mVGFibGVZWzBdK3RhYmxlcy5vZlRhYmxlWlt6YyBdXVxyXG5cdFx0XHRcdFx0QmxvY01hdHJpeFsxXVszXSA9IFNlY3RvckRhdGFUYWJsZVsoIHRhYmxlcy50YWJsZVhbeGNdICsgdGFibGVzLnRhYmxlWVswXSArIHRhYmxlcy50YWJsZVpbenBdICldW3RhYmxlcy5vZlRhYmxlWFt4Y10gKyB0YWJsZXMub2ZUYWJsZVlbMF0gKyB0YWJsZXMub2ZUYWJsZVpbenBdXTtcclxuXHRcdFx0XHRcdEJsb2NNYXRyaXhbMV1bNF0gPSBTZWN0b3JEYXRhVGFibGVbKCB0YWJsZXMudGFibGVYW3hwXSArIHRhYmxlcy50YWJsZVlbMF0gKyB0YWJsZXMudGFibGVaW3pwXSApXVt0YWJsZXMub2ZUYWJsZVhbeHBdICsgdGFibGVzLm9mVGFibGVZWzBdICsgdGFibGVzLm9mVGFibGVaW3pwXV07XHJcblx0XHRcdFx0XHRCbG9jTWF0cml4WzFdWzVdID0gU2VjdG9yRGF0YVRhYmxlWyggdGFibGVzLnRhYmxlWFt4cHBdICsgdGFibGVzLnRhYmxlWVswXSArIHRhYmxlcy50YWJsZVpbenBdICldW3RhYmxlcy5vZlRhYmxlWFt4cHBdICsgdGFibGVzLm9mVGFibGVZWzBdICsgdGFibGVzLm9mVGFibGVaW3pwXV07XHJcblx0XHRcdFx0XHQvLyAgICBCbG9jTWF0cml4WzFdWzZdID0gU2VjdG9yRGF0YVRhYmxlWyh0YWJsZXMudGFibGVYW3hjIF0rdGFibGVzLnRhYmxlWVswXSt0YWJsZXMudGFibGVaW3pwcF0pXVt0YWJsZXMub2ZUYWJsZVhbeGMgXSt0YWJsZXMub2ZUYWJsZVlbMF0rdGFibGVzLm9mVGFibGVaW3pwcF1dXHJcblx0XHRcdFx0XHRCbG9jTWF0cml4WzFdWzddID0gU2VjdG9yRGF0YVRhYmxlWyggdGFibGVzLnRhYmxlWFt4cF0gKyB0YWJsZXMudGFibGVZWzBdICsgdGFibGVzLnRhYmxlWlt6cHBdICldW3RhYmxlcy5vZlRhYmxlWFt4cF0gKyB0YWJsZXMub2ZUYWJsZVlbMF0gKyB0YWJsZXMub2ZUYWJsZVpbenBwXV07XHJcblx0XHRcdFx0XHQvLyAgICBCbG9jTWF0cml4WzFdWzhdID0gU2VjdG9yRGF0YVRhYmxlWyh0YWJsZXMudGFibGVYW3hwcF0rdGFibGVzLnRhYmxlWVswXSt0YWJsZXMudGFibGVaW3pwcF0pXVt0YWJsZXMub2ZUYWJsZVhbeHBwXSt0YWJsZXMub2ZUYWJsZVlbMF0rdGFibGVzLm9mVGFibGVaW3pwcF1dXHJcblxyXG5cdFx0XHRcdFx0Ly8gICAgQmxvY01hdHJpeFsyXVswXSA9IFNlY3RvckRhdGFUYWJsZVsodGFibGVzLnRhYmxlWFt4YyBdK3RhYmxlcy50YWJsZVlbMV0rdGFibGVzLnRhYmxlWlt6YyBdKV1bdGFibGVzLm9mVGFibGVYW3hjIF0rdGFibGVzLm9mVGFibGVZWzFdK3RhYmxlcy5vZlRhYmxlWlt6YyBdXVxyXG5cdFx0XHRcdFx0QmxvY01hdHJpeFsyXVsxXSA9IFNlY3RvckRhdGFUYWJsZVsoIHRhYmxlcy50YWJsZVhbeHBdICsgdGFibGVzLnRhYmxlWVsxXSArIHRhYmxlcy50YWJsZVpbemNdICldW3RhYmxlcy5vZlRhYmxlWFt4cF0gKyB0YWJsZXMub2ZUYWJsZVlbMV0gKyB0YWJsZXMub2ZUYWJsZVpbemNdXTtcclxuXHRcdFx0XHRcdC8vICAgIEJsb2NNYXRyaXhbMl1bMl0gPSBTZWN0b3JEYXRhVGFibGVbKHRhYmxlcy50YWJsZVhbeHBwXSt0YWJsZXMudGFibGVZWzFdK3RhYmxlcy50YWJsZVpbemMgXSldW3RhYmxlcy5vZlRhYmxlWFt4cHBdK3RhYmxlcy5vZlRhYmxlWVsxXSt0YWJsZXMub2ZUYWJsZVpbemMgXV1cclxuXHRcdFx0XHRcdEJsb2NNYXRyaXhbMl1bM10gPSBTZWN0b3JEYXRhVGFibGVbKCB0YWJsZXMudGFibGVYW3hjXSArIHRhYmxlcy50YWJsZVlbMV0gKyB0YWJsZXMudGFibGVaW3pwXSApXVt0YWJsZXMub2ZUYWJsZVhbeGNdICsgdGFibGVzLm9mVGFibGVZWzFdICsgdGFibGVzLm9mVGFibGVaW3pwXV07XHJcblx0XHRcdFx0XHRCbG9jTWF0cml4WzJdWzRdID0gU2VjdG9yRGF0YVRhYmxlWyggdGFibGVzLnRhYmxlWFt4cF0gKyB0YWJsZXMudGFibGVZWzFdICsgdGFibGVzLnRhYmxlWlt6cF0gKV1bdGFibGVzLm9mVGFibGVYW3hwXSArIHRhYmxlcy5vZlRhYmxlWVsxXSArIHRhYmxlcy5vZlRhYmxlWlt6cF1dO1xyXG5cdFx0XHRcdFx0QmxvY01hdHJpeFsyXVs1XSA9IFNlY3RvckRhdGFUYWJsZVsoIHRhYmxlcy50YWJsZVhbeHBwXSArIHRhYmxlcy50YWJsZVlbMV0gKyB0YWJsZXMudGFibGVaW3pwXSApXVt0YWJsZXMub2ZUYWJsZVhbeHBwXSArIHRhYmxlcy5vZlRhYmxlWVsxXSArIHRhYmxlcy5vZlRhYmxlWlt6cF1dO1xyXG5cdFx0XHRcdFx0Ly8gICAgQmxvY01hdHJpeFsyXVs2XSA9IFNlY3RvckRhdGFUYWJsZVsodGFibGVzLnRhYmxlWFt4YyBdK3RhYmxlcy50YWJsZVlbMV0rdGFibGVzLnRhYmxlWlt6cHBdKV1bdGFibGVzLm9mVGFibGVYW3hjIF0rdGFibGVzLm9mVGFibGVZWzFdK3RhYmxlcy5vZlRhYmxlWlt6cHBdXVxyXG5cdFx0XHRcdFx0QmxvY01hdHJpeFsyXVs3XSA9IFNlY3RvckRhdGFUYWJsZVsoIHRhYmxlcy50YWJsZVhbeHBdICsgdGFibGVzLnRhYmxlWVsxXSArIHRhYmxlcy50YWJsZVpbenBwXSApXVt0YWJsZXMub2ZUYWJsZVhbeHBdICsgdGFibGVzLm9mVGFibGVZWzFdICsgdGFibGVzLm9mVGFibGVaW3pwcF1dO1xyXG5cdFx0XHRcdFx0Ly8gICAgQmxvY01hdHJpeFsyXVs4XSA9IFNlY3RvckRhdGFUYWJsZVsodGFibGVzLnRhYmxlWFt4cHBdK3RhYmxlcy50YWJsZVlbMV0rdGFibGVzLnRhYmxlWlt6cHBdKV1bdGFibGVzLm9mVGFibGVYW3hwcF0rdGFibGVzLm9mVGFibGVZWzFdK3RhYmxlcy5vZlRhYmxlWlt6cHBdXVxyXG5cclxuXHRcdFx0XHRcdGZvciggeWMgPSAwOyB5YyA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHljKysgKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHR5cCA9IHljICsgMTsgeXBwID0geWMgKyAyO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gU2Nyb2xsaW5nIGJsb2MgbWF0cml4IGJ5IGV4Y2hhbmdpbmd5cHAgcmVmZXJlbmNlcy5cclxuXHRcdFx0XHRcdFx0dG1wcCA9IEJsb2NNYXRyaXhbMF07XHJcblx0XHRcdFx0XHRcdEJsb2NNYXRyaXhbMF0gPSBCbG9jTWF0cml4WzFdO1xyXG5cdFx0XHRcdFx0XHRCbG9jTWF0cml4WzFdID0gQmxvY01hdHJpeFsyXTtcclxuXHRcdFx0XHRcdFx0QmxvY01hdHJpeFsyXSA9IHRtcHA7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBGZXRjaGluZyBhIG5ldyBibG9jIG9mIGRhdGEgc2xpY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoZXJlT2ZzO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gICAgICBCbG9jTWF0cml4WzJdWzBdID0gU2VjdG9yRGF0YVRhYmxlWyh0YWJsZXMudGFibGVYW3hjIF0rdGFibGVzLnRhYmxlWVt5cHBdK3RhYmxlcy50YWJsZVpbemMgXSldLkRhdGE7ICAgIFt0YWJsZXMub2ZUYWJsZVhbeGMgXSt0YWJsZXMub2ZUYWJsZVlbeXBwXSt0YWJsZXMub2ZUYWJsZVpbemMgXV1cclxuXHRcdFx0XHRcdFx0QmxvY01hdHJpeFsyXVsxXSA9IFNlY3RvckRhdGFUYWJsZVsoIHRhYmxlcy50YWJsZVhbeHBdICsgdGFibGVzLnRhYmxlWVt5cHBdICsgdGFibGVzLnRhYmxlWlt6Y10gKV1bdGFibGVzLm9mVGFibGVYW3hwXSArIHRhYmxlcy5vZlRhYmxlWVt5cHBdICsgdGFibGVzLm9mVGFibGVaW3pjXV07XHJcblx0XHRcdFx0XHRcdC8vICAgICAgQmxvY01hdHJpeFsyXVsyXSA9IFNlY3RvckRhdGFUYWJsZVsodGFibGVzLnRhYmxlWFt4cHBdK3RhYmxlcy50YWJsZVlbeXBwXSt0YWJsZXMudGFibGVaW3pjIF0pXS5EYXRhO1x0ICAgW3RhYmxlcy5vZlRhYmxlWFt4cHBdK3RhYmxlcy5vZlRhYmxlWVt5cHBdK3RhYmxlcy5vZlRhYmxlWlt6YyBdXVxyXG5cdFx0XHRcdFx0XHRCbG9jTWF0cml4WzJdWzNdID0gU2VjdG9yRGF0YVRhYmxlWyggdGFibGVzLnRhYmxlWFt4Y10gKyB0YWJsZXMudGFibGVZW3lwcF0gKyB0YWJsZXMudGFibGVaW3pwXSApXVt0YWJsZXMub2ZUYWJsZVhbeGNdICsgdGFibGVzLm9mVGFibGVZW3lwcF0gKyB0YWJsZXMub2ZUYWJsZVpbenBdXTtcclxuXHRcdFx0XHRcdFx0QmxvY01hdHJpeFsyXVs0XSA9IFNlY3RvckRhdGFUYWJsZVsoIHRhYmxlcy50YWJsZVhbeHBdICsgdGFibGVzLnRhYmxlWVt5cHBdICsgdGFibGVzLnRhYmxlWlt6cF0gKV1bdGFibGVzLm9mVGFibGVYW3hwXSArIHRhYmxlcy5vZlRhYmxlWVt5cHBdICsgdGFibGVzLm9mVGFibGVaW3pwXV07XHJcblx0XHRcdFx0XHRcdEJsb2NNYXRyaXhbMl1bNV0gPSBTZWN0b3JEYXRhVGFibGVbKCB0YWJsZXMudGFibGVYW3hwcF0gKyB0YWJsZXMudGFibGVZW3lwcF0gKyB0YWJsZXMudGFibGVaW3pwXSApXVt0YWJsZXMub2ZUYWJsZVhbeHBwXSArIHRhYmxlcy5vZlRhYmxlWVt5cHBdICsgdGFibGVzLm9mVGFibGVaW3pwXV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAhQmxvY01hdHJpeFsyXVs1XSApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIFwidm94ZWwgaW4gc2VjdG9yIGhhcyBiZWNvbWUgdW5kZWZpbmVkLlwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9kZWJ1Z2dlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblx0XHRcdFx0XHRcdC8vICAgICAgQmxvY01hdHJpeFsyXVs2XSA9IFNlY3RvckRhdGFUYWJsZVsodGFibGVzLnRhYmxlWFt4YyBdK3RhYmxlcy50YWJsZVlbeXBwXSt0YWJsZXMudGFibGVaW3pwcF0pXS5EYXRhO1x0ICAgW3RhYmxlcy5vZlRhYmxlWFt4YyBdK3RhYmxlcy5vZlRhYmxlWVt5cHBdK3RhYmxlcy5vZlRhYmxlWlt6cHBdXVxyXG5cdFx0XHRcdFx0XHRCbG9jTWF0cml4WzJdWzddID0gU2VjdG9yRGF0YVRhYmxlWyggdGFibGVzLnRhYmxlWFt4cF0gKyB0YWJsZXMudGFibGVZW3lwcF0gKyB0YWJsZXMudGFibGVaW3pwcF0gKV1bdGFibGVzLm9mVGFibGVYW3hwXSArIHRhYmxlcy5vZlRhYmxlWVt5cHBdICsgdGFibGVzLm9mVGFibGVaW3pwcF1dO1xyXG5cdFx0XHRcdFx0XHQvLyAgICAgIEJsb2NNYXRyaXhbMl1bOF0gPSBTZWN0b3JEYXRhVGFibGVbKHRhYmxlcy50YWJsZVhbeHBwXSt0YWJsZXMudGFibGVZW3lwcF0rdGFibGVzLnRhYmxlWlt6cHBdKV0uRGF0YTtcdCAgIFt0YWJsZXMub2ZUYWJsZVhbeHBwXSt0YWJsZXMub2ZUYWJsZVlbeXBwXSt0YWJsZXMub2ZUYWJsZVpbenBwXV1cclxuXHJcblx0XHRcdFx0XHRcdC8vIENvbXB1dGUgZmFjZSBjdWxsaW5nIGluZm9cclxuXHRcdFx0XHRcdFx0aW5mbyA9IDA7XHJcblx0XHRcdFx0XHRcdGlmKCBCbG9jTWF0cml4WzFdWzRdIClcclxuXHRcdFx0XHRcdFx0e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IE1haW5Wb3hlbERyYXdJbmZvID0gQmxvY01hdHJpeFsxXVs0XS5wcm9wZXJ0aWVzLkRyYXdJbmZvO1xyXG5cdFx0XHRcdFx0XHRcdGxldCBTdWJUYWJsZSA9IFZveGVsYXJpdW0uSW50RmFjZVN0YXRlVGFibGVbTWFpblZveGVsRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU107XHJcblxyXG5cdFx0XHRcdFx0XHRcdGluZm8gfD0gKCAoIFN1YlRhYmxlW0Jsb2NNYXRyaXhbMV1bMV0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXSApICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApO1xyXG5cdFx0XHRcdFx0XHRcdGluZm8gfD0gKCAoIFN1YlRhYmxlW0Jsb2NNYXRyaXhbMV1bN10ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXSApICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEICk7XHJcblx0XHRcdFx0XHRcdFx0aW5mbyB8PSAoICggU3ViVGFibGVbQmxvY01hdHJpeFsxXVszXS5wcm9wZXJ0aWVzLkRyYXdJbmZvICYgVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fQ1VMTElOR0JJVFNdICkgJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCApO1xyXG5cdFx0XHRcdFx0XHRcdGluZm8gfD0gKCAoIFN1YlRhYmxlW0Jsb2NNYXRyaXhbMV1bNV0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXSApICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUICk7XHJcblx0XHRcdFx0XHRcdFx0aW5mbyB8PSAoICggU3ViVGFibGVbQmxvY01hdHJpeFswXVs0XS5wcm9wZXJ0aWVzLkRyYXdJbmZvICYgVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fQ1VMTElOR0JJVFNdICkgJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVMT1cgKTtcclxuXHRcdFx0XHRcdFx0XHRpbmZvIHw9ICggKCBTdWJUYWJsZVtCbG9jTWF0cml4WzJdWzRdLnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU10gKSAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BQk9WRSApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBXcml0ZSBmYWNlIGN1bGxpbmcgaW5mbyB0byBmYWNlIGN1bGxpbmcgdGFibGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VjdG9yLmRhdGEuRmFjZUN1bGxpbmdbdGFibGVzLm9mVGFibGVYW3hwXSArIHRhYmxlcy5vZlRhYmxlWVt5cF0gKyB0YWJsZXMub2ZUYWJsZVpbenBdXSA9IGluZm87XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQsU2VjdG9yVXBkYXRlRmFjZUN1bGxpbmdfUGFydGlhbCA6IGZ1bmN0aW9uICggY2x1c3Rlciwgc2VjdG9yXHJcblx0XHRcdFx0XHQsIEZhY2VzVG9EcmF3LCBJc29sYXRlZCApXHJcblx0XHR7XHJcblx0XHRcdHZhciBNaXNzaW5nU2VjdG9yO1xyXG5cdFx0XHR2YXIgU2VjdG9yX0luLCBTZWN0b3JfT3V0O1xyXG5cdFx0XHR2YXIgaTtcclxuXHRcdFx0dmFyIEN1bGVkRmFjZXM7XHJcblx0XHRcdHZhciBPZmZfSXAsIE9mZl9JbiwgT2ZmX09wLCBPZmZfT3V0LCBPZmZfQXV4O1xyXG5cdFx0XHR2YXIgVm94ZWxEYXRhX0luLCBWb3hlbERhdGFfT3V0O1xyXG5cdFx0XHR2YXIgVm94ZWxGQ19JbjtcclxuXHRcdFx0dmFyIHgsIHksIHo7XHJcblx0XHRcdHZhciBGYWNlU3RhdGU7XHJcblx0XHRcdC8vZXh0ZXJuIHVzaG9ydCBJbnRGYWNlU3RhdGVUYWJsZVtdWzhdO1xyXG5cclxuXHRcdFx0eCA9IHNlY3Rvci5wb3MueDtcclxuXHRcdFx0eSA9IHNlY3Rvci5wb3MueTtcclxuXHRcdFx0eiA9IHNlY3Rvci5wb3MuejtcclxuXHJcblx0XHRcdGlmKCBJc29sYXRlZCApIE1pc3NpbmdTZWN0b3IgPSBjbHVzdGVyLldvcmtpbmdFbXB0eVNlY3RvcjtcclxuXHRcdFx0ZWxzZSBNaXNzaW5nU2VjdG9yID0gY2x1c3Rlci5Xb3JraW5nRnVsbFNlY3RvcjtcclxuXHJcblx0XHRcdFNlY3Rvcl9JbiA9IHNlY3RvcjsgaWYoIFNlY3Rvcl9JbiA9PSBudWxsICkgcmV0dXJuICggMCApO1xyXG5cdFx0XHRTZWN0b3JfT3V0ID0gbnVsbDsgIC8vIGFnYWluIGEgcmVkdW5kYW50IGFzc2lnbm1lbnRcclxuXHRcdFx0Q3VsZWRGYWNlcyA9IDA7XHJcblxyXG5cdFx0XHQvLyBUb3AgU2lkZVxyXG4gICAgICBWb3hlbEZDX0luID0gU2VjdG9yX0luLmRhdGEuRmFjZUN1bGxpbmc7XHJcbiAgICAgIFZveGVsRGF0YV9JbiA9IFNlY3Rvcl9Jbi5kYXRhO1xyXG5cclxuXHRcdFx0aWYoICggRmFjZXNUb0RyYXcgJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgKSAhPSAwIClcclxuXHRcdFx0XHRpZiggKCAoIFNlY3Rvcl9PdXQgPSBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXSlcclxuICAgICAgICAgICB8fCAoIFNlY3Rvcl9PdXQgPSBNaXNzaW5nU2VjdG9yICkgKSAgKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdFZveGVsRGF0YV9PdXQgPSBTZWN0b3JfT3V0LmRhdGE7XHJcblxyXG5cdFx0XHRcdFx0Zm9yKCBPZmZfSXAgPSBjbHVzdGVyLnNlY3RvclNpemVZIC0gMSwgT2ZmX09wID0gMDtcclxuXHRcdFx0XHRcdFx0T2ZmX0lwIDwgKCBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWCApO1xyXG5cdFx0XHRcdFx0XHRPZmZfSXAgKz0gY2x1c3Rlci5zZWN0b3JTaXplWSxcclxuXHRcdFx0XHRcdFx0T2ZmX09wICs9IGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSAvLyB4ICgwLi4xNSlcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0Zm9yKCBPZmZfQXV4ID0gMDtcclxuXHRcdFx0XHRcdFx0XHRPZmZfQXV4IDwgKCBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVogKTtcclxuXHRcdFx0XHRcdFx0XHRPZmZfQXV4ICs9ICggY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSApIC8vIHogKDAuLjE1KVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0T2ZmX0luID0gT2ZmX0lwICsgT2ZmX0F1eDtcclxuXHRcdFx0XHRcdFx0XHRPZmZfT3V0ID0gT2ZmX09wICsgT2ZmX0F1eDtcclxuXHRcdFx0XHRcdFx0XHRGYWNlU3RhdGUgPSBWb3hlbGFyaXVtLkludEZhY2VTdGF0ZVRhYmxlW1ZveGVsRGF0YV9Jbi5kYXRhW09mZl9Jbl0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXVtWb3hlbERhdGFfT3V0LmRhdGFbT2ZmX091dF0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXTtcclxuXHRcdFx0XHRcdFx0XHRpZiggRmFjZVN0YXRlICE9IDAgKSBWb3hlbEZDX0luW09mZl9Jbl0gfD0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFO1xyXG5cdFx0XHRcdFx0XHRcdGVsc2UgVm94ZWxGQ19JbltPZmZfSW5dICY9ICggKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFICkgJiAweEZGICk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdEN1bGVkRmFjZXMgfD0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0Ly8gQm90dG9tIFNpZGVcclxuXHJcblx0XHRcdGlmKCAoIEZhY2VzVG9EcmF3ICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XICkgIT0gMCApXHJcblx0XHRcdFx0aWYoICggKCBTZWN0b3JfT3V0ID0gc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XIC0gMV0pIHx8ICggU2VjdG9yX091dCA9IE1pc3NpbmdTZWN0b3IpKSAhPSBudWxsIClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRWb3hlbERhdGFfT3V0ID0gU2VjdG9yX091dC5kYXRhO1xyXG5cclxuXHRcdFx0XHRcdGZvciggT2ZmX0lwID0gMCwgT2ZmX09wID0gY2x1c3Rlci5zZWN0b3JTaXplWSAtIDE7XHJcblx0XHRcdFx0XHRcdCBPZmZfSXAgPCAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKiBjbHVzdGVyLnNlY3RvclNpemVaICk7XHJcblx0XHRcdFx0XHRcdCBPZmZfSXAgKz0gY2x1c3Rlci5zZWN0b3JTaXplWSxcclxuXHRcdFx0XHRcdFx0IE9mZl9PcCArPSBjbHVzdGVyLnNlY3RvclNpemVZICkgLy8geCAoMC4uMTUpXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGZvciggT2ZmX0F1eCA9IDA7XHJcblx0XHRcdFx0XHRcdFx0IE9mZl9BdXggPCAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWiApO1xyXG5cdFx0XHRcdFx0XHRcdCBPZmZfQXV4ICs9ICggY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSApIC8vIHogKDAuLjE1KVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0T2ZmX0luID0gT2ZmX0lwICsgT2ZmX0F1eDtcclxuXHRcdFx0XHRcdFx0XHRPZmZfT3V0ID0gT2ZmX09wICsgT2ZmX0F1eDtcclxuXHRcdFx0XHRcdFx0XHRWb3hlbF9JbiA9IFZveGVsRGF0YV9Jbi5kYXRhW09mZl9Jbl07XHJcblx0XHRcdFx0XHRcdFx0Vm94ZWxfT3V0ID0gVm94ZWxEYXRhX091dC5kYXRhW09mZl9PdXRdO1xyXG5cdFx0XHRcdFx0XHRcdC8vWlZveGVsVHlwZSAqIFZ0SW4gPSAgVm94ZWxUeXBlVGFibGVbIFZveGVsX0luIF07XHJcblx0XHRcdFx0XHRcdFx0Ly9aVm94ZWxUeXBlICogVnRPdXQgPSBWb3hlbFR5cGVUYWJsZVsgVm94ZWxfT3V0IF07XHJcblxyXG5cclxuXHRcdFx0XHRcdFx0XHRGYWNlU3RhdGUgPSBWb3hlbGFyaXVtLkludEZhY2VTdGF0ZVRhYmxlW1ZveGVsX0luLnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU11bVm94ZWxfT3V0LnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU107XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vRmFjZVN0YXRlID0gSW50RmFjZVN0YXRlVGFibGVbIFZveGVsVHlwZVRhYmxlWyBWb3hlbERhdGFfSW4uRGF0YVtPZmZfSW5dIF0uRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUUyBdWyBWb3hlbFR5cGVUYWJsZVsgVm94ZWxEYXRhX091dC5EYXRhW09mZl9PdXRdIF0uRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUUyBdO1xyXG5cdFx0XHRcdFx0XHRcdGlmKCBGYWNlU3RhdGUgIT0gMCApIFZveGVsRkNfSW5bT2ZmX0luXSB8PSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVMT1c7XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSBWb3hlbEZDX0luW09mZl9Jbl0gJj0gKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XICYgMHhGRiApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRDdWxlZEZhY2VzIHw9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUxPVztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBMZWZ0IFNpZGVcclxuXHJcblx0XHRcdFx0XHRpZiggKCBGYWNlc1RvRHJhdyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUICkgIT0gMCApXHJcblx0XHRcdFx0aWYoICggKCBTZWN0b3JfT3V0ID0gc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXSkgfHwgKCBTZWN0b3JfT3V0ID0gTWlzc2luZ1NlY3RvcikpICE9IG51bGwgKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdFZveGVsRGF0YV9PdXQgPSBTZWN0b3JfT3V0LmRhdGE7XHJcblx0XHRcdFx0XHQvLyBWb3hlbERhdGFfSW5bNjNdPTE7XHJcblx0XHRcdFx0XHQvLyBWb3hlbERhdGFfSW5bNjMgKyBjbHVzdGVyLnNlY3RvclNpemVZKjE1IF09MTQ7IC8vIHhcclxuXHRcdFx0XHRcdC8vIFZveGVsRGF0YV9Jbls2MyArIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKiBjbHVzdGVyLnNlY3RvclNpemVYICogMTVdID0gMTM7IC8vIHpcclxuXHJcblx0XHRcdFx0XHRmb3IoIE9mZl9JcCA9IDAsIE9mZl9PcCA9IChjbHVzdGVyLnNlY3RvclNpemVZICogKCBjbHVzdGVyLnNlY3RvclNpemVYIC0gMSApKTtcclxuXHRcdFx0XHRcdFx0T2ZmX0lwIDwgKCBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVogKTtcclxuXHRcdFx0XHRcdFx0T2ZmX0lwICs9ICggY2x1c3Rlci5zZWN0b3JTaXplWSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKSxcclxuXHRcdFx0XHRcdFx0T2ZmX09wICs9ICggY2x1c3Rlci5zZWN0b3JTaXplWSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKSApIC8vIHogKDAuLjE1KVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRmb3IoIE9mZl9BdXggPSAwOyBPZmZfQXV4IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgT2ZmX0F1eCsrICkgLy8geSAoMC4uNjMpXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRPZmZfSW4gPSBPZmZfSXAgKyBPZmZfQXV4O1xyXG5cdFx0XHRcdFx0XHRcdE9mZl9PdXQgPSBPZmZfT3AgKyBPZmZfQXV4O1xyXG5cdFx0XHRcdFx0XHRcdC8vVm94ZWxEYXRhX0luW09mZl9Jbl09MTsgVm94ZWxEYXRhX091dFtPZmZfT3V0XT0xNDtcclxuXHRcdFx0XHRcdFx0XHRGYWNlU3RhdGUgPSBWb3hlbGFyaXVtLkludEZhY2VTdGF0ZVRhYmxlW1ZveGVsRGF0YV9Jbi5kYXRhW09mZl9Jbl0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXVtWb3hlbERhdGFfT3V0LmRhdGFbT2ZmX091dF0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXTtcclxuXHRcdFx0XHRcdFx0XHRpZiggRmFjZVN0YXRlICE9IDAgKSBWb3hlbEZDX0luW09mZl9Jbl0gfD0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkxFRlQ7XHJcblx0XHRcdFx0XHRcdFx0ZWxzZSBWb3hlbEZDX0luW09mZl9Jbl0gJj0gKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkxFRlQgJiAweEZGICk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdEN1bGVkRmFjZXMgfD0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkxFRlQ7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gUmlnaHQgU2lkZVxyXG5cclxuXHRcdFx0aWYoICggRmFjZXNUb0RyYXcgJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuUklHSFQgKSAhPSAwIClcclxuXHRcdFx0XHRpZiggKCAoIFNlY3Rvcl9PdXQgPSBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXSkgfHwgKCBTZWN0b3JfT3V0ID0gTWlzc2luZ1NlY3RvcikpICE9IG51bGwgKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdFZveGVsRGF0YV9PdXQgPSBTZWN0b3JfT3V0LmRhdGE7XHJcblxyXG5cdFx0XHRcdFx0Zm9yKCBPZmZfSXAgPSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKiAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVggLSAxICkpLCBPZmZfT3AgPSAwO1xyXG5cdFx0XHRcdFx0XHRPZmZfT3AgPCAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWiApO1xyXG5cdFx0XHRcdFx0XHRPZmZfSXAgKz0gKCBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWCApLCBPZmZfT3AgKz0gKCBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWCApICkgLy8geiAoMC4uMTUpXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGZvciggT2ZmX0F1eCA9IDA7IE9mZl9BdXggPCBjbHVzdGVyLnNlY3RvclNpemVZOyBPZmZfQXV4KysgKSAvLyB5ICgwLi42MylcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdE9mZl9JbiA9IE9mZl9JcCArIE9mZl9BdXg7XHJcblx0XHRcdFx0XHRcdFx0T2ZmX091dCA9IE9mZl9PcCArIE9mZl9BdXg7XHJcblx0XHRcdFx0XHRcdFx0RmFjZVN0YXRlID0gVm94ZWxhcml1bS5JbnRGYWNlU3RhdGVUYWJsZVtWb3hlbERhdGFfSW4uZGF0YVtPZmZfSW5dLnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU11bVm94ZWxEYXRhX091dC5kYXRhW09mZl9PdXRdLnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU107XHJcblx0XHRcdFx0XHRcdFx0aWYoIEZhY2VTdGF0ZSAhPSAwICkgVm94ZWxGQ19JbltPZmZfSW5dIHw9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVDsgZWxzZSBWb3hlbEZDX0luW09mZl9Jbl0gJj0gKCB+Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUICYgMHhGRiApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRDdWxlZEZhY2VzIHw9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVDtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBGcm9udCBTaWRlXHJcblxyXG5cdFx0XHRpZiggKCBGYWNlc1RvRHJhdyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCApICE9IDAgKVxyXG5cdFx0XHRcdGlmKCAoICggU2VjdG9yX091dCA9IHNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDFdKSB8fCAoIFNlY3Rvcl9PdXQgPSBNaXNzaW5nU2VjdG9yKSkgIT0gbnVsbCApXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Vm94ZWxEYXRhX091dCA9IFNlY3Rvcl9PdXQuZGF0YTtcclxuXHJcblx0XHRcdFx0XHRmb3IoIE9mZl9JcCA9ICggY2x1c3Rlci5zZWN0b3JTaXplWSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVogLSAxICkgKSwgT2ZmX09wID0gMDtcclxuXHRcdFx0XHRcdFx0T2ZmX09wIDwgKCBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWCApO1xyXG5cdFx0XHRcdFx0XHRPZmZfSXAgKz0gY2x1c3Rlci5zZWN0b3JTaXplWSwgT2ZmX09wICs9IGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSAvLyB4ICgwLi4xNSlcclxuXHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0Zm9yKCBPZmZfQXV4ID0gMDsgT2ZmX0F1eCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IE9mZl9BdXgrKyApIC8vIHkgKDAuLjYzKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0T2ZmX0luID0gT2ZmX0lwICsgT2ZmX0F1eDtcclxuXHRcdFx0XHRcdFx0XHRPZmZfT3V0ID0gT2ZmX09wICsgT2ZmX0F1eDtcclxuXHRcdFx0XHRcdFx0XHRGYWNlU3RhdGUgPSBWb3hlbGFyaXVtLkludEZhY2VTdGF0ZVRhYmxlW1ZveGVsRGF0YV9Jbi5kYXRhW09mZl9Jbl0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXVtWb3hlbERhdGFfT3V0LmRhdGFbT2ZmX091dF0ucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX0NVTExJTkdCSVRTXTtcclxuXHRcdFx0XHRcdFx0XHRpZiggRmFjZVN0YXRlICE9IDAgKSBWb3hlbEZDX0luW09mZl9Jbl0gfD0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEO1xyXG5cdFx0XHRcdFx0XHRcdGVsc2UgVm94ZWxGQ19JbltPZmZfSW5dICY9ICggflZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCAmIDB4RkYgKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Q3VsZWRGYWNlcyB8PSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUhFQUQ7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gQmFjayBTaWRlXHJcblxyXG5cdFx0XHRpZiggKCBGYWNlc1RvRHJhdyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQgKSAhPSAwIClcclxuXHRcdFx0XHRpZiggKCAoIFNlY3Rvcl9PdXQgPSBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV0gKSB8fCAoIFNlY3Rvcl9PdXQgPSBNaXNzaW5nU2VjdG9yICkgKSAhPSBudWxsIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFZveGVsRGF0YV9PdXQgPSBTZWN0b3JfT3V0LmRhdGE7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGZvciggT2ZmX0lwID0gMCwgT2ZmX09wID0gKCBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWCAqICggY2x1c3Rlci5zZWN0b3JTaXplWiAtIDEgKSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0T2ZmX0lwIDwgKCBjbHVzdGVyLnNlY3RvclNpemVZICogY2x1c3Rlci5zZWN0b3JTaXplWCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0T2ZmX0lwICs9IGNsdXN0ZXIuc2VjdG9yU2l6ZVksIE9mZl9PcCArPSBjbHVzdGVyLnNlY3RvclNpemVZICkgLy8geCAoMC4uMTUpXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCBPZmZfQXV4ID0gMDsgT2ZmX0F1eCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IE9mZl9BdXgrKyApIC8vIHkgKDAuLjYzKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRPZmZfSW4gPSBPZmZfSXAgKyBPZmZfQXV4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRPZmZfT3V0ID0gT2ZmX09wICsgT2ZmX0F1eDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0RmFjZVN0YXRlID0gVm94ZWxhcml1bS5JbnRGYWNlU3RhdGVUYWJsZVtWb3hlbERhdGFfSW4uZGF0YVtPZmZfSW5dLnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU11bVm94ZWxEYXRhX091dC5kYXRhW09mZl9PdXRdLnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19DVUxMSU5HQklUU107XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCBGYWNlU3RhdGUgIT0gMCApIFZveGVsRkNfSW5bT2ZmX0luXSB8PSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVISU5EOyBlbHNlIFZveGVsRkNfSW5bT2ZmX0luXSAmPSAoIH5Wb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVISU5EICYgMHhGRiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRDdWxlZEZhY2VzIHw9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQ7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdC8vc2VjdG9yLlBhcnRpYWxDdWxsaW5nIF49IEN1bGVkRmFjZXMgJiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BQk9WRSB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUxPVyB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApO1xyXG5cdFx0XHQvL3NlY3Rvci5QYXJ0aWFsQ3VsbGluZyAmPSAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BQk9WRSB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUxPVyB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApO1xyXG5cdFx0XHRpZiggQ3VsZWRGYWNlcyAhPSAwIClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdC8vTG9nLmxvZyggXCJzZWN0b3IgezB9IHsxfSB7Mn0gaXMgZGlydHlcIiwgc2VjdG9yLnBvcy54LCBzZWN0b3IucG9zLnksIHNlY3Rvci5wb3MueiApO1xyXG5cdFx0XHRcdFNlY3Rvcl9PdXQuRmxhZ19SZW5kZXJfRGlydHkgPSB0cnVlO1xyXG4gICAgICAgIFNlY3Rvcl9Jbi5GbGFnX1JlbmRlcl9EaXJ0eSA9IHRydWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHJldHVybiAoIEN1bGVkRmFjZXMgKTtcclxuXHRcdH1cclxuXHJcblx0XHQsIFVwZGF0ZUN1bGxpbmcgOiBmdW5jdGlvbiAoIExvY2F0aW9uLCBJbXBvcnRhbmNlRmFjdG9yIClcclxuXHRcdHtcclxuXHRcdFx0aWYoIExvY2F0aW9uLnNlY3RvciA9PSBudWxsIClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cdFx0XHRMb2NhdGlvbi5zZWN0b3IuY2x1c3Rlci5jdWxsZXIuQ3VsbFNpbmdsZVZveGVsKCBMb2NhdGlvbi5zZWN0b3IsIExvY2F0aW9uLk9mZnNldCApO1xyXG5cclxuXHRcdFx0TG9jYXRpb24uc2VjdG9yLkZsYWdfSXNNb2RpZmllZCB8PSBJbXBvcnRhbmNlRmFjdG9yO1xyXG5cdFx0fVxyXG5cclxuXHRcdCwgU2V0Vm94ZWxfV2l0aEN1bGxpbmdVcGRhdGUgOiBmdW5jdGlvbiAoIFZveGVsVHlwZVxyXG5cdFx0XHRcdFx0XHRcdCwgSW1wb3J0YW5jZUZhY3RvclxyXG5cdFx0XHRcdFx0XHRcdCwgQ3JlYXRlRXh0ZW5zaW9uXHJcblx0XHRcdFx0XHRcdFx0LCBMb2NhdGlvbiApXHJcblx0XHR7XHJcblx0XHRcdGlmKCAhTG9jYXRpb24uc2VjdG9yIClcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblxyXG5cdFx0XHQvLyBEZWxldGUgT2xkIHZveGVsIGV4dGVuZGVkIGluZm9ybWF0aW9ucyBpZiBhbnlcclxuXHRcdFx0dmFyIFZveGVsID0gTG9jYXRpb24uc2VjdG9yLmRhdGEuZGF0YVtMb2NhdGlvbi5PZmZzZXRdO1xyXG5cdFx0XHR2YXIgT3RoZXJJbmZvcyA9IExvY2F0aW9uLnNlY3Rvci5kYXRhLm90aGVySW5mb3NbTG9jYXRpb24uT2Zmc2V0XTtcclxuXHJcblx0XHRcdGlmKCBPdGhlckluZm9zIClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKCBWb3hlbFR5cGUucHJvcGVydGllcy5Jc19IYXNBbGxvY2F0ZWRNZW1vcnlFeHRlbnNpb24gKSBWb3hlbC5kZWxldGVWb3hlbEV4dGVuc2lvbiggb3RoZXJJbmZvcyApO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBTdG9yaW5nIEV4dGVuc2lvblxyXG5cdFx0XHRpZiggVm94ZWxUeXBlLmNyZWF0ZVZveGVsRXh0ZW5zaW9uIClcclxuXHRcdFx0XHRMb2NhdGlvbi5zZWN0b3IuRGF0YS5PdGhlckluZm9zW0xvY2F0aW9uLk9mZnNldF0gPSBWb3hlbFR5cGUuY3JlYXRlVm94ZWxFeHRlbnNpb24oKTtcclxuXHJcblx0XHRcdC8vIFN0b3JpbmcgVm94ZWxcclxuXHJcblx0XHRcdExvY2F0aW9uLnNlY3Rvci5kYXRhLmRhdGFbTG9jYXRpb24uT2Zmc2V0XSA9IFZveGVsVHlwZTtcclxuXHJcblx0XHRcdGlmKCBWb3hlbFR5cGUucHJvcGVydGllcy5Jc19BY3RpdmUgKVxyXG5cdFx0XHRcdExvY2F0aW9uLnNlY3Rvci5GbGFnX0lzQWN0aXZlVm94ZWxzID0gdHJ1ZTtcclxuXHJcblx0XHRcdFVwZGF0ZUN1bGxpbmcoIExvY2F0aW9uLCBJbXBvcnRhbmNlRmFjdG9yICk7XHJcblx0XHRcdHJldHVybiAoIHRydWUgKTtcclxuXHRcdH1cclxuXHJcblx0XHQsIE1ha2VTZWN0b3JSZW5kZXJpbmdEYXRhIDogZnVuY3Rpb24gKCBzZWN0b3IgKVxyXG5cdFx0e1xyXG5cdFx0XHR2YXIgZmFjZSA9IG5ldyBUSFJFRS5WZWN0b3I0KCAyNTUsIDAsIDAsIDI1NSApLCBlZGdlID0gbmV3IFRIUkVFLlZlY3RvcjQoIDAsIDAsIDAsIDI1NSApO1xyXG5cdFx0XHR2YXIgcG93ZXIgPSA0MDA7XHJcblx0XHRcdHZhciB4LCB5LCB6O1xyXG5cdFx0XHR2YXIgb2ZzO1xyXG5cdFx0XHR2YXIgaW5mbztcclxuXHRcdFx0dmFyIGN1YmU7XHJcblx0XHRcdC8qIGJ1aWxkIHNlY3RvciBnZW9tZXRyeSAqL1xyXG4gICAgICB2YXIgY2x1c3RlciA9IHNlY3Rvci5jbHVzdGVyO1xyXG5cdFx0XHR2YXIgT2Zmc2V0O1xyXG5cdFx0XHR2YXIgY3VieCwgY3VieSwgY3ViejtcclxuXHRcdFx0dmFyIFNlY3Rvcl9EaXNwbGF5X3gsIFNlY3Rvcl9EaXNwbGF5X3ksIFNlY3Rvcl9EaXNwbGF5X3o7XHJcblx0XHRcdHZhciBEcmF3O1xyXG4gICAgICAgICAgICB2YXIgUDAsUDEsUDIsUDMsUDQsUDUsUDYsUDc7XHJcblxyXG4gICAgICAgICAgICBpZiggIXNlY3Rvci5zb2xpZF9nZW9tZXRyeSApIHtcclxuICAgICAgICAgICAgICAgIHNlY3Rvci5zb2xpZF9nZW9tZXRyeSA9IGNsdXN0ZXIuZ2V0R2VvbWV0cnlCdWZmZXIoKTtcclxuICAgICAgICAgICAgICAgIHNlY3Rvci5GbGFnX1JlbmRlcl9EaXJ0eSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYoICFzZWN0b3IuZGF0YS5GYWNlQ3VsbGluZyApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHNlY3Rvci5jdWxsZXIgPSBjbHVzdGVyLm1lc2hlci5jdWxsZXI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRDdWxsaW5nKCBzZWN0b3IgKTtcclxuICAgICAgICAgICAgICB9XHJcblx0XHRcdC8vIERpc3BsYXkgbGlzdCBjcmVhdGlvbiBvciByZXVzZS5cclxuXHRcdFx0aWYoIHNlY3Rvci5GbGFnX1JlbmRlcl9EaXJ0eSApXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgZ2VvbWV0cnkgPSBzZWN0b3Iuc29saWRfZ2VvbWV0cnk7XHJcblx0XHRcdFx0dmFyIHZveGVsU2l6ZSA9IGNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuXHRcdFx0XHR2YXIgRmFjZUN1bGxpbmcgPSBzZWN0b3IuZGF0YS5GYWNlQ3VsbGluZztcclxuXHRcdFx0XHQvL0xvZy5sb2coIFwiSXMgRGlydHkgQnVpbGRpbmcgc2VjdG9yIHswfSB7MX0gezJ9XCIsIHNlY3Rvci5wb3MueCwgc2VjdG9yLnBvcy55LCBzZWN0b3IucG9zLnogKTtcclxuXHRcdFx0XHRTZWN0b3JfRGlzcGxheV94ID0gKCBzZWN0b3IucG9zLnggKiBjbHVzdGVyLnNlY3RvclNpemVYICogdm94ZWxTaXplICk7XHJcblx0XHRcdFx0U2VjdG9yX0Rpc3BsYXlfeSA9ICggc2VjdG9yLnBvcy55ICogY2x1c3Rlci5zZWN0b3JTaXplWSAqIHZveGVsU2l6ZSApO1xyXG5cdFx0XHRcdFNlY3Rvcl9EaXNwbGF5X3ogPSAoIHNlY3Rvci5wb3MueiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVogKiB2b3hlbFNpemUgKTtcclxuXHJcblx0XHRcdFx0c2VjdG9yLkZsYWdfVm9pZF9SZWd1bGFyID0gdHJ1ZTtcclxuXHRcdFx0XHRzZWN0b3IuRmxhZ19Wb2lkX1RyYW5zcGFyZW50ID0gdHJ1ZTtcclxuXHRcdFx0XHRzZWN0b3IuRmxhZ19Wb2lkX0N1c3RvbSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAvL3NlY3Rvci5waHlzaWNzLkVtcHR5ID0gdHJ1ZTtcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRnZW9tZXRyeS5jbGVhcigpO1xyXG5cdFx0XHRcdFx0LypcclxuXHRcdFx0XHRcdExvZy5sb2coIFwic2VjdG9yIGlzIHs2fSB7N30gezh9IG5lYXIgbHswfSByezF9IGFiezJ9IGJsezN9IGJoezR9IGFoezV9XCJcclxuXHRcdFx0XHRcdFx0LCAoIHNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZULTFdICE9IG51bGwgKSA/IFwiWWVzXCIgOiBcIm5vXCJcclxuXHRcdFx0XHRcdFx0LCAoIHNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdICE9IG51bGwgKSA/IFwiWWVzXCIgOiBcIm5vXCJcclxuXHRcdFx0XHRcdFx0LCAoIHNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSAtIDFdICE9IG51bGwgKSA/IFwiWWVzXCIgOiBcIm5vXCJcclxuXHRcdFx0XHRcdFx0LCAoIHNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdICE9IG51bGwgKSA/IFwiWWVzXCIgOiBcIm5vXCJcclxuXHRcdFx0XHRcdFx0LCAoIHNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkQgLSAxXSAhPSBudWxsICkgPyBcIlllc1wiIDogXCJub1wiXHJcblx0XHRcdFx0XHRcdCwgKCBzZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQgLSAxXSAhPSBudWxsICkgPyBcIlllc1wiIDogXCJub1wiXHJcblx0XHRcdFx0XHRcdCwgc2VjdG9yLnBvcy54LCBzZWN0b3IucG9zLnksIHNlY3Rvci5wb3MuelxyXG5cdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0Ki9cclxuICAgICAgICAgIHNlY3Rvci5kYXRhLmRhdGEuZm9yRWFjaCggKHZveGVsLE9mZnNldCk9PlxyXG5cdFx0XHRcdFx0e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggZ2VvbWV0cnkuYXZhaWxhYmxlID4gMjU2MDAwICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJ1Z2dlcjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggIXZveGVsICkgcmV0dXJuO1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0aW5mbyA9IEZhY2VDdWxsaW5nW09mZnNldF07XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0aWYoIHZveGVsICYmIGluZm8gIT0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLk5PTkUgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggdm94ZWwucHJvcGVydGllcy5EcmF3SW5mbyA9PT0gVm94ZWxhcml1bS5aVk9YRUxfRFJBV0lORk9fVk9JRCApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEcmF3ID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGVsc2UgaWYoIHZveGVsLnByb3BlcnRpZXMuRHJhd19UcmFuc3BhcmVudFJlbmRlcmluZyApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0eyBEcmF3ID0gZmFsc2U7IHNlY3Rvci5GbGFnX1ZvaWRfVHJhbnNwYXJlbnQgPSBmYWxzZTsgfVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0eyBEcmF3ID0gdHJ1ZTsgc2VjdG9yLkZsYWdfVm9pZF9SZWd1bGFyID0gZmFsc2U7IH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0RHJhdyA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGlmKCBEcmF3IClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGJveCA9IHZveGVsLlRleHR1cmVDb29yZHM7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBmYWNlX2lzX3NoYWRlZDtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCAhVm94ZWxhcml1bS5TZXR0aW5ncy51c2VfYmFzaWNfbWF0ZXJpYWwgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICggdm94ZWwucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX1NIQURFUiApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZmFjZSA9IHZveGVsLnByb3BlcnRpZXMuRmFjZUNvbG9yO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVkZ2UgPSB2b3hlbC5wcm9wZXJ0aWVzLkVkZ2VDb2xvcjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRwb3dlciA9IHZveGVsLnByb3BlcnRpZXMuRWRnZVBvd2VyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGZhY2VfaXNfc2hhZGVkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbHNlIFxyXG4gICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1YmUgPSB2b3hlbDtcclxuXHQgICAgICAgICAgICAgICAgICBmYWNlX2lzX3NoYWRlZCA9IGZhbHNlOyAvLyB1c2VzIHRleHR1cmUgaW5zdGVhZCBvZiBhbGdvcml0aG1cclxuICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCBpbmZvICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIlNldCBzZWN0b3IgezB9IHsxfSB7Mn0gb2Zmc2V0IHszfSAgIHs0Onh9XCIsIHNlY3Rvci5wb3MueCwgc2VjdG9yLnBvcy55LCBzZWN0b3IucG9zLnosIE9mZnNldCwgaW5mbyApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vc2VjdG9yLnBoeXNpY3MuU2V0Vm94ZWwoIE9mZnNldCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vc2VjdG9yLnBoeXNpY3MuQ2xlYXJWb3hlbCggT2Zmc2V0ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9jb250aW51ZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgIGN1YnggPSBTZWN0b3JfRGlzcGxheV94ICsgdm94ZWxTaXplICogKCBNYXRoLmZsb29yKCBPZmZzZXQgLyBjbHVzdGVyLnNlY3RvclNpemVZICkgJSBjbHVzdGVyLnNlY3RvclNpemVYICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGN1YnkgPSBTZWN0b3JfRGlzcGxheV95ICsgdm94ZWxTaXplICogKCAoIE9mZnNldCApICUgY2x1c3Rlci5zZWN0b3JTaXplWSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjdWJ6ID0gU2VjdG9yX0Rpc3BsYXlfeiArIHZveGVsU2l6ZSAqICggTWF0aC5mbG9vciggT2Zmc2V0IC8gKGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZICkgKSAlIGNsdXN0ZXIuc2VjdG9yU2l6ZVogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9jdWJ4ID0gKCB4ICogdm94ZWxTaXplICsgU2VjdG9yX0Rpc3BsYXlfeCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL2N1YnkgPSAoIHkgKiB2b3hlbFNpemUgKyBTZWN0b3JfRGlzcGxheV95ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vY3VieiA9ICggeiAqIHZveGVsU2l6ZSArIFNlY3Rvcl9EaXNwbGF5X3ogKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCAwICE9ICggdm94ZWwucHJvcGVydGllcy5EcmF3SW5mbyAmIFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX1NQRUNJQUxSRU5ERVJJTkcgKSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0eyAvKlZveGVsVHlwZVRhYmxlW2N1YmVdLlNwZWNpYWxSZW5kZXIoIGN1YngsIGN1YnksIGN1YnogKTsgKi9cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZyggXCJOZWVkIHRvIGFkZCBjdXN0b20gcGFzcyBmb3Igc3BlY2lhbCByZW5kZXJcIiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybjsvL2NvbnRpbnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRQMCA9IG5ldyBUSFJFRS5WZWN0b3IzKCBjdWJ4LCBjdWJ5LCBjdWJ6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFAxID0gbmV3IFRIUkVFLlZlY3RvcjMoIGN1YnggKyB2b3hlbFNpemUsIGN1YnksIGN1YnogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0UDIgPSBuZXcgVEhSRUUuVmVjdG9yMyggY3VieCArIHZveGVsU2l6ZSxjdWJ5LCBjdWJ6ICsgdm94ZWxTaXplICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFAzID0gbmV3IFRIUkVFLlZlY3RvcjMoIGN1YngsIGN1YnksIGN1YnogKyB2b3hlbFNpemUgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0UDQgPSBuZXcgVEhSRUUuVmVjdG9yMyggY3VieCwgY3VieSArIHZveGVsU2l6ZSwgY3VieiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQNSA9IG5ldyBUSFJFRS5WZWN0b3IzKCBjdWJ4ICsgdm94ZWxTaXplLCBjdWJ5ICsgdm94ZWxTaXplLCBjdWJ6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFA2ID0gbmV3IFRIUkVFLlZlY3RvcjMoIGN1YnggKyB2b3hlbFNpemUsIGN1YnkgKyB2b3hlbFNpemUsIGN1YnogKyB2b3hlbFNpemUgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0UDcgPSBuZXcgVEhSRUUuVmVjdG9yMyggY3VieCwgY3VieSArIHZveGVsU2l6ZSwgY3VieiArIHZveGVsU2l6ZSApO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9MZWZ0XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoIGluZm8gJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIkFkZCB7MH0gezF9IHsyfSB7M31cIiwgUDQgLCBQMCwgUDMsIFA3ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGZhY2VfaXNfc2hhZGVkIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGdlb21ldHJ5LkFkZFF1YWQoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSwgUDMsIFA3LCBQMCwgUDQsIGZhY2UsIGVkZ2UsIHBvd2VyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZFRleHR1cmUoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSwgUDMsIFA3LCBQMCwgUDQsIHZveGVsLnRleHR1cmVDb29yZHMgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmlnaHRcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoICggaW5mbyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVCApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIkFkZCB7MH0gezF9IHsyfSB7M31cIiwgUDUsIFA2LCBQMiwgUDEgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggZmFjZV9pc19zaGFkZWQgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZCggbm9ybWFsc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXSwgUDEsIFA1LCBQMiwgUDYsIGZhY2UsIGVkZ2UsIHBvd2VyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZFRleHR1cmUoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0sIFAxLCBQNSwgUDIsIFA2LCB2b3hlbC50ZXh0dXJlQ29vcmRzICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9Gcm9udFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiggKCBpbmZvICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIkFkZCB7MH0gezF9IHsyfSB7M31cIiwgUDAsIFA0LCBQNSwgUDEgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggZmFjZV9pc19zaGFkZWQgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZCggbm9ybWFsc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0sIFAwLCBQNCwgUDEsIFA1LCBmYWNlLCBlZGdlLCBwb3dlciApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGdlb21ldHJ5LkFkZFF1YWRUZXh0dXJlKCBub3JtYWxzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSwgUDAsIFA0LCBQMSwgUDUsIHZveGVsLnRleHR1cmVDb29yZHMgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9CYWNrXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoIGluZm8gJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUhFQUQgKSAhPSAwIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vTG9nLmxvZyggXCJBZGQgezB9IHsxfSB7Mn0gezN9XCIsIFAyLCBQNiwgUDMsIFA3ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGZhY2VfaXNfc2hhZGVkIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGdlb21ldHJ5LkFkZFF1YWQoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0sIFAyLCBQNiwgUDMsIFA3LCBmYWNlLCBlZGdlLCBwb3dlciApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGdlb21ldHJ5LkFkZFF1YWRUZXh0dXJlKCBub3JtYWxzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLCBQMiwgUDYsIFAzLCBQNywgdm94ZWwudGV4dHVyZUNvb3JkcyApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBUb3BcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoICggaW5mbyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BQk9WRSApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIkFkZCB7MH0gezF9IHsyfSB7M31cIiwgUDQsIFA3LCBQNSwgUDYgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggZmFjZV9pc19zaGFkZWQgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZCggbm9ybWFsc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSwgUDQsIFA3LCBQNSwgUDYsIGZhY2UsIGVkZ2UsIHBvd2VyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZFRleHR1cmUoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0sIFA0LCBQNywgUDUsIFA2LCB2b3hlbC50ZXh0dXJlQ29vcmRzICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEJvdHRvbVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiggKCBpbmZvICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XICkgIT0gMCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvL0xvZy5sb2coIFwiQWRkIHswfSB7MX0gezJ9IHszfVwiLCBQMCwgUDEsIFAzLCBQMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBmYWNlX2lzX3NoYWRlZCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRnZW9tZXRyeS5BZGRRdWFkKCBub3JtYWxzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddLCBQMywgUDAsIFAyLCBQMSwgZmFjZSwgZWRnZSwgcG93ZXIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRnZW9tZXRyeS5BZGRRdWFkVGV4dHVyZSggbm9ybWFsc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXSwgUDMsIFAwLCBQMiwgUDEsIHZveGVsLnRleHR1cmVDb29yZHMgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0Ly9lbHNlXHJcblx0XHRcdFx0XHRcdFx0XHQvL1x0c2VjdG9yLnBoeXNpY3MuQ2xlYXJWb3hlbCggT2Zmc2V0ICk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcbiAgICAgICAgZ2VvbWV0cnkubWFya0RpcnR5KCk7XHJcblx0XHRcdFx0c2VjdG9yLkZsYWdfUmVuZGVyX0RpcnR5ID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcbiAgICAgICAgLCBmaXhlZF9saXN0cyA6IGZhbHNlXHJcblxyXG5cdFx0LCBNYWtlU2VjdG9yUmVuZGVyaW5nRGF0YV9Tb3J0ZWQgOiBmdW5jdGlvbiAoIHNlY3Rvciwgdmlld2VkX2FzXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQsIGNlbnRlclgsIGNlbnRlclksIGNlbnRlclogKVxyXG5cdFx0e1xyXG5cdFx0XHRpZiggc2VjdG9yLkZsYWdfVm9pZF9UcmFuc3BhcmVudCApXHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cclxuXHRcdFx0aWYoICFmaXhlZF9saXN0cyApXHJcblx0XHRcdHtcclxuXHRcdFx0XHRmb3IoIHZhciBuID0gMTk7IG4gPCAyNzsgbisrIClcclxuXHRcdFx0XHRcdGZvciggdmFyIG0gPSAwOyBtIDwgMzsgbSsrIClcclxuXHRcdFx0XHRcdFx0T3JkZXJlZEZhY2VzW25dW21dID0gMDtcclxuXHRcdFx0XHRmaXhlZF9saXN0cyA9IHRydWU7XHJcblx0XHRcdH1cclxuXHJcbiAgICAgICAgICAgIHZhciBmYWNlID0gbmV3IFRIUkVFLlZlY3RvcjQoIDI1NiwgMCwgMCwgMjU2ICksIGVkZ2UgPSBuZXcgVEhSRUUuVmVjdG9yNCggMCwgMCwgMCwgMjU2ICk7XHJcblx0XHRcdHZhciBwb3dlciA9IDQwMDtcclxuXHRcdFx0dmFyIHgsIHksIHo7XHJcblx0XHRcdHZhciBpbmZvO1xyXG5cdFx0XHR2YXIgc29ydGVkX2RyYXdfaW5mbyA9IHNvcnRlZF9kcmF3X2luZm9zW3ZpZXdlZF9hc107XHJcblx0XHRcdHZhciBjdWJlLCBwcmV2Y3ViZTtcclxuXHRcdFx0LyogYnVpbGQgc2VjdG9yIGdlb21ldHJ5ICovXHJcblxyXG5cdFx0XHR2YXIgT2Zmc2V0O1xyXG5cdFx0XHR2YXIgY3VieCwgY3VieSwgY3ViejtcclxuXHRcdFx0dmFyIFNlY3Rvcl9EaXNwbGF5X3gsIFNlY3Rvcl9EaXNwbGF5X3ksIFNlY3Rvcl9EaXNwbGF5X3o7XHJcblx0XHRcdHZhciBEcmF3O1xyXG5cclxuXHRcdFx0dmFyIFAwLCBQMSwgUDIsIFAzLCBQNCwgUDUsIFA2LCBQNztcclxuXHJcblx0XHRcdC8vTG9nLmxvZyggXCJCdWlsZGluZyBzZWN0b3IgezB9IHsxfSB7Mn1cIiwgc2VjdG9yLnBvcy54LCBzZWN0b3IucG9zLnksIHNlY3Rvci5wb3MueiApO1xyXG5cdFx0XHQvLyBEaXNwbGF5IGxpc3QgY3JlYXRpb24gb3IgcmV1c2UuXHJcblx0XHRcdHZhciBnZW9tZXRyeSA9IHNlY3Rvci50cmFuc3BhcmVudF9nZW9tZXRyeTtcclxuXHRcdFx0dmFyIHZveGVsU2l6ZSA9IHNlY3Rvci5jbHVzdGVyLnZveGVsVW5pdFNpemU7XHJcblx0XHRcdHZhciBGYWNlQ3VsbGluZyA9IHNlY3Rvci5kYXRhLkZhY2VDdWxsaW5nO1xyXG5cdFx0XHRTZWN0b3JfRGlzcGxheV94ID0gKCBzZWN0b3IucG9zLnggKiBzZWN0b3IuU2l6ZV94ICogdm94ZWxTaXplICk7XHJcblx0XHRcdFNlY3Rvcl9EaXNwbGF5X3kgPSAoIHNlY3Rvci5wb3MueSAqIHNlY3Rvci5TaXplX3kgKiB2b3hlbFNpemUgKTtcclxuXHRcdFx0U2VjdG9yX0Rpc3BsYXlfeiA9ICggc2VjdG9yLnBvcy56ICogc2VjdG9yLlNpemVfeiAqIHZveGVsU2l6ZSApO1xyXG5cclxuXHRcdFx0dmFyIFNlY3RvckluZGV4ZXMgPSBTb3J0ZWRTZWN0b3JJbmRleGVzW3ZpZXdlZF9hc107XHJcblx0XHRcdC8qXHJcblx0XHRcdGlmKCBnZW9tZXRyeS50cmFuc3BhcmVudF9yZW5kZXJfc29ydGluZyAhPSB2aWV3ZWRfYXMgKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Z2VvbWV0cnkudHJhbnNwYXJlbnRfcmVuZGVyX3NvcnRpbmcgPSB2aWV3ZWRfYXM7XHJcblx0XHRcdFx0c2VjdG9yLkZsYWdfUmVuZGVyX0RpcnR5X1RyYW5zcGFyZW50ID0gdHJ1ZTtcclxuXHRcdFx0XHRnZW9tZXRyeS5zb3J0ZWRYID0gLTE7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYoIHZpZXdlZF9hcyA9PSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLklOQ0VOVEVSIClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdGlmKCBjZW50ZXJfc29ydGVkX3ggIT0gY2VudGVyWFxyXG5cdFx0XHRcdFx0fHwgY2VudGVyX3NvcnRlZF95ICE9IGNlbnRlcllcclxuXHRcdFx0XHRcdHx8IGNlbnRlcl9zb3J0ZWRfeiAhPSBjZW50ZXJaIClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRzZWN0b3IuRmxhZ19SZW5kZXJfRGlydHlfVHJhbnNwYXJlbnQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0QnVpbGRTb3J0TGlzdEluU2VjdG9yKCBjZW50ZXJYLCBjZW50ZXJZLCBjZW50ZXJaICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdCovXHJcblx0XHRcdGlmKCBzZWN0b3IuRmxhZ19SZW5kZXJfRGlydHlfVHJhbnNwYXJlbnQgKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Ly9Mb2cubG9nKCBcIlJlZ25lcmF0ZSBBbHBoYSBHZW9tZXRyeSB7MH0gezF9IHsyfVwiLCBzZWN0b3IucG9zLngsIHNlY3Rvci5wb3MueSwgc2VjdG9yLnBvcy56ICk7XHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0dmFyIGZhY2VfaXNfc2hhZGVkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHZhciB2aWV3X29yZGVyX2xpc3QgPSBudWxsO1xyXG5cdFx0XHRcdFx0Z2VvbWV0cnkuQ2xlYXIoKTtcclxuXHJcblx0XHRcdFx0XHRwcmV2Y3ViZSA9IDA7XHJcblx0XHRcdFx0XHRmb3IoIHZhciBPZmZzZXRJbmRleCA9IDA7IE9mZnNldEluZGV4IDwgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ0tDT1VOVDsgT2Zmc2V0SW5kZXgrKyApXHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRPZmZzZXQgPSBTZWN0b3JJbmRleGVzW09mZnNldEluZGV4XTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRjdWJlID0gc2VjdG9yLmRhdGEuZGF0YVtPZmZzZXRdO1xyXG5cdFx0XHRcdFx0XHRcdFx0aW5mbyA9IEZhY2VDdWxsaW5nW09mZnNldF07Ly8gJiAoVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTF9CSVRTKTsvLyBzb3J0ZWRfZHJhd19pbmZvO1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly9pbmZvID0gKFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucylGYWNlQ3VsbGluZ1tPZmZzZXRdICYgc29ydGVkX2RyYXdfaW5mbztcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRpZiggY3ViZSAmJiAoIGluZm8gKSE9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5OT05FIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0RHJhdyA9IGN1YmUucHJvcGVydGllcy5EcmF3X1RyYW5zcGFyZW50UmVuZGVyaW5nO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHREcmF3ID0gZmFsc2U7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0aWYoIERyYXcgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgYm94O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiggcHJldmN1YmUgIT09IGN1YmUgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ym94ID0gdm94ZWwudGV4dHVyZUNvb3JkcztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggKCBjdWJlLnByb3BlcnRpZXMuRHJhd0luZm8gJiBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19TSEFERVIgKSAhPSAwIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmYWNlID0gY3ViZS5wcm9wZXJ0aWVzLkZhY2VDb2xvcjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVkZ2UgPSBjdWJlLnByb3BlcnRpZXMuRWRnZUNvbG9yO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cG93ZXIgPSBjdWJlLnByb3BlcnRpZXMuRWRnZVBvd2VyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZmFjZV9pc19zaGFkZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRmYWNlX2lzX3NoYWRlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdHByZXZjdWJlID0gY3ViZTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGN1YnggPSAoIE9mZnNldCAvIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSAlIGNsdXN0ZXIuc2VjdG9yU2l6ZVg7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGN1YnkgPSAoIE9mZnNldCApICUgY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y3VieiA9ICggT2Zmc2V0IC8gKGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZICkgKSAlIGNsdXN0ZXIuc2VjdG9yU2l6ZVo7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRQMC5YID0gY3VieDsgUDAuWSA9IGN1Ynk7IFAwLlogPSBjdWJ6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQMS5YID0gY3VieCArIHZveGVsU2l6ZTsgUDEuWSA9IGN1Ynk7IFAxLlogPSBjdWJ6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQMi5YID0gY3VieCArIHZveGVsU2l6ZTsgUDIuWSA9IGN1Ynk7IFAyLlogPSBjdWJ6ICsgdm94ZWxTaXplO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQMy5YID0gY3VieDsgUDMuWSA9IGN1Ynk7IFAzLlogPSBjdWJ6ICsgdm94ZWxTaXplO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQNC5YID0gY3VieDsgUDQuWSA9IGN1YnkgKyB2b3hlbFNpemU7IFA0LlogPSBjdWJ6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQNS5YID0gY3VieCArIHZveGVsU2l6ZTsgUDUuWSA9IGN1YnkgKyB2b3hlbFNpemU7IFA1LlogPSBjdWJ6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQNi5YID0gY3VieCArIHZveGVsU2l6ZTsgUDYuWSA9IGN1YnkgKyB2b3hlbFNpemU7IFA2LlogPSBjdWJ6ICsgdm94ZWxTaXplO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRQNy5YID0gY3VieDsgUDcuWSA9IGN1YnkgKyB2b3hlbFNpemU7IFA3LlogPSBjdWJ6ICsgdm94ZWxTaXplO1xyXG5cclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2aWV3ZWRfYXMgPCAxIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ4IDwgY2VudGVyWCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieSA8IGNlbnRlclkgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieiA8IGNlbnRlclogKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieiA8IGNlbnRlclogKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ5IDwgY2VudGVyWSApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieiA8IGNlbnRlclogKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieiA8IGNlbnRlclogKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF07XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZiggdmlld2VkX2FzIDwgNyApXHJcblx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzd2l0Y2goIHZpZXdlZF9hcyApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnkgPCBjZW50ZXJZIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnogPCBjZW50ZXJaIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnogPCBjZW50ZXJaIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVDpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ5IDwgY2VudGVyWSApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ6IDwgY2VudGVyWiApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnogPCBjZW50ZXJaIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnkgPCBjZW50ZXJZIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnggPCBjZW50ZXJYIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnggPCBjZW50ZXJYIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkQ6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieSA8IGNlbnRlclkgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieiA8IGNlbnRlclggKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ4IDwgY2VudGVyWCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRTpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ6IDwgY2VudGVyWiApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ4IDwgY2VudGVyWCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnggPCBjZW50ZXJYIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ6IDwgY2VudGVyWiApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ6IDwgY2VudGVyWCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnggPCBjZW50ZXJYIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbHNlIGlmKCB2aWV3ZWRfYXMgPCAxOSApXHJcblx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzd2l0Y2goIHZpZXdlZF9hcyApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnkgPCBjZW50ZXJZIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRF9CRUxPV107XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUhFQURfQUJPVkVdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnkgPCBjZW50ZXJZIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUhFQURfQkVMT1ddO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BSEVBRF9BQk9WRV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkQ6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieSA8IGNlbnRlclkgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFSElORF9CRUxPV107XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVISU5EX0FCT1ZFXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkQ6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggY3VieSA8IGNlbnRlclkgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkRfQkVMT1ddO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkRfQUJPVkVdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnggPCBjZW50ZXJYIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRF9BQk9WRV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0FCT1ZFXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRDpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ4IDwgY2VudGVyWCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUhFQURfQkVMT1ddO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BSEVBRF9CRUxPV107XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnggPCBjZW50ZXJYIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQUJPVkVdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUhJTkRfQUJPVkVdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORDpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ4IDwgY2VudGVyWCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVISU5EX0JFTE9XXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVISU5EX0JFTE9XXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnogPCBjZW50ZXJaIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQUJPVkVdO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEX0FCT1ZFXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGN1YnogPCBjZW50ZXJaIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUhJTkRfQkVMT1ddO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2aWV3X29yZGVyX2xpc3QgPSBPcmRlcmVkRmFjZXNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEX0JFTE9XXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRTpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ6IDwgY2VudGVyWiApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFSElORF9BQk9WRV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0FCT1ZFXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPVzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBjdWJ6IDwgY2VudGVyWiApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFSElORF9CRUxPV107XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZpZXdfb3JkZXJfbGlzdCA9IE9yZGVyZWRGYWNlc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEX0JFTE9XXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmlld19vcmRlcl9saXN0ID0gT3JkZXJlZEZhY2VzW3ZpZXdlZF9hc107XHJcblx0XHRcdFx0XHRcdFx0XHRcdGZvciggdmFyIGYgPSAwOyBmIDwgNjsgZisrIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHN3aXRjaCggdmlld19vcmRlcl9saXN0W2ZdIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQ6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvL0xlZnRcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoIGluZm8gJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvL0xvZy5sb2coIFwiQWRkIHswfSB7MX0gezJ9IHszfVwiLCBQNCAsIFAwLCBQMywgUDcgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGZhY2VfaXNfc2hhZGVkIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRnZW9tZXRyeS5BZGRRdWFkKCBub3JtYWxzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF0sIFAzLCBQNywgUDAsIFA0LCBmYWNlLCBlZGdlLCBwb3dlciApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZFRleHR1cmUoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSwgUDMsIFA3LCBQMCwgUDQsIHZveGVsLnRleHR1cmVDb29yZHMgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVDpcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSaWdodFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoICggaW5mbyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVCApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvL0xvZy5sb2coIFwiQWRkIHswfSB7MX0gezJ9IHszfVwiLCBQNSwgUDYsIFAyLCBQMSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggZmFjZV9pc19zaGFkZWQgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGdlb21ldHJ5LkFkZFF1YWQoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0sIFAxLCBQNSwgUDIsIFA2LCBmYWNlLCBlZGdlLCBwb3dlciApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZFRleHR1cmUoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0sIFAxLCBQNSwgUDIsIFA2LCB2b3hlbC50ZXh0dXJlQ29vcmRzICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Gcm9udFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoICggaW5mbyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQgKSAhPSAwIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIkFkZCB7MH0gezF9IHsyfSB7M31cIiwgUDAsIFA0LCBQNSwgUDEgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGZhY2VfaXNfc2hhZGVkIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRnZW9tZXRyeS5BZGRRdWFkKCBub3JtYWxzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSwgUDAsIFA0LCBQMSwgUDUsIGZhY2UsIGVkZ2UsIHBvd2VyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRnZW9tZXRyeS5BZGRRdWFkVGV4dHVyZSggbm9ybWFsc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0sIFAwLCBQNCwgUDEsIFA1LCB2b3hlbC50ZXh0dXJlQ29vcmRzICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQ6XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvL0JhY2tcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoIGluZm8gJiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUhFQUQgKSAhPSAwIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIkFkZCB7MH0gezF9IHsyfSB7M31cIiwgUDIsIFA2LCBQMywgUDcgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIGZhY2VfaXNfc2hhZGVkIClcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRnZW9tZXRyeS5BZGRRdWFkKCBub3JtYWxzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLCBQMiwgUDYsIFAzLCBQNywgZmFjZSwgZWRnZSwgcG93ZXIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZWxzZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGdlb21ldHJ5LkFkZFF1YWRUZXh0dXJlKCBub3JtYWxzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLCBQMiwgUDYsIFAzLCBQNywgdm94ZWwudGV4dHVyZUNvb3JkcyApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVG9wXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggKCBpbmZvICYgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFICkgIT0gMCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vTG9nLmxvZyggXCJBZGQgezB9IHsxfSB7Mn0gezN9XCIsIFA0LCBQNywgUDUsIFA2ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCBmYWNlX2lzX3NoYWRlZCApXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZCggbm9ybWFsc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSwgUDQsIFA3LCBQNSwgUDYsIGZhY2UsIGVkZ2UsIHBvd2VyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRnZW9tZXRyeS5BZGRRdWFkVGV4dHVyZSggbm9ybWFsc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSwgUDQsIFA3LCBQNSwgUDYsIHZveGVsLnRleHR1cmVDb29yZHMgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEJvdHRvbVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoICggaW5mbyAmIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUxPVyApICE9IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvL0xvZy5sb2coIFwiQWRkIHswfSB7MX0gezJ9IHszfVwiLCBQMCwgUDEsIFAzLCBQMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggZmFjZV9pc19zaGFkZWQgKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGdlb21ldHJ5LkFkZFF1YWQoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10sIFAzLCBQMCwgUDIsIFAxLCBmYWNlLCBlZGdlLCBwb3dlciApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Z2VvbWV0cnkuQWRkUXVhZFRleHR1cmUoIG5vcm1hbHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10sIFAzLCBQMCwgUDIsIFAxLCB2b3hlbC50ZXh0dXJlQ29vcmRzICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcbiAgICAgICAgICAgICAgICBnZW9tZXRyeS5tYXJrRGlydHkoKTtcclxuXHJcblx0XHRcdFx0c2VjdG9yLkZsYWdfUmVuZGVyX0RpcnR5X1RyYW5zcGFyZW50ID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblxyXG5cclxuXHRcdCwgc29ydGVkX2RyYXdfaW5mb3MgOiBuZXcgQXJyYXkoIDI3KVxyXG4gICAgICAgICwgU29ydGVkU2VjdG9ySW5kZXhlcyA6IG5ldyBBcnJheSgyNykgLy91c2hvcnRbMjddW107XHJcblx0XHQsIGNlbnRlcl9zb3J0ZWRfeCA6IC0xXHJcbiAgICAgICAgLCBjZW50ZXJfc29ydGVkX3kgOiAwXHJcbiAgICAgICAgLCBjZW50ZXJfc29ydGVkX3ogOiAwXHJcblxyXG5cdFx0Ly8vIDxzdW1tYXJ5PlxyXG5cdFx0Ly8vIEJ1aWxkIHRoZSBJTkNFTlRFUiBvcmRlciBsaXN0LlxyXG5cdFx0Ly8vIDwvc3VtbWFyeT5cclxuXHRcdC8vLyA8cGFyYW0gbmFtZT1cInhcIj52b3hlbCBwb3NpdGlvbiBvZiB2aWV3cG9pbnQ8L3BhcmFtPlxyXG5cdFx0Ly8vIDxwYXJhbSBuYW1lPVwieVwiPnZveGVsIHBvc2l0aW9uIG9mIHZpZXdwb2ludDwvcGFyYW0+XHJcblx0XHQvLy8gPHBhcmFtIG5hbWU9XCJ6XCI+dm94ZWwgcG9zaXRpb24gb2Ygdmlld3BvaW50PC9wYXJhbT5cclxuXHRcdCwgQnVpbGRTb3J0TGlzdEluU2VjdG9yIDogZnVuY3Rpb24gKCBjbHVzdGVyLCBleWVfeCwgZXllX3ksIGV5ZV96IClcclxuXHRcdHtcclxuXHRcdFx0dmFyIHgsIHksIHo7XHJcblx0XHRcdHZhciB0bXB4LCB0bXB5LCB0bXB6O1xyXG5cdFx0XHR2YXIgZDtcclxuXHRcdFx0dmFyIHZhbDtcclxuXHRcdFx0aWYoIGNlbnRlcl9zb3J0ZWRfeCAhPSBleWVfeCB8fCBjZW50ZXJfc29ydGVkX3kgIT0gZXllX3kgfHwgY2VudGVyX3NvcnRlZF96ICE9IGV5ZV96IClcclxuXHRcdFx0e1xyXG5cdFx0XHRcdHZhciBuO1xyXG5cdFx0XHRcdGNlbnRlcl9zb3J0ZWRfeCA9IGV5ZV94O1xyXG5cdFx0XHRcdGNlbnRlcl9zb3J0ZWRfeSA9IGV5ZV95O1xyXG5cdFx0XHRcdGNlbnRlcl9zb3J0ZWRfeiA9IGV5ZV96O1xyXG5cdFx0XHRcdC8vIHgsIHksIHogcG9cclxuXHRcdFx0XHRzb3J0ZXIuQ2xlYXIoKTtcclxuXHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB4ICogY2x1c3Rlci5zZWN0b3JTaXplWSArIHkgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKTtcclxuXHRcdFx0XHRcdFx0XHR0bXB4ID0geCAtIGV5ZV94O1xyXG5cdFx0XHRcdFx0XHRcdHRtcHkgPSB5IC0gZXllX3k7XHJcblx0XHRcdFx0XHRcdFx0dG1weiA9IHogLSBleWVfejtcclxuXHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHZhciBJbmRleGVzO1xyXG5cdFx0XHRcdEluZGV4ZXMgPSBTb3J0ZWRTZWN0b3JJbmRleGVzWzBdO1xyXG5cdFx0XHRcdG4gPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DS0NPVU5UO1xyXG4gICAgICAgICAgICAgICAgc29ydGVyLmZvckVhY2goIChpbmRleCk9PntcclxuXHRcdFx0XHRcdC8vIHJldHJpZXZlZCBjbG9zZXN0IHRvIGZ1cnRoZXN0IHNvLi4uIHJldmVyc2Ugc3RvcmluZyBpdC5cclxuXHRcdFx0XHRcdEluZGV4ZXNbLS1uXSA9IGluZGV4O1xyXG4gICAgICAgICAgICAgICAgfSlcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHJcblx0XHQsIEJ1aWxkU29ydExpc3QgOiBmdW5jdGlvbiAoICApXHJcblx0XHR7XHJcblx0XHRcdHZhciB4LCB5LCB6O1xyXG5cdFx0XHR2YXIgdG1weCwgdG1weSwgdG1wejtcclxuXHRcdFx0dmFyIGQ7XHJcblx0XHRcdHZhciB2YWw7XHJcblx0XHRcdHZhciBiaW5hcnlPdXRwdXQgPSBuZXcgdXNob3J0W1ZveGVsU2VjdG9yLlpWT1hFTEJMT0NLQ09VTlRdO1xyXG5cdFx0XHR2YXIgYmluYXJ5T3V0cHV0SW5kZXggPSAwO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNvcnRlciA9IFZveGVsYXJpdW0uc29ydGVyc1tjbHVzdGVyLnNlY3RvclNpemVdO1xyXG4gICAgICAgICAgICBpZiggIXNvcnRlciApXHJcbiAgICAgICAgICAgICAgICBzb3J0ZXIgPSBWb3hlbGFyaXVtLnNvcnRlcnNbY2x1c3Rlci5zZWN0b3JTaXplXSA9IFZveGVsYXJpdW0uU29ydGluZ1RyZWUoIGNsdXN0ZXIuc2VjdG9yU2l6ZSApO1xyXG5cdFx0XHQvL3N0YXJ0X3N0ZXBzICs9IDI3O1xyXG5cdFx0XHRzb3J0ZXIuQXV0b0JhbGFuY2UgPSB0cnVlO1xyXG5cclxuXHRcdFx0dmFyIGk7XHJcblx0XHRcdGZvciggaSA9IFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuSU5DRU5URVI7XHJcblx0XHRcdFx0XHRcdGkgPD0gVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRfQkVMT1c7IGkrKyApXHJcblx0XHRcdHtcclxuXHRcdFx0XHR2YXIgSW5kZXhlcztcclxuXHRcdFx0XHR2YXIgbiwgbTtcclxuXHRcdFx0XHR2YXIgeHZhbCwgenZhbDtcclxuXHRcdFx0XHRJbmRleGVzID0gU29ydGVkU2VjdG9ySW5kZXhlc1tpXSA9IG5ldyB1c2hvcnRbVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ0tDT1VOVF07XHJcblx0XHRcdFx0biA9IDA7XHJcblx0XHRcdFx0bSA9IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NLQ09VTlQgLSAxO1xyXG5cdFx0XHRcdHNvcnRlci5DbGVhcigpO1xyXG5cdFx0XHRcdHN3aXRjaCggaSApXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLklOQ0VOVEVSOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEw7XHJcblx0XHRcdFx0XHRcdC8vIG5vIGluZm9ybWF0aW9uOyB0aGlzIG9uZSBoYXMgdG8gYmUgZG9uZSBjdXN0b20uXHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQ6XHJcblx0XHRcdFx0XHRcdHNvcnRlZF9kcmF3X2luZm9zW2ldID0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCBeIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUO1xyXG5cdFx0XHRcdFx0XHQvL2ZvciggbiA9IDA7IG4gPCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DS0NPVU5UOyBuKysgKVxyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSh6dmFsICsgeSk7IC8vKHVzaG9ydCkoIGJpbmFyeU91dHB1dFtuXSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL3ggPSAoIHZhbCA+PiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICYgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly95ID0gKCB2YWwgICkgJiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19ZO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL3ogPSAoIHZhbCA+PiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICYgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVggLSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geSAtICggY2x1c3Rlci5zZWN0b3JTaXplWSAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IHogLSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVogLyAyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vTG9nLmxvZyhcIkFkZCB7MH0gezF9IHsyfSAgezN9XCIsIHgsIHksIHosIGQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQ6XHJcblx0XHRcdFx0XHRcdHNvcnRlZF9kcmF3X2luZm9zW2ldID0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCBeIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVDtcclxuXHRcdFx0XHRcdFx0Zm9yKCB4ID0gMDsgeCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHgrKyApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR4dmFsID0geCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0Zm9yKCB6ID0gMDsgeiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHorKyApXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0enZhbCA9IHh2YWwgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IoIHkgPSAwOyB5IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHp2YWwgKyB5ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geSAtICggY2x1c3Rlci5zZWN0b3JTaXplWSAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IHogLSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVogLyAyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRTpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IHggLSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVggLyAyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHkgPSB5O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0geiAtICggY2x1c3Rlci5zZWN0b3JTaXplWiAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVMT1c7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0geCAtICggY2x1c3Rlci5zZWN0b3JTaXplWCAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weSA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVkgLSB5O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0geiAtICggY2x1c3Rlci5zZWN0b3JTaXplWiAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUhFQUQ7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0geCAtICggY2x1c3Rlci5zZWN0b3JTaXplWCAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weSA9IHkgLSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgLyAyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSB6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVISU5EO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IHggLSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVggLyAyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHkgPSB5IC0gKCBjbHVzdGVyLnNlY3RvclNpemVZIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0gY2x1c3Rlci5zZWN0b3JTaXplWiAtIHo7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRDpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gKFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUfFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCk7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0gY2x1c3Rlci5zZWN0b3JTaXplWCAtIHg7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHkgPSB5IC0gKCBjbHVzdGVyLnNlY3RvclNpemVZIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0gejtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FIRUFEOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCApO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IHg7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHkgPSB5IC0gKCBjbHVzdGVyLnNlY3RvclNpemVZIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0gejtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVggLSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geSAtICggY2x1c3Rlci5zZWN0b3JTaXplWSAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVogLSB6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5SSUdIVCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQgKTtcclxuXHRcdFx0XHRcdFx0Zm9yKCB4ID0gMDsgeCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHgrKyApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR4dmFsID0geCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0Zm9yKCB6ID0gMDsgeiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHorKyApXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0enZhbCA9IHh2YWwgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IoIHkgPSAwOyB5IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHp2YWwgKyB5ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geSAtICggY2x1c3Rlci5zZWN0b3JTaXplWSAvIDIgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVogLSB6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0xFRlQ6XHJcblx0XHRcdFx0XHRcdHNvcnRlZF9kcmF3X2luZm9zW2ldID0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCBeICggVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkxFRlQgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgKTtcclxuXHRcdFx0XHRcdFx0Zm9yKCB4ID0gMDsgeCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHgrKyApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR4dmFsID0geCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0Zm9yKCB6ID0gMDsgeiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHorKyApXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0enZhbCA9IHh2YWwgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IoIHkgPSAwOyB5IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHp2YWwgKyB5ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSBjbHVzdGVyLnNlY3RvclNpemVYIC0geDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weSA9IHk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSB6IC0gKCBjbHVzdGVyLnNlY3RvclNpemVaIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfUklHSFQ6XHJcblx0XHRcdFx0XHRcdHNvcnRlZF9kcmF3X2luZm9zW2ldID0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCBeICggVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFICk7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0geDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weSA9IHk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSB6IC0gKCBjbHVzdGVyLnNlY3RvclNpemVaIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgKTtcclxuXHRcdFx0XHRcdFx0Zm9yKCB4ID0gMDsgeCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHgrKyApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR4dmFsID0geCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0Zm9yKCB6ID0gMDsgeiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHorKyApXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0enZhbCA9IHh2YWwgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IoIHkgPSAwOyB5IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHp2YWwgKyB5ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSB4IC0gKCBjbHVzdGVyLnNlY3RvclNpemVYIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVogLSB6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQUQ6XHJcblx0XHRcdFx0XHRcdHNvcnRlZF9kcmF3X2luZm9zW2ldID0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCBeICggVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFICk7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggeCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKyB5ICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSB4IC0gKCBjbHVzdGVyLnNlY3RvclNpemVYIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IHo7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfTEVGVF9BSEVBRDpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gKCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BQk9WRSApO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVggLSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IHo7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9SSUdIVF9BSEVBRDpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gKCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuUklHSFQgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUhFQUQgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUJPVkUgKTtcclxuXHRcdFx0XHRcdFx0Zm9yKCB4ID0gMDsgeCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHgrKyApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR4dmFsID0geCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0Zm9yKCB6ID0gMDsgeiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHorKyApXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0enZhbCA9IHh2YWwgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IoIHkgPSAwOyB5IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHp2YWwgKyB5ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0geTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IHo7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9MRUZUX0JFSElORDpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gKCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQgfFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BQk9WRSApO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHggKiBjbHVzdGVyLnNlY3RvclNpemVZICsgeSArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0gY2x1c3Rlci5zZWN0b3JTaXplWCAtIHg7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHkgPSB5O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0gY2x1c3Rlci5zZWN0b3JTaXplWiAtIHo7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9SSUdIVF9CRUhJTkQ6XHJcblx0XHRcdFx0XHRcdHNvcnRlZF9kcmF3X2luZm9zW2ldID0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCBeICggVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCB8Vm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFCT1ZFICk7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0geDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weSA9IHk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSBjbHVzdGVyLnNlY3RvclNpemVaIC0gejtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19MRUZUOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XICk7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0gY2x1c3Rlci5zZWN0b3JTaXplWCAtIHg7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHkgPSBjbHVzdGVyLnNlY3RvclNpemVZIC0geTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IHogLSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVogLyAyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19SSUdIVDpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gKCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuUklHSFQgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVMT1cgKTtcclxuXHRcdFx0XHRcdFx0Zm9yKCB4ID0gMDsgeCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHgrKyApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR4dmFsID0geCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0Zm9yKCB6ID0gMDsgeiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHorKyApXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0enZhbCA9IHh2YWwgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IoIHkgPSAwOyB5IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHp2YWwgKyB5ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0gY2x1c3Rlci5zZWN0b3JTaXplWSAtIHk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSB6IC0gKCBjbHVzdGVyLnNlY3RvclNpemVaIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUhJTkQgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVMT1cgKTtcclxuXHRcdFx0XHRcdFx0Zm9yKCB4ID0gMDsgeCA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHgrKyApXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHR4dmFsID0geCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0Zm9yKCB6ID0gMDsgeiA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHorKyApXHJcblx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0enZhbCA9IHh2YWwgKyB6ICogY2x1c3Rlci5zZWN0b3JTaXplWCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVk7XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IoIHkgPSAwOyB5IDwgY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFsID0gKHVzaG9ydCkoIHp2YWwgKyB5ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHggPSB4IC0gKCBjbHVzdGVyLnNlY3RvclNpemVYIC8gMiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0gY2x1c3Rlci5zZWN0b3JTaXplWSAtIHk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSBjbHVzdGVyLnNlY3RvclNpemVaIC0gejtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUxPVyApO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IHggLSAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVggLyAyICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHkgPSBjbHVzdGVyLnNlY3RvclNpemVZIC0geTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weiA9IHo7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfTEVGVF9BSEVBRDpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gKCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuTEVGVCB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5CRUxPVyB8IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BSEVBRCApO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVggLSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0gY2x1c3Rlci5zZWN0b3JTaXplWSAtIHk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSB6O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRkID0gKCB0bXB4ICogdG1weCApICsgKCB0bXB5ICogdG1weSApICsgKCB0bXB6ICogdG1weiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRzb3J0ZXIuQWRkKCBkLCB2YWwgKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfUklHSFRfQUhFQUQ6XHJcblx0XHRcdFx0XHRcdHNvcnRlZF9kcmF3X2luZm9zW2ldID0gVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFMTCBeICggVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLlJJR0hUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkFIRUFEICk7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0geDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weSA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVkgLSB5O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0gejtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0xFRlRfQkVISU5EOlxyXG5cdFx0XHRcdFx0XHRzb3J0ZWRfZHJhd19pbmZvc1tpXSA9IFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5BTEwgXiAoIFZveGVsYXJpdW0uRkFDRURSQVdfT3BlcmF0aW9ucy5MRUZUIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFTE9XIHwgVm94ZWxhcml1bS5GQUNFRFJBV19PcGVyYXRpb25zLkJFSElORCApO1xyXG5cdFx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgY2x1c3Rlci5zZWN0b3JTaXplWDsgeCsrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdHh2YWwgPSB4ICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRmb3IoIHogPSAwOyB6IDwgY2x1c3Rlci5zZWN0b3JTaXplWjsgeisrIClcclxuXHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHR6dmFsID0geHZhbCArIHogKiBjbHVzdGVyLnNlY3RvclNpemVYICogY2x1c3Rlci5zZWN0b3JTaXplWTtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciggeSA9IDA7IHkgPCBjbHVzdGVyLnNlY3RvclNpemVZOyB5KysgKVxyXG5cdFx0XHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YWwgPSAodXNob3J0KSggenZhbCArIHkgKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weCA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVggLSB4O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB5ID0gY2x1c3Rlci5zZWN0b3JTaXplWSAtIHk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRtcHogPSBjbHVzdGVyLnNlY3RvclNpemVaIC0gejtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZCA9ICggdG1weCAqIHRtcHggKSArICggdG1weSAqIHRtcHkgKSArICggdG1weiAqIHRtcHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0c29ydGVyLkFkZCggZCwgdmFsICk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX1JJR0hUX0JFSElORDpcclxuXHRcdFx0XHRcdFx0c29ydGVkX2RyYXdfaW5mb3NbaV0gPSBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMIF4gKCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuUklHSFQgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVMT1cgfCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQkVISU5EICk7XHJcblx0XHRcdFx0XHRcdGZvciggeCA9IDA7IHggPCBjbHVzdGVyLnNlY3RvclNpemVYOyB4KysgKVxyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0eHZhbCA9IHggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdGZvciggeiA9IDA7IHogPCBjbHVzdGVyLnNlY3RvclNpemVaOyB6KysgKVxyXG5cdFx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRcdHp2YWwgPSB4dmFsICsgeiAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVggKiBjbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRcdFx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHkrKyApXHJcblx0XHRcdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhbCA9ICh1c2hvcnQpKCB6dmFsICsgeSApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB4ID0geDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dG1weSA9IGNsdXN0ZXIuc2VjdG9yU2l6ZVkgLSB5O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR0bXB6ID0gY2x1c3Rlci5zZWN0b3JTaXplWiAtIHo7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGQgPSAoIHRtcHggKiB0bXB4ICkgKyAoIHRtcHkgKiB0bXB5ICkgKyAoIHRtcHogKiB0bXB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNvcnRlci5BZGQoIGQsIHZhbCApO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdG4gPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DS0NPVU5UO1xyXG5cdFx0XHRcdHNvcmNlci5mb3JFYWNoKCAoKT0+XHJcbiAgICBcdFx0XHRcdHtcclxuICAgIFx0XHRcdFx0XHQvLyByZXRyaWV2ZWQgY2xvc2VzdCB0byBmdXJ0aGVzdCBzby4uLiByZXZlcnNlIHN0b3JpbmcgaXQuXHJcbiAgICBcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcImluZGV4IGlzIHswfSB7MX0gezJ9XCJcclxuICAgIFx0XHRcdFx0XHQvL1x0LCAoIGluZGV4ID4+IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZICkgJiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19YXHJcbiAgICBcdFx0XHRcdFx0Ly9cdCwgaW5kZXggJiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19ZXHJcbiAgICBcdFx0XHRcdFx0Ly9cdCwgKCBpbmRleCA+PiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICYgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWiApO1xyXG4gICAgXHRcdFx0XHRcdEluZGV4ZXNbLS1uXSA9IGluZGV4O1xyXG4gICAgXHRcdFx0XHR9ICk7XHJcblx0XHRcdFx0c3RhcnRfcGVyY2VudCA9ICggKytzdGFydF9zdGVwICogMTAwICkgLyBzdGFydF9zdGVwcztcclxuXHJcblxyXG5cdFx0XHRcdC8vIHN0cm9uZyB0ZXN0IHRvIG1ha2Ugc3VyZSBldmVyeSBvZmZzZXQgaXMgcmVwcmVzZW50ZWQgb25jZS5cclxuXHRcdFx0XHQvLyBwYXJhbm9pZCBkZWJ1Z2dpbmcuXHJcblx0XHRcdFx0LypcclxuXHRcdFx0XHRpZiggaSAhPSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLklOQ0VOVEVSIClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRpbnQgb2ZzLCBjaGVjaztcclxuXHRcdFx0XHRcdGZvciggb2ZzID0gMDsgb2ZzIDwgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ0tDT1VOVDsgb2ZzKysgKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRmb3IoIGNoZWNrID0gMDsgY2hlY2sgPCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DS0NPVU5UOyBjaGVjaysrIClcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdGlmKCBJbmRleGVzW2NoZWNrXSA9PSBvZnMgKVxyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYoIGNoZWNrID09IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NLQ09VTlQgKVxyXG5cdFx0XHRcdFx0XHRcdERlYnVnZ2VyLkJyZWFrKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdCovXHJcblx0XHRcdH1cclxuXHRcdH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbWVzaGVyO1xyXG59XHJcblxyXG5jb25zdCBub3JtYWxzID0gWyBUSFJFRS5WZWN0b3IzWmVyb1xyXG4gICAgICAgICwgVEhSRUUuVmVjdG9yM0xlZnRcclxuICAgICAgICAsIFRIUkVFLlZlY3RvcjNSaWdodFxyXG4gICAgICAgICwgVEhSRUUuVmVjdG9yM0FoZWFkXHJcbiAgICAgICAgLCBUSFJFRS5WZWN0b3IzQmVoaW5kXHJcbiAgICAgICAgLCBUSFJFRS5WZWN0b3IzQWJvdmVcclxuICAgICAgICAsIFRIUkVFLlZlY3RvcjNCZWxvdyBdO1xyXG5cclxuXHJcblZveGVsYXJpdW0uT3JkZXJlZEZhY2VzID0gW1xyXG4gICAgLy8gQ0VOVEVSXHJcbiAgICAgICAgICBudWxsXHJcbiAgICAvLyBMRUZUIDFcclxuICAgICAgICAsIG51bGxcclxuICAgIC8vIFJJR0hUIDJcclxuICAgICAgICAsIG51bGxcclxuICAgIC8vIEFIRUFEIDNcclxuICAgICAgICAsIG51bGxcclxuICAgIC8vIEJFSElORCA0XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBBQk9WRSA1XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBCRUxPVyA2XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBMRUZUX0FCT1ZFICA3XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBSSUdIVF9BQk9WRSA4XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBBSEVBRF9BQk9WRSA5XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBCRUhJTkRfQUJPVkUgIDEwXHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBMRUZUX0FIRUFEIDExXHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvLyBSSUdIVF9BSEVBRCAxMlxyXG4gICAgICAgICwgbnVsbFxyXG4gICAgLy8gTEVGVF9CRUxPVyAxM1xyXG4gICAgICAgICwgbnVsbFxyXG4gICAgLy9SSUdIVF9CRUxPVyAvLzE0XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvL0lORlJPTlRfQkVMT1cgLy8xNVxyXG4gICAgICAgICwgbnVsbFxyXG4gICAgLy9CRUhJTkRfQkVMT1cgIC8vMTZcclxuICAgICAgICAsIG51bGxcclxuICAgIC8vTEVGVF9CRUhJTkQgICAvLzE3XHJcbiAgICAgICAgLCBudWxsXHJcbiAgICAvL0JFSElORF9SSUdIVCAgIC8vMThcclxuICAgICAgICAsIG51bGxcclxuICAgIC8vIExFRlRfQUhFQURfQUJPVkUgICAvLyAxOVxyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQsVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSxWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XLFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5ELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIF1cclxuICAgIC8vIFJJR0hUX0FIRUFEX0FCT1ZFICAvLyAyMFxyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hULCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUIF1cclxuICAgIC8vIExFRlRfQUhFQURfQkVMT1cgICAvLyAyMVxyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1csIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5ELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIF1cclxuICAgIC8vIFJJR0hUX0FIRUFEX0JFTE9XICAvLyAyMlxyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hULCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUIF1cclxuICAgIC8vIExFRlRfQkVISU5EX0FCT1ZFICAvLyAyM1xyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5ELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIF1cclxuICAgIC8vIFJJR0hUX0JFSElORF9BQk9WRSAvLyAyNFxyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hULCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVywgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUIF1cclxuICAgIC8vIExFRlRfQkVISU5EX0JFTE9XICAvLyAyNVxyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5ELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFELCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIF1cclxuICAgIC8vIFJJR0hUX0JFSElORF9CRUxPVyAvLyAyNlxyXG4gICAgICAgICwgWyBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hULCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVywgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCwgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUIF1cclxuICAgIF07XHJcblxyXG5Wb3hlbGFyaXVtLm1lc2hlciA9IHsgc29ydGVycyA6IFtdIH1cclxuIiwiXHJcbnJlcXVpcmUoIFwiLi9wYWNrZWRib29sYXJyYXkuanNcIiApXHJcblZveGVsYXJpdW0uTW9kaWZpY2F0aW9uVHJhY2tlciA9IGZ1bmN0aW9uKHNpemUpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbGFzdEN5Y2xlIDogLTEsXHJcbiAgICAgICAgY3ljbGUgOiAwLFxyXG4gICAgICAgIG1vZGlmaWVkIDogVm94ZWxhcml1bS5QYWNrZWRCb29sQXJyYXkoIHNpemUgKSxcclxuICAgICAgICBjbGVhciA6IGZ1bmN0aW9uKCl7IHRoaXMubGFzdEN5Y2xlID0gdGhpcy5jeWNsZTsgbW9kaWZpZWQuY2xlYXIoKTsgfSxcclxuICAgICAgICBzZXRDeWNsZSA6IGZ1bmN0aW9uKGN5Y2xlKSB7IHRoaXMuY3ljbGUgPSBjeWNsZSB9LFxyXG4gICAgICAgIGdldCA6IGZ1bmN0aW9uKCBvZmZzZXQgKSB7IGlmKCB0aGlzLmxhc3RDeWNsZSAhPSB0aGlzLmN5Y2xlICkgcmV0dXJuIGZhbHNlOyByZXR1cm4gdGhpcy5tb2RpZmllZC5nZXQob2Zmc2V0KTsgfSxcclxuICAgICAgICBzZXQgOiBmdW5jdGlvbiggb2Zmc2V0ICkgeyBpZiggdGhpcy5sYXN0Q3ljbGUgIT0gdGhpcy5jeWNsZSApIHRoaXMuY2xlYXIoKTsgIHRoaXMubW9kaWZpZWQuc2V0KG9mZnNldCk7IH1cclxuICAgIH1cclxufVxyXG4iLCJcclxuXHJcbi8vRmFzdEJpdF9BcnJheV8zMmtcclxuXHJcblxyXG5Wb3hlbGFyaXVtLlBhY2tlZEJvb2xBcnJheSA9IGZ1bmN0aW9uICggc2l6ZSApe1xyXG4gICAgaWYoICFzaXplIClcclxuICAgICAgICBzaXplID0gMzIqMzIqMzI7XHJcbiAgICB2YXIgcGJhID0ge1xyXG4gICAgICAgIF9iaXRzIDogbmV3IEFycmF5QnVmZmVyKCBNYXRoLmZsb29yKCAoIHNpemUgKyAzMSApIC8zMiApICogNCApLFxyXG4gICAgICAgIGJpdHMgOiBudWxsLFxyXG4gICAgICAgIGdldCA6IGZ1bmN0aW9uKCBiaXQgKSB7IHJldHVybiAoIHRoaXMuYml0c1tiaXQ+PjVdICYgMSA8PCAoIGJpdCAmIDB4MWYgKSApICE9PSAwOyB9LFxyXG4gICAgICAgIHNldCA6IGZ1bmN0aW9uKCBiaXQgKSB7IHRoaXMuYml0c1tiaXQ+PjVdIHw9IDEgPDwgKCBiaXQgJiAweDFmICk7IH0sXHJcbiAgICAgICAgY2xlYXIgOiBmdW5jdGlvbiggYml0ICkgeyB0aGlzLmJpdHNbYml0Pj41XSAmPSB+KDEgPDwgKCBiaXQgJiAweDFmICkpIH0sXHJcbiAgICAgICAgY2xlYXJBbGwgOiBmdW5jdGlvbigpIHsgZm9yKCB2YXIgbiA9IDA7IG4gPCBiaXRzLmxlbmd0aDsgbisrKSBiaXRzW25dID0gMDsgfVxyXG4gICAgfTtcclxuICAgIHBiYS5iaXRzID0gbmV3IFVpbnQzMkFycmF5KCBwYmEuX2JpdHMgKTtcclxuICAgIHJldHVybiBwYmE7XHJcblxyXG59XHJcbiIsIlxyXG5Wb3hlbGFyaXVtLlJlYWN0b3IgPSBmdW5jdGlvbiggd29ybGQgKSB7XHJcbiAgICB2YXIgcmVhY3RvciA9IHtcclxuICAgICBTdGVwT25lIDogdHJ1ZSxcclxuICAgICBDeWNsZU51bSA6IDAsXHJcbiAgICAgd29ybGQ6IHdvcmxkLFxyXG5cclxuICAgIHByb2Nlc3NTZWN0b3JzIDogZnVuY3Rpb24gKCB3b3JsZCwgTGFzdExvb3BUaW1lIClcclxuICAgIHtcclxuICAgICAgICB2YXIgeCwgeSwgejtcclxuXHJcbiAgICAgICAgdmFyIExvd0FjdGl2aXR5VHJpZ2dlcjtcclxuXHJcbiAgICAgICAgLy9Mb2cubG9nKCBcIkJlZ2luIFJlYWN0aW9uIFByb2Nlc3NpbmdcIiApO1xyXG4gICAgICAgIHZhciBTZWN0b3JzX3Byb2Nlc3NlZCA9IDA7XHJcbiAgICAgICAgdmFyIFZveGVsc19Qcm9jZXNzZWQgPSAwO1xyXG5cclxuICAgICAgICByZWFjdG9yLmN5Y2xlKys7XHJcblxyXG4gICAgICAgIGlmKCAhcmVhY3Rvci5zdGVwT25lICkgcmV0dXJuO1xyXG5cclxuICAgICAgICB3b3JsZC5zZWN0b3JzLmZvckVhY2goIChTZWN0b3IpPT57XHJcblxyXG4gICAgICAgICAgICBTZWN0b3JzX3Byb2Nlc3NlZCsrO1xyXG5cclxuICAgICAgICAgICAgTG93QWN0aXZpdHlUcmlnZ2VyID0gU2VjdG9yLkZsYWdfSXNBY3RpdmVMb3dSZWZyZXNoXHJcbiAgICAgICAgICAgICAgICAmJiAoICggKCBDeWNsZU51bSApICYgU2VjdG9yLkxvd1JlZnJlc2hfTWFzayApID09IDAgKTtcclxuICAgICAgICAgICAgU2VjdG9yLk1vZGlmVHJhY2tlci5TZXRBY3R1YWxDeWNsZU51bSggQ3ljbGVOdW0gKTtcclxuICAgICAgICAgICAgaWYoIFNlY3Rvci5GbGFnX0lzQWN0aXZlVm94ZWxzIHwgTG93QWN0aXZpdHlUcmlnZ2VyIClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZm9yKCB4ID0gMDsgeCA8PSA2OyB4KysgKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKCBTZWN0b3IubmVhcl9zZWN0b3JzW3hdICE9IG51bGwgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBTZWN0b3IubmVhcl9zZWN0b3JzW3hdLk1vZGlmVHJhY2tlci5TZXRBY3R1YWxDeWNsZU51bSggQ3ljbGVOdW0gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgRXh0ZW5zaW9uID0gU2VjdG9yLmRhdGEub3RoZXJJbmZvcztcclxuICAgICAgICAgICAgICAgIHZhciBWb3hlbFAgPSBTZWN0b3IuZGF0YS5kYXRhO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB6b2ZzLCB4b2ZzO1xyXG4gICAgICAgICAgICAgICAgdmFyIElzQWN0aXZlVm94ZWxzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBNYWluT2Zmc2V0ID0gMDtcclxuICAgICAgICAgICAgICAgIHZhciBSU3ggPSBTZWN0b3IuUG9zX3ggKiBTZWN0b3Iuc2l6ZV94O1xyXG4gICAgICAgICAgICAgICAgdmFyIFJTeSA9IFNlY3Rvci5Qb3NfeSAqIFNlY3Rvci5zaXplX3k7XHJcbiAgICAgICAgICAgICAgICB2YXIgUlN6ID0gU2VjdG9yLlBvc196ICogU2VjdG9yLnNpemVfejtcclxuICAgICAgICAgICAgICAgIHZhciB2cmVmID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHdvcmxkIDogd29ybGQsXHJcbiAgICAgICAgICAgICAgICAgICAgc2VjdG9yIDogU2VjdG9yLFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHNsZWVwID0gU2VjdG9yLmRhdGEuc2xlZXBTdGF0ZTtcclxuICAgICAgICAgICAgICAgIFNlY3Rvci5kYXRhLmRhdGEuZm9yRWFjaCggKHZveGVsLCBNYWluT2ZzZXQpPT57XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIHNsZWVwLmdldCggTWFpbk9mZnNldCApIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2cmVmLlZveGVsRXh0ZW5zaW9uID0gRXh0ZW5zaW9uW01haW5PZmZzZXRdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZyZWYuVHlwZSA9IFZveGVsUFtNYWluT2Zmc2V0XVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKCB2cmVmLlR5cGUucHJvcGVydGllcy5Jc19BY3RpdmUgKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAhU2VjdG9yLk1vZGlmVHJhY2tlci5HZXQoIE1haW5PZmZzZXQgKSApIC8vIElmIHZveGVsIGlzIGFscmVhZHkgcHJvY2Vzc2VkLCBkb24ndCBwcm9jZXNzIGl0IG9uY2UgbW9yZSBpbiB0aGUgc2FtZSBjeWNsZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgVm94ZWxzX1Byb2Nlc3NlZCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdnJlZi53eCA9IFJTeCArICggdnJlZi54ID0geCApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdnJlZi53eSA9IFJTeSArICggdnJlZi55ID0geSApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdnJlZi53eiA9IFJTeiArICggdnJlZi56ID0geiApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdnJlZi5vZmZzZXQgPSBNYWluT2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VjdG9yLk1vZGlmVHJhY2tlci5TZXQoU2Vjb25kYXJ5T2Zmc2V0W2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCB2cmVmLlR5cGUuUmVhY3QoIHZyZWYsIExhc3RMb29wVGltZSApIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSXNBY3RpdmVWb3hlbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdnJlZi5TZWN0b3IuZGF0YS5zbGVlcFN0YXRlLnNldCggdnJlZi5vZmZzZXQgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCggZXJyIClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggXCJWb3hlbCBSZWFjdGlvbiBFeGNlcHRpb24gOiBcIiwgZXJyICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzbGVlcC5zZXQoIE1haW5PZmZzZXQgKTtcclxuICAgICAgICAgICAgICAgICAgICBTZWN0b3IuRmxhZ19Jc0FjdGl2ZVZveGVscyA9IElzQWN0aXZlVm94ZWxzO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLy9TdGVwT25lID0gZmFsc2U7XHJcbiAgICAgICAgLy9Mb2cubG9nKCBcIkZpbmlzaCBSZWFjdGlvbiBQcm9jZXNzaW5nIHswfSB7MX0gXCIsIFNlY3RvcnNfcHJvY2Vzc2VkLCBWb3hlbHNfUHJvY2Vzc2VkICk7XHJcbiAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlYWN0b3I7XHJcbn1cclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnJlcXVpcmUoIFwiLi9wYWNrZWRib29sYXJyYXkuanNcIilcbnJlcXVpcmUoIFwiLi9tb2R0cmFja2VyLmpzXCIpXG5cblxuXHJcblZveGVsYXJpdW0uU2VjdG9yID0gZnVuY3Rpb24oIGNsdXN0ZXIsIHgsIHksIHogKSB7XG5cblx0dmFyIG5ld1NlY3RvciA9IHtcbiAgICAgICAgbmV4dCA6IG51bGwsXG5cdFx0cHJlZCA6IG51bGwsXG5cblx0XHRHbG9iYWxMaXN0X05leHQgOiBudWxsLFxuXHRcdEdsb2JhbExpc3RfUHJlZCA6IG51bGwsXG5cblx0XHRuZWFyX3NlY3RvcnMgOiBuZXcgQXJyYXkoMjcpLCAvLyBjYW4gaW5kZXggd2l0aCByZWxhdGl2ZU9yZHMtMSAoc2VsZiBpcyBub3QgaW4gdGhpcyBhcnJheSlcblxuXHRcdGhhbmRsZV94IDogMCwgaGFuZGxlX3k6MCwgaGFuZGxlX3ogOiAwLCAvLyB1c2VkIGluIEdlbmVzaXMgdGVtcGxhdGVzOyAnb3JpZ2luJyBvZiB0aGlzIHNlY3RvclxuXHRcdHBvcyA6IG5ldyBUSFJFRS5WZWN0b3IzKCB4LCB5LCB6ICksXG5cblx0XHQvLyBWZXJzaW9uIGNvbnRyb2wgOiBBZGRlZCBmb3IgaGFuZGxpbmcgYmV0dGVyIHdvcmxkIGV2b2x1dGlvbi5cblx0XHRab25lVHlwZSA6IDAsICAgICAvLyBUaGUgdHlwZSBvZiB0aGUgem9uZS5cblx0XHRab25lVmVyc2lvbiA6IDAsICAvLyBUaGUgdmVyc2lvbiBvZiB0aGUgZ2VuZXJhdG9yIHVzZWQgZm9yIHRoaXMgem9uZS5cblx0XHRHZW5lcmF0b3JWZXJzaW9uIDogMCwgLy8gTWFpbiBnZW5lcmF0b3IgdmVyc2lvbi4gVXBkYXRlZCBhdCB3b3JsZCBjaGFuZ2UuXG5cdFx0UmluZ051bSA6IDAsXG5cblx0XHRjbHVzdGVyIDogY2x1c3RlcixcblxuXHRcdGRhdGEgOiB7IGRhdGEgOiBuZXcgQXJyYXkoIGNsdXN0ZXIuc2VjdG9yU2l6ZSApXG5cdFx0XHRcdCwgc2xlZXBTdGF0ZSA6IFZveGVsYXJpdW0uUGFja2VkQm9vbEFycmF5KCBjbHVzdGVyLnNlY3RvclNpemUgKVxuICAgICAgICAgICAgXHQsIG90aGVySW5mb3MgOiBbXVxyXG5cdFx0XHRcdFx0XHRcdCwgRmFjZUN1bGxpbmcgOiBudWxsXHJcbiAgICAgICAgICAgIFx0fSxcblx0XHRNb2RpZlRyYWNrZXIgOiBWb3hlbGFyaXVtLk1vZGlmaWNhdGlvblRyYWNrZXIoIGNsdXN0ZXIuc2VjdG9yU2l6ZSApLFxuXG4gICAgICAgIG1lc2hlciA6IG51bGwsXG5cblx0XHRUSFJFRV9zb2xpZCA6IG51bGwsXG4gICAgICAgIHNvbGlkX2dlb21ldHJ5IDogbnVsbCxcblx0XHR0cmFuc3BhcmVudF9nZW9tZXRyeTogbnVsbCxcblx0XHRjdXN0b21fZ2VvbWV0cnk6IG51bGwsXG5cdFx0Y2FjaGVkU3RyaW5nIDogbnVsbCxcblxuXHRcdGVuYWJsZUdlb21ldHJ5IDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnNvbGlkX2dlb21ldHJ5ID0gVm94ZWxhcml1bS5HZW9tZXRyeUJ1ZmZlcigpO1xuXHRcdFx0dGhpcy50cmFuc3BhcmVudF9nZW9tZXRyeSA9IFZveGVsYXJpdW0uR2VvbWV0cnlCdWZmZXIoKTtcblx0XHRcdC8vdGhpcy5jdXN0b21fZ2VvbWV0cnkgPSBWb3hlbGFyaXVtLkdlb21ldHJ5QnVmZmVyKCk7XG5cdFx0fSxcblxuXHRcdGdldE9mZnNldCA6IGZ1bmN0aW9uKCB4LCB5LCB6ICkge1xuXHRcdFx0cmV0dXJuIGNsdXN0ZXIubG9va3VwVGFibGVzLm9mVGFibGVYW3grMV0gKyBjbHVzdGVyLmxvb2t1cFRhYmxlcy5vZlRhYmxlWVt5KzFdICsgY2x1c3Rlci5sb29rdXBUYWJsZXMub2ZUYWJsZVpbeisxXTtcblxuXHRcdFx0dmFyIG9mZnNldDtcblx0XHRcdG9mZnNldCA9ICggeSAlIHRoaXMuY2x1c3Rlci5zZWN0b3JTaXplWSApXG5cdFx0XHRcdCsgKCAoIHggJSB0aGlzLmNsdXN0ZXIuc2VjdG9yU2l6ZVggKSAqIHRoaXMuY2x1c3Rlci5zZWN0b3JTaXplWSApXG5cdFx0XHRcdCsgKCAoIHogJSB0aGlzLmNsdXN0ZXIuc2VjdG9yU2l6ZVogKSAqICggdGhpcy5jbHVzdGVyLnNlY3RvclNpemVZICogdGhpcy5jbHVzdGVyLnNlY3RvclNpemVYICkgKTtcblx0XHRcdHJldHVybiBvZmZzZXQ7XG5cdFx0fSxcblxuXHRcdHNldEN1YmUgOiBmdW5jdGlvbiggeCwgeSwgeiwgQ3ViZVZhbHVlICkge1xyXG5cdFx0XHR2YXIgb2Zmc2V0ID0gdGhpcy5nZXRPZmZzZXQoIHgsIHksIHogKTtcclxuXHRcdFx0dGhpcy5kYXRhLmRhdGFbb2Zmc2V0XSA9IEN1YmVWYWx1ZTtcclxuXHJcblx0XHRcdGlmKCBDdWJlVmFsdWUgJiYgQ3ViZVZhbHVlLmV4dGVuc2lvbiApXHJcblx0XHRcdFx0dGhpcy5kYXRhLm90aGVySW5mb3Nbb2Zmc2V0XSA9IEN1YmVWYWx1ZS5leHRlbnNpb24oKTtcclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdHRoaXMuZGF0YS5vdGhlckluZm9zW29mZnNldF0gPSBudWxsO1xyXG5cdFx0XHR0aGlzLkZsYWdfUmVuZGVyX0RpcnR5ID0gdHJ1ZTtcclxuXHRcdH0sXG5cclxuXHRcdGdldEN1YmUgOiBmdW5jdGlvbiggeCwgeSwgeiApIHtcclxuXHRcdFx0dmFyIG9mZnNldCA9IGdldE9mZnNldCggeCwgeSwgeiApO1xyXG5cdFx0XHRyZXR1cm4gKCBuZXdTZWN0b3IuZGF0YS5kYXRhW09mZnNldF0gKTtcclxuXHRcdH0sXG5cclxuXHRcdE1ha2VTZWN0b3IgOiBmdW5jdGlvbiggdHlwZSApIHtcclxuXHRcdFx0dmFyIHgsIHksIHo7XHJcblx0XHRcdHZhciBDbnQ7XHJcblx0XHRcdGlmKCB0eXBlICkgQ250ID0gdHlwZTtcclxuXHRcdFx0ZWxzZSBpZiggdGhpcy5Qb3NfeSA8IDAgKSB7IENudCA9IFZveGVsYXJpdW0uVm94ZWxzLnR5cGVzWzBdOyB0aGlzLkZsYWdfVm9pZF9SZWd1bGFyID0gZmFsc2U7IHRoaXMuRmxhZ19Wb2lkX1RyYW5zcGFyZW50ID0gdHJ1ZTsgfVxyXG5cdFx0XHRlbHNlIHsgQ250ID0gbnVsbDsgdGhpcy5GbGFnX1ZvaWRfUmVndWxhciA9IHRydWU7IHRoaXMuRmxhZ19Wb2lkX1RyYW5zcGFyZW50ID0gdHJ1ZTsgfVxyXG5cdFx0XHRmb3IoIHogPSAwOyB6IDwgdGhpcy5jbHVzdGVyLnNlY3RvclNpemVYOyB6KysgKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0Zm9yKCB5ID0gMDsgeSA8IHRoaXMuY2x1c3Rlci5zZWN0b3JTaXplWTsgeSsrIClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRmb3IoIHggPSAwOyB4IDwgdGhpcy5jbHVzdGVyLnNlY3RvclNpemVaOyB4KysgKVxyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRuZXdTZWN0b3Iuc2V0Q3ViZSggeCwgeSwgeiwgQ250ICk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cclxuXHRcdGdldFZveGVsUmVmIDogZnVuY3Rpb24oeCx5LHopIHtcclxuXHRcdFx0aWYoIHggPCAwICkgeCArPSB0aGlzLmNsdXN0ZXIuc2VjdG9yU2l6ZVg7XHJcblx0XHRcdGlmKCB5IDwgMCApIHkgKz0gdGhpcy5jbHVzdGVyLnNlY3RvclNpemVZO1xyXG5cdFx0XHRpZiggeiA8IDAgKSB6ICs9IHRoaXMuY2x1c3Rlci5zZWN0b3JTaXplWjtcclxuXHRcdFx0IHJldHVybiBtYWtlVm94ZWxSZWYoIHRoaXMuY2x1c3RlciwgdGhpcywgeCwgeSwgeiApOyB9LFxyXG5cclxuXHRcdHN0cmluZ2lmeSA6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgdiA9IHZ8fCBWb3hlbENvbXByZXNzb3IoKTtcclxuXHRcdFx0dmFyIGRhdGEgPSB2LkNvbXByZXNzVm94ZWxEYXRhKCB0aGlzLmRhdGEuZGF0YSApO1xyXG5cdFx0XHR2YXIgbiA9IDA7XHJcblx0XHRcdHZhciBzdHJpbmcgPSBcIlwiO1xyXG5cdFx0XHQvL3ZhciBzdiA9IG5ldyBTdHJpbmdWaWV3KCBkYXRhLmRhdGEgKTtcclxuXHRcdFx0Ly92YXIgdGVzdFN0cmluZyA9IHN2LnRvU3RyaW5nKCk7XHJcblx0XHRcdC8vdmFyIHRlc3RTdHJpbmcyID0gJ1xcdTAwMDhcXHUwMDAwXFx1MDAwMFxcdTAwMDFcXHUwMDAyXFx1MDAzM1xcdTAwZWYnXHJcblx0XHRcdGZvciggbiA9IDA7IG4gPCBkYXRhLmJ5dGVzX3VzZWQ7IG4rKyApIHtcclxuXHRcdFx0XHR2YXIgdmFsID0gZGF0YS5kYXRhW25dO1xyXG5cdFx0XHRcdGlmKCAhdmFsIClcclxuXHRcdFx0XHRcdHN0cmluZyArPSBcIlxcXFwwXCI7XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHR2YXIgb3V0ID0gU3RyaW5nLmZyb21Db2RlUG9pbnQoIHZhbCApO1xyXG5cdFx0XHRcdFx0aWYoIG91dCA9PT0gXCJcXFxcXCIgKVxyXG5cdFx0XHRcdFx0XHRzdHJpbmcgKz0gXCJcXFxcL1wiO1xyXG5cdFx0XHRcdFx0ZWxzZSBpZiggb3V0ID09PSBcIi9cIiApXHJcblx0XHRcdFx0XHRcdHN0cmluZyArPSBcIlxcXFx8XCI7XHJcblx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdHN0cmluZyArPSBvdXQ7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2YXIgYXJyYXkgPSBuZXcgQXJyYXlCdWZmZXIoc3RyaW5nLmxlbmd0aCk7XHJcblx0XHRcdHZhciBlc2NhcGUgPSBmYWxzZTtcclxuXHRcdFx0dmFyIG91dCA9IDA7XHJcblx0XHRcdGZvciggbiA9IDA7IG4gPCBzdHJpbmcubGVuZ3RoOyBuKysgKVxyXG5cdFx0XHRcdHsgdmFyIHZhbCA9IHN0cmluZy5jb2RlUG9pbnRBdCggbiApO1xyXG5cdFx0XHRcdFx0aWYoIGVzY2FwZSApIHtcclxuXHRcdFx0XHRcdFx0aWYoIHZhbCA9PT0gNDggKVxyXG5cdFx0XHRcdFx0XHRcdHZhbCA9IDA7XHJcblx0XHRcdFx0XHRcdGVzY2FwZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fWVsc2Uge1xyXG5cdFx0XHRcdFx0XHRpZiggdmFsID09IDkyICkge1xyXG5cdFx0XHRcdFx0XHRcdGVzY2FwZSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGFycmF5W291dCsrXSA9IHZhbDtcclxuXHRcdFx0XHRcdC8vY29uc29sZS5sb2coIHZhbCApXHJcblx0XHRcdFx0IH07XHJcblx0XHRcdFx0IC8vY29uc29sZS5sb2coIFwiQnVmZmVyIHdhc1wiLCBkYXRhLmRhdGEgKTtcclxuXHRcdFx0XHQgLy9jb25zb2xlLmxvZyggXCJ3aGljaCBiZWNhbWVcIiwgc3RyaW5nICk7XHJcblxyXG5cdFx0XHRcdCB7XHJcblx0XHRcdFx0XHQgdmFyIHRlc3Rfb3V0ID0gW107XHJcblx0XHRcdFx0XHQgY29uc29sZS5sb2coIFwiZGVjb2Rpbmcgc3RyaW5nIGp1c3QgZW5jb2RlZCB0byBzZWUgaWYgaXQncyB2YWxpZDtpZiBmYWlsZWQsIGRlYnVnZ2VyOyB3aWxsIHRyaWdnZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IEpTT04uc3RyaW5naWZ5KHN0cmluZyk7XG5cdFx0XHRcdFx0IHZhciB4ZmVyID0gSlNPTi5wYXJzZSggYSApO1xyXG5cdFx0XHRcdFx0IGlmKCB4ZmVyICE9PSBzdHJpbmcgKVxyXG5cdFx0XHRcdFx0IFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0XHQgZGVjb2RlU3RyaW5nKCBzdHJpbmcsIHRlc3Rfb3V0ICk7XHJcblx0XHRcdFx0XHQgaWYoIHRlc3Rfb3V0Lmxlbmd0aCA9PT0gZGF0YS5kYXRhLmxlbmd0aCApIHtcclxuXHRcdFx0XHRcdFx0IGZvciggdmFyIG4gPSAwOyBuIDwgdGVzdF9vdXQubGVuZ3RoOyBuKysgKSB7XHJcblx0XHRcdFx0XHRcdFx0IGlmKCB0ZXN0X291dFtuXSAhPT0gZGF0YS5kYXRhW25dIClcclxuXHRcdFx0XHRcdFx0XHQgXHRkZWJ1Z2dlcjtcclxuXHJcblx0XHRcdFx0XHRcdCB9XHJcblx0XHRcdFx0XHQgfVxyXG5cdFx0XHRcdCB9XHJcblx0XHRcdCB0aGlzLmNhY2hlZFN0cmluZyA9IHN0cmluZztcclxuXHRcdFx0cmV0dXJuIHN0cmluZztcclxuXHRcdH0sXHJcblxyXG5cdFx0ZGVjb2RlIDogZnVuY3Rpb24oIHN0cmluZyApIHtcclxuXHRcdFx0Y29uc29sZS5sb2coIFwiZGVjb2RlXCIsIHN0cmluZyApO1xyXG5cdFx0XHRpZiggc3RyaW5nID09PSB0aGlzLmNhY2hlZFN0cmluZyApXHJcblx0XHRcdFx0cmV0dXJuOyAvLyBhbHJlYWR5IGhhdmUgdGhpcyBhcyB0aGUgdGhpbmcuXHJcblx0XHRcdHRoaXMuY2FjaGVkU3RyaW5nID0gc3RyaW5nO1xyXG5cdFx0XHRkZWNvZGVTdHJpbmcoIHN0cmluZywgdGhpcy5kYXRhLmRhdGEgKVxyXG5cdFx0XHR0aGlzLkZsYWdfUmVuZGVyX0RpcnR5ID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5jbHVzdGVyLm1lc2hlci5TZWN0b3JVcGRhdGVGYWNlQ3VsbGluZyggdGhpcywgdHJ1ZSApXHJcblx0XHRcdC8vYmFzaWNNZXNoZXIuU2VjdG9yVXBkYXRlRmFjZUN1bGxpbmdfUGFydGlhbCggY2x1c3Rlciwgc2VjdG9yLCBWb3hlbGFyaXVtLkZBQ0VEUkFXX09wZXJhdGlvbnMuQUxMLCB0cnVlIClcclxuXHRcdFx0dGhpcy5jbHVzdGVyLm1lc2hlci5NYWtlU2VjdG9yUmVuZGVyaW5nRGF0YSggdGhpcyApO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHJcblxyXG4gICAgfVxuXG5mdW5jdGlvbiBkZWNvZGVTdHJpbmcoIHN0cmluZywgaW50byApe1xuXHR2YXIgYnl0ZXMgPSAwO1xuXHRcdFx0Zm9yKCB2YXIgbiA9IDA7IG4gPCBzdHJpbmcubGVuZ3RoOyBuKysgKXtcblx0XHRcdFx0aWYoIHN0cmluZ1tuXSA9PT0gJ1xcXFwnICkge1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9IGVsc2UgYnl0ZXMrKztcblx0XHRcdH1cblxuXHRcdFx0dmFyIGJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihieXRlcyk7XG5cdFx0XHRieXRlcyA9IDA7XG5cdFx0XHRmb3IoIHZhciBuID0gMDsgbiA8IHN0cmluZy5sZW5ndGg7IG4rKyApe1xuXHRcdFx0XHRpZiggc3RyaW5nW25dID09PSAnXFxcXCcgKSB7XG5cdFx0XHRcdFx0aWYoIHN0cmluZ1tuKzFdID09PSAnMCcgKVxuXHRcdFx0XHRcdFx0YnVmZmVyW2J5dGVzKytdID0gMDtcblx0XHRcdFx0XHRlbHNlIGlmKCBzdHJpbmdbbisxXSA9PT0gJy8nIClcblx0XHRcdFx0XHRcdGJ1ZmZlcltieXRlcysrXSA9ICdcXFxcJztcblx0XHRcdFx0XHRlbHNlIGlmKCBzdHJpbmdbbisxXSA9PT0gJ3wnIClcblx0XHRcdFx0XHRcdGJ1ZmZlcltieXRlcysrXSA9ICcvJztcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiSW52YWxpZCBlbmNvZGluZ1wiICk7XG5cdFx0XHRcdFx0bisrO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRidWZmZXJbYnl0ZXMrK10gPSBzdHJpbmcuY29kZVBvaW50QXQoIG4gKTtcblx0XHRcdH1cblxuXG5cdFx0XHR2YXIgdiA9IHZ8fCBWb3hlbENvbXByZXNzb3IoKTtcblx0XHRcdHZhciBkYXRhID0gdi5EZWNvbXByZXNzVm94ZWxEYXRhKCBidWZmZXIsIGludG8gKTtcblxuXHRcdH1cblxuXG4gICAgcmV0dXJuIG5ld1NlY3Rvcjtcbn1cblxuXG5mdW5jdGlvbiBWb3hlbENvbXByZXNzb3IoKSB7XG5cdFx0Lypcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFZveGVsRGF0YUNvbXByZXNzb3IgdmRjID0gbmV3IFZveGVsRGF0YUNvbXByZXNzb3IoKTtcblx0XHRcdFx0XHRcdHVzaG9ydFtdIGRlY29tcHJlc3MgPSBuZXcgdXNob3J0WzMyICogMzIgKiAzMl07XG5cdFx0XHRcdFx0XHRieXRlW10gZGF0YTtcblx0XHRcdFx0XHRcdGludCBieXRlcztcblx0XHRcdFx0XHRcdHZkYy5Db21wcmVzc1ZveGVsRGF0YSggU2VjdG9yLkRhdGEuRGF0YSwgb3V0IGRhdGEsIG91dCBieXRlcyApO1xuXHRcdFx0XHRcdFx0TG9nLmxvZyggXCJjb21wcmVzc2VkIHNlY3RvciBpcyB7MH1cIiwgYnl0ZXMsIDAgKTtcblx0XHRcdFx0XHRcdHZkYy5EZWNvbXByZXNzVm94ZWxEYXRhKCBkYXRhLCBkZWNvbXByZXNzICk7XG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdGludCBuO1xuXHRcdFx0XHRcdFx0XHRmb3IoIG4gPSAwOyBuIDwgMzIgKiAzMiAqIDMyOyBuKysgKVxuXHRcdFx0XHRcdFx0XHRcdGlmKCBkZWNvbXByZXNzW25dICE9IFNlY3Rvci5EYXRhLkRhdGFbbl0gKVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGludCBhID0gMztcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0Ki9cblxuXHRcdFx0Ly8vIDxzdW1tYXJ5PlxuXHRcdFx0Ly8vIEhhbmRsZXMgY29tcHJlc3NpbmcgYW5kIGRlY29tcHJlc3NpbmcgdXNob3J0IGFycmF5IHRoYXQgaXMgdGhlIHNlY3RvciBjb250ZW50XG5cdFx0XHQvLy8gPC9zdW1tYXJ5PlxuXHR2YXIgdmMgPSB7XG5cblx0XHRcdFdyaXRlQ3ViZXMgOiBmdW5jdGlvbiggc3RyZWFtLCBiaXRzLCBjb3VudCwgaW5kZXggKVxuXHRcdFx0e1xuXHRcdFx0XHQvLyAxIGNvdW50IDIgYml0cyA9IDMgICB2cyA5XG5cdFx0XHRcdC8vIDEgY291bnQgMyBiaXRzID0gNCAgIHZzIDEwXG5cdFx0XHRcdC8vIDEgY291bnQgIDQgYml0cyAgPSA1ICAgICB2cyAxMVxuXHRcdFx0XHQvLyAxIGNvdW50ICA1IGJpdHMgID0gNiAgICAgdnMgMTJcblx0XHRcdFx0Ly8gMSBjb3VudCAgNiBiaXRzICA9IDcgICAgIHZzIDEzXG5cdFx0XHRcdC8vIDEgY291bnQgIDcgYml0cyAgPSA4ICAgICB2cyAxNFxuXG5cdFx0XHRcdC8vIDIgY291bnQgMiBiaXRzID0gNiAgIHZzIDlcblx0XHRcdFx0Ly8gMiBjb3VudCAzIGJpdHMgPSA4ICAgdnMgMTBcblx0XHRcdFx0Ly8gMiBjb3VudCAgNCBiaXRzICA9IDEwICAgIHZzIDExXG5cdFx0XHRcdC8vIDIgY291bnQgIDUgYml0cyAgPSAxMiAgICB2cyAxMlxuXHRcdFx0XHQvLyAyIGNvdW50ICA2IGJpdHMgID0gMTQgICAgdnMgMTNcblx0XHRcdFx0Ly8gMiBjb3VudCAgNyBiaXRzICA9IDE2ICAgIHZzIDE0XG5cblx0XHRcdFx0Ly8gMyBjb3VudCAyIGJpdHMgPSA5ICAgdnMgOVxuXHRcdFx0XHQvLyAzIGNvdW50IDMgYml0cyA9IDEyICB2cyAxMFxuXHRcdFx0XHQvLyAzIGNvdW50ICA0IGJpdHMgID0gMTUgICAgdnMgMTFcblx0XHRcdFx0Ly8gMyBjb3VudCAgNSBiaXRzICA9IDE4ICAgIHZzIDEyXG5cdFx0XHRcdC8vIDMgY291bnQgIDYgYml0cyAgPSAyMSAgICB2cyAxM1xuXHRcdFx0XHQvLyAzIGNvdW50ICA3IGJpdHMgID0gMjQgICAgdnMgMTRcblxuXG5cdFx0XHRcdGlmKCAoIChiaXRzICsxKSAqIGNvdW50ICkgPD0gKCA3ICsgYml0cyApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGZvciggdmFyIG4gPSAwOyBuIDwgY291bnQ7IG4rKyApXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0c3RyZWFtLndyaXRlKCAwLCAxICk7XG5cdFx0XHRcdFx0XHRzdHJlYW0ud3JpdGUoIGluZGV4LCBiaXRzICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHN0cmVhbS53cml0ZSggMSwgMSApO1xuXHRcdFx0XHRcdC8vTG9nLmxvZyggXCJXcml0ZSBjb3VudCB7MH1cIiwgY291bnQgKTtcblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdGlmKCAoIGNvdW50ICYgMHg4MDAwICkgIT0gMCApXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0c3RyZWFtLldyaXRlKCAoICggY291bnQgPj4gMTUgKSAmIDB4MUYgKSB8IDB4MjAsIDcgKTtcblx0XHRcdFx0XHRcdHN0cmVhbS5Xcml0ZSggKCAoIGNvdW50ID4+IDEwICkgJiAweDFGICkgfCAweDIwLCA3ICk7XG5cdFx0XHRcdFx0XHRzdHJlYW0uV3JpdGUoICggKCBjb3VudCA+PiA1ICkgJiAweDFGICkgfCAweDIwLCA3ICk7XG5cdFx0XHRcdFx0XHRzdHJlYW0uV3JpdGUoICggKCBjb3VudCAgKSAmIDB4MUYgKSwgNyApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlICovXG5cdFx0XHRcdFx0Y291bnQgLT0gMjsgLy8gYWx3YXlzIGF0IGxlYXN0IDEsIGFuZCB0aGVuIHRoaXMgdmFsdWUgYWx3YXlzIHN0YXJ0cyBhdCBhdGxlYXN0IDI7IGFuZCB2ZXJ5IHNtYWxsIGRlbHRhIHNldHMgY2FuIGJlIDMsIGJ1dCB0eXBpY2FsbHkgMi5cblx0XHRcdFx0XHRpZiggKCBjb3VudCAmIDB4RkMwMCApICE9IDAgKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdHN0cmVhbS53cml0ZSggKCAoIGNvdW50ID4+IDEwICkgJiAweDFGICkgfCAweDIwLCA2ICk7XG5cdFx0XHRcdFx0XHRzdHJlYW0ud3JpdGUoICggKCBjb3VudCA+PiA1ICkgJiAweDFGICkgfCAweDIwLCA2ICk7XG5cdFx0XHRcdFx0XHRzdHJlYW0ud3JpdGUoICggKCBjb3VudCApICYgMHgxRiApLCA2ICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYoICggY291bnQgJiAweEZGRTAgKSAhPSAwIClcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRzdHJlYW0ud3JpdGUoICggKCBjb3VudCA+PiA1ICkgJiAweDFGICkgfCAweDIwLCA2ICk7XG5cdFx0XHRcdFx0XHRzdHJlYW0ud3JpdGUoICggKCBjb3VudCApICYgMHgxRiApICwgNiApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0c3RyZWFtLndyaXRlKCAoICggY291bnQgKSAmIDB4MUYgKSwgNiApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvL3N0cmVhbS5Xcml0ZSggY291bnQsIDE2ICk7XG5cdFx0XHRcdFx0c3RyZWFtLndyaXRlKCBpbmRleCwgYml0cyApO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0sXG5cblx0XHRcdENvbXByZXNzVm94ZWxEYXRhIDogZnVuY3Rpb24oIGRhdGEgKVxuXHRcdFx0e1xuXHRcdFx0XHR2YXIgc3RyZWFtID0gVm94ZWxhcml1bS5CaXRTdHJlYW0oKTtcblx0XHRcdFx0dmFyIGxlbiA9IGRhdGEubGVuZ3RoO1xuXHRcdFx0XHR2YXIgbjtcblx0XHRcdFx0dmFyIHR5cGVzID0gW107XG5cblx0XHRcdFx0Zm9yKCBuID0gMDsgbiA8IGxlbjsgbisrIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHZhciB2b3ggPSBWb3hlbGFyaXVtLlZveGVscy5nZXRJbmRleCggZGF0YVtuXSApXG5cdFx0XHRcdFx0aWYoIHR5cGVzLmZpbmRJbmRleCggKHYpID0+IHY9PT12b3ggKSA8IDAgKVxuXHRcdFx0XHRcdFx0dHlwZXMucHVzaCggdm94ICk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR2YXIgYml0cyA9IFZveGVsYXJpdW0uQml0U3RyZWFtLkdldE1pbkJpdHNOZWVkZWRGb3JWYWx1ZSggdHlwZXMubGVuZ3RoIC0gMSApOyAvLyA0IGlzIDAsMSwyLDM7IG5lZWRzIG9ubHkgMiBiaXRzLi4uXG5cdFx0XHRcdC8vYml0cyA9IChiaXRzICsgNyApICYgMHhmODtcblx0XHRcdFx0c3RyZWFtLnNlZWsoIDE2ICk7IC8vIHNlZWsgYml0IGNvdW50XG5cdFx0XHRcdHN0cmVhbS53cml0ZSggYml0cywgOCApO1xuXHRcdFx0XHRzdHJlYW0ud3JpdGUoIHR5cGVzLmxlbmd0aC0xLCBiaXRzICk7XG5cdFx0XHRcdHR5cGVzLmZvckVhY2goICh0eXBlKT0+e1xuXHRcdFx0XHRcdHN0cmVhbS53cml0ZSggdHlwZSwgMTYgKTsgfSApO1xuXHRcdFx0XHR2YXIgcHJpb3JfY3ViZSA9IDB4RkZGRiwgY3ViZTtcblx0XHRcdFx0dmFyIGluZGV4ID0gMDtcblx0XHRcdFx0dmFyIGNvdW50ID0gMDtcblx0ICAgICAgICAgICAgZm9yKCBuID0gMDsgbiA8IGxlbjsgbisrIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHZhciBjdWJlID0gVm94ZWxhcml1bS5Wb3hlbHMuZ2V0SW5kZXgoIGRhdGFbbl0gKVxuXHRcdFx0XHRcdGlmKCBwcmlvcl9jdWJlICE9IGN1YmUgKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGlmKCBjb3VudCA+IDAgKVxuXHRcdFx0XHRcdFx0XHR2Yy5Xcml0ZUN1YmVzKCBzdHJlYW0sIGJpdHMsIGNvdW50LCBpbmRleCApO1xuXHRcdFx0XHRcdFx0aW5kZXggPSB0eXBlcy5maW5kSW5kZXgoICh2KT0+KHY9PT0gY3ViZSApICk7XG5cdFx0XHRcdFx0XHRwcmlvcl9jdWJlID0gY3ViZTtcblx0XHRcdFx0XHRcdGNvdW50ID0gMTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0Y291bnQrKztcblx0XHRcdFx0fVxuXHRcdFx0XHR2Yy5Xcml0ZUN1YmVzKCBzdHJlYW0sIGJpdHMsIGNvdW50LCBpbmRleCApO1xuXG5cdFx0XHRcdHZhciByZXN1bHQgPSBzdHJlYW0uZ2V0Qnl0ZXMoKTtcblx0XHRcdFx0cmVzdWx0LmRhdGFbMF0gPSAoKCByZXN1bHQuYnl0ZXNfdXNlZCApICYgMHhGRik7XG5cdFx0XHRcdHJlc3VsdC5kYXRhWzFdID0gKCAoIHJlc3VsdC5ieXRlc191c2VkICkgPj4gOCk7XG5cdFx0XHRcdC8vIGFscmVhZHkgY29tcHJlc3NlZCBhcyBjYW4gYmUuXG5cdFx0XHRcdGlmKCByZXN1bHQuYnl0ZXNfdXNlZCA8IDIwIClcblx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXG5cdFx0XHRcdC8qIGNhbiBnemlwIHRoZSBzdHJlYW0gYXQgdGhpcyBwb2ludCB0b28gYW5kIHNhdmUgMTAtMjAlIG1vcmUgKi9cblx0XHRcdFx0Lypcblx0XHRcdFx0TWVtb3J5U3RyZWFtIGZpbmFsX3N0cmVhbSA9IG5ldyBNZW1vcnlTdHJlYW0oKTtcblx0XHRcdFx0ZmluYWxfc3RyZWFtLlNlZWsoIDIsIFNlZWtPcmlnaW4uQmVnaW4gKTtcblx0XHRcdFx0Ly9EZWZsYXRlU3RyZWFtIGd6X3N0cmVhbSA9IG5ldyBEZWZsYXRlU3RyZWFtKCBmaW5hbF9zdHJlYW0sIENvbXByZXNzaW9uTW9kZS5Db21wcmVzcyApO1xuXHRcdFx0XHQvL0daaXBTdHJlYW0gZ3pfc3RyZWFtID0gbmV3IEdaaXBTdHJlYW0oIGZpbmFsX3N0cmVhbSwgQ29tcHJlc3Npb25Nb2RlLkNvbXByZXNzICk7XG5cdFx0XHRcdEdaaXBTdHJlYW0gZ3pfc3RyZWFtID0gbmV3IEdaaXBTdHJlYW0oIGZpbmFsX3N0cmVhbSwgQ29tcHJlc3Npb25MZXZlbC5GYXN0ZXN0ICk7XG5cdFx0XHRcdC8vZm9yKCBuID0gMjsgbiA8IGJ5dGVzX3VzZWQ7IG4rKyApXG5cdFx0XHRcdC8vXHRnel9zdHJlYW0uV3JpdGVCeXRlKCByZXN1bHRbbl0gKTtcblx0XHRcdFx0Z3pfc3RyZWFtLldyaXRlKCByZXN1bHQsIDIsIGJ5dGVzX3VzZWQgLSAyICk7XG5cdFx0XHRcdGd6X3N0cmVhbS5DbG9zZSgpO1xuXHRcdFx0XHRyZXN1bHQgPSBmaW5hbF9zdHJlYW0uVG9BcnJheSgpOy8vLkdldEJ1ZmZlcigpO1xuXHRcdFx0XHRMb2cubG9nKCBcIkNvbXByZXNzZWQgYW5vdGhlciB7MH0lXCIsIChmbG9hdCkoIDEwMC4wZiAqIChmbG9hdCkoIGJ5dGVzX3VzZWQgLSByZXN1bHQuTGVuZ3RoICkgLyAoIGJ5dGVzX3VzZWQgLSAyICkgKSApO1xuXHRcdFx0XHQvLyBzdG9yZSBvbGQgbGVuZ3RoIHNvIHdlIGtub3cgaG93IG11Y2ggdG8gcmVxdWVzdCBkZWNvbXByZXNzaW5nLlxuXHRcdFx0XHRyZXN1bHRbMF0gPSAoYnl0ZSkoICggYnl0ZXNfdXNlZCApICYgMHhGRiApO1xuXHRcdFx0XHRyZXN1bHRbMV0gPSAoYnl0ZSkoICggYnl0ZXNfdXNlZCApID4+IDggKTtcblx0XHRcdFx0Ynl0ZXNfdXNlZCA9IHJlc3VsdC5MZW5ndGg7Ly8gKGludClmaW5hbF9zdHJlYW0uTGVuZ3RoO1xuXHRcdFx0XHRnel9zdHJlYW0uRGlzcG9zZSgpO1xuXHRcdFx0XHQqL1xuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0fSxcblxuXHRcdFx0RGVjb21wcmVzc1ZveGVsRGF0YSA6IGZ1bmN0aW9uKCAgZGF0YSwgcmVzdWx0IClcblx0XHRcdHtcblx0XHRcdFx0dmFyIHN0cmVhbTtcblx0XHRcdFx0dmFyIERhdGFCeXRlcztcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHN0cmVhbSA9IFZveGVsYXJpdW0uQml0U3RyZWFtKCBkYXRhICk7XG5cdFx0XHRcdFx0c3RyZWFtLnNlZWsoIDE2ICk7IC8vIHNlZWsgYnkgYml0IHBvc2l0aW9uXG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIHR5cGVzID0gW107XG5cblx0XHRcdFx0dmFyIGJpdHM7XG5cdFx0XHRcdHZhciBUeXBlQ291bnQ7XG5cdFx0XHRcdGJpdHMgPSBzdHJlYW0ucmVhZCggOCk7XG5cdFx0XHRcdFR5cGVDb3VudCA9IHN0cmVhbS5yZWFkKCBiaXRzICk7XG5cdFx0XHRcdFR5cGVDb3VudCsrOyAvLyBhbHdheXMgYXQgbGVhc3Qgb25lLlxuXHRcdFx0XHR2YXIgbjtcblx0XHRcdFx0Zm9yKCBuID0gMDsgbiA8IFR5cGVDb3VudDsgbisrIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHZhciB2YWw7XG5cdFx0XHRcdFx0dmFsID0gc3RyZWFtLnJlYWQoIDE2ICk7XG5cdFx0XHRcdFx0dmFyIGFzc2VydFZhbDtcblx0XHRcdFx0XHRhc3NlcnRWYWwgPSBWb3hlbGFyaXVtLlZveGVscy50eXBlc1t2YWxdO1xuXHRcdFx0XHRcdGlmKCBhc3NlcnRWYWwgKVxuXHRcdFx0XHRcdFx0dHlwZXMucHVzaCggYXNzZXJ0VmFsICk7XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0dHlwZXMucHVzaCggVm94ZWxhcml1bS5Wb3hlbHMuVm9pZCApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIG91dHBvcyA9IDA7XG5cdFx0XHRcdGRvXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR2YXIgdm94O1xuXHRcdFx0XHRcdHZhciB2YWw7XG5cdFx0XHRcdFx0dmFyIGNvdW50O1xuXHRcdFx0XHRcdHZhbCA9IHN0cmVhbS5yZWFkKCAxICk7XG5cdFx0XHRcdFx0aWYoIHZhbCA9PSAwIClcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHR2YWwgPSBzdHJlYW0ucmVhZCggYml0cyApO1xuXHRcdFx0XHRcdFx0dm94ID0gdHlwZXNbdmFsXTtcblx0XHRcdFx0XHRcdGlmKCAhdm94ICkgZGVidWdnZXI7XG5cdFx0XHRcdFx0XHRyZXN1bHRbb3V0cG9zKytdID0gdm94O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0dmFyIGNvdW50X3RtcDtcblx0XHRcdFx0XHRcdGNvdW50X3RtcCA9IHN0cmVhbS5yZWFkKCA2ICApO1xuXHRcdFx0XHRcdFx0Y291bnQgPSBjb3VudF90bXAgJiAweDFGO1xuXHRcdFx0XHRcdFx0aWYoICggY291bnRfdG1wICYgMHgyMCApICE9IDAgKVxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRjb3VudCA8PD0gNTtcblx0XHRcdFx0XHRcdFx0Y291bnRfdG1wID0gc3RyZWFtLnJlYWQoIDYgKTtcblx0XHRcdFx0XHRcdFx0Y291bnQgfD0gY291bnRfdG1wICYgMHgxRjtcblx0XHRcdFx0XHRcdFx0aWYoICggY291bnRfdG1wICYgMHgyMCApICE9IDAgKVxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0Y291bnQgPDw9IDU7XG5cdFx0XHRcdFx0XHRcdFx0Y291bnRfdG1wID0gc3RyZWFtLnJlYWQoIDYgKTtcblx0XHRcdFx0XHRcdFx0XHRjb3VudCB8PSBjb3VudF90bXAgJiAweDFGO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRjb3VudCArPSAyO1xuXHRcdFx0XHRcdFx0Ly9zdHJlYW0uUmVhZCggMTYsIG91dCBjb3VudCApO1xuXHRcdFx0XHRcdFx0Ly9Mb2cubG9nKCBcIlJlYWQgY291bnQgezB9XCIsIGNvdW50ICk7XG5cdFx0XHRcdFx0XHR2YWwgPSBzdHJlYW0ucmVhZCggYml0cyApO1xuXHRcdFx0XHRcdFx0dm94ID0gdHlwZXNbdmFsXTtcblx0XHRcdFx0XHRcdGlmKCAhdm94ICkge1xuXHRcdFx0XHRcdFx0XHR2b3ggPSB0eXBlc1swXTtcblx0XHRcdFx0XHRcdFx0ZGVidWdnZXI7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKCBcIlNldCB2b3ggdG8gXCIsIHZveCApXG5cdFx0XHRcdFx0XHRmb3IoIG4gPSAwOyBuIDwgY291bnQ7IG4rKyApXG5cdFx0XHRcdFx0XHRcdHJlc3VsdFtvdXRwb3MrK10gPSB2b3g7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IHdoaWxlKCBvdXRwb3MgPCByZXN1bHQubGVuZ3RoICk7XG5cblx0XHRcdH1cblxuXHRcdH1cblx0cmV0dXJuIHZjO1xufVxuXG5mdW5jdGlvbiBOZWFyVm94ZWxSZWYoKSB7XG5cdHZhciByZXN1bHQgPSB7XG5cdCBzZWN0b3I6dGhpcyxcblx0IHZveGVsVHlwZTpudWxsLFxuXHQgb2Zmc2V0OjAsXG5cdCB2b3hlbEV4dGVuc2lvbjpudWxsXG4gXHR9XG5cdHJlc3VsdC52b3hlbFR5cGUgPSB0aGlzLmRhdGEuZGF0YVtyZXN1bHQub2Zmc2V0XTtcblx0cmVzdWx0LnZveGVsRXh0ZW5zaW9uID0gdGhpcy5kYXRhLm90aGVySW5mb3NbcmVzdWx0Lm9mZnNldF07XG5cdCByZXR1cm4gcmVzdWx0O1xufVxuXHJcbmZ1bmN0aW9uIFZveGVsUmVmKCB4LCB5LCB6ICkge1xyXG59XHJcblxyXG52YXIgcmVmUG9vbCA9IFtdO1xyXG5cclxuVm94ZWxhcml1bS5Wb3hlbFJlZiA9IG1ha2VWb3hlbFJlZlxyXG5cclxuXHJcbmZ1bmN0aW9uIG1ha2VWb3hlbFJlZiggY2x1c3Rlciwgc2VjdG9yLCB4LCB5LCB6IClcclxue1xuXHR2YXIgcmVzdWx0O1xuXHRyZXN1bHQgPSByZWZQb29sLnBvcCgpO1xuXHRpZiggIXJlc3VsdCApIHtcblx0XHRyZXN1bHQgPSB7IHNlY3RvciA6IHNlY3RvclxuXHRcdFx0XHQsIG9mZnNldCA6IDBcblx0XHRcdFx0LCB4IDogeCwgeSA6IHksIHogOiB6XG5cdFx0XHQgXHQsIHd4IDogc2VjdG9yPyhzZWN0b3IucG9zLnggKiBjbHVzdGVyLnNlY3RvclNpemVYICsgeCk6eFxyXG5cdFx0XHRcdCwgd3kgOiBzZWN0b3I/KHNlY3Rvci5wb3MueSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKyB5KTp5XHJcblx0XHRcdFx0LCB3eiA6IHNlY3Rvcj8oc2VjdG9yLnBvcy56ICogY2x1c3Rlci5zZWN0b3JTaXplWiArIHopOnpcclxuXHRcdFx0XHQsIHZveGVsVHlwZSA6IG51bGxcblx0XHRcdFx0LCBjbHVzdGVyIDogY2x1c3RlclxyXG5cdFx0XHRcdCwgdm94ZWxFeHRlbnNpb24gOiBudWxsXG5cdFx0XHRcdCwgZm9yRWFjaCA6IGZvckVhY2hcblx0XHRcdFx0LCBkZWxldGUgOiBmdW5jdGlvbigpIHsgcmVmUG9vbC5wdXNoKCB0aGlzICk7IH1cblx0XHRcdFx0LCBjbG9uZSA6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpcy5zZWN0b3IuZ2V0Vm94ZWxSZWYoIHRoaXMueCwgdGhpcy55LCB0aGlzLnogKSB9XHJcblx0XHRcdFx0LCBnZXROZWFyVm94ZWwgOiBHZXRWb3hlbFJlZlxuXHRcdFx0XHQgfVxuXHRcdE9iamVjdC5zZWFsKCByZXN1bHQgKTtcblx0fVxuXHRlbHNlIHtcblx0XHRyZXN1bHQuc2VjdG9yID0gc2VjdG9yO1xuXHRcdHJlc3VsdC5vZmZzZXQgPSAwO1xuXHRcdHJlc3VsdC54ID0geDtcblx0XHRyZXN1bHQueSA9IHk7XG5cdFx0cmVzdWx0LnogPSB6O1xuXHRcdHJlc3VsdC53eCA9IHNlY3Rvcj8oc2VjdG9yLnBvcy54ICogY2x1c3Rlci5zZWN0b3JTaXplWCArIHgpOnhcblx0XHRyZXN1bHQud3kgPSBzZWN0b3I/KHNlY3Rvci5wb3MueSAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKyB5KTp5XG5cdFx0cmVzdWx0Lnd6ID0gc2VjdG9yPyhzZWN0b3IucG9zLnogKiBjbHVzdGVyLnNlY3RvclNpemVaICsgeik6elxuXHRcdHJlc3VsdC52b3hlbFR5cGUgPSBudWxsO1xuXHRcdHJlc3VsdC5jbHVzdGVyID0gY2x1c3Rlcjtcblx0XHRyZXN1bHQudm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHR9XG4gICAgaWYoIHNlY3RvciApIHtcblx0XHQvLyB3eCBjb29yZHMgd2lsbCBzdGlsbCBiZSBhY2N1cmF0ZSBldmVuIGlmIHRoZSBzdWItcmFuZ2UgYW5kIG9yaWdpbiBzZWN0b3IgbW92ZSBub3cuXG5cdFx0aWYoIHJlc3VsdC54IDwgMCApIHsgcmVzdWx0LnggKz0gY2x1c3Rlci5zZWN0b3JTaXplWDsgcmVzdWx0LnNlY3RvciA9ICggcmVzdWx0LnNlY3RvciAmJiByZXN1bHQuc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXSB8fCByZXN1bHQuc2VjdG9yICkgfVxuXHRcdGlmKCByZXN1bHQueSA8IDAgKSB7IHJlc3VsdC55ICs9IGNsdXN0ZXIuc2VjdG9yU2l6ZVk7IHJlc3VsdC5zZWN0b3IgPSAoIHJlc3VsdC5zZWN0b3IgJiYgcmVzdWx0LnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10gfHwgcmVzdWx0LnNlY3RvciApIH1cblx0XHRpZiggcmVzdWx0LnogPCAwICkgeyByZXN1bHQueiArPSBjbHVzdGVyLnNlY3RvclNpemVaOyByZXN1bHQuc2VjdG9yID0gKCByZXN1bHQuc2VjdG9yICYmIHJlc3VsdC5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdIHx8IHJlc3VsdC5zZWN0b3IgKSB9XG5cdFx0aWYoIHJlc3VsdC54ID49IGNsdXN0ZXIuc2VjdG9yU2l6ZVggKSB7IHJlc3VsdC54IC09IGNsdXN0ZXIuc2VjdG9yU2l6ZVg7IHJlc3VsdC5zZWN0b3IgPSAoIHJlc3VsdC5zZWN0b3IgJiYgcmVzdWx0LnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSB8fCByZXN1bHQuc2VjdG9yICkgfVxuXHRcdGlmKCByZXN1bHQueSA+PSBjbHVzdGVyLnNlY3RvclNpemVZICkgeyByZXN1bHQueSArPSBjbHVzdGVyLnNlY3RvclNpemVZOyByZXN1bHQuc2VjdG9yID0gKCByZXN1bHQuc2VjdG9yICYmIHJlc3VsdC5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdIHx8IHJlc3VsdC5zZWN0b3IgKSB9XG5cdFx0aWYoIHJlc3VsdC56ID49IGNsdXN0ZXIuc2VjdG9yU2l6ZVogKSB7IHJlc3VsdC56ICs9IGNsdXN0ZXIuc2VjdG9yU2l6ZVo7IHJlc3VsdC5zZWN0b3IgPSAoIHJlc3VsdC5zZWN0b3IgJiYgcmVzdWx0LnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdIHx8IHJlc3VsdC5zZWN0b3IgKSB9XG5cblx0XHRyZXN1bHQub2Zmc2V0ID0gKCByZXN1bHQueCAqIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKSAgKyByZXN1bHQueSArICggcmVzdWx0LnogKiAoIGNsdXN0ZXIuc2VjdG9yU2l6ZVkgKiBjbHVzdGVyLnNlY3RvclNpemVYICkgKTtcblx0XHQgIHJlc3VsdC52b3hlbFR5cGUgPSBzZWN0b3IuZGF0YS5kYXRhW3Jlc3VsdC5vZmZzZXRdXHJcblx0XHQgIGlmKCAhcmVzdWx0LnZveGVsVHlwZSApXHJcblx0XHQgIFx0cmV0dXJuIG51bGw7XHJcblx0XHQgIHJlc3VsdC52b3hlbEV4dGVuc2lvbiA9IHNlY3Rvci5kYXRhLm90aGVySW5mb3NbcmVzdWx0Lm9mZnNldF07XHJcbiAgICB9XHJcblx0cmV0dXJuIHJlc3VsdDtcclxufVxuXG5cdGZ1bmN0aW9uIGZvckVhY2goIHZveGVsUmVmMiwgbm90X3plcm8sIGNhbGxiYWNrIClcblx0e1xuXHRcdHZhciB2b3hlbFJlZjEgPSB0aGlzO1xuXHRcdC8vaWYoIHZveGVsUmVmMS5zZWN0b3IgPT0gbnVsbCB8fCB2b3hlbFJlZjIuc2VjdG9yID09IG51bGwgKVxyXG5cdFx0Ly9cdHJldHVybiBub3RfemVybyA/IDEgOiAwO1xyXG5cdFx0aWYoIHZveGVsUmVmMS5jbHVzdGVyICE9PSB2b3hlbFJlZjIuY2x1c3RlciApXHJcblx0XHRcdHJldHVybiBub3RfemVybyA/IDEgOiAwO1xuXHRcdHZhciBjbHVzdGVyID0gdm94ZWxSZWYxLmNsdXN0ZXI7XHJcblxuXHRcdHZhciB2MXggPSB2b3hlbFJlZjEud3g7XG5cdFx0dmFyIHYxeSA9IHZveGVsUmVmMS53eTtcblx0XHR2YXIgdjF6ID0gdm94ZWxSZWYxLnd6O1xuXHRcdHZhciB2MnggPSB2b3hlbFJlZjIud3g7XG5cdFx0dmFyIHYyeSA9IHZveGVsUmVmMi53eTtcblx0XHR2YXIgdjJ6ID0gdm94ZWxSZWYyLnd6O1xuXHRcdHZhciBkZWxfeCA9IHYyeCAtIHYxeDtcclxuXHRcdHZhciBkZWxfeSA9IHYyeSAtIHYxeTtcclxuXHRcdHZhciBkZWxfeiA9IHYyeiAtIHYxejtcclxuXHRcdHZhciBhYnNfeCA9IGRlbF94IDwgMCA/IC1kZWxfeCA6IGRlbF94O1xuXHRcdHZhciBhYnNfeSA9IGRlbF95IDwgMCA/IC1kZWxfeSA6IGRlbF95O1xuXHRcdHZhciBhYnNfeiA9IGRlbF96IDwgMCA/IC1kZWxfeiA6IGRlbF96O1xuXHRcdC8vIGNhbm5vdCB1c2UgaXRlcmF0ZSBpZiBlaXRoZXIgZW5kIGlzIHVuZGVmaW5lZC5cblx0XHRpZiggZGVsX3ggIT0gMCApXG5cdFx0e1xuXHRcdFx0aWYoIGRlbF95ICE9IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHRpZiggZGVsX3ogIT0gMCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRpZiggYWJzX3ggPiBhYnNfeSB8fCAoIGFic196ID4gYWJzX3kgKSApXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0aWYoIGFic196ID4gYWJzX3ggKVxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHQvLyB6IGlzIGxvbmdlc3QgcGF0aFxuXHRcdFx0XHRcdFx0XHR2YXIgZXJyeSA9IC1hYnNfeiAvIDI7XG5cdFx0XHRcdFx0XHRcdHZhciBlcnJ4ID0gLWFic196IC8gMjtcblx0XHRcdFx0XHRcdFx0dmFyIGluY3kgPSBkZWxfeSA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0XHRcdHZhciBpbmN4ID0gZGVsX3ggPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0XHR2YXIgaW5jeiA9IGRlbF96IDwgMCA/IC0xIDogMTtcblx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdHZhciB4ID0gdjF4O1xuXHRcdFx0XHRcdFx0XHRcdHZhciB5ID0gdjF5O1xuXHRcdFx0XHRcdFx0XHRcdGZvciggdmFyIHogPSB2MXogKyBpbmN6OyB6ICE9IHYyejsgeiArPSBpbmN6IClcblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJ4ICs9IGFic194O1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYoIGVycnggPiAwIClcblx0XHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZXJyeCAtPSBhYnNfejtcblx0XHRcdFx0XHRcdFx0XHRcdFx0eCArPSBpbmN4O1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0ZXJyeSArPSBhYnNfeTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCBlcnJ5ID4gMCApXG5cdFx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVycnkgLT0gYWJzX3o7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHkgKz0gaW5jeTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGV0IHYgPSBjbHVzdGVyLmdldFZveGVsUmVmKCBmYWxzZSwgeCwgeSwgeiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2ICkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0bGV0IHZhbCA9IGNhbGxiYWNrKCB2ICk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIHZhbCAhPT0gdiApIHYuZGVsZXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoICggIW5vdF96ZXJvICYmIHZhbCApIHx8ICggbm90X3plcm8gJiYgIXZhbCApIClcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB2YWw7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0Ly8geCBpcyBsb25nZXN0LlxuXHRcdFx0XHRcdFx0XHR2YXIgZXJyeSA9IC1hYnNfeCAvIDI7XG5cdFx0XHRcdFx0XHRcdHZhciBlcnJ6ID0gLWFic194IC8gMjtcblx0XHRcdFx0XHRcdFx0dmFyIGluY3kgPSBkZWxfeSA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0XHRcdHZhciBpbmN4ID0gZGVsX3ggPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0XHR2YXIgaW5jeiA9IGRlbF96IDwgMCA/IC0xIDogMTtcblx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdHZhciB5ID0gdjF5O1xuXHRcdFx0XHRcdFx0XHRcdHZhciB6ID0gdjF6O1xuXHRcdFx0XHRcdFx0XHRcdGZvciggdmFyIHggPSB2MXggKyBpbmN4OyB4ICE9IHYyeDsgeCArPSBpbmN4IClcblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJ6ICs9IGFic196O1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYoIGVycnogPiAwIClcblx0XHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZXJyeiAtPSBhYnNfeDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0eiArPSBpbmN6O1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0ZXJyeSArPSBhYnNfeTtcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCBlcnJ5ID4gMCApXG5cdFx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVycnkgLT0gYWJzX3g7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHkgKz0gaW5jeTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGV0IHYgPSBjbHVzdGVyLmdldFZveGVsUmVmKCBmYWxzZSwgeCwgeSwgeiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2ICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGxldCB2YWwgPSBjYWxsYmFjayggdiApO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2YWwgIT09IHYgKSB2LmRlbGV0ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoICFub3RfemVybyAmJiB2YWwgKSB8fCAoIG5vdF96ZXJvICYmICF2YWwgKSApXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHQvLyB5IGlzIGxvbmdlc3QuXG5cdFx0XHRcdFx0XHR2YXIgZXJyeCA9IC1hYnNfeSAvIDI7XG5cdFx0XHRcdFx0XHR2YXIgZXJyeiA9IC1hYnNfeSAvIDI7XG5cdFx0XHRcdFx0XHR2YXIgaW5jeSA9IGRlbF95IDwgMCA/IC0xIDogMTtcblx0XHRcdFx0XHRcdHZhciBpbmN4ID0gZGVsX3ggPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0dmFyIGluY3ogPSBkZWxfeiA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdHZhciB4ID0gdjF4O1xuXHRcdFx0XHRcdFx0XHR2YXIgeiA9IHYxejtcblx0XHRcdFx0XHRcdFx0Zm9yKCB2YXIgeSA9IHYxeSArIGluY3k7IHkgIT0gdjJ5OyB5ICs9IGluY3kgKVxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyeCArPSBhYnNfeDtcblx0XHRcdFx0XHRcdFx0XHRpZiggZXJyeCA+IDAgKVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGVycnggLT0gYWJzX3k7XG5cdFx0XHRcdFx0XHRcdFx0XHR4ICs9IGluY3g7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGVycnogKz0gYWJzX3o7XG5cdFx0XHRcdFx0XHRcdFx0aWYoIGVycnogPiAwIClcblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJ6IC09IGFic195O1xuXHRcdFx0XHRcdFx0XHRcdFx0eiArPSBpbmN6O1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRsZXQgdiA9IGNsdXN0ZXIuZ2V0Vm94ZWxSZWYoIGZhbHNlLCB4LCB5LCB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2ICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsZXQgdmFsID0gY2FsbGJhY2soIHYgKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIHZhbCAhPT0gdiApIHYuZGVsZXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoICFub3RfemVybyAmJiB2YWwgKSB8fCAoIG5vdF96ZXJvICYmICF2YWwgKSApXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbDtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Ly8geiBpcyBjb25zdGFudFxuXHRcdFx0XHRcdGlmKCBhYnNfeCA+IGFic195IClcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHQvLyB4IGlzIGxvbmdlc3Rcblx0XHRcdFx0XHRcdHZhciBlcnJ5ID0gLWFic194IC8gMjtcblx0XHRcdFx0XHRcdHZhciBpbmN5ID0gZGVsX3kgPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0dmFyIGluY3ggPSBkZWxfeCA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdHZhciB5ID0gdjF5O1xuXHRcdFx0XHRcdFx0XHR2YXIgeiA9IHYxejtcblx0XHRcdFx0XHRcdFx0Zm9yKCB2YXIgeCA9IHYxeCArIGluY3g7IHggIT0gdjJ4OyB4ICs9IGluY3ggKVxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyeSArPSBhYnNfeTtcblx0XHRcdFx0XHRcdFx0XHRpZiggZXJyeSA+IDAgKVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGVycnkgLT0gYWJzX3g7XG5cdFx0XHRcdFx0XHRcdFx0XHR5ICs9IGluY3k7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGxldCB2ID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggZmFsc2UsIHgsIHksIHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoIHYgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxldCB2YWwgPSBjYWxsYmFjayggdiApO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggdmFsICE9PSB2ICkgdi5kZWxldGUoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoICggIW5vdF96ZXJvICYmIHZhbCApIHx8ICggbm90X3plcm8gJiYgIXZhbCApIClcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0Ly8geSBpcyBsb25nZXN0LlxuXHRcdFx0XHRcdFx0dmFyIGVycnggPSAtYWJzX3kgLyAyO1xuXHRcdFx0XHRcdFx0dmFyIGluY3kgPSBkZWxfeSA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0XHR2YXIgaW5jeCA9IGRlbF94IDwgMCA/IC0xIDogMTtcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0dmFyIHggPSB2MXg7XG5cdFx0XHRcdFx0XHRcdHZhciB6ID0gdjF6O1xuXHRcdFx0XHRcdFx0XHRmb3IoIHZhciB5ID0gdjF5ICsgaW5jeTsgeSAhPSB2Mnk7IHkgKz0gaW5jeSApXG5cdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRlcnJ4ICs9IGFic194O1xuXHRcdFx0XHRcdFx0XHRcdGlmKCBlcnJ4ID4gMCApXG5cdFx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdFx0ZXJyeCAtPSBhYnNfeTtcblx0XHRcdFx0XHRcdFx0XHRcdHggKz0gaW5jeDtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdFx0bGV0IHYgPSBjbHVzdGVyLmdldFZveGVsUmVmKCBmYWxzZSwgeCwgeSwgeiApO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiggdiApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bGV0IHZhbCA9IGNhbGxiYWNrKCB2ICk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2YWwgIT09IHYgKSB2LmRlbGV0ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggKCAhbm90X3plcm8gJiYgdmFsICkgfHwgKCBub3RfemVybyAmJiAhdmFsICkgKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiB2YWw7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdGlmKCBkZWxfeiAhPSAwIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGlmKCBhYnNfeCA+IGFic196IClcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHQvLyB4IGlzIGxvbmdlc3QuXG5cdFx0XHRcdFx0XHR2YXIgZXJyeiA9IC1hYnNfeCAvIDI7XG5cdFx0XHRcdFx0XHR2YXIgaW5jeCA9IGRlbF94IDwgMCA/IC0xIDogMTtcblx0XHRcdFx0XHRcdHZhciBpbmN6ID0gZGVsX3ogPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHR2YXIgeSA9IHYxeTtcblx0XHRcdFx0XHRcdFx0dmFyIHogPSB2MXo7XG5cdFx0XHRcdFx0XHRcdGZvciggdmFyIHggPSB2MXggKyBpbmN4OyB4ICE9IHYyeDsgeCArPSBpbmN4IClcblx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdGVycnogKz0gYWJzX3o7XG5cdFx0XHRcdFx0XHRcdFx0aWYoIGVycnogPiAwIClcblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJ6IC09IGFic194O1xuXHRcdFx0XHRcdFx0XHRcdFx0eiArPSBpbmN6O1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRsZXQgdiA9IGNsdXN0ZXIuZ2V0Vm94ZWxSZWYoIGZhbHNlLCB4LCB5LCB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2ICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsZXQgdmFsID0gY2FsbGJhY2soIHYgKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIHZhbCAhPT0gdiApIHYuZGVsZXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoICFub3RfemVybyAmJiB2YWwgKSB8fCAoIG5vdF96ZXJvICYmICF2YWwgKSApXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbDtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdC8vIHogaXMgbG9uZ2VzdCBwYXRoXG5cdFx0XHRcdFx0XHR2YXIgZXJyeCA9IC1hYnNfeiAvIDI7XG5cdFx0XHRcdFx0XHR2YXIgaW5jeCA9IGRlbF94IDwgMCA/IC0xIDogMTtcblx0XHRcdFx0XHRcdHZhciBpbmN6ID0gZGVsX3ogPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHR2YXIgeCA9IHYxeDtcblx0XHRcdFx0XHRcdFx0dmFyIHkgPSB2MXk7XG5cdFx0XHRcdFx0XHRcdGZvciggdmFyIHogPSB2MXogKyBpbmN6OyB6ICE9IHYyejsgeiArPSBpbmN6IClcblx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdGVycnggKz0gYWJzX3g7XG5cdFx0XHRcdFx0XHRcdFx0aWYoIGVycnggPiAwIClcblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJ4IC09IGFic196O1xuXHRcdFx0XHRcdFx0XHRcdFx0eCArPSBpbmN4O1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0XHRsZXQgdiA9IGNsdXN0ZXIuZ2V0Vm94ZWxSZWYoIGZhbHNlLCB4LCB5LCB6ICk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmKCB2ICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsZXQgdmFsID0gY2FsbGJhY2soIHYgKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoIHZhbCAhPT0gdiApIHYuZGVsZXRlKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKCAoICFub3RfemVybyAmJiB2YWwgKSB8fCAoIG5vdF96ZXJvICYmICF2YWwgKSApXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbDtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Ly8geCBpcyBvbmx5IGNoYW5naW5nLlxuXHRcdFx0XHRcdHZhciBpbmN4ID0gZGVsX3ggPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdGZvciggdmFyIHggPSB2MXggKyBpbmN4OyB4ICE9IHYyeDsgeCArPSBpbmN4IClcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRsZXQgdiA9IGNsdXN0ZXIuZ2V0Vm94ZWxSZWYoIGZhbHNlLCB4LCB5LCB6ICk7XHJcblx0XHRcdFx0XHRcdGlmKCB2ICkge1xuXHRcdFx0XHRcdFx0XHRsZXQgdmFsID0gY2FsbGJhY2soIHYgKTtcblx0XHRcdFx0XHRcdFx0aWYoIHZhbCAhPT0gdiApIHYuZGVsZXRlKCk7XG5cdFx0XHRcdFx0XHRcdGlmKCAoICFub3RfemVybyAmJiB2YWwgKSB8fCAoIG5vdF96ZXJvICYmICF2YWwgKSApXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdGlmKCBkZWxfeSAhPSAwIClcblx0XHRcdHtcblx0XHRcdFx0aWYoIGRlbF96ICE9IDAgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0aWYoIGFic195ID4gYWJzX3ogKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdC8vIHkgaXMgbG9uZ2VzdC5cblx0XHRcdFx0XHRcdHZhciBlcnJ6ID0gLWFic195IC8gMjtcblx0XHRcdFx0XHRcdHZhciBpbmN5ID0gZGVsX3kgPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0dmFyIGluY3ogPSBkZWxfeiA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdHZhciB4ID0gdjF4O1xuXHRcdFx0XHRcdFx0XHR2YXIgeiA9IHYxejtcblx0XHRcdFx0XHRcdFx0Zm9yKCB2YXIgeSA9IHYxeSArIGluY3k7IHkgIT0gdjJ5OyB5ICs9IGluY3kgKVxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyeiArPSBhYnNfejtcblx0XHRcdFx0XHRcdFx0XHRpZiggZXJyeiA+IDAgKVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGVycnogLT0gYWJzX3k7XG5cdFx0XHRcdFx0XHRcdFx0XHR6ICs9IGluY3o7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGxldCB2ID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggZmFsc2UsIHgsIHksIHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoIHYgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxldCB2YWwgPSBjYWxsYmFjayggdiApO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggdmFsICE9PSB2ICkgdi5kZWxldGUoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoICggIW5vdF96ZXJvICYmIHZhbCApIHx8ICggbm90X3plcm8gJiYgIXZhbCApIClcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0Ly8geiBpcyBsb25nZXN0IHBhdGhcblx0XHRcdFx0XHRcdHZhciBlcnJ5ID0gLWFic196IC8gMjtcblx0XHRcdFx0XHRcdHZhciBpbmN5ID0gZGVsX3kgPCAwID8gLTEgOiAxO1xuXHRcdFx0XHRcdFx0dmFyIGluY3ogPSBkZWxfeiA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdHZhciB4ID0gdjF4O1xuXHRcdFx0XHRcdFx0XHR2YXIgeSA9IHYxeTtcblx0XHRcdFx0XHRcdFx0Zm9yKCB2YXIgeiA9IHYxeiArIGluY3o7IHogIT0gdjJ6OyB6ICs9IGluY3ogKVxuXHRcdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyeSArPSBhYnNfeTtcblx0XHRcdFx0XHRcdFx0XHRpZiggZXJyeSA+IDAgKVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGVycnkgLT0gYWJzX3o7XG5cdFx0XHRcdFx0XHRcdFx0XHR5ICs9IGluY3k7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHRcdGxldCB2ID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggZmFsc2UsIHgsIHksIHogKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYoIHYgKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxldCB2YWwgPSBjYWxsYmFjayggdiApO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiggdmFsICE9PSB2ICkgdi5kZWxldGUoKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYoICggIW5vdF96ZXJvICYmIHZhbCApIHx8ICggbm90X3plcm8gJiYgIXZhbCApIClcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHQvLyBubyBkZWxfeCwgbm8gZGVsX3pcblx0XHRcdFx0XHQvLyB5IGlzIG9ubHkgY2hhbmdpbmcuXG5cdFx0XHRcdFx0dmFyIGluY3kgPSBkZWxfeSA8IDAgPyAtMSA6IDE7XG5cdFx0XHRcdFx0Zm9yKCB2YXIgeSA9IHYxeSArIGluY3k7IHkgIT0gdjJ5OyB5ICs9IGluY3kgKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGxldCB2ID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggZmFsc2UsIHgsIHksIHogKTtcclxuXHRcdFx0XHRcdFx0aWYoIHYgKSB7XG5cdFx0XHRcdFx0XHRcdGxldCB2YWwgPSBjYWxsYmFjayggdiApO1xuXHRcdFx0XHRcdFx0XHRpZiggdmFsICE9PSB2ICkgdi5kZWxldGUoKTtcblx0XHRcdFx0XHRcdFx0aWYoICggIW5vdF96ZXJvICYmIHZhbCApIHx8ICggbm90X3plcm8gJiYgIXZhbCApIClcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHQvLyBubyBkZWxfeCwgbm8gZGVsX3kuLi5cblx0XHRcdFx0aWYoIGRlbF96ICE9IDAgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0aWYoIGRlbF96ID4gMCApXG5cdFx0XHRcdFx0XHRmb3IoIHZhciB6ID0gdjF6ICsgMTsgeiA8IHYyejsgeisrIClcblx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0bGV0IHYgPSBjbHVzdGVyLmdldFZveGVsUmVmKCBmYWxzZSwgeCwgeSwgeiApO1xyXG5cdFx0XHRcdFx0XHRcdGlmKCB2ICkge1xuXHRcdFx0XHRcdFx0XHRcdGxldCB2YWwgPSBjYWxsYmFjayggdiApO1xuXHRcdFx0XHRcdFx0XHRcdGlmKCB2YWwgIT09IHYgKSB2LmRlbGV0ZSgpO1xuXHRcdFx0XHRcdFx0XHRcdGlmKCAoICFub3RfemVybyAmJiB2YWwgKSB8fCAoIG5vdF96ZXJvICYmICF2YWwgKSApXG5cdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmFsO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0Zm9yKCB2YXIgeiA9IHYyeiArIDE7IHogPCB2MXo7IHorKyApXG5cdFx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRcdGxldCB2ID0gY2x1c3Rlci5nZXRWb3hlbFJlZiggZmFsc2UsIHgsIHksIHogKTtcclxuXHRcdFx0XHRcdFx0XHRpZiggdiApIHtcblx0XHRcdFx0XHRcdFx0XHRsZXQgdmFsID0gY2FsbGJhY2soIHYgKTtcblx0XHRcdFx0XHRcdFx0XHRpZiggdmFsICE9PSB2ICkgdi5kZWxldGUoKTtcblx0XHRcdFx0XHRcdFx0XHRpZiggKCAhbm90X3plcm8gJiYgdmFsICkgfHwgKCBub3RfemVybyAmJiAhdmFsICkgKVxuXHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZhbDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0Ly8gbm8gZGVsdGEgZGlmZiwgbm90aGluZyB0byBkby5cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gbm90X3plcm8gPyAxIDogMDtcblx0fVxuXG5cdGZ1bmN0aW9uIEdldFZveGVsUmVmcyggbmVhck9ubHkgKVxuXHR7XG5cdFx0dmFyIHJlc3VsdCA9IHtcblx0XHRcdFJlc3VsdFNlY3RvcnMgOiBuZXcgQXJyYXkobmVhck9ubHkgPyA3IDogMTkpLFxuXHRcdFx0UmVzdWx0T2Zmc2V0cyA6IG5ldyBBcnJheShuZWFyT25seSA/IDcgOiAxOSlcblx0XHR9XG5cdFx0R2V0Vm94ZWxSZWZzKCBSZXN1bHRTZWN0b3JzLCBSZXN1bHRPZmZzZXRzLCBuZWFyT25seSApO1xuXHR9XG5cblx0ZnVuY3Rpb24gR2V0Vm94ZWxSZWYoIGRpcmVjdGlvbiApXG5cdHtcblx0XHR0aGF0ID0gdGhpcy5jbG9uZSgpO1xuXHRcdHN3aXRjaCggZGlyZWN0aW9uIClcblx0XHR7XG5cdFx0ZGVmYXVsdDpcblx0XHRcdHRocm93IG5ldyBFcnJvciggXCJDcmVhdGluZyB2b3hlbCByZWYgXCIgKyBkaXJlY3Rpb24gKyBcIiBpcyBub3QgaW1wbGVtZW50ZWQgXCIgKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUOlxuXHRcdFx0dGhhdC53eC0tO1xuXHRcdFx0aWYoIHRoYXQueCA+IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LngtLTtcblx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gdGhhdC5zZWN0b3IuU2l6ZV95O1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tkaXJlY3Rpb24gLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGhhdC54ID0gKGJ5dGUpKCB0aGF0LnNlY3Rvci5TaXplX3ggLSAxICk7XG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgKz0gdGhhdC5zZWN0b3IuU2l6ZV95ICogKCB0aGF0LnNlY3Rvci5TaXplX3ggLSAyICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVDpcblx0XHRcdHRoYXQud3grKztcblx0XHRcdGlmKCB0aGF0LnggPCAodGhhdC5zZWN0b3IuU2l6ZV94LTEgKSApXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQueCsrO1xuXHRcdFx0XHR0aGF0Lk9mZnNldCArPSB0aGF0LnNlY3Rvci5TaXplX3k7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW2RpcmVjdGlvbiAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGF0LnggPSAwO1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0IC09IHRoYXQuc2VjdG9yLlNpemVfeSAqICggdGhhdC5zZWN0b3IuU2l6ZV94IC0gMiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EOlxuXHRcdFx0dGhhdC53ei0tO1xuXHRcdFx0aWYoIHRoYXQueiA+IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnotLTtcblx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gdGhhdC5zZWN0b3IuU2l6ZV95KnRoYXQuc2VjdG9yLlNpemVfeDtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbZGlyZWN0aW9uIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQueiA9IChieXRlKSggdGhhdC5zZWN0b3IuU2l6ZV96IC0gMSApO1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0ICs9ICggdGhhdC5zZWN0b3IuU2l6ZV94ICogdGhhdC5zZWN0b3IuU2l6ZV95ICogKCB0aGF0LnNlY3Rvci5TaXplX3ogLSAyICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEOlxuXHRcdFx0dGhhdC53eisrO1xuXHRcdFx0aWYoIHRoYXQueiA8ICggdGhhdC5zZWN0b3IuU2l6ZV96IC0gMSApIClcblx0XHRcdHtcblx0XHRcdFx0dGhhdC56Kys7XG5cdFx0XHRcdHRoYXQuT2Zmc2V0ICs9IHRoYXQuc2VjdG9yLlNpemVfeSp0aGF0LnNlY3Rvci5TaXplX3g7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW2RpcmVjdGlvbiAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGF0LnogPSAwO1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0IC09ICggdGhhdC5zZWN0b3IuU2l6ZV94ICogdGhhdC5zZWN0b3IuU2l6ZV95ICogKCB0aGF0LnNlY3Rvci5TaXplX3ogLSAyICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XOlxuXHRcdFx0dGhhdC53eS0tO1xuXHRcdFx0aWYoIHRoYXQueSA+IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnktLTtcblx0XHRcdFx0dGhhdC5PZmZzZXQtLTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbZGlyZWN0aW9uIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQueSA9IChieXRlKSggdGhhdC5zZWN0b3IuU2l6ZV95IC0gMSApO1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0ICs9ICggdGhhdC5zZWN0b3IuU2l6ZV95IC0gMiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkU6XG5cdFx0XHR0aGF0Lnd5Kys7XG5cdFx0XHRpZiggdGhhdC55IDwgKCB0aGF0LnNlY3Rvci5TaXplX3kgLSAxICkgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnkrKztcblx0XHRcdFx0dGhhdC5PZmZzZXQrKztcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbZGlyZWN0aW9uIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQueSA9IDA7XG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gKCB0aGF0LnNlY3Rvci5TaXplX3kgLSAyICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gdGhhdC5zZWN0b3IuZGF0YS5kYXRhW3RoYXQub2Zmc2V0XTtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSB0aGF0LnNlY3Rvci5kYXRhLm90aGVySW5mb3NbdGhhdC5vZmZzZXRdO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gbnVsbDtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhhdDtcblx0fVxuXG5cdGZ1bmN0aW9uIEdldE5lYXJWb3hlbFJlZiggZGlyZWN0aW9uIClcblx0e1xuXHRcdHZhciB0aGF0ID0gR2V0TmVhclZveGVsUmVmKCApXG5cdFx0dmFyIGNsdXN0ZXIgPSB0aGlzLnNlY3Rvci5jbHVzdGVyO1xuXHRcdHRoYXQuc2VjdG9yID0gdGhpcy5zZWN0b3I7XG5cdFx0dGhhdC5PZmZzZXQgPSB0aGlzLk9mZnNldDtcblx0XHRzd2l0Y2goIGRpcmVjdGlvbiApXG5cdFx0e1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHR0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFeGNlcHRpb24oIFwiQ3JlYXRpbmcgdm94ZWwgcmVmIFwiICsgZGlyZWN0aW9uICsgXCIgaXMgbm90IGltcGxlbWVudGVkIFwiICk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVDpcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19YIDw8IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZICkgKSAhPSAwIClcblx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gdGhhdC5zZWN0b3IuU2l6ZV95O1xuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tkaXJlY3Rpb24gLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0ICs9IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ggLSAyICk7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQ6XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWCA8PCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgIT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWCA8PCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0ICs9IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1k7XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW2RpcmVjdGlvbiAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAtIDIgKTtcblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkQ6XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWiA8PCAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICkgIT0gMCApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0IC09IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YO1xuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tkaXJlY3Rpb24gLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0ICs9ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAyICkgKTtcblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRDpcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19aIDw8ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1ggKyBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgKSAhPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NNQVNLX1ogPDwgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWCArIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZICkgKSApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0ICs9IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YO1xuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tkaXJlY3Rpb24gLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0IC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAyICkgKTtcblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVzpcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19ZICkgKSAhPSAwIClcblx0XHRcdFx0dGhhdC5PZmZzZXQtLTtcblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbZGlyZWN0aW9uIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0XHR0aGF0Lk9mZnNldCArPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgLSAyICk7XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkU6XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApICkgIT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0Kys7XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW2RpcmVjdGlvbiAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZIC0gMiApO1xuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBzZWxmLlZveGVsVHlwZU1hbmFnZXIuVm94ZWxUYWJsZVt0aGF0LnNlY3Rvci5EYXRhLkRhdGFbdGhhdC5PZmZzZXRdXTtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSB0aGF0LnNlY3Rvci5EYXRhLk90aGVySW5mb3NbdGhhdC5PZmZzZXRdO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gbnVsbDtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cblx0ZnVuY3Rpb24gR2V0TmVhckxlZnRWb3hlbFJlZiggdGhhdCwgc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWCA8PCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgIT0gMCApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0IC09IHRoYXQuc2VjdG9yLlNpemVfeTtcblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0XHR0aGF0Lk9mZnNldCArPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YIC0gMiApO1xuXHRcdFx0fVxuXHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBzZWxmLlZveGVsVHlwZU1hbmFnZXIuVm94ZWxUYWJsZVt0aGF0LnNlY3Rvci5EYXRhLkRhdGFbdGhhdC5PZmZzZXRdXTtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSB0aGF0LnNlY3Rvci5EYXRhLk90aGVySW5mb3NbdGhhdC5PZmZzZXRdO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gbnVsbDtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIEdldE5lYXJSaWdodFZveGVsUmVmKCB0aGF0LCBzZWxmIClcblx0e1xuXHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3I7XG5cdFx0dGhhdC5PZmZzZXQgPSBzZWxmLk9mZnNldDtcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19YIDw8IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZICkgKSAhPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19YIDw8IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZIClcblx0XHRcdFx0dGhhdC5PZmZzZXQgKz0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWTtcblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAtIDIgKTtcblx0XHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gc2VsZi5Wb3hlbFR5cGVNYW5hZ2VyLlZveGVsVGFibGVbdGhhdC5zZWN0b3IuRGF0YS5EYXRhW3RoYXQuT2Zmc2V0XV07XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gdGhhdC5zZWN0b3IuRGF0YS5PdGhlckluZm9zW3RoYXQuT2Zmc2V0XTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRoYXQuVHlwZSA9IG51bGw7XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBHZXROZWFyQWhlYWRWb3hlbFJlZiggdGhhdCwgc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWiA8PCAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICkgIT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19aIDw8ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1ggKyBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgKVxuXHRcdFx0XHR0aGF0Lk9mZnNldCArPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWDtcblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiAtIDIgKSApO1xuXHRcdFx0fVxuXHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBzZWxmLlZveGVsVHlwZU1hbmFnZXIuVm94ZWxUYWJsZVt0aGF0LnNlY3Rvci5EYXRhLkRhdGFbdGhhdC5PZmZzZXRdXTtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSB0aGF0LnNlY3Rvci5EYXRhLk90aGVySW5mb3NbdGhhdC5PZmZzZXRdO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gbnVsbDtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIEdldE5lYXJCZWhpbmRWb3hlbFJlZiggdGhhdCwgc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWiA8PCAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICkgIT0gMCApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0IC09IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YO1xuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgKz0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiAtIDIgKSApO1xuXHRcdFx0fVxuXHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBzZWxmLlZveGVsVHlwZU1hbmFnZXIuVm94ZWxUYWJsZVt0aGF0LnNlY3Rvci5EYXRhLkRhdGFbdGhhdC5PZmZzZXRdXTtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSB0aGF0LnNlY3Rvci5EYXRhLk90aGVySW5mb3NbdGhhdC5PZmZzZXRdO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gbnVsbDtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIEdldE5lYXJBYm92ZVZveGVsUmVmKCB0aGF0LCAgc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApICkgIT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0Kys7XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0IC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAtIDIgKTtcblx0XHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gc2VsZi5Wb3hlbFR5cGVNYW5hZ2VyLlZveGVsVGFibGVbdGhhdC5zZWN0b3IuRGF0YS5EYXRhW3RoYXQuT2Zmc2V0XV07XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gdGhhdC5zZWN0b3IuRGF0YS5PdGhlckluZm9zW3RoYXQuT2Zmc2V0XTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRoYXQuVHlwZSA9IG51bGw7XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBHZXROZWFyQmVsb3dWb3hlbFJlZiggdGhhdCwgc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApICkgIT0gMCApXG5cdFx0XHRcdHRoYXQuT2Zmc2V0LS07XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1cgLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0ICs9ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAtIDIgKTtcblx0XHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gc2VsZi5Wb3hlbFR5cGVNYW5hZ2VyLlZveGVsVGFibGVbdGhhdC5zZWN0b3IuRGF0YS5EYXRhW3RoYXQuT2Zmc2V0XV07XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gdGhhdC5zZWN0b3IuRGF0YS5PdGhlckluZm9zW3RoYXQuT2Zmc2V0XTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRoYXQuVHlwZSA9IG51bGw7XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gbnVsbDtcblx0XHR9XG5cdH1cblxuXG5cblx0ZnVuY3Rpb24gR2V0TmVhclZveGVsUmVmKCB0aGF0LCAgc2VsZiwgZGlyZWN0aW9uIClcblx0e1xuXHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3I7XG5cdFx0dGhhdC5PZmZzZXQgPSBzZWxmLk9mZnNldDtcblx0XHRzd2l0Y2goIGRpcmVjdGlvbiApXG5cdFx0e1xuXHRcdGRlZmF1bHQ6XG5cdFx0XHR0aHJvdyBuZXcgTm90SW1wbGVtZW50ZWRFeGNlcHRpb24oIFwiQ3JlYXRpbmcgdm94ZWwgcmVmIFwiICsgZGlyZWN0aW9uICsgXCIgaXMgbm90IGltcGxlbWVudGVkIFwiICk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVDpcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19YIDw8IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZICkgKSAhPSAwIClcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbZGlyZWN0aW9uIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0ICs9IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ggLSAyICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVDpcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19YIDw8IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZICkgKSAhPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19YIDw8IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZIClcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5PZmZzZXQgKz0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbZGlyZWN0aW9uIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0IC09IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ggLSAyICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkQ6XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWiA8PCAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICkgIT0gMCApXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuT2Zmc2V0IC09IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tkaXJlY3Rpb24gLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgKz0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiAtIDIgKSApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQ6XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWiA8PCAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICkgIT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19aIDw8ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1ggKyBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0Lk9mZnNldCArPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWDtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbZGlyZWN0aW9uIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0IC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAyICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XOlxuXHRcdFx0aWYoICggdGhhdC5PZmZzZXQgJiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NNQVNLX1kgKSApICE9IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0Lk9mZnNldC0tO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tkaXJlY3Rpb24gLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgKz0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZIC0gMiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkU6XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApICkgIT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuT2Zmc2V0Kys7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW2RpcmVjdGlvbiAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGF0Lk9mZnNldCAtPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgLSAyICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gc2VsZi5zZWN0b3IuVm94ZWxUeXBlTWFuYWdlci5Wb3hlbFRhYmxlW3RoYXQuc2VjdG9yLkRhdGEuRGF0YVt0aGF0Lk9mZnNldF1dO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IHRoYXQuc2VjdG9yLkRhdGEuT3RoZXJJbmZvc1t0aGF0Lk9mZnNldF07XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBudWxsO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IG51bGw7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gR2V0TmVhckxlZnRWb3hlbFJlZiggdGhhdCwgc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWCA8PCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgIT0gMCApXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuT2Zmc2V0IC09IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1k7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGF0Lk9mZnNldCArPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YIC0gMiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdHtcblx0XHRcdHRoYXQuVHlwZSA9IHNlbGYuc2VjdG9yLlZveGVsVHlwZU1hbmFnZXIuVm94ZWxUYWJsZVt0aGF0LnNlY3Rvci5EYXRhLkRhdGFbdGhhdC5PZmZzZXRdXTtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSB0aGF0LnNlY3Rvci5EYXRhLk90aGVySW5mb3NbdGhhdC5PZmZzZXRdO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gbnVsbDtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIEdldE5lYXJSaWdodFZveGVsUmVmKCB0aGF0LHNlbGYgKVxuXHR7XG5cdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvcjtcblx0XHR0aGF0Lk9mZnNldCA9IHNlbGYuT2Zmc2V0O1xuXHRcdFx0aWYoICggdGhhdC5PZmZzZXQgJiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NNQVNLX1ggPDwgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICE9IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NNQVNLX1ggPDwgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0Lk9mZnNldCArPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0IC09IFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ggLSAyICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gc2VsZi5zZWN0b3IuVm94ZWxUeXBlTWFuYWdlci5Wb3hlbFRhYmxlW3RoYXQuc2VjdG9yLkRhdGEuRGF0YVt0aGF0Lk9mZnNldF1dO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IHRoYXQuc2VjdG9yLkRhdGEuT3RoZXJJbmZvc1t0aGF0Lk9mZnNldF07XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBudWxsO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IG51bGw7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gR2V0TmVhckFoZWFkVm94ZWxSZWYoIHRoYXQsc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWiA8PCAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9YICsgVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApICkgIT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19aIDw8ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1ggKyBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgKVxuXHRcdFx0e1xuXHRcdFx0XHR0aGF0Lk9mZnNldCArPSBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWDtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGF0Lk9mZnNldCAtPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ggKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMiApICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gc2VsZi5zZWN0b3IuVm94ZWxUeXBlTWFuYWdlci5Wb3hlbFRhYmxlW3RoYXQuc2VjdG9yLkRhdGEuRGF0YVt0aGF0Lk9mZnNldF1dO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IHRoYXQuc2VjdG9yLkRhdGEuT3RoZXJJbmZvc1t0aGF0Lk9mZnNldF07XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBudWxsO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IG51bGw7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gR2V0TmVhckJlaGluZFZveGVsUmVmKCB0aGF0LCBzZWxmIClcblx0e1xuXHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3I7XG5cdFx0dGhhdC5PZmZzZXQgPSBzZWxmLk9mZnNldDtcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19aIDw8ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1ggKyBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICkgKSAhPSAwIClcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1g7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV07XG5cdFx0XHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHRoYXQuT2Zmc2V0ICs9ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAyICkgKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdGlmKCB0aGF0LnNlY3RvciAhPSBudWxsIClcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBzZWxmLnNlY3Rvci5Wb3hlbFR5cGVNYW5hZ2VyLlZveGVsVGFibGVbdGhhdC5zZWN0b3IuRGF0YS5EYXRhW3RoYXQuT2Zmc2V0XV07XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gdGhhdC5zZWN0b3IuRGF0YS5PdGhlckluZm9zW3RoYXQuT2Zmc2V0XTtcblx0XHR9XG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHRoYXQuVHlwZSA9IG51bGw7XG5cdFx0XHR0aGF0LlZveGVsRXh0ZW5zaW9uID0gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBHZXROZWFyQWJvdmVWb3hlbFJlZiggdGhhdCwgc2VsZiApXG5cdHtcblx0XHR0aGF0LnNlY3RvciA9IHNlbGYuc2VjdG9yO1xuXHRcdHRoYXQuT2Zmc2V0ID0gc2VsZi5PZmZzZXQ7XG5cdFx0XHRpZiggKCB0aGF0Lk9mZnNldCAmICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApICkgIT0gVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ01BU0tfWSApXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuT2Zmc2V0Kys7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXTtcblx0XHRcdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dGhhdC5PZmZzZXQgLT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZIC0gMiApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0aWYoIHRoYXQuc2VjdG9yICE9IG51bGwgKVxuXHRcdHtcblx0XHRcdHRoYXQuVHlwZSA9IHNlbGYuc2VjdG9yLlZveGVsVHlwZU1hbmFnZXIuVm94ZWxUYWJsZVt0aGF0LnNlY3Rvci5EYXRhLkRhdGFbdGhhdC5PZmZzZXRdXTtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSB0aGF0LnNlY3Rvci5EYXRhLk90aGVySW5mb3NbdGhhdC5PZmZzZXRdO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gbnVsbDtcblx0XHRcdHRoYXQuVm94ZWxFeHRlbnNpb24gPSBudWxsO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIEdldE5lYXJCZWxvd1ZveGVsUmVmKCB0aGF0LCBzZWxmIClcblx0e1xuXHRcdHRoYXQuc2VjdG9yID0gc2VsZi5zZWN0b3I7XG5cdFx0dGhhdC5PZmZzZXQgPSBzZWxmLk9mZnNldDtcblx0XHRcdGlmKCAoIHRoYXQuT2Zmc2V0ICYgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DTUFTS19ZICkgKSAhPSAwIClcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5PZmZzZXQtLTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0dGhhdC5zZWN0b3IgPSBzZWxmLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdO1xuXHRcdFx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0aGF0Lk9mZnNldCArPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgLSAyICk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRpZiggdGhhdC5zZWN0b3IgIT0gbnVsbCApXG5cdFx0e1xuXHRcdFx0dGhhdC5UeXBlID0gc2VsZi5zZWN0b3IuVm94ZWxUeXBlTWFuYWdlci5Wb3hlbFRhYmxlW3RoYXQuc2VjdG9yLkRhdGEuRGF0YVt0aGF0Lk9mZnNldF1dO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IHRoYXQuc2VjdG9yLkRhdGEuT3RoZXJJbmZvc1t0aGF0Lk9mZnNldF07XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR0aGF0LlR5cGUgPSBudWxsO1xuXHRcdFx0dGhhdC5Wb3hlbEV4dGVuc2lvbiA9IG51bGw7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gR2V0Vm94ZWxSZWZzKCBuZWFyT25seSApXG5cdHtcblx0XHRpZiggbmVhck9ubHkgKVxuXHRcdHtcblx0XHRcdHZhciByZXN1bHQgPSBuZXcgYXJyYXkoNyk7XG5cdFx0XHQvL3Jlc3VsdFswXSA9IHRoaXM7XG5cdFx0XHRHZXROZWFyVm94ZWxSZWYoICByZXN1bHRbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSAgICwgdGhpcywgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUICk7XG5cdFx0XHRHZXROZWFyVm94ZWxSZWYoICByZXN1bHRbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0gICwgdGhpcywgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCApO1xuXHRcdFx0R2V0TmVhclZveGVsUmVmKCAgcmVzdWx0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdICAsIHRoaXMsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQgKTtcblx0XHRcdEdldE5lYXJWb3hlbFJlZiggIHJlc3VsdFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0gLCB0aGlzLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCApO1xuXHRcdFx0R2V0TmVhclZveGVsUmVmKCAgcmVzdWx0W1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdICAsIHRoaXMsIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgKTtcblx0XHRcdEdldE5lYXJWb3hlbFJlZiggIHJlc3VsdFtWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXSAgLCB0aGlzLCBWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XICk7XG5cdFx0fVxuXHRcdGVsc2Vcblx0XHR7XG5cdFx0XHR2YXIgcmVzdWx0ID0gbmV3IFZveGVsUmVmWzI3XTtcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3VsdDtcblxuXHR9XG5cblx0ZnVuY3Rpb24gR2V0Vm94ZWxSZWZzKCBSZXN1bHRTZWN0b3JzLCAgUmVzdWx0T2Zmc2V0cywgIG5lYXJPbmx5IClcblx0e1xuXHRcdC8vUmVzdWx0U2VjdG9ycyA9IG5ldyBWb3hlbFNlY3RvcltuZWFyT25seSA/IDcgOiAxOV07XG5cdFx0Ly9SZXN1bHRPZmZzZXRzID0gbmV3IHVpbnRbbmVhck9ubHkgPyA3IDogMTldO1xuXG5cdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLklOQ0VOVEVSXSA9IHRoaXMuc2VjdG9yO1xuXHRcdHZhciBvcmlnaW4gPSB0aGlzLk9mZnNldC5jbG9uc2UoKTsvLyggdGhpcy54IDw8Vm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSArIHRoaXMueSArICggdGhpcy56IDw8IChWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWCArVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NISUZUX1kgKSApO1xuXHRcdHtcblx0XHRcdHZhciBpbnB1dCA9IFZveGVsU2VjdG9yLlJlbGF0aXZlVm94ZWxPZmZzZXRzX1Vud3JhcHBlZDtcblx0XHRcdHZhciBuO1xuXHRcdFx0dmFyIGlkeCA9IDA7XG5cdFx0XHRSZXN1bHRPZmZzZXRzW2lkeF0gPSBvcmlnaW4gKyBpbnB1dFtpZHhdOyBpZHgrKztcblx0XHRcdFJlc3VsdE9mZnNldHNbaWR4XSA9IG9yaWdpbiArIGlucHV0W2lkeF07IGlkeCsrOyAvLzFcblx0XHRcdFJlc3VsdE9mZnNldHNbaWR4XSA9IG9yaWdpbiArIGlucHV0W2lkeF07IGlkeCsrOyAvLzJcblx0XHRcdFJlc3VsdE9mZnNldHNbaWR4XSA9IG9yaWdpbiArIGlucHV0W2lkeF07IGlkeCsrOyAvLzNcblx0XHRcdFJlc3VsdE9mZnNldHNbaWR4XSA9IG9yaWdpbiArIGlucHV0W2lkeF07IGlkeCsrOyAvLzRcblx0XHRcdFJlc3VsdE9mZnNldHNbaWR4XSA9IG9yaWdpbiArIGlucHV0W2lkeF07IGlkeCsrOyAvLzVcblx0XHRcdFJlc3VsdE9mZnNldHNbaWR4XSA9IG9yaWdpbiArIGlucHV0W2lkeF07IGlkeCsrOyAvLzZcblx0XHRcdGlmKCAhbmVhck9ubHkgKSBmb3IoIG4gPSAwOyBuIDwgMjA7IG4rKyApIHsgUmVzdWx0T2Zmc2V0c1tpZHhdID0gb3JpZ2luICsgaW5wdXRbaWR4XTsgaWR4Kys7IH1cblxuXHRcdFx0aWYoIHRoaXMueCA9PSAwIClcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdXG5cdFx0XHRcdFx0XHQ9IHRoaXMuc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXTsgUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0XHRSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxLCAwXV0gKz0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YICkgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZO1xuXHRcdFx0XHRpZiggIW5lYXJPbmx5ICkgZm9yKCBuID0gMTsgbiA8IDk7IG4rKyApIFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDEsIG5dXSArPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ggKSAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1k7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmKCB0aGlzLnggPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YIC0gMSApIClcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0gPSB0aGlzLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXHRcdFx0XHRSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMSwgMF1dIC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCApICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWTtcblx0XHRcdFx0aWYoICFuZWFyT25seSApIGZvciggbiA9IDE7IG4gPCA5OyBuKysgKSBSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMSwgbl1dIC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCApICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWTtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0gPSB0aGlzLnNlY3Rvcjtcblx0XHRcdH1cblx0XHRcdGlmKCB0aGlzLnkgPT0gMCApXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0gPSB0aGlzLnNlY3RvcjsgUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXSA9IHRoaXMuc2VjdG9yLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XIC0gMV07XG5cdFx0XHRcdFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1cgLSAxLCAwXV0gKz0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICk7XG5cdFx0XHRcdGlmKCAhbmVhck9ubHkgKSBmb3IoIG4gPSAxOyBuIDwgOTsgbisrICkgUmVzdWx0T2Zmc2V0c1tWb3hlbFNlY3Rvci5Wb3hlbEZhY2VHcm91cHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDEsIG5dXSArPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKTtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYoIHRoaXMueSA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgLSAxICkgKVxuXHRcdFx0e1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdID0gdGhpcy5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXTsgUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0XHRSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFIC0gMSwgMF1dIC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSApO1xuXHRcdFx0XHRpZiggIW5lYXJPbmx5ICkgZm9yKCBuID0gMTsgbiA8IDk7IG4rKyApIFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxLCBuXV0gLT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0gPSB0aGlzLnNlY3RvcjsgUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiggdGhpcy56ID09IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdID0gdGhpcy5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV07XG5cdFx0XHRcdFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMSwgMF1dICs9ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiApICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1g7XG5cdFx0XHRcdGlmKCAhbmVhck9ubHkgKSBmb3IoIG4gPSAxOyBuIDwgOTsgbisrICkgUmVzdWx0T2Zmc2V0c1tWb3hlbFNlY3Rvci5Wb3hlbEZhY2VHcm91cHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkQgLSAxLCBuXV0gKz0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aICkgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWDtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYoIHRoaXMueiA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAxICkgKVxuXHRcdFx0e1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdID0gdGhpcy5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQgLSAxXTsgUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0gPSB0aGlzLnNlY3Rvcjtcblx0XHRcdFx0UmVzdWx0T2Zmc2V0c1tWb3hlbFNlY3Rvci5Wb3hlbEZhY2VHcm91cHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDEsIDBdXSAtPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogKSAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YO1xuXHRcdFx0XHRpZiggIW5lYXJPbmx5ICkgZm9yKCBuID0gMTsgbiA8IDk7IG4rKyApIFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQgLSAxLCBuXV0gLT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aICkgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWDtcblx0XHRcdH1cblx0XHRcdGVsc2Vcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXSA9IHRoaXMuc2VjdG9yOyBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyB0ZXN0IHRvIG1ha2Ugc3VyZSByZXN1bHRpbmcgb2Zmc2V0cyBhcmUgd2l0aGluIHJhbmdlLlxuXHRcdFx0Ly9mb3IoIG4gPSAwOyBuIDwgMjc7IG4rKyApIGlmKCBSZXN1bHRPZmZzZXRzW25dICYgMHhGRkZGODAwMCApIERlYnVnQnJlYWsoKTtcblx0XHR9XG5cdFx0aWYoIG5lYXJPbmx5IClcblx0XHRcdHJldHVybjtcblxuXHRcdGlmKCB0aGlzLnggPT0gMCApXG5cdFx0e1xuXHRcdFx0aWYoIHRoaXMueSA9PSAwIClcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRpZiggdGhpcy56ID09IDAgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiggdGhpcy55ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAtIDEgKSApXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0aWYoIHRoaXMueiA9PSAwIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRcdFx0e1xuXHRcdFx0XHRcdC8vIGxlZnQgYm91bmQsIHRvcCBib3VuZCwgZnJvbnQgbm9ib3VuZFxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0gPSB0aGlzLnNlY3Rvcjtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSA9IHRoaXMuc2VjdG9yO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGVsc2UgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHR7XG5cdFx0XHRcdC8vIGxlZnQgYm91bmQsIGFib3ZlL2JlbG93IHVuYm91bmRcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdGlmKCB0aGlzLnogPT0gMCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0gIT0gbnVsbCA/IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdIDogbnVsbDtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHQvLyBsZWZ0IGJvdW5kLCB5IHVuYm91bmQgeiB1bmJvdW5kXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0ZWxzZSBpZiggdGhpcy54ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAtIDEgKSApXG5cdFx0e1xuXHRcdFx0aWYoIHRoaXMueSA9PSAwIClcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XIC0gMV07XG5cdFx0XHRcdGlmKCB0aGlzLnogPT0gMCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCAtIDFdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1cgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGVsc2UgaWYoIHRoaXMueSA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgLSAxICkgKVxuXHRcdFx0e1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdID0gdGhpcy5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0aWYoIHRoaXMueiA9PSAwIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYoIHRoaXMueiA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAxICkgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZVxuXHRcdFx0e1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRpZiggdGhpcy56ID09IDAgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYoIHRoaXMueiA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAxICkgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0ZWxzZSAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHtcblx0XHRcdC8vIGxlZnQvcmlnaHQgdW5ib3VuZC4uLiBsZWZ0IGFuZCByaWdodCBzaG91bGQgbmV2ZXIgYmUgdGVybXMgb2YgZXF1YWxpdHlcblx0XHRcdGlmKCB0aGlzLnkgPT0gMCApXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0aWYoIHRoaXMueiA9PSAwIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCAtIDFdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYoIHRoaXMueiA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAxICkgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXTtcblx0XHRcdH1cblx0XHRcdGVsc2UgaWYoIHRoaXMueSA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgLSAxICkgKVxuXHRcdFx0e1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdGlmKCB0aGlzLnogPT0gMCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiggdGhpcy56ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiAtIDEgKSApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHR7XG5cdFx0XHRcdC8vIHggbm90IG9uIGJvdW5kLCB5IG5vdCBvbiBib3VuZC5cblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblxuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8vIHJlc3VsdCBzZXQgaXMgb25seSA5ICgzeDMgZmFjZSlcblx0ZnVuY3Rpb24gR2V0Vm94ZWxSZWZzKCAgUmVzdWx0U2VjdG9ycywgIFJlc3VsdE9mZnNldHMsIGZhY2VPbmx5IClcblx0e1xuXHRcdHZhciByZXN1bHQgPSB7XG5cdFx0XHRSZXN1bHRTZWN0b3JzIDogbmV3IEFycmF5KDI3KSxcblx0XHRcdFJlc3VsdE9mZnNldHMgOiBuZXcgQXJyYXkoMjcpXG5cdFx0fVxuXG5cdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLklOQ0VOVEVSXSA9IHRoaXMuc2VjdG9yO1xuXHRcdHZhciBvcmlnaW4gPSAoIHRoaXMueCA8PCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWSApICsgdGhpcy55ICsgKCB0aGlzLnogPDwgKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0hJRlRfWCArIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSElGVF9ZICkgKTtcblx0XHR7XG5cdFx0XHR2YXIgaW5wdXQgPSBWb3hlbFNlY3Rvci5SZWxhdGl2ZVZveGVsT2Zmc2V0c19VbndyYXBwZWQ7XG5cdFx0XHR2YXIgbjtcblx0XHRcdGZvciggbiA9IDA7IG4gPCA5OyBuKysgKVxuXHRcdFx0XHRSZXN1bHRPZmZzZXRzW25dID0gKHVpbnQpKG9yaWdpbiArIFZveGVsU2VjdG9yLlJlbGF0aXZlVm94ZWxPZmZzZXRzX1Vud3JhcHBlZFtWb3hlbFNlY3Rvci5Wb3hlbEZhY2VHcm91cHNbZmFjZU9ubHksIG5dXSk7XG5cblx0XHRcdHN3aXRjaCggZmFjZU9ubHkgKVxuXHRcdFx0e1xuXHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVDpcblx0XHRcdFx0XHRpZiggdGhpcy54ID09IDAgKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdGZvciggbiA9IDA7IG4gPCA5OyBuKysgKVxuXHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW25dID0gdGhpcy5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdOyBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFx0XHRcdFJlc3VsdE9mZnNldHNbbl0gKz0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YICkgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0gPSB0aGlzLnNlY3Rvcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVDpcblx0XHRcdFx0XHRpZiggdGhpcy54ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCAtIDEgKSApXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXSA9IHRoaXMuc2VjdG9yOyBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdID0gdGhpcy5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblx0XHRcdFx0XHRcdGZvciggbiA9IDA7IG4gPCA5OyBuKysgKSBSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMSwgbl1dIC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWCApICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXSA9IHRoaXMuc2VjdG9yOyBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkU6XG5cdFx0XHRcdFx0aWYoIHRoaXMueSA9PSAwIClcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10gPSB0aGlzLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdO1xuXHRcdFx0XHRcdFx0UmVzdWx0T2Zmc2V0c1tWb3hlbFNlY3Rvci5Wb3hlbEZhY2VHcm91cHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDEsIDBdXSArPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKTtcblx0XHRcdFx0XHRcdGZvciggbiA9IDA7IG4gPCA5OyBuKysgKSBSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XIC0gMSwgbl1dICs9ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSA9IHRoaXMuc2VjdG9yOyBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1c6XG5cdFx0XHRcdFx0aWYoIHRoaXMueSA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgLSAxICkgKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0gPSB0aGlzLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSAtIDFdOyBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFx0XHRSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFIC0gMSwgMF1dIC09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSApO1xuXHRcdFx0XHRcdFx0Zm9yKCBuID0gMDsgbiA8IDk7IG4rKyApIFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxLCBuXV0gLT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10gPSB0aGlzLnNlY3Rvcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkQ6XG5cdFx0XHRcdFx0aWYoIHRoaXMueiA9PSAwIClcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdID0gdGhpcy5zZWN0b3IubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV07XG5cdFx0XHRcdFx0XHRSZXN1bHRPZmZzZXRzW1ZveGVsU2VjdG9yLlZveGVsRmFjZUdyb3Vwc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORCAtIDEsIDBdXSArPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogKSAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YO1xuXHRcdFx0XHRcdFx0Zm9yKCBuID0gMTsgbiA8IDk7IG4rKyApIFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMSwgbl1dICs9ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiApICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1g7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdID0gdGhpcy5zZWN0b3I7IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQ6XG5cdFx0XHRcdFx0aWYoIHRoaXMueiA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAxICkgKVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0gPSB0aGlzLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDFdOyBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0XHRcdFx0UmVzdWx0T2Zmc2V0c1tWb3hlbFNlY3Rvci5Wb3hlbEZhY2VHcm91cHNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRCAtIDEsIDBdXSAtPSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogKSAqIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1kgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YO1xuXHRcdFx0XHRcdFx0Zm9yKCBuID0gMTsgbiA8IDk7IG4rKyApIFJlc3VsdE9mZnNldHNbVm94ZWxTZWN0b3IuVm94ZWxGYWNlR3JvdXBzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQUQgLSAxLCBuXV0gLT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aICkgKiBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9ZICogVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0gPSB0aGlzLnNlY3RvcjsgUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0gPSB0aGlzLnNlY3Rvcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0XHQvLyB0ZXN0IHRvIG1ha2Ugc3VyZSByZXN1bHRpbmcgb2Zmc2V0cyBhcmUgd2l0aGluIHJhbmdlLlxuXHRcdFx0Ly9mb3IoIG4gPSAwOyBuIDwgMjc7IG4rKyApIGlmKCBSZXN1bHRPZmZzZXRzW25dICYgMHhGRkZGODAwMCApIERlYnVnQnJlYWsoKTtcblx0XHR9XG5cblxuXHRcdGlmKCB0aGlzLnggPT0gMCApXG5cdFx0e1xuXHRcdFx0aWYoIHRoaXMueSA9PSAwIClcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRpZiggdGhpcy56ID09IDAgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiggdGhpcy55ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAtIDEgKSApXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0aWYoIHRoaXMueiA9PSAwIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkUgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRcdFx0e1xuXHRcdFx0XHRcdC8vIGxlZnQgYm91bmQsIHRvcCBib3VuZCwgZnJvbnQgbm9ib3VuZFxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0gPSB0aGlzLnNlY3Rvcjtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXSA9IHRoaXMuc2VjdG9yO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGVsc2UgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHR7XG5cdFx0XHRcdC8vIGxlZnQgYm91bmQsIGFib3ZlL2JlbG93IHVuYm91bmRcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXSA9IHRoaXMuc2VjdG9yO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdGlmKCB0aGlzLnogPT0gMCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdC8vIGxlZnQgYm91bmQsIHkgdW5ib3VuZCB6IHVuYm91bmRcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRlbHNlIGlmKCB0aGlzLnggPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9YIC0gMSApIClcblx0XHR7XG5cdFx0XHRpZiggdGhpcy55ID09IDAgKVxuXHRcdFx0e1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1cgLSAxXTtcblx0XHRcdFx0aWYoIHRoaXMueiA9PSAwIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2UgaWYoIHRoaXMueiA9PSAoIFZveGVsU2VjdG9yLlpWT1hFTEJMT0NTSVpFX1ogLSAxICkgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPVyAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiggdGhpcy55ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAtIDEgKSApXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV0gPSB0aGlzLnNlY3Rvci5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRSAtIDFdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddID0gdGhpcy5zZWN0b3I7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRpZiggdGhpcy56ID09IDAgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiggdGhpcy56ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiAtIDEgKSApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVCAtIDFdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRlbHNlXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdGlmKCB0aGlzLnogPT0gMCApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF0ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFQgLSAxXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiggdGhpcy56ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiAtIDEgKSApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV107XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRlbHNlIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0e1xuXHRcdFx0Ly8gbGVmdC9yaWdodCB1bmJvdW5kLi4uIGxlZnQgYW5kIHJpZ2h0IHNob3VsZCBuZXZlciBiZSB0ZXJtcyBvZiBlcXVhbGl0eVxuXHRcdFx0aWYoIHRoaXMueSA9PSAwIClcblx0XHRcdHtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRpZiggdGhpcy56ID09IDAgKVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV10ubmVhcl9zZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EIC0gMV07XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSBpZiggdGhpcy56ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWiAtIDEgKSApXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdH1cblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EXTtcblxuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQkVISU5EXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiggdGhpcy55ID09ICggVm94ZWxTZWN0b3IuWlZPWEVMQkxPQ1NJWkVfWSAtIDEgKSApXG5cdFx0XHR7XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1ddID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0aWYoIHRoaXMueiA9PSAwIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFXS5uZWFyX3NlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkQgLSAxXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV107XG5cblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIGlmKCB0aGlzLnogPT0gKCBWb3hlbFNlY3Rvci5aVk9YRUxCTE9DU0laRV9aIC0gMSApIClcblx0XHRcdFx0e1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdLm5lYXJfc2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEIC0gMV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV07XG5cdFx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVdO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1ddO1xuXHRcdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfTEVGVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX1JJR0hUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUJPVkVfQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0FIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0JFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFTE9XX0JFSElORF07XG5cdFx0XHR9XG5cdFx0XHRlbHNlICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRcdHtcblx0XHRcdFx0Ly8geCBub3Qgb24gYm91bmQsIHkgbm90IG9uIGJvdW5kLlxuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9BQk9WRV0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLlJJR0hUX0FCT1ZFXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV10gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRdO1xuXG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9MRUZUXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF9SSUdIVF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVISU5EX0xFRlRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRfUklHSFRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUxPV19BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQkVMT1dfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0FCT1ZFX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5MRUZUX0JFTE9XX0FIRUFEXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5BSEVBRF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9BSEVBRF0gPSBSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuQUhFQURdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuUklHSFRfQkVMT1dfQUhFQURdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkFIRUFEXTtcblx0XHRcdFx0UmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkxFRlRfQUJPVkVfQkVISU5EXSA9IFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5CRUhJTkRdO1xuXHRcdFx0XHRSZXN1bHRTZWN0b3JzW1ZveGVsYXJpdW0uUmVsYXRpdmVWb3hlbE9yZHMuTEVGVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9BQk9WRV9CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHRcdFJlc3VsdFNlY3RvcnNbVm94ZWxhcml1bS5SZWxhdGl2ZVZveGVsT3Jkcy5SSUdIVF9CRUxPV19CRUhJTkRdID0gUmVzdWx0U2VjdG9yc1tWb3hlbGFyaXVtLlJlbGF0aXZlVm94ZWxPcmRzLkJFSElORF07XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG4iLCJcclxuXHJcblZveGVsYXJpdW0uU29ydGluZ1RyZWUgPSBmdW5jdGlvbihDYXBhY2l0eSl7XHJcbiAgICB2YXIgc29ydGVyID0ge1xyXG5cdFx0Ly8vIDxzdW1tYXJ5PlxyXG5cdFx0Ly8vIHN0b3JhZ2UgdHlwZSBmb3IgU29ydGluZyBUcmVlXHJcblx0XHQvLy8gPC9zdW1tYXJ5PlxyXG5cclxuXHRcdHN0b3JhZ2UgOiBbXSxcclxuXHRcdHJvb3QgOiAtMSxcclxuXHRcdHVzZWQgOiAwLFxyXG4gICAgICAgIGF1dG9CYWxhbmNlIDogZmFsc2UsXHJcbiAgICAgICAgY2xlYXIgOiBmdW5jdGlvbigpIHsgdGhpcy5yb290ID0gLTE7IHRoaXMudXNlZCA9IDA7IH0sXHJcbiAgICAgICAgYWRkIDogQWRkLFxyXG4gICAgICAgIGJhbGFuY2UgOiBCYWxhbmNlLFxyXG4gICAgICAgIGZvckVhY2ggOiBmb3JlYWNoXHJcbiAgICB9O1xyXG5cclxuXHRzdG9yYWdlID0gW107XHJcbiAgICBmb3IoIHZhciBuID0gMDsgbiA8IENhcGFjaXQ7IG4rKyApXHJcbiAgICAgICAgc3RvcmFnZS5wdXNoKCB7IGtleSA6IDAsIHZhbHVlIDogbnVsbCxcclxuICAgICAgICAgICAgICAgICBsZXNzZXIgOiAwLCBncmVhdGVyIDogMCwgcGFyZW50IDogMCwgY2hpbGRyZW4gOiAwXHJcbiAgICAgICAgICAgIH0gKTtcclxuXHJcbiAgICByZXR1cm4gc29ydGVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBEdW1wVHJlZSggY3VycmVudCwgbGV2ZWwgKSB7XHJcblx0aWYoIGN1cnJlbnQgPT0gLTEgKSB7XHJcblx0XHRpZiggcm9vdCA9PSAtMSApXHJcblx0XHRcdHJldHVybjtcclxuXHRcdGNvbnNvbGUubG9nKCBcIlN0YXJ0IFRyZWUgRHVtcFwiICk7XHJcblx0XHREdW1wVHJlZSggcm9vdCwgbGV2ZWwgKyAxICk7XHJcblx0fSBlbHNlIHtcclxuXHRcdGlmKCB0aGlzLnN0b3JhZ2VbY3VycmVudF0ubGVzc2VyICE9IC0xICkge1xyXG5cdFx0XHREdW1wVHJlZSggdGhpcy5zdG9yYWdlW2N1cnJlbnRdLmxlc3NlciwgbGV2ZWwgKyAxICk7XHJcblx0XHR9XHJcblx0XHRjb25zb2xlLmxvZyggXCJDdXI6IFwiICsgY3VycmVudCArIFwiIFBhcjogXCIgKyB0aGlzLnN0b3JhZ2VbY3VycmVudF0ucGFyZW50XHJcblx0XHRcdCsgXCIgTGVzOiBcIiArIHRoaXMuc3RvcmFnZVtjdXJyZW50XS5sZXNzZXJcclxuXHRcdFx0KyBcIiBHcnQ6IFwiICsgdGhpcy5zdG9yYWdlW2N1cnJlbnRdLmdyZWF0ZXJcclxuXHRcdFx0KyBcIiBMZXY6IFwiICsgbGV2ZWwgKyBcIiBjbGQ6IFwiICsgdGhpcy5zdG9yYWdlW2N1cnJlbnRdLmNoaWxkcmVuICsgXCIgIEtleTogXCIgKyB0aGlzLnN0b3JhZ2VbY3VycmVudF0ua2V5ICsgXCIgdmFsOiBcIiArIHRoaXMuc3RvcmFnZVtjdXJyZW50XS52YWx1ZSApO1xyXG5cdFx0aWYoIHRoaXMuc3RvcmFnZVtjdXJyZW50XS5ncmVhdGVyICE9IC0xICkge1xyXG5cdFx0XHREdW1wVHJlZSggdGhpcy5zdG9yYWdlW2N1cnJlbnRdLmdyZWF0ZXIsIGxldmVsICsgMSApO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIFJvdGF0ZUxlZnQoIG5vZGUsIG5vZGVfaWQgKVxyXG57XHJcblx0aWYoIG5vZGUucGFyZW50ID09IC0xIClcclxuXHR7XHJcblx0XHRyb290ID0gbm9kZS5ncmVhdGVyO1xyXG5cdFx0dGhpcy5zdG9yYWdlW3Jvb3RdLnBhcmVudCA9IC0xO1xyXG5cdH1cclxuXHRlbHNlXHJcblx0e1xyXG5cdFx0aWYoIHRoaXMuc3RvcmFnZVtub2RlLnBhcmVudF0ubGVzc2VyID09IG5vZGVfaWQgKVxyXG5cdFx0XHR0aGlzLnN0b3JhZ2Vbbm9kZS5wYXJlbnRdLmxlc3NlciA9IG5vZGUuZ3JlYXRlcjtcclxuXHRcdGVsc2VcclxuXHRcdFx0dGhpcy5zdG9yYWdlW25vZGUucGFyZW50XS5ncmVhdGVyID0gbm9kZS5ncmVhdGVyO1xyXG5cdFx0dGhpcy5zdG9yYWdlW25vZGUuZ3JlYXRlcl0ucGFyZW50ID0gbm9kZS5wYXJlbnQ7XHJcblx0fVxyXG5cdG5vZGUuY2hpbGRyZW4gLT0gKCB0aGlzLnN0b3JhZ2Vbbm9kZS5ncmVhdGVyXS5jaGlsZHJlbiArIDEgKTtcclxuXHRub2RlLnBhcmVudCA9IG5vZGUuZ3JlYXRlcjtcclxuXHR2YXIgdGVtcCA9IHRoaXMuc3RvcmFnZVtub2RlLmdyZWF0ZXJdLmxlc3NlcjtcclxuXHRub2RlLmdyZWF0ZXIgPSB0ZW1wO1xyXG5cdHRoaXMuc3RvcmFnZVtub2RlLnBhcmVudF0ubGVzc2VyID0gbm9kZV9pZDtcclxuXHRpZiggdGVtcCA+PSAwIClcclxuXHR7XHJcblx0XHR0aGlzLnN0b3JhZ2VbdGVtcF0ucGFyZW50ID0gbm9kZV9pZDtcclxuXHRcdHRoaXMuc3RvcmFnZVtub2RlLnBhcmVudF0uY2hpbGRyZW4gLT0gKCB0aGlzLnN0b3JhZ2VbdGVtcF0uY2hpbGRyZW4gKyAxICk7XHJcblx0XHRub2RlLmNoaWxkcmVuICs9ICggdGhpcy5zdG9yYWdlW3RlbXBdLmNoaWxkcmVuICsgMSApO1xyXG5cdH1cclxuXHR0aGlzLnN0b3JhZ2Vbbm9kZS5wYXJlbnRdLmNoaWxkcmVuICs9ICggbm9kZS5jaGlsZHJlbiArIDEgKTtcclxufVxyXG5cclxuZnVuY3Rpb24gUm90YXRlUmlnaHQoIG5vZGUsIG5vZGVfaWQgKVxyXG57XHJcblx0aWYoIG5vZGUucGFyZW50ID09IC0xIClcclxuXHR7XHJcblx0XHRyb290ID0gbm9kZS5sZXNzZXI7XHJcblx0XHR0aGlzLnN0b3JhZ2Vbcm9vdF0ucGFyZW50ID0gLTE7XHJcblx0fVxyXG5cdGVsc2VcclxuXHR7XHJcblx0XHRpZiggdGhpcy5zdG9yYWdlW25vZGUucGFyZW50XS5sZXNzZXIgPT0gbm9kZV9pZCApXHJcblx0XHRcdHRoaXMuc3RvcmFnZVtub2RlLnBhcmVudF0ubGVzc2VyID0gbm9kZS5sZXNzZXI7XHJcblx0XHRlbHNlXHJcblx0XHRcdHRoaXMuc3RvcmFnZVtub2RlLnBhcmVudF0uZ3JlYXRlciA9IG5vZGUubGVzc2VyO1xyXG5cdFx0dGhpcy5zdG9yYWdlW25vZGUubGVzc2VyXS5wYXJlbnQgPSBub2RlLnBhcmVudDtcclxuXHR9XHJcblx0bm9kZS5jaGlsZHJlbiAtPSAoIHRoaXMuc3RvcmFnZVtub2RlLmxlc3Nlcl0uY2hpbGRyZW4gKyAxICk7XHJcblx0bm9kZS5wYXJlbnQgPSBub2RlLmxlc3NlcjtcclxuXHR2YXIgdGVtcCA9IHRoaXMuc3RvcmFnZVtub2RlLmxlc3Nlcl0uZ3JlYXRlcjtcclxuXHRub2RlLmxlc3NlciA9IHRlbXA7XHJcblx0dGhpcy5zdG9yYWdlW25vZGUucGFyZW50XS5ncmVhdGVyID0gbm9kZV9pZDsgIC8vIGFjdHVhbGx5IG9sZG5vZGUubGVzc2VyXHJcblx0aWYoIHRlbXAgPj0gMCApXHJcblx0e1xyXG5cdFx0dGhpcy5zdG9yYWdlW3RlbXBdLnBhcmVudCA9IG5vZGVfaWQ7XHJcblx0XHR0aGlzLnN0b3JhZ2Vbbm9kZS5wYXJlbnRdLmNoaWxkcmVuIC09ICggdGhpcy5zdG9yYWdlW3RlbXBdLmNoaWxkcmVuICsgMSApO1xyXG5cdFx0bm9kZS5jaGlsZHJlbiArPSAoIHRoaXMuc3RvcmFnZVt0ZW1wXS5jaGlsZHJlbiArIDEgKTtcclxuXHR9XHJcblx0dGhpcy5zdG9yYWdlW25vZGUucGFyZW50XS5jaGlsZHJlbiArPSAoIG5vZGUuY2hpbGRyZW4gKyAxICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIEJhbGFuY2UoIG5vZGUsIG5vZGVfaWQgKVxyXG57XHJcblx0aWYoICF0aGlzLkF1dG9CYWxhbmNlICkgcmV0dXJuO1xyXG4gICAgdmFyIGxlZnRfY2hpbGRyZW4gPSBub2RlLmxlc3NlciA9PSAtMSA/IDAgOiAoIHRoaXMuc3RvcmFnZVtub2RlLmxlc3Nlcl0uY2hpbGRyZW4gKyAxICk7XHJcblx0dmFyIHJpZ2h0X2NoaWxkcmVuID0gbm9kZS5ncmVhdGVyID09IC0xID8gMCA6ICggdGhpcy5zdG9yYWdlW25vZGUuZ3JlYXRlcl0uY2hpbGRyZW4gKyAxICk7XHJcblx0aWYoIGxlZnRfY2hpbGRyZW4gPT0gMCApXHJcblx0e1xyXG5cdFx0aWYoIHJpZ2h0X2NoaWxkcmVuID4gMSApXHJcbiAgICAgICAgICAgIFJvdGF0ZUxlZnQoIG5vZGUsIG5vZGVfaWQgKTtcclxuXHR9XHJcblx0ZWxzZSBpZiggcmlnaHRfY2hpbGRyZW4gPT0gMCApXHJcblx0e1xyXG5cdFx0aWYoIGxlZnRfY2hpbGRyZW4gPiAxIClcclxuXHRcdHtcclxuXHRcdFx0Um90YXRlUmlnaHQoIG5vZGUsIG5vZGVfaWQgKTtcclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSBpZiggcmlnaHRfY2hpbGRyZW4gPiAoIGxlZnRfY2hpbGRyZW4gKiAzICkgKVxyXG5cdHtcclxuXHRcdFJvdGF0ZUxlZnQoIG5vZGUsIG5vZGVfaWQgKTtcclxuXHRcdEJhbGFuY2UoIHN0b3JhZ2Vbbm9kZS5sZXNzZXJdLCBub2RlLmxlc3NlciApO1xyXG5cdH1cclxuXHRlbHNlIGlmKCBsZWZ0X2NoaWxkcmVuID4gKCByaWdodF9jaGlsZHJlbiAqIDMgKSApXHJcblx0e1xyXG5cdFx0Um90YXRlUmlnaHQoIG5vZGUsIG5vZGVfaWQgKTtcclxuXHRcdEJhbGFuY2UoIHN0b3JhZ2Vbbm9kZS5ncmVhdGVyXSwgbm9kZS5ncmVhdGVyICk7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBhZGROb2RlKCBub2RlLCAgcGFyZW50X2lkLCBLLCAgViApIHtcclxuXHRub2RlLmtleSA9IEs7XHJcblx0bm9kZS52YWx1ZSA9IFY7XHJcblx0bm9kZS5sZXNzZXIgPSAtMTtcclxuXHRub2RlLmdyZWF0ZXIgPSAtMTtcclxuXHRub2RlLnBhcmVudCA9IHBhcmVudF9pZDtcclxuXHRub2RlLmNoaWxkcmVuID0gMDtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIFNjYW5BZGQoIG5vZGUsIG5vZGVfaWQsIEssIFYgKVxyXG57XHJcblx0aWYoIEsgPCBub2RlLmtleSApXHJcblx0e1xyXG5cdFx0aWYoIG5vZGUubGVzc2VyID09IC0xIClcclxuXHRcdHtcclxuXHRcdFx0bm9kZS5jaGlsZHJlbisrO1xyXG5cdFx0XHR0aGlzLmFkZE5vZGUoIHN0b3JhZ2VbdXNlZF0sIG5vZGVfaWQsIEssIFYgKTtcclxuXHRcdFx0bm9kZS5sZXNzZXIgPSB1c2VkO1xyXG5cdFx0XHR1c2VkKys7XHJcblx0XHR9XHJcblx0XHRlbHNlXHJcblx0XHR7XHJcblx0XHRcdG5vZGUuY2hpbGRyZW4rKztcclxuXHRcdFx0U2NhbkFkZCggc3RvcmFnZVtub2RlLmxlc3Nlcl0sIG5vZGUubGVzc2VyLCBLLCBWICk7XHJcblx0XHRcdEJhbGFuY2UoIG5vZGUsIG5vZGVfaWQgKTtcclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSBpZiggSyA+PSBub2RlLmtleSApXHJcblx0e1xyXG5cdFx0aWYoIG5vZGUuZ3JlYXRlciA9PSAtMSApXHJcblx0XHR7XHJcblx0XHRcdG5vZGUuY2hpbGRyZW4rKztcclxuXHRcdFx0dGhpcy5hZGROb2RlKCBzdG9yYWdlW3VzZWRdLCBub2RlX2lkLCBLLCBWICk7XHJcblx0XHRcdG5vZGUuZ3JlYXRlciA9IHVzZWQ7XHJcblx0XHRcdHVzZWQrKztcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0bm9kZS5jaGlsZHJlbisrO1xyXG5cdFx0XHRTY2FuQWRkKCBzdG9yYWdlW25vZGUuZ3JlYXRlcl0sIG5vZGUuZ3JlYXRlciwgSywgViApO1xyXG5cdFx0XHRCYWxhbmNlKCBub2RlLCBub2RlX2lkICk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBBZGQoIEssIFYgKVxyXG57XHJcblx0aWYoIHJvb3QgPT0gLTEgKVxyXG5cdHtcclxuXHRcdHJvb3QgPSAwO1xyXG5cdFx0dGhpcy5hZGROb2RlKCB0aGlzLnN0b3JhZ2Vbcm9vdF0sIC0xLCBLLCBWICk7XHJcblx0XHR1c2VkKys7XHJcblx0fVxyXG5cdGVsc2VcclxuXHRcdFNjYW5BZGQoIHRoaXMuc3RvcmFnZVtyb290XSwgcm9vdCwgSywgViApO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gZm9yZWFjaCggY2FsbGJhY2sgKSB7XHJcbiAgICB2YXIgY3VycmVudCA9IC0xO1xyXG5cclxuXHR2YXIgbmV4dDtcclxuICAgIHdoaWxlKCB0cnVlICkge1xyXG5cdFx0aWYoIGN1cnJlbnQgPT0gLTEgKVxyXG5cdFx0e1xyXG5cdFx0XHRjdXJyZW50ID0gVHJlZS5yb290O1xyXG5cdFx0XHRpZiggY3VycmVudCA9PSAtMSApXHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR3aGlsZSggKCBuZXh0ID0gVHJlZS5zdG9yYWdlW2N1cnJlbnRdLmxlc3NlciApICE9IC0xIClcclxuXHRcdFx0XHRjdXJyZW50ID0gbmV4dDtcclxuICAgICAgICAgICAgY2FsbGJhY2soIHRoaXMuc3RvcmFnZVtjdXJyZW50XS52YWx1ZSApO1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYoICggbmV4dCA9IFRyZWUuc3RvcmFnZVtjdXJyZW50XS5ncmVhdGVyICkgIT0gLTEgKVxyXG5cdFx0e1xyXG5cdFx0XHRjdXJyZW50ID0gbmV4dDtcclxuXHRcdFx0d2hpbGUoICggbmV4dCA9IFRyZWUuc3RvcmFnZVtjdXJyZW50XS5sZXNzZXIgKSAhPSAtMSApXHJcblx0XHRcdFx0Y3VycmVudCA9IG5leHQ7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKCB0aGlzLnN0b3JhZ2VbY3VycmVudF0udmFsdWUgKTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcblx0XHR9XHJcblxyXG5cdFx0ZWxzZSB3aGlsZSggKCBuZXh0ID0gVHJlZS5zdG9yYWdlW2N1cnJlbnRdLnBhcmVudCApICE9IC0xIClcclxuXHRcdHtcclxuXHRcdFx0Ly8gY2FtZSBmcm9tIGxlc3Nlciwgc28gdGhpcyBpcyBuZXh0IGxhcmdlci5cclxuXHRcdFx0aWYoIFRyZWUuc3RvcmFnZVtuZXh0XS5sZXNzZXIgPT0gY3VycmVudCApXHJcblx0XHRcdHtcclxuXHRcdFx0XHRjdXJyZW50ID0gbmV4dDtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCB0aGlzLnN0b3JhZ2VbY3VycmVudF0udmFsdWUgKTtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRjdXJyZW50ID0gbmV4dDtcclxuXHRcdH1cclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxufVxyXG4iLCJcInVzZSBzdHJpY3RcIjtcclxuXHJcblZveGVsYXJpdW0uVGV4dHVyZUF0bGFzID0ge1xyXG4gICAgdGV4dHVyZSA6IG51bGwsXHJcbiAgICB0ZXh0dXJlX2NvdW50IDogMCxcclxuICAgIHRleHR1cmVfc2l6ZSA6IDAsXHJcbiAgICByZW5kZXJUYXJnZXQgOiBudWxsLFxyXG4gICAgY2FudmFzIDogbnVsbCxcclxuICAgIGNvbnRleHQgOiBudWxsLFxyXG4gICAgdGV4dHVyZSA6IG51bGwsXHJcbiAgICB4X29mcyA6IDAsXHJcbiAgICB5X29mcyA6IDAsXHJcbiAgICBpbml0IDogZnVuY3Rpb24oIGNvdW50LCBzaXplICkge1xyXG4gICAgICAgIHRoaXMudGV4dHVyZV9jb3VudCA9IGNvdW50O1xyXG4gICAgICAgIHRoaXMudGV4dHVyZV9zaXplID0gc2l6ZTtcclxuICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gMjA0ODtcclxuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSAyMDQ4O1xyXG4gICAgXHR0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGU9XCJjbGVhclwiO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5maWxsUmVjdCgwLDAsMjA0OCwyMDQ4KTtcclxuICAgICAgICAvL3RoaXMuY29udGV4dC5jbGVhclJlY3QoMjAsMjAsMTAwLDUwKTtcclxuICAgICAgICB0aGlzLnRleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZSh0aGlzLmNhbnZhcylcclxuICAgICAgICB0aGlzLnRleHR1cmUubWFnRmlsdGVyID0gVEhSRUUuTmVhcmVzdEZpbHRlcjtcclxuICAgICAgICB0aGlzLnRleHR1cmUubWluRmlsdGVyID0gVEhSRUUuTmVhcmVzdEZpbHRlcjtcclxuICAgIFx0Ly90aGlzLnRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG5cclxuICAgIH0sXHJcbiAgICBhZGQgOiBmdW5jdGlvbiggaW1hZ2UgKVxyXG4gICB7XHJcbiAgICAgICB2YXIgY29vcmRzID0ge1xyXG4gICAgICAgICAgIHV2cyA6IG5ldyBBcnJheSg4KSxcclxuICAgICAgICAgICB1dl9hcnJheSA6IG51bGwsXHJcbiAgICAgICAgICAgY29vcmQgOiB7IHBvc2l0aW9uIDogeyB4IDogMCwgeSA6IDAgfSwgc2l6ZSA6IHt4IDogMCx5OjAgfSB9XHJcbiAgICAgICB9XHJcbiAgICAgICBpZiggdGhpcy55X29mcyA+PSAzMiApXHJcbiAgICAgICB7XHJcbiAgICAgICAgICAgZm9yKCAgdmFyIG4gPSAwOyBuIDwgODsgbisrIClcclxuICAgICAgICAgICAgICAgdXZzW25dID0gMDtcclxuICAgICAgICAgICBjb29yZHMuY29vcmQucG9zaXRpb24ueCA9IDA7XHJcbiAgICAgICAgICAgY29vcmRzLmNvb3JkLnBvc2l0aW9uLnkgPSAwO1xyXG4gICAgICAgICAgIGNvb3Jkcy5jb29yZC5zaXplLnggPSAwO1xyXG4gICAgICAgICAgIGNvb3Jkcy5jb29yZC5zaXplLnkgPSAwO1xyXG4gICAgICAgICAgIHJldHVybiBjb29yZHM7XHJcbiAgICAgICB9XHJcbiAgICAgICB2YXIgc2NhbGFyID0gMS4wIC8gKCB0aGlzLnRleHR1cmVfY291bnQpO1xyXG4gICAgICAgLy9Mb2cubG9nKCBcIm91dHB1dCB0ZXh0dXJlIHRvIGF0bGFzLi4uIHswfSB7MX1cIiwgeF9vZnMsIHlfb2ZzICk7XHJcbiAgICAgICBjb29yZHMuY29vcmQucG9zaXRpb24ueCA9ICggc2NhbGFyICkgKiB0aGlzLnhfb2ZzO1xyXG4gICAgICAgY29vcmRzLmNvb3JkLnBvc2l0aW9uLnkgPSAoIHNjYWxhciApICogdGhpcy55X29mcztcclxuICAgICAgIGNvb3Jkcy5jb29yZC5zaXplLnggPSAoIHNjYWxhciApO1xyXG4gICAgICAgY29vcmRzLmNvb3JkLnNpemUueSA9ICggc2NhbGFyICk7XHJcblxyXG4gICAgICAgY29vcmRzLnV2c1swICogMiArIDBdID0gKCBzY2FsYXIgKSAqIHRoaXMueF9vZnM7XHJcbiAgICAgICBjb29yZHMudXZzWzAgKiAyICsgMV0gPSAxLSgoIHNjYWxhciApICogdGhpcy55X29mcyk7XHJcbiAgICAgICBjb29yZHMudXZzWzEgKiAyICsgMF0gPSBjb29yZHMudXZzWzAgKiAyICsgMF0gKyAoIHNjYWxhciApO1xyXG4gICAgICAgY29vcmRzLnV2c1sxICogMiArIDFdID0gY29vcmRzLnV2c1swICogMiArIDFdO1xyXG4gICAgICAgY29vcmRzLnV2c1syICogMiArIDBdID0gY29vcmRzLnV2c1swICogMiArIDBdO1xyXG4gICAgICAgY29vcmRzLnV2c1syICogMiArIDFdID0gKGNvb3Jkcy51dnNbMCAqIDIgKyAxXSAtICggc2NhbGFyICkpO1xyXG4gICAgICAgY29vcmRzLnV2c1szICogMiArIDBdID0gY29vcmRzLnV2c1sxICogMiArIDBdO1xyXG4gICAgICAgY29vcmRzLnV2c1szICogMiArIDFdID0gY29vcmRzLnV2c1syICogMiArIDFdO1xyXG5cclxuICAgICAgIHZhciBpbl91dnMgPSBjb29yZHMudXZzO1xyXG4gICAgICAgY29vcmRzLnV2X2FycmF5ID0gW2luX3V2c1sxKjIrMF1cclxuICAgICAgICAgICAgICAgICAgICxpbl91dnNbMSoyKzFdXHJcbiAgICAgICAgICAgICAgICAgICAsaW5fdXZzWzAqMiswXVxyXG4gICAgICAgICAgICAgICAgICAgLGluX3V2c1swKjIrMV1cclxuICAgICAgICAgICAgICAgICAgICxpbl91dnNbMyoyKzBdXHJcbiAgICAgICAgICAgICAgICAgICAsaW5fdXZzWzMqMisxXVxyXG4gICAgICAgICAgICAgICAgICAgLGluX3V2c1syKjIrMF1cclxuICAgICAgICAgICAgICAgICAgICxpbl91dnNbMioyKzFdXHJcbiAgICAgICAgICAgICAgIF07XHJcblxyXG5cclxuICAgICAgIHRoaXMuY29udGV4dC5kcmF3SW1hZ2UoIGltYWdlLCB0aGlzLnRleHR1cmVfc2l6ZSAqIHRoaXMueF9vZnMsIHRoaXMudGV4dHVyZV9zaXplICogdGhpcy55X29mcywgdGhpcy50ZXh0dXJlX3NpemUsIHRoaXMudGV4dHVyZV9zaXplIClcclxuXHJcbiAgICAgICB0aGlzLnRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlO1xyXG5cclxuICAgICAgIHRoaXMueF9vZnMrKztcclxuICAgICAgIGlmKCB0aGlzLnhfb2ZzID09IHRoaXMudGV4dHVyZV9jb3VudCApXHJcbiAgICAgICB7XHJcbiAgICAgICAgICAgdGhpcy54X29mcyA9IDA7XHJcbiAgICAgICAgICAgdGhpcy55X29mcysrO1xyXG4gICAgICAgfVxyXG4gICAgICAgcmV0dXJuIGNvb3JkcztcclxuICAgfVxyXG59XHJcbiIsIi8qKlxuICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbS9cbiAqIEBhdXRob3Igc3VwZXJlZ2diZXJ0IC8gaHR0cDovL3d3dy5wYXVsYnJ1bnQuY28udWsvXG4gKiBAYXV0aG9yIGp1bGlhbndhIC8gaHR0cHM6Ly9naXRodWIuY29tL2p1bGlhbndhXG4gKi9cblxuVEhSRUUuUmVuZGVyYWJsZU9iamVjdCA9IGZ1bmN0aW9uICgpIHtcblxuXHR0aGlzLmlkID0gMDtcblxuXHR0aGlzLm9iamVjdCA9IG51bGw7XG5cdHRoaXMueiA9IDA7XG5cdHRoaXMucmVuZGVyT3JkZXIgPSAwO1xuXG59O1xuXG4vL1xuXG5USFJFRS5SZW5kZXJhYmxlRmFjZSA9IGZ1bmN0aW9uICgpIHtcblxuXHR0aGlzLmlkID0gMDtcblxuXHR0aGlzLnYxID0gbmV3IFRIUkVFLlJlbmRlcmFibGVWZXJ0ZXgoKTtcblx0dGhpcy52MiA9IG5ldyBUSFJFRS5SZW5kZXJhYmxlVmVydGV4KCk7XG5cdHRoaXMudjMgPSBuZXcgVEhSRUUuUmVuZGVyYWJsZVZlcnRleCgpO1xuXG5cdHRoaXMubm9ybWFsTW9kZWwgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdHRoaXMudmVydGV4Tm9ybWFsc01vZGVsID0gWyBuZXcgVEhSRUUuVmVjdG9yMygpLCBuZXcgVEhSRUUuVmVjdG9yMygpLCBuZXcgVEhSRUUuVmVjdG9yMygpIF07XG5cdHRoaXMudmVydGV4Tm9ybWFsc0xlbmd0aCA9IDA7XG5cblx0dGhpcy5jb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpO1xuXHR0aGlzLm1hdGVyaWFsID0gbnVsbDtcblx0dGhpcy51dnMgPSBbIG5ldyBUSFJFRS5WZWN0b3IyKCksIG5ldyBUSFJFRS5WZWN0b3IyKCksIG5ldyBUSFJFRS5WZWN0b3IyKCkgXTtcblxuXHR0aGlzLnogPSAwO1xuXHR0aGlzLnJlbmRlck9yZGVyID0gMDtcblxufTtcblxuLy9cblxuVEhSRUUuUmVuZGVyYWJsZVZlcnRleCA9IGZ1bmN0aW9uICgpIHtcblxuXHR0aGlzLnBvc2l0aW9uID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0dGhpcy5wb3NpdGlvbldvcmxkID0gbmV3IFRIUkVFLlZlY3RvcjMoKTtcblx0dGhpcy5wb3NpdGlvblNjcmVlbiA9IG5ldyBUSFJFRS5WZWN0b3I0KCk7XG5cblx0dGhpcy52aXNpYmxlID0gdHJ1ZTtcblxufTtcblxuVEhSRUUuUmVuZGVyYWJsZVZlcnRleC5wcm90b3R5cGUuY29weSA9IGZ1bmN0aW9uICggdmVydGV4ICkge1xuXG5cdHRoaXMucG9zaXRpb25Xb3JsZC5jb3B5KCB2ZXJ0ZXgucG9zaXRpb25Xb3JsZCApO1xuXHR0aGlzLnBvc2l0aW9uU2NyZWVuLmNvcHkoIHZlcnRleC5wb3NpdGlvblNjcmVlbiApO1xuXG59O1xuXG4vL1xuXG5USFJFRS5SZW5kZXJhYmxlTGluZSA9IGZ1bmN0aW9uICgpIHtcblxuXHR0aGlzLmlkID0gMDtcblxuXHR0aGlzLnYxID0gbmV3IFRIUkVFLlJlbmRlcmFibGVWZXJ0ZXgoKTtcblx0dGhpcy52MiA9IG5ldyBUSFJFRS5SZW5kZXJhYmxlVmVydGV4KCk7XG5cblx0dGhpcy52ZXJ0ZXhDb2xvcnMgPSBbIG5ldyBUSFJFRS5Db2xvcigpLCBuZXcgVEhSRUUuQ29sb3IoKSBdO1xuXHR0aGlzLm1hdGVyaWFsID0gbnVsbDtcblxuXHR0aGlzLnogPSAwO1xuXHR0aGlzLnJlbmRlck9yZGVyID0gMDtcblxufTtcblxuLy9cblxuVEhSRUUuUmVuZGVyYWJsZVNwcml0ZSA9IGZ1bmN0aW9uICgpIHtcblxuXHR0aGlzLmlkID0gMDtcblxuXHR0aGlzLm9iamVjdCA9IG51bGw7XG5cblx0dGhpcy54ID0gMDtcblx0dGhpcy55ID0gMDtcblx0dGhpcy56ID0gMDtcblxuXHR0aGlzLnJvdGF0aW9uID0gMDtcblx0dGhpcy5zY2FsZSA9IG5ldyBUSFJFRS5WZWN0b3IyKCk7XG5cblx0dGhpcy5tYXRlcmlhbCA9IG51bGw7XG5cdHRoaXMucmVuZGVyT3JkZXIgPSAwO1xuXG59O1xuXG4vL1xuXG5USFJFRS5Qcm9qZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG5cblx0dmFyIF9vYmplY3QsIF9vYmplY3RDb3VudCwgX29iamVjdFBvb2wgPSBbXSwgX29iamVjdFBvb2xMZW5ndGggPSAwLFxuXHRfdmVydGV4LCBfdmVydGV4Q291bnQsIF92ZXJ0ZXhQb29sID0gW10sIF92ZXJ0ZXhQb29sTGVuZ3RoID0gMCxcblx0X2ZhY2UsIF9mYWNlQ291bnQsIF9mYWNlUG9vbCA9IFtdLCBfZmFjZVBvb2xMZW5ndGggPSAwLFxuXHRfbGluZSwgX2xpbmVDb3VudCwgX2xpbmVQb29sID0gW10sIF9saW5lUG9vbExlbmd0aCA9IDAsXG5cdF9zcHJpdGUsIF9zcHJpdGVDb3VudCwgX3Nwcml0ZVBvb2wgPSBbXSwgX3Nwcml0ZVBvb2xMZW5ndGggPSAwLFxuXG5cdF9yZW5kZXJEYXRhID0geyBvYmplY3RzOiBbXSwgbGlnaHRzOiBbXSwgZWxlbWVudHM6IFtdIH0sXG5cblx0X3ZlY3RvcjMgPSBuZXcgVEhSRUUuVmVjdG9yMygpLFxuXHRfdmVjdG9yNCA9IG5ldyBUSFJFRS5WZWN0b3I0KCksXG5cblx0X2NsaXBCb3ggPSBuZXcgVEhSRUUuQm94MyggbmV3IFRIUkVFLlZlY3RvcjMoIC0gMSwgLSAxLCAtIDEgKSwgbmV3IFRIUkVFLlZlY3RvcjMoIDEsIDEsIDEgKSApLFxuXHRfYm91bmRpbmdCb3ggPSBuZXcgVEhSRUUuQm94MygpLFxuXHRfcG9pbnRzMyA9IG5ldyBBcnJheSggMyApLFxuXHRfcG9pbnRzNCA9IG5ldyBBcnJheSggNCApLFxuXG5cdF92aWV3TWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDQoKSxcblx0X3ZpZXdQcm9qZWN0aW9uTWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDQoKSxcblxuXHRfbW9kZWxNYXRyaXgsXG5cdF9tb2RlbFZpZXdQcm9qZWN0aW9uTWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDQoKSxcblxuXHRfbm9ybWFsTWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDMoKSxcblxuXHRfZnJ1c3R1bSA9IG5ldyBUSFJFRS5GcnVzdHVtKCksXG5cblx0X2NsaXBwZWRWZXJ0ZXgxUG9zaXRpb25TY3JlZW4gPSBuZXcgVEhSRUUuVmVjdG9yNCgpLFxuXHRfY2xpcHBlZFZlcnRleDJQb3NpdGlvblNjcmVlbiA9IG5ldyBUSFJFRS5WZWN0b3I0KCk7XG5cblx0Ly9cblxuXHR0aGlzLnByb2plY3RWZWN0b3IgPSBmdW5jdGlvbiAoIHZlY3RvciwgY2FtZXJhICkge1xuXG5cdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuUHJvamVjdG9yOiAucHJvamVjdFZlY3RvcigpIGlzIG5vdyB2ZWN0b3IucHJvamVjdCgpLicgKTtcblx0XHR2ZWN0b3IucHJvamVjdCggY2FtZXJhICk7XG5cblx0fTtcblxuXHR0aGlzLnVucHJvamVjdFZlY3RvciA9IGZ1bmN0aW9uICggdmVjdG9yLCBjYW1lcmEgKSB7XG5cblx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5Qcm9qZWN0b3I6IC51bnByb2plY3RWZWN0b3IoKSBpcyBub3cgdmVjdG9yLnVucHJvamVjdCgpLicgKTtcblx0XHR2ZWN0b3IudW5wcm9qZWN0KCBjYW1lcmEgKTtcblxuXHR9O1xuXG5cdHRoaXMucGlja2luZ1JheSA9IGZ1bmN0aW9uICggdmVjdG9yLCBjYW1lcmEgKSB7XG5cblx0XHRjb25zb2xlLmVycm9yKCAnVEhSRUUuUHJvamVjdG9yOiAucGlja2luZ1JheSgpIGlzIG5vdyByYXljYXN0ZXIuc2V0RnJvbUNhbWVyYSgpLicgKTtcblxuXHR9O1xuXG5cdC8vXG5cblx0dmFyIFJlbmRlckxpc3QgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHR2YXIgbm9ybWFscyA9IFtdO1xuXHRcdHZhciB1dnMgPSBbXTtcblxuXHRcdHZhciBvYmplY3QgPSBudWxsO1xuXHRcdHZhciBtYXRlcmlhbCA9IG51bGw7XG5cblx0XHR2YXIgbm9ybWFsTWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDMoKTtcblxuXHRcdGZ1bmN0aW9uIHNldE9iamVjdCggdmFsdWUgKSB7XG5cblx0XHRcdG9iamVjdCA9IHZhbHVlO1xuXHRcdFx0bWF0ZXJpYWwgPSBvYmplY3QubWF0ZXJpYWw7XG5cblx0XHRcdG5vcm1hbE1hdHJpeC5nZXROb3JtYWxNYXRyaXgoIG9iamVjdC5tYXRyaXhXb3JsZCApO1xuXG5cdFx0XHRub3JtYWxzLmxlbmd0aCA9IDA7XG5cdFx0XHR1dnMubGVuZ3RoID0gMDtcblxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHByb2plY3RWZXJ0ZXgoIHZlcnRleCApIHtcblxuXHRcdFx0dmFyIHBvc2l0aW9uID0gdmVydGV4LnBvc2l0aW9uO1xuXHRcdFx0dmFyIHBvc2l0aW9uV29ybGQgPSB2ZXJ0ZXgucG9zaXRpb25Xb3JsZDtcblx0XHRcdHZhciBwb3NpdGlvblNjcmVlbiA9IHZlcnRleC5wb3NpdGlvblNjcmVlbjtcblxuXHRcdFx0cG9zaXRpb25Xb3JsZC5jb3B5KCBwb3NpdGlvbiApLmFwcGx5TWF0cml4NCggX21vZGVsTWF0cml4ICk7XG5cdFx0XHRwb3NpdGlvblNjcmVlbi5jb3B5KCBwb3NpdGlvbldvcmxkICkuYXBwbHlNYXRyaXg0KCBfdmlld1Byb2plY3Rpb25NYXRyaXggKTtcblxuXHRcdFx0dmFyIGludlcgPSAxIC8gcG9zaXRpb25TY3JlZW4udztcblxuXHRcdFx0cG9zaXRpb25TY3JlZW4ueCAqPSBpbnZXO1xuXHRcdFx0cG9zaXRpb25TY3JlZW4ueSAqPSBpbnZXO1xuXHRcdFx0cG9zaXRpb25TY3JlZW4ueiAqPSBpbnZXO1xuXG5cdFx0XHR2ZXJ0ZXgudmlzaWJsZSA9IHBvc2l0aW9uU2NyZWVuLnggPj0gLSAxICYmIHBvc2l0aW9uU2NyZWVuLnggPD0gMSAmJlxuXHRcdFx0XHRcdCBwb3NpdGlvblNjcmVlbi55ID49IC0gMSAmJiBwb3NpdGlvblNjcmVlbi55IDw9IDEgJiZcblx0XHRcdFx0XHQgcG9zaXRpb25TY3JlZW4ueiA+PSAtIDEgJiYgcG9zaXRpb25TY3JlZW4ueiA8PSAxO1xuXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcHVzaFZlcnRleCggeCwgeSwgeiApIHtcblxuXHRcdFx0X3ZlcnRleCA9IGdldE5leHRWZXJ0ZXhJblBvb2woKTtcblx0XHRcdF92ZXJ0ZXgucG9zaXRpb24uc2V0KCB4LCB5LCB6ICk7XG5cblx0XHRcdHByb2plY3RWZXJ0ZXgoIF92ZXJ0ZXggKTtcblxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHB1c2hOb3JtYWwoIHgsIHksIHogKSB7XG5cblx0XHRcdG5vcm1hbHMucHVzaCggeCwgeSwgeiApO1xuXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcHVzaFV2KCB4LCB5ICkge1xuXG5cdFx0XHR1dnMucHVzaCggeCwgeSApO1xuXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY2hlY2tUcmlhbmdsZVZpc2liaWxpdHkoIHYxLCB2MiwgdjMgKSB7XG5cblx0XHRcdGlmICggdjEudmlzaWJsZSA9PT0gdHJ1ZSB8fCB2Mi52aXNpYmxlID09PSB0cnVlIHx8IHYzLnZpc2libGUgPT09IHRydWUgKSByZXR1cm4gdHJ1ZTtcblxuXHRcdFx0X3BvaW50czNbIDAgXSA9IHYxLnBvc2l0aW9uU2NyZWVuO1xuXHRcdFx0X3BvaW50czNbIDEgXSA9IHYyLnBvc2l0aW9uU2NyZWVuO1xuXHRcdFx0X3BvaW50czNbIDIgXSA9IHYzLnBvc2l0aW9uU2NyZWVuO1xuXG5cdFx0XHRyZXR1cm4gX2NsaXBCb3guaW50ZXJzZWN0c0JveCggX2JvdW5kaW5nQm94LnNldEZyb21Qb2ludHMoIF9wb2ludHMzICkgKTtcblxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGNoZWNrQmFja2ZhY2VDdWxsaW5nKCB2MSwgdjIsIHYzICkge1xuXG5cdFx0XHRyZXR1cm4gKCAoIHYzLnBvc2l0aW9uU2NyZWVuLnggLSB2MS5wb3NpdGlvblNjcmVlbi54ICkgKlxuXHRcdFx0XHQgICAgKCB2Mi5wb3NpdGlvblNjcmVlbi55IC0gdjEucG9zaXRpb25TY3JlZW4ueSApIC1cblx0XHRcdFx0ICAgICggdjMucG9zaXRpb25TY3JlZW4ueSAtIHYxLnBvc2l0aW9uU2NyZWVuLnkgKSAqXG5cdFx0XHRcdCAgICAoIHYyLnBvc2l0aW9uU2NyZWVuLnggLSB2MS5wb3NpdGlvblNjcmVlbi54ICkgKSA8IDA7XG5cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBwdXNoTGluZSggYSwgYiApIHtcblxuXHRcdFx0dmFyIHYxID0gX3ZlcnRleFBvb2xbIGEgXTtcblx0XHRcdHZhciB2MiA9IF92ZXJ0ZXhQb29sWyBiIF07XG5cblx0XHRcdF9saW5lID0gZ2V0TmV4dExpbmVJblBvb2woKTtcblxuXHRcdFx0X2xpbmUuaWQgPSBvYmplY3QuaWQ7XG5cdFx0XHRfbGluZS52MS5jb3B5KCB2MSApO1xuXHRcdFx0X2xpbmUudjIuY29weSggdjIgKTtcblx0XHRcdF9saW5lLnogPSAoIHYxLnBvc2l0aW9uU2NyZWVuLnogKyB2Mi5wb3NpdGlvblNjcmVlbi56ICkgLyAyO1xuXHRcdFx0X2xpbmUucmVuZGVyT3JkZXIgPSBvYmplY3QucmVuZGVyT3JkZXI7XG5cblx0XHRcdF9saW5lLm1hdGVyaWFsID0gb2JqZWN0Lm1hdGVyaWFsO1xuXG5cdFx0XHRfcmVuZGVyRGF0YS5lbGVtZW50cy5wdXNoKCBfbGluZSApO1xuXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcHVzaFRyaWFuZ2xlKCBhLCBiLCBjICkge1xuXG5cdFx0XHR2YXIgdjEgPSBfdmVydGV4UG9vbFsgYSBdO1xuXHRcdFx0dmFyIHYyID0gX3ZlcnRleFBvb2xbIGIgXTtcblx0XHRcdHZhciB2MyA9IF92ZXJ0ZXhQb29sWyBjIF07XG5cblx0XHRcdGlmICggY2hlY2tUcmlhbmdsZVZpc2liaWxpdHkoIHYxLCB2MiwgdjMgKSA9PT0gZmFsc2UgKSByZXR1cm47XG5cblx0XHRcdGlmICggbWF0ZXJpYWwuc2lkZSA9PT0gVEhSRUUuRG91YmxlU2lkZSB8fCBjaGVja0JhY2tmYWNlQ3VsbGluZyggdjEsIHYyLCB2MyApID09PSB0cnVlICkge1xuXG5cdFx0XHRcdF9mYWNlID0gZ2V0TmV4dEZhY2VJblBvb2woKTtcblxuXHRcdFx0XHRfZmFjZS5pZCA9IG9iamVjdC5pZDtcblx0XHRcdFx0X2ZhY2UudjEuY29weSggdjEgKTtcblx0XHRcdFx0X2ZhY2UudjIuY29weSggdjIgKTtcblx0XHRcdFx0X2ZhY2UudjMuY29weSggdjMgKTtcblx0XHRcdFx0X2ZhY2UueiA9ICggdjEucG9zaXRpb25TY3JlZW4ueiArIHYyLnBvc2l0aW9uU2NyZWVuLnogKyB2My5wb3NpdGlvblNjcmVlbi56ICkgLyAzO1xuXHRcdFx0XHRfZmFjZS5yZW5kZXJPcmRlciA9IG9iamVjdC5yZW5kZXJPcmRlcjtcblxuXHRcdFx0XHQvLyB1c2UgZmlyc3QgdmVydGV4IG5vcm1hbCBhcyBmYWNlIG5vcm1hbFxuXG5cdFx0XHRcdF9mYWNlLm5vcm1hbE1vZGVsLmZyb21BcnJheSggbm9ybWFscywgYSAqIDMgKTtcblx0XHRcdFx0X2ZhY2Uubm9ybWFsTW9kZWwuYXBwbHlNYXRyaXgzKCBub3JtYWxNYXRyaXggKS5ub3JtYWxpemUoKTtcblxuXHRcdFx0XHRmb3IgKCB2YXIgaSA9IDA7IGkgPCAzOyBpICsrICkge1xuXG5cdFx0XHRcdFx0dmFyIG5vcm1hbCA9IF9mYWNlLnZlcnRleE5vcm1hbHNNb2RlbFsgaSBdO1xuXHRcdFx0XHRcdG5vcm1hbC5mcm9tQXJyYXkoIG5vcm1hbHMsIGFyZ3VtZW50c1sgaSBdICogMyApO1xuXHRcdFx0XHRcdG5vcm1hbC5hcHBseU1hdHJpeDMoIG5vcm1hbE1hdHJpeCApLm5vcm1hbGl6ZSgpO1xuXG5cdFx0XHRcdFx0dmFyIHV2ID0gX2ZhY2UudXZzWyBpIF07XG5cdFx0XHRcdFx0dXYuZnJvbUFycmF5KCB1dnMsIGFyZ3VtZW50c1sgaSBdICogMiApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRfZmFjZS52ZXJ0ZXhOb3JtYWxzTGVuZ3RoID0gMztcblxuXHRcdFx0XHRfZmFjZS5tYXRlcmlhbCA9IG9iamVjdC5tYXRlcmlhbDtcblxuXHRcdFx0XHRfcmVuZGVyRGF0YS5lbGVtZW50cy5wdXNoKCBfZmFjZSApO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0c2V0T2JqZWN0OiBzZXRPYmplY3QsXG5cdFx0XHRwcm9qZWN0VmVydGV4OiBwcm9qZWN0VmVydGV4LFxuXHRcdFx0Y2hlY2tUcmlhbmdsZVZpc2liaWxpdHk6IGNoZWNrVHJpYW5nbGVWaXNpYmlsaXR5LFxuXHRcdFx0Y2hlY2tCYWNrZmFjZUN1bGxpbmc6IGNoZWNrQmFja2ZhY2VDdWxsaW5nLFxuXHRcdFx0cHVzaFZlcnRleDogcHVzaFZlcnRleCxcblx0XHRcdHB1c2hOb3JtYWw6IHB1c2hOb3JtYWwsXG5cdFx0XHRwdXNoVXY6IHB1c2hVdixcblx0XHRcdHB1c2hMaW5lOiBwdXNoTGluZSxcblx0XHRcdHB1c2hUcmlhbmdsZTogcHVzaFRyaWFuZ2xlXG5cdFx0fVxuXG5cdH07XG5cblx0dmFyIHJlbmRlckxpc3QgPSBuZXcgUmVuZGVyTGlzdCgpO1xuXG5cdHRoaXMucHJvamVjdFNjZW5lID0gZnVuY3Rpb24gKCBzY2VuZSwgY2FtZXJhLCBzb3J0T2JqZWN0cywgc29ydEVsZW1lbnRzICkge1xuXG5cdFx0X2ZhY2VDb3VudCA9IDA7XG5cdFx0X2xpbmVDb3VudCA9IDA7XG5cdFx0X3Nwcml0ZUNvdW50ID0gMDtcblxuXHRcdF9yZW5kZXJEYXRhLmVsZW1lbnRzLmxlbmd0aCA9IDA7XG5cblx0XHRpZiAoIHNjZW5lLmF1dG9VcGRhdGUgPT09IHRydWUgKSBzY2VuZS51cGRhdGVNYXRyaXhXb3JsZCgpO1xuXHRcdGlmICggY2FtZXJhLnBhcmVudCA9PT0gbnVsbCApIGNhbWVyYS51cGRhdGVNYXRyaXhXb3JsZCgpO1xuXG5cdFx0X3ZpZXdNYXRyaXguY29weSggY2FtZXJhLm1hdHJpeFdvcmxkSW52ZXJzZS5nZXRJbnZlcnNlKCBjYW1lcmEubWF0cml4V29ybGQgKSApO1xuXHRcdF92aWV3UHJvamVjdGlvbk1hdHJpeC5tdWx0aXBseU1hdHJpY2VzKCBjYW1lcmEucHJvamVjdGlvbk1hdHJpeCwgX3ZpZXdNYXRyaXggKTtcblxuXHRcdF9mcnVzdHVtLnNldEZyb21NYXRyaXgoIF92aWV3UHJvamVjdGlvbk1hdHJpeCApO1xuXG5cdFx0Ly9cblxuXHRcdF9vYmplY3RDb3VudCA9IDA7XG5cblx0XHRfcmVuZGVyRGF0YS5vYmplY3RzLmxlbmd0aCA9IDA7XG5cdFx0X3JlbmRlckRhdGEubGlnaHRzLmxlbmd0aCA9IDA7XG5cblx0XHRmdW5jdGlvbiBhZGRPYmplY3QoIG9iamVjdCApIHtcblxuXHRcdFx0X29iamVjdCA9IGdldE5leHRPYmplY3RJblBvb2woKTtcblx0XHRcdF9vYmplY3QuaWQgPSBvYmplY3QuaWQ7XG5cdFx0XHRfb2JqZWN0Lm9iamVjdCA9IG9iamVjdDtcblxuXHRcdFx0X3ZlY3RvcjMuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKCBvYmplY3QubWF0cml4V29ybGQgKTtcblx0XHRcdF92ZWN0b3IzLmFwcGx5UHJvamVjdGlvbiggX3ZpZXdQcm9qZWN0aW9uTWF0cml4ICk7XG5cdFx0XHRfb2JqZWN0LnogPSBfdmVjdG9yMy56O1xuXHRcdFx0X29iamVjdC5yZW5kZXJPcmRlciA9IG9iamVjdC5yZW5kZXJPcmRlcjtcblxuXHRcdFx0X3JlbmRlckRhdGEub2JqZWN0cy5wdXNoKCBfb2JqZWN0ICk7XG5cblx0XHR9XG5cblx0XHRzY2VuZS50cmF2ZXJzZVZpc2libGUoIGZ1bmN0aW9uICggb2JqZWN0ICkge1xuXG5cdFx0XHRpZiAoIG9iamVjdCBpbnN0YW5jZW9mIFRIUkVFLkxpZ2h0ICkge1xuXG5cdFx0XHRcdF9yZW5kZXJEYXRhLmxpZ2h0cy5wdXNoKCBvYmplY3QgKTtcblxuXHRcdFx0fSBlbHNlIGlmICggb2JqZWN0IGluc3RhbmNlb2YgVEhSRUUuTWVzaCB8fCBvYmplY3QgaW5zdGFuY2VvZiBUSFJFRS5MaW5lICkge1xuXG5cdFx0XHRcdGlmICggb2JqZWN0Lm1hdGVyaWFsLnZpc2libGUgPT09IGZhbHNlICkgcmV0dXJuO1xuXHRcdFx0XHRpZiAoIG9iamVjdC5mcnVzdHVtQ3VsbGVkID09PSB0cnVlICYmIF9mcnVzdHVtLmludGVyc2VjdHNPYmplY3QoIG9iamVjdCApID09PSBmYWxzZSApIHJldHVybjtcblxuXHRcdFx0XHRhZGRPYmplY3QoIG9iamVjdCApO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCBvYmplY3QgaW5zdGFuY2VvZiBUSFJFRS5TcHJpdGUgKSB7XG5cblx0XHRcdFx0aWYgKCBvYmplY3QubWF0ZXJpYWwudmlzaWJsZSA9PT0gZmFsc2UgKSByZXR1cm47XG5cdFx0XHRcdGlmICggb2JqZWN0LmZydXN0dW1DdWxsZWQgPT09IHRydWUgJiYgX2ZydXN0dW0uaW50ZXJzZWN0c1Nwcml0ZSggb2JqZWN0ICkgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0XHRcdGFkZE9iamVjdCggb2JqZWN0ICk7XG5cblx0XHRcdH1cblxuXHRcdH0gKTtcblxuXHRcdGlmICggc29ydE9iamVjdHMgPT09IHRydWUgKSB7XG5cblx0XHRcdF9yZW5kZXJEYXRhLm9iamVjdHMuc29ydCggcGFpbnRlclNvcnQgKTtcblxuXHRcdH1cblxuXHRcdC8vXG5cblx0XHRmb3IgKCB2YXIgbyA9IDAsIG9sID0gX3JlbmRlckRhdGEub2JqZWN0cy5sZW5ndGg7IG8gPCBvbDsgbyArKyApIHtcblxuXHRcdFx0dmFyIG9iamVjdCA9IF9yZW5kZXJEYXRhLm9iamVjdHNbIG8gXS5vYmplY3Q7XG5cdFx0XHR2YXIgZ2VvbWV0cnkgPSBvYmplY3QuZ2VvbWV0cnk7XG5cblx0XHRcdHJlbmRlckxpc3Quc2V0T2JqZWN0KCBvYmplY3QgKTtcblxuXHRcdFx0X21vZGVsTWF0cml4ID0gb2JqZWN0Lm1hdHJpeFdvcmxkO1xuXG5cdFx0XHRfdmVydGV4Q291bnQgPSAwO1xuXG5cdFx0XHRpZiAoIG9iamVjdCBpbnN0YW5jZW9mIFRIUkVFLk1lc2ggKSB7XG5cblx0XHRcdFx0aWYgKCBnZW9tZXRyeSBpbnN0YW5jZW9mIFRIUkVFLkJ1ZmZlckdlb21ldHJ5ICkge1xuXG5cdFx0XHRcdFx0dmFyIGF0dHJpYnV0ZXMgPSBnZW9tZXRyeS5hdHRyaWJ1dGVzO1xuXHRcdFx0XHRcdHZhciBncm91cHMgPSBnZW9tZXRyeS5ncm91cHM7XG5cblx0XHRcdFx0XHRpZiAoIGF0dHJpYnV0ZXMucG9zaXRpb24gPT09IHVuZGVmaW5lZCApIGNvbnRpbnVlO1xuXG5cdFx0XHRcdFx0dmFyIHBvc2l0aW9ucyA9IGF0dHJpYnV0ZXMucG9zaXRpb24uYXJyYXk7XG5cblx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IDAsIGwgPSBwb3NpdGlvbnMubGVuZ3RoOyBpIDwgbDsgaSArPSAzICkge1xuXG5cdFx0XHRcdFx0XHRyZW5kZXJMaXN0LnB1c2hWZXJ0ZXgoIHBvc2l0aW9uc1sgaSBdLCBwb3NpdGlvbnNbIGkgKyAxIF0sIHBvc2l0aW9uc1sgaSArIDIgXSApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCBhdHRyaWJ1dGVzLm5vcm1hbCAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRcdFx0XHR2YXIgbm9ybWFscyA9IGF0dHJpYnV0ZXMubm9ybWFsLmFycmF5O1xuXG5cdFx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IDAsIGwgPSBub3JtYWxzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMyApIHtcblxuXHRcdFx0XHRcdFx0XHRyZW5kZXJMaXN0LnB1c2hOb3JtYWwoIG5vcm1hbHNbIGkgXSwgbm9ybWFsc1sgaSArIDEgXSwgbm9ybWFsc1sgaSArIDIgXSApO1xuXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoIGF0dHJpYnV0ZXMudXYgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRcdFx0dmFyIHV2cyA9IGF0dHJpYnV0ZXMudXYuYXJyYXk7XG5cblx0XHRcdFx0XHRcdGZvciAoIHZhciBpID0gMCwgbCA9IHV2cy5sZW5ndGg7IGkgPCBsOyBpICs9IDIgKSB7XG5cblx0XHRcdFx0XHRcdFx0cmVuZGVyTGlzdC5wdXNoVXYoIHV2c1sgaSBdLCB1dnNbIGkgKyAxIF0gKTtcblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCBnZW9tZXRyeS5pbmRleCAhPT0gbnVsbCApIHtcblxuXHRcdFx0XHRcdFx0dmFyIGluZGljZXMgPSBnZW9tZXRyeS5pbmRleC5hcnJheTtcblxuXHRcdFx0XHRcdFx0aWYgKCBncm91cHMubGVuZ3RoID4gMCApIHtcblxuXHRcdFx0XHRcdFx0XHRmb3IgKCB2YXIgbyA9IDA7IG8gPCBncm91cHMubGVuZ3RoOyBvICsrICkge1xuXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGdyb3VwID0gZ3JvdXBzWyBvIF07XG5cblx0XHRcdFx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IGdyb3VwLnN0YXJ0LCBsID0gZ3JvdXAuc3RhcnQgKyBncm91cC5jb3VudDsgaSA8IGw7IGkgKz0gMyApIHtcblxuXHRcdFx0XHRcdFx0XHRcdFx0cmVuZGVyTGlzdC5wdXNoVHJpYW5nbGUoIGluZGljZXNbIGkgXSwgaW5kaWNlc1sgaSArIDEgXSwgaW5kaWNlc1sgaSArIDIgXSApO1xuXG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IDAsIGwgPSBpbmRpY2VzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMyApIHtcblxuXHRcdFx0XHRcdFx0XHRcdHJlbmRlckxpc3QucHVzaFRyaWFuZ2xlKCBpbmRpY2VzWyBpIF0sIGluZGljZXNbIGkgKyAxIF0sIGluZGljZXNbIGkgKyAyIF0gKTtcblxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRcdGZvciAoIHZhciBpID0gMCwgbCA9IHBvc2l0aW9ucy5sZW5ndGggLyAzOyBpIDwgbDsgaSArPSAzICkge1xuXG5cdFx0XHRcdFx0XHRcdHJlbmRlckxpc3QucHVzaFRyaWFuZ2xlKCBpLCBpICsgMSwgaSArIDIgKTtcblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIGdlb21ldHJ5IGluc3RhbmNlb2YgVEhSRUUuR2VvbWV0cnkgKSB7XG5cblx0XHRcdFx0XHR2YXIgdmVydGljZXMgPSBnZW9tZXRyeS52ZXJ0aWNlcztcblx0XHRcdFx0XHR2YXIgZmFjZXMgPSBnZW9tZXRyeS5mYWNlcztcblx0XHRcdFx0XHR2YXIgZmFjZVZlcnRleFV2cyA9IGdlb21ldHJ5LmZhY2VWZXJ0ZXhVdnNbIDAgXTtcblxuXHRcdFx0XHRcdF9ub3JtYWxNYXRyaXguZ2V0Tm9ybWFsTWF0cml4KCBfbW9kZWxNYXRyaXggKTtcblxuXHRcdFx0XHRcdHZhciBtYXRlcmlhbCA9IG9iamVjdC5tYXRlcmlhbDtcblxuXHRcdFx0XHRcdHZhciBpc0ZhY2VNYXRlcmlhbCA9IG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuTXVsdGlNYXRlcmlhbDtcblx0XHRcdFx0XHR2YXIgb2JqZWN0TWF0ZXJpYWxzID0gaXNGYWNlTWF0ZXJpYWwgPT09IHRydWUgPyBvYmplY3QubWF0ZXJpYWwgOiBudWxsO1xuXG5cdFx0XHRcdFx0Zm9yICggdmFyIHYgPSAwLCB2bCA9IHZlcnRpY2VzLmxlbmd0aDsgdiA8IHZsOyB2ICsrICkge1xuXG5cdFx0XHRcdFx0XHR2YXIgdmVydGV4ID0gdmVydGljZXNbIHYgXTtcblxuXHRcdFx0XHRcdFx0X3ZlY3RvcjMuY29weSggdmVydGV4ICk7XG5cblx0XHRcdFx0XHRcdGlmICggbWF0ZXJpYWwubW9ycGhUYXJnZXRzID09PSB0cnVlICkge1xuXG5cdFx0XHRcdFx0XHRcdHZhciBtb3JwaFRhcmdldHMgPSBnZW9tZXRyeS5tb3JwaFRhcmdldHM7XG5cdFx0XHRcdFx0XHRcdHZhciBtb3JwaEluZmx1ZW5jZXMgPSBvYmplY3QubW9ycGhUYXJnZXRJbmZsdWVuY2VzO1xuXG5cdFx0XHRcdFx0XHRcdGZvciAoIHZhciB0ID0gMCwgdGwgPSBtb3JwaFRhcmdldHMubGVuZ3RoOyB0IDwgdGw7IHQgKysgKSB7XG5cblx0XHRcdFx0XHRcdFx0XHR2YXIgaW5mbHVlbmNlID0gbW9ycGhJbmZsdWVuY2VzWyB0IF07XG5cblx0XHRcdFx0XHRcdFx0XHRpZiAoIGluZmx1ZW5jZSA9PT0gMCApIGNvbnRpbnVlO1xuXG5cdFx0XHRcdFx0XHRcdFx0dmFyIHRhcmdldCA9IG1vcnBoVGFyZ2V0c1sgdCBdO1xuXHRcdFx0XHRcdFx0XHRcdHZhciB0YXJnZXRWZXJ0ZXggPSB0YXJnZXQudmVydGljZXNbIHYgXTtcblxuXHRcdFx0XHRcdFx0XHRcdF92ZWN0b3IzLnggKz0gKCB0YXJnZXRWZXJ0ZXgueCAtIHZlcnRleC54ICkgKiBpbmZsdWVuY2U7XG5cdFx0XHRcdFx0XHRcdFx0X3ZlY3RvcjMueSArPSAoIHRhcmdldFZlcnRleC55IC0gdmVydGV4LnkgKSAqIGluZmx1ZW5jZTtcblx0XHRcdFx0XHRcdFx0XHRfdmVjdG9yMy56ICs9ICggdGFyZ2V0VmVydGV4LnogLSB2ZXJ0ZXgueiApICogaW5mbHVlbmNlO1xuXG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZW5kZXJMaXN0LnB1c2hWZXJ0ZXgoIF92ZWN0b3IzLngsIF92ZWN0b3IzLnksIF92ZWN0b3IzLnogKTtcblxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGZvciAoIHZhciBmID0gMCwgZmwgPSBmYWNlcy5sZW5ndGg7IGYgPCBmbDsgZiArKyApIHtcblxuXHRcdFx0XHRcdFx0dmFyIGZhY2UgPSBmYWNlc1sgZiBdO1xuXG5cdFx0XHRcdFx0XHRtYXRlcmlhbCA9IGlzRmFjZU1hdGVyaWFsID09PSB0cnVlXG5cdFx0XHRcdFx0XHRcdCA/IG9iamVjdE1hdGVyaWFscy5tYXRlcmlhbHNbIGZhY2UubWF0ZXJpYWxJbmRleCBdXG5cdFx0XHRcdFx0XHRcdCA6IG9iamVjdC5tYXRlcmlhbDtcblxuXHRcdFx0XHRcdFx0aWYgKCBtYXRlcmlhbCA9PT0gdW5kZWZpbmVkICkgY29udGludWU7XG5cblx0XHRcdFx0XHRcdHZhciBzaWRlID0gbWF0ZXJpYWwuc2lkZTtcblxuXHRcdFx0XHRcdFx0dmFyIHYxID0gX3ZlcnRleFBvb2xbIGZhY2UuYSBdO1xuXHRcdFx0XHRcdFx0dmFyIHYyID0gX3ZlcnRleFBvb2xbIGZhY2UuYiBdO1xuXHRcdFx0XHRcdFx0dmFyIHYzID0gX3ZlcnRleFBvb2xbIGZhY2UuYyBdO1xuXG5cdFx0XHRcdFx0XHRpZiAoIHJlbmRlckxpc3QuY2hlY2tUcmlhbmdsZVZpc2liaWxpdHkoIHYxLCB2MiwgdjMgKSA9PT0gZmFsc2UgKSBjb250aW51ZTtcblxuXHRcdFx0XHRcdFx0dmFyIHZpc2libGUgPSByZW5kZXJMaXN0LmNoZWNrQmFja2ZhY2VDdWxsaW5nKCB2MSwgdjIsIHYzICk7XG5cblx0XHRcdFx0XHRcdGlmICggc2lkZSAhPT0gVEhSRUUuRG91YmxlU2lkZSApIHtcblxuXHRcdFx0XHRcdFx0XHRpZiAoIHNpZGUgPT09IFRIUkVFLkZyb250U2lkZSAmJiB2aXNpYmxlID09PSBmYWxzZSApIGNvbnRpbnVlO1xuXHRcdFx0XHRcdFx0XHRpZiAoIHNpZGUgPT09IFRIUkVFLkJhY2tTaWRlICYmIHZpc2libGUgPT09IHRydWUgKSBjb250aW51ZTtcblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRfZmFjZSA9IGdldE5leHRGYWNlSW5Qb29sKCk7XG5cblx0XHRcdFx0XHRcdF9mYWNlLmlkID0gb2JqZWN0LmlkO1xuXHRcdFx0XHRcdFx0X2ZhY2UudjEuY29weSggdjEgKTtcblx0XHRcdFx0XHRcdF9mYWNlLnYyLmNvcHkoIHYyICk7XG5cdFx0XHRcdFx0XHRfZmFjZS52My5jb3B5KCB2MyApO1xuXG5cdFx0XHRcdFx0XHRfZmFjZS5ub3JtYWxNb2RlbC5jb3B5KCBmYWNlLm5vcm1hbCApO1xuXG5cdFx0XHRcdFx0XHRpZiAoIHZpc2libGUgPT09IGZhbHNlICYmICggc2lkZSA9PT0gVEhSRUUuQmFja1NpZGUgfHwgc2lkZSA9PT0gVEhSRUUuRG91YmxlU2lkZSApICkge1xuXG5cdFx0XHRcdFx0XHRcdF9mYWNlLm5vcm1hbE1vZGVsLm5lZ2F0ZSgpO1xuXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdF9mYWNlLm5vcm1hbE1vZGVsLmFwcGx5TWF0cml4MyggX25vcm1hbE1hdHJpeCApLm5vcm1hbGl6ZSgpO1xuXG5cdFx0XHRcdFx0XHR2YXIgZmFjZVZlcnRleE5vcm1hbHMgPSBmYWNlLnZlcnRleE5vcm1hbHM7XG5cblx0XHRcdFx0XHRcdGZvciAoIHZhciBuID0gMCwgbmwgPSBNYXRoLm1pbiggZmFjZVZlcnRleE5vcm1hbHMubGVuZ3RoLCAzICk7IG4gPCBubDsgbiArKyApIHtcblxuXHRcdFx0XHRcdFx0XHR2YXIgbm9ybWFsTW9kZWwgPSBfZmFjZS52ZXJ0ZXhOb3JtYWxzTW9kZWxbIG4gXTtcblx0XHRcdFx0XHRcdFx0bm9ybWFsTW9kZWwuY29weSggZmFjZVZlcnRleE5vcm1hbHNbIG4gXSApO1xuXG5cdFx0XHRcdFx0XHRcdGlmICggdmlzaWJsZSA9PT0gZmFsc2UgJiYgKCBzaWRlID09PSBUSFJFRS5CYWNrU2lkZSB8fCBzaWRlID09PSBUSFJFRS5Eb3VibGVTaWRlICkgKSB7XG5cblx0XHRcdFx0XHRcdFx0XHRub3JtYWxNb2RlbC5uZWdhdGUoKTtcblxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0bm9ybWFsTW9kZWwuYXBwbHlNYXRyaXgzKCBfbm9ybWFsTWF0cml4ICkubm9ybWFsaXplKCk7XG5cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0X2ZhY2UudmVydGV4Tm9ybWFsc0xlbmd0aCA9IGZhY2VWZXJ0ZXhOb3JtYWxzLmxlbmd0aDtcblxuXHRcdFx0XHRcdFx0dmFyIHZlcnRleFV2cyA9IGZhY2VWZXJ0ZXhVdnNbIGYgXTtcblxuXHRcdFx0XHRcdFx0aWYgKCB2ZXJ0ZXhVdnMgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRcdFx0XHRmb3IgKCB2YXIgdSA9IDA7IHUgPCAzOyB1ICsrICkge1xuXG5cdFx0XHRcdFx0XHRcdFx0X2ZhY2UudXZzWyB1IF0uY29weSggdmVydGV4VXZzWyB1IF0gKTtcblxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0X2ZhY2UuY29sb3IgPSBmYWNlLmNvbG9yO1xuXHRcdFx0XHRcdFx0X2ZhY2UubWF0ZXJpYWwgPSBtYXRlcmlhbDtcblxuXHRcdFx0XHRcdFx0X2ZhY2UueiA9ICggdjEucG9zaXRpb25TY3JlZW4ueiArIHYyLnBvc2l0aW9uU2NyZWVuLnogKyB2My5wb3NpdGlvblNjcmVlbi56ICkgLyAzO1xuXHRcdFx0XHRcdFx0X2ZhY2UucmVuZGVyT3JkZXIgPSBvYmplY3QucmVuZGVyT3JkZXI7XG5cblx0XHRcdFx0XHRcdF9yZW5kZXJEYXRhLmVsZW1lbnRzLnB1c2goIF9mYWNlICk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2UgaWYgKCBvYmplY3QgaW5zdGFuY2VvZiBUSFJFRS5MaW5lICkge1xuXG5cdFx0XHRcdGlmICggZ2VvbWV0cnkgaW5zdGFuY2VvZiBUSFJFRS5CdWZmZXJHZW9tZXRyeSApIHtcblxuXHRcdFx0XHRcdHZhciBhdHRyaWJ1dGVzID0gZ2VvbWV0cnkuYXR0cmlidXRlcztcblxuXHRcdFx0XHRcdGlmICggYXR0cmlidXRlcy5wb3NpdGlvbiAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRcdFx0XHR2YXIgcG9zaXRpb25zID0gYXR0cmlidXRlcy5wb3NpdGlvbi5hcnJheTtcblxuXHRcdFx0XHRcdFx0Zm9yICggdmFyIGkgPSAwLCBsID0gcG9zaXRpb25zLmxlbmd0aDsgaSA8IGw7IGkgKz0gMyApIHtcblxuXHRcdFx0XHRcdFx0XHRyZW5kZXJMaXN0LnB1c2hWZXJ0ZXgoIHBvc2l0aW9uc1sgaSBdLCBwb3NpdGlvbnNbIGkgKyAxIF0sIHBvc2l0aW9uc1sgaSArIDIgXSApO1xuXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdGlmICggZ2VvbWV0cnkuaW5kZXggIT09IG51bGwgKSB7XG5cblx0XHRcdFx0XHRcdFx0dmFyIGluZGljZXMgPSBnZW9tZXRyeS5pbmRleC5hcnJheTtcblxuXHRcdFx0XHRcdFx0XHRmb3IgKCB2YXIgaSA9IDAsIGwgPSBpbmRpY2VzLmxlbmd0aDsgaSA8IGw7IGkgKz0gMiApIHtcblxuXHRcdFx0XHRcdFx0XHRcdHJlbmRlckxpc3QucHVzaExpbmUoIGluZGljZXNbIGkgXSwgaW5kaWNlc1sgaSArIDEgXSApO1xuXG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0XHR2YXIgc3RlcCA9IG9iamVjdCBpbnN0YW5jZW9mIFRIUkVFLkxpbmVTZWdtZW50cyA/IDIgOiAxO1xuXG5cdFx0XHRcdFx0XHRcdGZvciAoIHZhciBpID0gMCwgbCA9ICggcG9zaXRpb25zLmxlbmd0aCAvIDMgKSAtIDE7IGkgPCBsOyBpICs9IHN0ZXAgKSB7XG5cblx0XHRcdFx0XHRcdFx0XHRyZW5kZXJMaXN0LnB1c2hMaW5lKCBpLCBpICsgMSApO1xuXG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIGdlb21ldHJ5IGluc3RhbmNlb2YgVEhSRUUuR2VvbWV0cnkgKSB7XG5cblx0XHRcdFx0XHRfbW9kZWxWaWV3UHJvamVjdGlvbk1hdHJpeC5tdWx0aXBseU1hdHJpY2VzKCBfdmlld1Byb2plY3Rpb25NYXRyaXgsIF9tb2RlbE1hdHJpeCApO1xuXG5cdFx0XHRcdFx0dmFyIHZlcnRpY2VzID0gb2JqZWN0Lmdlb21ldHJ5LnZlcnRpY2VzO1xuXG5cdFx0XHRcdFx0aWYgKCB2ZXJ0aWNlcy5sZW5ndGggPT09IDAgKSBjb250aW51ZTtcblxuXHRcdFx0XHRcdHYxID0gZ2V0TmV4dFZlcnRleEluUG9vbCgpO1xuXHRcdFx0XHRcdHYxLnBvc2l0aW9uU2NyZWVuLmNvcHkoIHZlcnRpY2VzWyAwIF0gKS5hcHBseU1hdHJpeDQoIF9tb2RlbFZpZXdQcm9qZWN0aW9uTWF0cml4ICk7XG5cblx0XHRcdFx0XHR2YXIgc3RlcCA9IG9iamVjdCBpbnN0YW5jZW9mIFRIUkVFLkxpbmVTZWdtZW50cyA/IDIgOiAxO1xuXG5cdFx0XHRcdFx0Zm9yICggdmFyIHYgPSAxLCB2bCA9IHZlcnRpY2VzLmxlbmd0aDsgdiA8IHZsOyB2ICsrICkge1xuXG5cdFx0XHRcdFx0XHR2MSA9IGdldE5leHRWZXJ0ZXhJblBvb2woKTtcblx0XHRcdFx0XHRcdHYxLnBvc2l0aW9uU2NyZWVuLmNvcHkoIHZlcnRpY2VzWyB2IF0gKS5hcHBseU1hdHJpeDQoIF9tb2RlbFZpZXdQcm9qZWN0aW9uTWF0cml4ICk7XG5cblx0XHRcdFx0XHRcdGlmICggKCB2ICsgMSApICUgc3RlcCA+IDAgKSBjb250aW51ZTtcblxuXHRcdFx0XHRcdFx0djIgPSBfdmVydGV4UG9vbFsgX3ZlcnRleENvdW50IC0gMiBdO1xuXG5cdFx0XHRcdFx0XHRfY2xpcHBlZFZlcnRleDFQb3NpdGlvblNjcmVlbi5jb3B5KCB2MS5wb3NpdGlvblNjcmVlbiApO1xuXHRcdFx0XHRcdFx0X2NsaXBwZWRWZXJ0ZXgyUG9zaXRpb25TY3JlZW4uY29weSggdjIucG9zaXRpb25TY3JlZW4gKTtcblxuXHRcdFx0XHRcdFx0aWYgKCBjbGlwTGluZSggX2NsaXBwZWRWZXJ0ZXgxUG9zaXRpb25TY3JlZW4sIF9jbGlwcGVkVmVydGV4MlBvc2l0aW9uU2NyZWVuICkgPT09IHRydWUgKSB7XG5cblx0XHRcdFx0XHRcdFx0Ly8gUGVyZm9ybSB0aGUgcGVyc3BlY3RpdmUgZGl2aWRlXG5cdFx0XHRcdFx0XHRcdF9jbGlwcGVkVmVydGV4MVBvc2l0aW9uU2NyZWVuLm11bHRpcGx5U2NhbGFyKCAxIC8gX2NsaXBwZWRWZXJ0ZXgxUG9zaXRpb25TY3JlZW4udyApO1xuXHRcdFx0XHRcdFx0XHRfY2xpcHBlZFZlcnRleDJQb3NpdGlvblNjcmVlbi5tdWx0aXBseVNjYWxhciggMSAvIF9jbGlwcGVkVmVydGV4MlBvc2l0aW9uU2NyZWVuLncgKTtcblxuXHRcdFx0XHRcdFx0XHRfbGluZSA9IGdldE5leHRMaW5lSW5Qb29sKCk7XG5cblx0XHRcdFx0XHRcdFx0X2xpbmUuaWQgPSBvYmplY3QuaWQ7XG5cdFx0XHRcdFx0XHRcdF9saW5lLnYxLnBvc2l0aW9uU2NyZWVuLmNvcHkoIF9jbGlwcGVkVmVydGV4MVBvc2l0aW9uU2NyZWVuICk7XG5cdFx0XHRcdFx0XHRcdF9saW5lLnYyLnBvc2l0aW9uU2NyZWVuLmNvcHkoIF9jbGlwcGVkVmVydGV4MlBvc2l0aW9uU2NyZWVuICk7XG5cblx0XHRcdFx0XHRcdFx0X2xpbmUueiA9IE1hdGgubWF4KCBfY2xpcHBlZFZlcnRleDFQb3NpdGlvblNjcmVlbi56LCBfY2xpcHBlZFZlcnRleDJQb3NpdGlvblNjcmVlbi56ICk7XG5cdFx0XHRcdFx0XHRcdF9saW5lLnJlbmRlck9yZGVyID0gb2JqZWN0LnJlbmRlck9yZGVyO1xuXG5cdFx0XHRcdFx0XHRcdF9saW5lLm1hdGVyaWFsID0gb2JqZWN0Lm1hdGVyaWFsO1xuXG5cdFx0XHRcdFx0XHRcdGlmICggb2JqZWN0Lm1hdGVyaWFsLnZlcnRleENvbG9ycyA9PT0gVEhSRUUuVmVydGV4Q29sb3JzICkge1xuXG5cdFx0XHRcdFx0XHRcdFx0X2xpbmUudmVydGV4Q29sb3JzWyAwIF0uY29weSggb2JqZWN0Lmdlb21ldHJ5LmNvbG9yc1sgdiBdICk7XG5cdFx0XHRcdFx0XHRcdFx0X2xpbmUudmVydGV4Q29sb3JzWyAxIF0uY29weSggb2JqZWN0Lmdlb21ldHJ5LmNvbG9yc1sgdiAtIDEgXSApO1xuXG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRfcmVuZGVyRGF0YS5lbGVtZW50cy5wdXNoKCBfbGluZSApO1xuXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2UgaWYgKCBvYmplY3QgaW5zdGFuY2VvZiBUSFJFRS5TcHJpdGUgKSB7XG5cblx0XHRcdFx0X3ZlY3RvcjQuc2V0KCBfbW9kZWxNYXRyaXguZWxlbWVudHNbIDEyIF0sIF9tb2RlbE1hdHJpeC5lbGVtZW50c1sgMTMgXSwgX21vZGVsTWF0cml4LmVsZW1lbnRzWyAxNCBdLCAxICk7XG5cdFx0XHRcdF92ZWN0b3I0LmFwcGx5TWF0cml4NCggX3ZpZXdQcm9qZWN0aW9uTWF0cml4ICk7XG5cblx0XHRcdFx0dmFyIGludlcgPSAxIC8gX3ZlY3RvcjQudztcblxuXHRcdFx0XHRfdmVjdG9yNC56ICo9IGludlc7XG5cblx0XHRcdFx0aWYgKCBfdmVjdG9yNC56ID49IC0gMSAmJiBfdmVjdG9yNC56IDw9IDEgKSB7XG5cblx0XHRcdFx0XHRfc3ByaXRlID0gZ2V0TmV4dFNwcml0ZUluUG9vbCgpO1xuXHRcdFx0XHRcdF9zcHJpdGUuaWQgPSBvYmplY3QuaWQ7XG5cdFx0XHRcdFx0X3Nwcml0ZS54ID0gX3ZlY3RvcjQueCAqIGludlc7XG5cdFx0XHRcdFx0X3Nwcml0ZS55ID0gX3ZlY3RvcjQueSAqIGludlc7XG5cdFx0XHRcdFx0X3Nwcml0ZS56ID0gX3ZlY3RvcjQuejtcblx0XHRcdFx0XHRfc3ByaXRlLnJlbmRlck9yZGVyID0gb2JqZWN0LnJlbmRlck9yZGVyO1xuXHRcdFx0XHRcdF9zcHJpdGUub2JqZWN0ID0gb2JqZWN0O1xuXG5cdFx0XHRcdFx0X3Nwcml0ZS5yb3RhdGlvbiA9IG9iamVjdC5yb3RhdGlvbjtcblxuXHRcdFx0XHRcdF9zcHJpdGUuc2NhbGUueCA9IG9iamVjdC5zY2FsZS54ICogTWF0aC5hYnMoIF9zcHJpdGUueCAtICggX3ZlY3RvcjQueCArIGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4LmVsZW1lbnRzWyAwIF0gKSAvICggX3ZlY3RvcjQudyArIGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4LmVsZW1lbnRzWyAxMiBdICkgKTtcblx0XHRcdFx0XHRfc3ByaXRlLnNjYWxlLnkgPSBvYmplY3Quc2NhbGUueSAqIE1hdGguYWJzKCBfc3ByaXRlLnkgLSAoIF92ZWN0b3I0LnkgKyBjYW1lcmEucHJvamVjdGlvbk1hdHJpeC5lbGVtZW50c1sgNSBdICkgLyAoIF92ZWN0b3I0LncgKyBjYW1lcmEucHJvamVjdGlvbk1hdHJpeC5lbGVtZW50c1sgMTMgXSApICk7XG5cblx0XHRcdFx0XHRfc3ByaXRlLm1hdGVyaWFsID0gb2JqZWN0Lm1hdGVyaWFsO1xuXG5cdFx0XHRcdFx0X3JlbmRlckRhdGEuZWxlbWVudHMucHVzaCggX3Nwcml0ZSApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0aWYgKCBzb3J0RWxlbWVudHMgPT09IHRydWUgKSB7XG5cblx0XHRcdF9yZW5kZXJEYXRhLmVsZW1lbnRzLnNvcnQoIHBhaW50ZXJTb3J0ICk7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gX3JlbmRlckRhdGE7XG5cblx0fTtcblxuXHQvLyBQb29sc1xuXG5cdGZ1bmN0aW9uIGdldE5leHRPYmplY3RJblBvb2woKSB7XG5cblx0XHRpZiAoIF9vYmplY3RDb3VudCA9PT0gX29iamVjdFBvb2xMZW5ndGggKSB7XG5cblx0XHRcdHZhciBvYmplY3QgPSBuZXcgVEhSRUUuUmVuZGVyYWJsZU9iamVjdCgpO1xuXHRcdFx0X29iamVjdFBvb2wucHVzaCggb2JqZWN0ICk7XG5cdFx0XHRfb2JqZWN0UG9vbExlbmd0aCArKztcblx0XHRcdF9vYmplY3RDb3VudCArKztcblx0XHRcdHJldHVybiBvYmplY3Q7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gX29iamVjdFBvb2xbIF9vYmplY3RDb3VudCArKyBdO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBnZXROZXh0VmVydGV4SW5Qb29sKCkge1xuXG5cdFx0aWYgKCBfdmVydGV4Q291bnQgPT09IF92ZXJ0ZXhQb29sTGVuZ3RoICkge1xuXG5cdFx0XHR2YXIgdmVydGV4ID0gbmV3IFRIUkVFLlJlbmRlcmFibGVWZXJ0ZXgoKTtcblx0XHRcdF92ZXJ0ZXhQb29sLnB1c2goIHZlcnRleCApO1xuXHRcdFx0X3ZlcnRleFBvb2xMZW5ndGggKys7XG5cdFx0XHRfdmVydGV4Q291bnQgKys7XG5cdFx0XHRyZXR1cm4gdmVydGV4O1xuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIF92ZXJ0ZXhQb29sWyBfdmVydGV4Q291bnQgKysgXTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0TmV4dEZhY2VJblBvb2woKSB7XG5cblx0XHRpZiAoIF9mYWNlQ291bnQgPT09IF9mYWNlUG9vbExlbmd0aCApIHtcblxuXHRcdFx0dmFyIGZhY2UgPSBuZXcgVEhSRUUuUmVuZGVyYWJsZUZhY2UoKTtcblx0XHRcdF9mYWNlUG9vbC5wdXNoKCBmYWNlICk7XG5cdFx0XHRfZmFjZVBvb2xMZW5ndGggKys7XG5cdFx0XHRfZmFjZUNvdW50ICsrO1xuXHRcdFx0cmV0dXJuIGZhY2U7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gX2ZhY2VQb29sWyBfZmFjZUNvdW50ICsrIF07XG5cblxuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0TmV4dExpbmVJblBvb2woKSB7XG5cblx0XHRpZiAoIF9saW5lQ291bnQgPT09IF9saW5lUG9vbExlbmd0aCApIHtcblxuXHRcdFx0dmFyIGxpbmUgPSBuZXcgVEhSRUUuUmVuZGVyYWJsZUxpbmUoKTtcblx0XHRcdF9saW5lUG9vbC5wdXNoKCBsaW5lICk7XG5cdFx0XHRfbGluZVBvb2xMZW5ndGggKys7XG5cdFx0XHRfbGluZUNvdW50ICsrO1xuXHRcdFx0cmV0dXJuIGxpbmU7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gX2xpbmVQb29sWyBfbGluZUNvdW50ICsrIF07XG5cblx0fVxuXG5cdGZ1bmN0aW9uIGdldE5leHRTcHJpdGVJblBvb2woKSB7XG5cblx0XHRpZiAoIF9zcHJpdGVDb3VudCA9PT0gX3Nwcml0ZVBvb2xMZW5ndGggKSB7XG5cblx0XHRcdHZhciBzcHJpdGUgPSBuZXcgVEhSRUUuUmVuZGVyYWJsZVNwcml0ZSgpO1xuXHRcdFx0X3Nwcml0ZVBvb2wucHVzaCggc3ByaXRlICk7XG5cdFx0XHRfc3ByaXRlUG9vbExlbmd0aCArKztcblx0XHRcdF9zcHJpdGVDb3VudCArKztcblx0XHRcdHJldHVybiBzcHJpdGU7XG5cblx0XHR9XG5cblx0XHRyZXR1cm4gX3Nwcml0ZVBvb2xbIF9zcHJpdGVDb3VudCArKyBdO1xuXG5cdH1cblxuXHQvL1xuXG5cdGZ1bmN0aW9uIHBhaW50ZXJTb3J0KCBhLCBiICkge1xuXG5cdFx0aWYgKCBhLnJlbmRlck9yZGVyICE9PSBiLnJlbmRlck9yZGVyICkge1xuXG5cdFx0XHRyZXR1cm4gYS5yZW5kZXJPcmRlciAtIGIucmVuZGVyT3JkZXI7XG5cblx0XHR9IGVsc2UgaWYgKCBhLnogIT09IGIueiApIHtcblxuXHRcdFx0cmV0dXJuIGIueiAtIGEuejtcblxuXHRcdH0gZWxzZSBpZiAoIGEuaWQgIT09IGIuaWQgKSB7XG5cblx0XHRcdHJldHVybiBhLmlkIC0gYi5pZDtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHJldHVybiAwO1xuXG5cdFx0fVxuXG5cdH1cblxuXHRmdW5jdGlvbiBjbGlwTGluZSggczEsIHMyICkge1xuXG5cdFx0dmFyIGFscGhhMSA9IDAsIGFscGhhMiA9IDEsXG5cblx0XHQvLyBDYWxjdWxhdGUgdGhlIGJvdW5kYXJ5IGNvb3JkaW5hdGUgb2YgZWFjaCB2ZXJ0ZXggZm9yIHRoZSBuZWFyIGFuZCBmYXIgY2xpcCBwbGFuZXMsXG5cdFx0Ly8gWiA9IC0xIGFuZCBaID0gKzEsIHJlc3BlY3RpdmVseS5cblx0XHRiYzFuZWFyID0gIHMxLnogKyBzMS53LFxuXHRcdGJjMm5lYXIgPSAgczIueiArIHMyLncsXG5cdFx0YmMxZmFyID0gIC0gczEueiArIHMxLncsXG5cdFx0YmMyZmFyID0gIC0gczIueiArIHMyLnc7XG5cblx0XHRpZiAoIGJjMW5lYXIgPj0gMCAmJiBiYzJuZWFyID49IDAgJiYgYmMxZmFyID49IDAgJiYgYmMyZmFyID49IDAgKSB7XG5cblx0XHRcdC8vIEJvdGggdmVydGljZXMgbGllIGVudGlyZWx5IHdpdGhpbiBhbGwgY2xpcCBwbGFuZXMuXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblxuXHRcdH0gZWxzZSBpZiAoICggYmMxbmVhciA8IDAgJiYgYmMybmVhciA8IDAgKSB8fCAoIGJjMWZhciA8IDAgJiYgYmMyZmFyIDwgMCApICkge1xuXG5cdFx0XHQvLyBCb3RoIHZlcnRpY2VzIGxpZSBlbnRpcmVseSBvdXRzaWRlIG9uZSBvZiB0aGUgY2xpcCBwbGFuZXMuXG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHQvLyBUaGUgbGluZSBzZWdtZW50IHNwYW5zIGF0IGxlYXN0IG9uZSBjbGlwIHBsYW5lLlxuXG5cdFx0XHRpZiAoIGJjMW5lYXIgPCAwICkge1xuXG5cdFx0XHRcdC8vIHYxIGxpZXMgb3V0c2lkZSB0aGUgbmVhciBwbGFuZSwgdjIgaW5zaWRlXG5cdFx0XHRcdGFscGhhMSA9IE1hdGgubWF4KCBhbHBoYTEsIGJjMW5lYXIgLyAoIGJjMW5lYXIgLSBiYzJuZWFyICkgKTtcblxuXHRcdFx0fSBlbHNlIGlmICggYmMybmVhciA8IDAgKSB7XG5cblx0XHRcdFx0Ly8gdjIgbGllcyBvdXRzaWRlIHRoZSBuZWFyIHBsYW5lLCB2MSBpbnNpZGVcblx0XHRcdFx0YWxwaGEyID0gTWF0aC5taW4oIGFscGhhMiwgYmMxbmVhciAvICggYmMxbmVhciAtIGJjMm5lYXIgKSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggYmMxZmFyIDwgMCApIHtcblxuXHRcdFx0XHQvLyB2MSBsaWVzIG91dHNpZGUgdGhlIGZhciBwbGFuZSwgdjIgaW5zaWRlXG5cdFx0XHRcdGFscGhhMSA9IE1hdGgubWF4KCBhbHBoYTEsIGJjMWZhciAvICggYmMxZmFyIC0gYmMyZmFyICkgKTtcblxuXHRcdFx0fSBlbHNlIGlmICggYmMyZmFyIDwgMCApIHtcblxuXHRcdFx0XHQvLyB2MiBsaWVzIG91dHNpZGUgdGhlIGZhciBwbGFuZSwgdjIgaW5zaWRlXG5cdFx0XHRcdGFscGhhMiA9IE1hdGgubWluKCBhbHBoYTIsIGJjMWZhciAvICggYmMxZmFyIC0gYmMyZmFyICkgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIGFscGhhMiA8IGFscGhhMSApIHtcblxuXHRcdFx0XHQvLyBUaGUgbGluZSBzZWdtZW50IHNwYW5zIHR3byBib3VuZGFyaWVzLCBidXQgaXMgb3V0c2lkZSBib3RoIG9mIHRoZW0uXG5cdFx0XHRcdC8vIChUaGlzIGNhbid0IGhhcHBlbiB3aGVuIHdlJ3JlIG9ubHkgY2xpcHBpbmcgYWdhaW5zdCBqdXN0IG5lYXIvZmFyIGJ1dCBnb29kXG5cdFx0XHRcdC8vICB0byBsZWF2ZSB0aGUgY2hlY2sgaGVyZSBmb3IgZnV0dXJlIHVzYWdlIGlmIG90aGVyIGNsaXAgcGxhbmVzIGFyZSBhZGRlZC4pXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHMxIGFuZCBzMiB2ZXJ0aWNlcyB0byBtYXRjaCB0aGUgY2xpcHBlZCBsaW5lIHNlZ21lbnQuXG5cdFx0XHRcdHMxLmxlcnAoIHMyLCBhbHBoYTEgKTtcblx0XHRcdFx0czIubGVycCggczEsIDEgLSBhbHBoYTIgKTtcblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdH1cblxufTtcbiIsIi8qKlxuICogQGF1dGhvciBhbHRlcmVkcSAvIGh0dHA6Ly9hbHRlcmVkcXVhbGlhLmNvbS9cbiAqL1xuXG5USFJFRS5CbG9vbVBhc3MgPSBmdW5jdGlvbiAoIHN0cmVuZ3RoLCBrZXJuZWxTaXplLCBzaWdtYSwgcmVzb2x1dGlvbiApIHtcblxuXHRUSFJFRS5QYXNzLmNhbGwoIHRoaXMgKTtcblxuXHRzdHJlbmd0aCA9ICggc3RyZW5ndGggIT09IHVuZGVmaW5lZCApID8gc3RyZW5ndGggOiAxO1xuXHRrZXJuZWxTaXplID0gKCBrZXJuZWxTaXplICE9PSB1bmRlZmluZWQgKSA/IGtlcm5lbFNpemUgOiAyNTtcblx0c2lnbWEgPSAoIHNpZ21hICE9PSB1bmRlZmluZWQgKSA/IHNpZ21hIDogNC4wO1xuXHRyZXNvbHV0aW9uID0gKCByZXNvbHV0aW9uICE9PSB1bmRlZmluZWQgKSA/IHJlc29sdXRpb24gOiAyNTY7XG5cblx0Ly8gcmVuZGVyIHRhcmdldHNcblxuXHR2YXIgcGFycyA9IHsgbWluRmlsdGVyOiBUSFJFRS5MaW5lYXJGaWx0ZXIsIG1hZ0ZpbHRlcjogVEhSRUUuTGluZWFyRmlsdGVyLCBmb3JtYXQ6IFRIUkVFLlJHQkFGb3JtYXQgfTtcblxuXHR0aGlzLnJlbmRlclRhcmdldFggPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJUYXJnZXQoIHJlc29sdXRpb24sIHJlc29sdXRpb24sIHBhcnMgKTtcblx0dGhpcy5yZW5kZXJUYXJnZXRZID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0KCByZXNvbHV0aW9uLCByZXNvbHV0aW9uLCBwYXJzICk7XG5cblx0Ly8gY29weSBtYXRlcmlhbFxuXG5cdGlmICggVEhSRUUuQ29weVNoYWRlciA9PT0gdW5kZWZpbmVkIClcblx0XHRjb25zb2xlLmVycm9yKCBcIlRIUkVFLkJsb29tUGFzcyByZWxpZXMgb24gVEhSRUUuQ29weVNoYWRlclwiICk7XG5cblx0dmFyIGNvcHlTaGFkZXIgPSBUSFJFRS5Db3B5U2hhZGVyO1xuXG5cdHRoaXMuY29weVVuaWZvcm1zID0gVEhSRUUuVW5pZm9ybXNVdGlscy5jbG9uZSggY29weVNoYWRlci51bmlmb3JtcyApO1xuXG5cdHRoaXMuY29weVVuaWZvcm1zWyBcIm9wYWNpdHlcIiBdLnZhbHVlID0gc3RyZW5ndGg7XG5cblx0dGhpcy5tYXRlcmlhbENvcHkgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoIHtcblxuXHRcdHVuaWZvcm1zOiB0aGlzLmNvcHlVbmlmb3Jtcyxcblx0XHR2ZXJ0ZXhTaGFkZXI6IGNvcHlTaGFkZXIudmVydGV4U2hhZGVyLFxuXHRcdGZyYWdtZW50U2hhZGVyOiBjb3B5U2hhZGVyLmZyYWdtZW50U2hhZGVyLFxuXHRcdGJsZW5kaW5nOiBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nLFxuXHRcdHRyYW5zcGFyZW50OiB0cnVlXG5cblx0fSApO1xuXG5cdC8vIGNvbnZvbHV0aW9uIG1hdGVyaWFsXG5cblx0aWYgKCBUSFJFRS5Db252b2x1dGlvblNoYWRlciA9PT0gdW5kZWZpbmVkIClcblx0XHRjb25zb2xlLmVycm9yKCBcIlRIUkVFLkJsb29tUGFzcyByZWxpZXMgb24gVEhSRUUuQ29udm9sdXRpb25TaGFkZXJcIiApO1xuXG5cdHZhciBjb252b2x1dGlvblNoYWRlciA9IFRIUkVFLkNvbnZvbHV0aW9uU2hhZGVyO1xuXG5cdHRoaXMuY29udm9sdXRpb25Vbmlmb3JtcyA9IFRIUkVFLlVuaWZvcm1zVXRpbHMuY2xvbmUoIGNvbnZvbHV0aW9uU2hhZGVyLnVuaWZvcm1zICk7XG5cblx0dGhpcy5jb252b2x1dGlvblVuaWZvcm1zWyBcInVJbWFnZUluY3JlbWVudFwiIF0udmFsdWUgPSBUSFJFRS5CbG9vbVBhc3MuYmx1clg7XG5cdHRoaXMuY29udm9sdXRpb25Vbmlmb3Jtc1sgXCJjS2VybmVsXCIgXS52YWx1ZSA9IFRIUkVFLkNvbnZvbHV0aW9uU2hhZGVyLmJ1aWxkS2VybmVsKCBzaWdtYSApO1xuXG5cdHRoaXMubWF0ZXJpYWxDb252b2x1dGlvbiA9IG5ldyBUSFJFRS5TaGFkZXJNYXRlcmlhbCgge1xuXG5cdFx0dW5pZm9ybXM6IHRoaXMuY29udm9sdXRpb25Vbmlmb3Jtcyxcblx0XHR2ZXJ0ZXhTaGFkZXI6ICBjb252b2x1dGlvblNoYWRlci52ZXJ0ZXhTaGFkZXIsXG5cdFx0ZnJhZ21lbnRTaGFkZXI6IGNvbnZvbHV0aW9uU2hhZGVyLmZyYWdtZW50U2hhZGVyLFxuXHRcdGRlZmluZXM6IHtcblx0XHRcdFwiS0VSTkVMX1NJWkVfRkxPQVRcIjoga2VybmVsU2l6ZS50b0ZpeGVkKCAxICksXG5cdFx0XHRcIktFUk5FTF9TSVpFX0lOVFwiOiBrZXJuZWxTaXplLnRvRml4ZWQoIDAgKVxuXHRcdH1cblxuXHR9ICk7XG5cblx0dGhpcy5uZWVkc1N3YXAgPSBmYWxzZTtcblxuXHR0aGlzLmNhbWVyYSA9IG5ldyBUSFJFRS5PcnRob2dyYXBoaWNDYW1lcmEoIC0gMSwgMSwgMSwgLSAxLCAwLCAxICk7XG5cdHRoaXMuc2NlbmUgID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cblx0dGhpcy5xdWFkID0gbmV3IFRIUkVFLk1lc2goIG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KCAyLCAyICksIG51bGwgKTtcblx0dGhpcy5zY2VuZS5hZGQoIHRoaXMucXVhZCApO1xuXG59O1xuXG5USFJFRS5CbG9vbVBhc3MucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbiggT2JqZWN0LmNyZWF0ZSggVEhSRUUuUGFzcy5wcm90b3R5cGUgKSwge1xuXG5cdGNvbnN0cnVjdG9yOiBUSFJFRS5CbG9vbVBhc3MsXG5cblx0cmVuZGVyOiBmdW5jdGlvbiAoIHJlbmRlcmVyLCB3cml0ZUJ1ZmZlciwgcmVhZEJ1ZmZlciwgZGVsdGEsIG1hc2tBY3RpdmUgKSB7XG5cblx0XHRpZiAoIG1hc2tBY3RpdmUgKSByZW5kZXJlci5jb250ZXh0LmRpc2FibGUoIHJlbmRlcmVyLmNvbnRleHQuU1RFTkNJTF9URVNUICk7XG5cblx0XHQvLyBSZW5kZXIgcXVhZCB3aXRoIGJsdXJlZCBzY2VuZSBpbnRvIHRleHR1cmUgKGNvbnZvbHV0aW9uIHBhc3MgMSlcblxuXHRcdHRoaXMucXVhZC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWxDb252b2x1dGlvbjtcblxuXHRcdHRoaXMuY29udm9sdXRpb25Vbmlmb3Jtc1sgXCJ0RGlmZnVzZVwiIF0udmFsdWUgPSByZWFkQnVmZmVyLnRleHR1cmU7XG5cdFx0dGhpcy5jb252b2x1dGlvblVuaWZvcm1zWyBcInVJbWFnZUluY3JlbWVudFwiIF0udmFsdWUgPSBUSFJFRS5CbG9vbVBhc3MuYmx1clg7XG5cblx0XHRyZW5kZXJlci5yZW5kZXIoIHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhLCB0aGlzLnJlbmRlclRhcmdldFgsIHRydWUgKTtcblxuXG5cdFx0Ly8gUmVuZGVyIHF1YWQgd2l0aCBibHVyZWQgc2NlbmUgaW50byB0ZXh0dXJlIChjb252b2x1dGlvbiBwYXNzIDIpXG5cblx0XHR0aGlzLmNvbnZvbHV0aW9uVW5pZm9ybXNbIFwidERpZmZ1c2VcIiBdLnZhbHVlID0gdGhpcy5yZW5kZXJUYXJnZXRYLnRleHR1cmU7XG5cdFx0dGhpcy5jb252b2x1dGlvblVuaWZvcm1zWyBcInVJbWFnZUluY3JlbWVudFwiIF0udmFsdWUgPSBUSFJFRS5CbG9vbVBhc3MuYmx1clk7XG5cblx0XHRyZW5kZXJlci5yZW5kZXIoIHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhLCB0aGlzLnJlbmRlclRhcmdldFksIHRydWUgKTtcblxuXHRcdC8vIFJlbmRlciBvcmlnaW5hbCBzY2VuZSB3aXRoIHN1cGVyaW1wb3NlZCBibHVyIHRvIHRleHR1cmVcblxuXHRcdHRoaXMucXVhZC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWxDb3B5O1xuXG5cdFx0dGhpcy5jb3B5VW5pZm9ybXNbIFwidERpZmZ1c2VcIiBdLnZhbHVlID0gdGhpcy5yZW5kZXJUYXJnZXRZLnRleHR1cmU7XG5cblx0XHRpZiAoIG1hc2tBY3RpdmUgKSByZW5kZXJlci5jb250ZXh0LmVuYWJsZSggcmVuZGVyZXIuY29udGV4dC5TVEVOQ0lMX1RFU1QgKTtcblxuXHRcdHJlbmRlcmVyLnJlbmRlciggdGhpcy5zY2VuZSwgdGhpcy5jYW1lcmEsIHJlYWRCdWZmZXIsIHRoaXMuY2xlYXIgKTtcblxuXHR9XG5cbn0gKTtcblxuVEhSRUUuQmxvb21QYXNzLmJsdXJYID0gbmV3IFRIUkVFLlZlY3RvcjIoIDAuMDAxOTUzMTI1LCAwLjAgKTtcblRIUkVFLkJsb29tUGFzcy5ibHVyWSA9IG5ldyBUSFJFRS5WZWN0b3IyKCAwLjAsIDAuMDAxOTUzMTI1ICk7XG4iLCIvKipcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb20vXG4gKi9cblxuVEhSRUUuQ2xlYXJQYXNzID0gZnVuY3Rpb24gKCBjbGVhckNvbG9yLCBjbGVhckFscGhhICkge1xuXG5cdFRIUkVFLlBhc3MuY2FsbCggdGhpcyApO1xuXG5cdHRoaXMubmVlZHNTd2FwID0gZmFsc2U7XG5cblx0dGhpcy5jbGVhckNvbG9yID0gKCBjbGVhckNvbG9yICE9PSB1bmRlZmluZWQgKSA/IGNsZWFyQ29sb3IgOiAweDAwMDAwMDtcblx0dGhpcy5jbGVhckFscGhhID0gKCBjbGVhckFscGhhICE9PSB1bmRlZmluZWQgKSA/IGNsZWFyQWxwaGEgOiAwO1xuXG59O1xuXG5USFJFRS5DbGVhclBhc3MucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbiggT2JqZWN0LmNyZWF0ZSggVEhSRUUuUGFzcy5wcm90b3R5cGUgKSwge1xuXG5cdGNvbnN0cnVjdG9yOiBUSFJFRS5DbGVhclBhc3MsXG5cblx0cmVuZGVyOiBmdW5jdGlvbiAoIHJlbmRlcmVyLCB3cml0ZUJ1ZmZlciwgcmVhZEJ1ZmZlciwgZGVsdGEsIG1hc2tBY3RpdmUgKSB7XG5cblx0XHR2YXIgb2xkQ2xlYXJDb2xvciwgb2xkQ2xlYXJBbHBoYTtcblxuXHRcdGlmICggdGhpcy5jbGVhckNvbG9yICkge1xuXG5cdFx0XHRvbGRDbGVhckNvbG9yID0gcmVuZGVyZXIuZ2V0Q2xlYXJDb2xvcigpLmdldEhleCgpO1xuXHRcdFx0b2xkQ2xlYXJBbHBoYSA9IHJlbmRlcmVyLmdldENsZWFyQWxwaGEoKTtcblxuXHRcdFx0cmVuZGVyZXIuc2V0Q2xlYXJDb2xvciggdGhpcy5jbGVhckNvbG9yLCB0aGlzLmNsZWFyQWxwaGEgKTtcblxuXHRcdH1cblxuXHRcdHJlbmRlcmVyLnNldFJlbmRlclRhcmdldCggdGhpcy5yZW5kZXJUb1NjcmVlbiA/IG51bGwgOiByZWFkQnVmZmVyICk7XG5cdFx0cmVuZGVyZXIuY2xlYXIoKTtcblxuXHRcdGlmICggdGhpcy5jbGVhckNvbG9yICkge1xuXG5cdFx0XHRyZW5kZXJlci5zZXRDbGVhckNvbG9yKCBvbGRDbGVhckNvbG9yLCBvbGRDbGVhckFscGhhICk7XG5cblx0XHR9XG5cblx0fVxuXG59ICk7XG4iLCIvKipcbiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vXG4gKi9cblxuVEhSRUUuRWZmZWN0Q29tcG9zZXIgPSBmdW5jdGlvbiAoIHJlbmRlcmVyLCByZW5kZXJUYXJnZXQgKSB7XG5cblx0dGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuXG5cdGlmICggcmVuZGVyVGFyZ2V0ID09PSB1bmRlZmluZWQgKSB7XG5cblx0XHR2YXIgcGFyYW1ldGVycyA9IHtcblx0XHRcdG1pbkZpbHRlcjogVEhSRUUuTGluZWFyRmlsdGVyLFxuXHRcdFx0bWFnRmlsdGVyOiBUSFJFRS5MaW5lYXJGaWx0ZXIsXG5cdFx0XHRmb3JtYXQ6IFRIUkVFLlJHQkFGb3JtYXQsXG5cdFx0XHRzdGVuY2lsQnVmZmVyOiBmYWxzZVxuXHRcdH07XG5cdFx0dmFyIHNpemUgPSByZW5kZXJlci5nZXRTaXplKCk7XG5cdFx0cmVuZGVyVGFyZ2V0ID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyVGFyZ2V0KCBzaXplLndpZHRoLCBzaXplLmhlaWdodCwgcGFyYW1ldGVycyApO1xuXG5cdH1cblxuXHR0aGlzLnJlbmRlclRhcmdldDEgPSByZW5kZXJUYXJnZXQ7XG5cdHRoaXMucmVuZGVyVGFyZ2V0MiA9IHJlbmRlclRhcmdldC5jbG9uZSgpO1xuXG5cdHRoaXMud3JpdGVCdWZmZXIgPSB0aGlzLnJlbmRlclRhcmdldDE7XG5cdHRoaXMucmVhZEJ1ZmZlciA9IHRoaXMucmVuZGVyVGFyZ2V0MjtcblxuXHR0aGlzLnBhc3NlcyA9IFtdO1xuXG5cdGlmICggVEhSRUUuQ29weVNoYWRlciA9PT0gdW5kZWZpbmVkIClcblx0XHRjb25zb2xlLmVycm9yKCBcIlRIUkVFLkVmZmVjdENvbXBvc2VyIHJlbGllcyBvbiBUSFJFRS5Db3B5U2hhZGVyXCIgKTtcblxuXHR0aGlzLmNvcHlQYXNzID0gbmV3IFRIUkVFLlNoYWRlclBhc3MoIFRIUkVFLkNvcHlTaGFkZXIgKTtcblxufTtcblxuT2JqZWN0LmFzc2lnbiggVEhSRUUuRWZmZWN0Q29tcG9zZXIucHJvdG90eXBlLCB7XG5cblx0c3dhcEJ1ZmZlcnM6IGZ1bmN0aW9uKCkge1xuXG5cdFx0dmFyIHRtcCA9IHRoaXMucmVhZEJ1ZmZlcjtcblx0XHR0aGlzLnJlYWRCdWZmZXIgPSB0aGlzLndyaXRlQnVmZmVyO1xuXHRcdHRoaXMud3JpdGVCdWZmZXIgPSB0bXA7XG5cblx0fSxcblxuXHRhZGRQYXNzOiBmdW5jdGlvbiAoIHBhc3MgKSB7XG5cblx0XHR0aGlzLnBhc3Nlcy5wdXNoKCBwYXNzICk7XG5cblx0XHR2YXIgc2l6ZSA9IHRoaXMucmVuZGVyZXIuZ2V0U2l6ZSgpO1xuXHRcdHBhc3Muc2V0U2l6ZSggc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQgKTtcblxuXHR9LFxuXG5cdGluc2VydFBhc3M6IGZ1bmN0aW9uICggcGFzcywgaW5kZXggKSB7XG5cblx0XHR0aGlzLnBhc3Nlcy5zcGxpY2UoIGluZGV4LCAwLCBwYXNzICk7XG5cblx0fSxcblxuXHRyZW5kZXI6IGZ1bmN0aW9uICggZGVsdGEgKSB7XG5cblx0XHR2YXIgbWFza0FjdGl2ZSA9IGZhbHNlO1xuXG5cdFx0dmFyIHBhc3MsIGksIGlsID0gdGhpcy5wYXNzZXMubGVuZ3RoO1xuXG5cdFx0Zm9yICggaSA9IDA7IGkgPCBpbDsgaSArKyApIHtcblxuXHRcdFx0cGFzcyA9IHRoaXMucGFzc2VzWyBpIF07XG5cblx0XHRcdGlmICggcGFzcy5lbmFibGVkID09PSBmYWxzZSApIGNvbnRpbnVlO1xuXG5cdFx0XHRwYXNzLnJlbmRlciggdGhpcy5yZW5kZXJlciwgdGhpcy53cml0ZUJ1ZmZlciwgdGhpcy5yZWFkQnVmZmVyLCBkZWx0YSwgbWFza0FjdGl2ZSApO1xuXG5cdFx0XHRpZiAoIHBhc3MubmVlZHNTd2FwICkge1xuXG5cdFx0XHRcdGlmICggbWFza0FjdGl2ZSApIHtcblxuXHRcdFx0XHRcdHZhciBjb250ZXh0ID0gdGhpcy5yZW5kZXJlci5jb250ZXh0O1xuXG5cdFx0XHRcdFx0Y29udGV4dC5zdGVuY2lsRnVuYyggY29udGV4dC5OT1RFUVVBTCwgMSwgMHhmZmZmZmZmZiApO1xuXG5cdFx0XHRcdFx0dGhpcy5jb3B5UGFzcy5yZW5kZXIoIHRoaXMucmVuZGVyZXIsIHRoaXMud3JpdGVCdWZmZXIsIHRoaXMucmVhZEJ1ZmZlciwgZGVsdGEgKTtcblxuXHRcdFx0XHRcdGNvbnRleHQuc3RlbmNpbEZ1bmMoIGNvbnRleHQuRVFVQUwsIDEsIDB4ZmZmZmZmZmYgKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5zd2FwQnVmZmVycygpO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggVEhSRUUuTWFza1Bhc3MgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRpZiAoIHBhc3MgaW5zdGFuY2VvZiBUSFJFRS5NYXNrUGFzcyApIHtcblxuXHRcdFx0XHRcdG1hc2tBY3RpdmUgPSB0cnVlO1xuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIHBhc3MgaW5zdGFuY2VvZiBUSFJFRS5DbGVhck1hc2tQYXNzICkge1xuXG5cdFx0XHRcdFx0bWFza0FjdGl2ZSA9IGZhbHNlO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdH0sXG5cblx0cmVzZXQ6IGZ1bmN0aW9uICggcmVuZGVyVGFyZ2V0ICkge1xuXG5cdFx0aWYgKCByZW5kZXJUYXJnZXQgPT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0dmFyIHNpemUgPSB0aGlzLnJlbmRlcmVyLmdldFNpemUoKTtcblxuXHRcdFx0cmVuZGVyVGFyZ2V0ID0gdGhpcy5yZW5kZXJUYXJnZXQxLmNsb25lKCk7XG5cdFx0XHRyZW5kZXJUYXJnZXQuc2V0U2l6ZSggc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQgKTtcblxuXHRcdH1cblxuXHRcdHRoaXMucmVuZGVyVGFyZ2V0MS5kaXNwb3NlKCk7XG5cdFx0dGhpcy5yZW5kZXJUYXJnZXQyLmRpc3Bvc2UoKTtcblx0XHR0aGlzLnJlbmRlclRhcmdldDEgPSByZW5kZXJUYXJnZXQ7XG5cdFx0dGhpcy5yZW5kZXJUYXJnZXQyID0gcmVuZGVyVGFyZ2V0LmNsb25lKCk7XG5cblx0XHR0aGlzLndyaXRlQnVmZmVyID0gdGhpcy5yZW5kZXJUYXJnZXQxO1xuXHRcdHRoaXMucmVhZEJ1ZmZlciA9IHRoaXMucmVuZGVyVGFyZ2V0MjtcblxuXHR9LFxuXG5cdHNldFNpemU6IGZ1bmN0aW9uICggd2lkdGgsIGhlaWdodCApIHtcblxuXHRcdHRoaXMucmVuZGVyVGFyZ2V0MS5zZXRTaXplKCB3aWR0aCwgaGVpZ2h0ICk7XG5cdFx0dGhpcy5yZW5kZXJUYXJnZXQyLnNldFNpemUoIHdpZHRoLCBoZWlnaHQgKTtcblxuXHRcdGZvciAoIHZhciBpID0gMDsgaSA8IHRoaXMucGFzc2VzLmxlbmd0aDsgaSArKyApIHtcblxuXHRcdFx0dGhpcy5wYXNzZXNbaV0uc2V0U2l6ZSggd2lkdGgsIGhlaWdodCApO1xuXG5cdFx0fVxuXG5cdH1cblxufSApO1xuXG5cblRIUkVFLlBhc3MgPSBmdW5jdGlvbiAoKSB7XG5cblx0Ly8gaWYgc2V0IHRvIHRydWUsIHRoZSBwYXNzIGlzIHByb2Nlc3NlZCBieSB0aGUgY29tcG9zZXJcblx0dGhpcy5lbmFibGVkID0gdHJ1ZTtcblxuXHQvLyBpZiBzZXQgdG8gdHJ1ZSwgdGhlIHBhc3MgaW5kaWNhdGVzIHRvIHN3YXAgcmVhZCBhbmQgd3JpdGUgYnVmZmVyIGFmdGVyIHJlbmRlcmluZ1xuXHR0aGlzLm5lZWRzU3dhcCA9IHRydWU7XG5cblx0Ly8gaWYgc2V0IHRvIHRydWUsIHRoZSBwYXNzIGNsZWFycyBpdHMgYnVmZmVyIGJlZm9yZSByZW5kZXJpbmdcblx0dGhpcy5jbGVhciA9IGZhbHNlO1xuXG5cdC8vIGlmIHNldCB0byB0cnVlLCB0aGUgcmVzdWx0IG9mIHRoZSBwYXNzIGlzIHJlbmRlcmVkIHRvIHNjcmVlblxuXHR0aGlzLnJlbmRlclRvU2NyZWVuID0gZmFsc2U7XG5cbn07XG5cbk9iamVjdC5hc3NpZ24oIFRIUkVFLlBhc3MucHJvdG90eXBlLCB7XG5cblx0c2V0U2l6ZTogZnVuY3Rpb24oIHdpZHRoLCBoZWlnaHQgKSB7fSxcblxuXHRyZW5kZXI6IGZ1bmN0aW9uICggcmVuZGVyZXIsIHdyaXRlQnVmZmVyLCByZWFkQnVmZmVyLCBkZWx0YSwgbWFza0FjdGl2ZSApIHtcblxuXHRcdGNvbnNvbGUuZXJyb3IoIFwiVEhSRUUuUGFzczogLnJlbmRlcigpIG11c3QgYmUgaW1wbGVtZW50ZWQgaW4gZGVyaXZlZCBwYXNzLlwiICk7XG5cblx0fVxuXG59ICk7XG4iLCIvKipcbiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vXG4gKi9cblxuVEhSRUUuTWFza1Bhc3MgPSBmdW5jdGlvbiAoIHNjZW5lLCBjYW1lcmEgKSB7XG5cblx0VEhSRUUuUGFzcy5jYWxsKCB0aGlzICk7XG5cblx0dGhpcy5zY2VuZSA9IHNjZW5lO1xuXHR0aGlzLmNhbWVyYSA9IGNhbWVyYTtcblxuXHR0aGlzLmNsZWFyID0gdHJ1ZTtcblx0dGhpcy5uZWVkc1N3YXAgPSBmYWxzZTtcblxuXHR0aGlzLmludmVyc2UgPSBmYWxzZTtcblxufTtcblxuVEhSRUUuTWFza1Bhc3MucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbiggT2JqZWN0LmNyZWF0ZSggVEhSRUUuUGFzcy5wcm90b3R5cGUgKSwge1xuXG5cdGNvbnN0cnVjdG9yOiBUSFJFRS5NYXNrUGFzcyxcblxuXHRyZW5kZXI6IGZ1bmN0aW9uICggcmVuZGVyZXIsIHdyaXRlQnVmZmVyLCByZWFkQnVmZmVyLCBkZWx0YSwgbWFza0FjdGl2ZSApIHtcblxuXHRcdHZhciBjb250ZXh0ID0gcmVuZGVyZXIuY29udGV4dDtcblx0XHR2YXIgc3RhdGUgPSByZW5kZXJlci5zdGF0ZTtcblxuXHRcdC8vIGRvbid0IHVwZGF0ZSBjb2xvciBvciBkZXB0aFxuXG5cdFx0c3RhdGUuYnVmZmVycy5jb2xvci5zZXRNYXNrKCBmYWxzZSApO1xuXHRcdHN0YXRlLmJ1ZmZlcnMuZGVwdGguc2V0TWFzayggZmFsc2UgKTtcblxuXHRcdC8vIGxvY2sgYnVmZmVyc1xuXG5cdFx0c3RhdGUuYnVmZmVycy5jb2xvci5zZXRMb2NrZWQoIHRydWUgKTtcblx0XHRzdGF0ZS5idWZmZXJzLmRlcHRoLnNldExvY2tlZCggdHJ1ZSApO1xuXG5cdFx0Ly8gc2V0IHVwIHN0ZW5jaWxcblxuXHRcdHZhciB3cml0ZVZhbHVlLCBjbGVhclZhbHVlO1xuXG5cdFx0aWYgKCB0aGlzLmludmVyc2UgKSB7XG5cblx0XHRcdHdyaXRlVmFsdWUgPSAwO1xuXHRcdFx0Y2xlYXJWYWx1ZSA9IDE7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHR3cml0ZVZhbHVlID0gMTtcblx0XHRcdGNsZWFyVmFsdWUgPSAwO1xuXG5cdFx0fVxuXG5cdFx0c3RhdGUuYnVmZmVycy5zdGVuY2lsLnNldFRlc3QoIHRydWUgKTtcblx0XHRzdGF0ZS5idWZmZXJzLnN0ZW5jaWwuc2V0T3AoIGNvbnRleHQuUkVQTEFDRSwgY29udGV4dC5SRVBMQUNFLCBjb250ZXh0LlJFUExBQ0UgKTtcblx0XHRzdGF0ZS5idWZmZXJzLnN0ZW5jaWwuc2V0RnVuYyggY29udGV4dC5BTFdBWVMsIHdyaXRlVmFsdWUsIDB4ZmZmZmZmZmYgKTtcblx0XHRzdGF0ZS5idWZmZXJzLnN0ZW5jaWwuc2V0Q2xlYXIoIGNsZWFyVmFsdWUgKTtcblxuXHRcdC8vIGRyYXcgaW50byB0aGUgc3RlbmNpbCBidWZmZXJcblxuXHRcdHJlbmRlcmVyLnJlbmRlciggdGhpcy5zY2VuZSwgdGhpcy5jYW1lcmEsIHJlYWRCdWZmZXIsIHRoaXMuY2xlYXIgKTtcblx0XHRyZW5kZXJlci5yZW5kZXIoIHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhLCB3cml0ZUJ1ZmZlciwgdGhpcy5jbGVhciApO1xuXG5cdFx0Ly8gdW5sb2NrIGNvbG9yIGFuZCBkZXB0aCBidWZmZXIgZm9yIHN1YnNlcXVlbnQgcmVuZGVyaW5nXG5cblx0XHRzdGF0ZS5idWZmZXJzLmNvbG9yLnNldExvY2tlZCggZmFsc2UgKTtcblx0XHRzdGF0ZS5idWZmZXJzLmRlcHRoLnNldExvY2tlZCggZmFsc2UgKTtcblxuXHRcdC8vIG9ubHkgcmVuZGVyIHdoZXJlIHN0ZW5jaWwgaXMgc2V0IHRvIDFcblxuXHRcdHN0YXRlLmJ1ZmZlcnMuc3RlbmNpbC5zZXRGdW5jKCBjb250ZXh0LkVRVUFMLCAxLCAweGZmZmZmZmZmICk7ICAvLyBkcmF3IGlmID09IDFcblx0XHRzdGF0ZS5idWZmZXJzLnN0ZW5jaWwuc2V0T3AoIGNvbnRleHQuS0VFUCwgY29udGV4dC5LRUVQLCBjb250ZXh0LktFRVAgKTtcblxuXHR9XG5cbn0gKTtcblxuXG5USFJFRS5DbGVhck1hc2tQYXNzID0gZnVuY3Rpb24gKCkge1xuXG5cdFRIUkVFLlBhc3MuY2FsbCggdGhpcyApO1xuXG5cdHRoaXMubmVlZHNTd2FwID0gZmFsc2U7XG5cbn07XG5cblRIUkVFLkNsZWFyTWFza1Bhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggVEhSRUUuUGFzcy5wcm90b3R5cGUgKTtcblxuT2JqZWN0LmFzc2lnbiggVEhSRUUuQ2xlYXJNYXNrUGFzcy5wcm90b3R5cGUsIHtcblxuXHRyZW5kZXI6IGZ1bmN0aW9uICggcmVuZGVyZXIsIHdyaXRlQnVmZmVyLCByZWFkQnVmZmVyLCBkZWx0YSwgbWFza0FjdGl2ZSApIHtcblxuXHRcdHJlbmRlcmVyLnN0YXRlLmJ1ZmZlcnMuc3RlbmNpbC5zZXRUZXN0KCBmYWxzZSApO1xuXG5cdH1cblxufSApO1xuIiwiLyoqXG4gKiBAYXV0aG9yIGFsdGVyZWRxIC8gaHR0cDovL2FsdGVyZWRxdWFsaWEuY29tL1xuICovXG5cblRIUkVFLlJlbmRlclBhc3MgPSBmdW5jdGlvbiAoIHNjZW5lLCBjYW1lcmEsIG92ZXJyaWRlTWF0ZXJpYWwsIGNsZWFyQ29sb3IsIGNsZWFyQWxwaGEgKSB7XG5cblx0VEhSRUUuUGFzcy5jYWxsKCB0aGlzICk7XG5cblx0dGhpcy5zY2VuZSA9IHNjZW5lO1xuXHR0aGlzLmNhbWVyYSA9IGNhbWVyYTtcblxuXHR0aGlzLm92ZXJyaWRlTWF0ZXJpYWwgPSBvdmVycmlkZU1hdGVyaWFsO1xuXG5cdHRoaXMuY2xlYXJDb2xvciA9IGNsZWFyQ29sb3I7XG5cdHRoaXMuY2xlYXJBbHBoYSA9ICggY2xlYXJBbHBoYSAhPT0gdW5kZWZpbmVkICkgPyBjbGVhckFscGhhIDogMDtcblxuXHR0aGlzLmNsZWFyID0gdHJ1ZTtcblx0dGhpcy5uZWVkc1N3YXAgPSBmYWxzZTtcblxufTtcblxuVEhSRUUuUmVuZGVyUGFzcy5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKCBPYmplY3QuY3JlYXRlKCBUSFJFRS5QYXNzLnByb3RvdHlwZSApLCB7XG5cblx0Y29uc3RydWN0b3I6IFRIUkVFLlJlbmRlclBhc3MsXG5cblx0cmVuZGVyOiBmdW5jdGlvbiAoIHJlbmRlcmVyLCB3cml0ZUJ1ZmZlciwgcmVhZEJ1ZmZlciwgZGVsdGEsIG1hc2tBY3RpdmUgKSB7XG5cblx0XHR2YXIgb2xkQXV0b0NsZWFyID0gcmVuZGVyZXIuYXV0b0NsZWFyO1xuXHRcdHJlbmRlcmVyLmF1dG9DbGVhciA9IGZhbHNlO1xuXG5cdFx0dGhpcy5zY2VuZS5vdmVycmlkZU1hdGVyaWFsID0gdGhpcy5vdmVycmlkZU1hdGVyaWFsO1xuXG5cdFx0dmFyIG9sZENsZWFyQ29sb3IsIG9sZENsZWFyQWxwaGE7XG5cblx0XHRpZiAoIHRoaXMuY2xlYXJDb2xvciApIHtcblxuXHRcdFx0b2xkQ2xlYXJDb2xvciA9IHJlbmRlcmVyLmdldENsZWFyQ29sb3IoKS5nZXRIZXgoKTtcblx0XHRcdG9sZENsZWFyQWxwaGEgPSByZW5kZXJlci5nZXRDbGVhckFscGhhKCk7XG5cblx0XHRcdHJlbmRlcmVyLnNldENsZWFyQ29sb3IoIHRoaXMuY2xlYXJDb2xvciwgdGhpcy5jbGVhckFscGhhICk7XG5cblx0XHR9XG5cblx0XHRyZW5kZXJlci5yZW5kZXIoIHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhLCB0aGlzLnJlbmRlclRvU2NyZWVuID8gbnVsbCA6IHJlYWRCdWZmZXIsIHRoaXMuY2xlYXIgKTtcblxuXHRcdGlmICggdGhpcy5jbGVhckNvbG9yICkge1xuXG5cdFx0XHRyZW5kZXJlci5zZXRDbGVhckNvbG9yKCBvbGRDbGVhckNvbG9yLCBvbGRDbGVhckFscGhhICk7XG5cblx0XHR9XG5cblx0XHR0aGlzLnNjZW5lLm92ZXJyaWRlTWF0ZXJpYWwgPSBudWxsO1xuXHRcdHJlbmRlcmVyLmF1dG9DbGVhciA9IG9sZEF1dG9DbGVhcjtcblx0fVxuXG59ICk7XG4iLCIvKipcbiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vXG4gKi9cblxuVEhSRUUuU2hhZGVyUGFzcyA9IGZ1bmN0aW9uICggc2hhZGVyLCB0ZXh0dXJlSUQgKSB7XG5cblx0VEhSRUUuUGFzcy5jYWxsKCB0aGlzICk7XG5cblx0dGhpcy50ZXh0dXJlSUQgPSAoIHRleHR1cmVJRCAhPT0gdW5kZWZpbmVkICkgPyB0ZXh0dXJlSUQgOiBcInREaWZmdXNlXCI7XG5cblx0aWYgKCBzaGFkZXIgaW5zdGFuY2VvZiBUSFJFRS5TaGFkZXJNYXRlcmlhbCApIHtcblxuXHRcdHRoaXMudW5pZm9ybXMgPSBzaGFkZXIudW5pZm9ybXM7XG5cblx0XHR0aGlzLm1hdGVyaWFsID0gc2hhZGVyO1xuXG5cdH0gZWxzZSBpZiAoIHNoYWRlciApIHtcblxuXHRcdHRoaXMudW5pZm9ybXMgPSBUSFJFRS5Vbmlmb3Jtc1V0aWxzLmNsb25lKCBzaGFkZXIudW5pZm9ybXMgKTtcblxuXHRcdHRoaXMubWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoIHtcblxuXHRcdFx0ZGVmaW5lczogc2hhZGVyLmRlZmluZXMgfHwge30sXG5cdFx0XHR1bmlmb3JtczogdGhpcy51bmlmb3Jtcyxcblx0XHRcdHZlcnRleFNoYWRlcjogc2hhZGVyLnZlcnRleFNoYWRlcixcblx0XHRcdGZyYWdtZW50U2hhZGVyOiBzaGFkZXIuZnJhZ21lbnRTaGFkZXJcblxuXHRcdH0gKTtcblxuXHR9XG5cblx0dGhpcy5jYW1lcmEgPSBuZXcgVEhSRUUuT3J0aG9ncmFwaGljQ2FtZXJhKCAtIDEsIDEsIDEsIC0gMSwgMCwgMSApO1xuXHR0aGlzLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cblx0dGhpcy5xdWFkID0gbmV3IFRIUkVFLk1lc2goIG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KCAyLCAyICksIG51bGwgKTtcblx0dGhpcy5zY2VuZS5hZGQoIHRoaXMucXVhZCApO1xuXG59O1xuXG5USFJFRS5TaGFkZXJQYXNzLnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oIE9iamVjdC5jcmVhdGUoIFRIUkVFLlBhc3MucHJvdG90eXBlICksIHtcblxuXHRjb25zdHJ1Y3RvcjogVEhSRUUuU2hhZGVyUGFzcyxcblxuXHRyZW5kZXI6IGZ1bmN0aW9uKCByZW5kZXJlciwgd3JpdGVCdWZmZXIsIHJlYWRCdWZmZXIsIGRlbHRhLCBtYXNrQWN0aXZlICkge1xuXG5cdFx0aWYgKCB0aGlzLnVuaWZvcm1zWyB0aGlzLnRleHR1cmVJRCBdICkge1xuXG5cdFx0XHR0aGlzLnVuaWZvcm1zWyB0aGlzLnRleHR1cmVJRCBdLnZhbHVlID0gcmVhZEJ1ZmZlci50ZXh0dXJlO1xuXG5cdFx0fVxuXG5cdFx0dGhpcy5xdWFkLm1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbDtcblxuXHRcdGlmICggdGhpcy5yZW5kZXJUb1NjcmVlbiApIHtcblxuXHRcdFx0cmVuZGVyZXIucmVuZGVyKCB0aGlzLnNjZW5lLCB0aGlzLmNhbWVyYSApO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0cmVuZGVyZXIucmVuZGVyKCB0aGlzLnNjZW5lLCB0aGlzLmNhbWVyYSwgd3JpdGVCdWZmZXIsIHRoaXMuY2xlYXIgKTtcblxuXHRcdH1cblxuXHR9XG5cbn0gKTtcbiIsIi8qKlxuICogQGF1dGhvciBhbHRlcmVkcSAvIGh0dHA6Ly9hbHRlcmVkcXVhbGlhLmNvbS9cbiAqL1xuXG5USFJFRS5UZXh0dXJlUGFzcyA9IGZ1bmN0aW9uICggbWFwLCBvcGFjaXR5ICkge1xuXG5cdFRIUkVFLlBhc3MuY2FsbCggdGhpcyApO1xuXG5cdGlmICggVEhSRUUuQ29weVNoYWRlciA9PT0gdW5kZWZpbmVkIClcblx0XHRjb25zb2xlLmVycm9yKCBcIlRIUkVFLlRleHR1cmVQYXNzIHJlbGllcyBvbiBUSFJFRS5Db3B5U2hhZGVyXCIgKTtcblxuXHR2YXIgc2hhZGVyID0gVEhSRUUuQ29weVNoYWRlcjtcblxuXHR0aGlzLm1hcCA9IG1hcDtcblx0dGhpcy5vcGFjaXR5ID0gKCBvcGFjaXR5ICE9PSB1bmRlZmluZWQgKSA/IG9wYWNpdHkgOiAxLjA7XG5cblx0dGhpcy51bmlmb3JtcyA9IFRIUkVFLlVuaWZvcm1zVXRpbHMuY2xvbmUoIHNoYWRlci51bmlmb3JtcyApO1xuXG5cdHRoaXMubWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoIHtcblxuXHRcdHVuaWZvcm1zOiB0aGlzLnVuaWZvcm1zLFxuXHRcdHZlcnRleFNoYWRlcjogc2hhZGVyLnZlcnRleFNoYWRlcixcblx0XHRmcmFnbWVudFNoYWRlcjogc2hhZGVyLmZyYWdtZW50U2hhZGVyLFxuXHRcdGRlcHRoVGVzdDogZmFsc2UsXG5cdFx0ZGVwdGhXcml0ZTogZmFsc2VcblxuXHR9ICk7XG5cblx0dGhpcy5uZWVkc1N3YXAgPSBmYWxzZTtcblxuXHR0aGlzLmNhbWVyYSA9IG5ldyBUSFJFRS5PcnRob2dyYXBoaWNDYW1lcmEoIC0gMSwgMSwgMSwgLSAxLCAwLCAxICk7XG5cdHRoaXMuc2NlbmUgID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cblx0dGhpcy5xdWFkID0gbmV3IFRIUkVFLk1lc2goIG5ldyBUSFJFRS5QbGFuZUJ1ZmZlckdlb21ldHJ5KCAyLCAyICksIG51bGwgKTtcblx0dGhpcy5zY2VuZS5hZGQoIHRoaXMucXVhZCApO1xuXG59O1xuXG5USFJFRS5UZXh0dXJlUGFzcy5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKCBPYmplY3QuY3JlYXRlKCBUSFJFRS5QYXNzLnByb3RvdHlwZSApLCB7XG5cblx0Y29uc3RydWN0b3I6IFRIUkVFLlRleHR1cmVQYXNzLFxuXG5cdHJlbmRlcjogZnVuY3Rpb24gKCByZW5kZXJlciwgd3JpdGVCdWZmZXIsIHJlYWRCdWZmZXIsIGRlbHRhLCBtYXNrQWN0aXZlICkge1xuXG5cdFx0dmFyIG9sZEF1dG9DbGVhciA9IHJlbmRlcmVyLmF1dG9DbGVhcjtcblx0XHRyZW5kZXJlci5hdXRvQ2xlYXIgPSBmYWxzZTtcblxuXHRcdHRoaXMucXVhZC5tYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWw7XG5cblx0XHR0aGlzLnVuaWZvcm1zWyBcIm9wYWNpdHlcIiBdLnZhbHVlID0gdGhpcy5vcGFjaXR5O1xuXHRcdHRoaXMudW5pZm9ybXNbIFwidERpZmZ1c2VcIiBdLnZhbHVlID0gdGhpcy5tYXA7XG5cdFx0dGhpcy5tYXRlcmlhbC50cmFuc3BhcmVudCA9ICggdGhpcy5vcGFjaXR5IDwgMS4wICk7XG5cblx0XHRyZW5kZXJlci5yZW5kZXIoIHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhLCB0aGlzLnJlbmRlclRvU2NyZWVuID8gbnVsbCA6IHJlYWRCdWZmZXIsIHRoaXMuY2xlYXIgKTtcblxuXHRcdHJlbmRlcmVyLmF1dG9DbGVhciA9IG9sZEF1dG9DbGVhcjtcblx0fVxuXG59ICk7XG4iLCIvKipcbiAqIEBhdXRob3IgYWx0ZXJlZHEgLyBodHRwOi8vYWx0ZXJlZHF1YWxpYS5jb20vXG4gKlxuICogRnVsbC1zY3JlZW4gdGV4dHVyZWQgcXVhZCBzaGFkZXJcbiAqL1xuXG5USFJFRS5Db3B5U2hhZGVyID0ge1xuXG5cdHVuaWZvcm1zOiB7XG5cblx0XHRcInREaWZmdXNlXCI6IHsgdmFsdWU6IG51bGwgfSxcblx0XHRcIm9wYWNpdHlcIjogIHsgdmFsdWU6IDEuMCB9XG5cblx0fSxcblxuXHR2ZXJ0ZXhTaGFkZXI6IFtcblxuXHRcdFwidmFyeWluZyB2ZWMyIHZVdjtcIixcblxuXHRcdFwidm9pZCBtYWluKCkge1wiLFxuXG5cdFx0XHRcInZVdiA9IHV2O1wiLFxuXHRcdFx0XCJnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KCBwb3NpdGlvbiwgMS4wICk7XCIsXG5cblx0XHRcIn1cIlxuXG5cdF0uam9pbiggXCJcXG5cIiApLFxuXG5cdGZyYWdtZW50U2hhZGVyOiBbXG5cblx0XHRcInVuaWZvcm0gZmxvYXQgb3BhY2l0eTtcIixcblxuXHRcdFwidW5pZm9ybSBzYW1wbGVyMkQgdERpZmZ1c2U7XCIsXG5cblx0XHRcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG5cblx0XHRcInZvaWQgbWFpbigpIHtcIixcblxuXHRcdFx0XCJ2ZWM0IHRleGVsID0gdGV4dHVyZTJEKCB0RGlmZnVzZSwgdlV2ICk7XCIsXG5cdFx0XHRcImdsX0ZyYWdDb2xvciA9IG9wYWNpdHkgKiB0ZXhlbDtcIixcblxuXHRcdFwifVwiXG5cblx0XS5qb2luKCBcIlxcblwiIClcblxufTtcbiIsIi8qKlxuICogQGF1dGhvciB6ejg1IC8gaHR0cDovL3d3dy5sYWI0Z2FtZXMubmV0L3p6ODUvYmxvZ1xuICpcbiAqIFR3byBwYXNzIEdhdXNzaWFuIGJsdXIgZmlsdGVyIChob3Jpem9udGFsIGFuZCB2ZXJ0aWNhbCBibHVyIHNoYWRlcnMpXG4gKiAtIGRlc2NyaWJlZCBpbiBodHRwOi8vd3d3LmdhbWVyZW5kZXJpbmcuY29tLzIwMDgvMTAvMTEvZ2F1c3NpYW4tYmx1ci1maWx0ZXItc2hhZGVyL1xuICogICBhbmQgdXNlZCBpbiBodHRwOi8vd3d3LmNha2UyMy5kZS90cmF2ZWxpbmctd2F2ZWZyb250cy1saXQtdXAuaHRtbFxuICpcbiAqIC0gOSBzYW1wbGVzIHBlciBwYXNzXG4gKiAtIHN0YW5kYXJkIGRldmlhdGlvbiAyLjdcbiAqIC0gXCJoXCIgYW5kIFwidlwiIHBhcmFtZXRlcnMgc2hvdWxkIGJlIHNldCB0byBcIjEgLyB3aWR0aFwiIGFuZCBcIjEgLyBoZWlnaHRcIlxuICovXG5cblRIUkVFLkhvcml6b250YWxCbHVyU2hhZGVyID0ge1xuXG5cdHVuaWZvcm1zOiB7XG5cblx0XHRcInREaWZmdXNlXCI6IHsgdmFsdWU6IG51bGwgfSxcblx0XHRcImhcIjogICAgICAgIHsgdmFsdWU6IDEuMCAvIDUxMi4wIH1cblxuXHR9LFxuXG5cdHZlcnRleFNoYWRlcjogW1xuXG5cdFx0XCJ2YXJ5aW5nIHZlYzIgdlV2O1wiLFxuXG5cdFx0XCJ2b2lkIG1haW4oKSB7XCIsXG5cblx0XHRcdFwidlV2ID0gdXY7XCIsXG5cdFx0XHRcImdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQoIHBvc2l0aW9uLCAxLjAgKTtcIixcblxuXHRcdFwifVwiXG5cblx0XS5qb2luKCBcIlxcblwiICksXG5cblx0ZnJhZ21lbnRTaGFkZXI6IFtcblxuXHRcdFwidW5pZm9ybSBzYW1wbGVyMkQgdERpZmZ1c2U7XCIsXG5cdFx0XCJ1bmlmb3JtIGZsb2F0IGg7XCIsXG5cblx0XHRcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG5cblx0XHRcInZvaWQgbWFpbigpIHtcIixcblxuXHRcdFx0XCJ2ZWM0IHN1bSA9IHZlYzQoIDAuMCApO1wiLFxuXG5cdFx0XHRcInN1bSArPSB0ZXh0dXJlMkQoIHREaWZmdXNlLCB2ZWMyKCB2VXYueCAtIDQuMCAqIGgsIHZVdi55ICkgKSAqIDAuMDUxO1wiLFxuXHRcdFx0XCJzdW0gKz0gdGV4dHVyZTJEKCB0RGlmZnVzZSwgdmVjMiggdlV2LnggLSAzLjAgKiBoLCB2VXYueSApICkgKiAwLjA5MTg7XCIsXG5cdFx0XHRcInN1bSArPSB0ZXh0dXJlMkQoIHREaWZmdXNlLCB2ZWMyKCB2VXYueCAtIDIuMCAqIGgsIHZVdi55ICkgKSAqIDAuMTIyNDU7XCIsXG5cdFx0XHRcInN1bSArPSB0ZXh0dXJlMkQoIHREaWZmdXNlLCB2ZWMyKCB2VXYueCAtIDEuMCAqIGgsIHZVdi55ICkgKSAqIDAuMTUzMTtcIixcblx0XHRcdFwic3VtICs9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZlYzIoIHZVdi54LCB2VXYueSApICkgKiAwLjE2MzM7XCIsXG5cdFx0XHRcInN1bSArPSB0ZXh0dXJlMkQoIHREaWZmdXNlLCB2ZWMyKCB2VXYueCArIDEuMCAqIGgsIHZVdi55ICkgKSAqIDAuMTUzMTtcIixcblx0XHRcdFwic3VtICs9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZlYzIoIHZVdi54ICsgMi4wICogaCwgdlV2LnkgKSApICogMC4xMjI0NTtcIixcblx0XHRcdFwic3VtICs9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZlYzIoIHZVdi54ICsgMy4wICogaCwgdlV2LnkgKSApICogMC4wOTE4O1wiLFxuXHRcdFx0XCJzdW0gKz0gdGV4dHVyZTJEKCB0RGlmZnVzZSwgdmVjMiggdlV2LnggKyA0LjAgKiBoLCB2VXYueSApICkgKiAwLjA1MTtcIixcblxuXHRcdFx0XCJnbF9GcmFnQ29sb3IgPSBzdW07XCIsXG5cblx0XHRcIn1cIlxuXG5cdF0uam9pbiggXCJcXG5cIiApXG5cbn07XG4iLCIvKipcbiAqIEBhdXRob3Igeno4NSAvIGh0dHA6Ly93d3cubGFiNGdhbWVzLm5ldC96ejg1L2Jsb2dcbiAqXG4gKiBUd28gcGFzcyBHYXVzc2lhbiBibHVyIGZpbHRlciAoaG9yaXpvbnRhbCBhbmQgdmVydGljYWwgYmx1ciBzaGFkZXJzKVxuICogLSBkZXNjcmliZWQgaW4gaHR0cDovL3d3dy5nYW1lcmVuZGVyaW5nLmNvbS8yMDA4LzEwLzExL2dhdXNzaWFuLWJsdXItZmlsdGVyLXNoYWRlci9cbiAqICAgYW5kIHVzZWQgaW4gaHR0cDovL3d3dy5jYWtlMjMuZGUvdHJhdmVsaW5nLXdhdmVmcm9udHMtbGl0LXVwLmh0bWxcbiAqXG4gKiAtIDkgc2FtcGxlcyBwZXIgcGFzc1xuICogLSBzdGFuZGFyZCBkZXZpYXRpb24gMi43XG4gKiAtIFwiaFwiIGFuZCBcInZcIiBwYXJhbWV0ZXJzIHNob3VsZCBiZSBzZXQgdG8gXCIxIC8gd2lkdGhcIiBhbmQgXCIxIC8gaGVpZ2h0XCJcbiAqL1xuXG5USFJFRS5WZXJ0aWNhbEJsdXJTaGFkZXIgPSB7XG5cblx0dW5pZm9ybXM6IHtcblxuXHRcdFwidERpZmZ1c2VcIjogeyB2YWx1ZTogbnVsbCB9LFxuXHRcdFwidlwiOiAgICAgICAgeyB2YWx1ZTogMS4wIC8gNTEyLjAgfVxuXG5cdH0sXG5cblx0dmVydGV4U2hhZGVyOiBbXG5cblx0XHRcInZhcnlpbmcgdmVjMiB2VXY7XCIsXG5cblx0XHRcInZvaWQgbWFpbigpIHtcIixcblxuXHRcdFx0XCJ2VXYgPSB1djtcIixcblx0XHRcdFwiZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogbW9kZWxWaWV3TWF0cml4ICogdmVjNCggcG9zaXRpb24sIDEuMCApO1wiLFxuXG5cdFx0XCJ9XCJcblxuXHRdLmpvaW4oIFwiXFxuXCIgKSxcblxuXHRmcmFnbWVudFNoYWRlcjogW1xuXG5cdFx0XCJ1bmlmb3JtIHNhbXBsZXIyRCB0RGlmZnVzZTtcIixcblx0XHRcInVuaWZvcm0gZmxvYXQgdjtcIixcblxuXHRcdFwidmFyeWluZyB2ZWMyIHZVdjtcIixcblxuXHRcdFwidm9pZCBtYWluKCkge1wiLFxuXG5cdFx0XHRcInZlYzQgc3VtID0gdmVjNCggMC4wICk7XCIsXG5cblx0XHRcdFwic3VtICs9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZlYzIoIHZVdi54LCB2VXYueSAtIDQuMCAqIHYgKSApICogMC4wNTE7XCIsXG5cdFx0XHRcInN1bSArPSB0ZXh0dXJlMkQoIHREaWZmdXNlLCB2ZWMyKCB2VXYueCwgdlV2LnkgLSAzLjAgKiB2ICkgKSAqIDAuMDkxODtcIixcblx0XHRcdFwic3VtICs9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZlYzIoIHZVdi54LCB2VXYueSAtIDIuMCAqIHYgKSApICogMC4xMjI0NTtcIixcblx0XHRcdFwic3VtICs9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZlYzIoIHZVdi54LCB2VXYueSAtIDEuMCAqIHYgKSApICogMC4xNTMxO1wiLFxuXHRcdFx0XCJzdW0gKz0gdGV4dHVyZTJEKCB0RGlmZnVzZSwgdmVjMiggdlV2LngsIHZVdi55ICkgKSAqIDAuMTYzMztcIixcblx0XHRcdFwic3VtICs9IHRleHR1cmUyRCggdERpZmZ1c2UsIHZlYzIoIHZVdi54LCB2VXYueSArIDEuMCAqIHYgKSApICogMC4xNTMxO1wiLFxuXHRcdFx0XCJzdW0gKz0gdGV4dHVyZTJEKCB0RGlmZnVzZSwgdmVjMiggdlV2LngsIHZVdi55ICsgMi4wICogdiApICkgKiAwLjEyMjQ1O1wiLFxuXHRcdFx0XCJzdW0gKz0gdGV4dHVyZTJEKCB0RGlmZnVzZSwgdmVjMiggdlV2LngsIHZVdi55ICsgMy4wICogdiApICkgKiAwLjA5MTg7XCIsXG5cdFx0XHRcInN1bSArPSB0ZXh0dXJlMkQoIHREaWZmdXNlLCB2ZWMyKCB2VXYueCwgdlV2LnkgKyA0LjAgKiB2ICkgKSAqIDAuMDUxO1wiLFxuXG5cdFx0XHRcImdsX0ZyYWdDb2xvciA9IHN1bTtcIixcblxuXHRcdFwifVwiXG5cblx0XS5qb2luKCBcIlxcblwiIClcblxufTtcbiIsIlxyXG5cclxuZXhwb3J0cy5kcmF3Q2hhcmFjdGVyID0gZnVuY3Rpb24gZHJhd0NoYXJhY3RlciggY2x1c3RlciwgcG9zLCB2LCBjLCBmb250ICkge1xyXG4gICAgdmFyIHBjaGFyO1xyXG4gICAgaWYoIHBjaGFyID0gZm9udC5jaGFyYWN0ZXJzW2NdICkge1xyXG4gICAgICAgIHZhciBkYXRhICA9IHBjaGFyLmRhdGE7XHJcblx0XHQvLyBiYWNrZ3JvdW5kIG1heSBoYXZlIGFuIGFscGhhIHZhbHVlIC1cclxuXHRcdC8vIGJ1dCB3ZSBzaG91bGQgc3RpbGwgYXNzdW1lIHRoYXQgYmxhY2sgaXMgdHJhbnNwYXJlbnQuLi5cclxuXHRcdHZhciBzaXplID0gcGNoYXIuc3o7XHJcblx0XHR2YXIgd2lkdGggPSBwY2hhci53O1xyXG5cdFx0aWYoICggZm9udC5mbGFncyAmIDMgKSA9PSAwLypGT05UX0ZMQUdfTU9OTyovIClcclxuXHRcdHtcclxuXHRcdFx0dmFyIENoYXJEYXRheCA9IENoYXJEYXRhMTtcclxuXHRcdFx0dmFyIGluYyA9IE1hdGguZmxvb3IoIChwY2hhci5zeis3KS84ICk7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmKCAoIGZvbnQuZmxhZ3MgJiAzICkgPT0gMS8qRk9OVF9GTEFHXzJCSVQqLyApXHJcblx0XHR7XHJcblx0XHRcdHZhciBDaGFyRGF0YXggPSBDaGFyRGF0YTI7XHJcblx0XHRcdHZhciBpbmMgPSBNYXRoLmZsb29yKChwY2hhci5zeiszKS80KTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYoICggZm9udC5mbGFncyAmIDMgKSA9PSAzIHx8ICggZm9udC5mbGFncyAmIDMgKSAgPT0gMiApXHJcblx0XHR7XHJcblx0XHRcdHZhciBDaGFyRGF0YXggPSBDaGFyRGF0YTg7XHJcblx0XHRcdHZhciBpbmMgPSAoY2hhci5zeik7XHJcblx0XHR9XHJcblxyXG4gICAgICAgIGlmKCAoIGZvbnQuZmxhZ3MgJiAzICkgPT0gMCApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRyYXdNb25vQ2hhciggY2x1c3RlciwgcG9zLCB2LCBwY2hhciwgZm9udCwgQ2hhckRhdGF4LCBpbmMgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIENoYXJEYXRhOCggYml0cywgb2ZzLCBiaXQgKSB7IHJldHVybiBiaXRzW29mcytiaXRdOyB9XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIENoYXJEYXRhMiggYml0cywgb2ZzLCBiaXQgKSB7IHJldHVybiAoYml0c1tvZnMrYml0Pj4yXSA+PiAoMiooYml0JjMpKSkmMzsgfVxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5mdW5jdGlvbiBDaGFyRGF0YTEoIGJpdHMsIG9mcywgYml0ICkgeyByZXR1cm4gKGJpdHNbb2ZzKyhiaXQ+PjMpXSA+PiAoYml0JjcpKSYxOyB9XHJcblxyXG5cclxuZnVuY3Rpb24gZHJhd01vbm9DaGFyKCBjbHVzdGVyLCBwb3MsIHYsIHBjaGFyLCBmb250LCBDaGFyRGF0YXgsIGluYyApIHtcclxuICAgIHZhciBsaW5lX3RhcmdldDtcclxuICAgIHZhciB5ID0gcG9zLnkgKyAoIGZvbnQuYmFzZWxpbmUgKyBwY2hhci5hc2MgKTtcclxuICAgIHZhciB4ID0gcG9zLnggKyAoIHBjaGFyLm9mcyApO1xyXG4gICAgdmFyIGxpbmUgPSAwOy8vVXNlRm9udC5iYXNlbGluZSAtIHBjaGFyLmFzY2VudDtcclxuICAgIHZhciBkT2ZzID0gMDtcclxuICAgIHZhciBsaW5lX3RhcmdldCA9ICBwY2hhci5hc2MgLSBwY2hhci5kc2M7Ly8oVXNlRm9udC5iYXNlbGluZSAtIHBjaGFyLmFzYykgKyAoIFVzZUZvbnQuYmFzZWxpbmUgLSBwY2hhci5kZXNjZW50ICk7XHJcbiAgICB2YXIgZGF0YSAgPSBwY2hhci5kYXRhO1xyXG4gICAgdmFyIHNpemUgPSBwY2hhci5zejtcclxuICAgIGZvcig7XHJcbiAgICAgICAgIGxpbmUgPD0gbGluZV90YXJnZXQ7XHJcbiAgICAgICAgIGxpbmUrKyApXHJcbiAgICB7XHJcbiAgICAgICAgZm9yKCB2YXIgYml0ID0gMDsgYml0IDwgc2l6ZTsgYml0KysgKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGNoYXJkYXRhID0gQ2hhckRhdGF4KCBkYXRhLCBkT2ZzLCBiaXQgKTtcclxuICAgICAgICAgICAgaWYoIGNoYXJkYXRhIClcclxuICAgICAgICAgICAgICAgIGNsdXN0ZXIuc2V0Q3ViZSggeCArIGJpdCwgeSAtIGxpbmUsIDAsIHYgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZE9mcyArPSBpbmM7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcGNoYXIudztcclxufVxyXG4iLCJcclxuXHJcbnZhciBjdXJyZW50UmVmO1xyXG52YXIgY3VycmVudEFkZFJlZjtcclxuXHJcbnZhciBzZWxlY3RvciA9IFZveGVsYXJpdW0uc2VsZWN0b3IgPSB7XHJcblxyXG4gICAgZ2V0IGN1cnJlbnRWb3hlbCAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRSZWY7XHJcbiAgICB9LFxyXG4gICAgc2V0IGN1cnJlbnRWb3hlbCAocmVmKSB7XHJcbiAgICAgICAgY3VycmVudFJlZiA9IHJlZjtcclxuICAgIH0sXHJcbiAgICBnZXQgY3VycmVudEFkZFZveGVsICgpIHtcclxuICAgICAgICByZXR1cm4gY3VycmVudEFkZFJlZjtcclxuICAgIH0sXHJcbiAgICBzZXQgY3VycmVudEFkZFZveGVsIChyZWYpIHtcclxuICAgICAgICBjdXJyZW50QWRkUmVmID0gcmVmO1xyXG4gICAgfSxcclxuICAgIG1hdGVyaWFsIDogbmV3IFRIUkVFLkxpbmVCYXNpY01hdGVyaWFsKHsgY29sb3I6J3doaXRlJ1xyXG4gICAgICAgICx2ZXJ0ZXhDb2xvcnM6IFRIUkVFLlZlcnRleENvbG9yc1xyXG4gICAgICAgICxsaW5ld2lkdGg6MSAvKiB3aW5kb3dzID09IDEgYWx3YXlzICovXHJcbiAgICAgICAgfSksXHJcbiAgICBnZW9tZXRyeSA6IG5ldyBUSFJFRS5HZW9tZXRyeSgpLFxyXG4gICAgbWVzaCA6IG51bGwsXHJcbiAgICBtZXNoR2xvdyA6IG51bGwsXHJcbn07XHJcbnNlbGVjdG9yLm1hdGVyaWFsLmRlcHRoV3JpdGUgPSBmYWxzZTtcclxuc2VsZWN0b3IubWF0ZXJpYWwuZGVwdGhUZXN0ID0gZmFsc2U7XHJcblxyXG5zZWxlY3Rvci5tZXNoID0gbmV3IFRIUkVFLkxpbmVTZWdtZW50cyggc2VsZWN0b3IuZ2VvbWV0cnksIHNlbGVjdG9yLm1hdGVyaWFsICk7XHJcbnNlbGVjdG9yLm1lc2hHbG93ID0gbmV3IFRIUkVFLkxpbmVTZWdtZW50cyggc2VsZWN0b3IuZ2VvbWV0cnksIHNlbGVjdG9yLm1hdGVyaWFsICk7XHJcblxyXG5cclxuVm94ZWxhcml1bS5zZWxlY3Rvci51cGRhdGUgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBjb2xvciA9IG5ldyBUSFJFRS5Db2xvciggMC44LCAwLCAwICk7XHJcbiAgICB2YXIgdW5pdCA9IGN1cnJlbnRSZWY/Y3VycmVudFJlZi5jbHVzdGVyLnZveGVsVW5pdFNpemU6MTA7XHJcbiAgICB2YXIgeCA9IDBcclxuICAgIHZhciB5ID0gMFxyXG4gICAgdmFyIHogPSAwXHJcbiAgICB2YXIgZ2VvbWV0cnkgPSBzZWxlY3Rvci5nZW9tZXRyeTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLmxlbmd0aCA9IDA7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMubGVuZ3RoID0gMDtcclxuICAgIGZvciggdmFyIG4gPSAwOyBuIDwgMjsgbisrICkge1xyXG4gICAgICAgIGlmKCBuID09IDAgKSB7XHJcbiAgICAgICAgICAgIGlmKCAhY3VycmVudFJlZiApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIC8vcmV0dXJuO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHVuaXQgPSBjdXJyZW50UmVmLmNsdXN0ZXIudm94ZWxVbml0U2l6ZTtcclxuICAgICAgICAgICAgICAgIHggPSBjdXJyZW50UmVmLnd4ICogdW5pdFxyXG4gICAgICAgICAgICAgICAgeSA9IGN1cnJlbnRSZWYud3kgKiB1bml0XHJcbiAgICAgICAgICAgICAgICB6ID0gY3VycmVudFJlZi53eiAqIHVuaXRcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAvL2NvbG9yLmRlbGV0ZSgpO1xyXG4gICAgICAgICAgICAgIGNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCAwLCAwLjgsIDAgKTtcclxuICAgICAgICAgICAgICBpZiggIWN1cnJlbnRBZGRSZWYgKVxyXG4gICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgLy9yZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgeCA9IGN1cnJlbnRBZGRSZWYud3ggKiB1bml0XHJcbiAgICAgICAgICAgICAgICAgIHkgPSBjdXJyZW50QWRkUmVmLnd5ICogdW5pdFxyXG4gICAgICAgICAgICAgICAgICB6ID0gY3VycmVudEFkZFJlZi53eiAqIHVuaXRcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB9XHJcbiAgICB2YXIgUCA9IFtuZXcgVEhSRUUuVmVjdG9yMyggeCwgeSwgeiApXHJcbiAgICAgICAgLCBuZXcgVEhSRUUuVmVjdG9yMyggeCArIHVuaXQsIHksIHogKVxyXG4gICAgICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHgsIHkgKyB1bml0LCB6IClcclxuICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4ICsgdW5pdCwgeSArIHVuaXQsIHogKVxyXG4gICAgICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHgsIHksIHogKyB1bml0IClcclxuICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4ICsgdW5pdCwgeSwgeiArIHVuaXQgKVxyXG4gICAgICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHgsIHkgKyB1bml0LCB6ICsgdW5pdCApXHJcbiAgICAgICAgLCBuZXcgVEhSRUUuVmVjdG9yMyggeCArIHVuaXQsIHkgKyB1bml0LCB6ICsgdW5pdCApXHJcbiAgICAgICAgXVxyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzBdICk7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbMV0gKTtcclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFsxXSApO1xyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzNdICk7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbM10gKTtcclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFsyXSApO1xyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzJdICk7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbMF0gKTtcclxuXHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbNF0gKTtcclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFs1XSApO1xyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzVdICk7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbN10gKTtcclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFs3XSApO1xyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzZdICk7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbNl0gKTtcclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFs0XSApO1xyXG5cclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFswXSApO1xyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzRdICk7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbMV0gKTtcclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFs1XSApO1xyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzJdICk7XHJcbiAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbNl0gKTtcclxuICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFszXSApO1xyXG4gICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzddICk7XHJcblxyXG4gICAgfVxyXG4gICAgLy9jb2xvci5kZWxldGUoKTtcclxuICAgIGdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpO1xyXG4gICAgZ2VvbWV0cnkudmVydGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcclxuICAgIGdlb21ldHJ5LmNvbG9yc05lZWRVcGRhdGUgPSB0cnVlO1xyXG59XHJcbiIsIlwidXNlIHN0cmljdFwiO1xyXG5cclxudmFyIHR5cGVzID0gVm94ZWxhcml1bS5Wb3hlbHM7XHJcblxyXG52YXIga2V5cyA9IHsgTEVGVDogMzcsIFVQOiAzOCwgUklHSFQ6IDM5LCBCT1RUT006IDQwXHJcblx0LCBBOjY1LCBTOjgzLCBEOjY4LCBXOjg3LCBTUEFDRTozMiwgQzo2N1xyXG4gICAgLCBJIDogNzMsIEVTQ0FQRSA6IDI3IH07XHJcblxyXG5cclxuZnVuY3Rpb24gSW52ZW50b3J5SXRlbSAoIHZveGVsVHlwZSApIHtcclxuICAgIHZhciBpdGVtID0ge1xyXG4gICAgICAgIHZveGVsVHlwZSA6IHZveGVsVHlwZSwgIC8vIHZveGVsIHR5cGVcclxuICAgICAgICBUSFJFRV9zb2xpZCA6IG51bGwsXHJcbiAgICAgICAgZ2VvbWV0cnkgOiBWb3hlbGFyaXVtLlNldHRpbmdzLnVzZV9iYXNpY19tYXRlcmlhbFxyXG5cdFx0XHRcdFx0PyBWb3hlbGFyaXVtLkdlb21ldHJ5QmFzaWNCdWZmZXIoKVxyXG5cdFx0XHRcdFx0OiBWb3hlbGFyaXVtLkdlb21ldHJ5QnVmZmVyKCkgLFxyXG5cclxuICAgIH1cclxuICAgIGl0ZW0uZ2VvbWV0cnkubWFrZVZveEN1YmUoIDAuMjUsIHZveGVsVHlwZSApO1xyXG5cclxuICAgIHJldHVybiBpdGVtO1xyXG59XHJcblxyXG5Wb3hlbGFyaXVtLkludmVudG9yeSA9IGZ1bmN0aW9uKCBnZW9tZXRyeVNoYWRlcixkb21FbGVtZW50ICkge1xyXG4gICAgdmFyIGRvbUVsZW1lbnQgPSAoIGRvbUVsZW1lbnQgIT09IHVuZGVmaW5lZCApID8gZG9tRWxlbWVudCA6IGRvY3VtZW50O1xyXG4gICAgdmFyIGludmVudG9yeSA9IHtcclxuICAgICAgICAgcmF5Y2FzdGVyIDogbmV3IFRIUkVFLlJheWNhc3RlcigpLFxyXG4gICAgICAgIGl0ZW1zIDogW10sXHJcbiAgICAgICAgZW5hYmxlZCA6IGZhbHNlLFxyXG4gICAgICAgIGJ1aWxkX3ZlcnRpY2FsIDogdHJ1ZSxcclxuICAgICAgICBUSFJFRV9zb2xpZCA6IG5ldyBUSFJFRS5PYmplY3QzRCgpLFxyXG4gICAgICAgICB4X21heCA6IDE1LCB5X21heCA6IDEyLFxyXG4gICAgICAgICB4X2luYyA6IDAuNzUsIHlfaW5jIDogMC43NSxcclxuICAgICAgICAgbW91c2VSYXkgOiB7IG4gOiBUSFJFRS5WZWN0b3IzWmVyby5jbG9uZSgpLCBvOiBuZXcgVEhSRUUuVmVjdG9yMygpLmRlbGV0ZSgpIH0sXHJcbiAgICAgICAgIGxhc3RfaW50ZXJzZWN0cyA6IG51bGwsXHJcbiAgICAgICAgIGRlYWN0aXZhdGVzIDogW10sXHJcbiAgICAgICAgIC8vbW91c2VDbG9jayA6IG5ldyBUSFJFRS5DbG9jaygpO1xyXG5cclxuICAgICAgICB1cGRhdGVQb3NpdGlvbnMgOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHggPSAwLCB5ID0gMDtcclxuICAgICAgICAgICAgaW52ZW50b3J5Lml0ZW1zLmZvckVhY2goIChpdGVtKT0+e1xyXG4gICAgICAgICAgICAgICAgaWYoIHkgPj0gdGhpcy55X21heCB8fCB4ID49IHRoaXMueF9tYXggKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5USFJFRV9zb2xpZC52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGl0ZW0uVEhSRUVfc29saWQudmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpdGVtLlRIUkVFX3NvbGlkLm1hdHJpeC5vcmlnaW4uc2V0KCB4LCB5LCAwICk7XHJcbiAgICAgICAgICAgICAgICBpZiggdGhpcy5idWlsZF92ZXJ0aWNhbCApIHtcclxuICAgICAgICAgICAgICAgICAgICB5ICs9IHRoaXMueV9pbmM7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIHkgPj0gdGhpcy55X21heCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHkgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgeCArPSB0aGlzLnhfaW5jO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1lbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB4ICs9IHRoaXMueF9pbmM7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoIHggPj0gdGhpcy54X21heCApIHtcclxuICAgICAgICAgICAgICAgICAgICAgIHggPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgeSArPSB0aGlzLnlfaW5jO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFjdGl2YXRlIDogZnVuY3Rpb24oICBpbmFjdGl2ZUNhbGxiYWNrICkge1xyXG4gICAgICAgICAgICBkb21FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIGlnbm9yZSwgZmFsc2UgKTtcclxuICAgICAgICBcdGRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNlZG93bicsIG9uTW91c2VEb3duLCBmYWxzZSApO1xyXG4gICAgICAgIFx0ZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2V3aGVlbCcsIG9uTW91c2VXaGVlbCwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9tRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbk1vdXNlVXAsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIG9uS2V5RG93biwgZmFsc2UgKTtcclxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoICdrZXl1cCcsIG9uS2V5VXAsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGludmVudG9yeS5USFJFRV9zb2xpZC52aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgaW52ZW50b3J5LmVuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiggaW5hY3RpdmVDYWxsYmFjayApXHJcbiAgICAgICAgICAgICAgICBpbnZlbnRvcnkuZGVhY3RpdmF0ZXMucHVzaCggaW5hY3RpdmVDYWxsYmFjayApXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkZWFjdGl2YXRlIDogZnVuY3Rpb24oICkge1xyXG4gICAgICAgICAgICBkb21FbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdjb250ZXh0bWVudScsIGlnbm9yZSwgZmFsc2UgKTtcclxuICAgICAgICAgICAgZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vkb3duJywgb25Nb3VzZURvd24sIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNld2hlZWwnLCBvbk1vdXNlV2hlZWwsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIC8vZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnRE9NTW91c2VTY3JvbGwnLCBvbk1vdXNlV2hlZWwsIGZhbHNlICk7IC8vIGZpcmVmb3hcclxuICAgICAgICAgICAgZG9tRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCAnbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIGRvbUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ21vdXNldXAnLCBvbk1vdXNlVXAsIGZhbHNlICk7XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAna2V5ZG93bicsIG9uS2V5RG93biwgZmFsc2UgKTtcclxuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICdrZXl1cCcsIG9uS2V5VXAsIGZhbHNlICk7XHJcblxyXG4gICAgICAgICAgICBpbnZlbnRvcnkuVEhSRUVfc29saWQudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpbnZlbnRvcnkuZW5hYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiggaW52ZW50b3J5LmRlYWN0aXZhdGVzLmxlbmd0aCApIHtcclxuICAgICAgICAgICAgICAgIGludmVudG9yeS5kZWFjdGl2YXRlcy5mb3JFYWNoKCAoY2IpPT5jYigpICk7XHJcbiAgICAgICAgICAgICAgICBpbnZlbnRvcnkuZGVhY3RpdmF0ZXMubGVuZ3RoID0gMDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9LFxyXG4gICAgICAgIGFuaW1hdGUgOiBmdW5jdGlvbiggY2FtZXJhLCB0aWNrICkge1xyXG4gICAgICAgICAgICBpZiggIWNhbWVyYSApcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiggIWludmVudG9yeS5lbmFibGVkKSByZXR1cm47XHJcbiAgICAgICAgICAgIHZhciBvO1xyXG5cdFx0XHR2YXIgaW52ZW50b3J5TztcclxuICAgICAgICAgICAgdmFyIGY7XHJcblxyXG4gICAgICAgICAgICAoIGludmVudG9yeU8gPSB0aGlzLlRIUkVFX3NvbGlkLm1hdHJpeC5vcmlnaW4vKnBvc2l0aW9uKi8gICkuY29weSggY2FtZXJhLm1hdHJpeC5vcmlnaW4gKTtcclxuICAgICAgICAgICAgLy9mID0gY2FtZXJhLm1hdHJpeC5mb3J3YXJkXHJcblxyXG5cdFx0XHRvID0gaW52ZW50b3J5LnJheWNhc3Rlci5yYXkub3JpZ2luLmNsb25lKCk7XHJcblx0XHRcdGYgPSBpbnZlbnRvcnkucmF5Y2FzdGVyLnJheS5kaXJlY3Rpb247XHJcblxyXG4gICAgICAgICAgICBvLmFkZFNjYWxlZFZlY3RvciggZiwgMTEgKTtcclxuXHJcblx0XHRcdHZhciB0bXBkZWwgPSBmLmRvdCggY2FtZXJhLm1hdHJpeC5mb3J3YXJkLmRlbGV0ZSgpICk7XHJcblx0XHRcdGludmVudG9yeU8uYWRkU2NhbGVkVmVjdG9yKCBjYW1lcmEubWF0cml4LmZvcndhcmQuZGVsZXRlKCksICAxMSAvIHRtcGRlbCApO1xyXG5cclxuICAgICAgICAgICAgdmFyIG0gPSB0aGlzLlRIUkVFX3NvbGlkLm1hdHJpeDtcclxuICAgICAgICAgICAgdmFyIGF3YXkgPSBjYW1lcmEubWF0cml4Lm9yaWdpbi5jbG9uZSgpLmFkZFNjYWxlZFZlY3RvciggbywgMiApXHJcbiAgICAgICAgICAgIG0ubG9va0F0KCBvLCBjYW1lcmEubWF0cml4Lm9yaWdpbiwgY2FtZXJhLm1hdHJpeC51cCApXHJcbiAgICAgICAgICAgIG0ucm90YXRlT3J0aG8oIE1hdGguUEksIDAsIDIgKTtcclxuICAgICAgICAgICAgLy92YXIgZCA9IGNhbWVyYS5tYXRyaXguZG93bjtcclxuICAgICAgICAgICAgaW52ZW50b3J5Ty5hZGRTY2FsZWRWZWN0b3IoIG0uZG93bi5kZWxldGUoKSwgKHRoaXMueV9tYXgtdGhpcy55X2luYykvMiApO1xyXG4gICAgICAgICAgICBpbnZlbnRvcnlPLmFkZFNjYWxlZFZlY3RvciggbS5yaWdodC5kZWxldGUoKSwgKHRoaXMueF9tYXgtdGhpcy54X2luYykvMiApO1xyXG5cclxuXHJcblx0XHRcdC8vaW52ZW50b3J5Ty5jb3B5KCBvICk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLlRIUkVFX3NvbGlkLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaW52ZW50b3J5Lmxhc3RfaW50ZXJzZWN0cyA9IGludmVudG9yeS5yYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyggaW52ZW50b3J5LlRIUkVFX3NvbGlkLmNoaWxkcmVuICk7XHJcbiAgICAgICAgICAgIGludmVudG9yeS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwgPSBudWxsO1xyXG4gICAgICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBpbnZlbnRvcnkubGFzdF9pbnRlcnNlY3RzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgaWYoIGludmVudG9yeS5sYXN0X2ludGVyc2VjdHNbaV0ub2JqZWN0ICE9PSBpbnZlbnRvcnkuc2VsZWN0b3IuVEhSRUVfc29saWQgKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW52ZW50b3J5LnNlbGVjdG9yLmN1cnJlbnRWb3hlbCA9IGludmVudG9yeS5sYXN0X2ludGVyc2VjdHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvL2ludmVudG9yeS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwgPSBpbnRlcnNlY3RzW2ldO1xyXG4gICAgICAgICAgICAgICAgLy9pbnZlbnRvcnkuc2VsZWN0b3IuY3VycmVudFZveGVsID0gaW50ZXJzZWN0c1tpXS5vYmplY3QuaXRlbVxyXG4gICAgICAgICAgICAgICAgLy9pbnRlcnNlY3RzWyBpIF0ub2JqZWN0Lm1hdGVyaWFsLmNvbG9yLnNldCggMHhmZjAwMDAgKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIG9iajtcclxuICAgICAgICAgICAgaWYoIGludmVudG9yeS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwgKSB7XHJcbiAgICAgICAgICAgICAgICBvYmogPSBpbnZlbnRvcnkuc2VsZWN0b3IuY3VycmVudFZveGVsLm9iamVjdDtcclxuICAgICAgICAgICAgICAgIG9iai5tYXRyaXgubW90aW9uLnJvdGF0aW9uLnggPSAwLjUwO1xyXG4gICAgICAgICAgICAgICAgb2JqLm1hdHJpeC5tb3Rpb24ucm90YXRpb24ueSA9IDEuNTA7XHJcbiAgICAgICAgICAgICAgICBvYmoubWF0cml4Lm1vdGlvbi5yb3RhdGlvbi56ID0gMi4zMDtcclxuICAgICAgICAgICAgICAgIC8vb2JqLm1hdHJpeC5tb3Rpb24udG9ycXVlLnggPSAwLjI1O1xyXG4gICAgICAgICAgICAgICAgb2JqLm1hdHJpeC5tb3ZlKHRpY2spO1xyXG4gICAgICAgICAgICAgICAgb2JqLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB1cGRhdGVTZWxlY3RvcigpO1xyXG4gICAgICAgICAgICAvL2lmKCBpbnZlbnRvcnkuc2VsZWN0b3IuY3VycmVudFZveGVsIClcclxuICAgICAgICAgICAgLy8gICAgaW52ZW50b3J5LnNlbGVjdG9yLmN1cnJlbnRWb3hlbC5vYmplY3QudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvL2ZvciAoIHZhciBpID0gMDsgaSA8IGludmVudG9yeS5sYXN0X2ludGVyc2VjdHMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCBpbnZlbnRvcnkubGFzdF9pbnRlcnNlY3RzW2ldKVxyXG4gICAgICAgIFx0XHQvL2ludGVyc2VjdHNbIGkgXS5vYmplY3QubWF0ZXJpYWwuY29sb3Iuc2V0KCAweGZmMDAwMCApO1xyXG5cclxuICAgICAgICBcdC8vfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHR5cGVzLnR5cGVzLmZvckVhY2goICh2b3hlbCk9PntcclxuICAgICAgICB2YXIgaXRlbTtcclxuICAgICAgICBpbnZlbnRvcnkuaXRlbXMucHVzaCggaXRlbSA9IEludmVudG9yeUl0ZW0oIHZveGVsICkgKTtcclxuICAgICAgICBpbnZlbnRvcnkuVEhSRUVfc29saWQuYWRkKCBpdGVtLlRIUkVFX3NvbGlkID0gbmV3IFRIUkVFLk1lc2goIGl0ZW0uZ2VvbWV0cnkuZ2VvbWV0cnksIGdlb21ldHJ5U2hhZGVyICkgKTtcclxuICAgICAgICBpdGVtLlRIUkVFX3NvbGlkLmZydXN0dW1DdWxsZWQgPSBmYWxzZTtcclxuICAgICAgICBpdGVtLlRIUkVFX3NvbGlkLml0ZW0gPSBpdGVtO1xyXG4gICAgICAgIGl0ZW0uVEhSRUVfc29saWQubWF0cml4QXV0b1VwZGF0ZSA9IGZhbHNlO1xyXG4gICAgfSlcclxuICAgIGludmVudG9yeS51cGRhdGVQb3NpdGlvbnMoKTtcclxuICAgIGludmVudG9yeS5USFJFRV9zb2xpZC5tYXRyaXhBdXRvVXBkYXRlID0gZmFsc2U7XHJcbiAgICBpbnZlbnRvcnkuVEhSRUVfc29saWQudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgdmFyIGN1cnJlbnRSZWY7XHJcbiAgICB2YXIgY3VycmVudEFkZFJlZjtcclxuXHJcbiAgICBpbnZlbnRvcnkuc2VsZWN0b3IgPSB7XHJcblxyXG4gICAgICAgIGdldCBjdXJyZW50Vm94ZWwgKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY3VycmVudFJlZjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldCBjdXJyZW50Vm94ZWwgKHJlZikge1xyXG4gICAgICAgICAgICBjdXJyZW50UmVmID0gcmVmO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0IGN1cnJlbnRBZGRWb3hlbCAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50QWRkUmVmO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc2V0IGN1cnJlbnRBZGRWb3hlbCAocmVmKSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRBZGRSZWYgPSByZWY7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBtYXRlcmlhbCA6IG5ldyBUSFJFRS5MaW5lQmFzaWNNYXRlcmlhbCh7IGNvbG9yOid3aGl0ZSdcclxuICAgICAgICAgICAgLy8sdmVydGV4Q29sb3JzOiBUSFJFRS5WZXJ0ZXhDb2xvcnNcclxuICAgICAgICAgICAgLGxpbmV3aWR0aDoxIC8qIHdpbmRvd3MgPT0gMSBhbHdheXMgKi9cclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgZ2VvbWV0cnkgOiBuZXcgVEhSRUUuR2VvbWV0cnkoKSxcclxuICAgICAgICBUSFJFRV9zb2xpZCA6IG51bGwsXHJcbiAgICAgICAgbWVzaEdsb3cgOiBudWxsLFxyXG4gICAgfTtcclxuICAgIGludmVudG9yeS5zZWxlY3Rvci5tYXRlcmlhbC5kZXB0aFdyaXRlID0gZmFsc2U7XHJcbiAgICBpbnZlbnRvcnkuc2VsZWN0b3IubWF0ZXJpYWwuZGVwdGhUZXN0ID0gZmFsc2U7XHJcblxyXG4gICAgaW52ZW50b3J5LnNlbGVjdG9yLlRIUkVFX3NvbGlkID0gbmV3IFRIUkVFLkxpbmVTZWdtZW50cyggaW52ZW50b3J5LnNlbGVjdG9yLmdlb21ldHJ5LCBpbnZlbnRvcnkuc2VsZWN0b3IubWF0ZXJpYWwgKTtcclxuICAgIGludmVudG9yeS5zZWxlY3Rvci5tZXNoR2xvdyA9IG5ldyBUSFJFRS5MaW5lU2VnbWVudHMoIGludmVudG9yeS5zZWxlY3Rvci5nZW9tZXRyeSwgaW52ZW50b3J5LnNlbGVjdG9yLm1hdGVyaWFsICk7XHJcbiAgICBpbnZlbnRvcnkuc2VsZWN0b3IuVEhSRUVfc29saWQuZnJ1c3R1bUN1bGxlZCA9IGZhbHNlO1xyXG5cclxuICAgIGludmVudG9yeS5USFJFRV9zb2xpZC5hZGQoIGludmVudG9yeS5zZWxlY3Rvci5USFJFRV9zb2xpZCApO1xyXG5cclxuXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVTZWxlY3RvcigpIHtcclxuICAgICAgICB2YXIgY29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoIDAuOCwgMCwgMCApO1xyXG4gICAgICAgIHZhciB1bml0ID0gMC44O1xyXG4gICAgICAgIHZhciB4ID0gMFxyXG4gICAgICAgIHZhciB5ID0gMFxyXG4gICAgICAgIHZhciB6ID0gMFxyXG4gICAgICAgIHZhciBnZW9tZXRyeSA9IGludmVudG9yeS5zZWxlY3Rvci5nZW9tZXRyeTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5sZW5ndGggPSAwO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5sZW5ndGggPSAwO1xyXG4gICAgICAgIGlmKCAhY3VycmVudFJlZiApe1xyXG4gICAgICAgICAgICBnZW9tZXRyeS5jb21wdXRlQm91bmRpbmdTcGhlcmUoKTtcclxuICAgICAgICAgICAgZ2VvbWV0cnkudmVydGljZXNOZWVkVXBkYXRlID0gdHJ1ZTtcclxuICAgICAgICAgICAgZ2VvbWV0cnkuY29sb3JzTmVlZFVwZGF0ZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBvcmlnaW4gPSBjdXJyZW50UmVmLm9iamVjdC5tYXRyaXgub3JpZ2luO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coIGBpbnZlbnRvcnkgYXQgJHtvcmlnaW4ueH0gJHtvcmlnaW4ueX0gJHtvcmlnaW4uen1gKVxyXG4gICAgICAgIGZvciggdmFyIG4gPSAwOyBuIDwgMTsgbisrICkge1xyXG4gICAgICAgICAgICB4ID0gb3JpZ2luLnggIC0gdW5pdC8yIC0gMC4xXHJcbiAgICAgICAgICAgIHkgPSBvcmlnaW4ueSAgLSB1bml0LzIgLSAwLjFcclxuICAgICAgICAgICAgeiA9IG9yaWdpbi56ICAtIHVuaXQvMiAtIDAuMVxyXG4gICAgICAgICAgdW5pdCArPSAwLjI7XHJcbiAgICAgICAgdmFyIFAgPSBbbmV3IFRIUkVFLlZlY3RvcjMoIHgsIHksIHogKVxyXG4gICAgICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4ICsgdW5pdCwgeSwgeiApXHJcbiAgICAgICAgICAgICwgbmV3IFRIUkVFLlZlY3RvcjMoIHgsIHkgKyB1bml0LCB6IClcclxuICAgICAgICAgICAgLCBuZXcgVEhSRUUuVmVjdG9yMyggeCArIHVuaXQsIHkgKyB1bml0LCB6IClcclxuICAgICAgICAgICAgLCBuZXcgVEhSRUUuVmVjdG9yMyggeCwgeSwgeiArIHVuaXQgKVxyXG4gICAgICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4ICsgdW5pdCwgeSwgeiArIHVuaXQgKVxyXG4gICAgICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4LCB5ICsgdW5pdCwgeiArIHVuaXQgKVxyXG4gICAgICAgICAgICAsIG5ldyBUSFJFRS5WZWN0b3IzKCB4ICsgdW5pdCwgeSArIHVuaXQsIHogKyB1bml0IClcclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbMF0gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzFdICk7XHJcbiAgICAgICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICAgICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFsxXSApO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbM10gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzNdICk7XHJcbiAgICAgICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICAgICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFsyXSApO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbMl0gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzBdICk7XHJcblxyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbNF0gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzVdICk7XHJcbiAgICAgICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICAgICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFs1XSApO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbN10gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzddICk7XHJcbiAgICAgICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICAgICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFs2XSApO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbNl0gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzRdICk7XHJcblxyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbMF0gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzRdICk7XHJcbiAgICAgICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICAgICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFsxXSApO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbNV0gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzJdICk7XHJcbiAgICAgICAgZ2VvbWV0cnkuY29sb3JzLnB1c2goIGNvbG9yICk7XHJcbiAgICAgICAgZ2VvbWV0cnkudmVydGljZXMucHVzaCggUFs2XSApO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbG9ycy5wdXNoKCBjb2xvciApO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzLnB1c2goIFBbM10gKTtcclxuICAgICAgICBnZW9tZXRyeS5jb2xvcnMucHVzaCggY29sb3IgKTtcclxuICAgICAgICBnZW9tZXRyeS52ZXJ0aWNlcy5wdXNoKCBQWzddICk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICAvL2NvbG9yLmRlbGV0ZSgpO1xyXG4gICAgICAgIGdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ1NwaGVyZSgpO1xyXG4gICAgICAgIGdlb21ldHJ5LnZlcnRpY2VzTmVlZFVwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgZ2VvbWV0cnkuY29sb3JzTmVlZFVwZGF0ZSA9IHRydWU7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHJldHVybiBpbnZlbnRvcnk7XHJcblxyXG5cclxuICAgICBmdW5jdGlvbiBzZXRNb3VzZVJheSggY2FtZXJhLCBlICkge1xyXG4gICAgICAgIHZhciByZWN0ID0gZG9tRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgICBjb25zdCB3ID0gcmVjdC5yaWdodC1yZWN0LmxlZnQ7Ly93aW5kb3cuaW5uZXJXaWR0aDtcclxuICAgICAgICBjb25zdCBoID0gcmVjdC5ib3R0b20tcmVjdC50b3A7Ly93aW5kb3cuaW5uZXJIZWlnaHQ7XHJcbiAgICAgICAgdmFyIHggPSAoKChlLmNsaWVudFgtcmVjdC5sZWZ0KS0ody8yLjApKS93KSAqIDI7XHJcbiAgICAgICAgdmFyIHkgPSAoKChlLmNsaWVudFktcmVjdC50b3ApLShoLzIuMCkpL2gpICogMjtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKCBgbW91c2UgYXQgJHt4fSwgJHt5fWAgKVxyXG5cclxuICAgICAgICBpbnZlbnRvcnkucmF5Y2FzdGVyLnNldEZyb21DYW1lcmEoIHt4OngseToteX0sIGNhbWVyYSApO1xyXG5cclxuICAgIH1cclxuXHJcblxyXG4gICAgICBmdW5jdGlvbiBvbk1vdXNlRG93bihldmVudCkge1xyXG4gICAgICAgICAgaWYgKCBpbnZlbnRvcnkuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgaWYoIGludmVudG9yeS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwgKSB7XHJcbiAgICAgICAgICAgICAgY29udHJvbEdhbWUuc2V0Q3VycmVudFR5cGUoIGludmVudG9yeS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwub2JqZWN0Lml0ZW0udm94ZWxUeXBlICk7XHJcblxyXG4gICAgICAgICAgICAgIGludmVudG9yeS5kZWFjdGl2YXRlKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICAvL2ludmVudG9yeS5sYXN0X2ludGVyc2VjdHMgPSBpbnZlbnRvcnkucmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdHMoIGludmVudG9yeS5USFJFRV9zb2xpZC5jaGlsZHJlbiApO1xyXG4gICAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgaW52ZW50b3J5Lmxhc3RfaW50ZXJzZWN0cy5sZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgICBpZiggaW52ZW50b3J5Lmxhc3RfaW50ZXJzZWN0c1tpXS5vYmplY3QgIT09IGludmVudG9yeS5zZWxlY3Rvci5USFJFRV9zb2xpZCApIHtcclxuICAgICAgICAgICAgICAgICAgaW52ZW50b3J5LnNlbGVjdG9yLmN1cnJlbnRWb3hlbCA9IGludmVudG9yeS5sYXN0X2ludGVyc2VjdHNbaV07XHJcbiAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAvL2ludmVudG9yeS5zZWxlY3Rvci5jdXJyZW50Vm94ZWwgPSBpbnRlcnNlY3RzW2ldO1xyXG4gICAgICAgICAgICAgIC8vaW52ZW50b3J5LnNlbGVjdG9yLmN1cnJlbnRWb3hlbCA9IGludGVyc2VjdHNbaV0ub2JqZWN0Lml0ZW1cclxuICAgICAgICAgICAgICAvL2ludGVyc2VjdHNbIGkgXS5vYmplY3QubWF0ZXJpYWwuY29sb3Iuc2V0KCAweGZmMDAwMCApO1xyXG5cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIG9uTW91c2VVcChldmVudCkge1xyXG4gICAgICAgICAgaWYgKCBpbnZlbnRvcnkuZW5hYmxlZCA9PT0gZmFsc2UgKSByZXR1cm47XHJcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uTW91c2VNb3ZlKCBldmVudCApIHtcclxuICAgICAgICBcdGlmICggaW52ZW50b3J5LmVuYWJsZWQgPT09IGZhbHNlICkgcmV0dXJuO1xyXG4gICAgICAgIFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgc2V0TW91c2VSYXkoIGNhbWVyYSwgZXZlbnQgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uTW91c2VXaGVlbCggZXZlbnQgKSB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIG1vdXNlU2Nyb2xsWCArPSBldmVudC53aGVlbERlbHRhWDtcclxuICAgICAgICAgICAgbW91c2VTY3JvbGxZICs9IGV2ZW50LndoZWVsRGVsdGFZO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIGZ1bmN0aW9uIGlnbm9yZShldmVudCkge1xyXG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gb25LZXlEb3duKCBldmVudCApIHtcclxuXHJcblxyXG4gICAgICBcdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XHJcbiAgICAgICAgICAgIGNhc2Uga2V5cy5FU0NBUEU6XHJcbiAgICAgIFx0XHRjYXNlIGtleXMuSTpcclxuICAgICAgXHRcdFx0aW52ZW50b3J5LmRlYWN0aXZhdGUoKTtcclxuICAgICAgXHRcdFx0YnJlYWs7XHJcbiAgICAgIFx0fVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgZnVuY3Rpb24gb25LZXlVcCggZXZlbnQgKSB7XHJcblxyXG4gICAgICBcdHN3aXRjaCAoIGV2ZW50LmtleUNvZGUgKSB7XHJcbiAgICAgIFx0fVxyXG4gICAgICB9XHJcblxyXG5cclxufVxyXG4iLCJcbi8vdmFyIEd1biA9IHJlcXVpcmUoIFwiZ3VuXCIgKTtcbnZhciBHdW4gPSByZXF1aXJlKCBcIi4uL25vZGVfbW9kdWxlcy9ndW4vZ3VuLmpzXCIgKTtcblxudmFyIGRiID0ge307XG5Wb3hlbGFyaXVtLmRiID0gZGI7XG5cbi8vVm94ZWxhcml1bS5kYiA9IGRiO1xuXG4vL2dsb2JhbCA9IEd1bih7cHJlZml4OiAnZ2xvYmFsLycsIHBlZXJzOiBbJ2h0dHBzOi8vbG9jYWxob3N0OjgwODAvZ3VuJ119KVxuLy9sb2NhbCA9IEd1bih7cHJlZml4OiAnbG9jYWwvJ30pLlxuXG5cbmRiLmdsb2JhbERiID0gR3VuKCB7cHJlZml4OiAnZ2xvYmFsLycsIHBlZXJzOiBbYHdzOi8vJHtsb2NhdGlvbi5ob3N0fS9ndW5gXX0gKS5nZXQoIFwiVm94ZWxhcml1bVwiICk7XG4vL2RiLmdsb2JhbERiID0gR3VuKCBsb2NhdGlvbi5vcmlnaW4gKyAnL2d1bicgKS5nZXQoIFwiVm94ZWxhcml1bVwiICk7XG4vL2RiLmdsb2JhbERiID0gR3VuKCB7cHJlZml4OiAnZ2xvYmFsLycsIHBlZXJzOiBbYGh0dHBzOi8vJHtsb2NhdGlvbi5vcmlnaW59L2d1bmBdfSApLmdldCggXCJWb3hlbGFyaXVtXCIgKTtcbmRiLmxvY2FsRGIgPSBHdW4oIHtwcmVmaXg6ICdsb2NhbC8nfSkuZ2V0KCBcIm9yZy5kM3gwci52b3hlbGFyaXVtLmxvY2FsXCIgKTtcbi8vZGIubG9jYWxEYiA9IGRiLmdsb2JhbERiLnBhdGgoIFwibG9jYWxcIiApO1xuXG5kYi53b3JsZCA9IHtcbiAgICBkYiA6IG51bGwsIC8vZGIuZ2xvYmFsRGJcbiAgICBjbHVzdGVyIDogbnVsbCxcbiAgICBsb2FkU2VjdG9yIDogbG9hZFNlY3RvcixcbiAgICBzdG9yZVNlY3RvciA6IHN0b3JlU2VjdG9yLFxuICAgIGdldFBhdGggOiBnZXRQYXRoLFxuICAgIGxpc3RlbmVycyA6IFtdLFxufVxuXG5kYi5wbGF5ZXIgPSB7IGxvY2FsOiBkYi5sb2NhbERiLnBhdGgoIFwicGxheWVyXCIgKVxuICAgICAgICAsIGdsb2JhbCA6IG51bGwgLy8gaGF2ZSB0byB3YWl0IGZvciBwbGF5ZXIgSUQgYmVmb3JlXG4gICAgICAgICwgX3F1YXQ6IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKClcbiAgICAgICAgLCBfb3JpZ2luIDogbmV3IFRIUkVFLlZlY3RvcjMoKVxuICAgICAgICAsIHF1YXQ6IG5ldyBUSFJFRS5RdWF0ZXJuaW9uKClcbiAgICAgICAgLCBvcmlnaW4gOiBuZXcgVEhSRUUuVmVjdG9yMygpXG4gICAgICAgICwgcG9zaXRpb25VcGRhdGUgOiBmYWxzZVxuICAgICAgICAsIGludmVudG9yeSA6IFtdXG4gICAgICAgICwgaWQgOiBudWxsXG4gICAgICAgICwgd29ybGRfaWQgOiBudWxsXG4gICAgfVxuXG5mdW5jdGlvbiBzZWN0b3JVcGRhdGVkKCBzZWN0b3IsIHN0dWZmICkge1xuICB2YXIgeCwgeSwgejtcbiAgdmFyIGJhc2VfeCA9ICggc2VjdG9yLnBvcy54ID4+IDIgKSAqIDQ7XG4gIHZhciBiYXNlX3kgPSAoIHNlY3Rvci5wb3MueSA+PiAyICkgKiA0O1xuICB2YXIgYmFzZV96ID0gKCBzZWN0b3IucG9zLnogPj4gMiApICogNDtcbiAgY29uc29sZS5sb2coIFwiR290IHNlY3RvciB1cGRhdGUgZXZlbnRcIiwgc3R1ZmYpXG4gIGZvciggeCA9IDA7IHggPD0gMzsgeCsrIClcbiAgICBmb3IoIHkgPSAwOyB5IDw9IDM7IHkrKyApXG4gICAgICBmb3IoIHogPSAwOyB6IDw9IDM7IHorKyApIHtcbiAgICAgICAgdmFyIGtleSA9IGAke3h9JHt5fSR7en1gXG4gICAgICAgIHZhciB2YWw7XG4gICAgICAgIGlmKCB2YWwgPSBzdHVmZltrZXldICkge1xuICAgICAgICAgIHZhciBzZWN0b3IgPSBkYi53b3JsZC5jbHVzdGVyLmdldFNlY3RvciggYmFzZV94ICsgeCwgYmFzZV95ICsgeSwgYmFzZV96ICsgeiwgdHJ1ZSApXG4gICAgICAgICAgaWYoIHNlY3RvciApXG4gICAgICAgICAgICBpZiggc2VjdG9yLmNhY2hlZFN0cmluZyAhPT0gdmFsICkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyggXCJuZXcgc2VjdG9yIHN0cmluZyAtIG5lZWQgZGVjb2RlLlwiKVxuICAgICAgICAgICAgICBzZWN0b3IuZGVjb2RlKCB2YWwgKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbn1cblxuZnVuY3Rpb24gYWRkTGlzdGVuZXIoIHNlY3RvciApIHtcbiAgdmFyIHdoZXJlID0gZ2V0Wm9uZVBhdGgoc2VjdG9yKTtcbiAgaWYoIGRiLndvcmxkLmxpc3RlbmVycy5maW5kSW5kZXgoICh2YWwpPT53aGVyZT09PXZhbCApIDwgMCApIHtcbiAgICBkYi53b3JsZC5saXN0ZW5lcnMucHVzaCggd2hlcmUgKTtcbiAgICBkYi53b3JsZC5kYi5wYXRoKCB3aGVyZSApLm9uKCAoZGF0YSk9Pnsgc2VjdG9yVXBkYXRlZChzZWN0b3IsZGF0YSkgfSwgeyBkZWx0YTogdHJ1ZSB9IClcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFpvbmVQYXRoKCBzZWN0b3IgKSB7XG4gIHJldHVybiBgc2VjdG9yLiR7c2VjdG9yLnBvcy54Pj4yfS4ke3NlY3Rvci5wb3MueT4+Mn0uJHtzZWN0b3IucG9zLno+PjJ9YFxufVxuZnVuY3Rpb24gZ2V0UGF0aCggc2VjdG9yICkge1xuICByZXR1cm4gYCR7Z2V0Wm9uZVBhdGgoc2VjdG9yKX0uJHtzZWN0b3IucG9zLngmM30ke3NlY3Rvci5wb3MueSYzfSR7c2VjdG9yLnBvcy56JjN9YFxufVxuLy9kYi5wbGF5ZXIgPSBkYi5nbG9iYWxEYi5nZXQoIFwicGxheWVyXCIgKTtcblxuZnVuY3Rpb24gcGxheWVyUG9zaXRpb25DaGFuZ2UoIGRhdGEgKSB7XG4gICAgdmFyIGxhc3RxID0gZGIucGxheWVyLnF1YXRcbiAgICB2YXIgcSA9IGRiLnBsYXllci5fcXVhdC5zZXQoIGRhdGEucXgsZGF0YS5xeSxkYXRhLnF6LGRhdGEucXcpXG4gICAgdmFyIGxhc3RvID0gZGIucGxheWVyLm9yaWdpblxuICAgIHZhciBvID0gZGIucGxheWVyLl9vcmlnaW4uc2V0KCBkYXRhLm94LCBkYXRhLm95LCBkYXRhLm96ICk7XG4gICAgaWYoIHEueCAhPSBsYXN0cS54IHx8XG4gICAgICAgIHEueSAhPSBsYXN0cS55IHx8XG4gICAgICAgIHEueiAhPSBsYXN0cS56IHx8XG4gICAgICAgIHEudyAhPSBsYXN0cS53XG4gICAgKSB7XG4gICAgICAgIHZhciBhID0gKCBxLnggLSBsYXN0cS54ICk7XG4gICAgICAgIHZhciBiID0gKCBxLnkgLSBsYXN0cS55ICk7XG4gICAgICAgIHZhciBjID0gKCBxLnogLSBsYXN0cS56ICk7XG5cbiAgICAgICAgaWYoIGEqYStiKmIrYypjID4gMC4wMDEgKVxuICAgICAgICB7XG4gICAgICAgICAgICBkYi5wbGF5ZXIucG9zaXRpb25VcGRhdGUgPSB0cnVlOyAvLyBza2lwIG5leHQgYW5pbWF0ZSB1cGRhdGVcbiAgICAgICAgICAgIFZveGVsYXJpdW0uY2FtZXJhLm1hdHJpeC5tYWtlUm90YXRpb25Gcm9tUXVhdGVybmlvbiggZGIucGxheWVyLl9xdWF0ICk7XG4gICAgICAgICAgICBWb3hlbGFyaXVtLmNhbWVyYS5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiggby54ICE9IGxhc3RvLnggfHxcbiAgICAgICAgby55ICE9IGxhc3RvLnkgfHxcbiAgICAgICAgby56ICE9IGxhc3RvLnpcbiAgICAgICAgICAgICkge1xuICAgICAgICB2YXIgYSA9ICggby54IC0gbGFzdG8ueCApO1xuICAgICAgICB2YXIgYiA9ICggby55IC0gbGFzdG8ueSApO1xuICAgICAgICB2YXIgYyA9ICggby56IC0gbGFzdG8ueiApO1xuXG4gICAgICAgIGlmKCBhKmErYipiK2MqYyA+IDAuMDAxIClcbiAgICAgICAge1xuICAgICAgICAgICAgZGIucGxheWVyLnBvc2l0aW9uVXBkYXRlID0gdHJ1ZTsgLy8gc2tpcCBuZXh0IGFuaW1hdGUgdXBkYXRlXG4gICAgICAgICAgICBWb3hlbGFyaXVtLmNhbWVyYS5wb3NpdGlvbi5jb3B5KCBvICk7XG4gICAgICAgICAgICBWb3hlbGFyaXVtLmNhbWVyYS5tYXRyaXhXb3JsZE5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvL2NvbnNvbGUubG9nKCBcImRhdGEgOiBcIiwgZGF0YSk7XG59XG5cblxuZnVuY3Rpb24gc2V0dXBFdmVudHMoIGNiICkge1xuICAgIC8vZGIucGxheWVyLmxvY2FsLnBhdGgoXCJwb3NpdGlvblwiKS5vbiggcGxheWVyUG9zaXRpb25DaGFuZ2UgKTtcbiAgICBkYi5wbGF5ZXIuZ2xvYmFsLnBhdGgoXCJwb3NpdGlvblwiKS5vbiggcGxheWVyUG9zaXRpb25DaGFuZ2UgKTtcbiAgICBsb2FkV29ybGQoIGNiICk7XG59XG5cbmZ1bmN0aW9uIGxvYWRWb3hlbHMoY2IsIHZhbCl7XG4gIHZhciBjb3VudCA9IHZhbC52b3hlbFR5cGVDb3VudDtcbiAgLy9jb25zb2xlLmxvZyggXCJoYXZlIFwiICwgY291bnQgKVxuICBkYi53b3JsZC52b3hlbEluZm8ucGF0aCggXCJ2b3hlbFR5cGVzXCIgKS5tYXAoIChkYXRhLGZpZWxkKT0+e1xuICAgICAgdmFyIHQgPSBWb3hlbGFyaXVtLlZveGVscy50eXBlc1tOdW1iZXIoZmllbGQpXTtcbiAgICAgIGlmKCB0ICkgcmV0dXJuO1xuICAgICAgLy9jb25zb2xlLmxvZyggXCJyZWxvYWRpbmcgXCIsIGZpZWxkLCBkYXRhLklEKVxuICAgICAgdCA9IFZveGVsYXJpdW0uVm94ZWxzLnR5cGVzW2RhdGEuSURdID0gZXZhbCggZGF0YS5jb2RlICk7XG5cbiAgICAgIGlmKCBkYXRhLnRleHR1cmUgKSB7XG4gICAgICAgIGNvdW50Kys7XG4gICAgICAgICggdC5pbWFnZSA9IG5ldyBJbWFnZSgpICkuc3JjID0gdC50ZXh0dXJlRGF0YSA9IGRhdGEudGV4dHVyZTtcblxuICAgICAgICAgIHQuaW1hZ2Uub25sb2FkID0gKCk9PiB7XG4gICAgICAgICAgICAgLy9jb25zb2xlLmxvZyggXCJXYWl0IHVudGlsIGxvYWQgdG8gc2V0dXAgY29vcmRzXCIpXG4gICAgICAgICAgICAgdC50ZXh0dXJlQ29vcmRzID0gVm94ZWxhcml1bS5UZXh0dXJlQXRsYXMuYWRkKCB0LmltYWdlIClcbiAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCBcInBlbmRpbmcgXCIsIGNvdW50ICk7XG4gICAgICAgICAgICAgaWYoICEtLWNvdW50ICkgeyBjb25zb2xlLmxvZyggXCJaRVJPIVwiICk7IGNiKCk7IH1cbiAgICAgICAgICB9XG5cbiAgICAgIH1cbiAgICAgIGlmKCAhLS1jb3VudCApIGNiKCk7XG4gIH0pO1xufVxuXG5cbmZ1bmN0aW9uIGluaXRpYWxWb3hlbFR5cGVMb2FkKGJyYW5jaCxjYikge1xuICAgIGNvbnNvbGUubG9nKCBcIkxvYWRpbmcgaW5pdGlhbCB2b3hlbHMuLi5cIilcbiAgICBWb3hlbGFyaXVtLlZveGVscy5sb2FkKCAoKT0+e1xuICAgICAgICB2YXIgdm94ZWxUeXBlcyA9IHt9O1xuICAgICAgICB2YXIgbiA9IDA7XG4gICAgICAgIFZveGVsYXJpdW0uVm94ZWxzLnR5cGVzLmZvckVhY2goICh0eXBlKT0+e1xuICAgICAgICAgICAgaWYoICF0eXBlLklEICkgcmV0dXJuO1xuICAgICAgICAgICAgbisrO1xuICAgICAgICAgICAgdm94ZWxUeXBlc1sgdHlwZS5JRCBdID0geyBJRDp0eXBlLklELCBjb2RlOiB0eXBlLmNvZGVEYXRhLCB0ZXh0dXJlIDogdHlwZS50ZXh0dXJlRGF0YX07XG4gICAgICAgIH0pO1xuICAgICAgICBicmFuY2gucHV0KCB7IHZveGVsVHlwZXMgOiB2b3hlbFR5cGVzLCB2b3hlbFR5cGVDb3VudCA6IG4gfSApO1xuICAgICAgICBjYigpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBsb2FkV29ybGQoIGNiICkge1xuICAgICggZGIud29ybGQudm94ZWxJbmZvID0gZGIud29ybGQuZGIucGF0aCggXCJ2b3hlbEluZm9cIiApIClcbiAgICAgICAgLm5vdCggZnVuY3Rpb24oKXtcbiAgICAgICAgICBjb25zb2xlLmxvZyggXCJObyBWb3hlbEluZm87IGxvYWQgZGVmYXVsdFwiKTtcbiAgICAgICAgICAgIGluaXRpYWxWb3hlbFR5cGVMb2FkKGRiLndvcmxkLnZveGVsSW5mbyxjYilcbiAgICAgICAgIH0pLnZhbCggKHZhbCk9PntcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCBcInNraXAgYSBiZWF0IGFuZCBsb2FkIHRoZSB2b3hlbHMuLi4uXCIpXG4gICAgICAgICAgIHNldFRpbWVvdXQoXG4gICAgICAgICAgICAgICAoKT0+eyBsb2FkVm94ZWxzKGNiLHZhbCkgfVxuICAgICAgICAgICAgIClcbiAgICAgICAgfSApO1xufVxuXG5mdW5jdGlvbiBkb0RlZmF1bHRJbml0KCBkYXRhICkge1xuICAgIGlmKCAhZGIucGxheWVyLmlkICkge1xuICAgICAgICBjb25zb2xlLmxvZyggXCJkbyBkZWZhdWx0IGluaXQuLi4gcGljayBhIHBsYXllciBJRCBhbmQgZ2l2ZSBoaW0gYW4gaW5pdGlhbCB3b3JsZF9pZFwiKVxuICAgICAgICBkYi5wbGF5ZXIuaWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICAgZGIucGxheWVyLndvcmxkX2lkID0gMDtcbiAgICAgICAgY29uc29sZS5sb2coIFwicHV0IGxvY2FsLmlkPXBsYXllci5pZFwiKVxuICAgICAgICBkYi5wbGF5ZXIubG9jYWwucGF0aChcImlkXCIpLnB1dCggZGIucGxheWVyLmlkIClcbiAgICAgICAgY29uc29sZS5sb2coIFwicHV0IGxvY2FsLndvcmxkX2lkPXBsYXllci53b3JsZF9pZFwiKVxuICAgICAgICBkYi5wbGF5ZXIubG9jYWwucGF0aChcIndvcmxkX2lkXCIpLnB1dCggZGIucGxheWVyLndvcmxkX2lkIClcbiAgICAgICAgY29uc29sZS5sb2coIFwiZG9uZSBwdXR0aW5nIHdvcmxkX2lkXCIpXG4gICAgfWVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyggXCJza2lwcGVkIHJlZHVuZGFudCBpbml0XCIpXG4gICAgfVxuICAgIC8vIHRoZSB2YWwoKSBpbiBpbml0IHdpbGwgZmlyZSBoZXJlOyBzbyBnbG9iYWwgZ2V0cyBpbml0aWFsaXplZCBpbiBub3JtYWwgcGF0aC4uLlxufVxuXG5mdW5jdGlvbiBkb0RlZmF1bHRJbml0VHJpZ2dlcigpIHtcbiAgICBjb25zb2xlLmxvZyggXCJwdXQgaW5pdD10cnVlXCIpXG5cdCAgZGIucGxheWVyLmxvY2FsLnBhdGgoIFwiaW5pdFwiICkucHV0KCB0cnVlICk7XG4gICAgY29uc29sZS5sb2coIFwibG9jYWwgcHV0IGluaXQgaGFzIGZpbmlzaGVkIGZvciBpbml0YWwgRGIgS2ljaztcIiApO1xufVxuXG5mdW5jdGlvbiBkb0RlZmF1bHRHbG9iYWxJbml0VHJpZ2dlcigpIHtcbiAgICBjb25zb2xlLmxvZyggXCIga2ljayBnbG9iYWw/XCIpXG4gICAgZGIucGxheWVyLmdsb2JhbC5wYXRoKCBcImluaXRcIiApLnB1dCggdHJ1ZSApO1xuICAgIGNvbnNvbGUubG9nKCBcImdsb2JhbCBwdXQgaW5pdCBoYXMgZmluaXNoZWQgZm9yIGluaXRhbCBEYiBLaWNrXCIpXG5cbn1cblxuZnVuY3Rpb24gcGxheWVyQ29ubmVjdCggdmFsLCBmaWVsZCApIHtcbiAgY29uc29sZS5sb2coIFwicGxheWVyIGhhcyBjb25uZWN0ZWRcIiwgdmFsLCBmaWVsZCApO1xufVxuXG52YXIgZGVmYXVsdFRpbWVvdXQ7XG52YXIgZGVmYXVsdEdsb2JhbFRpbWVvdXQ7XG5kYi5pbml0ID0gZnVuY3Rpb24oIGNiICkge1xuICAgIC8vIGRlZmF1bHRUaW1lb3V0ID0gc2V0VGltZW91dCggZG9EZWZhdWx0SW5pdFRyaWdnZXIsIDI1MCApO1xuICAgIGRiLnBsYXllci5sb2NhbC5wYXRoKFwiaWRcIikubm90KCBkb0RlZmF1bHRJbml0ICkudmFsKCAoZGF0YSk9PntcbiAgICAgICAgY29uc29sZS5sb2coIFwidmFsdWUgaXMgXCIsIGRhdGEpXG4gICAgICAgIC8vY2xlYXJUaW1lb3V0KCBkZWZhdWx0VGltZW91dCApO1xuICAgICAgICBkYi5wbGF5ZXIuaWQgPSBkYXRhO1xuICAgICAgICBkYi5nbG9iYWxEYi5wYXRoKCBcInBsYXllclwiICkubWFwKCBwbGF5ZXJDb25uZWN0ICk7XG4gICAgICAgIGRiLnBsYXllci5nbG9iYWwgPSBkYi5nbG9iYWxEYi5wYXRoKCBcInBsYXllclwiICkucGF0aCggZGF0YSApO1xuICAgICAgICBjb25zb2xlLmxvZyggXCJnb2luZyB0byByZXF1ZXN0IHdvcmxkX2lkLi4uXCIpXG4gICAgICAgIGRiLnBsYXllci5sb2NhbC5wYXRoKFwid29ybGRfaWRcIikudmFsKCAoZGF0YSk9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyggXCJyZWNlaXZlZCB3b3JsZF9pZFwiKVxuICAgICAgICAgIGRiLnBsYXllci53b3JsZF9pZCA9IGRhdGE7XG4gICAgICAgICAgZGIud29ybGQuZGIgPSBkYi5nbG9iYWxEYi5wYXRoKCBcIndvcmxkXCIgKS5wYXRoKCBkYi5wbGF5ZXIud29ybGRfaWQgKTtcbiAgICAgICAgICBkYi5wbGF5ZXIuZ2xvYmFsLm1hcCgpLnZhbCggcGxheWVyQ29ubmVjdCApO1xuICAgICAgICAgIGRiLnBsYXllci5nbG9iYWwucGF0aChcInBvc2l0aW9uXCIpLm9uKCBwbGF5ZXJQb3NpdGlvbkNoYW5nZSApO1xuICAgICAgICAgIGxvYWRXb3JsZCggY2IgKTtcbiAgICAgICAgfSApO1xuICAgICAgICBjb25zb2xlLmxvZyggXCJyZXF1ZXN0ZWQgd29ybGQgaWQgLSBkb25lIHdpdGggdmFsIGNhbGxiYWNrXCIpXG4gICAgfSlcbiAgICAvL2RiLnBsYXllci5sb2NhbC5wYXRoKFwiaWRcIikucHV0KCBuZXcgRGF0ZSgpLmdldFRpbWUoKSApXG59XG5cbmRiLmFuaW1hdGUgPSBmdW5jdGlvbigpIHtcbiAgICAvL2RiLnBsYXllci5wdXQoIHtwb3NpdGlvbjpWb3hlbGFyaXVtLmNhbWVyYS5wb3NpdGlvbn0gKVxuICAgIGlmKCAhZGIucGxheWVyLmdsb2JhbCApXG4gICAgICAgIHJldHVybjtcbiAgICB2YXIgbSA9IFZveGVsYXJpdW0uY2FtZXJhLm1hdHJpeDtcbiAgICB2YXIgb2xkcSA9IGRiLnBsYXllci5fcXVhdFxuICAgIHZhciBuZXdxID0gZGIucGxheWVyLnF1YXQuc2V0RnJvbVJvdGF0aW9uTWF0cml4KCBtICk7XG4gICAgdmFyIG9sZG8gPSBkYi5wbGF5ZXIuX29yaWdpblxuICAgIHZhciBuZXdvID0gZGIucGxheWVyLm9yaWdpbi5jb3B5KCBtLm9yaWdpbiApO1xuXG5cbiAgICBpZiggb2xkcS54ICE9PSBuZXdxLnggfHxcbiAgICAgICAgb2xkcS55ICE9PSBuZXdxLnkgfHxcbiAgICAgICAgb2xkcS56ICE9PSBuZXdxLnogfHxcbiAgICAgICAgb2xkcS53ICE9PSBuZXdxLncgfHxcbiAgICAgICAgb2xkby54ICE9PSBuZXdvLnggfHxcbiAgICAgICAgb2xkby55ICE9PSBuZXdvLnkgfHxcbiAgICAgICAgb2xkby56ICE9PSBuZXdvLnogKVxuICAgIHtcbiAgICAgICAgdmFyIGEgPSAoIG9sZG8ueCAtIG5ld28ueCApO1xuICAgICAgICB2YXIgYiA9ICggb2xkby55IC0gbmV3by55ICk7XG4gICAgICAgIHZhciBjID0gKCBvbGRvLnogLSBuZXdvLnogKTtcblxuICAgICAgICB2YXIgZCA9ICggb2xkcS54IC0gbmV3cS54ICk7XG4gICAgICAgIHZhciBlID0gKCBvbGRxLnkgLSBuZXdxLnkgKTtcbiAgICAgICAgdmFyIGYgPSAoIG9sZHEueiAtIG5ld3EueiApO1xuICAgICAgICB2YXIgZyA9ICggb2xkcS53IC0gbmV3cS53ICk7XG4gICAgICAgIC8vY29uc29sZS5sb2coIGBhIGlzICR7YSphK2IqYitjKmN9ICBiIGlzICR7ZCpkK2UqZStmKmYrZypnfWApXG4gICAgICAgIGlmKCAoIGEqYStiKmIrYypjID4gMC4wMDEgKVxuICAgICAgICAgICAgfHwoIGQqZCtlKmUrZipmK2cqZyA+IDAuMDAxICkgKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgcG9zX21zZyA9IHtxeDpuZXdxLngscXk6bmV3cS55LHF6Om5ld3EueixxdzpuZXdxLndcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsb3g6bS5vcmlnaW4ueCxveTptLm9yaWdpbi55LG96Om0ub3JpZ2luLnp9XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCBcInB1dFwiLCBwb3NfbXNnIClcbiAgICAgICAgICAgIC8vZGIucGxheWVyLmxvY2FsLnBhdGgoIFwicG9zaXRpb25cIikucHV0KCBwb3NfbXNnIClcbiAgICAgICAgICAgIGRiLnBsYXllci5nbG9iYWwucGF0aCggXCJwb3NpdGlvblwiKS5wdXQoIHBvc19tc2cgKVxuICAgICAgICAgICAgb2xkcS5jb3B5KCBuZXdxICk7XG4gICAgICAgICAgICBvbGRvLmNvcHkoIG5ld28gKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBzdG9yZVNlY3Rvciggc2VjdG9yICkge1xuICAgIGlmKCAhZGIud29ybGQuY2x1c3RlciApXG4gICAgICBkYi53b3JsZC5jbHVzdGVyID0gc2VjdG9yLmNsdXN0ZXI7XG4gICAgYWRkTGlzdGVuZXIoIHNlY3RvciApO1xuICAgIC8vY29uc29sZS5sb2coIFwicHV0IHNlY3RvciB1cGRhdGUgXCIgKVxuICAgIHZhciBzdHJpbmc7XG4gICAgICB0aGlzLmRiLnBhdGgoZ2V0UGF0aChzZWN0b3IpKS5wdXQoIHN0cmluZyA9IHNlY3Rvci5zdHJpbmdpZnkoKSApO1xuICAgICAgY29uc29sZS5sb2coIFwicHV0LWVkIHNlY3RvciB1cGRhdGUgXCIsIHN0cmluZyApXG59XG5cbmZ1bmN0aW9uIGxvYWRTZWN0b3IoIHNlY3RvciApIHtcbiAgICAgIGFkZExpc3RlbmVyKCBzZWN0b3IgKTtcbiAgICAgIC8vdGhpcy5kYi5wYXRoKGdldFBhdGgoc2VjdG9yKSkub24oIGNiICk7XG59XG5cbi8vZ3VuLmdldCggYG9yZy5kM3gwci52b3hlbGFyaXVtLnVuaXZlcnNlLiR7dW5pdmVyc2V9LnBsYXllci4ke3NlbGZ9YClcbiIsIlxuVm94ZWxhcml1bS5Wb3hlbHMgPSB7XG5cdHR5cGVzIDogW10sXG5cdGFkZCA6IGZ1bmN0aW9uKCB0eXBlLCBwcm9wZXJ0aWVzLHJlYWN0aW9uICkge1xuICAgICAgICBcdC8vdGhpcy50eXBlcy5wdXNoKFxuXHRcdFx0XHRcdFx0dGhpc1t0eXBlXSA9IHtcblx0XHRcdFx0XHRcdCBJRCA6IHRoaXMudHlwZXMubGVuZ3RoXG4gICAgICAgICAgICAgICAgXHRcdCwgbmFtZSA6IHR5cGVcbiAgICAgICAgICAgICAgICBcdFx0LCBwcm9wZXJ0aWVzIDogcHJvcGVydGllc1xuXHRcdFx0XHQsIHJlYWN0aW9uIDogcmVhY3Rpb25cblx0XHRcdCBcdCwgY3JlYXRlVm94ZWxFeHRlbnNpb24gOiBudWxsXG5cdFx0XHRcdCwgZGVsZXRlVm94ZWxFeHRlbnNpb24gOiBudWxsXG5cdFx0XHRcdCwgdGV4dHVyZUNvb3JkcyA6IHt9XG5cdFx0XHRcdCwgaW1hZ2UgOiBudWxsXG5cdFx0XHRcdCwgdGV4dHVyZSA6IG51bGxcblx0XHRcdFx0LCBjb2RlRGF0YSA6IG51bGxcblx0XHRcdFx0LCB0ZXh0dXJlRGF0YSA6IG51bGxcblx0XHRcdH1cblx0XHQgIC8vKTtcblx0XHRcdGlmKCB0eXBlb2YgcHJvcGVydGllcy5EcmF3SW5mbyA9PT0gXCJ1bmRlZmluZWRcIiApXG5cdFx0XHRcdHByb3BlcnRpZXMuRHJhd0luZm8gPSBWb3hlbGFyaXVtLlpWT1hFTF9EUkFXSU5GT19EUkFXRlVMTFZPWEVMT1BBQ0lUWTtcblx0XHRcdHJldHVybiB0aGlzW3R5cGVdO1xuXHRcdH1cbi8qXG5Jc19QbGF5ZXJDYW5QYXNzVGhyb3VnaCA9IGZhbHNlO1xuRHJhd19UcmFuc3BhcmVudFJlbmRlcmluZyA9IGZhbHNlO1xuRHJhd19GdWxsVm94ZWxPcGFjaXR5ID0gdHJ1ZTtcbkRyYXdJbmZvID0gVm94ZWxHbG9iYWxTZXR0aW5ncy5aVk9YRUxfRFJBV0lORk9fRFJBV0ZVTExWT1hFTE9QQUNJVFk7XG5FeHRlbnNpb25UeXBlID0gMDtcbklzX1ZveGVsRXh0ZW5zaW9uID0gZmFsc2U7XG5Jc19IYXNBbGxvY2F0ZWRNZW1vcnlFeHRlbnNpb24gPSBmYWxzZTtcbk1pbmluZ0hhcmRuZXNzID0gMTAwMC4wZjtcbk1pbmluZ1R5cGUgPSAyO1xuSXNfTm9UeXBlID0gZmFsc2U7XG5Jc19Vc2VyVHlwZVRyYW5zZm9ybWFibGUgPSB0cnVlO1xuSXNfSGFybWluZyA9IGZhbHNlO1xuRnJpY3Rpb25Db2VmID0gMC4wMDE7XG5HcmlwX0hvcml6b250YWwgPSAwLjk7XG5HcmlwX1ZlcnRpY2FsID0gMC4wO1xuSXNfU3BhY2VHcmlwVHlwZSA9IGZhbHNlO1xuSXNfS2VlcENvbnRyb2xPbkp1bXBpbmcgPSB0cnVlO1xuSGFybWluZ0xpZmVQb2ludHNQZXJTZWNvbmQgPSAwLjA7XG5Jc19BY3RpdmUgPSBmYWxzZTtcbklzX0NhbkJlUmVwbGFjZWRCeV9XYXRlciA9IGZhbHNlO1xuSXNfQ2FuQmVSZXBsYWNlZEJ5X0dyZWVuQWNpZCA9IGZhbHNlO1xuSXNfQ2FuQmVSZXBsYWNlZEJ5X011c3RhcmRHYXogPSBmYWxzZTtcbklzX0NvbWJpbmFibGVXaXRoX0dyZWVuQWNpZCA9IHRydWU7XG5Jc19DYW5UcmlnZ2VyQm9tYiA9IGZhbHNlO1xuSXNfTGlxdWlkID0gZmFsc2U7XG5Jc19HYXogPSBmYWxzZTtcbklzX0ludGVyZmFjZV9TdG9yZUJsb2NrID0gZmFsc2U7XG5Jc19JbnRlcmZhY2VfUHVzaEJsb2NrID0gZmFsc2U7XG5Jc19JbnRlcmZhY2VfUHVsbEJsb2NrID0gZmFsc2U7XG5Jc19JbnRlcmZhY2VfR2V0SW5mbyA9IGZhbHNlO1xuSXNfSW50ZXJmYWNlX1NldEluZm8gPSBmYWxzZTtcbklzX1B1bXBhYmxlX0J5UHVtcF9UMSA9IGZhbHNlO1xuSXNfUHVtcGFibGVfQnlQdW1wX1QyID0gZmFsc2U7XG5Jc19Mb2FkYWJsZV9CeUxvYWRlcl9MMSA9IHRydWU7XG5CdlByb3BfTW92ZWFibGVCeVRyZWFkbWlsbCA9IHRydWU7XG5CdlByb3BfRmFzdE1vdmluZyA9IGZhbHNlO1xuSXNfUmlkZWFibGUgPSBmYWxzZTtcbklzX0hhc0hlbHBpbmdNZXNzYWdlID0gZmFsc2U7XG5CdlByb3BfQ2FuQmVQaWNrZWRVcEJ5Um9ib3QgPSB0cnVlO1xuQnZQcm9wX1hyUm9ib3RQaWNrTWluTGV2ZWwgPSAxO1xuQnZQcm9wX1ByUm9ib3RSZXBsYWNlTWluTGV2ZWwgPSAwO1xuQnZQcm9wX1ByUm9ib3RQaWNrTWluTGV2ZWwgPSAwO1xuQnZQcm9wX1ByUm9ib3RNb3ZlTWluTGV2ZWwgPSAwO1xuQnZQcm9wX0F0b21pY0ZpcmVSZXNpc3RhbnQgPSBmYWxzZTtcbkJ2UHJvcF9FZ215VDFSZXNpc3RhbnQgPSBmYWxzZTtcbkxpcXVpZERlbnNpdHkgPSAwLjA7XG5CbGFzdFJlc2lzdGFuY2UgPSAxO1xuRmFiSW5mbyA9IG51bGw7XG5Eb2N1bWVudGF0aW9uX1BhZ2VOdW0gPSAwO1xuKi9cblxufVxuXG5Wb3hlbGFyaXVtLlZveGVscy50eXBlcy5wdXNoKFxuVm94ZWxhcml1bS5Wb3hlbHMuYWRkKCBcIlZvaWRcIiwge1xuICAgICAgSXNfUGxheWVyQ2FuUGFzc1Rocm91Z2ggOiB0cnVlLFxuICAgICAgRHJhd19UcmFuc3BhcmVudFJlbmRlcmluZyA6IGZhbHNlLFxuICAgICAgRHJhd19GdWxsVm94ZWxPcGFjaXR5IDogZmFsc2UsXG4gICAgICBEcmF3SW5mbyA6IFZveGVsYXJpdW0uWlZPWEVMX0RSQVdJTkZPX1ZPSUQsXG4gICAgICBJc19IYXJtaW5nIDogZmFsc2UsXG4gICAgICBGcmljdGlvbkNvZWYgOiAwLjAwMDEsXG4gICAgICBHcmlwX1ZlcnRpY2FsIDogMC4wLFxuICAgICAgR3JpcF9Ib3Jpem9udGFsIDogMC44LFxuICAgICAgSXNfU3BhY2VHcmlwVHlwZSA6IGZhbHNlLFxuICAgICAgSXNfS2VlcENvbnRyb2xPbkp1bXBpbmcgOiB0cnVlLFxuICAgICAgSXNfQWN0aXZlIDogZmFsc2UsXG4gICAgICBJc19DYW5CZVJlcGxhY2VkQnlfV2F0ZXIgOiB0cnVlLFxuICAgICAgSXNfQ29tYmluYWJsZVdpdGhfR3JlZW5BY2lkIDogZmFsc2UsXG4gICAgICBJc19DYW5CZVJlcGxhY2VkQnlfR3JlZW5BY2lkIDogdHJ1ZSxcbiAgICAgIElzX0NhbkJlUmVwbGFjZWRCeV9NdXN0YXJkR2F6IDogdHJ1ZSxcbiAgICAgIEJ2UHJvcF9DYW5CZVBpY2tlZFVwQnlSb2JvdCA6IGZhbHNlLFxuICAgICAgQnZQcm9wX1hyUm9ib3RQaWNrTWluTGV2ZWwgOiAyNTUsXG4gICAgICBCdlByb3BfUHJSb2JvdFJlcGxhY2VNaW5MZXZlbCA6IDAsXG4gICAgICBCdlByb3BfUHJSb2JvdFBpY2tNaW5MZXZlbCA6IDI1NSxcbiAgICAgIEJ2UHJvcF9QclJvYm90TW92ZU1pbkxldmVsIDogMCxcbiAgICAgIEJ2UHJvcF9BdG9taWNGaXJlUmVzaXN0YW50IDogdHJ1ZSxcbiAgICAgIElzX0xpcXVpZCA6IGZhbHNlLFxuICAgICAgSXNfR2F6IDogdHJ1ZSxcbiAgICAgIElzX0xvYWRhYmxlX0J5TG9hZGVyX0wxIDogZmFsc2UsXG4gICAgICBCdlByb3BfTW92ZWFibGVCeVRyZWFkbWlsbCA6IGZhbHNlLFxuICAgICAgQnZQcm9wX0VnbXlUMVJlc2lzdGFudCA6IGZhbHNlLFxuICAgICAgTGlxdWlkRGVuc2l0eSA6IDAuMCxcbn0gKSApO1xuXG5Wb3hlbGFyaXVtLlZveGVscy5nZXRJbmRleCA9IGZ1bmN0aW9uKCB0eXBlICkge1xuXHR2YXIgdHlwZXMgPSBWb3hlbGFyaXVtLlZveGVscy50eXBlcztcblx0cmV0dXJuIHR5cGVzLmZpbmRJbmRleCggKHYpPT52ID09PSB0eXBlICk7XG59XG5cbnZhciB4aHJPYmo7XG5Wb3hlbGFyaXVtLlZveGVscy5sb2FkID0gZnVuY3Rpb24oIGNiICkge1xuXHR2YXIgbiA9IDFcblx0eGhyT2JqID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdC8vdmFyIHhock9iajIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblx0bG9hZEFWb3hlbCggbiwgY2IgKTtcbn1cblxuZnVuY3Rpb24gbG9hZEFWb3hlbCggbiwgY2IgKSB7XG5cdHtcblx0XHR0cnkge1xuXHRcdFx0eGhyT2JqLm9wZW4oJ0dFVCcsIGAuL3NyYy92b3hlbHMvdm94ZWxfJHtufS5qc2ApO1xuXHRcdFx0Ly94aHJPYmoucmVzcG9uc2VUeXBlID0gXCJ0ZXh0XCI7XG5cdFx0XHQvL3hock9iai5yZXNwb25zZSA9IFwiXCI7XG5cdFx0XHR4aHJPYmouc2VuZChudWxsKTtcblx0XHRcdHhock9iai5vbmVycm9yID0gKGVycik9Pntcblx0XHRcdFx0ICAvL2NvbnNvbGUubG9nKCBcInJlcXVpcmUgXCIsIG4gKTtcblx0XHQgICAgICAvL2NvbnNvbGUubG9nKCBlcnIgKTtcblx0XHRcdFx0XHRjYigpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdH07XG5cdFx0XHR4aHJPYmoub25sb2FkID0gKCk9Pntcblx0XHRcdFx0aWYoICF4aHJPYmouc3RhdHVzIHx8IHhock9iai5zdGF0dXMgPT09IDIwMCApIHtcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKCBcImxvYWQgXCIsIG4pXG5cdFx0XHRcdFx0Vm94ZWxhcml1bS5Wb3hlbHMudHlwZXMucHVzaCggZXZhbCh4aHJPYmoucmVzcG9uc2VUZXh0KSApO1xuXHRcdFx0XHRcdHZhciB0ID0gVm94ZWxhcml1bS5Wb3hlbHMudHlwZXNbbl07XG5cblx0XHRcdFx0XHR0LmNvZGVEYXRhID0geGhyT2JqLnJlc3BvbnNlVGV4dDtcblx0XHRcdFx0XHR4aHJPYmoub3BlbignR0VUJywgYC4vc3JjL3ZveGVscy9pbWFnZXMvdm94ZWxfJHtufS5wbmdgKTtcblx0XHRcdFx0XHR4aHJPYmoub25lcnJvciA9IChlcnIpPT57XG5cdFx0XHRcdFx0XHQgY29uc29sZS5sb2coIFwiZXJyb3I6XCIsIGVycik7XG5cdFx0XHRcdCAgICAgbG9hZEFWb3hlbCggbisxLCBjYiApO1xuXHRcdFx0XHQgIH1cblx0XHRcdFx0XHR4aHJPYmouc2VuZChudWxsKTtcblx0XHRcdFx0XHR4aHJPYmoub25sb2FkID0gKCk9Pntcblx0XHRcdFx0XHRcdGlmKCB4aHJPYmoucmVzcG9uc2VUZXh0Lmxlbmd0aCA+IDAgKSB7XG5cdFx0XHRcdFx0XHRcdCggdC5pbWFnZSA9IG5ldyBJbWFnZSgpICkuc3JjID0geGhyT2JqLnJlc3BvbnNlVGV4dDtcblx0XHRcdFx0XHRcdFx0dC50ZXh0dXJlRGF0YSA9IHhock9iai5yZXNwb25zZTtcblx0XHRcdFx0XHRcdFx0dC5pbWFnZS5vbmVycm9yID0gKGVycik9PnsgY29uc29sZS5sb2coIFwiaW1hZ2UgbG9hZCBlcnJvcj9cIiwgZXJyKX1cblx0XHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyggdCApO1xuXHRcdFx0XHRcdFx0XHRpZiggdHJ1ZSB8fCAhdC5pbWFnZS53aWR0aCApXG5cdFx0XHRcdFx0XHRcdHtcblx0XHRcdFx0XHRcdFx0XHR0LmltYWdlLm9ubG9hZCA9ICgpPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0IC8vY29uc29sZS5sb2coIFwiV2FpdGVkIHVudGlsIGxvYWQgdG8gc2V0dXAgY29vcmRzXCIsIHQpXG5cdFx0XHRcdFx0XHRcdFx0ICAgdC50ZXh0dXJlQ29vcmRzID0gVm94ZWxhcml1bS5UZXh0dXJlQXRsYXMuYWRkKCB0LmltYWdlIClcblx0XHRcdFx0XHRcdFx0ICB9XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyggXCJkb24ndCBoYXZlIHRvIGRlbGF5IGxvYWQ/XCIpXG5cdFx0XHRcdFx0XHRcdCAgLy90LnRleHR1cmVDb29yZHMgPSBWb3hlbGFyaXVtLlRleHR1cmVBdGxhcy5hZGQoIHQuaW1hZ2UgKVxuXHRcdFx0XHRcdFx0ICB9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRsb2FkQVZveGVsKCBuKzEsIGNiICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCBcIkFsbCBjb21wbGV0ZWQuLi4gb3V0IG9mIGxvYWRhYmxlcy4uLlwiKVxuXHRcdFx0XHRcdGNiKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdC8vcmVxdWlyZSggYC4vdm94ZWxzL3ZveGVsXyR7bn0uanNgIClcblx0XHR9XG5cdFx0Y2F0Y2goIGVyciApIHtcblx0XHRcdGNvbnNvbGUubG9nKCBcInJlcXVpcmUgXCIsIG4gKTtcblx0ICAgICAgICBcdGNvbnNvbGUubG9nKCBlcnIgKTtcblx0XHRcdFx0Y2IoKTtcblx0XHR9XG5cdH1cblxufVxuXG4vL1ZveGVsYXJpdW0uVm94ZWxzLnR5cGVzWzBdID0gVm94ZWxhcml1bS5Wb3hlbHMudHlwZXMuVm9pZDtcbi8vVm94ZWxhcml1bS5Wb3hlbHMudHlwZXNbMV0gPSBWb3hlbGFyaXVtLlZveGVscy50eXBlc1tcIkJsYWNrUm9jayBCbHVlXCJdO1xuIiwiXHJcbnJlcXVpcmUoIFwiLi9jbHVzdGVyLmpzXCIpXHJcbnZhciBmb250cyA9IHJlcXVpcmUoIFwiLi92b3hlbC5mb250cy5qc1wiICk7XHJcblxyXG5Wb3hlbGFyaXVtLldvcmxkID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGNsdXN0ZXJzIDogW10sXHJcblxyXG4gICAgICAgIGNyZWF0ZUNsdXN0ZXIgOiBmdW5jdGlvbiggbWVzaGVyLCB2b3hlbFVuaXRTaXplICkge1xyXG4gICAgICAgICAgICB2YXIgY2x1c3RlciA9IFZveGVsYXJpdW0uQ2x1c3RlcigzMiwzMiwzMik7XHJcbiAgICAgICAgICAgIGNsdXN0ZXIubWVzaGVyID0gbWVzaGVyO1xyXG4gICAgICAgICAgICBjbHVzdGVyLnZveGVsVW5pdFNpemUgPSB2b3hlbFVuaXRTaXplIHx8IDIwO1xyXG4gICAgICAgICAgICBjbHVzdGVyLmdldEdlb21ldHJ5QnVmZmVyID0gVm94ZWxhcml1bS5TZXR0aW5ncy51c2VfYmFzaWNfbWF0ZXJpYWxcclxuICAgICAgICAgICAgICAgID8gVm94ZWxhcml1bS5HZW9tZXRyeUJhc2ljQnVmZmVyXHJcbiAgICAgICAgICAgICAgICA6IFZveGVsYXJpdW0uR2VvbWV0cnlCdWZmZXI7XHJcbiAgICAgICAgICAgIHRoaXMuY2x1c3RlcnMucHVzaCggY2x1c3RlciApO1xyXG4gICAgICAgICAgICByZXR1cm4gY2x1c3RlcjtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBjcmVhdGVUZXh0Q2x1c3RlciA6IGZ1bmN0aW9uKCB0ZXh0LCB2LCBtZXNoZXIsIGZvbnQsIHZveGVsVW5pdFNpemUgKSB7XHJcbiAgICAgICAgICAgIHZhciBjbHVzdGVyID0gVm94ZWxhcml1bS5DbHVzdGVyKDI1Nio4LDgsMSk7XHJcbiAgICAgICAgICAgIGNsdXN0ZXIubWVzaGVyID0gbWVzaGVyO1xyXG4gICAgICAgICAgICBjbHVzdGVyLnZveGVsVW5pdFNpemUgPSB2b3hlbFVuaXRTaXplIHx8IDIwO1xyXG4gICAgICAgICAgICBjbHVzdGVyLmdldEdlb21ldHJ5QnVmZmVyID0gVm94ZWxhcml1bS5HZW9tZXRyeUJ1ZmZlck1vbm87XHJcbiAgICAgICAgICAgIHRoaXMuY2x1c3RlcnMucHVzaCggY2x1c3RlciApO1xyXG4gICAgICAgICAgICAvL3ZhciBzZWN0b3IgPSBjbHVzdGVyLmNyZWF0ZVNlY3RvciggMCwgMCwgMCApO1xyXG4gICAgICAgICAgICB2YXIgcG9zID0geyB4OjAsIHk6MH07XHJcblxyXG4gICAgICAgICAgICBmb3IoIHZhciBuID0gMDsgbiA8IHRleHQubGVuZ3RoOyBuKysgKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2ggPSB0ZXh0LmNvZGVQb2ludEF0KG4pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB3ID0gZm9udHMuZHJhd0NoYXJhY3RlciggY2x1c3RlciwgcG9zLCB2LCBjaCwgZm9udCApXHJcbiAgICAgICAgICAgICAgICBwb3MueCArPSB3O1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNsdXN0ZXI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8qKlxuICogQGF1dGhvciBkbWFyY29zIC8gaHR0cHM6Ly9naXRodWIuY29tL2RtYXJjb3NcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb21cbiAqL1xuXG5USFJFRS5WUkNvbnRyb2xzID0gZnVuY3Rpb24gKCBvYmplY3QsIG9uRXJyb3IgKSB7XG5cblx0dmFyIHNjb3BlID0gdGhpcztcblxuXHR2YXIgdnJEaXNwbGF5LCB2ckRpc3BsYXlzO1xuXG5cdHZhciBzdGFuZGluZ01hdHJpeCA9IG5ldyBUSFJFRS5NYXRyaXg0KCk7XG5cblx0dmFyIGZyYW1lRGF0YSA9IG51bGw7XG5cblx0aWYgKCAnVlJGcmFtZURhdGEnIGluIHdpbmRvdyApIHtcblxuXHRcdGZyYW1lRGF0YSA9IG5ldyBWUkZyYW1lRGF0YSgpO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBnb3RWUkRpc3BsYXlzKCBkaXNwbGF5cyApIHtcblxuXHRcdHZyRGlzcGxheXMgPSBkaXNwbGF5cztcblxuXHRcdGlmICggZGlzcGxheXMubGVuZ3RoID4gMCApIHtcblxuXHRcdFx0dnJEaXNwbGF5ID0gZGlzcGxheXNbIDAgXTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdGlmICggb25FcnJvciApIG9uRXJyb3IoICdWUiBpbnB1dCBub3QgYXZhaWxhYmxlLicgKTtcblxuXHRcdH1cblxuXHR9XG5cblx0aWYgKCBuYXZpZ2F0b3IuZ2V0VlJEaXNwbGF5cyApIHtcblxuXHRcdG5hdmlnYXRvci5nZXRWUkRpc3BsYXlzKCkudGhlbiggZ290VlJEaXNwbGF5cyApO1xuXG5cdH1cblxuICB0aGlzLnJvb21PcmlnaW4gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXG5cdC8vIHRoZSBSaWZ0IFNESyByZXR1cm5zIHRoZSBwb3NpdGlvbiBpbiBtZXRlcnNcblx0Ly8gdGhpcyBzY2FsZSBmYWN0b3IgYWxsb3dzIHRoZSB1c2VyIHRvIGRlZmluZSBob3cgbWV0ZXJzXG5cdC8vIGFyZSBjb252ZXJ0ZWQgdG8gc2NlbmUgdW5pdHMuXG5cblx0dGhpcy5zY2FsZSA9IDE7XG5cblx0Ly8gSWYgdHJ1ZSB3aWxsIHVzZSBcInN0YW5kaW5nIHNwYWNlXCIgY29vcmRpbmF0ZSBzeXN0ZW0gd2hlcmUgeT0wIGlzIHRoZVxuXHQvLyBmbG9vciBhbmQgeD0wLCB6PTAgaXMgdGhlIGNlbnRlciBvZiB0aGUgcm9vbS5cblx0dGhpcy5zdGFuZGluZyA9IGZhbHNlO1xuXG5cdC8vIERpc3RhbmNlIGZyb20gdGhlIHVzZXJzIGV5ZXMgdG8gdGhlIGZsb29yIGluIG1ldGVycy4gVXNlZCB3aGVuXG5cdC8vIHN0YW5kaW5nPXRydWUgYnV0IHRoZSBWUkRpc3BsYXkgZG9lc24ndCBwcm92aWRlIHN0YWdlUGFyYW1ldGVycy5cblx0dGhpcy51c2VySGVpZ2h0ID0gMS42O1xuXG5cdHRoaXMuZ2V0VlJEaXNwbGF5ID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0cmV0dXJuIHZyRGlzcGxheTtcblxuXHR9O1xuXG5cdHRoaXMuc2V0VlJEaXNwbGF5ID0gZnVuY3Rpb24gKCB2YWx1ZSApIHtcblxuXHRcdHZyRGlzcGxheSA9IHZhbHVlO1xuXG5cdH07XG5cblx0dGhpcy5nZXRWUkRpc3BsYXlzID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuVlJDb250cm9sczogZ2V0VlJEaXNwbGF5cygpIGlzIGJlaW5nIGRlcHJlY2F0ZWQuJyApO1xuXHRcdHJldHVybiB2ckRpc3BsYXlzO1xuXG5cdH07XG5cblx0dGhpcy5nZXRTdGFuZGluZ01hdHJpeCA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiBzdGFuZGluZ01hdHJpeDtcblxuXHR9O1xuXG5cdHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0aWYgKCB2ckRpc3BsYXkgKSB7XG5cblx0XHRcdHZhciBwb3NlO1xuXG5cdFx0XHRpZiAoIHZyRGlzcGxheS5nZXRGcmFtZURhdGEgKSB7XG5cblx0XHRcdFx0dnJEaXNwbGF5LmdldEZyYW1lRGF0YSggZnJhbWVEYXRhICk7XG5cdFx0XHRcdHBvc2UgPSBmcmFtZURhdGEucG9zZTtcblxuXHRcdFx0fSBlbHNlIGlmICggdnJEaXNwbGF5LmdldFBvc2UgKSB7XG5cblx0XHRcdFx0cG9zZSA9IHZyRGlzcGxheS5nZXRQb3NlKCk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBwb3NlLm9yaWVudGF0aW9uICE9PSBudWxsICkge1xuXG5cdFx0XHRcdG9iamVjdC5xdWF0ZXJuaW9uLmZyb21BcnJheSggcG9zZS5vcmllbnRhdGlvbiApO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggcG9zZS5wb3NpdGlvbiAhPT0gbnVsbCApIHtcblxuXHRcdFx0XHRvYmplY3QucG9zaXRpb24uZnJvbUFycmF5KCBwb3NlLnBvc2l0aW9uICk7XG5cdFx0XHRcdG9iamVjdC5wb3NpdGlvbi5hZGQoIHRoaXMucm9vbU9yaWdpbiApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdG9iamVjdC5wb3NpdGlvbi5zZXQoIDAsIDAsIDAgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHRoaXMuc3RhbmRpbmcgKSB7XG5cblx0XHRcdFx0aWYgKCB2ckRpc3BsYXkuc3RhZ2VQYXJhbWV0ZXJzICkge1xuXG5cdFx0XHRcdFx0b2JqZWN0LnVwZGF0ZU1hdHJpeCgpO1xuXG5cdFx0XHRcdFx0c3RhbmRpbmdNYXRyaXguZnJvbUFycmF5KCB2ckRpc3BsYXkuc3RhZ2VQYXJhbWV0ZXJzLnNpdHRpbmdUb1N0YW5kaW5nVHJhbnNmb3JtICk7XG5cdFx0XHRcdFx0b2JqZWN0LmFwcGx5TWF0cml4KCBzdGFuZGluZ01hdHJpeCApO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRvYmplY3QucG9zaXRpb24uc2V0WSggb2JqZWN0LnBvc2l0aW9uLnkgKyB0aGlzLnVzZXJIZWlnaHQgKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH1cblxuXHRcdFx0b2JqZWN0LnBvc2l0aW9uLm11bHRpcGx5U2NhbGFyKCBzY29wZS5zY2FsZSApO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0dGhpcy5yZXNldFBvc2UgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRpZiAoIHZyRGlzcGxheSApIHtcblxuXHRcdFx0dnJEaXNwbGF5LnJlc2V0UG9zZSgpO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0dGhpcy5yZXNldFNlbnNvciA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLlZSQ29udHJvbHM6IC5yZXNldFNlbnNvcigpIGlzIG5vdyAucmVzZXRQb3NlKCkuJyApO1xuXHRcdHRoaXMucmVzZXRQb3NlKCk7XG5cblx0fTtcblxuXHR0aGlzLnplcm9TZW5zb3IgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5WUkNvbnRyb2xzOiAuemVyb1NlbnNvcigpIGlzIG5vdyAucmVzZXRQb3NlKCkuJyApO1xuXHRcdHRoaXMucmVzZXRQb3NlKCk7XG5cblx0fTtcblxuXHR0aGlzLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHR2ckRpc3BsYXkgPSBudWxsO1xuXG5cdH07XG5cbn07XG4iLCIvKipcbiAqIEBhdXRob3IgZG1hcmNvcyAvIGh0dHBzOi8vZ2l0aHViLmNvbS9kbWFyY29zXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tXG4gKlxuICogV2ViVlIgU3BlYzogaHR0cDovL21venZyLmdpdGh1Yi5pby93ZWJ2ci1zcGVjL3dlYnZyLmh0bWxcbiAqXG4gKiBGaXJlZm94OiBodHRwOi8vbW96dnIuY29tL2Rvd25sb2Fkcy9cbiAqIENocm9taXVtOiBodHRwczovL3dlYnZyLmluZm8vZ2V0LWNocm9tZVxuICpcbiAqL1xuXG5USFJFRS5WUkVmZmVjdCA9IGZ1bmN0aW9uICggcmVuZGVyZXIsIG9uRXJyb3IgKSB7XG5cblx0dmFyIHZyRGlzcGxheSwgdnJEaXNwbGF5cztcblx0dmFyIGV5ZVRyYW5zbGF0aW9uTCA9IG5ldyBUSFJFRS5WZWN0b3IzKCk7XG5cdHZhciBleWVUcmFuc2xhdGlvblIgPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xuXHR2YXIgcmVuZGVyUmVjdEwsIHJlbmRlclJlY3RSO1xuXG5cdHZhciBmcmFtZURhdGEgPSBudWxsO1xuXG5cdGlmICggJ1ZSRnJhbWVEYXRhJyBpbiB3aW5kb3cgKSB7XG5cblx0XHRmcmFtZURhdGEgPSBuZXcgVlJGcmFtZURhdGEoKTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gZ290VlJEaXNwbGF5cyggZGlzcGxheXMgKSB7XG5cblx0XHR2ckRpc3BsYXlzID0gZGlzcGxheXM7XG5cblx0XHRpZiAoIGRpc3BsYXlzLmxlbmd0aCA+IDAgKSB7XG5cblx0XHRcdHZyRGlzcGxheSA9IGRpc3BsYXlzWyAwIF07XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRpZiAoIG9uRXJyb3IgKSBvbkVycm9yKCAnSE1EIG5vdCBhdmFpbGFibGUnICk7XG5cblx0XHR9XG5cblx0fVxuXG5cdGlmICggbmF2aWdhdG9yLmdldFZSRGlzcGxheXMgKSB7XG5cblx0XHRuYXZpZ2F0b3IuZ2V0VlJEaXNwbGF5cygpLnRoZW4oIGdvdFZSRGlzcGxheXMgKTtcblxuXHR9XG5cblx0Ly9cblxuXHR0aGlzLmlzUHJlc2VudGluZyA9IGZhbHNlO1xuXHR0aGlzLnNjYWxlID0gMTtcblxuXHR2YXIgc2NvcGUgPSB0aGlzO1xuXG5cdHZhciByZW5kZXJlclNpemUgPSByZW5kZXJlci5nZXRTaXplKCk7XG5cdHZhciByZW5kZXJlclVwZGF0ZVN0eWxlID0gZmFsc2U7XG5cdHZhciByZW5kZXJlclBpeGVsUmF0aW8gPSByZW5kZXJlci5nZXRQaXhlbFJhdGlvKCk7XG5cblx0dGhpcy5nZXRWUkRpc3BsYXkgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gdnJEaXNwbGF5O1xuXG5cdH07XG5cblx0dGhpcy5zZXRWUkRpc3BsYXkgPSBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0dnJEaXNwbGF5ID0gdmFsdWU7XG5cblx0fTtcblxuXHR0aGlzLmdldFZSRGlzcGxheXMgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5WUkVmZmVjdDogZ2V0VlJEaXNwbGF5cygpIGlzIGJlaW5nIGRlcHJlY2F0ZWQuJyApO1xuXHRcdHJldHVybiB2ckRpc3BsYXlzO1xuXG5cdH07XG5cbiAgdGhpcy5nZXRTaXplID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHJlbmRlcmVyLmdldFNpemUoKTtcblx0fVxuXHR0aGlzLnNldFNpemUgPSBmdW5jdGlvbiAoIHdpZHRoLCBoZWlnaHQsIHVwZGF0ZVN0eWxlICkge1xuXG5cdFx0cmVuZGVyZXJTaXplID0geyB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0IH07XG5cdFx0cmVuZGVyZXJVcGRhdGVTdHlsZSA9IHVwZGF0ZVN0eWxlO1xuXG5cdFx0aWYgKCBzY29wZS5pc1ByZXNlbnRpbmcgKSB7XG5cblx0XHRcdHZhciBleWVQYXJhbXNMID0gdnJEaXNwbGF5LmdldEV5ZVBhcmFtZXRlcnMoICdsZWZ0JyApO1xuXHRcdFx0cmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyggMSApO1xuXHRcdFx0cmVuZGVyZXIuc2V0U2l6ZSggZXllUGFyYW1zTC5yZW5kZXJXaWR0aCAqIDIsIGV5ZVBhcmFtc0wucmVuZGVySGVpZ2h0LCBmYWxzZSApO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0cmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyggcmVuZGVyZXJQaXhlbFJhdGlvICk7XG5cdFx0XHRyZW5kZXJlci5zZXRTaXplKCB3aWR0aCwgaGVpZ2h0LCB1cGRhdGVTdHlsZSApO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0Ly8gZnVsbHNjcmVlblxuXG5cdHZhciBjYW52YXMgPSByZW5kZXJlci5kb21FbGVtZW50O1xuXHR2YXIgcmVxdWVzdEZ1bGxzY3JlZW47XG5cdHZhciBleGl0RnVsbHNjcmVlbjtcblx0dmFyIGZ1bGxzY3JlZW5FbGVtZW50O1xuXHR2YXIgZGVmYXVsdExlZnRCb3VuZHMgPSBbIDAuMCwgMC4wLCAwLjUsIDEuMCBdO1xuXHR2YXIgZGVmYXVsdFJpZ2h0Qm91bmRzID0gWyAwLjUsIDAuMCwgMC41LCAxLjAgXTtcblxuXHRmdW5jdGlvbiBvblZSRGlzcGxheVByZXNlbnRDaGFuZ2UoKSB7XG5cblx0XHR2YXIgd2FzUHJlc2VudGluZyA9IHNjb3BlLmlzUHJlc2VudGluZztcblx0XHRzY29wZS5pc1ByZXNlbnRpbmcgPSB2ckRpc3BsYXkgIT09IHVuZGVmaW5lZCAmJiB2ckRpc3BsYXkuaXNQcmVzZW50aW5nO1xuXG5cdFx0aWYgKCBzY29wZS5pc1ByZXNlbnRpbmcgKSB7XG5cblx0XHRcdHZhciBleWVQYXJhbXNMID0gdnJEaXNwbGF5LmdldEV5ZVBhcmFtZXRlcnMoICdsZWZ0JyApO1xuXHRcdFx0dmFyIGV5ZVdpZHRoID0gZXllUGFyYW1zTC5yZW5kZXJXaWR0aDtcblx0XHRcdHZhciBleWVIZWlnaHQgPSBleWVQYXJhbXNMLnJlbmRlckhlaWdodDtcblxuXHRcdFx0aWYgKCAhd2FzUHJlc2VudGluZyApIHtcblxuXHRcdFx0XHRyZW5kZXJlclBpeGVsUmF0aW8gPSByZW5kZXJlci5nZXRQaXhlbFJhdGlvKCk7XG5cdFx0XHRcdHJlbmRlcmVyU2l6ZSA9IHJlbmRlcmVyLmdldFNpemUoKTtcblxuXHRcdFx0XHRyZW5kZXJlci5zZXRQaXhlbFJhdGlvKCAxICk7XG5cdFx0XHRcdHJlbmRlcmVyLnNldFNpemUoIGV5ZVdpZHRoICogMiwgZXllSGVpZ2h0LCBmYWxzZSApO1xuXG5cdFx0XHR9XG5cblx0XHR9IGVsc2UgaWYgKCB3YXNQcmVzZW50aW5nICkge1xuXG5cdFx0XHRyZW5kZXJlci5zZXRQaXhlbFJhdGlvKCByZW5kZXJlclBpeGVsUmF0aW8gKTtcblx0XHRcdHJlbmRlcmVyLnNldFNpemUoIHJlbmRlcmVyU2l6ZS53aWR0aCwgcmVuZGVyZXJTaXplLmhlaWdodCwgcmVuZGVyZXJVcGRhdGVTdHlsZSApO1xuXG5cdFx0fVxuXG5cdH1cblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggJ3ZyZGlzcGxheXByZXNlbnRjaGFuZ2UnLCBvblZSRGlzcGxheVByZXNlbnRDaGFuZ2UsIGZhbHNlICk7XG5cblx0dGhpcy5zZXRGdWxsU2NyZWVuID0gZnVuY3Rpb24gKCBib29sZWFuICkge1xuXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcblxuXHRcdFx0aWYgKCB2ckRpc3BsYXkgPT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRyZWplY3QoIG5ldyBFcnJvciggJ05vIFZSIGhhcmR3YXJlIGZvdW5kLicgKSApO1xuXHRcdFx0XHRyZXR1cm47XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBzY29wZS5pc1ByZXNlbnRpbmcgPT09IGJvb2xlYW4gKSB7XG5cblx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0XHRyZXR1cm47XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBib29sZWFuICkge1xuXG5cdFx0XHRcdHJlc29sdmUoIHZyRGlzcGxheS5yZXF1ZXN0UHJlc2VudCggWyB7IHNvdXJjZTogY2FudmFzIH0gXSApICk7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0cmVzb2x2ZSggdnJEaXNwbGF5LmV4aXRQcmVzZW50KCkgKTtcblxuXHRcdFx0fVxuXG5cdFx0fSApO1xuXG5cdH07XG5cblx0dGhpcy5yZXF1ZXN0UHJlc2VudCA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdHJldHVybiB0aGlzLnNldEZ1bGxTY3JlZW4oIHRydWUgKTtcblxuXHR9O1xuXG5cdHRoaXMuZXhpdFByZXNlbnQgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gdGhpcy5zZXRGdWxsU2NyZWVuKCBmYWxzZSApO1xuXG5cdH07XG5cblx0dGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoIGYgKSB7XG5cblx0XHRpZiAoIHZyRGlzcGxheSAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRyZXR1cm4gdnJEaXNwbGF5LnJlcXVlc3RBbmltYXRpb25GcmFtZSggZiApO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0cmV0dXJuIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoIGYgKTtcblxuXHRcdH1cblxuXHR9O1xuXG5cdHRoaXMuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoIGggKSB7XG5cblx0XHRpZiAoIHZyRGlzcGxheSAhPT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHR2ckRpc3BsYXkuY2FuY2VsQW5pbWF0aW9uRnJhbWUoIGggKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSggaCApO1xuXG5cdFx0fVxuXG5cdH07XG5cblx0dGhpcy5zdWJtaXRGcmFtZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdGlmICggdnJEaXNwbGF5ICE9PSB1bmRlZmluZWQgJiYgc2NvcGUuaXNQcmVzZW50aW5nICkge1xuXG5cdFx0XHR2ckRpc3BsYXkuc3VibWl0RnJhbWUoKTtcblxuXHRcdH1cblxuXHR9O1xuXG5cdHRoaXMuYXV0b1N1Ym1pdEZyYW1lID0gdHJ1ZTtcblxuXHQvLyByZW5kZXJcblxuXHR2YXIgY2FtZXJhTCA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSgpO1xuXHRjYW1lcmFMLmxheWVycy5lbmFibGUoIDEgKTtcblxuXHR2YXIgY2FtZXJhUiA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSgpO1xuXHRjYW1lcmFSLmxheWVycy5lbmFibGUoIDIgKTtcblxuXHR0aGlzLnJlbmRlciA9IGZ1bmN0aW9uICggc2NlbmUsIGNhbWVyYSwgcmVuZGVyVGFyZ2V0LCBmb3JjZUNsZWFyICkge1xuXG5cdFx0aWYgKCB2ckRpc3BsYXkgJiYgc2NvcGUuaXNQcmVzZW50aW5nICkge1xuXG5cdFx0XHR2YXIgYXV0b1VwZGF0ZSA9IHNjZW5lLmF1dG9VcGRhdGU7XG5cblx0XHRcdGlmICggYXV0b1VwZGF0ZSApIHtcblxuXHRcdFx0XHRzY2VuZS51cGRhdGVNYXRyaXhXb3JsZCgpO1xuXHRcdFx0XHRzY2VuZS5hdXRvVXBkYXRlID0gZmFsc2U7XG5cblx0XHRcdH1cblxuXHRcdFx0dmFyIGV5ZVBhcmFtc0wgPSB2ckRpc3BsYXkuZ2V0RXllUGFyYW1ldGVycyggJ2xlZnQnICk7XG5cdFx0XHR2YXIgZXllUGFyYW1zUiA9IHZyRGlzcGxheS5nZXRFeWVQYXJhbWV0ZXJzKCAncmlnaHQnICk7XG5cblx0XHRcdGV5ZVRyYW5zbGF0aW9uTC5mcm9tQXJyYXkoIGV5ZVBhcmFtc0wub2Zmc2V0ICk7XG5cdFx0XHRleWVUcmFuc2xhdGlvblIuZnJvbUFycmF5KCBleWVQYXJhbXNSLm9mZnNldCApO1xuXG5cdFx0XHRpZiAoIEFycmF5LmlzQXJyYXkoIHNjZW5lICkgKSB7XG5cblx0XHRcdFx0Y29uc29sZS53YXJuKCAnVEhSRUUuVlJFZmZlY3QucmVuZGVyKCkgbm8gbG9uZ2VyIHN1cHBvcnRzIGFycmF5cy4gVXNlIG9iamVjdC5sYXllcnMgaW5zdGVhZC4nICk7XG5cdFx0XHRcdHNjZW5lID0gc2NlbmVbIDAgXTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBXaGVuIHJlbmRlcmluZyB3ZSBkb24ndCBjYXJlIHdoYXQgdGhlIHJlY29tbWVuZGVkIHNpemUgaXMsIG9ubHkgd2hhdCB0aGUgYWN0dWFsIHNpemVcblx0XHRcdC8vIG9mIHRoZSBiYWNrYnVmZmVyIGlzLlxuXHRcdFx0dmFyIHNpemUgPSByZW5kZXJlci5nZXRTaXplKCk7XG5cdFx0XHR2YXIgbGF5ZXJzID0gdnJEaXNwbGF5LmdldExheWVycygpO1xuXHRcdFx0dmFyIGxlZnRCb3VuZHM7XG5cdFx0XHR2YXIgcmlnaHRCb3VuZHM7XG5cblx0XHRcdGlmICggbGF5ZXJzLmxlbmd0aCApIHtcblxuXHRcdFx0XHR2YXIgbGF5ZXIgPSBsYXllcnNbIDAgXTtcblxuXHRcdFx0XHRsZWZ0Qm91bmRzID0gbGF5ZXIubGVmdEJvdW5kcyAhPT0gbnVsbCAmJiBsYXllci5sZWZ0Qm91bmRzLmxlbmd0aCA9PT0gNCA/IGxheWVyLmxlZnRCb3VuZHMgOiBkZWZhdWx0TGVmdEJvdW5kcztcblx0XHRcdFx0cmlnaHRCb3VuZHMgPSBsYXllci5yaWdodEJvdW5kcyAhPT0gbnVsbCAmJiBsYXllci5yaWdodEJvdW5kcy5sZW5ndGggPT09IDQgPyBsYXllci5yaWdodEJvdW5kcyA6IGRlZmF1bHRSaWdodEJvdW5kcztcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRsZWZ0Qm91bmRzID0gZGVmYXVsdExlZnRCb3VuZHM7XG5cdFx0XHRcdHJpZ2h0Qm91bmRzID0gZGVmYXVsdFJpZ2h0Qm91bmRzO1xuXG5cdFx0XHR9XG5cblx0XHRcdHJlbmRlclJlY3RMID0ge1xuXHRcdFx0XHR4OiBNYXRoLnJvdW5kKCBzaXplLndpZHRoICogbGVmdEJvdW5kc1sgMCBdICksXG5cdFx0XHRcdHk6IE1hdGgucm91bmQoIHNpemUuaGVpZ2h0ICogbGVmdEJvdW5kc1sgMSBdICksXG5cdFx0XHRcdHdpZHRoOiBNYXRoLnJvdW5kKCBzaXplLndpZHRoICogbGVmdEJvdW5kc1sgMiBdICksXG5cdFx0XHRcdGhlaWdodDogTWF0aC5yb3VuZChzaXplLmhlaWdodCAqIGxlZnRCb3VuZHNbIDMgXSApXG5cdFx0XHR9O1xuXHRcdFx0cmVuZGVyUmVjdFIgPSB7XG5cdFx0XHRcdHg6IE1hdGgucm91bmQoIHNpemUud2lkdGggKiByaWdodEJvdW5kc1sgMCBdICksXG5cdFx0XHRcdHk6IE1hdGgucm91bmQoIHNpemUuaGVpZ2h0ICogcmlnaHRCb3VuZHNbIDEgXSApLFxuXHRcdFx0XHR3aWR0aDogTWF0aC5yb3VuZCggc2l6ZS53aWR0aCAqIHJpZ2h0Qm91bmRzWyAyIF0gKSxcblx0XHRcdFx0aGVpZ2h0OiBNYXRoLnJvdW5kKHNpemUuaGVpZ2h0ICogcmlnaHRCb3VuZHNbIDMgXSApXG5cdFx0XHR9O1xuXG5cdFx0XHRpZiAoIHJlbmRlclRhcmdldCApIHtcblxuXHRcdFx0XHRyZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQoIHJlbmRlclRhcmdldCApO1xuXHRcdFx0XHRyZW5kZXJUYXJnZXQuc2Npc3NvclRlc3QgPSB0cnVlO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdHJlbmRlcmVyLnNldFJlbmRlclRhcmdldCggbnVsbCApO1xuXHRcdFx0XHRyZW5kZXJlci5zZXRTY2lzc29yVGVzdCggdHJ1ZSApO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggcmVuZGVyZXIuYXV0b0NsZWFyIHx8IGZvcmNlQ2xlYXIgKSByZW5kZXJlci5jbGVhcigpO1xuXG5cdFx0XHRpZiAoIGNhbWVyYS5wYXJlbnQgPT09IG51bGwgKSBjYW1lcmEudXBkYXRlTWF0cml4V29ybGQoKTtcblxuXHRcdFx0Y2FtZXJhLm1hdHJpeFdvcmxkLmRlY29tcG9zZSggY2FtZXJhTC5wb3NpdGlvbiwgY2FtZXJhTC5xdWF0ZXJuaW9uLCBjYW1lcmFMLnNjYWxlICk7XG5cdFx0XHRjYW1lcmEubWF0cml4V29ybGQuZGVjb21wb3NlKCBjYW1lcmFSLnBvc2l0aW9uLCBjYW1lcmFSLnF1YXRlcm5pb24sIGNhbWVyYVIuc2NhbGUgKTtcblxuXHRcdFx0dmFyIHNjYWxlID0gdGhpcy5zY2FsZTtcblx0XHRcdGNhbWVyYUwudHJhbnNsYXRlT25BeGlzKCBleWVUcmFuc2xhdGlvbkwsIHNjYWxlICk7XG5cdFx0XHRjYW1lcmFSLnRyYW5zbGF0ZU9uQXhpcyggZXllVHJhbnNsYXRpb25SLCBzY2FsZSApO1xuXG5cdFx0XHRpZiAoIHZyRGlzcGxheS5nZXRGcmFtZURhdGEgKSB7XG5cblx0XHRcdFx0dnJEaXNwbGF5LmRlcHRoTmVhciA9IGNhbWVyYS5uZWFyO1xuXHRcdFx0XHR2ckRpc3BsYXkuZGVwdGhGYXIgPSBjYW1lcmEuZmFyO1xuXG5cdFx0XHRcdHZyRGlzcGxheS5nZXRGcmFtZURhdGEoIGZyYW1lRGF0YSApO1xuXG5cdFx0XHRcdGNhbWVyYUwucHJvamVjdGlvbk1hdHJpeC5lbGVtZW50cyA9IGZyYW1lRGF0YS5sZWZ0UHJvamVjdGlvbk1hdHJpeDtcblx0XHRcdFx0Y2FtZXJhUi5wcm9qZWN0aW9uTWF0cml4LmVsZW1lbnRzID0gZnJhbWVEYXRhLnJpZ2h0UHJvamVjdGlvbk1hdHJpeDtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRjYW1lcmFMLnByb2plY3Rpb25NYXRyaXggPSBmb3ZUb1Byb2plY3Rpb24oIGV5ZVBhcmFtc0wuZmllbGRPZlZpZXcsIHRydWUsIGNhbWVyYS5uZWFyLCBjYW1lcmEuZmFyICk7XG5cdFx0XHRcdGNhbWVyYVIucHJvamVjdGlvbk1hdHJpeCA9IGZvdlRvUHJvamVjdGlvbiggZXllUGFyYW1zUi5maWVsZE9mVmlldywgdHJ1ZSwgY2FtZXJhLm5lYXIsIGNhbWVyYS5mYXIgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyByZW5kZXIgbGVmdCBleWVcblx0XHRcdGlmICggcmVuZGVyVGFyZ2V0ICkge1xuXG5cdFx0XHRcdHJlbmRlclRhcmdldC52aWV3cG9ydC5zZXQoIHJlbmRlclJlY3RMLngsIHJlbmRlclJlY3RMLnksIHJlbmRlclJlY3RMLndpZHRoLCByZW5kZXJSZWN0TC5oZWlnaHQgKTtcblx0XHRcdFx0cmVuZGVyVGFyZ2V0LnNjaXNzb3Iuc2V0KCByZW5kZXJSZWN0TC54LCByZW5kZXJSZWN0TC55LCByZW5kZXJSZWN0TC53aWR0aCwgcmVuZGVyUmVjdEwuaGVpZ2h0ICk7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0cmVuZGVyZXIuc2V0Vmlld3BvcnQoIHJlbmRlclJlY3RMLngsIHJlbmRlclJlY3RMLnksIHJlbmRlclJlY3RMLndpZHRoLCByZW5kZXJSZWN0TC5oZWlnaHQgKTtcblx0XHRcdFx0cmVuZGVyZXIuc2V0U2Npc3NvciggcmVuZGVyUmVjdEwueCwgcmVuZGVyUmVjdEwueSwgcmVuZGVyUmVjdEwud2lkdGgsIHJlbmRlclJlY3RMLmhlaWdodCApO1xuXG5cdFx0XHR9XG5cdFx0XHRyZW5kZXJlci5yZW5kZXIoIHNjZW5lLCBjYW1lcmFMLCByZW5kZXJUYXJnZXQsIGZvcmNlQ2xlYXIgKTtcblxuXHRcdFx0Ly8gcmVuZGVyIHJpZ2h0IGV5ZVxuXHRcdFx0aWYgKCByZW5kZXJUYXJnZXQgKSB7XG5cblx0XHRcdFx0cmVuZGVyVGFyZ2V0LnZpZXdwb3J0LnNldCggcmVuZGVyUmVjdFIueCwgcmVuZGVyUmVjdFIueSwgcmVuZGVyUmVjdFIud2lkdGgsIHJlbmRlclJlY3RSLmhlaWdodCApO1xuXHRcdFx0XHRyZW5kZXJUYXJnZXQuc2Npc3Nvci5zZXQoIHJlbmRlclJlY3RSLngsIHJlbmRlclJlY3RSLnksIHJlbmRlclJlY3RSLndpZHRoLCByZW5kZXJSZWN0Ui5oZWlnaHQgKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRyZW5kZXJlci5zZXRWaWV3cG9ydCggcmVuZGVyUmVjdFIueCwgcmVuZGVyUmVjdFIueSwgcmVuZGVyUmVjdFIud2lkdGgsIHJlbmRlclJlY3RSLmhlaWdodCApO1xuXHRcdFx0XHRyZW5kZXJlci5zZXRTY2lzc29yKCByZW5kZXJSZWN0Ui54LCByZW5kZXJSZWN0Ui55LCByZW5kZXJSZWN0Ui53aWR0aCwgcmVuZGVyUmVjdFIuaGVpZ2h0ICk7XG5cblx0XHRcdH1cblx0XHRcdHJlbmRlcmVyLnJlbmRlciggc2NlbmUsIGNhbWVyYVIsIHJlbmRlclRhcmdldCwgZm9yY2VDbGVhciApO1xuXG5cdFx0XHRpZiAoIHJlbmRlclRhcmdldCApIHtcblxuXHRcdFx0XHRyZW5kZXJUYXJnZXQudmlld3BvcnQuc2V0KCAwLCAwLCBzaXplLndpZHRoLCBzaXplLmhlaWdodCApO1xuXHRcdFx0XHRyZW5kZXJUYXJnZXQuc2Npc3Nvci5zZXQoIDAsIDAsIHNpemUud2lkdGgsIHNpemUuaGVpZ2h0ICk7XG5cdFx0XHRcdHJlbmRlclRhcmdldC5zY2lzc29yVGVzdCA9IGZhbHNlO1xuXHRcdFx0XHRyZW5kZXJlci5zZXRSZW5kZXJUYXJnZXQoIG51bGwgKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRyZW5kZXJlci5zZXRWaWV3cG9ydCggMCwgMCwgc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQgKTtcblx0XHRcdFx0cmVuZGVyZXIuc2V0U2Npc3NvclRlc3QoIGZhbHNlICk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBhdXRvVXBkYXRlICkge1xuXG5cdFx0XHRcdHNjZW5lLmF1dG9VcGRhdGUgPSB0cnVlO1xuXG5cdFx0XHR9XG5cblx0XHRcdGlmICggc2NvcGUuYXV0b1N1Ym1pdEZyYW1lICkge1xuXG5cdFx0XHRcdHNjb3BlLnN1Ym1pdEZyYW1lKCk7XG5cblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuO1xuXG5cdFx0fVxuXG5cdFx0Ly8gUmVndWxhciByZW5kZXIgbW9kZSBpZiBub3QgSE1EXG5cblx0XHRyZW5kZXJlci5yZW5kZXIoIHNjZW5lLCBjYW1lcmEsIHJlbmRlclRhcmdldCwgZm9yY2VDbGVhciApO1xuXG5cdH07XG5cblx0dGhpcy5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0d2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoICd2cmRpc3BsYXlwcmVzZW50Y2hhbmdlJywgb25WUkRpc3BsYXlQcmVzZW50Q2hhbmdlLCBmYWxzZSApO1xuXG5cdH07XG5cblx0Ly9cblxuXHRmdW5jdGlvbiBmb3ZUb05EQ1NjYWxlT2Zmc2V0KCBmb3YgKSB7XG5cblx0XHR2YXIgcHhzY2FsZSA9IDIuMCAvICggZm92LmxlZnRUYW4gKyBmb3YucmlnaHRUYW4gKTtcblx0XHR2YXIgcHhvZmZzZXQgPSAoIGZvdi5sZWZ0VGFuIC0gZm92LnJpZ2h0VGFuICkgKiBweHNjYWxlICogMC41O1xuXHRcdHZhciBweXNjYWxlID0gMi4wIC8gKCBmb3YudXBUYW4gKyBmb3YuZG93blRhbiApO1xuXHRcdHZhciBweW9mZnNldCA9ICggZm92LnVwVGFuIC0gZm92LmRvd25UYW4gKSAqIHB5c2NhbGUgKiAwLjU7XG5cdFx0cmV0dXJuIHsgc2NhbGU6IFsgcHhzY2FsZSwgcHlzY2FsZSBdLCBvZmZzZXQ6IFsgcHhvZmZzZXQsIHB5b2Zmc2V0IF0gfTtcblxuXHR9XG5cblx0ZnVuY3Rpb24gZm92UG9ydFRvUHJvamVjdGlvbiggZm92LCByaWdodEhhbmRlZCwgek5lYXIsIHpGYXIgKSB7XG5cblx0XHRyaWdodEhhbmRlZCA9IHJpZ2h0SGFuZGVkID09PSB1bmRlZmluZWQgPyB0cnVlIDogcmlnaHRIYW5kZWQ7XG5cdFx0ek5lYXIgPSB6TmVhciA9PT0gdW5kZWZpbmVkID8gMC4wMSA6IHpOZWFyO1xuXHRcdHpGYXIgPSB6RmFyID09PSB1bmRlZmluZWQgPyAxMDAwMC4wIDogekZhcjtcblxuXHRcdHZhciBoYW5kZWRuZXNzU2NhbGUgPSByaWdodEhhbmRlZCA/IC0gMS4wIDogMS4wO1xuXG5cdFx0Ly8gc3RhcnQgd2l0aCBhbiBpZGVudGl0eSBtYXRyaXhcblx0XHR2YXIgbW9iaiA9IG5ldyBUSFJFRS5NYXRyaXg0KCk7XG5cdFx0dmFyIG0gPSBtb2JqLmVsZW1lbnRzO1xuXG5cdFx0Ly8gYW5kIHdpdGggc2NhbGUvb2Zmc2V0IGluZm8gZm9yIG5vcm1hbGl6ZWQgZGV2aWNlIGNvb3Jkc1xuXHRcdHZhciBzY2FsZUFuZE9mZnNldCA9IGZvdlRvTkRDU2NhbGVPZmZzZXQoIGZvdiApO1xuXG5cdFx0Ly8gWCByZXN1bHQsIG1hcCBjbGlwIGVkZ2VzIHRvIFstdywrd11cblx0XHRtWyAwICogNCArIDAgXSA9IHNjYWxlQW5kT2Zmc2V0LnNjYWxlWyAwIF07XG5cdFx0bVsgMCAqIDQgKyAxIF0gPSAwLjA7XG5cdFx0bVsgMCAqIDQgKyAyIF0gPSBzY2FsZUFuZE9mZnNldC5vZmZzZXRbIDAgXSAqIGhhbmRlZG5lc3NTY2FsZTtcblx0XHRtWyAwICogNCArIDMgXSA9IDAuMDtcblxuXHRcdC8vIFkgcmVzdWx0LCBtYXAgY2xpcCBlZGdlcyB0byBbLXcsK3ddXG5cdFx0Ly8gWSBvZmZzZXQgaXMgbmVnYXRlZCBiZWNhdXNlIHRoaXMgcHJvaiBtYXRyaXggdHJhbnNmb3JtcyBmcm9tIHdvcmxkIGNvb3JkcyB3aXRoIFk9dXAsXG5cdFx0Ly8gYnV0IHRoZSBOREMgc2NhbGluZyBoYXMgWT1kb3duICh0aGFua3MgRDNEPylcblx0XHRtWyAxICogNCArIDAgXSA9IDAuMDtcblx0XHRtWyAxICogNCArIDEgXSA9IHNjYWxlQW5kT2Zmc2V0LnNjYWxlWyAxIF07XG5cdFx0bVsgMSAqIDQgKyAyIF0gPSAtIHNjYWxlQW5kT2Zmc2V0Lm9mZnNldFsgMSBdICogaGFuZGVkbmVzc1NjYWxlO1xuXHRcdG1bIDEgKiA0ICsgMyBdID0gMC4wO1xuXG5cdFx0Ly8gWiByZXN1bHQgKHVwIHRvIHRoZSBhcHApXG5cdFx0bVsgMiAqIDQgKyAwIF0gPSAwLjA7XG5cdFx0bVsgMiAqIDQgKyAxIF0gPSAwLjA7XG5cdFx0bVsgMiAqIDQgKyAyIF0gPSB6RmFyIC8gKCB6TmVhciAtIHpGYXIgKSAqIC0gaGFuZGVkbmVzc1NjYWxlO1xuXHRcdG1bIDIgKiA0ICsgMyBdID0gKCB6RmFyICogek5lYXIgKSAvICggek5lYXIgLSB6RmFyICk7XG5cblx0XHQvLyBXIHJlc3VsdCAoPSBaIGluKVxuXHRcdG1bIDMgKiA0ICsgMCBdID0gMC4wO1xuXHRcdG1bIDMgKiA0ICsgMSBdID0gMC4wO1xuXHRcdG1bIDMgKiA0ICsgMiBdID0gaGFuZGVkbmVzc1NjYWxlO1xuXHRcdG1bIDMgKiA0ICsgMyBdID0gMC4wO1xuXG5cdFx0bW9iai50cmFuc3Bvc2UoKTtcblxuXHRcdHJldHVybiBtb2JqO1xuXG5cdH1cblxuXHRmdW5jdGlvbiBmb3ZUb1Byb2plY3Rpb24oIGZvdiwgcmlnaHRIYW5kZWQsIHpOZWFyLCB6RmFyICkge1xuXG5cdFx0dmFyIERFRzJSQUQgPSBNYXRoLlBJIC8gMTgwLjA7XG5cblx0XHR2YXIgZm92UG9ydCA9IHtcblx0XHRcdHVwVGFuOiBNYXRoLnRhbiggZm92LnVwRGVncmVlcyAqIERFRzJSQUQgKSxcblx0XHRcdGRvd25UYW46IE1hdGgudGFuKCBmb3YuZG93bkRlZ3JlZXMgKiBERUcyUkFEICksXG5cdFx0XHRsZWZ0VGFuOiBNYXRoLnRhbiggZm92LmxlZnREZWdyZWVzICogREVHMlJBRCApLFxuXHRcdFx0cmlnaHRUYW46IE1hdGgudGFuKCBmb3YucmlnaHREZWdyZWVzICogREVHMlJBRCApXG5cdFx0fTtcblxuXHRcdHJldHVybiBmb3ZQb3J0VG9Qcm9qZWN0aW9uKCBmb3ZQb3J0LCByaWdodEhhbmRlZCwgek5lYXIsIHpGYXIgKTtcblxuXHR9XG5cbn07XG4iLCIvKipcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb20vXG4gKi9cblxuVEhSRUUuT0JKTG9hZGVyID0gZnVuY3Rpb24gKCBtYW5hZ2VyICkge1xuXG5cdHRoaXMubWFuYWdlciA9ICggbWFuYWdlciAhPT0gdW5kZWZpbmVkICkgPyBtYW5hZ2VyIDogVEhSRUUuRGVmYXVsdExvYWRpbmdNYW5hZ2VyO1xuXG5cdHRoaXMubWF0ZXJpYWxzID0gbnVsbDtcblxuXHR0aGlzLnJlZ2V4cCA9IHtcblx0XHQvLyB2IGZsb2F0IGZsb2F0IGZsb2F0XG5cdFx0dmVydGV4X3BhdHRlcm4gICAgICAgICAgIDogL152XFxzKyhbXFxkfFxcLnxcXCt8XFwtfGV8RV0rKVxccysoW1xcZHxcXC58XFwrfFxcLXxlfEVdKylcXHMrKFtcXGR8XFwufFxcK3xcXC18ZXxFXSspLyxcblx0XHQvLyB2biBmbG9hdCBmbG9hdCBmbG9hdFxuXHRcdG5vcm1hbF9wYXR0ZXJuICAgICAgICAgICA6IC9edm5cXHMrKFtcXGR8XFwufFxcK3xcXC18ZXxFXSspXFxzKyhbXFxkfFxcLnxcXCt8XFwtfGV8RV0rKVxccysoW1xcZHxcXC58XFwrfFxcLXxlfEVdKykvLFxuXHRcdC8vIHZ0IGZsb2F0IGZsb2F0XG5cdFx0dXZfcGF0dGVybiAgICAgICAgICAgICAgIDogL152dFxccysoW1xcZHxcXC58XFwrfFxcLXxlfEVdKylcXHMrKFtcXGR8XFwufFxcK3xcXC18ZXxFXSspLyxcblx0XHQvLyBmIHZlcnRleCB2ZXJ0ZXggdmVydGV4XG5cdFx0ZmFjZV92ZXJ0ZXggICAgICAgICAgICAgIDogL15mXFxzKygtP1xcZCspXFxzKygtP1xcZCspXFxzKygtP1xcZCspKD86XFxzKygtP1xcZCspKT8vLFxuXHRcdC8vIGYgdmVydGV4L3V2IHZlcnRleC91diB2ZXJ0ZXgvdXZcblx0XHRmYWNlX3ZlcnRleF91diAgICAgICAgICAgOiAvXmZcXHMrKC0/XFxkKylcXC8oLT9cXGQrKVxccysoLT9cXGQrKVxcLygtP1xcZCspXFxzKygtP1xcZCspXFwvKC0/XFxkKykoPzpcXHMrKC0/XFxkKylcXC8oLT9cXGQrKSk/Lyxcblx0XHQvLyBmIHZlcnRleC91di9ub3JtYWwgdmVydGV4L3V2L25vcm1hbCB2ZXJ0ZXgvdXYvbm9ybWFsXG5cdFx0ZmFjZV92ZXJ0ZXhfdXZfbm9ybWFsICAgIDogL15mXFxzKygtP1xcZCspXFwvKC0/XFxkKylcXC8oLT9cXGQrKVxccysoLT9cXGQrKVxcLygtP1xcZCspXFwvKC0/XFxkKylcXHMrKC0/XFxkKylcXC8oLT9cXGQrKVxcLygtP1xcZCspKD86XFxzKygtP1xcZCspXFwvKC0/XFxkKylcXC8oLT9cXGQrKSk/Lyxcblx0XHQvLyBmIHZlcnRleC8vbm9ybWFsIHZlcnRleC8vbm9ybWFsIHZlcnRleC8vbm9ybWFsXG5cdFx0ZmFjZV92ZXJ0ZXhfbm9ybWFsICAgICAgIDogL15mXFxzKygtP1xcZCspXFwvXFwvKC0/XFxkKylcXHMrKC0/XFxkKylcXC9cXC8oLT9cXGQrKVxccysoLT9cXGQrKVxcL1xcLygtP1xcZCspKD86XFxzKygtP1xcZCspXFwvXFwvKC0/XFxkKykpPy8sXG5cdFx0Ly8gbyBvYmplY3RfbmFtZSB8IGcgZ3JvdXBfbmFtZVxuXHRcdG9iamVjdF9wYXR0ZXJuICAgICAgICAgICA6IC9eW29nXVxccyooLispPy8sXG5cdFx0Ly8gcyBib29sZWFuXG5cdFx0c21vb3RoaW5nX3BhdHRlcm4gICAgICAgIDogL15zXFxzKyhcXGQrfG9ufG9mZikvLFxuXHRcdC8vIG10bGxpYiBmaWxlX3JlZmVyZW5jZVxuXHRcdG1hdGVyaWFsX2xpYnJhcnlfcGF0dGVybiA6IC9ebXRsbGliIC8sXG5cdFx0Ly8gdXNlbXRsIG1hdGVyaWFsX25hbWVcblx0XHRtYXRlcmlhbF91c2VfcGF0dGVybiAgICAgOiAvXnVzZW10bCAvXG5cdH07XG5cbn07XG5cblRIUkVFLk9CSkxvYWRlci5wcm90b3R5cGUgPSB7XG5cblx0Y29uc3RydWN0b3I6IFRIUkVFLk9CSkxvYWRlcixcblxuXHRsb2FkOiBmdW5jdGlvbiAoIHVybCwgb25Mb2FkLCBvblByb2dyZXNzLCBvbkVycm9yICkge1xuXG5cdFx0dmFyIHNjb3BlID0gdGhpcztcblxuXHRcdHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuWEhSTG9hZGVyKCBzY29wZS5tYW5hZ2VyICk7XG5cdFx0bG9hZGVyLnNldFBhdGgoIHRoaXMucGF0aCApO1xuXHRcdGxvYWRlci5sb2FkKCB1cmwsIGZ1bmN0aW9uICggdGV4dCApIHtcblxuXHRcdFx0b25Mb2FkKCBzY29wZS5wYXJzZSggdGV4dCApICk7XG5cblx0XHR9LCBvblByb2dyZXNzLCBvbkVycm9yICk7XG5cblx0fSxcblxuXHRzZXRQYXRoOiBmdW5jdGlvbiAoIHZhbHVlICkge1xuXG5cdFx0dGhpcy5wYXRoID0gdmFsdWU7XG5cblx0fSxcblxuXHRzZXRNYXRlcmlhbHM6IGZ1bmN0aW9uICggbWF0ZXJpYWxzICkge1xuXG5cdFx0dGhpcy5tYXRlcmlhbHMgPSBtYXRlcmlhbHM7XG5cblx0fSxcblxuXHRfY3JlYXRlUGFyc2VyU3RhdGUgOiBmdW5jdGlvbiAoKSB7XG5cblx0XHR2YXIgc3RhdGUgPSB7XG5cdFx0XHRvYmplY3RzICA6IFtdLFxuXHRcdFx0b2JqZWN0ICAgOiB7fSxcblxuXHRcdFx0dmVydGljZXMgOiBbXSxcblx0XHRcdG5vcm1hbHMgIDogW10sXG5cdFx0XHR1dnMgICAgICA6IFtdLFxuXG5cdFx0XHRtYXRlcmlhbExpYnJhcmllcyA6IFtdLFxuXG5cdFx0XHRzdGFydE9iamVjdDogZnVuY3Rpb24gKCBuYW1lLCBmcm9tRGVjbGFyYXRpb24gKSB7XG5cblx0XHRcdFx0Ly8gSWYgdGhlIGN1cnJlbnQgb2JqZWN0IChpbml0aWFsIGZyb20gcmVzZXQpIGlzIG5vdCBmcm9tIGEgZy9vIGRlY2xhcmF0aW9uIGluIHRoZSBwYXJzZWRcblx0XHRcdFx0Ly8gZmlsZS4gV2UgbmVlZCB0byB1c2UgaXQgZm9yIHRoZSBmaXJzdCBwYXJzZWQgZy9vIHRvIGtlZXAgdGhpbmdzIGluIHN5bmMuXG5cdFx0XHRcdGlmICggdGhpcy5vYmplY3QgJiYgdGhpcy5vYmplY3QuZnJvbURlY2xhcmF0aW9uID09PSBmYWxzZSApIHtcblxuXHRcdFx0XHRcdHRoaXMub2JqZWN0Lm5hbWUgPSBuYW1lO1xuXHRcdFx0XHRcdHRoaXMub2JqZWN0LmZyb21EZWNsYXJhdGlvbiA9ICggZnJvbURlY2xhcmF0aW9uICE9PSBmYWxzZSApO1xuXHRcdFx0XHRcdHJldHVybjtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIHByZXZpb3VzTWF0ZXJpYWwgPSAoIHRoaXMub2JqZWN0ICYmIHR5cGVvZiB0aGlzLm9iamVjdC5jdXJyZW50TWF0ZXJpYWwgPT09ICdmdW5jdGlvbicgPyB0aGlzLm9iamVjdC5jdXJyZW50TWF0ZXJpYWwoKSA6IHVuZGVmaW5lZCApO1xuXG5cdFx0XHRcdGlmICggdGhpcy5vYmplY3QgJiYgdHlwZW9mIHRoaXMub2JqZWN0Ll9maW5hbGl6ZSA9PT0gJ2Z1bmN0aW9uJyApIHtcblxuXHRcdFx0XHRcdHRoaXMub2JqZWN0Ll9maW5hbGl6ZSggdHJ1ZSApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLm9iamVjdCA9IHtcblx0XHRcdFx0XHRuYW1lIDogbmFtZSB8fCAnJyxcblx0XHRcdFx0XHRmcm9tRGVjbGFyYXRpb24gOiAoIGZyb21EZWNsYXJhdGlvbiAhPT0gZmFsc2UgKSxcblxuXHRcdFx0XHRcdGdlb21ldHJ5IDoge1xuXHRcdFx0XHRcdFx0dmVydGljZXMgOiBbXSxcblx0XHRcdFx0XHRcdG5vcm1hbHMgIDogW10sXG5cdFx0XHRcdFx0XHR1dnMgICAgICA6IFtdXG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRtYXRlcmlhbHMgOiBbXSxcblx0XHRcdFx0XHRzbW9vdGggOiB0cnVlLFxuXG5cdFx0XHRcdFx0c3RhcnRNYXRlcmlhbCA6IGZ1bmN0aW9uKCBuYW1lLCBsaWJyYXJpZXMgKSB7XG5cblx0XHRcdFx0XHRcdHZhciBwcmV2aW91cyA9IHRoaXMuX2ZpbmFsaXplKCBmYWxzZSApO1xuXG5cdFx0XHRcdFx0XHQvLyBOZXcgdXNlbXRsIGRlY2xhcmF0aW9uIG92ZXJ3cml0ZXMgYW4gaW5oZXJpdGVkIG1hdGVyaWFsLCBleGNlcHQgaWYgZmFjZXMgd2VyZSBkZWNsYXJlZFxuXHRcdFx0XHRcdFx0Ly8gYWZ0ZXIgdGhlIG1hdGVyaWFsLCB0aGVuIGl0IG11c3QgYmUgcHJlc2VydmVkIGZvciBwcm9wZXIgTXVsdGlNYXRlcmlhbCBjb250aW51YXRpb24uXG5cdFx0XHRcdFx0XHRpZiAoIHByZXZpb3VzICYmICggcHJldmlvdXMuaW5oZXJpdGVkIHx8IHByZXZpb3VzLmdyb3VwQ291bnQgPD0gMCApICkge1xuXG5cdFx0XHRcdFx0XHRcdHRoaXMubWF0ZXJpYWxzLnNwbGljZSggcHJldmlvdXMuaW5kZXgsIDEgKTtcblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR2YXIgbWF0ZXJpYWwgPSB7XG5cdFx0XHRcdFx0XHRcdGluZGV4ICAgICAgOiB0aGlzLm1hdGVyaWFscy5sZW5ndGgsXG5cdFx0XHRcdFx0XHRcdG5hbWUgICAgICAgOiBuYW1lIHx8ICcnLFxuXHRcdFx0XHRcdFx0XHRtdGxsaWIgICAgIDogKCBBcnJheS5pc0FycmF5KCBsaWJyYXJpZXMgKSAmJiBsaWJyYXJpZXMubGVuZ3RoID4gMCA/IGxpYnJhcmllc1sgbGlicmFyaWVzLmxlbmd0aCAtIDEgXSA6ICcnICksXG5cdFx0XHRcdFx0XHRcdHNtb290aCAgICAgOiAoIHByZXZpb3VzICE9PSB1bmRlZmluZWQgPyBwcmV2aW91cy5zbW9vdGggOiB0aGlzLnNtb290aCApLFxuXHRcdFx0XHRcdFx0XHRncm91cFN0YXJ0IDogKCBwcmV2aW91cyAhPT0gdW5kZWZpbmVkID8gcHJldmlvdXMuZ3JvdXBFbmQgOiAwICksXG5cdFx0XHRcdFx0XHRcdGdyb3VwRW5kICAgOiAtMSxcblx0XHRcdFx0XHRcdFx0Z3JvdXBDb3VudCA6IC0xLFxuXHRcdFx0XHRcdFx0XHRpbmhlcml0ZWQgIDogZmFsc2UsXG5cblx0XHRcdFx0XHRcdFx0Y2xvbmUgOiBmdW5jdGlvbiggaW5kZXggKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGNsb25lZCA9IHtcblx0XHRcdFx0XHRcdFx0XHRcdGluZGV4ICAgICAgOiAoIHR5cGVvZiBpbmRleCA9PT0gJ251bWJlcicgPyBpbmRleCA6IHRoaXMuaW5kZXggKSxcblx0XHRcdFx0XHRcdFx0XHRcdG5hbWUgICAgICAgOiB0aGlzLm5hbWUsXG5cdFx0XHRcdFx0XHRcdFx0XHRtdGxsaWIgICAgIDogdGhpcy5tdGxsaWIsXG5cdFx0XHRcdFx0XHRcdFx0XHRzbW9vdGggICAgIDogdGhpcy5zbW9vdGgsXG5cdFx0XHRcdFx0XHRcdFx0XHRncm91cFN0YXJ0IDogMCxcblx0XHRcdFx0XHRcdFx0XHRcdGdyb3VwRW5kICAgOiAtMSxcblx0XHRcdFx0XHRcdFx0XHRcdGdyb3VwQ291bnQgOiAtMSxcblx0XHRcdFx0XHRcdFx0XHRcdGluaGVyaXRlZCAgOiBmYWxzZVxuXHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0Y2xvbmVkLmNsb25lID0gdGhpcy5jbG9uZS5iaW5kKGNsb25lZCk7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGNsb25lZDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fTtcblxuXHRcdFx0XHRcdFx0dGhpcy5tYXRlcmlhbHMucHVzaCggbWF0ZXJpYWwgKTtcblxuXHRcdFx0XHRcdFx0cmV0dXJuIG1hdGVyaWFsO1xuXG5cdFx0XHRcdFx0fSxcblxuXHRcdFx0XHRcdGN1cnJlbnRNYXRlcmlhbCA6IGZ1bmN0aW9uKCkge1xuXG5cdFx0XHRcdFx0XHRpZiAoIHRoaXMubWF0ZXJpYWxzLmxlbmd0aCA+IDAgKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0aGlzLm1hdGVyaWFsc1sgdGhpcy5tYXRlcmlhbHMubGVuZ3RoIC0gMSBdO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXG5cdFx0XHRcdFx0fSxcblxuXHRcdFx0XHRcdF9maW5hbGl6ZSA6IGZ1bmN0aW9uKCBlbmQgKSB7XG5cblx0XHRcdFx0XHRcdHZhciBsYXN0TXVsdGlNYXRlcmlhbCA9IHRoaXMuY3VycmVudE1hdGVyaWFsKCk7XG5cdFx0XHRcdFx0XHRpZiAoIGxhc3RNdWx0aU1hdGVyaWFsICYmIGxhc3RNdWx0aU1hdGVyaWFsLmdyb3VwRW5kID09PSAtMSApIHtcblxuXHRcdFx0XHRcdFx0XHRsYXN0TXVsdGlNYXRlcmlhbC5ncm91cEVuZCA9IHRoaXMuZ2VvbWV0cnkudmVydGljZXMubGVuZ3RoIC8gMztcblx0XHRcdFx0XHRcdFx0bGFzdE11bHRpTWF0ZXJpYWwuZ3JvdXBDb3VudCA9IGxhc3RNdWx0aU1hdGVyaWFsLmdyb3VwRW5kIC0gbGFzdE11bHRpTWF0ZXJpYWwuZ3JvdXBTdGFydDtcblx0XHRcdFx0XHRcdFx0bGFzdE11bHRpTWF0ZXJpYWwuaW5oZXJpdGVkID0gZmFsc2U7XG5cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Ly8gSWdub3JlIG9iamVjdHMgdGFpbCBtYXRlcmlhbHMgaWYgbm8gZmFjZSBkZWNsYXJhdGlvbnMgZm9sbG93ZWQgdGhlbSBiZWZvcmUgYSBuZXcgby9nIHN0YXJ0ZWQuXG5cdFx0XHRcdFx0XHRpZiAoIGVuZCAmJiB0aGlzLm1hdGVyaWFscy5sZW5ndGggPiAxICkge1xuXG5cdFx0XHRcdFx0XHRcdGZvciAoIHZhciBtaSA9IHRoaXMubWF0ZXJpYWxzLmxlbmd0aCAtIDE7IG1pID49IDA7IG1pLS0gKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCB0aGlzLm1hdGVyaWFsc1ttaV0uZ3JvdXBDb3VudCA8PSAwICkge1xuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5tYXRlcmlhbHMuc3BsaWNlKCBtaSwgMSApO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdC8vIEd1YXJhbnRlZSBhdCBsZWFzdCBvbmUgZW1wdHkgbWF0ZXJpYWwsIHRoaXMgbWFrZXMgdGhlIGNyZWF0aW9uIGxhdGVyIG1vcmUgc3RyYWlnaHQgZm9yd2FyZC5cblx0XHRcdFx0XHRcdGlmICggZW5kICYmIHRoaXMubWF0ZXJpYWxzLmxlbmd0aCA9PT0gMCApIHtcblxuXHRcdFx0XHRcdFx0XHR0aGlzLm1hdGVyaWFscy5wdXNoKHtcblx0XHRcdFx0XHRcdFx0XHRuYW1lICAgOiAnJyxcblx0XHRcdFx0XHRcdFx0XHRzbW9vdGggOiB0aGlzLnNtb290aFxuXHRcdFx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRyZXR1cm4gbGFzdE11bHRpTWF0ZXJpYWw7XG5cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0Ly8gSW5oZXJpdCBwcmV2aW91cyBvYmplY3RzIG1hdGVyaWFsLlxuXHRcdFx0XHQvLyBTcGVjIHRlbGxzIHVzIHRoYXQgYSBkZWNsYXJlZCBtYXRlcmlhbCBtdXN0IGJlIHNldCB0byBhbGwgb2JqZWN0cyB1bnRpbCBhIG5ldyBtYXRlcmlhbCBpcyBkZWNsYXJlZC5cblx0XHRcdFx0Ly8gSWYgYSB1c2VtdGwgZGVjbGFyYXRpb24gaXMgZW5jb3VudGVyZWQgd2hpbGUgdGhpcyBuZXcgb2JqZWN0IGlzIGJlaW5nIHBhcnNlZCwgaXQgd2lsbFxuXHRcdFx0XHQvLyBvdmVyd3JpdGUgdGhlIGluaGVyaXRlZCBtYXRlcmlhbC4gRXhjZXB0aW9uIGJlaW5nIHRoYXQgdGhlcmUgd2FzIGFscmVhZHkgZmFjZSBkZWNsYXJhdGlvbnNcblx0XHRcdFx0Ly8gdG8gdGhlIGluaGVyaXRlZCBtYXRlcmlhbCwgdGhlbiBpdCB3aWxsIGJlIHByZXNlcnZlZCBmb3IgcHJvcGVyIE11bHRpTWF0ZXJpYWwgY29udGludWF0aW9uLlxuXG5cdFx0XHRcdGlmICggcHJldmlvdXNNYXRlcmlhbCAmJiBwcmV2aW91c01hdGVyaWFsLm5hbWUgJiYgdHlwZW9mIHByZXZpb3VzTWF0ZXJpYWwuY2xvbmUgPT09IFwiZnVuY3Rpb25cIiApIHtcblxuXHRcdFx0XHRcdHZhciBkZWNsYXJlZCA9IHByZXZpb3VzTWF0ZXJpYWwuY2xvbmUoIDAgKTtcblx0XHRcdFx0XHRkZWNsYXJlZC5pbmhlcml0ZWQgPSB0cnVlO1xuXHRcdFx0XHRcdHRoaXMub2JqZWN0Lm1hdGVyaWFscy5wdXNoKCBkZWNsYXJlZCApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLm9iamVjdHMucHVzaCggdGhpcy5vYmplY3QgKTtcblxuXHRcdFx0fSxcblxuXHRcdFx0ZmluYWxpemUgOiBmdW5jdGlvbigpIHtcblxuXHRcdFx0XHRpZiAoIHRoaXMub2JqZWN0ICYmIHR5cGVvZiB0aGlzLm9iamVjdC5fZmluYWxpemUgPT09ICdmdW5jdGlvbicgKSB7XG5cblx0XHRcdFx0XHR0aGlzLm9iamVjdC5fZmluYWxpemUoIHRydWUgKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH0sXG5cblx0XHRcdHBhcnNlVmVydGV4SW5kZXg6IGZ1bmN0aW9uICggdmFsdWUsIGxlbiApIHtcblxuXHRcdFx0XHR2YXIgaW5kZXggPSBwYXJzZUludCggdmFsdWUsIDEwICk7XG5cdFx0XHRcdHJldHVybiAoIGluZGV4ID49IDAgPyBpbmRleCAtIDEgOiBpbmRleCArIGxlbiAvIDMgKSAqIDM7XG5cblx0XHRcdH0sXG5cblx0XHRcdHBhcnNlTm9ybWFsSW5kZXg6IGZ1bmN0aW9uICggdmFsdWUsIGxlbiApIHtcblxuXHRcdFx0XHR2YXIgaW5kZXggPSBwYXJzZUludCggdmFsdWUsIDEwICk7XG5cdFx0XHRcdHJldHVybiAoIGluZGV4ID49IDAgPyBpbmRleCAtIDEgOiBpbmRleCArIGxlbiAvIDMgKSAqIDM7XG5cblx0XHRcdH0sXG5cblx0XHRcdHBhcnNlVVZJbmRleDogZnVuY3Rpb24gKCB2YWx1ZSwgbGVuICkge1xuXG5cdFx0XHRcdHZhciBpbmRleCA9IHBhcnNlSW50KCB2YWx1ZSwgMTAgKTtcblx0XHRcdFx0cmV0dXJuICggaW5kZXggPj0gMCA/IGluZGV4IC0gMSA6IGluZGV4ICsgbGVuIC8gMiApICogMjtcblxuXHRcdFx0fSxcblxuXHRcdFx0YWRkVmVydGV4OiBmdW5jdGlvbiAoIGEsIGIsIGMgKSB7XG5cblx0XHRcdFx0dmFyIHNyYyA9IHRoaXMudmVydGljZXM7XG5cdFx0XHRcdHZhciBkc3QgPSB0aGlzLm9iamVjdC5nZW9tZXRyeS52ZXJ0aWNlcztcblxuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBhICsgMCBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGEgKyAxIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYSArIDIgXSApO1xuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBiICsgMCBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGIgKyAxIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYiArIDIgXSApO1xuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBjICsgMCBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGMgKyAxIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYyArIDIgXSApO1xuXG5cdFx0XHR9LFxuXG5cdFx0XHRhZGRWZXJ0ZXhMaW5lOiBmdW5jdGlvbiAoIGEgKSB7XG5cblx0XHRcdFx0dmFyIHNyYyA9IHRoaXMudmVydGljZXM7XG5cdFx0XHRcdHZhciBkc3QgPSB0aGlzLm9iamVjdC5nZW9tZXRyeS52ZXJ0aWNlcztcblxuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBhICsgMCBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGEgKyAxIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYSArIDIgXSApO1xuXG5cdFx0XHR9LFxuXG5cdFx0XHRhZGROb3JtYWwgOiBmdW5jdGlvbiAoIGEsIGIsIGMgKSB7XG5cblx0XHRcdFx0dmFyIHNyYyA9IHRoaXMubm9ybWFscztcblx0XHRcdFx0dmFyIGRzdCA9IHRoaXMub2JqZWN0Lmdlb21ldHJ5Lm5vcm1hbHM7XG5cblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYSArIDAgXSApO1xuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBhICsgMSBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGEgKyAyIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYiArIDAgXSApO1xuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBiICsgMSBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGIgKyAyIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYyArIDAgXSApO1xuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBjICsgMSBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGMgKyAyIF0gKTtcblxuXHRcdFx0fSxcblxuXHRcdFx0YWRkVVY6IGZ1bmN0aW9uICggYSwgYiwgYyApIHtcblxuXHRcdFx0XHR2YXIgc3JjID0gdGhpcy51dnM7XG5cdFx0XHRcdHZhciBkc3QgPSB0aGlzLm9iamVjdC5nZW9tZXRyeS51dnM7XG5cblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYSArIDAgXSApO1xuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBhICsgMSBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGIgKyAwIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYiArIDEgXSApO1xuXHRcdFx0XHRkc3QucHVzaCggc3JjWyBjICsgMCBdICk7XG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGMgKyAxIF0gKTtcblxuXHRcdFx0fSxcblxuXHRcdFx0YWRkVVZMaW5lOiBmdW5jdGlvbiAoIGEgKSB7XG5cblx0XHRcdFx0dmFyIHNyYyA9IHRoaXMudXZzO1xuXHRcdFx0XHR2YXIgZHN0ID0gdGhpcy5vYmplY3QuZ2VvbWV0cnkudXZzO1xuXG5cdFx0XHRcdGRzdC5wdXNoKCBzcmNbIGEgKyAwIF0gKTtcblx0XHRcdFx0ZHN0LnB1c2goIHNyY1sgYSArIDEgXSApO1xuXG5cdFx0XHR9LFxuXG5cdFx0XHRhZGRGYWNlOiBmdW5jdGlvbiAoIGEsIGIsIGMsIGQsIHVhLCB1YiwgdWMsIHVkLCBuYSwgbmIsIG5jLCBuZCApIHtcblxuXHRcdFx0XHR2YXIgdkxlbiA9IHRoaXMudmVydGljZXMubGVuZ3RoO1xuXG5cdFx0XHRcdHZhciBpYSA9IHRoaXMucGFyc2VWZXJ0ZXhJbmRleCggYSwgdkxlbiApO1xuXHRcdFx0XHR2YXIgaWIgPSB0aGlzLnBhcnNlVmVydGV4SW5kZXgoIGIsIHZMZW4gKTtcblx0XHRcdFx0dmFyIGljID0gdGhpcy5wYXJzZVZlcnRleEluZGV4KCBjLCB2TGVuICk7XG5cdFx0XHRcdHZhciBpZDtcblxuXHRcdFx0XHRpZiAoIGQgPT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRcdHRoaXMuYWRkVmVydGV4KCBpYSwgaWIsIGljICk7XG5cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdGlkID0gdGhpcy5wYXJzZVZlcnRleEluZGV4KCBkLCB2TGVuICk7XG5cblx0XHRcdFx0XHR0aGlzLmFkZFZlcnRleCggaWEsIGliLCBpZCApO1xuXHRcdFx0XHRcdHRoaXMuYWRkVmVydGV4KCBpYiwgaWMsIGlkICk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggdWEgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRcdHZhciB1dkxlbiA9IHRoaXMudXZzLmxlbmd0aDtcblxuXHRcdFx0XHRcdGlhID0gdGhpcy5wYXJzZVVWSW5kZXgoIHVhLCB1dkxlbiApO1xuXHRcdFx0XHRcdGliID0gdGhpcy5wYXJzZVVWSW5kZXgoIHViLCB1dkxlbiApO1xuXHRcdFx0XHRcdGljID0gdGhpcy5wYXJzZVVWSW5kZXgoIHVjLCB1dkxlbiApO1xuXG5cdFx0XHRcdFx0aWYgKCBkID09PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdFx0XHRcdHRoaXMuYWRkVVYoIGlhLCBpYiwgaWMgKTtcblxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRcdGlkID0gdGhpcy5wYXJzZVVWSW5kZXgoIHVkLCB1dkxlbiApO1xuXG5cdFx0XHRcdFx0XHR0aGlzLmFkZFVWKCBpYSwgaWIsIGlkICk7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZFVWKCBpYiwgaWMsIGlkICk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggbmEgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0XHRcdC8vIE5vcm1hbHMgYXJlIG1hbnkgdGltZXMgdGhlIHNhbWUuIElmIHNvLCBza2lwIGZ1bmN0aW9uIGNhbGwgYW5kIHBhcnNlSW50LlxuXHRcdFx0XHRcdHZhciBuTGVuID0gdGhpcy5ub3JtYWxzLmxlbmd0aDtcblx0XHRcdFx0XHRpYSA9IHRoaXMucGFyc2VOb3JtYWxJbmRleCggbmEsIG5MZW4gKTtcblxuXHRcdFx0XHRcdGliID0gbmEgPT09IG5iID8gaWEgOiB0aGlzLnBhcnNlTm9ybWFsSW5kZXgoIG5iLCBuTGVuICk7XG5cdFx0XHRcdFx0aWMgPSBuYSA9PT0gbmMgPyBpYSA6IHRoaXMucGFyc2VOb3JtYWxJbmRleCggbmMsIG5MZW4gKTtcblxuXHRcdFx0XHRcdGlmICggZCA9PT0gdW5kZWZpbmVkICkge1xuXG5cdFx0XHRcdFx0XHR0aGlzLmFkZE5vcm1hbCggaWEsIGliLCBpYyApO1xuXG5cdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0aWQgPSB0aGlzLnBhcnNlTm9ybWFsSW5kZXgoIG5kLCBuTGVuICk7XG5cblx0XHRcdFx0XHRcdHRoaXMuYWRkTm9ybWFsKCBpYSwgaWIsIGlkICk7XG5cdFx0XHRcdFx0XHR0aGlzLmFkZE5vcm1hbCggaWIsIGljLCBpZCApO1xuXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0fSxcblxuXHRcdFx0YWRkTGluZUdlb21ldHJ5OiBmdW5jdGlvbiAoIHZlcnRpY2VzLCB1dnMgKSB7XG5cblx0XHRcdFx0dGhpcy5vYmplY3QuZ2VvbWV0cnkudHlwZSA9ICdMaW5lJztcblxuXHRcdFx0XHR2YXIgdkxlbiA9IHRoaXMudmVydGljZXMubGVuZ3RoO1xuXHRcdFx0XHR2YXIgdXZMZW4gPSB0aGlzLnV2cy5sZW5ndGg7XG5cblx0XHRcdFx0Zm9yICggdmFyIHZpID0gMCwgbCA9IHZlcnRpY2VzLmxlbmd0aDsgdmkgPCBsOyB2aSArKyApIHtcblxuXHRcdFx0XHRcdHRoaXMuYWRkVmVydGV4TGluZSggdGhpcy5wYXJzZVZlcnRleEluZGV4KCB2ZXJ0aWNlc1sgdmkgXSwgdkxlbiApICk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGZvciAoIHZhciB1dmkgPSAwLCBsID0gdXZzLmxlbmd0aDsgdXZpIDwgbDsgdXZpICsrICkge1xuXG5cdFx0XHRcdFx0dGhpcy5hZGRVVkxpbmUoIHRoaXMucGFyc2VVVkluZGV4KCB1dnNbIHV2aSBdLCB1dkxlbiApICk7XG5cblx0XHRcdFx0fVxuXG5cdFx0XHR9XG5cblx0XHR9O1xuXG5cdFx0c3RhdGUuc3RhcnRPYmplY3QoICcnLCBmYWxzZSApO1xuXG5cdFx0cmV0dXJuIHN0YXRlO1xuXG5cdH0sXG5cblx0cGFyc2U6IGZ1bmN0aW9uICggdGV4dCApIHtcblxuXHRcdGNvbnNvbGUudGltZSggJ09CSkxvYWRlcicgKTtcblxuXHRcdHZhciBzdGF0ZSA9IHRoaXMuX2NyZWF0ZVBhcnNlclN0YXRlKCk7XG5cblx0XHRpZiAoIHRleHQuaW5kZXhPZiggJ1xcclxcbicgKSAhPT0gLSAxICkge1xuXG5cdFx0XHQvLyBUaGlzIGlzIGZhc3RlciB0aGFuIFN0cmluZy5zcGxpdCB3aXRoIHJlZ2V4IHRoYXQgc3BsaXRzIG9uIGJvdGhcblx0XHRcdHRleHQgPSB0ZXh0LnJlcGxhY2UoIC9cXHJcXG4vZywgJ1xcbicgKTtcblxuXHRcdH1cblxuXHRcdGlmICggdGV4dC5pbmRleE9mKCAnXFxcXFxcbicgKSAhPT0gLSAxKSB7XG5cblx0XHRcdC8vIGpvaW4gbGluZXMgc2VwYXJhdGVkIGJ5IGEgbGluZSBjb250aW51YXRpb24gY2hhcmFjdGVyIChcXClcblx0XHRcdHRleHQgPSB0ZXh0LnJlcGxhY2UoIC9cXFxcXFxuL2csICcnICk7XG5cblx0XHR9XG5cblx0XHR2YXIgbGluZXMgPSB0ZXh0LnNwbGl0KCAnXFxuJyApO1xuXHRcdHZhciBsaW5lID0gJycsIGxpbmVGaXJzdENoYXIgPSAnJywgbGluZVNlY29uZENoYXIgPSAnJztcblx0XHR2YXIgbGluZUxlbmd0aCA9IDA7XG5cdFx0dmFyIHJlc3VsdCA9IFtdO1xuXG5cdFx0Ly8gRmFzdGVyIHRvIGp1c3QgdHJpbSBsZWZ0IHNpZGUgb2YgdGhlIGxpbmUuIFVzZSBpZiBhdmFpbGFibGUuXG5cdFx0dmFyIHRyaW1MZWZ0ID0gKCB0eXBlb2YgJycudHJpbUxlZnQgPT09ICdmdW5jdGlvbicgKTtcblxuXHRcdGZvciAoIHZhciBpID0gMCwgbCA9IGxpbmVzLmxlbmd0aDsgaSA8IGw7IGkgKysgKSB7XG5cblx0XHRcdGxpbmUgPSBsaW5lc1sgaSBdO1xuXG5cdFx0XHRsaW5lID0gdHJpbUxlZnQgPyBsaW5lLnRyaW1MZWZ0KCkgOiBsaW5lLnRyaW0oKTtcblxuXHRcdFx0bGluZUxlbmd0aCA9IGxpbmUubGVuZ3RoO1xuXG5cdFx0XHRpZiAoIGxpbmVMZW5ndGggPT09IDAgKSBjb250aW51ZTtcblxuXHRcdFx0bGluZUZpcnN0Q2hhciA9IGxpbmUuY2hhckF0KCAwICk7XG5cblx0XHRcdC8vIEB0b2RvIGludm9rZSBwYXNzZWQgaW4gaGFuZGxlciBpZiBhbnlcblx0XHRcdGlmICggbGluZUZpcnN0Q2hhciA9PT0gJyMnICkgY29udGludWU7XG5cblx0XHRcdGlmICggbGluZUZpcnN0Q2hhciA9PT0gJ3YnICkge1xuXG5cdFx0XHRcdGxpbmVTZWNvbmRDaGFyID0gbGluZS5jaGFyQXQoIDEgKTtcblxuXHRcdFx0XHRpZiAoIGxpbmVTZWNvbmRDaGFyID09PSAnICcgJiYgKCByZXN1bHQgPSB0aGlzLnJlZ2V4cC52ZXJ0ZXhfcGF0dGVybi5leGVjKCBsaW5lICkgKSAhPT0gbnVsbCApIHtcblxuXHRcdFx0XHRcdC8vIDAgICAgICAgICAgICAgICAgICAxICAgICAgMiAgICAgIDNcblx0XHRcdFx0XHQvLyBbXCJ2IDEuMCAyLjAgMy4wXCIsIFwiMS4wXCIsIFwiMi4wXCIsIFwiMy4wXCJdXG5cblx0XHRcdFx0XHRzdGF0ZS52ZXJ0aWNlcy5wdXNoKFxuXHRcdFx0XHRcdFx0cGFyc2VGbG9hdCggcmVzdWx0WyAxIF0gKSxcblx0XHRcdFx0XHRcdHBhcnNlRmxvYXQoIHJlc3VsdFsgMiBdICksXG5cdFx0XHRcdFx0XHRwYXJzZUZsb2F0KCByZXN1bHRbIDMgXSApXG5cdFx0XHRcdFx0KTtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCBsaW5lU2Vjb25kQ2hhciA9PT0gJ24nICYmICggcmVzdWx0ID0gdGhpcy5yZWdleHAubm9ybWFsX3BhdHRlcm4uZXhlYyggbGluZSApICkgIT09IG51bGwgKSB7XG5cblx0XHRcdFx0XHQvLyAwICAgICAgICAgICAgICAgICAgIDEgICAgICAyICAgICAgM1xuXHRcdFx0XHRcdC8vIFtcInZuIDEuMCAyLjAgMy4wXCIsIFwiMS4wXCIsIFwiMi4wXCIsIFwiMy4wXCJdXG5cblx0XHRcdFx0XHRzdGF0ZS5ub3JtYWxzLnB1c2goXG5cdFx0XHRcdFx0XHRwYXJzZUZsb2F0KCByZXN1bHRbIDEgXSApLFxuXHRcdFx0XHRcdFx0cGFyc2VGbG9hdCggcmVzdWx0WyAyIF0gKSxcblx0XHRcdFx0XHRcdHBhcnNlRmxvYXQoIHJlc3VsdFsgMyBdIClcblx0XHRcdFx0XHQpO1xuXG5cdFx0XHRcdH0gZWxzZSBpZiAoIGxpbmVTZWNvbmRDaGFyID09PSAndCcgJiYgKCByZXN1bHQgPSB0aGlzLnJlZ2V4cC51dl9wYXR0ZXJuLmV4ZWMoIGxpbmUgKSApICE9PSBudWxsICkge1xuXG5cdFx0XHRcdFx0Ly8gMCAgICAgICAgICAgICAgIDEgICAgICAyXG5cdFx0XHRcdFx0Ly8gW1widnQgMC4xIDAuMlwiLCBcIjAuMVwiLCBcIjAuMlwiXVxuXG5cdFx0XHRcdFx0c3RhdGUudXZzLnB1c2goXG5cdFx0XHRcdFx0XHRwYXJzZUZsb2F0KCByZXN1bHRbIDEgXSApLFxuXHRcdFx0XHRcdFx0cGFyc2VGbG9hdCggcmVzdWx0WyAyIF0gKVxuXHRcdFx0XHRcdCk7XG5cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvciggXCJVbmV4cGVjdGVkIHZlcnRleC9ub3JtYWwvdXYgbGluZTogJ1wiICsgbGluZSAgKyBcIidcIiApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0fSBlbHNlIGlmICggbGluZUZpcnN0Q2hhciA9PT0gXCJmXCIgKSB7XG5cblx0XHRcdFx0aWYgKCAoIHJlc3VsdCA9IHRoaXMucmVnZXhwLmZhY2VfdmVydGV4X3V2X25vcm1hbC5leGVjKCBsaW5lICkgKSAhPT0gbnVsbCApIHtcblxuXHRcdFx0XHRcdC8vIGYgdmVydGV4L3V2L25vcm1hbCB2ZXJ0ZXgvdXYvbm9ybWFsIHZlcnRleC91di9ub3JtYWxcblx0XHRcdFx0XHQvLyAwICAgICAgICAgICAgICAgICAgICAgICAgMSAgICAyICAgIDMgICAgNCAgICA1ICAgIDYgICAgNyAgICA4ICAgIDkgICAxMCAgICAgICAgIDExICAgICAgICAgMTJcblx0XHRcdFx0XHQvLyBbXCJmIDEvMS8xIDIvMi8yIDMvMy8zXCIsIFwiMVwiLCBcIjFcIiwgXCIxXCIsIFwiMlwiLCBcIjJcIiwgXCIyXCIsIFwiM1wiLCBcIjNcIiwgXCIzXCIsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWRdXG5cblx0XHRcdFx0XHRzdGF0ZS5hZGRGYWNlKFxuXHRcdFx0XHRcdFx0cmVzdWx0WyAxIF0sIHJlc3VsdFsgNCBdLCByZXN1bHRbIDcgXSwgcmVzdWx0WyAxMCBdLFxuXHRcdFx0XHRcdFx0cmVzdWx0WyAyIF0sIHJlc3VsdFsgNSBdLCByZXN1bHRbIDggXSwgcmVzdWx0WyAxMSBdLFxuXHRcdFx0XHRcdFx0cmVzdWx0WyAzIF0sIHJlc3VsdFsgNiBdLCByZXN1bHRbIDkgXSwgcmVzdWx0WyAxMiBdXG5cdFx0XHRcdFx0KTtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCAoIHJlc3VsdCA9IHRoaXMucmVnZXhwLmZhY2VfdmVydGV4X3V2LmV4ZWMoIGxpbmUgKSApICE9PSBudWxsICkge1xuXG5cdFx0XHRcdFx0Ly8gZiB2ZXJ0ZXgvdXYgdmVydGV4L3V2IHZlcnRleC91dlxuXHRcdFx0XHRcdC8vIDAgICAgICAgICAgICAgICAgICAxICAgIDIgICAgMyAgICA0ICAgIDUgICAgNiAgIDcgICAgICAgICAgOFxuXHRcdFx0XHRcdC8vIFtcImYgMS8xIDIvMiAzLzNcIiwgXCIxXCIsIFwiMVwiLCBcIjJcIiwgXCIyXCIsIFwiM1wiLCBcIjNcIiwgdW5kZWZpbmVkLCB1bmRlZmluZWRdXG5cblx0XHRcdFx0XHRzdGF0ZS5hZGRGYWNlKFxuXHRcdFx0XHRcdFx0cmVzdWx0WyAxIF0sIHJlc3VsdFsgMyBdLCByZXN1bHRbIDUgXSwgcmVzdWx0WyA3IF0sXG5cdFx0XHRcdFx0XHRyZXN1bHRbIDIgXSwgcmVzdWx0WyA0IF0sIHJlc3VsdFsgNiBdLCByZXN1bHRbIDggXVxuXHRcdFx0XHRcdCk7XG5cblx0XHRcdFx0fSBlbHNlIGlmICggKCByZXN1bHQgPSB0aGlzLnJlZ2V4cC5mYWNlX3ZlcnRleF9ub3JtYWwuZXhlYyggbGluZSApICkgIT09IG51bGwgKSB7XG5cblx0XHRcdFx0XHQvLyBmIHZlcnRleC8vbm9ybWFsIHZlcnRleC8vbm9ybWFsIHZlcnRleC8vbm9ybWFsXG5cdFx0XHRcdFx0Ly8gMCAgICAgICAgICAgICAgICAgICAgIDEgICAgMiAgICAzICAgIDQgICAgNSAgICA2ICAgNyAgICAgICAgICA4XG5cdFx0XHRcdFx0Ly8gW1wiZiAxLy8xIDIvLzIgMy8vM1wiLCBcIjFcIiwgXCIxXCIsIFwiMlwiLCBcIjJcIiwgXCIzXCIsIFwiM1wiLCB1bmRlZmluZWQsIHVuZGVmaW5lZF1cblxuXHRcdFx0XHRcdHN0YXRlLmFkZEZhY2UoXG5cdFx0XHRcdFx0XHRyZXN1bHRbIDEgXSwgcmVzdWx0WyAzIF0sIHJlc3VsdFsgNSBdLCByZXN1bHRbIDcgXSxcblx0XHRcdFx0XHRcdHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCxcblx0XHRcdFx0XHRcdHJlc3VsdFsgMiBdLCByZXN1bHRbIDQgXSwgcmVzdWx0WyA2IF0sIHJlc3VsdFsgOCBdXG5cdFx0XHRcdFx0KTtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKCAoIHJlc3VsdCA9IHRoaXMucmVnZXhwLmZhY2VfdmVydGV4LmV4ZWMoIGxpbmUgKSApICE9PSBudWxsICkge1xuXG5cdFx0XHRcdFx0Ly8gZiB2ZXJ0ZXggdmVydGV4IHZlcnRleFxuXHRcdFx0XHRcdC8vIDAgICAgICAgICAgICAxICAgIDIgICAgMyAgIDRcblx0XHRcdFx0XHQvLyBbXCJmIDEgMiAzXCIsIFwiMVwiLCBcIjJcIiwgXCIzXCIsIHVuZGVmaW5lZF1cblxuXHRcdFx0XHRcdHN0YXRlLmFkZEZhY2UoXG5cdFx0XHRcdFx0XHRyZXN1bHRbIDEgXSwgcmVzdWx0WyAyIF0sIHJlc3VsdFsgMyBdLCByZXN1bHRbIDQgXVxuXHRcdFx0XHRcdCk7XG5cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdHRocm93IG5ldyBFcnJvciggXCJVbmV4cGVjdGVkIGZhY2UgbGluZTogJ1wiICsgbGluZSAgKyBcIidcIiApO1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0fSBlbHNlIGlmICggbGluZUZpcnN0Q2hhciA9PT0gXCJsXCIgKSB7XG5cblx0XHRcdFx0dmFyIGxpbmVQYXJ0cyA9IGxpbmUuc3Vic3RyaW5nKCAxICkudHJpbSgpLnNwbGl0KCBcIiBcIiApO1xuXHRcdFx0XHR2YXIgbGluZVZlcnRpY2VzID0gW10sIGxpbmVVVnMgPSBbXTtcblxuXHRcdFx0XHRpZiAoIGxpbmUuaW5kZXhPZiggXCIvXCIgKSA9PT0gLSAxICkge1xuXG5cdFx0XHRcdFx0bGluZVZlcnRpY2VzID0gbGluZVBhcnRzO1xuXG5cdFx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0XHRmb3IgKCB2YXIgbGkgPSAwLCBsbGVuID0gbGluZVBhcnRzLmxlbmd0aDsgbGkgPCBsbGVuOyBsaSArKyApIHtcblxuXHRcdFx0XHRcdFx0dmFyIHBhcnRzID0gbGluZVBhcnRzWyBsaSBdLnNwbGl0KCBcIi9cIiApO1xuXG5cdFx0XHRcdFx0XHRpZiAoIHBhcnRzWyAwIF0gIT09IFwiXCIgKSBsaW5lVmVydGljZXMucHVzaCggcGFydHNbIDAgXSApO1xuXHRcdFx0XHRcdFx0aWYgKCBwYXJ0c1sgMSBdICE9PSBcIlwiICkgbGluZVVWcy5wdXNoKCBwYXJ0c1sgMSBdICk7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXHRcdFx0XHRzdGF0ZS5hZGRMaW5lR2VvbWV0cnkoIGxpbmVWZXJ0aWNlcywgbGluZVVWcyApO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCAoIHJlc3VsdCA9IHRoaXMucmVnZXhwLm9iamVjdF9wYXR0ZXJuLmV4ZWMoIGxpbmUgKSApICE9PSBudWxsICkge1xuXG5cdFx0XHRcdC8vIG8gb2JqZWN0X25hbWVcblx0XHRcdFx0Ly8gb3Jcblx0XHRcdFx0Ly8gZyBncm91cF9uYW1lXG5cblx0XHRcdFx0Ly8gV09SS0FST1VORDogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9Mjg2OVxuXHRcdFx0XHQvLyB2YXIgbmFtZSA9IHJlc3VsdFsgMCBdLnN1YnN0ciggMSApLnRyaW0oKTtcblx0XHRcdFx0dmFyIG5hbWUgPSAoIFwiIFwiICsgcmVzdWx0WyAwIF0uc3Vic3RyKCAxICkudHJpbSgpICkuc3Vic3RyKCAxICk7XG5cblx0XHRcdFx0c3RhdGUuc3RhcnRPYmplY3QoIG5hbWUgKTtcblxuXHRcdFx0fSBlbHNlIGlmICggdGhpcy5yZWdleHAubWF0ZXJpYWxfdXNlX3BhdHRlcm4udGVzdCggbGluZSApICkge1xuXG5cdFx0XHRcdC8vIG1hdGVyaWFsXG5cblx0XHRcdFx0c3RhdGUub2JqZWN0LnN0YXJ0TWF0ZXJpYWwoIGxpbmUuc3Vic3RyaW5nKCA3ICkudHJpbSgpLCBzdGF0ZS5tYXRlcmlhbExpYnJhcmllcyApO1xuXG5cdFx0XHR9IGVsc2UgaWYgKCB0aGlzLnJlZ2V4cC5tYXRlcmlhbF9saWJyYXJ5X3BhdHRlcm4udGVzdCggbGluZSApICkge1xuXG5cdFx0XHRcdC8vIG10bCBmaWxlXG5cblx0XHRcdFx0c3RhdGUubWF0ZXJpYWxMaWJyYXJpZXMucHVzaCggbGluZS5zdWJzdHJpbmcoIDcgKS50cmltKCkgKTtcblxuXHRcdFx0fSBlbHNlIGlmICggKCByZXN1bHQgPSB0aGlzLnJlZ2V4cC5zbW9vdGhpbmdfcGF0dGVybi5leGVjKCBsaW5lICkgKSAhPT0gbnVsbCApIHtcblxuXHRcdFx0XHQvLyBzbW9vdGggc2hhZGluZ1xuXG5cdFx0XHRcdC8vIEB0b2RvIEhhbmRsZSBmaWxlcyB0aGF0IGhhdmUgdmFyeWluZyBzbW9vdGggdmFsdWVzIGZvciBhIHNldCBvZiBmYWNlcyBpbnNpZGUgb25lIGdlb21ldHJ5LFxuXHRcdFx0XHQvLyBidXQgZG9lcyBub3QgZGVmaW5lIGEgdXNlbXRsIGZvciBlYWNoIGZhY2Ugc2V0LlxuXHRcdFx0XHQvLyBUaGlzIHNob3VsZCBiZSBkZXRlY3RlZCBhbmQgYSBkdW1teSBtYXRlcmlhbCBjcmVhdGVkIChsYXRlciBNdWx0aU1hdGVyaWFsIGFuZCBnZW9tZXRyeSBncm91cHMpLlxuXHRcdFx0XHQvLyBUaGlzIHJlcXVpcmVzIHNvbWUgY2FyZSB0byBub3QgY3JlYXRlIGV4dHJhIG1hdGVyaWFsIG9uIGVhY2ggc21vb3RoIHZhbHVlIGZvciBcIm5vcm1hbFwiIG9iaiBmaWxlcy5cblx0XHRcdFx0Ly8gd2hlcmUgZXhwbGljaXQgdXNlbXRsIGRlZmluZXMgZ2VvbWV0cnkgZ3JvdXBzLlxuXHRcdFx0XHQvLyBFeGFtcGxlIGFzc2V0OiBleGFtcGxlcy9tb2RlbHMvb2JqL2NlcmJlcnVzL0NlcmJlcnVzLm9ialxuXG5cdFx0XHRcdHZhciB2YWx1ZSA9IHJlc3VsdFsgMSBdLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0XHRzdGF0ZS5vYmplY3Quc21vb3RoID0gKCB2YWx1ZSA9PT0gJzEnIHx8IHZhbHVlID09PSAnb24nICk7XG5cblx0XHRcdFx0dmFyIG1hdGVyaWFsID0gc3RhdGUub2JqZWN0LmN1cnJlbnRNYXRlcmlhbCgpO1xuXHRcdFx0XHRpZiAoIG1hdGVyaWFsICkge1xuXG5cdFx0XHRcdFx0bWF0ZXJpYWwuc21vb3RoID0gc3RhdGUub2JqZWN0LnNtb290aDtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0Ly8gSGFuZGxlIG51bGwgdGVybWluYXRlZCBmaWxlcyB3aXRob3V0IGV4Y2VwdGlvblxuXHRcdFx0XHRpZiAoIGxpbmUgPT09ICdcXDAnICkgY29udGludWU7XG5cblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIlVuZXhwZWN0ZWQgbGluZTogJ1wiICsgbGluZSAgKyBcIidcIiApO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHRzdGF0ZS5maW5hbGl6ZSgpO1xuXG5cdFx0dmFyIGNvbnRhaW5lciA9IG5ldyBUSFJFRS5Hcm91cCgpO1xuXHRcdGNvbnRhaW5lci5tYXRlcmlhbExpYnJhcmllcyA9IFtdLmNvbmNhdCggc3RhdGUubWF0ZXJpYWxMaWJyYXJpZXMgKTtcblxuXHRcdGZvciAoIHZhciBpID0gMCwgbCA9IHN0YXRlLm9iamVjdHMubGVuZ3RoOyBpIDwgbDsgaSArKyApIHtcblxuXHRcdFx0dmFyIG9iamVjdCA9IHN0YXRlLm9iamVjdHNbIGkgXTtcblx0XHRcdHZhciBnZW9tZXRyeSA9IG9iamVjdC5nZW9tZXRyeTtcblx0XHRcdHZhciBtYXRlcmlhbHMgPSBvYmplY3QubWF0ZXJpYWxzO1xuXHRcdFx0dmFyIGlzTGluZSA9ICggZ2VvbWV0cnkudHlwZSA9PT0gJ0xpbmUnICk7XG5cblx0XHRcdC8vIFNraXAgby9nIGxpbmUgZGVjbGFyYXRpb25zIHRoYXQgZGlkIG5vdCBmb2xsb3cgd2l0aCBhbnkgZmFjZXNcblx0XHRcdGlmICggZ2VvbWV0cnkudmVydGljZXMubGVuZ3RoID09PSAwICkgY29udGludWU7XG5cblx0XHRcdHZhciBidWZmZXJnZW9tZXRyeSA9IG5ldyBUSFJFRS5CdWZmZXJHZW9tZXRyeSgpO1xuXG5cdFx0XHRidWZmZXJnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdwb3NpdGlvbicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoIG5ldyBGbG9hdDMyQXJyYXkoIGdlb21ldHJ5LnZlcnRpY2VzICksIDMgKSApO1xuXG5cdFx0XHRpZiAoIGdlb21ldHJ5Lm5vcm1hbHMubGVuZ3RoID4gMCApIHtcblxuXHRcdFx0XHRidWZmZXJnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICdub3JtYWwnLCBuZXcgVEhSRUUuQnVmZmVyQXR0cmlidXRlKCBuZXcgRmxvYXQzMkFycmF5KCBnZW9tZXRyeS5ub3JtYWxzICksIDMgKSApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGJ1ZmZlcmdlb21ldHJ5LmNvbXB1dGVWZXJ0ZXhOb3JtYWxzKCk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBnZW9tZXRyeS51dnMubGVuZ3RoID4gMCApIHtcblxuXHRcdFx0XHRidWZmZXJnZW9tZXRyeS5hZGRBdHRyaWJ1dGUoICd1dicsIG5ldyBUSFJFRS5CdWZmZXJBdHRyaWJ1dGUoIG5ldyBGbG9hdDMyQXJyYXkoIGdlb21ldHJ5LnV2cyApLCAyICkgKTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBDcmVhdGUgbWF0ZXJpYWxzXG5cblx0XHRcdHZhciBjcmVhdGVkTWF0ZXJpYWxzID0gW107XG5cblx0XHRcdGZvciAoIHZhciBtaSA9IDAsIG1pTGVuID0gbWF0ZXJpYWxzLmxlbmd0aDsgbWkgPCBtaUxlbiA7IG1pKysgKSB7XG5cblx0XHRcdFx0dmFyIHNvdXJjZU1hdGVyaWFsID0gbWF0ZXJpYWxzW21pXTtcblx0XHRcdFx0dmFyIG1hdGVyaWFsID0gdW5kZWZpbmVkO1xuXG5cdFx0XHRcdGlmICggdGhpcy5tYXRlcmlhbHMgIT09IG51bGwgKSB7XG5cblx0XHRcdFx0XHRtYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWxzLmNyZWF0ZSggc291cmNlTWF0ZXJpYWwubmFtZSApO1xuXG5cdFx0XHRcdFx0Ly8gbXRsIGV0Yy4gbG9hZGVycyBwcm9iYWJseSBjYW4ndCBjcmVhdGUgbGluZSBtYXRlcmlhbHMgY29ycmVjdGx5LCBjb3B5IHByb3BlcnRpZXMgdG8gYSBsaW5lIG1hdGVyaWFsLlxuXHRcdFx0XHRcdGlmICggaXNMaW5lICYmIG1hdGVyaWFsICYmICEgKCBtYXRlcmlhbCBpbnN0YW5jZW9mIFRIUkVFLkxpbmVCYXNpY01hdGVyaWFsICkgKSB7XG5cblx0XHRcdFx0XHRcdHZhciBtYXRlcmlhbExpbmUgPSBuZXcgVEhSRUUuTGluZUJhc2ljTWF0ZXJpYWwoKTtcblx0XHRcdFx0XHRcdG1hdGVyaWFsTGluZS5jb3B5KCBtYXRlcmlhbCApO1xuXHRcdFx0XHRcdFx0bWF0ZXJpYWwgPSBtYXRlcmlhbExpbmU7XG5cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICggISBtYXRlcmlhbCApIHtcblxuXHRcdFx0XHRcdG1hdGVyaWFsID0gKCAhIGlzTGluZSA/IG5ldyBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCgpIDogbmV3IFRIUkVFLkxpbmVCYXNpY01hdGVyaWFsKCkgKTtcblx0XHRcdFx0XHRtYXRlcmlhbC5uYW1lID0gc291cmNlTWF0ZXJpYWwubmFtZTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0bWF0ZXJpYWwuc2hhZGluZyA9IHNvdXJjZU1hdGVyaWFsLnNtb290aCA/IFRIUkVFLlNtb290aFNoYWRpbmcgOiBUSFJFRS5GbGF0U2hhZGluZztcblxuXHRcdFx0XHRjcmVhdGVkTWF0ZXJpYWxzLnB1c2gobWF0ZXJpYWwpO1xuXG5cdFx0XHR9XG5cblx0XHRcdC8vIENyZWF0ZSBtZXNoXG5cblx0XHRcdHZhciBtZXNoO1xuXG5cdFx0XHRpZiAoIGNyZWF0ZWRNYXRlcmlhbHMubGVuZ3RoID4gMSApIHtcblxuXHRcdFx0XHRmb3IgKCB2YXIgbWkgPSAwLCBtaUxlbiA9IG1hdGVyaWFscy5sZW5ndGg7IG1pIDwgbWlMZW4gOyBtaSsrICkge1xuXG5cdFx0XHRcdFx0dmFyIHNvdXJjZU1hdGVyaWFsID0gbWF0ZXJpYWxzW21pXTtcblx0XHRcdFx0XHRidWZmZXJnZW9tZXRyeS5hZGRHcm91cCggc291cmNlTWF0ZXJpYWwuZ3JvdXBTdGFydCwgc291cmNlTWF0ZXJpYWwuZ3JvdXBDb3VudCwgbWkgKTtcblxuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIG11bHRpTWF0ZXJpYWwgPSBuZXcgVEhSRUUuTXVsdGlNYXRlcmlhbCggY3JlYXRlZE1hdGVyaWFscyApO1xuXHRcdFx0XHRtZXNoID0gKCAhIGlzTGluZSA/IG5ldyBUSFJFRS5NZXNoKCBidWZmZXJnZW9tZXRyeSwgbXVsdGlNYXRlcmlhbCApIDogbmV3IFRIUkVFLkxpbmVTZWdtZW50cyggYnVmZmVyZ2VvbWV0cnksIG11bHRpTWF0ZXJpYWwgKSApO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdG1lc2ggPSAoICEgaXNMaW5lID8gbmV3IFRIUkVFLk1lc2goIGJ1ZmZlcmdlb21ldHJ5LCBjcmVhdGVkTWF0ZXJpYWxzWyAwIF0gKSA6IG5ldyBUSFJFRS5MaW5lU2VnbWVudHMoIGJ1ZmZlcmdlb21ldHJ5LCBjcmVhdGVkTWF0ZXJpYWxzWyAwIF0gKSApO1xuXHRcdFx0fVxuXG5cdFx0XHRtZXNoLm5hbWUgPSBvYmplY3QubmFtZTtcblxuXHRcdFx0Y29udGFpbmVyLmFkZCggbWVzaCApO1xuXG5cdFx0fVxuXG5cdFx0Y29uc29sZS50aW1lRW5kKCAnT0JKTG9hZGVyJyApO1xuXG5cdFx0cmV0dXJuIGNvbnRhaW5lcjtcblxuXHR9XG5cbn07XG4iLCIvLyBzdGF0cy5qcyAtIGh0dHA6Ly9naXRodWIuY29tL21yZG9vYi9zdGF0cy5qc1xudmFyIFN0YXRzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaChhKXtjLmFwcGVuZENoaWxkKGEuZG9tKTtyZXR1cm4gYX1mdW5jdGlvbiBrKGEpe2Zvcih2YXIgZD0wO2Q8Yy5jaGlsZHJlbi5sZW5ndGg7ZCsrKWMuY2hpbGRyZW5bZF0uc3R5bGUuZGlzcGxheT1kPT09YT9cImJsb2NrXCI6XCJub25lXCI7bD1hfXZhciBsPTAsYz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2Muc3R5bGUuY3NzVGV4dD1cInBvc2l0aW9uOmZpeGVkO3RvcDowO2xlZnQ6MDtjdXJzb3I6cG9pbnRlcjtvcGFjaXR5OjAuOTt6LWluZGV4OjEwMDAwXCI7Yy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbihhKXthLnByZXZlbnREZWZhdWx0KCk7aygrK2wlYy5jaGlsZHJlbi5sZW5ndGgpfSwhMSk7dmFyIGc9KHBlcmZvcm1hbmNlfHxEYXRlKS5ub3coKSxlPWcsYT0wLHI9aChuZXcgU3RhdHMuUGFuZWwoXCJGUFNcIixcIiMwZmZcIixcIiMwMDJcIikpLGY9aChuZXcgU3RhdHMuUGFuZWwoXCJNU1wiLFwiIzBmMFwiLFwiIzAyMFwiKSk7XG5pZihzZWxmLnBlcmZvcm1hbmNlJiZzZWxmLnBlcmZvcm1hbmNlLm1lbW9yeSl2YXIgdD1oKG5ldyBTdGF0cy5QYW5lbChcIk1CXCIsXCIjZjA4XCIsXCIjMjAxXCIpKTtrKDApO3JldHVybntSRVZJU0lPTjoxNixkb206YyxhZGRQYW5lbDpoLHNob3dQYW5lbDprLGJlZ2luOmZ1bmN0aW9uKCl7Zz0ocGVyZm9ybWFuY2V8fERhdGUpLm5vdygpfSxlbmQ6ZnVuY3Rpb24oKXthKys7dmFyIGM9KHBlcmZvcm1hbmNlfHxEYXRlKS5ub3coKTtmLnVwZGF0ZShjLWcsMjAwKTtpZihjPmUrMUUzJiYoci51cGRhdGUoMUUzKmEvKGMtZSksMTAwKSxlPWMsYT0wLHQpKXt2YXIgZD1wZXJmb3JtYW5jZS5tZW1vcnk7dC51cGRhdGUoZC51c2VkSlNIZWFwU2l6ZS8xMDQ4NTc2LGQuanNIZWFwU2l6ZUxpbWl0LzEwNDg1NzYpfXJldHVybiBjfSx1cGRhdGU6ZnVuY3Rpb24oKXtnPXRoaXMuZW5kKCl9LGRvbUVsZW1lbnQ6YyxzZXRNb2RlOmt9fTtcblN0YXRzLlBhbmVsPWZ1bmN0aW9uKGgsayxsKXt2YXIgYz1JbmZpbml0eSxnPTAsZT1NYXRoLnJvdW5kLGE9ZSh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpb3x8MSkscj04MCphLGY9NDgqYSx0PTMqYSx1PTIqYSxkPTMqYSxtPTE1KmEsbj03NCphLHA9MzAqYSxxPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7cS53aWR0aD1yO3EuaGVpZ2h0PWY7cS5zdHlsZS5jc3NUZXh0PVwid2lkdGg6ODBweDtoZWlnaHQ6NDhweFwiO3ZhciBiPXEuZ2V0Q29udGV4dChcIjJkXCIpO2IuZm9udD1cImJvbGQgXCIrOSphK1wicHggSGVsdmV0aWNhLEFyaWFsLHNhbnMtc2VyaWZcIjtiLnRleHRCYXNlbGluZT1cInRvcFwiO2IuZmlsbFN0eWxlPWw7Yi5maWxsUmVjdCgwLDAscixmKTtiLmZpbGxTdHlsZT1rO2IuZmlsbFRleHQoaCx0LHUpO2IuZmlsbFJlY3QoZCxtLG4scCk7Yi5maWxsU3R5bGU9bDtiLmdsb2JhbEFscGhhPS45O2IuZmlsbFJlY3QoZCxtLG4scCk7cmV0dXJue2RvbTpxLHVwZGF0ZTpmdW5jdGlvbihmLFxudil7Yz1NYXRoLm1pbihjLGYpO2c9TWF0aC5tYXgoZyxmKTtiLmZpbGxTdHlsZT1sO2IuZ2xvYmFsQWxwaGE9MTtiLmZpbGxSZWN0KDAsMCxyLG0pO2IuZmlsbFN0eWxlPWs7Yi5maWxsVGV4dChlKGYpK1wiIFwiK2grXCIgKFwiK2UoYykrXCItXCIrZShnKStcIilcIix0LHUpO2IuZHJhd0ltYWdlKHEsZCthLG0sbi1hLHAsZCxtLG4tYSxwKTtiLmZpbGxSZWN0KGQrbi1hLG0sYSxwKTtiLmZpbGxTdHlsZT1sO2IuZ2xvYmFsQWxwaGE9Ljk7Yi5maWxsUmVjdChkK24tYSxtLGEsZSgoMS1mL3YpKnApKX19fTtcIm9iamVjdFwiPT09dHlwZW9mIG1vZHVsZSYmKG1vZHVsZS5leHBvcnRzPVN0YXRzKTtcbiIsIi8qKlxuICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbVxuICovXG5cblRIUkVFLlBhaW50Vml2ZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoIGlkICkge1xuXG5cdFRIUkVFLlZpdmVDb250cm9sbGVyLmNhbGwoIHRoaXMsIGlkICk7XG5cblx0dmFyIFBJMiA9IE1hdGguUEkgKiAyO1xuXG5cdHZhciBNT0RFUyA9IHsgQ09MT1I6IDAsIFNJWkU6IDEgfTtcblx0dmFyIG1vZGUgPSBNT0RFUy5DT0xPUjtcblxuXHR2YXIgY29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoIDEsIDEsIDEgKTtcblx0dmFyIHNpemUgPSAxLjA7XG5cblx0Ly9cblxuXHRmdW5jdGlvbiBnZW5lcmF0ZUh1ZVRleHR1cmUoKSB7XG5cblx0XHR2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2NhbnZhcycgKTtcblx0XHRjYW52YXMud2lkdGggPSAyNTY7XG5cdFx0Y2FudmFzLmhlaWdodCA9IDI1NjtcblxuXHRcdHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoICcyZCcgKTtcblx0XHR2YXIgaW1hZ2VEYXRhID0gY29udGV4dC5nZXRJbWFnZURhdGEoIDAsIDAsIDI1NiwgMjU2ICk7XG5cdFx0dmFyIGRhdGEgPSBpbWFnZURhdGEuZGF0YTtcblxuXHRcdGZvciAoIHZhciBpID0gMCwgaiA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSArPSA0LCBqICsrICkge1xuXG5cdFx0XHR2YXIgeCA9ICggKCBqICUgMjU2ICkgLyAyNTYgKSAtIDAuNTtcblx0XHRcdHZhciB5ID0gKCBNYXRoLmZsb29yKCBqIC8gMjU2ICkgLyAyNTYgKSAtIDAuNTtcblxuXHRcdFx0Y29sb3Iuc2V0SFNMKCBNYXRoLmF0YW4yKCB5LCB4ICkgLyBQSTIsIDEsKCAwLjUgLSBNYXRoLnNxcnQoIHggKiB4ICsgeSAqIHkgKSApICogMi4wICk7XG5cblx0XHRcdGRhdGFbIGkgKyAwIF0gPSBjb2xvci5yICogMjU2O1xuXHRcdFx0ZGF0YVsgaSArIDEgXSA9IGNvbG9yLmcgKiAyNTY7XG5cdFx0XHRkYXRhWyBpICsgMiBdID0gY29sb3IuYiAqIDI1Njtcblx0XHRcdGRhdGFbIGkgKyAzIF0gPSAyNTY7XG5cblx0XHR9XG5cblx0XHRjb250ZXh0LnB1dEltYWdlRGF0YSggaW1hZ2VEYXRhLCAwLCAwICk7XG5cblx0XHRyZXR1cm4gbmV3IFRIUkVFLkNhbnZhc1RleHR1cmUoIGNhbnZhcyApO1xuXG5cdH1cblxuXHR2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuQ2lyY2xlR2VvbWV0cnkoIDEsIDMyICk7XG5cdHZhciBtYXRlcmlhbCA9IG5ldyBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCggeyBtYXA6IGdlbmVyYXRlSHVlVGV4dHVyZSgpIH0gKTtcblx0dmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdGVyaWFsICk7XG5cdG1lc2gucG9zaXRpb24uc2V0KCAwLCAwLjAwNSwgMC4wNDk1ICk7XG5cdG1lc2gucm90YXRpb24ueCA9IC0gMS40NTtcblx0bWVzaC5zY2FsZS5zZXRTY2FsYXIoIDAuMDIgKTtcblx0dGhpcy5hZGQoIG1lc2ggKVxuXG5cdHZhciBnZW9tZXRyeSA9IG5ldyBUSFJFRS5JY29zYWhlZHJvbkdlb21ldHJ5KCAwLjEsIDIgKTtcblx0dmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKCk7XG5cdG1hdGVyaWFsLmNvbG9yID0gY29sb3I7XG5cdHZhciBiYWxsID0gbmV3IFRIUkVFLk1lc2goIGdlb21ldHJ5LCBtYXRlcmlhbCApO1xuXHRtZXNoLmFkZCggYmFsbCApO1xuXG5cdGZ1bmN0aW9uIG9uQXhpc0NoYW5nZWQoIGV2ZW50ICkge1xuXG5cdFx0aWYgKCB0aGlzLmdldEJ1dHRvblN0YXRlKCAndGh1bWJwYWQnICkgPT09IGZhbHNlICkgcmV0dXJuO1xuXG5cdFx0dmFyIHggPSBldmVudC5heGVzWyAwIF0gLyAyLjA7XG5cdFx0dmFyIHkgPSAtIGV2ZW50LmF4ZXNbIDEgXSAvIDIuMDtcblxuXHRcdGlmICggbW9kZSA9PT0gTU9ERVMuQ09MT1IgKSB7XG5cdFx0XHRjb2xvci5zZXRIU0woIE1hdGguYXRhbjIoIHksIHggKSAvIFBJMiwgMSwgKCAwLjUgLSBNYXRoLnNxcnQoIHggKiB4ICsgeSAqIHkgKSApICogMi4wICk7XG5cdFx0XHRiYWxsLnBvc2l0aW9uLnggPSBldmVudC5heGVzWyAwIF07XG5cdFx0XHRiYWxsLnBvc2l0aW9uLnkgPSBldmVudC5heGVzWyAxIF07XG5cdFx0fVxuXG5cdFx0aWYgKCBtb2RlID09PSBNT0RFUy5TSVpFICkge1xuXHRcdFx0c2l6ZSA9IHkgKyAxO1xuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gb25Hcmlwc0Rvd24oIGV2ZW50ICkge1xuXG5cdFx0aWYgKCBtb2RlID09PSBNT0RFUy5DT0xPUiApIHtcblx0XHRcdG1vZGUgPSBNT0RFUy5TSVpFO1xuXHRcdFx0bWVzaC52aXNpYmxlID0gZmFsc2U7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCBtb2RlID09PSBNT0RFUy5TSVpFICkge1xuXHRcdFx0bW9kZSA9IE1PREVTLkNPTE9SO1xuXHRcdFx0bWVzaC52aXNpYmxlID0gdHJ1ZTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0fVxuXG5cdHRoaXMuZ2V0Q29sb3IgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjb2xvcjsgfTtcblx0dGhpcy5nZXRTaXplID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gc2l6ZTsgfTtcblxuXHR0aGlzLmFkZEV2ZW50TGlzdGVuZXIoICdheGlzY2hhbmdlZCcsIG9uQXhpc0NoYW5nZWQgKTtcblx0dGhpcy5hZGRFdmVudExpc3RlbmVyKCAnZ3JpcHNkb3duJywgb25Hcmlwc0Rvd24gKTtcblxufTtcblxuVEhSRUUuUGFpbnRWaXZlQ29udHJvbGxlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBUSFJFRS5WaXZlQ29udHJvbGxlci5wcm90b3R5cGUgKTtcblRIUkVFLlBhaW50Vml2ZUNvbnRyb2xsZXIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gVEhSRUUuUGFpbnRWaXZlQ29udHJvbGxlcjtcbiIsIi8qKlxuICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbVxuICogQGF1dGhvciBzdGV3ZGlvIC8gaHR0cDovL3N0ZXdkLmlvXG4gKi9cblxuVEhSRUUuVml2ZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoIGlkICkge1xuXG5cdFRIUkVFLk9iamVjdDNELmNhbGwoIHRoaXMgKTtcblxuXHR2YXIgc2NvcGUgPSB0aGlzO1xuXHR2YXIgZ2FtZXBhZDtcblxuXHR2YXIgYXhlcyA9IFsgMCwgMCBdO1xuXHR2YXIgdGh1bWJwYWRJc1ByZXNzZWQgPSBmYWxzZTtcblx0dmFyIHRyaWdnZXJJc1ByZXNzZWQgPSBmYWxzZTtcblx0dmFyIGdyaXBzQXJlUHJlc3NlZCA9IGZhbHNlO1xuXHR2YXIgbWVudUlzUHJlc3NlZCA9IGZhbHNlO1xuXG5cdGZ1bmN0aW9uIGZpbmRHYW1lcGFkKCBpZCApIHtcblxuXHRcdC8vIEl0ZXJhdGUgYWNyb3NzIGdhbWVwYWRzIGFzIFZpdmUgQ29udHJvbGxlcnMgbWF5IG5vdCBiZVxuXHRcdC8vIGluIHBvc2l0aW9uIDAgYW5kIDEuXG5cblx0XHR2YXIgZ2FtZXBhZHMgPSBuYXZpZ2F0b3IuZ2V0R2FtZXBhZHMoKTtcblxuXHRcdGZvciAoIHZhciBpID0gMCwgaiA9IDA7IGkgPCA0OyBpICsrICkge1xuXG5cdFx0XHR2YXIgZ2FtZXBhZCA9IGdhbWVwYWRzWyBpIF07XG5cblx0XHRcdGlmICggZ2FtZXBhZCAmJiBnYW1lcGFkLmlkID09PSAnT3BlblZSIEdhbWVwYWQnICkge1xuXG5cdFx0XHRcdGlmICggaiA9PT0gaWQgKSByZXR1cm4gZ2FtZXBhZDtcblxuXHRcdFx0XHRqICsrO1xuXG5cdFx0XHR9XG5cblx0XHR9XG5cblx0fVxuXG5cdHRoaXMubWF0cml4QXV0b1VwZGF0ZSA9IGZhbHNlO1xuXHR0aGlzLnN0YW5kaW5nTWF0cml4ID0gbmV3IFRIUkVFLk1hdHJpeDQoKTtcblxuXHR0aGlzLmdldEdhbWVwYWQgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gZ2FtZXBhZDtcblxuXHR9O1xuXG5cdHRoaXMuZ2V0QnV0dG9uU3RhdGUgPSBmdW5jdGlvbiAoIGJ1dHRvbiApIHtcblxuXHRcdGlmICggYnV0dG9uID09PSAndGh1bWJwYWQnICkgcmV0dXJuIHRodW1icGFkSXNQcmVzc2VkO1xuXHRcdGlmICggYnV0dG9uID09PSAndHJpZ2dlcicgKSByZXR1cm4gdHJpZ2dlcklzUHJlc3NlZDtcblx0XHRpZiAoIGJ1dHRvbiA9PT0gJ2dyaXBzJyApIHJldHVybiBncmlwc0FyZVByZXNzZWQ7XG5cdFx0aWYgKCBidXR0b24gPT09ICdtZW51JyApIHJldHVybiBtZW51SXNQcmVzc2VkO1xuXG5cdH07XG5cblx0dGhpcy51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG5cblx0XHRnYW1lcGFkID0gZmluZEdhbWVwYWQoIGlkICk7XG5cblx0XHRpZiAoIGdhbWVwYWQgIT09IHVuZGVmaW5lZCAmJiBnYW1lcGFkLnBvc2UgIT09IHVuZGVmaW5lZCApIHtcblxuXHRcdFx0aWYgKCBnYW1lcGFkLnBvc2UgPT09IG51bGwgKSByZXR1cm47IC8vIE5vIHVzZXIgYWN0aW9uIHlldFxuXG5cdFx0XHQvLyAgUG9zaXRpb24gYW5kIG9yaWVudGF0aW9uLlxuXG5cdFx0XHR2YXIgcG9zZSA9IGdhbWVwYWQucG9zZTtcblxuXHRcdFx0aWYgKCBwb3NlLnBvc2l0aW9uICE9PSBudWxsICkgc2NvcGUucG9zaXRpb24uZnJvbUFycmF5KCBwb3NlLnBvc2l0aW9uICk7XG5cdFx0XHRpZiAoIHBvc2Uub3JpZW50YXRpb24gIT09IG51bGwgKSBzY29wZS5xdWF0ZXJuaW9uLmZyb21BcnJheSggcG9zZS5vcmllbnRhdGlvbiApO1xuXHRcdFx0c2NvcGUubWF0cml4LmNvbXBvc2UoIHNjb3BlLnBvc2l0aW9uLCBzY29wZS5xdWF0ZXJuaW9uLCBzY29wZS5zY2FsZSApO1xuXHRcdFx0c2NvcGUubWF0cml4Lm11bHRpcGx5TWF0cmljZXMoIHNjb3BlLnN0YW5kaW5nTWF0cml4LCBzY29wZS5tYXRyaXggKTtcblx0XHRcdHNjb3BlLm1hdHJpeFdvcmxkTmVlZHNVcGRhdGUgPSB0cnVlO1xuXHRcdFx0c2NvcGUudmlzaWJsZSA9IHRydWU7XG5cblx0XHRcdC8vICBUaHVtYnBhZCBhbmQgQnV0dG9ucy5cblxuXHRcdFx0aWYgKCBheGVzWyAwIF0gIT09IGdhbWVwYWQuYXhlc1sgMCBdIHx8IGF4ZXNbIDEgXSAhPT0gZ2FtZXBhZC5heGVzWyAxIF0gKSB7XG5cblx0XHRcdFx0YXhlc1sgMCBdID0gZ2FtZXBhZC5heGVzWyAwIF07IC8vICBYIGF4aXM6IC0xID0gTGVmdCwgKzEgPSBSaWdodC5cblx0XHRcdFx0YXhlc1sgMSBdID0gZ2FtZXBhZC5heGVzWyAxIF07IC8vICBZIGF4aXM6IC0xID0gQm90dG9tLCArMSA9IFRvcC5cblx0XHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggeyB0eXBlOiAnYXhpc2NoYW5nZWQnLCBheGVzOiBheGVzIH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHRodW1icGFkSXNQcmVzc2VkICE9PSBnYW1lcGFkLmJ1dHRvbnNbIDAgXS5wcmVzc2VkICkge1xuXG5cdFx0XHRcdHRodW1icGFkSXNQcmVzc2VkID0gZ2FtZXBhZC5idXR0b25zWyAwIF0ucHJlc3NlZDtcblx0XHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggeyB0eXBlOiB0aHVtYnBhZElzUHJlc3NlZCA/ICd0aHVtYnBhZGRvd24nIDogJ3RodW1icGFkdXAnIH0gKTtcblxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoIHRyaWdnZXJJc1ByZXNzZWQgIT09IGdhbWVwYWQuYnV0dG9uc1sgMSBdLnByZXNzZWQgKSB7XG5cblx0XHRcdFx0dHJpZ2dlcklzUHJlc3NlZCA9IGdhbWVwYWQuYnV0dG9uc1sgMSBdLnByZXNzZWQ7XG5cdFx0XHRcdHNjb3BlLmRpc3BhdGNoRXZlbnQoIHsgdHlwZTogdHJpZ2dlcklzUHJlc3NlZCA/ICd0cmlnZ2VyZG93bicgOiAndHJpZ2dlcnVwJyB9ICk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBncmlwc0FyZVByZXNzZWQgIT09IGdhbWVwYWQuYnV0dG9uc1sgMiBdLnByZXNzZWQgKSB7XG5cblx0XHRcdFx0Z3JpcHNBcmVQcmVzc2VkID0gZ2FtZXBhZC5idXR0b25zWyAyIF0ucHJlc3NlZDtcblx0XHRcdFx0c2NvcGUuZGlzcGF0Y2hFdmVudCggeyB0eXBlOiBncmlwc0FyZVByZXNzZWQgPyAnZ3JpcHNkb3duJyA6ICdncmlwc3VwJyB9ICk7XG5cblx0XHRcdH1cblxuXHRcdFx0aWYgKCBtZW51SXNQcmVzc2VkICE9PSBnYW1lcGFkLmJ1dHRvbnNbIDMgXS5wcmVzc2VkICkge1xuXG5cdFx0XHRcdG1lbnVJc1ByZXNzZWQgPSBnYW1lcGFkLmJ1dHRvbnNbIDMgXS5wcmVzc2VkO1xuXHRcdFx0XHRzY29wZS5kaXNwYXRjaEV2ZW50KCB7IHR5cGU6IG1lbnVJc1ByZXNzZWQgPyAnbWVudWRvd24nIDogJ21lbnV1cCcgfSApO1xuXG5cdFx0XHR9XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRzY29wZS52aXNpYmxlID0gZmFsc2U7XG5cblx0XHR9XG5cblx0fTtcblxufTtcblxuVEhSRUUuVml2ZUNvbnRyb2xsZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggVEhSRUUuT2JqZWN0M0QucHJvdG90eXBlICk7XG5USFJFRS5WaXZlQ29udHJvbGxlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBUSFJFRS5WaXZlQ29udHJvbGxlcjtcbiIsIi8qKlxuICogQGF1dGhvciBtcmRvb2IgLyBodHRwOi8vbXJkb29iLmNvbVxuICogQmFzZWQgb24gQHRvamlybydzIHZyLXNhbXBsZXMtdXRpbHMuanNcbiAqL1xuXG50aGlzLldFQlZSID0ge1xuXG5cdGlzTGF0ZXN0QXZhaWxhYmxlOiBmdW5jdGlvbiAoKSB7XG5cblx0XHRjb25zb2xlLndhcm4oICdXRUJWUjogaXNMYXRlc3RBdmFpbGFibGUoKSBpcyBiZWluZyBkZXByZWNhdGVkLiBVc2UgLmlzQXZhaWxhYmxlKCkgaW5zdGVhZC4nICk7XG5cdFx0cmV0dXJuIHRoaXMuaXNBdmFpbGFibGUoKTtcblxuXHR9LFxuXG5cdGlzQXZhaWxhYmxlOiBmdW5jdGlvbiAoKSB7XG5cblx0XHRyZXR1cm4gbmF2aWdhdG9yLmdldFZSRGlzcGxheXMgIT09IHVuZGVmaW5lZDtcblxuXHR9LFxuXG5cdGdldE1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcblxuXHRcdHZhciBtZXNzYWdlO1xuXG5cdFx0aWYgKCBuYXZpZ2F0b3IuZ2V0VlJEaXNwbGF5cyApIHtcblxuXHRcdFx0bmF2aWdhdG9yLmdldFZSRGlzcGxheXMoKS50aGVuKCBmdW5jdGlvbiAoIGRpc3BsYXlzICkge1xuXG5cdFx0XHRcdGlmICggZGlzcGxheXMubGVuZ3RoID09PSAwICkgbWVzc2FnZSA9ICdXZWJWUiBzdXBwb3J0ZWQsIGJ1dCBubyBWUkRpc3BsYXlzIGZvdW5kLic7XG5cblx0XHRcdH0gKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdG1lc3NhZ2UgPSAnWW91ciBicm93c2VyIGRvZXMgbm90IHN1cHBvcnQgV2ViVlIuIFNlZSA8YSBocmVmPVwiaHR0cDovL3dlYnZyLmluZm9cIj53ZWJ2ci5pbmZvPC9hPiBmb3IgYXNzaXN0YW5jZS4nO1xuXG5cdFx0fVxuXG5cdFx0aWYgKCBtZXNzYWdlICE9PSB1bmRlZmluZWQgKSB7XG5cblx0XHRcdHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xuXHRcdFx0Y29udGFpbmVyLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcblx0XHRcdGNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gJzAnO1xuXHRcdFx0Y29udGFpbmVyLnN0eWxlLnRvcCA9ICcwJztcblx0XHRcdGNvbnRhaW5lci5zdHlsZS5yaWdodCA9ICcwJztcblx0XHRcdGNvbnRhaW5lci5zdHlsZS56SW5kZXggPSAnOTk5Jztcblx0XHRcdGNvbnRhaW5lci5hbGlnbiA9ICdjZW50ZXInO1xuXG5cdFx0XHR2YXIgZXJyb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xuXHRcdFx0ZXJyb3Iuc3R5bGUuZm9udEZhbWlseSA9ICdzYW5zLXNlcmlmJztcblx0XHRcdGVycm9yLnN0eWxlLmZvbnRTaXplID0gJzE2cHgnO1xuXHRcdFx0ZXJyb3Iuc3R5bGUuZm9udFN0eWxlID0gJ25vcm1hbCc7XG5cdFx0XHRlcnJvci5zdHlsZS5saW5lSGVpZ2h0ID0gJzI2cHgnO1xuXHRcdFx0ZXJyb3Iuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNmZmYnO1xuXHRcdFx0ZXJyb3Iuc3R5bGUuY29sb3IgPSAnIzAwMCc7XG5cdFx0XHRlcnJvci5zdHlsZS5wYWRkaW5nID0gJzEwcHggMjBweCc7XG5cdFx0XHRlcnJvci5zdHlsZS5tYXJnaW4gPSAnNTBweCc7XG5cdFx0XHRlcnJvci5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XG5cdFx0XHRlcnJvci5pbm5lckhUTUwgPSBtZXNzYWdlO1xuXHRcdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKCBlcnJvciApO1xuXG5cdFx0XHRyZXR1cm4gY29udGFpbmVyO1xuXG5cdFx0fVxuXG5cdH0sXG5cblx0Z2V0QnV0dG9uOiBmdW5jdGlvbiAoIGVmZmVjdCApIHtcblxuXHRcdHZhciBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnYnV0dG9uJyApO1xuXHRcdGJ1dHRvbi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG5cdFx0YnV0dG9uLnN0eWxlLmxlZnQgPSAnY2FsYyg1MCUgLSA1MHB4KSc7XG5cdFx0YnV0dG9uLnN0eWxlLmJvdHRvbSA9ICcyMHB4Jztcblx0XHRidXR0b24uc3R5bGUud2lkdGggPSAnMTAwcHgnO1xuXHRcdGJ1dHRvbi5zdHlsZS5ib3JkZXIgPSAnMCc7XG5cdFx0YnV0dG9uLnN0eWxlLnBhZGRpbmcgPSAnOHB4Jztcblx0XHRidXR0b24uc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInO1xuXHRcdGJ1dHRvbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnIzAwMCc7XG5cdFx0YnV0dG9uLnN0eWxlLmNvbG9yID0gJyNmZmYnO1xuXHRcdGJ1dHRvbi5zdHlsZS5mb250RmFtaWx5ID0gJ3NhbnMtc2VyaWYnO1xuXHRcdGJ1dHRvbi5zdHlsZS5mb250U2l6ZSA9ICcxM3B4Jztcblx0XHRidXR0b24uc3R5bGUuZm9udFN0eWxlID0gJ25vcm1hbCc7XG5cdFx0YnV0dG9uLnN0eWxlLnRleHRBbGlnbiA9ICdjZW50ZXInO1xuXHRcdGJ1dHRvbi5zdHlsZS56SW5kZXggPSAnOTk5Jztcblx0XHRidXR0b24udGV4dENvbnRlbnQgPSAnRU5URVIgVlInO1xuXHRcdGJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XG5cblx0XHRcdGVmZmVjdC5pc1ByZXNlbnRpbmcgPyBlZmZlY3QuZXhpdFByZXNlbnQoKSA6IGVmZmVjdC5yZXF1ZXN0UHJlc2VudCgpO1xuXG5cdFx0fTtcblxuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCAndnJkaXNwbGF5cHJlc2VudGNoYW5nZScsIGZ1bmN0aW9uICggZXZlbnQgKSB7XG5cblx0XHRcdGJ1dHRvbi50ZXh0Q29udGVudCA9IGVmZmVjdC5pc1ByZXNlbnRpbmcgPyAnRVhJVCBWUicgOiAnRU5URVIgVlInO1xuXG5cdFx0fSwgZmFsc2UgKTtcblxuXHRcdHJldHVybiBidXR0b247XG5cblx0fVxuXG59O1xuIiwiXHJcbmlmKCAhVEhSRUUuUkVWSVNJT04uaW5jbHVkZXMoIFwiZDN4MHJcIiApICkge1xuXG5pZiggTnVtYmVyKFRIUkVFLlJFVklTSU9OKSA9PT0gNzQgKSB7XHJcbn1cclxuXHJcbnZhciB2ZWN0b3IzUG9vbCA9IFtdO1xyXG5USFJFRS5WZWN0b3IzUG9vbCA9IHtcclxuXHRuZXcgOiBmdW5jdGlvbih4LHkseikge1xyXG5cdFx0dmFyIHIgPSB2ZWN0b3IzUG9vbC5wb3AoKTtcclxuXHRcdGlmKCByICkge1xyXG5cdFx0XHRyLnggPSB4O1xyXG5cdFx0XHRyLnkgPSB5O1xyXG5cdFx0XHRyLnogPSB6O1xyXG5cdFx0fVxyXG5cdFx0ZWxzZXtcclxuXHRcdFx0ciA9IG5ldyBUSFJFRS5WZWN0b3IzKHgseSx6KTtcclxuXHRcdH1cclxuXHRcdHJldHVybiByO1xyXG5cdH1cclxufVxyXG5cclxuVEhSRUUuVmVjdG9yMy5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2ZWN0b3IzUG9vbC5wdXNoKCB0aGlzICk7XHJcbiAgICByZXR1cm4gdGhpcztcclxufVxyXG5cclxudmFyIHZlY3RvcjRQb29sID0gW107XHJcblRIUkVFLlZlY3RvcjRQb29sID0ge1xyXG5cdG5ldyA6IGZ1bmN0aW9uKHgseSx6LHcpIHtcclxuXHRcdHZhciByID0gdmVjdG9yNFBvb2wucG9wKCk7XHJcblx0XHRpZiggciApIHtcclxuXHRcdFx0ci54ID0geDtcclxuXHRcdFx0ci55ID0geTtcclxuXHRcdFx0ci56ID0gejtcclxuXHRcdFx0ci53ID0gdztcclxuXHRcdH1cclxuXHRcdGVsc2V7XHJcblx0XHRcdHIgPSBuZXcgVEhSRUUuVmVjdG9yNCh4LHkseix3KTtcclxuXHRcdH1cclxuXHRcdHJldHVybiByO1xyXG5cdH1cclxufVxyXG5cclxuVEhSRUUuVmVjdG9yNC5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2ZWN0b3I0UG9vbC5wdXNoKCB0aGlzICk7XHJcbiAgICByZXR1cm4gdGhpcztcclxufVxyXG5cclxuXHJcbi8qXHJcblx0SU5MSU5FRlVOQyggdm9pZCwgUm90YXRlLCAoIFJDT09SRCBkQW5nbGUsIFBfUE9JTlQgdmF4aXMxLCBQX1BPSU5UIHZheGlzMiApIClcclxuXHR7XHJcblx0ICAgX1BPSU5UIHYxLCB2MjtcclxuXHQgICBfUE9JTlQgdnNhdmU7XHJcblx0ICAgUkNPT1JEIGRzaW4gPSAoUkNPT1JEKVNJTiggZEFuZ2xlIClcclxuXHQgICBcdCAgLCBkY29zID0gKFJDT09SRClDT1MoIGRBbmdsZSApO1xyXG5cdCAgIE1lbUNweSggdnNhdmUsIHZheGlzMSwgc2l6ZW9mKCBfUE9JTlQgKSApO1xyXG5cdCAgIERPRlVOQyhzY2FsZSkoIHYxLCB2YXhpczEsIGRjb3MgKTtcclxuXHQgICBET0ZVTkMoc2NhbGUpKCB2MiwgdmF4aXMyLCBkc2luICk7XHJcblx0ICAgRE9GVU5DKHN1YikoIHZheGlzMSwgdjEsIHYyICk7XHJcblx0ICAgRE9GVU5DKHNjYWxlKSggdjIsIHZzYXZlLCBkc2luICk7XHJcblx0ICAgRE9GVU5DKHNjYWxlKSggdjEsIHZheGlzMiwgZGNvcyApO1xyXG5cdCAgIERPRlVOQyhhZGQpKCB2YXhpczIsIHYyLCB2MSApO1xyXG5cdH1cclxuKi9cclxuXHJcblRIUkVFLlZlY3RvcjNVbml0ID0gbmV3ICAgICAgVEhSRUUuVmVjdG9yMyggIDEsICAxLCAgMSApO1xyXG5USFJFRS5WZWN0b3IzWmVybyA9IG5ldyAgICAgIFRIUkVFLlZlY3RvcjMoICAwLCAgMCwgIDAgKTtcclxuVEhSRUUuVmVjdG9yM1JpZ2h0ID0gbmV3ICAgICBUSFJFRS5WZWN0b3IzKCAtMSwgIDAsICAwICk7XHJcblRIUkVFLlZlY3RvcjNCYWNrd2FyZCA9IG5ldyAgVEhSRUUuVmVjdG9yMyggIDAsICAwLCAgMSApO1xyXG5USFJFRS5WZWN0b3IzVXAgPSBuZXcgICAgICAgIFRIUkVFLlZlY3RvcjMoICAwLCAgMSwgIDAgKTtcclxuVEhSRUUuVmVjdG9yM0xlZnQgPSBuZXcgICAgICBUSFJFRS5WZWN0b3IzKCAgMSwgIDAsICAwICk7XHJcblRIUkVFLlZlY3RvcjNGb3J3YXJkID0gbmV3ICAgVEhSRUUuVmVjdG9yMyggIDAsICAwLCAtMSApO1xyXG5USFJFRS5WZWN0b3IzRG93biA9IG5ldyAgICAgIFRIUkVFLlZlY3RvcjMoICAwLCAtMSwgIDAgKTtcclxuXHJcblxyXG5bXCJWZWN0b3IzVW5pdFwiXHJcbixcIlZlY3RvcjNaZXJvXCJcclxuLFwiVmVjdG9yM1JpZ2h0XCJcclxuLFwiVmVjdG9yM0JhY2t3YXJkXCJcclxuLFwiVmVjdG9yM1VwXCJcclxuLFwiVmVjdG9yM0xlZnRcIlxyXG4sXCJWZWN0b3IzRm9yd2FyZFwiXHJcbixcIlZlY3RvcjNEb3duXCJdLmZvckVhY2goIGZ1bmN0aW9uKGtleSl7XHJcblx0T2JqZWN0LmZyZWV6ZShUSFJFRVtrZXldKVxyXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUSFJFRVtrZXldLCBcInhcIiwgeyB3cml0YWJsZTogZmFsc2UgfSlcclxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoVEhSRUVba2V5XSwgXCJ5XCIsIHsgd3JpdGFibGU6IGZhbHNlIH0pXHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KFRIUkVFW2tleV0sIFwielwiLCB7IHdyaXRhYmxlOiBmYWxzZSB9KVxyXG59KVxyXG5cclxudmFyIG9sZFByb3RvID0gVEhSRUUuTWF0cml4NC5wcm90b3R5cGU7XHJcbnZhciBvbGRNYXRyaXhDb250cnVjdG9yID0gVEhSRUUuTWF0cml4NC5wcm90b3R5cGUuY29uc3RydWN0b3I7XHJcblRIUkVFLk1hdHJpeDR4ID0gZnVuY3Rpb24oKSB7XHJcblx0dGhpcy5lbGVtZW50cyA9IG5ldyBGbG9hdDMyQXJyYXkoIFtcclxuXHJcblx0XHQxLCAwLCAwLCAwLFxyXG5cdFx0MCwgMSwgMCwgMCxcclxuXHRcdDAsIDAsIDEsIDAsXHJcblx0XHQwLCAwLCAwLCAxXHJcblxyXG5cdF0gKTtcclxuXHJcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZWxlbWVudHNcIiwgeyB3cml0YWJsZTpmYWxzZSB9ICk7XHJcblxyXG5cclxufVxyXG5cclxuVEhSRUUuTWF0cml4NC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyggXCJtb3Rpb25cIiwgZnVuY3Rpb24oKXtcclxuXHRpZiggIXRoaXMuX21vdGlvbiApe1xyXG4gICAgICAgIHRoaXMuX21vdGlvbiA9IHtcclxuICAgICAgICBcdHRpY2sgOiAwLFxyXG4gICAgICAgIFx0c3BlZWQgOiBuZXcgVEhSRUUuVmVjdG9yMygpLFxyXG4gICAgICAgICAgICAgICAgYWNjZWxlcmF0aW9uIDogbmV3IFRIUkVFLlZlY3RvcjMoKSxcclxuICAgICAgICAgICAgICAgIHJvdGF0aW9uIDogbmV3IFRIUkVFLlZlY3RvcjMoKSxcclxuICAgICAgICAgICAgICAgIHRvcnF1ZSA6IG5ldyBUSFJFRS5WZWN0b3IzKCksXHJcbiAgICAgICAgICAgICAgICBtYXNzIDogMS4wLFxyXG4gICAgICAgICAgICAgICAgbW92ZSA6IGZ1bmN0aW9uKCBtLCBkZWx0YSApIHtcclxuXHRcdFx0XHRcdHRoaXMuc3BlZWQuYWRkU2NhbGVkVmVjdG9yKCB0aGlzLmFjY2VsZXJhdGlvbiwgZGVsdGEgKTtcclxuXHRcdFx0XHRcdHZhciBkZWwgPSB0aGlzLnNwZWVkLmNsb25lKCkubXVsdGlwbHlTY2FsYXIoIGRlbHRhICk7XHJcblxyXG5cdFx0XHRcdFx0bS5vcmlnaW4uYWRkU2NhbGVkVmVjdG9yKCBtLmZvcndhcmQsIGRlbC56ICk7XHJcblx0XHRcdFx0XHRtLm9yaWdpbi5hZGRTY2FsZWRWZWN0b3IoIG0udXAsIGRlbC55ICk7XHJcblx0XHRcdFx0XHRtLm9yaWdpbi5hZGRTY2FsZWRWZWN0b3IoIG0ubGVmdCwgZGVsLnggKTtcclxuXHJcblx0XHRcdFx0XHR0aGlzLnJvdGF0aW9uLmFkZFNjYWxlZFZlY3RvciggdGhpcy50b3JxdWUsIGRlbHRhICk7XHJcblx0XHRcdFx0XHR2YXIgdGhpc19tb3ZlID0gdGhpcy5yb3RhdGlvbi5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKCBkZWx0YSApXHJcblx0XHRcdFx0XHRtLnJvdGF0ZVJlbGF0aXZlKCB0aGlzX21vdmUueCwgdGhpc19tb3ZlLnksIHRoaXNfbW92ZS56ICk7XHJcblx0XHRcdFx0XHR0aGlzX21vdmUuZGVsZXRlKCk7XHJcblx0XHRcdFx0XHRkZWwuZGVsZXRlKCk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRyb3RhdGUgOiBmdW5jdGlvbiggbSwgZGVsdGEgKSB7XHJcblx0XHRcdFx0XHR2YXIgaXRlcmF0aW9ucyA9IDE7XHJcblxyXG5cdFx0XHRcdFx0dmFyIG1heCA9IE1hdGguYWJzKCB0aGlzLnJvdGF0aW9uLnggKTtcclxuXHRcdFx0XHRcdHZhciB0bXAgPSBNYXRoLmFicyggdGhpcy5yb3RhdGlvbi55ICk7XHJcblx0XHRcdFx0XHRpZiggdG1wID4gbWF4ICkge1xyXG5cdFx0XHRcdFx0XHRtYXggPSB0bXA7XHJcblx0XHRcdFx0XHRcdHRtcCA9IE1hdGguYWJzKCB0aGlzLnJvdGF0aW9uLnogKTtcclxuXHRcdFx0XHRcdFx0aWYoIHRtcCA+IG1heCApIHtcclxuXHRcdFx0XHRcdFx0XHRtYXggPSB0bXA7XHJcblx0XHRcdFx0XHRcdFx0d2hpbGUoICggKCBtYXggKiBkZWx0YSApIC8gaXRlcmF0aW9ucyApID4gMC4xIClcclxuXHRcdFx0XHRcdFx0XHRcdGl0ZXJhdGlvbnMrKztcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHR3aGlsZSggKCAoIG1heCAqIGRlbHRhICkgLyBpdGVyYXRpb25zICkgPiAwLjEgKVxyXG5cdFx0XHRcdFx0XHRcdFx0aXRlcmF0aW9ucysrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR0bXAgPSBNYXRoLmFicyggdGhpcy5yb3RhdGlvbi56ICk7XHJcblx0XHRcdFx0XHRcdGlmKCB0bXAgPiBtYXggKSB7XHJcblx0XHRcdFx0XHRcdFx0bWF4ID0gdG1wO1xyXG5cdFx0XHRcdFx0XHRcdHdoaWxlKCAoICggbWF4ICogZGVsdGEgKSAvIGl0ZXJhdGlvbnMgKSA+IDAuMSApXHJcblx0XHRcdFx0XHRcdFx0XHRpdGVyYXRpb25zKys7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0d2hpbGUoICggKCBtYXggKiBkZWx0YSApIC8gaXRlcmF0aW9ucyApID4gMC4xIClcclxuXHRcdFx0XHRcdFx0XHRcdGl0ZXJhdGlvbnMrKztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dmFyIGRlbHggPSAoIHRoaXMucm90YXRpb24ueCAqIGRlbHRhICkgLyBpdGVyYXRpb25zO1xyXG5cdFx0XHRcdFx0dmFyIGRlbHkgPSAoIHRoaXMucm90YXRpb24ueSAqIGRlbHRhICkgLyBpdGVyYXRpb25zO1xyXG5cdFx0XHRcdFx0dmFyIGRlbHogPSAoIHRoaXMucm90YXRpb24ueiAqIGRlbHRhICkgLyBpdGVyYXRpb25zO1xyXG5cdFx0XHRcdFx0Zm9yKCB2YXIgbiA9IDA7IG4gPCBpdGVyYXRpb25zOyBuKysgKSB7XHJcblx0XHRcdFx0XHRcdG0ucm90YXRlUmVsYXRpdmUoIGRlbHgsIGRlbHksIGRlbHogKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vIGRlbHRhID0gZGVsdGEgLyAxMDAwO1xyXG5cdFx0XHRcdFx0LypcclxuXHRcdFx0XHRcdCAgICoqIHRoaXMgaXMgYmVjb21pbmcgYSBwaHlzaWNzIGVuZ2luZSBmcmFtZS4uLlxyXG5cdFx0XHRcdFx0ICAgKiogbWlnaHQgYXMgd2VsbCBqdXN0IGFkZCB0aGF0LlxyXG4gICAgICAgICAgICAgICAgXHR2YXIgZGVsdGFfYWNjZWwgPSB0aGlzLmFjY2VsZXJhdGlvbi5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKGRlbHRhKTtcclxuXHRcdFx0XHRcdGlmKCAoIHRoaXMucm90YXRpb24ueCA+ICggTWF0aC5QSSAvIDQgKSApXHJcblx0XHRcdFx0XHQgICB8fCggdGhpcy5yb3RhdGlvbi54IDwgLSggTWF0aC5QSSAvIDQgKSApXHJcblx0XHRcdFx0XHQgICB8fCggdGhpcy5yb3RhdGlvbi55ID4gKCBNYXRoLlBJIC8gNCApIClcclxuXHRcdFx0XHRcdCAgIHx8KCB0aGlzLnJvdGF0aW9uLnkgPCAtKCBNYXRoLlBJIC8gNCApIClcclxuXHRcdFx0XHRcdCAgIHx8KCB0aGlzLnJvdGF0aW9uLnogPiAoIE1hdGguUEkgLyA0ICkgKVxyXG5cdFx0XHRcdFx0ICAgfHwoIHRoaXMucm90YXRpb24ueiA8IC0oIE1hdGguUEkgLyA0ICkgKVxyXG5cdFx0XHRcdFx0ICAgKXtcclxuXHRcdFx0XHRcdFx0ICAgdmFyIG1heCA9IHRoaXMucm90YXRpb24ueDtcclxuXHRcdFx0XHRcdFx0ICAgaWYoIG1heCA8IHRoaXMucm90YXRpb24ueSApXHJcblx0XHRcdFx0XHRcdCAgIFx0IG1heCA9IHRoaXMucm90YXRpb24ueTtcclxuXHRcdFx0XHRcdFx0ICAgaWYoIG1heCA8IHRoaXMucm90YXRpb24ueiApXHJcblx0XHRcdFx0XHRcdCAgICAgbWF4ID0gdGhpcy5yb3RhdGlvbi56O1xyXG5cdFx0XHRcdFx0XHQgdmFyIG1pbiA9IHRoaXMucm90YXRpb24ueDtcclxuICBcdFx0XHRcdFx0XHQgICBpZiggbWluID4gdGhpcy5yb3RhdGlvbi55IClcclxuICBcdFx0XHRcdFx0XHQgICBcdCBtYXggPSB0aGlzLnJvdGF0aW9uLnk7XHJcbiAgXHRcdFx0XHRcdFx0ICAgaWYoIG1pbiA+IHRoaXMucm90YXRpb24ueiApXHJcbiAgXHRcdFx0XHRcdFx0ICAgICBtYXggPSB0aGlzLnJvdGF0aW9uLno7XHJcblx0XHRcdFx0XHRcdFx0aWYoIG1pbiA8IDAgKVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYoIG1heCA8IC1taW4gKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRtYXggPSAtbWluO1xyXG5cdFx0XHRcdFx0XHRcdHZhciB0O1xyXG5cdFx0XHRcdFx0XHRcdGZvciggdCA9IDE7IHQgPCAxMDA7IHQrKyApXHJcblx0XHRcdFx0XHRcdFx0XHRpZiggKCBtYXggLyB0ICkgPCAoIE1hdGguUEkgLyA0ICkpXHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRkZWx0YV9hY2NlbC5zY2FsZSggMSAvIHQgKTtcclxuXHRcdFx0XHRcdCAgIH1cclxuXHRcdFx0XHRcdCAgKi9cclxuXHRcdFx0XHQgIH0sXHJcblxyXG5cclxuXHRcdFx0cm90YXRlIDogZnVuY3Rpb24oIG0sIGRlbHRhICkge1xyXG5cdFx0XHRcdHZhciBpdGVyYXRpb25zID0gMTtcclxuXHJcblx0XHRcdFx0dmFyIG1heCA9IE1hdGguYWJzKCB0aGlzLnJvdGF0aW9uLnggKTtcclxuXHRcdFx0XHR2YXIgdG1wID0gTWF0aC5hYnMoIHRoaXMucm90YXRpb24ueSApO1xyXG5cdFx0XHRcdGlmKCB0bXAgPiBtYXggKSB7XHJcblx0XHRcdFx0XHRtYXggPSB0bXA7XHJcblx0XHRcdFx0XHR0bXAgPSBNYXRoLmFicyggdGhpcy5yb3RhdGlvbi56ICk7XHJcblx0XHRcdFx0XHRpZiggdG1wID4gbWF4ICkge1xyXG5cdFx0XHRcdFx0XHRtYXggPSB0bXA7XHJcblx0XHRcdFx0XHRcdHdoaWxlKCAoICggbWF4ICogZGVsdGEgKSAvIGl0ZXJhdGlvbnMgKSA+IDAuMSApXHJcblx0XHRcdFx0XHRcdFx0aXRlcmF0aW9ucysrO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0d2hpbGUoICggKCBtYXggKiBkZWx0YSApIC8gaXRlcmF0aW9ucyApID4gMC4xIClcclxuXHRcdFx0XHRcdFx0XHRpdGVyYXRpb25zKys7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRtcCA9IE1hdGguYWJzKCB0aGlzLnJvdGF0aW9uLnogKTtcclxuXHRcdFx0XHRcdGlmKCB0bXAgPiBtYXggKSB7XHJcblx0XHRcdFx0XHRcdG1heCA9IHRtcDtcclxuXHRcdFx0XHRcdFx0d2hpbGUoICggKCBtYXggKiBkZWx0YSApIC8gaXRlcmF0aW9ucyApID4gMC4xIClcclxuXHRcdFx0XHRcdFx0XHRpdGVyYXRpb25zKys7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR3aGlsZSggKCAoIG1heCAqIGRlbHRhICkgLyBpdGVyYXRpb25zICkgPiAwLjEgKVxyXG5cdFx0XHRcdFx0XHRcdGl0ZXJhdGlvbnMrKztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGRlbHggPSAoIHRoaXMucm90YXRpb24ueCAqIGRlbHRhICkgLyBpdGVyYXRpb25zO1xyXG5cdFx0XHRcdHZhciBkZWx5ID0gKCB0aGlzLnJvdGF0aW9uLnkgKiBkZWx0YSApIC8gaXRlcmF0aW9ucztcclxuXHRcdFx0XHR2YXIgZGVseiA9ICggdGhpcy5yb3RhdGlvbi56ICogZGVsdGEgKSAvIGl0ZXJhdGlvbnM7XHJcblx0XHRcdFx0Zm9yKCB2YXIgbiA9IDA7IG4gPCBpdGVyYXRpb25zOyBuKysgKSB7XHJcblx0XHRcdFx0XHRtLnJvdGF0ZVJlbGF0aXZlKCBkZWx4LCBkZWx5LCBkZWx6ICk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdC8vIGRlbHRhID0gZGVsdGEgLyAxMDAwO1xyXG5cdFx0XHRcdC8qXHJcblx0XHRcdFx0XHQgKiogdGhpcyBpcyBiZWNvbWluZyBhIHBoeXNpY3MgZW5naW5lIGZyYW1lLi4uXHJcblx0XHRcdFx0XHQgKiogbWlnaHQgYXMgd2VsbCBqdXN0IGFkZCB0aGF0LlxyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRlbHRhX2FjY2VsID0gdGhpcy5hY2NlbGVyYXRpb24uY2xvbmUoKS5tdWx0aXBseVNjYWxhcihkZWx0YSk7XHJcblx0XHRcdFx0aWYoICggdGhpcy5yb3RhdGlvbi54ID4gKCBNYXRoLlBJIC8gNCApIClcclxuXHRcdFx0XHRcdCB8fCggdGhpcy5yb3RhdGlvbi54IDwgLSggTWF0aC5QSSAvIDQgKSApXHJcblx0XHRcdFx0XHQgfHwoIHRoaXMucm90YXRpb24ueSA+ICggTWF0aC5QSSAvIDQgKSApXHJcblx0XHRcdFx0XHQgfHwoIHRoaXMucm90YXRpb24ueSA8IC0oIE1hdGguUEkgLyA0ICkgKVxyXG5cdFx0XHRcdFx0IHx8KCB0aGlzLnJvdGF0aW9uLnogPiAoIE1hdGguUEkgLyA0ICkgKVxyXG5cdFx0XHRcdFx0IHx8KCB0aGlzLnJvdGF0aW9uLnogPCAtKCBNYXRoLlBJIC8gNCApIClcclxuXHRcdFx0XHRcdCApe1xyXG5cdFx0XHRcdFx0XHQgdmFyIG1heCA9IHRoaXMucm90YXRpb24ueDtcclxuXHRcdFx0XHRcdFx0IGlmKCBtYXggPCB0aGlzLnJvdGF0aW9uLnkgKVxyXG5cdFx0XHRcdFx0XHRcdCBtYXggPSB0aGlzLnJvdGF0aW9uLnk7XHJcblx0XHRcdFx0XHRcdCBpZiggbWF4IDwgdGhpcy5yb3RhdGlvbi56IClcclxuXHRcdFx0XHRcdFx0XHQgbWF4ID0gdGhpcy5yb3RhdGlvbi56O1xyXG5cdFx0XHRcdFx0IHZhciBtaW4gPSB0aGlzLnJvdGF0aW9uLng7XHJcblx0XHRcdFx0XHRcdFx0IGlmKCBtaW4gPiB0aGlzLnJvdGF0aW9uLnkgKVxyXG5cdFx0XHRcdFx0XHRcdFx0IG1heCA9IHRoaXMucm90YXRpb24ueTtcclxuXHRcdFx0XHRcdFx0XHQgaWYoIG1pbiA+IHRoaXMucm90YXRpb24ueiApXHJcblx0XHRcdFx0XHRcdFx0XHQgbWF4ID0gdGhpcy5yb3RhdGlvbi56O1xyXG5cdFx0XHRcdFx0XHRpZiggbWluIDwgMCApXHJcblx0XHRcdFx0XHRcdFx0aWYoIG1heCA8IC1taW4gKVxyXG5cdFx0XHRcdFx0XHRcdFx0bWF4ID0gLW1pbjtcclxuXHRcdFx0XHRcdFx0dmFyIHQ7XHJcblx0XHRcdFx0XHRcdGZvciggdCA9IDE7IHQgPCAxMDA7IHQrKyApXHJcblx0XHRcdFx0XHRcdFx0aWYoICggbWF4IC8gdCApIDwgKCBNYXRoLlBJIC8gNCApKVxyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRcdFx0XHRkZWx0YV9hY2NlbC5zY2FsZSggMSAvIHQgKTtcclxuXHRcdFx0XHRcdCB9XHJcblx0XHRcdFx0XHQqL1xyXG5cdFx0XHRcdH1cclxuXHJcblx0ICAgICAgICB9O1xyXG5cdH1cclxuXHRyZXR1cm4gdGhpcy5fbW90aW9uO1xyXG59ICk7XHJcblxyXG5USFJFRS5NYXRyaXg0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fKCBcIm9yaWdpblwiLCBmdW5jdGlvbigpe1xyXG5cdGlmKCAhdGhpcy5fb3JpZ2luICl7XHJcblx0XHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0XHR0aGlzLl9vcmlnaW4gPSBuZXcgVEhSRUUuVmVjdG9yMygpO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX29yaWdpblwiLCB7IHdyaXRhYmxlOmZhbHNlIH0gKTtcclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSggdGhpcy5fb3JpZ2luLCBcInhcIiwge1xyXG5cdFx0XHRnZXQgOiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJldHVybiBzZWxmLmVsZW1lbnRzWzEyXTtcclxuXHRcdFx0fSxcclxuXHRcdFx0c2V0IDogZnVuY3Rpb24odil7XHJcblx0XHRcdFx0c2VsZi5lbGVtZW50c1sxMl0gPSB2O1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KCB0aGlzLl9vcmlnaW4sIFwieVwiLCB7XHJcblx0XHRcdGdldCA6ICgpPT57XHJcblx0XHRcdFx0cmV0dXJuIHNlbGYuZWxlbWVudHNbMTNdO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRzZXQgOiAodik9PntcclxuXHRcdFx0XHRzZWxmLmVsZW1lbnRzWzEzXSA9IHY7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoIHRoaXMuX29yaWdpbiwgXCJ6XCIsIHtcclxuXHRcdFx0Z2V0IDogKCk9PntcclxuXHRcdFx0XHRyZXR1cm4gc2VsZi5lbGVtZW50c1sxNF07XHJcblx0XHRcdH0sXHJcblx0XHRcdHNldCA6ICh2KT0+e1xyXG5cdFx0XHRcdHNlbGYuZWxlbWVudHNbMTRdID0gdjtcclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHR9XHJcblx0cmV0dXJuIHRoaXMuX29yaWdpbjtcclxufSApO1xyXG5cclxuXHJcblxyXG5cclxuVEhSRUUuTWF0cml4NC5wcm90b3R5cGUucm90YXRlT3J0aG8gPSBmdW5jdGlvbiggYW5nbGUsIGF4aXMxLCBheGlzMiApIHtcclxuXHRcdGlmKCAhYW5nbGUgKSByZXR1cm47XHJcblx0XHQvLyAwID0geDsgIDBcclxuXHRcdC8vIDEgPSB5OyAgNFxyXG5cdFx0Ly8gMiA9IHo7ICA4XHJcblx0XHR2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xyXG5cdFx0dmFyIHNhID0gTWF0aC5zaW4oIGFuZ2xlICk7XHJcblx0XHR2YXIgY2EgPSBNYXRoLmNvcyggYW5nbGUgKTtcclxuICAgICAgICBzd2l0Y2goIGF4aXMxIClcdHtcclxuXHRcdFx0Y2FzZSAwOiBzd2l0Y2goIGF4aXMyICl7XHJcblx0XHRcdFx0Y2FzZSAwOlxyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIkludmFsaWQgYXhpcyBjb21iaW5hdGlvbiwgY2Fubm90IHJvdGF0ZSBheGlzIHRvd2FyZCBpdHNlbGZcIilcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIDE6XHJcblx0XHRcdFx0XHR2YXIgc2F2ZTF4ID0gdGVbMF0sIHNhdmUxeSA9IHRlWzFdLCBzYXZlMXogPSB0ZVsyXTtcclxuXHRcdFx0XHRcdHZhciB0bXAxeCA9IHRlWzBdICogY2EsIHRtcDF5ID0gdGVbMV0gKiBjYSwgdG1wMXogPSB0ZVsyXSAqIGNhO1xyXG5cdFx0XHRcdFx0dmFyIHRtcDJ4ID0gdGVbNF0gKiBzYSwgdG1wMnkgPSB0ZVs1XSAqIHNhLCB0bXAyeiA9IHRlWzZdICogc2E7XHJcblx0XHRcdFx0XHR0ZVswXSA9IHRtcDF4IC0gdG1wMng7IHRlWzFdID0gdG1wMXkgLSB0bXAyeTsgdGVbMl0gPSB0bXAxeiAtIHRtcDJ6O1xyXG5cdFx0XHRcdFx0dG1wMnggPSBzYXZlMXggKiBzYTsgdG1wMnkgPSBzYXZlMXkgKiBzYTsgdG1wMnogPSBzYXZlMXogKiBzYTtcclxuXHRcdFx0XHRcdHRtcDF4ID0gdGVbNF0gKiBjYTsgdG1wMXkgPSB0ZVs1XSAqIGNhOyB0bXAxeiA9IHRlWzZdICogY2E7XHJcblx0XHRcdFx0XHR0ZVs0XSA9IHRtcDF4ICsgdG1wMng7IHRlWzVdID0gdG1wMXkgKyB0bXAyeTsgdGVbNl0gPSB0bXAxeiArIHRtcDJ6O1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAyOlxyXG5cdFx0XHRcdFx0dmFyIHNhdmUxeCA9IHRlWzBdLCBzYXZlMXkgPSB0ZVsxXSwgc2F2ZTF6ID0gdGVbMl07XHJcblx0XHRcdFx0XHR2YXIgdG1wMXggPSB0ZVswXSAqIGNhLCB0bXAxeSA9IHRlWzFdICogY2EsIHRtcDF6ID0gdGVbMl0gKiBjYTtcclxuXHRcdFx0XHRcdHZhciB0bXAyeCA9IHRlWzhdICogc2EsIHRtcDJ5ID0gdGVbOV0gKiBzYSwgdG1wMnogPSB0ZVsxMF0gKiBzYTtcclxuXHRcdFx0XHRcdHRlWzBdID0gdG1wMXggLSB0bXAyeDsgdGVbMV0gPSB0bXAxeSAtIHRtcDJ5OyB0ZVsyXSA9IHRtcDF6IC0gdG1wMno7XHJcblx0XHRcdFx0XHR0bXAyeCA9IHNhdmUxeCAqIHNhOyB0bXAyeSA9IHNhdmUxeSAqIHNhOyB0bXAyeiA9IHNhdmUxeiAqIHNhO1xyXG5cdFx0XHRcdFx0dG1wMXggPSB0ZVs4XSAqIGNhOyB0bXAxeSA9IHRlWzldICogY2E7IHRtcDF6ID0gdGVbMTBdICogY2E7XHJcblx0XHRcdFx0XHR0ZVs4XSA9IHRtcDF4ICsgdG1wMng7IHRlWzldID0gdG1wMXkgKyB0bXAyeTsgdGVbMTBdID0gdG1wMXogKyB0bXAyejtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIDE6IHN3aXRjaCggYXhpczIgKXtcclxuXHRcdFx0XHRjYXNlIDA6XHJcblx0XHRcdFx0XHR2YXIgc2F2ZTF4ID0gdGVbNF0sIHNhdmUxeSA9IHRlWzVdLCBzYXZlMXogPSB0ZVs2XTtcclxuXHRcdFx0XHRcdHZhciB0bXAxeCA9IHRlWzRdICogY2EsIHRtcDF5ID0gdGVbNV0gKiBjYSwgdG1wMXogPSB0ZVs2XSAqIGNhO1xyXG5cdFx0XHRcdFx0dmFyIHRtcDJ4ID0gdGVbMF0gKiBzYSwgdG1wMnkgPSB0ZVsxXSAqIHNhLCB0bXAyeiA9IHRlWzJdICogc2E7XHJcblx0XHRcdFx0XHR0ZVs0XSA9IHRtcDF4IC0gdG1wMng7IHRlWzVdID0gdG1wMXkgLSB0bXAyeTsgdGVbNl0gPSB0bXAxeiAtIHRtcDJ6O1xyXG5cdFx0XHRcdFx0dG1wMnggPSBzYXZlMXggKiBzYTsgdG1wMnkgPSBzYXZlMXkgKiBzYTsgdG1wMnogPSBzYXZlMXogKiBzYTtcclxuXHRcdFx0XHRcdHRtcDF4ID0gdGVbMF0gKiBjYTsgdG1wMXkgPSB0ZVsxXSAqIGNhOyB0bXAxeiA9IHRlWzJdICogY2E7XHJcblx0XHRcdFx0XHR0ZVswXSA9IHRtcDF4ICsgdG1wMng7IHRlWzFdID0gdG1wMXkgKyB0bXAyeTsgdGVbMl0gPSB0bXAxeiArIHRtcDJ6O1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAxOlxyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIkludmFsaWQgYXhpcyBjb21iaW5hdGlvbiwgY2Fubm90IHJvdGF0ZSBheGlzIHRvd2FyZCBpdHNlbGZcIilcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIDI6XHJcblx0XHRcdFx0XHR2YXIgc2F2ZTF4ID0gdGVbNF0sIHNhdmUxeSA9IHRlWzVdLCBzYXZlMXogPSB0ZVs2XTtcclxuXHRcdFx0XHRcdHZhciB0bXAxeCA9IHRlWzRdICogY2EsIHRtcDF5ID0gdGVbNV0gKiBjYSwgdG1wMXogPSB0ZVs2XSAqIGNhO1xyXG5cdFx0XHRcdFx0dmFyIHRtcDJ4ID0gdGVbOF0gKiBzYSwgdG1wMnkgPSB0ZVs5XSAqIHNhLCB0bXAyeiA9IHRlWzEwXSAqIHNhO1xyXG5cdFx0XHRcdFx0dGVbNF0gPSB0bXAxeCAtIHRtcDJ4OyB0ZVs1XSA9IHRtcDF5IC0gdG1wMnk7IHRlWzZdID0gdG1wMXogLSB0bXAyejtcclxuXHRcdFx0XHRcdHRtcDJ4ID0gc2F2ZTF4ICogc2E7IHRtcDJ5ID0gc2F2ZTF5ICogc2E7IHRtcDJ6ID0gc2F2ZTF6ICogc2E7XHJcblx0XHRcdFx0XHR0bXAxeCA9IHRlWzhdICogY2E7IHRtcDF5ID0gdGVbOV0gKiBjYTsgdG1wMXogPSB0ZVsxMF0gKiBjYTtcclxuXHRcdFx0XHRcdHRlWzhdID0gdG1wMXggKyB0bXAyeDsgdGVbOV0gPSB0bXAxeSArIHRtcDJ5OyB0ZVsxMF0gPSB0bXAxeiArIHRtcDJ6O1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIDI6IHN3aXRjaCggYXhpczIgKXtcclxuXHRcdFx0XHRjYXNlIDA6XHJcblx0XHRcdFx0XHR2YXIgc2F2ZTF4ID0gdGVbOF0sIHNhdmUxeSA9IHRlWzldLCBzYXZlMXogPSB0ZVsxMF07XHJcblx0XHRcdFx0XHR2YXIgdG1wMXggPSB0ZVs4XSAqIGNhLCB0bXAxeSA9IHRlWzldICogY2EsIHRtcDF6ID0gdGVbMTBdICogY2E7XHJcblx0XHRcdFx0XHR2YXIgdG1wMnggPSB0ZVswXSAqIHNhLCB0bXAyeSA9IHRlWzFdICogc2EsIHRtcDJ6ID0gdGVbMl0gKiBzYTtcclxuXHRcdFx0XHRcdHRlWzhdID0gdG1wMXggLSB0bXAyeDsgdGVbOV0gPSB0bXAxeSAtIHRtcDJ5OyB0ZVsxMF0gPSB0bXAxeiAtIHRtcDJ6O1xyXG5cdFx0XHRcdFx0dG1wMnggPSBzYXZlMXggKiBzYTsgdG1wMnkgPSBzYXZlMXkgKiBzYTsgdG1wMnogPSBzYXZlMXogKiBzYTtcclxuXHRcdFx0XHRcdHRtcDF4ID0gdGVbMF0gKiBjYTsgdG1wMXkgPSB0ZVsxXSAqIGNhOyB0bXAxeiA9IHRlWzJdICogY2E7XHJcblx0XHRcdFx0XHR0ZVswXSA9IHRtcDF4ICsgdG1wMng7IHRlWzFdID0gdG1wMXkgKyB0bXAyeTsgdGVbMl0gPSB0bXAxeiArIHRtcDJ6O1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgMTpcclxuXHRcdFx0XHRcdHZhciBzYXZlMXggPSB0ZVs4XSwgc2F2ZTF5ID0gdGVbOV0sIHNhdmUxeiA9IHRlWzEwXTtcclxuXHRcdFx0XHRcdHZhciB0bXAxeCA9IHRlWzhdICogY2EsIHRtcDF5ID0gdGVbOV0gKiBjYSwgdG1wMXogPSB0ZVsxMF0gKiBjYTtcclxuXHRcdFx0XHRcdHZhciB0bXAyeCA9IHRlWzRdICogc2EsIHRtcDJ5ID0gdGVbNV0gKiBzYSwgdG1wMnogPSB0ZVs2XSAqIHNhO1xyXG5cdFx0XHRcdFx0dGVbOF0gPSB0bXAxeCAtIHRtcDJ4OyB0ZVs5XSA9IHRtcDF5IC0gdG1wMnk7IHRlWzEwXSA9IHRtcDF6IC0gdG1wMno7XHJcblx0XHRcdFx0XHR0bXAyeCA9IHNhdmUxeCAqIHNhOyB0bXAyeSA9IHNhdmUxeSAqIHNhOyB0bXAyeiA9IHNhdmUxeiAqIHNhO1xyXG5cdFx0XHRcdFx0dG1wMXggPSB0ZVs0XSAqIGNhOyB0bXAxeSA9IHRlWzVdICogY2E7IHRtcDF6ID0gdGVbNl0gKiBjYTtcclxuXHRcdFx0XHRcdHRlWzRdID0gdG1wMXggKyB0bXAyeDsgdGVbNV0gPSB0bXAxeSArIHRtcDJ5OyB0ZVs2XSA9IHRtcDF6ICsgdG1wMno7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSAyOlxyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIkludmFsaWQgYXhpcyBjb21iaW5hdGlvbiwgY2Fubm90IHJvdGF0ZSBheGlzIHRvd2FyZCBpdHNlbGZcIilcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0fVxyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuICAgIH07XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuVHJhbnNsYXRlID0gZnVuY3Rpb24oeCx5LHopIHtcclxuXHRcdFx0dGhpcy5vcmlnaW4ueCA9IHg7XHJcblx0XHRcdHRoaXMub3JpZ2luLnkgPSB5O1xyXG5cdFx0XHR0aGlzLm9yaWdpbi56ID0gejtcclxuXHR9O1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLnJvdGF0ZVJlbGF0aXZlID0gZnVuY3Rpb24oIHgsIHksIHogKXtcclxuXHRcdC8vY29uc29sZS50cmFjZSggXCJyb3RhdGUgc3RhcnRzIGFzIFwiLCB0aGlzIClcclxuXHRcdGlmKCB0eXBlb2YgdGhpcy50aWNrID09PSBcInVuZGVmaW5lZFwiICkgdGhpcy50aWNrID0gMDtcclxuXHRcdHN3aXRjaCggdGhpcy50aWNrKysgKSB7XHJcblx0XHRcdGNhc2UgMDpcclxuXHRcdFx0XHR0aGlzLnJvdGF0ZU9ydGhvKCB4LCAxLCAyICk7XHJcblx0XHRcdFx0dGhpcy5yb3RhdGVPcnRobyggeSwgMCwgMiApO1xyXG5cdFx0XHRcdHRoaXMucm90YXRlT3J0aG8oIHosIDAsIDEgKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSAxOlxyXG5cdFx0XHRcdHRoaXMucm90YXRlT3J0aG8oIHksIDAsIDIgKTtcclxuXHRcdFx0XHR0aGlzLnJvdGF0ZU9ydGhvKCB4LCAxLCAyICk7XHJcblx0XHRcdFx0dGhpcy5yb3RhdGVPcnRobyggeiwgMCwgMSApO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIDI6XHJcblx0XHRcdFx0dGhpcy5yb3RhdGVPcnRobyggeiwgMCwgMSApO1xyXG5cdFx0XHRcdHRoaXMucm90YXRlT3J0aG8oIHgsIDEsIDIgKTtcclxuXHRcdFx0XHR0aGlzLnJvdGF0ZU9ydGhvKCB5LCAwLCAyICk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdGNhc2UgMzpcclxuXHRcdFx0XHR0aGlzLnJvdGF0ZU9ydGhvKCB4LCAxLCAyICk7XHJcblx0XHRcdFx0dGhpcy5yb3RhdGVPcnRobyggeiwgMCwgMSApO1xyXG5cdFx0XHRcdHRoaXMucm90YXRlT3J0aG8oIHksIDAsIDIgKTtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdFx0Y2FzZSA0OlxyXG5cdFx0XHRcdHRoaXMucm90YXRlT3J0aG8oIHksIDAsIDIgKTtcclxuXHRcdFx0XHR0aGlzLnJvdGF0ZU9ydGhvKCB6LCAwLCAxICk7XHJcblx0XHRcdFx0dGhpcy5yb3RhdGVPcnRobyggeCwgMSwgMiApO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRjYXNlIDU6XHJcblx0XHRcdFx0dGhpcy5yb3RhdGVPcnRobyggeiwgMCwgMSApO1xyXG5cdFx0XHRcdHRoaXMucm90YXRlT3J0aG8oIHksIDAsIDIgKTtcclxuXHRcdFx0XHR0aGlzLnJvdGF0ZU9ydGhvKCB4LCAxLCAyICk7XHJcblx0XHRcdFx0dGhpcy50aWNrID0gMDtcclxuXHRcdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHR9O1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLl9fZGVmaW5lR2V0dGVyX18oIFwibGVmdFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIFx0cmV0dXJuIFRIUkVFLlZlY3RvcjNQb29sLm5ldyggdGhpcy5lbGVtZW50c1swXSwgdGhpcy5lbGVtZW50c1sxXSwgdGhpcy5lbGVtZW50c1syXSApO1xyXG4gICAgICAgIH0gKTtcclxuXHRUSFJFRS5NYXRyaXg0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fKCBcInJpZ2h0XCIsIGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gVEhSRUUuVmVjdG9yM1Bvb2wubmV3KCAtdGhpcy5lbGVtZW50c1swXSwgLXRoaXMuZWxlbWVudHNbMV0sIC10aGlzLmVsZW1lbnRzWzJdICk7XHJcblx0fSApO1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLl9fZGVmaW5lR2V0dGVyX18oIFwidXBcIiwgZnVuY3Rpb24oKXtcclxuICAgICAgICBcdHJldHVybiBUSFJFRS5WZWN0b3IzUG9vbC5uZXcoIHRoaXMuZWxlbWVudHNbNF0sIHRoaXMuZWxlbWVudHNbNV0sIHRoaXMuZWxlbWVudHNbNl0gKTtcclxuICAgICAgICB9ICk7XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyggXCJkb3duXCIsIGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gVEhSRUUuVmVjdG9yM1Bvb2wubmV3KCAtdGhpcy5lbGVtZW50c1s0XSwgLXRoaXMuZWxlbWVudHNbNV0sIC10aGlzLmVsZW1lbnRzWzZdICk7XHJcbiAgICAgICAgfSApO1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLl9fZGVmaW5lR2V0dGVyX18oIFwiZm9yd2FyZFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIFx0cmV0dXJuIFRIUkVFLlZlY3RvcjNQb29sLm5ldyggLXRoaXMuZWxlbWVudHNbOF0sIC10aGlzLmVsZW1lbnRzWzldLCAtdGhpcy5lbGVtZW50c1sxMF0gKTtcclxuICAgICAgICB9ICk7XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyggXCJiYWNrd2FyZFwiLCBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIFRIUkVFLlZlY3RvcjNQb29sLm5ldyggdGhpcy5lbGVtZW50c1s4XSwgdGhpcy5lbGVtZW50c1s5XSwgdGhpcy5lbGVtZW50c1sxMF0gKTtcclxuICAgICAgICB9ICk7XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUubW92ZSA9IGZ1bmN0aW9uICh0aWNrKSB7XHJcbiAgICAgICAgXHRpZiggdGhpcy5tb3Rpb24gKVxyXG5cdFx0XHRcdHRoaXMubW90aW9uLm1vdmUoIHRoaXMsIHRpY2sgKTtcclxuICAgICAgICBcdC8vdGhpcy5vcmlnaW4uYWRkU2NhbGVkVmVjdG9yKCB0aGlzLmZvcndhcmQsIHogKS5hZGRTY2FsZWRWZWN0b3IoIHRoaXMudXAsIHkgKS5hZGRTY2FsZWRWZWN0b3IoIHRoaXMubGVmdCwgeCApXHJcblx0XHR9O1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLm1vdmVOb3cgPSBmdW5jdGlvbiAoIHgseSx6ICkgeyB0aGlzLm9yaWdpbi5hZGRTY2FsZWRWZWN0b3IoIHRoaXMuZm9yd2FyZCwgeiApLmFkZFNjYWxlZFZlY3RvciggdGhpcy51cCwgeSApLmFkZFNjYWxlZFZlY3RvciggdGhpcy5sZWZ0LCB4ICkgfTtcclxuXHRUSFJFRS5NYXRyaXg0LnByb3RvdHlwZS5tb3ZlRm9yd2FyZCA9IGZ1bmN0aW9uICggbiApIHsgdGhpcy5vcmlnaW4uYWRkU2NhbGVkVmVjdG9yKCB0aGlzLmZvcndhcmQsIG4gKTsgfTtcclxuXHRUSFJFRS5NYXRyaXg0LnByb3RvdHlwZS5tb3ZlVXAgPSBmdW5jdGlvbiAoIG4gKSB7IHRoaXMub3JpZ2luLmFkZFNjYWxlZFZlY3RvciggdGhpcy51cCwgbiApOyB9O1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLm1vdmVMZWZ0ID0gZnVuY3Rpb24gKCBuICkgeyB0aGlzLm9yaWdpbi5hZGRTY2FsZWRWZWN0b3IoIHRoaXMubGVmdCwgbiApOyB9O1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLm1vdmVCYWNrd2FyZCA9IGZ1bmN0aW9uICggbiApIHsgdGhpcy5vcmlnaW4uYWRkU2NhbGVkVmVjdG9yKCB0aGlzLmJhY2t3YXJkLCBuICk7IH07XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUubW92ZURvd24gPSBmdW5jdGlvbiAoIG4gKSB7IHRoaXMub3JpZ2luLmFkZFNjYWxlZFZlY3RvciggdGhpcy5kb3duLCBuICk7IH07XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUubW92ZVJpZ2h0ID0gZnVuY3Rpb24gKCBuICkgeyB0aGlzLm9yaWdpbi5hZGRTY2FsZWRWZWN0b3IoIHRoaXMucmlnaHQsIG4gKTsgfTtcclxuXHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyggXCJpbnZfbGVmdFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIFx0cmV0dXJuIFZlY3RvcjNQb29sLm5ldyggdGhpcy5lbGVtZW50c1swXSwgdGhpcy5lbGVtZW50c1s0XSwgdGhpcy5lbGVtZW50c1s4XSApO1xyXG4gICAgICAgIH0gKTtcclxuXHRUSFJFRS5NYXRyaXg0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fKCBcImludl91cFwiLCBmdW5jdGlvbigpe1xyXG4gICAgICAgIFx0cmV0dXJuIFZlY3RvcjNQb29sLm5ldyggdGhpcy5lbGVtZW50c1sxXSwgdGhpcy5lbGVtZW50c1s1XSwgdGhpcy5lbGVtZW50c1s5XSApO1xyXG4gICAgICAgIH0gKTtcclxuXHRUSFJFRS5NYXRyaXg0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fKCBcImludl9mb3J3YXJkXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgXHRyZXR1cm4gVmVjdG9yM1Bvb2wubmV3KCB0aGlzLmVsZW1lbnRzWzJdLCB0aGlzLmVsZW1lbnRzWzZdLCB0aGlzLmVsZW1lbnRzWzEwXSApO1xyXG4gICAgICAgIH0gKTtcclxuXHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuZ2V0Um9sbCA9IGZ1bmN0aW9uKCByZWxhdGl2ZVVwICkge1xyXG5cdFx0Ly9pZiggIXJlbGF0aXZlVXAgKSByZWxhdGl2ZVVwID0gVEhSRUUuVmVjdG9yM1VwO1xyXG5cdFx0cmV0dXJuIE1hdGguYXNpbiggdGhpcy5yaWdodC5kb3QoIHJlbGF0aXZlVXAgKSApO1xyXG5cdH07XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuZ2V0UGl0Y2ggPSBmdW5jdGlvbiggcmVsYXRpdmVGb3J3YXJkICkge1xyXG5cdFx0Ly9pZiggIXJlbGF0aXZlRm9yd2FyZCApIHJlbGF0aXZlRm9yd2FyZCA9IFRIUkVFLlZlY3RvcjNGb3J3YXJkO1xyXG5cdFx0cmV0dXJuIE1hdGguYXNpbiggdGhpcy51cC5kb3QoIHJlbGF0aXZlRm9yd2FyZCApICk7XHJcblx0fTtcclxuXHRUSFJFRS5NYXRyaXg0LnByb3RvdHlwZS5nZXRZYXcgPSBmdW5jdGlvbiggcmVsYXRpdmVSaWdodCApIHtcclxuXHRcdC8vaWYoICFyZWxhdGl2ZVJpZ2h0ICkgcmVsYXRpdmVSaWdodCA9IFRIUkVFLlZlY3RvcjNSaWdodDtcclxuXHRcdHJldHVybiBNYXRoLmFzaW4oIHRoaXMuZm9yd2FyZC5kb3QoIHJlbGF0aXZlUmlnaHQgKSApO1xyXG5cdH07XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyggXCJyb2xsXCIsIGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXRSb2xsKCBUSFJFRS5WZWN0b3IzVXAgKTtcclxuXHR9ICk7XHJcblx0VEhSRUUuTWF0cml4NC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyggXCJwaXRjaFwiLCBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0UGl0Y2goIFRIUkVFLlZlY3RvcjNGb3J3YXJkICk7XHJcblx0fSApO1xyXG5cdFRIUkVFLk1hdHJpeDQucHJvdG90eXBlLl9fZGVmaW5lR2V0dGVyX18oIFwieWF3XCIsIGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXRZYXcoIFRIUkVFLlZlY3RvcjNSaWdodCApO1xyXG5cdH0gKTtcclxufVxuIiwiXHJcbmlmKCB0eXBlb2YgVm94ZWxhcml1bSA9PT0gXCJ1bmRlZmluZWRcIiApe1xyXG4gICAgdGhpcy5Wb3hlbGFyaXVtID0ge307XHJcbi8vXHR2YXIgVm94ZWxhcml1bTtcclxufVxyXG5cclxuVm94ZWxhcml1bSA9IHsgVkVSU0lPTiA6IFwiMC4wLjFcIixcclxuICBTZXR0aW5ncyA6IHtcclxuICAgICBWUiA6IHRydWUsXHJcbiAgICAgQWx0U3BhY2UgOiB0cnVlLFxyXG4gICAgICB1c2VfYmFzaWNfbWF0ZXJpYWwgOiB0cnVlLFxyXG4gICAgICB1c2Vfdml2ZSA6IHRydWUsXHJcbiAgfVxyXG59O1xyXG5cclxuaWYoIHR5cGVvZiB1cGRhdGVWb3hlbGFyaXVtU2V0dGluZ3MgPT09ICdmdW5jdGlvbicgKXtcclxuICB1cGRhdGVWb3hlbGFyaXVtU2V0dGluZ3MoKTtcclxufVxyXG5cclxuT2JqZWN0LmZyZWV6ZSggVm94ZWxhcml1bS5TZXR0aW5ncyApO1xyXG5cclxuaWYoICBUSFJFRSA9PT0gbnVsbCApIHtcclxuLy9cdFRIUkVFID0gcmVxdWlyZSggXCIuL3RocmVlLmpzLjc0L2J1aWxkL3RocmVlLmpzXCIpXHJcbn1cclxuXHRyZXF1aXJlKCBcIi4vdGhyZWUuanMvcGVyc29uYWxGaWxsLmpzXCIpXHJcblxyXG4vL2lmKCBWb3hlbGFyaXVtLlNldHRpbmdzLkFsdFNwYWNlIClcclxuLy8gICB2YXIgYWx0c3BhY2UgPSByZXF1aXJlKCBcIi4vQWx0U3BhY2VWUi9kaXN0L2FsdHNwYWNlLmpzXCIgKTtcclxuXHJcblZveGVsYXJpdW0uU3RhdHMgPSAoIVZveGVsYXJpdW0uU2V0dGluZ3MuVlIpP3JlcXVpcmUoICcuL3RocmVlLmpzL2pzL3N0YXRzLm1pbi5qcycgKTpmdW5jdGlvbigpe307XHJcbmlmKCAhVm94ZWxhcml1bS5TZXR0aW5ncy5BbHRTcGFjZSAmJiBWb3hlbGFyaXVtLlNldHRpbmdzLlZSICkge1xyXG4gIHJlcXVpcmUoICcuL3RocmVlLmpzL2pzL2NvbnRyb2xzL1ZSQ29udHJvbHMuanMnICk7XHJcbiAgcmVxdWlyZSggJy4vdGhyZWUuanMvanMvZWZmZWN0cy9WUkVmZmVjdC5qcycgKTtcclxuXHJcbiAgcmVxdWlyZSggJy4vdGhyZWUuanMvanMvdnIvVml2ZUNvbnRyb2xsZXIuanMnICk7XHJcbiAgcmVxdWlyZSggJy4vdGhyZWUuanMvanMvdnIvUGFpbnRWaXZlQ29udHJvbGxlci5qcycgKTtcclxuICByZXF1aXJlKCAnLi90aHJlZS5qcy9qcy92ci9XZWJWUi5qcycgKTtcclxuICByZXF1aXJlKCAnLi90aHJlZS5qcy9qcy9sb2FkZXJzL09CSkxvYWRlci5qcycgKTtcclxufVxyXG5cclxuVm94ZWxhcml1bS5jbG9jayA9IG5ldyBUSFJFRS5DbG9jaygpXHJcblxyXG5cclxuaWYoICFWb3hlbGFyaXVtLlNldHRpbmdzLlZSICkge1xuICByZXF1aXJlKCBcIi4vb3JiaXRfY29udHJvbHMuanNcIiApXHJcbiAgcmVxdWlyZSggXCIuL05hdHVyYWxDYW1lcmEuanNcIiApXHJcbiAgcmVxdWlyZSggXCIuL2dhbWVNb3VzZS5qc1wiIClcclxufVxuXG5pZiggIVZveGVsYXJpdW0uU2V0dGluZ3MudXNlX2Jhc2ljX21hdGVyaWFsIClcblx0cmVxdWlyZSggXCIuL2dsb3cucmVuZGVyZXIuanNcIiApO1xuXHJcbnJlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMuZXhhbXBsZS9Qcm9qZWN0b3IuanNcIiApXG5yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3Qvc2hhZGVycy9Db3B5U2hhZGVyLmpzXCIpXG5yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3Qvc2hhZGVycy9Ib3Jpem9udGFsQmx1clNoYWRlci5qc1wiKVxucmVxdWlyZSggXCIuL3NyYy90aHJlZS5qcy5wb3N0L3NoYWRlcnMvVmVydGljYWxCbHVyU2hhZGVyLmpzXCIpXG4vL3JlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9zaGFkZXJzL0NvbnZvbHV0aW9uU2hhZGVyLmpzXCIpXG4vL3JlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9zaGFkZXJzL0RvdFNjcmVlblNoYWRlci5qc1wiKVxuLy9yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3Qvc2hhZGVycy9GaWxtU2hhZGVyLmpzXCIpXG5yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3QvRWZmZWN0Q29tcG9zZXIuanNcIilcbnJlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9CbG9vbVBhc3MuanNcIilcblxuXG4vL3JlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9BZGFwdGl2ZVRvbmVNYXBwaW5nUGFzcy5qc1wiKVxuLy9yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3QvQm9rZWhQYXNzLmpzXCIpXG5yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3QvQ2xlYXJQYXNzLmpzXCIpXG4vL3JlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9Eb3RTY3JlZW5QYXNzLmpzXCIpXG4vL3JlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9GaWxtUGFzcy5qc1wiKVxuLy9yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3QvR2xpdGNoUGFzcy5qc1wiKVxuLy9yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3QvTWFudWFsTVNBQVJlbmRlclBhc3MuanNcIilcbnJlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9NYXNrUGFzcy5qc1wiKVxucmVxdWlyZSggXCIuL3NyYy90aHJlZS5qcy5wb3N0L1JlbmRlclBhc3MuanNcIilcbi8vcmVxdWlyZSggXCIuL3NyYy90aHJlZS5qcy5wb3N0L1NhdmVQYXNzLmpzXCIpXG5yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3QvU2hhZGVyUGFzcy5qc1wiKVxuLy9yZXF1aXJlKCBcIi4vc3JjL3RocmVlLmpzLnBvc3QvU01BQVBhc3MuanNcIilcbi8vcmVxdWlyZSggXCIuL3NyYy90aHJlZS5qcy5wb3N0L1RBQVJlbmRlclBhc3MuanNcIilcbnJlcXVpcmUoIFwiLi9zcmMvdGhyZWUuanMucG9zdC9UZXh0dXJlUGFzcy5qc1wiKVxuXHJcblZveGVsYXJpdW0uY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA5MCwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDAuMDAxLCAxMDAwMCApO1xyXG4vL2NvbnNvbGUubG9nKCBWb3hlbGFyaXVtLmNhbWVyYS5wcm9qZWN0aW9uTWF0cml4LnRvQXJyYXkoKSApXHJcbnJlcXVpcmUoIFwiLi9zcmMvdm94ZWxhcml1bS5ndW4uZGIuanNcIiApXG5cbi8vLS0tIGZvbnRzIC0tLVxyXG5Wb3hlbGFyaXVtLkZvbnRzID0ge307XHJcbnJlcXVpcmUoIFwiLi9zcmMvZm9udHMvVEk5OS5qc1wiKVxyXG4vL3JlcXVpcmUoIFwiLi9zcmMvZm9udHMvbXN5aDEuanNcIilcclxuXHJcbnJlcXVpcmUoIFwiLi9zcmMvY29uc3RhbnRzLmpzXCIpXHJcbnJlcXVpcmUoIFwiLi9zcmMvYml0c3RyZWFtLmpzXCIpICAvLyByZWFkIGFuZCB3cml0ZSBiaXRzXHJcblxyXG5yZXF1aXJlKCBcIi4vc3JjL3NlY3Rvci5qc1wiKVxyXG5yZXF1aXJlKCBcIi4vc3JjL2NsdXN0ZXIuanNcIilcclxucmVxdWlyZSggXCIuL3NyYy93b3JsZC5qc1wiKVxyXG5cclxucmVxdWlyZSggXCIuL3NyYy9nZW9tZXRyeWJhc2ljYnVmZmVyLmpzXCIpXHJcbnJlcXVpcmUoIFwiLi9zcmMvZ2VvbWV0cnlidWZmZXIuanNcIilcclxucmVxdWlyZSggXCIuL3NyYy9nZW9tZXRyeW1hdGVyaWFsLmpzXCIpXHJcbnJlcXVpcmUoIFwiLi9zcmMvZ2VvbWV0cnlidWZmZXIubW9uby5qc1wiKVxyXG5yZXF1aXJlKCBcIi4vc3JjL2dlb21ldHJ5bWF0ZXJpYWwubW9uby5qc1wiKVxyXG5yZXF1aXJlKCBcIi4vc3JjL3RleHR1cmVBdGxhcy5jYW52YXMuanNcIilcclxuXHJcbnJlcXVpcmUoIFwiLi9zcmMvdm94ZWxTZWxlY3Rvci5qc1wiKVxyXG5cclxucmVxdWlyZSggXCIuL3NyYy9zb3J0aW5nLnRyZWUuanNcIilcclxucmVxdWlyZSggXCIuL3NyYy9tZXNoZXIuYmFzaWMuanNcIilcclxuXHJcbnJlcXVpcmUoIFwiLi9zcmMvdm94ZWxzLmpzXCIgKSAgLy8gbXVzdCBiZSBhZnRlciBhdGxhc1xyXG5cclxuXHJcbnJlcXVpcmUoIFwiLi9zcmMvdm94ZWxfaW52ZW50b3J5LmpzXCIpICAvLyBtdXN0IGJlIGFmdGVyIHZveGVsc1xyXG4vL09iamVjdC5mcmVlemUoIFZveGVsYXJpdW0gKTtcclxuLy9Wb3hlbGFyaXVtLmZyZWV6ZSgpO1xyXG4iXX0=
